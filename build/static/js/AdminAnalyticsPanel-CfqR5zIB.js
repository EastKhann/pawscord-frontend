import{n as e,q as b,A as I,C as h,X as y,Y as j,T as f,z as L,L as G,t as A,B as W,u as $,r as m}from"./react-core-DA61mcWm.js";import{ba as V,bb as E,aC as u,av as C,u as d,a4 as k,aM as U,y as Y,bc as Z,at as K,aP as q,S as z,D as B,ao as N,a as J}from"./icons-vendor-DRtjID0N.js";import"./ui-vendor-BrUQ4r0A.js";import"./editor-vendor-D9c4a6XZ.js";const s={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,backdropFilter:"blur(5px)"},modal:{backgroundColor:"#2b2d31",borderRadius:"12px",width:"90%",maxWidth:"1200px",maxHeight:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.5)"},header:{padding:"20px",borderBottom:"1px solid #1e1f22",display:"flex",justifyContent:"space-between",alignItems:"center"},headerLeft:{display:"flex",alignItems:"center",gap:"12px",color:"#fff"},headerRight:{display:"flex",gap:"10px"},title:{margin:0,fontSize:"24px",color:"#fff"},exportButton:{background:"#23a559",border:"none",color:"#fff",padding:"10px 15px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px"},closeButton:{background:"#da373c",border:"none",color:"#fff",padding:"10px 15px",borderRadius:"6px",cursor:"pointer",fontSize:"16px"},tabs:{display:"flex",padding:"0 20px",borderBottom:"1px solid #1e1f22",gap:"5px"},tab:{background:"none",border:"none",color:"#b9bbbe",padding:"12px 20px",cursor:"pointer",fontSize:"14px",fontWeight:"500",borderBottom:"2px solid transparent",display:"flex",alignItems:"center",gap:"8px",transition:"all 0.2s"},activeTab:{color:"#fff",borderBottomColor:"#5865f2"},content:{flex:1,overflow:"auto",padding:"20px"},tabContent:{display:"flex",flexDirection:"column",gap:"20px"},statsGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"15px"},statCard:{backgroundColor:"#1e1f22",borderRadius:"8px",padding:"20px",display:"flex",alignItems:"center",gap:"15px"},statIcon:{fontSize:"32px"},statContent:{flex:1},statLabel:{color:"#b9bbbe",fontSize:"12px",marginBottom:"5px"},statValue:{color:"#fff",fontSize:"24px",fontWeight:"bold"},statSubtitle:{color:"#747f8d",fontSize:"11px",marginTop:"3px"},section:{backgroundColor:"#1e1f22",borderRadius:"8px",padding:"20px"},sectionTitle:{color:"#fff",fontSize:"16px",marginBottom:"15px",margin:"0 0 15px 0"},activityList:{display:"flex",flexDirection:"column",gap:"10px"},activityItem:{display:"flex",alignItems:"center",padding:"10px",backgroundColor:"#2b2d31",borderRadius:"6px"},activityIcon:{color:"#5865f2",marginRight:"12px",fontSize:"18px"},activityLabel:{flex:1,color:"#b9bbbe",fontSize:"14px"},activityValue:{color:"#fff",fontSize:"16px",fontWeight:"bold"},list:{display:"flex",flexDirection:"column",gap:"8px"},listItem:{display:"flex",justifyContent:"space-between",padding:"10px",backgroundColor:"#2b2d31",borderRadius:"6px",color:"#b9bbbe",fontSize:"14px"},pieChart:{display:"flex",flexDirection:"column",gap:"12px"},pieItem:{display:"flex",alignItems:"center",gap:"12px"},pieColor:{width:"20px",height:"20px",borderRadius:"4px"},pieLabel:{flex:1,color:"#b9bbbe",fontSize:"14px"},pieValue:{color:"#fff",fontSize:"16px",fontWeight:"bold"},loading:{color:"#fff",textAlign:"center",padding:"40px"},error:{color:"#da373c",textAlign:"center",padding:"40px"},growthSection:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:"12px",marginBottom:"20px"},growthCard:{backgroundColor:"#1e1f22",borderRadius:"8px",padding:"15px",display:"flex",flexDirection:"column",gap:"8px"},growthLabel:{color:"#b9bbbe",fontSize:"12px"},growthValue:{display:"flex",alignItems:"center",gap:"8px",fontSize:"20px",fontWeight:"bold"},deviceStats:{display:"flex",gap:"20px",flexWrap:"wrap"},deviceCard:{flex:"1 1 200px",display:"flex",alignItems:"center",gap:"15px",backgroundColor:"#2b2d31",padding:"20px",borderRadius:"8px"},deviceInfo:{display:"flex",flexDirection:"column",gap:"4px"},deviceLabel:{color:"#b9bbbe",fontSize:"12px"},deviceValue:{color:"#fff",fontSize:"24px",fontWeight:"bold"},devicePercent:{color:"#5865f2",fontSize:"14px",fontWeight:"bold"}},a=i=>i==null?"0":i>=1e6?(i/1e6).toFixed(1)+"M":i>=1e3?(i/1e3).toFixed(1)+"K":i.toLocaleString(),n=({icon:i,label:l,value:t,color:o,subtitle:c})=>e.jsxs("div",{style:{...s.statCard,borderTop:`3px solid ${o}`},children:[e.jsx("div",{style:{...s.statIcon,color:o},children:i}),e.jsxs("div",{style:s.statContent,children:[e.jsx("div",{style:s.statLabel,children:l}),e.jsx("div",{style:s.statValue,children:t}),c&&e.jsx("div",{style:s.statSubtitle,children:c})]})]}),_=({label:i,value:l,isPositive:t,suffix:o="%",icon:c})=>e.jsxs("div",{style:{...s.growthCard,borderLeft:`4px solid ${t?"#23a559":"#ed4245"}`},children:[e.jsx("div",{style:s.growthLabel,children:i}),e.jsxs("div",{style:{...s.growthValue,color:t?"#23a559":"#ed4245"},children:[c||(t?e.jsx(V,{}):e.jsx(E,{})),e.jsxs("span",{children:[typeof l=="number"?l.toFixed(1):l,o]})]})]}),x=({icon:i,label:l,value:t,color:o="#5865f2"})=>e.jsxs("div",{style:s.activityItem,children:[e.jsx("div",{style:{...s.activityIcon,color:o},children:i}),e.jsx("div",{style:s.activityLabel,children:l}),e.jsx("div",{style:{...s.activityValue,color:o},children:t})]}),w=({label:i,value:l,color:t})=>e.jsxs("div",{style:s.pieItem,children:[e.jsx("div",{style:{...s.pieColor,backgroundColor:t}}),e.jsx("div",{style:s.pieLabel,children:i}),e.jsx("div",{style:s.pieValue,children:l})]}),v=i=>({backgroundColor:"#1e1f22",border:`1px solid ${i}`,borderRadius:"6px",color:"#fff"}),g={stroke:"#b9bbbe",tick:{fill:"#b9bbbe",fontSize:12},interval:4},X=({stats:i})=>e.jsxs("div",{style:s.tabContent,children:[e.jsxs("div",{style:s.growthSection,children:[e.jsx(_,{label:"Mesaj ArtÄ±ÅŸÄ± (24h)",value:i.message_growth_24h||0,isPositive:(i.message_growth_24h||0)>=0}),e.jsx(_,{label:"KayÄ±t ArtÄ±ÅŸÄ± (24h)",value:i.signup_growth_24h||0,isPositive:(i.signup_growth_24h||0)>=0}),e.jsx(_,{label:"GÃ¼nlÃ¼k Ort. Mesaj",value:i.avg_messages_per_day||0,isPositive:!0,suffix:"",icon:e.jsx(u,{})}),e.jsx(_,{label:"GÃ¼nlÃ¼k Ort. KayÄ±t",value:i.avg_signups_per_day||0,isPositive:!0,suffix:"",icon:e.jsx(C,{})})]}),e.jsxs("div",{style:s.statsGrid,children:[e.jsx(n,{icon:e.jsx(d,{}),label:"Toplam KullanÄ±cÄ±",value:i.total_users||0,color:"#5865f2",subtitle:`Online: ${i.online_users||0} | Aktif: ${i.active_users||0}`}),e.jsx(n,{icon:e.jsx(u,{}),label:"Toplam Sunucu",value:i.total_servers||0,color:"#23a559",subtitle:`Son 24h: +${i.new_servers_24h||0}`}),e.jsx(n,{icon:e.jsx(u,{}),label:"Toplam Mesaj",value:a(i.total_messages||0),color:"#f0b132",subtitle:`Son 24h: ${a(i.messages_24h||0)}`}),e.jsx(n,{icon:e.jsx(k,{}),label:"Toplam Ziyaret",value:a(i.total_page_views||0),color:"#e91e63",subtitle:`Son 24h: ${a(i.page_views_24h||0)}`}),e.jsx(n,{icon:e.jsx(d,{}),label:"Premium KullanÄ±cÄ±",value:i.premium_users||0,color:"#9b59b6",subtitle:`Gelir: ${i.monthly_revenue||0} TL/ay`}),e.jsx(n,{icon:e.jsx(d,{}),label:"Benzersiz ZiyaretÃ§i",value:a(i.unique_visitors_30d||0),color:"#00bcd4",subtitle:`Son 24h: ${a(i.unique_visitors_24h||0)}`})]}),(i.mobile_views>0||i.desktop_views>0)&&e.jsxs("div",{style:s.section,children:[e.jsx("h3",{style:s.sectionTitle,children:"ðŸ“± Cihaz DaÄŸÄ±lÄ±mÄ± (Son 7 GÃ¼n)"}),e.jsxs("div",{style:s.deviceStats,children:[e.jsxs("div",{style:s.deviceCard,children:[e.jsx(U,{size:32,color:"#5865f2"}),e.jsxs("div",{style:s.deviceInfo,children:[e.jsx("span",{style:s.deviceLabel,children:"Mobil"}),e.jsx("span",{style:s.deviceValue,children:a(i.mobile_views||0)}),e.jsxs("span",{style:s.devicePercent,children:[Math.round((i.mobile_views||0)/((i.mobile_views||0)+(i.desktop_views||1))*100),"%"]})]})]}),e.jsxs("div",{style:s.deviceCard,children:[e.jsx(Y,{size:32,color:"#23a559"}),e.jsxs("div",{style:s.deviceInfo,children:[e.jsx("span",{style:s.deviceLabel,children:"MasaÃ¼stÃ¼"}),e.jsx("span",{style:s.deviceValue,children:a(i.desktop_views||0)}),e.jsxs("span",{style:s.devicePercent,children:[Math.round((i.desktop_views||0)/((i.mobile_views||0)+(i.desktop_views||1))*100),"%"]})]})]})]})]}),i.daily_stats&&i.daily_stats.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:s.section,children:[e.jsx("h3",{style:s.sectionTitle,children:"ðŸ“¨ GÃ¼nlÃ¼k Mesaj SayÄ±sÄ± (Son 30 GÃ¼n)"}),e.jsx(b,{width:"100%",height:250,children:e.jsxs(I,{data:i.daily_stats,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorMessages",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#5865f2",stopOpacity:.8}),e.jsx("stop",{offset:"95%",stopColor:"#5865f2",stopOpacity:0})]})}),e.jsx(h,{strokeDasharray:"3 3",stroke:"#1e1f22"}),e.jsx(y,{dataKey:"label",...g}),e.jsx(j,{stroke:"#b9bbbe",tick:{fill:"#b9bbbe",fontSize:12}}),e.jsx(f,{contentStyle:v("#5865f2")}),e.jsx(L,{type:"monotone",dataKey:"messages",stroke:"#5865f2",strokeWidth:2,fillOpacity:1,fill:"url(#colorMessages)"})]})})]}),e.jsxs("div",{style:s.section,children:[e.jsx("h3",{style:s.sectionTitle,children:"ðŸ‘¥ GÃ¼nlÃ¼k Aktif KullanÄ±cÄ± (Son 30 GÃ¼n)"}),e.jsx(b,{width:"100%",height:250,children:e.jsxs(G,{data:i.daily_stats,children:[e.jsx(h,{strokeDasharray:"3 3",stroke:"#1e1f22"}),e.jsx(y,{dataKey:"label",...g}),e.jsx(j,{stroke:"#b9bbbe",tick:{fill:"#b9bbbe",fontSize:12}}),e.jsx(f,{contentStyle:v("#23a559")}),e.jsx(A,{type:"monotone",dataKey:"active_users",stroke:"#23a559",strokeWidth:3,dot:{fill:"#23a559",r:4},activeDot:{r:6}})]})})]}),e.jsxs("div",{style:s.section,children:[e.jsx("h3",{style:s.sectionTitle,children:"ðŸ†• GÃ¼nlÃ¼k Yeni KayÄ±tlar (Son 30 GÃ¼n)"}),e.jsx(b,{width:"100%",height:250,children:e.jsxs(W,{data:i.daily_stats,children:[e.jsx(h,{strokeDasharray:"3 3",stroke:"#1e1f22"}),e.jsx(y,{dataKey:"label",...g}),e.jsx(j,{stroke:"#b9bbbe",tick:{fill:"#b9bbbe",fontSize:12}}),e.jsx(f,{contentStyle:v("#f0b132")}),e.jsx($,{dataKey:"signups",fill:"#f0b132",radius:[8,8,0,0]})]})})]}),e.jsxs("div",{style:s.section,children:[e.jsx("h3",{style:s.sectionTitle,children:"ðŸ‘ï¸ GÃ¼nlÃ¼k Ziyaret SayÄ±sÄ± (Son 30 GÃ¼n)"}),e.jsx(b,{width:"100%",height:250,children:e.jsxs(I,{data:i.daily_stats,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorPageViews",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#e91e63",stopOpacity:.8}),e.jsx("stop",{offset:"95%",stopColor:"#e91e63",stopOpacity:0})]})}),e.jsx(h,{strokeDasharray:"3 3",stroke:"#1e1f22"}),e.jsx(y,{dataKey:"label",...g}),e.jsx(j,{stroke:"#b9bbbe",tick:{fill:"#b9bbbe",fontSize:12}}),e.jsx(f,{contentStyle:v("#e91e63")}),e.jsx(L,{type:"monotone",dataKey:"page_views",stroke:"#e91e63",strokeWidth:2,fillOpacity:1,fill:"url(#colorPageViews)"})]})})]}),e.jsxs("div",{style:s.section,children:[e.jsx("h3",{style:s.sectionTitle,children:"ðŸ‘¥ GÃ¼nlÃ¼k Benzersiz ZiyaretÃ§i (Son 30 GÃ¼n)"}),e.jsx(b,{width:"100%",height:250,children:e.jsxs(G,{data:i.daily_stats,children:[e.jsx(h,{strokeDasharray:"3 3",stroke:"#1e1f22"}),e.jsx(y,{dataKey:"label",...g}),e.jsx(j,{stroke:"#b9bbbe",tick:{fill:"#b9bbbe",fontSize:12}}),e.jsx(f,{contentStyle:v("#00bcd4")}),e.jsx(A,{type:"monotone",dataKey:"unique_visitors",stroke:"#00bcd4",strokeWidth:3,dot:{fill:"#00bcd4",r:4},activeDot:{r:6}})]})})]})]}),e.jsxs("div",{style:s.section,children:[e.jsx("h3",{style:s.sectionTitle,children:"Son Aktiviteler (24 Saat)"}),e.jsxs("div",{style:s.activityList,children:[e.jsx(x,{icon:e.jsx(C,{}),label:"Yeni KayÄ±tlar",value:i.new_signups_24h||0}),e.jsx(x,{icon:e.jsx(u,{}),label:"Yeni Sunucular",value:i.new_servers_24h||0}),e.jsx(x,{icon:e.jsx(u,{}),label:"Mesajlar",value:i.messages_24h||0}),e.jsx(x,{icon:e.jsx(k,{}),label:"Aktif KullanÄ±cÄ±",value:i.active_users_24h||0}),e.jsx(x,{icon:e.jsx(k,{}),label:"Sayfa Ziyareti",value:i.page_views_24h||0,color:"#e91e63"}),e.jsx(x,{icon:e.jsx(d,{}),label:"Benzersiz ZiyaretÃ§i",value:i.unique_visitors_24h||0,color:"#00bcd4"})]})]}),i.top_pages&&i.top_pages.length>0&&e.jsxs("div",{style:s.section,children:[e.jsx("h3",{style:s.sectionTitle,children:"ðŸ“Š En Ã‡ok Ziyaret Edilen Sayfalar (Son 30 GÃ¼n)"}),e.jsx("div",{style:s.list,children:i.top_pages.slice(0,10).map((l,t)=>e.jsxs("div",{style:s.listItem,children:[e.jsxs("span",{children:["#",t+1," ",l?.path||"Unknown"]}),e.jsxs("span",{style:{color:"#e91e63",fontWeight:"bold"},children:[(l?.views||0).toLocaleString()," ziyaret"]})]},t))})]})]}),H=({stats:i})=>e.jsxs("div",{style:s.tabContent,children:[e.jsxs("div",{style:s.statsGrid,children:[e.jsx(n,{icon:e.jsx(d,{}),label:"Toplam KullanÄ±cÄ±",value:i.total_users||0,color:"#5865f2"}),e.jsx(n,{icon:e.jsx(C,{}),label:"Online",value:i.online_users||0,color:"#23a559"}),e.jsx(n,{icon:e.jsx(Z,{}),label:"Offline",value:i.total_users-i.online_users||0,color:"#747f8d"})]}),i.top_users&&i.top_users.length>0&&e.jsxs("div",{style:s.section,children:[e.jsx("h3",{style:s.sectionTitle,children:"En Aktif KullanÄ±cÄ±lar"}),e.jsx("div",{style:s.list,children:i.top_users.map((l,t)=>e.jsxs("div",{style:s.listItem,children:[e.jsxs("span",{children:["#",t+1," ",l.username]}),e.jsxs("span",{children:[l.message_count," mesaj"]})]},t))})]})]}),Q=({stats:i})=>e.jsxs("div",{style:s.tabContent,children:[e.jsxs("div",{style:s.statsGrid,children:[e.jsx(n,{icon:e.jsx(K,{}),label:"Premium KullanÄ±cÄ±",value:i.premium_users||0,color:"#9b59b6"}),e.jsx(n,{icon:e.jsx(q,{}),label:"AylÄ±k Gelir",value:`${i.monthly_revenue||0} TL`,color:"#f0b132"}),e.jsx(n,{icon:e.jsx(z,{}),label:"YÄ±llÄ±k Tahmin",value:`${(i.monthly_revenue||0)*12} TL`,color:"#23a559"})]}),e.jsxs("div",{style:s.section,children:[e.jsx("h3",{style:s.sectionTitle,children:"Premium DaÄŸÄ±lÄ±mÄ±"}),e.jsxs("div",{style:s.pieChart,children:[e.jsx(w,{label:"Ãœcretsiz",value:i.free_users||0,color:"#747f8d"}),e.jsx(w,{label:"Nitro Basic",value:i.basic_users||0,color:"#5865f2"}),e.jsx(w,{label:"Nitro Premium",value:i.premium_tier_users||0,color:"#9b59b6"})]})]})]}),ee=({stats:i})=>e.jsxs("div",{style:s.tabContent,children:[e.jsxs("div",{style:s.statsGrid,children:[e.jsx(n,{icon:e.jsx(B,{}),label:"Toplam Sunucu",value:i.total_servers||0,color:"#5865f2"}),e.jsx(n,{icon:e.jsx(k,{}),label:"Genel Sunucu",value:i.public_servers||0,color:"#23a559"}),e.jsx(n,{icon:e.jsx(d,{}),label:"Ortalama Ãœye",value:i.avg_server_members||0,color:"#f0b132"})]}),i.top_servers&&i.top_servers.length>0&&e.jsxs("div",{style:s.section,children:[e.jsx("h3",{style:s.sectionTitle,children:"En BÃ¼yÃ¼k Sunucular"}),e.jsx("div",{style:s.list,children:i.top_servers.map((l,t)=>e.jsxs("div",{style:s.listItem,children:[e.jsxs("span",{children:["#",t+1," ",l.name]}),e.jsxs("span",{children:[l.member_count," Ã¼ye"]})]},t))})]})]}),oe=({onClose:i,fetchWithAuth:l,apiBaseUrl:t})=>{const[o,c]=m.useState(null),[D,F]=m.useState(!0),[p,P]=m.useState("overview");m.useEffect(()=>{T();const r=setInterval(T,3e4);return()=>clearInterval(r)},[]);const T=async()=>{try{const r=await l(`${t}/admin/analytics/`);r.ok&&c(await r.json())}catch{}finally{F(!1)}},R=()=>{if(!o)return;const r=new Blob([JSON.stringify(o,null,2)],{type:"application/json"}),M=URL.createObjectURL(r),S=document.createElement("a");S.href=M,S.download=`analytics_${new Date().toISOString().split("T")[0]}.json`,S.click()};if(D)return e.jsx("div",{style:s.overlay,children:e.jsx("div",{style:s.modal,children:e.jsx("div",{style:s.loading,children:"Y\\u00FCkleniyor..."})})});if(!o)return e.jsx("div",{style:s.overlay,children:e.jsx("div",{style:s.modal,children:e.jsx("div",{style:s.error,children:"Analytics verisi y\\u00FCklenemedi"})})});const O=[{key:"overview",icon:e.jsx(z,{}),label:"Genel"},{key:"users",icon:e.jsx(d,{}),label:"KullanÄ±cÄ±lar"},{key:"premium",icon:e.jsx(K,{}),label:"Premium"},{key:"servers",icon:e.jsx(B,{}),label:"Sunucular"}];return e.jsx("div",{style:s.overlay,onClick:i,children:e.jsxs("div",{style:s.modal,onClick:r=>r.stopPropagation(),children:[e.jsxs("div",{style:s.header,children:[e.jsxs("div",{style:s.headerLeft,children:[e.jsx(z,{size:24}),e.jsx("h2",{style:s.title,children:"Admin Analytics"})]}),e.jsxs("div",{style:s.headerRight,children:[e.jsx("button",{onClick:R,style:s.exportButton,title:"Export JSON",children:e.jsx(N,{})}),e.jsx("button",{onClick:i,style:s.closeButton,children:e.jsx(J,{})})]})]}),e.jsx("div",{style:s.tabs,children:O.map(r=>e.jsxs("button",{onClick:()=>P(r.key),style:{...s.tab,...p===r.key&&s.activeTab},children:[r.icon," ",r.label]},r.key))}),e.jsxs("div",{style:s.content,children:[p==="overview"&&e.jsx(X,{stats:o}),p==="users"&&e.jsx(H,{stats:o}),p==="premium"&&e.jsx(Q,{stats:o}),p==="servers"&&e.jsx(ee,{stats:o})]})]})})};export{oe as default};
