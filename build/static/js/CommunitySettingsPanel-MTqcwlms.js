var w=Object.defineProperty;var l=(n,i)=>w(n,"name",{value:i,configurable:!0});import{r as m,j as e}from"./react-core-Djgtqrmb.js";import{aA as k,b4 as K,ax as Q,ac as A,cI as $,a as j,f as z,a1 as f,d as I,u as L,bo as D,bp as G,az as O,cC as Y,aY as q}from"./icons-vendor-BMXAt4pj.js";import{t as b}from"./index-DwVhiipM.js";import"./media-vendor-CxFPycob.js";import"./router-vendor-gmJ9Mn-1.js";import"./state-vendor-CbW2fAN9.js";import"./crypto-vendor-D1XRGppi.js";import"./ui-vendor-IhB9Znpc.js";const H={is_community:!1,rules_channel_id:"",public_updates_channel_id:"",verification_level:"medium",explicit_content_filter:"medium",default_notifications:"mentions",description:"",preferred_locale:"tr",features:{welcome_screen:!0,member_screening:!1,discovery:!1}},P=[{value:"none",label:"Yok",description:"Herkes mesaj gÃ¶nderebilir"},{value:"low",label:"DÃ¼ÅŸÃ¼k",description:"E-posta doÄŸrulamasÄ± gerekli"},{value:"medium",label:"Orta",description:"5 dakika kayÄ±tlÄ± olmalÄ±"},{value:"high",label:"YÃ¼ksek",description:"10 dakika sunucuda olmalÄ±"},{value:"highest",label:"En YÃ¼ksek",description:"Telefon doÄŸrulamasÄ± gerekli"}],V=[{value:"disabled",label:"KapalÄ±",description:"Ä°Ã§erik filtresi yok"},{value:"medium",label:"Orta",description:"RolsÃ¼z Ã¼yeler iÃ§in filtrele"},{value:"high",label:"YÃ¼ksek",description:"TÃ¼m mesajlarÄ± filtrele"}],B=l((n,i)=>{const[c,s]=m.useState(H),[a,r]=m.useState([]),[o,v]=m.useState([]),[y,N]=m.useState([]),[_,S]=m.useState(!0),[C,g]=m.useState(!1),[T,F]=m.useState("general");m.useEffect(()=>{E(),R()},[]);const x=l(()=>({Authorization:`Bearer ${localStorage.getItem("access_token")}`}),"authHeaders"),E=l(async()=>{try{const t=await fetch(`${n}/servers/${i}/community/settings/`,{headers:x()});if(t.ok){const d=await t.json();s(u=>({...u,...d})),r(d.rules||[]),v(d.screening_questions||[])}}catch{}finally{S(!1)}},"fetchCommunitySettings"),R=l(async()=>{try{const t=await fetch(`${n}/servers/${i}/channels/`,{headers:x()});if(t.ok){const d=await t.json();N((d.channels||d||[]).filter(u=>u.type!=="category"))}}catch{}},"fetchChannels");return{settings:c,setSettings:s,rules:a,screeningQuestions:o,channels:y,loading:_,saving:C,activeTab:T,setActiveTab:F,saveSettings:l(async()=>{g(!0);try{(await fetch(`${n}/servers/${i}/community/settings/`,{method:"PUT",headers:{...x(),"Content-Type":"application/json"},body:JSON.stringify({...c,rules:a,screening_questions:o})})).ok&&b.success("âœ… Topluluk ayarlarÄ± kaydedildi")}catch{b.error("Kaydetme baÅŸarÄ±sÄ±z")}finally{g(!1)}},"saveSettings"),addRule:l(()=>r(t=>[...t,{id:Date.now(),title:"",description:""}]),"addRule"),updateRule:l((t,d,u)=>r(p=>p.map(h=>h.id===t?{...h,[d]:u}:h)),"updateRule"),removeRule:l(t=>r(d=>d.filter(u=>u.id!==t)),"removeRule"),addQuestion:l(()=>v(t=>[...t,{id:Date.now(),question:"",required:!1}]),"addQuestion"),updateQuestion:l((t,d,u)=>v(p=>p.map(h=>h.id===t?{...h,[d]:u}:h)),"updateQuestion"),removeQuestion:l(t=>v(d=>d.filter(u=>u.id!==t)),"removeQuestion")}},"useCommunitySettings"),U=l(({settings:n,setSettings:i,channels:c})=>e.jsxs("div",{className:"settings-tab",children:[e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["Sunucu A","Ã§Ä±","klamas","Ä±"]}),e.jsx("textarea",{value:n.description,onChange:l(s=>i(a=>({...a,description:s.target.value})),"onChange"),placeholder:"Sunucunuz hakkÄ±nda kÄ±sa bir aÃ§Ä±klama...",rows:"3",maxLength:300}),e.jsxs("span",{className:"char-count",children:[n.description?.length||0,"/300"]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:[e.jsx(k,{})," Kurallar Kanal","Ä±"]}),e.jsxs("select",{value:n.rules_channel_id,onChange:l(s=>i(a=>({...a,rules_channel_id:s.target.value})),"onChange"),children:[e.jsxs("option",{value:"",children:["Se","Ã§","in..."]}),c.map(s=>e.jsxs("option",{value:s.id,children:["#",s.name]},s.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:[e.jsx(K,{})," G","Ã¼","ncellemeler Kanal","Ä±"]}),e.jsxs("select",{value:n.public_updates_channel_id,onChange:l(s=>i(a=>({...a,public_updates_channel_id:s.target.value})),"onChange"),children:[e.jsxs("option",{value:"",children:["Se","Ã§","in..."]}),c.map(s=>e.jsxs("option",{value:s.id,children:["#",s.name]},s.id))]})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:[e.jsx(Q,{})," Tercih Edilen Dil"]}),e.jsxs("select",{value:n.preferred_locale,onChange:l(s=>i(a=>({...a,preferred_locale:s.target.value})),"onChange"),children:[e.jsxs("option",{value:"tr",children:["ðŸ‡¹ðŸ‡·"," T","Ã¼","rk","Ã§","e"]}),e.jsxs("option",{value:"en",children:["ðŸ‡¬ðŸ‡§"," English"]}),e.jsxs("option",{value:"de",children:["ðŸ‡©ðŸ‡ª"," Deutsch"]}),e.jsxs("option",{value:"fr",children:["ðŸ‡«ðŸ‡·"," Fran","Ã§","ais"]})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:[e.jsx(A,{})," Varsay","Ä±","lan Bildirimler"]}),e.jsxs("select",{value:n.default_notifications,onChange:l(s=>i(a=>({...a,default_notifications:s.target.value})),"onChange"),children:[e.jsxs("option",{value:"all",children:["T","Ã¼","m Mesajlar"]}),e.jsx("option",{value:"mentions",children:"Sadece Etiketler"})]})]})]}),e.jsxs("div",{className:"feature-toggles",children:[e.jsxs("h4",{children:["Ã–","zellikler"]}),[{key:"welcome_screen",label:"KarÅŸÄ±lama EkranÄ±"},{key:"member_screening",label:"Ãœye Tarama"},{key:"discovery",label:"Sunucu KeÅŸfet"}].map(s=>e.jsxs("label",{className:"feature-item",children:[e.jsx("span",{children:s.label}),e.jsx("input",{type:"checkbox",checked:n.features?.[s.key],onChange:l(a=>i(r=>({...r,features:{...r.features,[s.key]:a.target.checked}})),"onChange")})]},s.key))]})]}),"GeneralSettings"),J=l(({rules:n,onAdd:i,onUpdate:c,onRemove:s})=>e.jsxs("div",{className:"settings-tab",children:[e.jsxs("div",{className:"tab-header",children:[e.jsxs("h4",{children:["Sunucu Kurallar","Ä±"]}),e.jsx("button",{className:"add-btn",onClick:i,children:"+ Kural Ekle"})]}),n.length===0?e.jsxs("div",{className:"empty-rules",children:[e.jsx($,{}),e.jsxs("p",{children:["Hen","Ã¼","z kural eklenmemi","ÅŸ"]})]}):e.jsx("div",{className:"rules-list",children:n.map((a,r)=>e.jsxs("div",{className:"rule-item",children:[e.jsx("span",{className:"rule-number",children:r+1}),e.jsxs("div",{className:"rule-content",children:[e.jsx("input",{type:"text",placeholder:"Kural baÅŸlÄ±ÄŸÄ±...",value:a.title,onChange:l(o=>c(a.id,"title",o.target.value),"onChange")}),e.jsx("textarea",{placeholder:"Kural aÃ§Ä±klamasÄ±...",value:a.description,onChange:l(o=>c(a.id,"description",o.target.value),"onChange"),rows:"2"})]}),e.jsx("button",{className:"remove-btn",onClick:l(()=>s(a.id),"onClick"),children:e.jsx(j,{})})]},a.id))})]}),"RulesSettings"),M=l(({questions:n,onAdd:i,onUpdate:c,onRemove:s})=>e.jsxs("div",{className:"settings-tab",children:[e.jsxs("div",{className:"tab-header",children:[e.jsxs("h4",{children:["Ãœ","ye Tarama Sorular","Ä±"]}),e.jsx("button",{className:"add-btn",onClick:i,children:"+ Soru Ekle"})]}),e.jsxs("p",{className:"tab-description",children:["Yeni ","Ã¼","yeler sunucuya kat","Ä±","lmadan ","Ã¶","nce bu sorular","Ä±"," yan","Ä±","tlamal","Ä±","d","Ä±","r."]}),n.length===0?e.jsxs("div",{className:"empty-rules",children:[e.jsx(z,{}),e.jsxs("p",{children:["Hen","Ã¼","z soru eklenmemi","ÅŸ"]})]}):e.jsx("div",{className:"questions-list",children:n.map((a,r)=>e.jsxs("div",{className:"question-item",children:[e.jsx("span",{className:"question-number",children:r+1}),e.jsxs("div",{className:"question-content",children:[e.jsx("input",{type:"text",placeholder:"Soruyu yazÄ±n...",value:a.question,onChange:l(o=>c(a.id,"question",o.target.value),"onChange")}),e.jsxs("label",{className:"required-toggle",children:[e.jsx("input",{type:"checkbox",checked:a.required,onChange:l(o=>c(a.id,"required",o.target.checked),"onChange")}),e.jsx("span",{children:"Zorunlu"})]})]}),e.jsx("button",{className:"remove-btn",onClick:l(()=>s(a.id),"onClick"),children:e.jsx(j,{})})]},a.id))})]}),"ScreeningSettings"),Z=l(({settings:n,setSettings:i,verificationLevels:c,contentFilters:s})=>e.jsxs("div",{className:"settings-tab",children:[e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:[e.jsx(f,{})," Do","ÄŸ","rulama Seviyesi"]}),e.jsx("div",{className:"level-options",children:c.map(a=>e.jsxs("label",{className:`level-option ${n.verification_level===a.value?"selected":""}`,children:[e.jsx("input",{type:"radio",name:"verification",value:a.value,checked:n.verification_level===a.value,onChange:l(r=>i(o=>({...o,verification_level:r.target.value})),"onChange")}),e.jsxs("div",{className:"level-info",children:[e.jsx("span",{className:"level-label",children:a.label}),e.jsx("span",{className:"level-desc",children:a.description})]})]},a.value))})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:[e.jsx(I,{})," ","Ä°Ã§","erik Filtresi"]}),e.jsx("div",{className:"level-options",children:s.map(a=>e.jsxs("label",{className:`level-option ${n.explicit_content_filter===a.value?"selected":""}`,children:[e.jsx("input",{type:"radio",name:"content-filter",value:a.value,checked:n.explicit_content_filter===a.value,onChange:l(r=>i(o=>({...o,explicit_content_filter:r.target.value})),"onChange")}),e.jsxs("div",{className:"level-info",children:[e.jsx("span",{className:"level-label",children:a.label}),e.jsx("span",{className:"level-desc",children:a.description})]})]},a.value))})]})]}),"SafetySettings"),W=[{key:"general",label:"Genel",Icon:O},{key:"rules",label:"Kurallar",Icon:k},{key:"screening",label:"Ãœye Tarama",Icon:Y},{key:"safety",label:"GÃ¼venlik",Icon:f}],xe=l(({apiBaseUrl:n,serverId:i,onClose:c})=>{const s=B(n,i);return s.loading?e.jsx("div",{className:"community-settings-overlay",onClick:c,children:e.jsx("div",{className:"community-settings-panel",onClick:l(a=>a.stopPropagation(),"onClick"),children:e.jsxs("div",{className:"loading",children:["Y","Ã¼","kleniyor..."]})})}):e.jsx("div",{className:"community-settings-overlay",onClick:c,children:e.jsxs("div",{className:"community-settings-panel",onClick:l(a=>a.stopPropagation(),"onClick"),children:[e.jsxs("div",{className:"panel-header",children:[e.jsxs("h2",{children:[e.jsx(L,{})," Topluluk Ayarlar","Ä±"]}),e.jsx("button",{className:"close-btn",onClick:c,children:e.jsx(j,{})})]}),e.jsxs("div",{className:"community-toggle",children:[e.jsxs("div",{className:"toggle-info",children:[e.jsx("span",{className:"toggle-label",children:"Topluluk Sunucusu"}),e.jsxs("span",{className:"toggle-description",children:["Topluluk ","Ã¶","zelliklerini aktifle","ÅŸ","tir (ke","ÅŸ","fet, kar","ÅŸÄ±","lama ekran","Ä±"," vb.)"]})]}),e.jsx("button",{className:`toggle-btn ${s.settings.is_community?"active":""}`,onClick:l(()=>s.setSettings(a=>({...a,is_community:!a.is_community})),"onClick"),children:s.settings.is_community?e.jsx(D,{}):e.jsx(G,{})})]}),e.jsx("div",{className:"tabs",children:W.map(({key:a,label:r,Icon:o})=>e.jsxs("button",{className:`tab ${s.activeTab===a?"active":""}`,onClick:l(()=>s.setActiveTab(a),"onClick"),children:[e.jsx(o,{})," ",r]},a))}),e.jsxs("div",{className:"panel-content",children:[s.activeTab==="general"&&e.jsx(U,{settings:s.settings,setSettings:s.setSettings,channels:s.channels}),s.activeTab==="rules"&&e.jsx(J,{rules:s.rules,onAdd:s.addRule,onUpdate:s.updateRule,onRemove:s.removeRule}),s.activeTab==="screening"&&e.jsx(M,{questions:s.screeningQuestions,onAdd:s.addQuestion,onUpdate:s.updateQuestion,onRemove:s.removeQuestion}),s.activeTab==="safety"&&e.jsx(Z,{settings:s.settings,setSettings:s.setSettings,verificationLevels:P,contentFilters:V})]}),e.jsxs("div",{className:"panel-footer",children:[e.jsxs("button",{className:"cancel-btn",onClick:c,children:["Ä°","ptal"]}),e.jsxs("button",{className:"save-btn",onClick:s.saveSettings,disabled:s.saving,children:[e.jsx(q,{})," ",s.saving?"Kaydediliyor...":"Kaydet"]})]})]})})},"CommunitySettingsPanel");export{xe as default};
