import{r}from"./react-core-B6hadH-M.js";import{t as i}from"./index-D_6pZib5.js";const z=({apiBaseUrl:p,onClose:R})=>{const[l,N]=r.useState([]),[y,v]=r.useState(!0),[t,m]=r.useState("all"),[B,k]=r.useState(null);r.useEffect(()=>{f()},[]);const f=async()=>{try{v(!0);const e=localStorage.getItem("access_token"),a=await fetch(`${p}/reports/list/`,{headers:{Authorization:`Bearer ${e}`}});if(a.ok){const c=await a.json();N(c.reports||[])}else i.error("‚ùå ≈ûikayetler y√ºklenemedi")}catch(e){console.error("Fetch reports error:",e),i.error("‚ùå Baƒülantƒ± hatasƒ±")}finally{v(!1)}},o=async(e,a,c="")=>{try{const n=localStorage.getItem("access_token"),d=await fetch(`${p}/reports/handle/${e}/`,{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify({action:a,reason:c})});if(d.ok){const g=await d.json();N(l.map(u=>u.id===e?{...u,status:a==="dismiss"?"dismissed":"resolved",resolution:a}:u)),k(null),i.success(`‚úÖ ${E(a)}`)}else{const g=await d.json();i.error(`‚ùå ${g.error||"ƒ∞≈ülem ba≈üarƒ±sƒ±z"}`)}}catch(n){console.error("Handle report error:",n),i.error("‚ùå Baƒülantƒ± hatasƒ±")}},E=e=>({ban:"Kullanƒ±cƒ± yasaklandƒ±",warn:"Kullanƒ±cƒ± uyarƒ±ldƒ±",delete_message:"Mesaj silindi",dismiss:"≈ûikayet reddedildi"})[e]||"ƒ∞≈ülem tamamlandƒ±",b=l.filter(e=>t==="all"?!0:t==="pending"?e.status==="pending":t==="resolved"?e.status==="resolved":t==="dismissed"?e.status==="dismissed":!0),h=e=>({pending:{label:"Bekliyor",className:"status-pending"},resolved:{label:"√á√∂z√ºld√º",className:"status-resolved"},dismissed:{label:"Reddedildi",className:"status-dismissed"}})[e]||{label:e,className:""},S=e=>({spam:{label:"Spam",className:"severity-low"},harassment:{label:"Taciz",className:"severity-high"},hate_speech:{label:"Nefret S√∂ylemi",className:"severity-critical"},inappropriate:{label:"Uygunsuz ƒ∞√ßerik",className:"severity-medium"},scam:{label:"Dolandƒ±rƒ±cƒ±lƒ±k",className:"severity-high"},other:{label:"Diƒüer",className:"severity-low"}})[e]||{label:e,className:""},w=e=>new Date(e).toLocaleString("tr-TR",{day:"2-digit",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}),s={total:l.length,pending:l.filter(e=>e.status==="pending").length,resolved:l.filter(e=>e.status==="resolved").length,dismissed:l.filter(e=>e.status==="dismissed").length};return React.createElement("div",{className:"reports-overlay",onClick:R},React.createElement("div",{className:"reports-panel",onClick:e=>e.stopPropagation()},React.createElement("div",{className:"reports-header"},React.createElement("h2",null,"üö® ≈ûikayet Y√∂netimi"),React.createElement("button",{className:"close-btn",onClick:R},"‚úï")),React.createElement("div",{className:"reports-stats"},React.createElement("div",{className:"stat-item"},React.createElement("span",{className:"stat-value"},s.total),React.createElement("span",{className:"stat-label"},"Toplam")),React.createElement("div",{className:"stat-item pending"},React.createElement("span",{className:"stat-value"},s.pending),React.createElement("span",{className:"stat-label"},"Bekliyor")),React.createElement("div",{className:"stat-item resolved"},React.createElement("span",{className:"stat-value"},s.resolved),React.createElement("span",{className:"stat-label"},"√á√∂z√ºld√º")),React.createElement("div",{className:"stat-item dismissed"},React.createElement("span",{className:"stat-value"},s.dismissed),React.createElement("span",{className:"stat-label"},"Reddedildi"))),React.createElement("div",{className:"reports-filters"},React.createElement("button",{className:t==="all"?"active":"",onClick:()=>m("all")},"T√ºm√º (",s.total,")"),React.createElement("button",{className:t==="pending"?"active":"",onClick:()=>m("pending")},"Bekliyor (",s.pending,")"),React.createElement("button",{className:t==="resolved"?"active":"",onClick:()=>m("resolved")},"√á√∂z√ºld√º (",s.resolved,")"),React.createElement("button",{className:t==="dismissed"?"active":"",onClick:()=>m("dismissed")},"Reddedildi (",s.dismissed,")")),React.createElement("div",{className:"reports-content"},y?React.createElement("div",{className:"loading-state"},React.createElement("div",{className:"spinner"}),React.createElement("p",null,"Y√ºkleniyor...")):b.length===0?React.createElement("div",{className:"empty-state"},React.createElement("div",{className:"empty-icon"},"üéâ"),React.createElement("h3",null,"≈ûikayet yok"),React.createElement("p",null,"Bu filtre i√ßin ≈üikayet bulunamadƒ±")):React.createElement("div",{className:"reports-list"},b.map(e=>{const a=h(e.status),c=S(e.reason);return React.createElement("div",{key:e.id,className:"report-card"},React.createElement("div",{className:"report-header"},React.createElement("div",{className:"report-meta"},React.createElement("span",{className:`status-badge ${a.className}`},a.label),React.createElement("span",{className:`severity-badge ${c.className}`},c.label)),React.createElement("span",{className:"report-date"},w(e.created_at))),React.createElement("div",{className:"report-body"},React.createElement("div",{className:"report-info"},React.createElement("div",{className:"info-row"},React.createElement("span",{className:"info-label"},"Bildiren:"),React.createElement("span",{className:"info-value"},"üë§ ",e.reporter_username)),React.createElement("div",{className:"info-row"},React.createElement("span",{className:"info-label"},"Bildirilen:"),React.createElement("span",{className:"info-value"},"‚ö†Ô∏è ",e.reported_user_username)),e.message_content&&React.createElement("div",{className:"info-row"},React.createElement("span",{className:"info-label"},"Mesaj:"),React.createElement("div",{className:"message-preview"},e.message_content))),e.description&&React.createElement("div",{className:"report-description"},React.createElement("strong",null,"A√ßƒ±klama:"),React.createElement("p",null,e.description))),e.status==="pending"?React.createElement("div",{className:"report-actions"},React.createElement("button",{className:"action-btn ban",onClick:()=>{const n=prompt("Yasaklama sebebi:");n&&o(e.id,"ban",n)},title:"Kullanƒ±cƒ±yƒ± Yasakla"},"üö´ Yasakla"),React.createElement("button",{className:"action-btn warn",onClick:()=>o(e.id,"warn","Uyarƒ± verildi"),title:"Kullanƒ±cƒ±yƒ± Uyar"},"‚ö†Ô∏è Uyar"),React.createElement("button",{className:"action-btn delete",onClick:()=>o(e.id,"delete_message","Mesaj silindi"),title:"Mesajƒ± Sil"},"üóëÔ∏è Mesajƒ± Sil"),React.createElement("button",{className:"action-btn dismiss",onClick:()=>o(e.id,"dismiss","Ge√ßersiz ≈üikayet"),title:"≈ûikayeti Reddet"},"‚úï Reddet")):React.createElement("div",{className:"report-resolution"},React.createElement("span",{className:"resolution-label"},"√á√∂z√ºm:"),React.createElement("span",{className:"resolution-value"},E(e.resolution))))})))))};export{z as default};
