{"version":3,"file":"SpotifyIntegrationPanel-Bx1vw9y7.js","sources":["../../../src/components/SpotifyIntegrationPanel.js"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport './SpotifyIntegrationPanel.css';\nimport { FaSpotify, FaPlay, FaPause, FaMusic, FaUnlink, FaCheck, FaTimes } from 'react-icons/fa';\n\nfunction SpotifyIntegrationPanel({ apiBaseUrl, fetchWithAuth }) {\n  const [connected, setConnected] = useState(false);\n  const [currentTrack, setCurrentTrack] = useState(null);\n  const [showActivity, setShowActivity] = useState(true);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n\n  useEffect(() => {\n    checkSpotifyConnection();\n    if (connected) {\n      fetchCurrentTrack();\n      const interval = setInterval(fetchCurrentTrack, 30000); // Update every 30 seconds\n      return () => clearInterval(interval);\n    }\n  }, [connected]);\n\n  const checkSpotifyConnection = async () => {\n    try {\n      const response = await fetchWithAuth(`${apiBaseUrl}/auth/spotify/status/`);\n      if (response.ok) {\n        const data = await response.json();\n        setConnected(data.connected);\n        setShowActivity(data.show_activity);\n      }\n    } catch (err) {\n      console.error('Error checking Spotify connection:', err);\n    }\n  };\n\n  const connectSpotify = async () => {\n    setLoading(true);\n    try {\n      const response = await fetchWithAuth(`${apiBaseUrl}/auth/spotify/start/`);\n      if (response.ok) {\n        const data = await response.json();\n        // Backend returns 'url', not 'auth_url'\n        window.location.href = data.url || data.auth_url;\n      }\n    } catch (err) {\n      setError('Failed to connect: ' + err.message);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const disconnectSpotify = async () => {\n    setLoading(true);\n    try {\n      const response = await fetchWithAuth(`${apiBaseUrl}/auth/spotify/disconnect/`, {\n        method: 'POST'\n      });\n      if (response.ok) {\n        setConnected(false);\n        setCurrentTrack(null);\n        setError('');\n      }\n    } catch (err) {\n      setError('Failed to disconnect: ' + err.message);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const fetchCurrentTrack = async () => {\n    try {\n      const response = await fetchWithAuth(`${apiBaseUrl}/spotify/current-track/`);\n      if (response.ok) {\n        const data = await response.json();\n        setCurrentTrack(data.track);\n      }\n    } catch (err) {\n      console.error('Error fetching current track:', err);\n    }\n  };\n\n  const toggleActivityStatus = async () => {\n    try {\n      const response = await fetchWithAuth(`${apiBaseUrl}/spotify/toggle-activity/`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ show_activity: !showActivity })\n      });\n      if (response.ok) {\n        setShowActivity(!showActivity);\n      }\n    } catch (err) {\n      setError('Failed to toggle activity: ' + err.message);\n    }\n  };\n\n  return (\n    <div className=\"spotify-panel\">\n      <div className=\"spotify-header\">\n        <h2><FaSpotify className=\"spotify-icon\" /> Spotify Integration</h2>\n      </div>\n\n      {error && <div className=\"spotify-error\">{error}</div>}\n\n      {!connected ? (\n        <div className=\"spotify-connect\">\n          <div className=\"spotify-logo-container\">\n            <FaSpotify className=\"spotify-logo\" />\n          </div>\n          <h3>Connect Your Spotify</h3>\n          <p>Share what you're listening to with your friends!</p>\n          <button\n            className=\"connect-btn\"\n            onClick={connectSpotify}\n            disabled={loading}\n          >\n            <FaSpotify /> Connect Spotify\n          </button>\n          <div className=\"spotify-features\">\n            <div className=\"feature-item\">\n              <FaCheck className=\"check-icon\" />\n              <span>Show currently playing track</span>\n            </div>\n            <div className=\"feature-item\">\n              <FaCheck className=\"check-icon\" />\n              <span>Display in your status</span>\n            </div>\n            <div className=\"feature-item\">\n              <FaCheck className=\"check-icon\" />\n              <span>Privacy controls</span>\n            </div>\n          </div>\n        </div>\n      ) : (\n        <div className=\"spotify-connected\">\n          <div className=\"connection-status\">\n            <FaCheck className=\"status-icon\" />\n            <span>Connected to Spotify</span>\n            <button\n              className=\"disconnect-btn\"\n              onClick={disconnectSpotify}\n              disabled={loading}\n            >\n              <FaUnlink /> Disconnect\n            </button>\n          </div>\n\n          <div className=\"activity-toggle\">\n            <label className=\"toggle-label\">\n              <input\n                type=\"checkbox\"\n                checked={showActivity}\n                onChange={toggleActivityStatus}\n              />\n              <span className=\"toggle-slider\"></span>\n              <span className=\"toggle-text\">Show listening activity</span>\n            </label>\n          </div>\n\n          {currentTrack ? (\n            <div className=\"current-track\">\n              <div className=\"track-header\">\n                <FaMusic className=\"music-icon\" />\n                <h3>Now Playing</h3>\n              </div>\n              <div className=\"track-info\">\n                {currentTrack.album_art && (\n                  <img\n                    src={currentTrack.album_art}\n                    alt=\"Album art\"\n                    className=\"album-art\"\n                  />\n                )}\n                <div className=\"track-details\">\n                  <div className=\"track-name\">{currentTrack.name}</div>\n                  <div className=\"track-artist\">{currentTrack.artist}</div>\n                  <div className=\"track-album\">{currentTrack.album}</div>\n                </div>\n                <div className=\"track-status\">\n                  {currentTrack.is_playing ? (\n                    <FaPlay className=\"playing-icon\" />\n                  ) : (\n                    <FaPause className=\"paused-icon\" />\n                  )}\n                </div>\n              </div>\n              <div className=\"track-progress\">\n                <div\n                  className=\"progress-bar\"\n                  style={{ width: `${currentTrack.progress_percent || 0}%` }}\n                ></div>\n              </div>\n            </div>\n          ) : (\n            <div className=\"no-track\">\n              <FaMusic className=\"no-track-icon\" />\n              <p>Not playing anything right now</p>\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default SpotifyIntegrationPanel;\n"],"names":["useState","useEffect","jsxs","jsx"],"mappings":";;;;AAIA,SAAS,wBAAwB,EAAE,YAAY,iBAAiB;AAC9D,QAAM,CAAC,WAAW,YAAY,IAAIA,aAAAA,SAAS,KAAK;AAChD,QAAM,CAAC,cAAc,eAAe,IAAIA,aAAAA,SAAS,IAAI;AACrD,QAAM,CAAC,cAAc,eAAe,IAAIA,aAAAA,SAAS,IAAI;AACrD,QAAM,CAAC,SAAS,UAAU,IAAIA,aAAAA,SAAS,KAAK;AAC5C,QAAM,CAAC,OAAO,QAAQ,IAAIA,aAAAA,SAAS,EAAE;AAErCC,eAAAA,UAAU,MAAM;AACd,2BAAA;AACA,QAAI,WAAW;AACb,wBAAA;AACA,YAAM,WAAW,YAAY,mBAAmB,GAAK;AACrD,aAAO,MAAM,cAAc,QAAQ;AAAA,IACrC;AAAA,EACF,GAAG,CAAC,SAAS,CAAC;AAEd,QAAM,yBAAyB,mCAAY;AACzC,QAAI;AACF,YAAM,WAAW,MAAM,cAAc,GAAG,UAAU,uBAAuB;AACzE,UAAI,SAAS,IAAI;AACf,cAAM,OAAO,MAAM,SAAS,KAAA;AAC5B,qBAAa,KAAK,SAAS;AAC3B,wBAAgB,KAAK,aAAa;AAAA,MACpC;AAAA,IACF,SAAS,KAAK;AACZ,cAAQ,MAAM,sCAAsC,GAAG;AAAA,IACzD;AAAA,EACF,GAX+B;AAa/B,QAAM,iBAAiB,mCAAY;AACjC,eAAW,IAAI;AACf,QAAI;AACF,YAAM,WAAW,MAAM,cAAc,GAAG,UAAU,sBAAsB;AACxE,UAAI,SAAS,IAAI;AACf,cAAM,OAAO,MAAM,SAAS,KAAA;AAE5B,eAAO,SAAS,OAAO,KAAK,OAAO,KAAK;AAAA,MAC1C;AAAA,IACF,SAAS,KAAK;AACZ,eAAS,wBAAwB,IAAI,OAAO;AAAA,IAC9C,UAAA;AACE,iBAAW,KAAK;AAAA,IAClB;AAAA,EACF,GAduB;AAgBvB,QAAM,oBAAoB,mCAAY;AACpC,eAAW,IAAI;AACf,QAAI;AACF,YAAM,WAAW,MAAM,cAAc,GAAG,UAAU,6BAA6B;AAAA,QAC7E,QAAQ;AAAA,MAAA,CACT;AACD,UAAI,SAAS,IAAI;AACf,qBAAa,KAAK;AAClB,wBAAgB,IAAI;AACpB,iBAAS,EAAE;AAAA,MACb;AAAA,IACF,SAAS,KAAK;AACZ,eAAS,2BAA2B,IAAI,OAAO;AAAA,IACjD,UAAA;AACE,iBAAW,KAAK;AAAA,IAClB;AAAA,EACF,GAhB0B;AAkB1B,QAAM,oBAAoB,mCAAY;AACpC,QAAI;AACF,YAAM,WAAW,MAAM,cAAc,GAAG,UAAU,yBAAyB;AAC3E,UAAI,SAAS,IAAI;AACf,cAAM,OAAO,MAAM,SAAS,KAAA;AAC5B,wBAAgB,KAAK,KAAK;AAAA,MAC5B;AAAA,IACF,SAAS,KAAK;AACZ,cAAQ,MAAM,iCAAiC,GAAG;AAAA,IACpD;AAAA,EACF,GAV0B;AAY1B,QAAM,uBAAuB,mCAAY;AACvC,QAAI;AACF,YAAM,WAAW,MAAM,cAAc,GAAG,UAAU,6BAA6B;AAAA,QAC7E,QAAQ;AAAA,QACR,SAAS,EAAE,gBAAgB,mBAAA;AAAA,QAC3B,MAAM,KAAK,UAAU,EAAE,eAAe,CAAC,cAAc;AAAA,MAAA,CACtD;AACD,UAAI,SAAS,IAAI;AACf,wBAAgB,CAAC,YAAY;AAAA,MAC/B;AAAA,IACF,SAAS,KAAK;AACZ,eAAS,gCAAgC,IAAI,OAAO;AAAA,IACtD;AAAA,EACF,GAb6B;AAe7B,SACEC,kCAAAA,KAAC,OAAA,EAAI,WAAU,iBACb,UAAA;AAAA,IAAAC,sCAAC,OAAA,EAAI,WAAU,kBACb,UAAAD,kCAAAA,KAAC,MAAA,EAAG,UAAA;AAAA,MAAAC,kCAAAA,IAAC,WAAA,EAAU,WAAU,eAAA,CAAe;AAAA,MAAE;AAAA,IAAA,EAAA,CAAoB,EAAA,CAChE;AAAA,IAEC,SAASA,kCAAAA,IAAC,OAAA,EAAI,WAAU,iBAAiB,UAAA,OAAM;AAAA,IAE/C,CAAC,YACAD,kCAAAA,KAAC,OAAA,EAAI,WAAU,mBACb,UAAA;AAAA,MAAAC,kCAAAA,IAAC,SAAI,WAAU,0BACb,gDAAC,WAAA,EAAU,WAAU,gBAAe,EAAA,CACtC;AAAA,MACAA,kCAAAA,IAAC,QAAG,UAAA,uBAAA,CAAoB;AAAA,MACxBA,kCAAAA,IAAC,OAAE,UAAA,oDAAA,CAAiD;AAAA,MACpDD,kCAAAA;AAAAA,QAAC;AAAA,QAAA;AAAA,UACC,WAAU;AAAA,UACV,SAAS;AAAA,UACT,UAAU;AAAA,UAEV,UAAA;AAAA,YAAAC,kCAAAA,IAAC,WAAA,EAAU;AAAA,YAAE;AAAA,UAAA;AAAA,QAAA;AAAA,MAAA;AAAA,MAEfD,kCAAAA,KAAC,OAAA,EAAI,WAAU,oBACb,UAAA;AAAA,QAAAA,kCAAAA,KAAC,OAAA,EAAI,WAAU,gBACb,UAAA;AAAA,UAAAC,kCAAAA,IAAC,SAAA,EAAQ,WAAU,aAAA,CAAa;AAAA,UAChCA,kCAAAA,IAAC,UAAK,UAAA,+BAAA,CAA4B;AAAA,QAAA,GACpC;AAAA,QACAD,kCAAAA,KAAC,OAAA,EAAI,WAAU,gBACb,UAAA;AAAA,UAAAC,kCAAAA,IAAC,SAAA,EAAQ,WAAU,aAAA,CAAa;AAAA,UAChCA,kCAAAA,IAAC,UAAK,UAAA,yBAAA,CAAsB;AAAA,QAAA,GAC9B;AAAA,QACAD,kCAAAA,KAAC,OAAA,EAAI,WAAU,gBACb,UAAA;AAAA,UAAAC,kCAAAA,IAAC,SAAA,EAAQ,WAAU,aAAA,CAAa;AAAA,UAChCA,kCAAAA,IAAC,UAAK,UAAA,mBAAA,CAAgB;AAAA,QAAA,EAAA,CACxB;AAAA,MAAA,EAAA,CACF;AAAA,IAAA,EAAA,CACF,IAEAD,kCAAAA,KAAC,OAAA,EAAI,WAAU,qBACb,UAAA;AAAA,MAAAA,kCAAAA,KAAC,OAAA,EAAI,WAAU,qBACb,UAAA;AAAA,QAAAC,kCAAAA,IAAC,SAAA,EAAQ,WAAU,cAAA,CAAc;AAAA,QACjCA,kCAAAA,IAAC,UAAK,UAAA,uBAAA,CAAoB;AAAA,QAC1BD,kCAAAA;AAAAA,UAAC;AAAA,UAAA;AAAA,YACC,WAAU;AAAA,YACV,SAAS;AAAA,YACT,UAAU;AAAA,YAEV,UAAA;AAAA,cAAAC,kCAAAA,IAAC,UAAA,EAAS;AAAA,cAAE;AAAA,YAAA;AAAA,UAAA;AAAA,QAAA;AAAA,MACd,GACF;AAAA,4CAEC,OAAA,EAAI,WAAU,mBACb,UAAAD,kCAAAA,KAAC,SAAA,EAAM,WAAU,gBACf,UAAA;AAAA,QAAAC,kCAAAA;AAAAA,UAAC;AAAA,UAAA;AAAA,YACC,MAAK;AAAA,YACL,SAAS;AAAA,YACT,UAAU;AAAA,UAAA;AAAA,QAAA;AAAA,QAEZA,kCAAAA,IAAC,QAAA,EAAK,WAAU,gBAAA,CAAgB;AAAA,QAChCA,kCAAAA,IAAC,QAAA,EAAK,WAAU,eAAc,UAAA,0BAAA,CAAuB;AAAA,MAAA,EAAA,CACvD,EAAA,CACF;AAAA,MAEC,eACCD,kCAAAA,KAAC,OAAA,EAAI,WAAU,iBACb,UAAA;AAAA,QAAAA,kCAAAA,KAAC,OAAA,EAAI,WAAU,gBACb,UAAA;AAAA,UAAAC,kCAAAA,IAAC,SAAA,EAAQ,WAAU,aAAA,CAAa;AAAA,UAChCA,kCAAAA,IAAC,QAAG,UAAA,cAAA,CAAW;AAAA,QAAA,GACjB;AAAA,QACAD,kCAAAA,KAAC,OAAA,EAAI,WAAU,cACZ,UAAA;AAAA,UAAA,aAAa,aACZC,kCAAAA;AAAAA,YAAC;AAAA,YAAA;AAAA,cACC,KAAK,aAAa;AAAA,cAClB,KAAI;AAAA,cACJ,WAAU;AAAA,YAAA;AAAA,UAAA;AAAA,UAGdD,kCAAAA,KAAC,OAAA,EAAI,WAAU,iBACb,UAAA;AAAA,YAAAC,kCAAAA,IAAC,OAAA,EAAI,WAAU,cAAc,UAAA,aAAa,MAAK;AAAA,YAC/CA,kCAAAA,IAAC,OAAA,EAAI,WAAU,gBAAgB,uBAAa,QAAO;AAAA,YACnDA,kCAAAA,IAAC,OAAA,EAAI,WAAU,eAAe,uBAAa,MAAA,CAAM;AAAA,UAAA,GACnD;AAAA,UACAA,sCAAC,OAAA,EAAI,WAAU,gBACZ,uBAAa,aACZA,sCAAC,QAAA,EAAO,WAAU,gBAAe,IAEjCA,kCAAAA,IAAC,SAAA,EAAQ,WAAU,eAAc,EAAA,CAErC;AAAA,QAAA,GACF;AAAA,QACAA,kCAAAA,IAAC,OAAA,EAAI,WAAU,kBACb,UAAAA,kCAAAA;AAAAA,UAAC;AAAA,UAAA;AAAA,YACC,WAAU;AAAA,YACV,OAAO,EAAE,OAAO,GAAG,aAAa,oBAAoB,CAAC,IAAA;AAAA,UAAI;AAAA,QAAA,EAC1D,CACH;AAAA,MAAA,EAAA,CACF,IAEAD,kCAAAA,KAAC,OAAA,EAAI,WAAU,YACb,UAAA;AAAA,QAAAC,kCAAAA,IAAC,SAAA,EAAQ,WAAU,gBAAA,CAAgB;AAAA,QACnCA,kCAAAA,IAAC,OAAE,UAAA,iCAAA,CAA8B;AAAA,MAAA,EAAA,CACnC;AAAA,IAAA,EAAA,CAEJ;AAAA,EAAA,GAEJ;AAEJ;AArMS;"}