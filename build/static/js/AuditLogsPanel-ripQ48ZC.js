import{r as o,c9 as g,d as e}from"./react-core-DrOm_csO.js";import{g as L}from"./index-DmEhdEtw.js";const R=({serverId:c,onClose:v})=>{const[m,b]=o.useState([]),[l,s]=o.useState({action_type:"",user_id:"",target_user_id:"",channel_id:"",start_date:"",end_date:""}),[d,h]=o.useState(!0),[u,p]=o.useState(1),[y,N]=o.useState(!0),f=L();o.useEffect(()=>{c&&k()},[c,u]);const k=async()=>{h(!0);try{const t=localStorage.getItem("access_token"),n=new URLSearchParams({page:u,...Object.fromEntries(Object.entries(l).filter(([a,i])=>i!==""))}),r=await fetch(`${f}/audit-logs/server/${c}/?${n}`,{headers:{Authorization:`Bearer ${t}`}});if(r.ok){const a=await r.json();b(u===1?a.logs||[]:[...m,...a.logs||[]]),N(a.has_more||!1)}}catch(t){console.error("Error fetching audit logs:",t),g.error("âŒ Audit loglarÄ± yÃ¼klenemedi")}finally{h(!1)}},j=()=>{p(1),k()},S=()=>{s({action_type:"",user_id:"",target_user_id:"",channel_id:"",start_date:"",end_date:""}),p(1)},w=async()=>{try{const t=localStorage.getItem("access_token"),n=new URLSearchParams({...Object.fromEntries(Object.entries(l).filter(([a,i])=>i!==""))}),r=await fetch(`${f}/audit-logs/server/${c}/export/?${n}`,{headers:{Authorization:`Bearer ${t}`}});if(r.ok){const a=await r.blob(),i=window.URL.createObjectURL(a),_=document.createElement("a");_.href=i,_.download=`audit_logs_${c}.csv`,_.click(),g.success("âœ… Audit loglarÄ± dÄ±ÅŸa aktarÄ±ldÄ±")}}catch(t){console.error("Error exporting logs:",t),g.error("âŒ DÄ±ÅŸa aktarma baÅŸarÄ±sÄ±z")}},A=t=>({message_delete:"ğŸ—‘ï¸",message_edit:"âœï¸",member_join:"ğŸ‘‹",member_leave:"ğŸ‘‹",member_kick:"ğŸš«",member_ban:"ğŸ”¨",member_unban:"âœ…",role_create:"ğŸ­",role_delete:"ğŸ—‘ï¸",role_update:"ğŸ¨",role_assign:"â­",role_remove:"â–",channel_create:"â•",channel_delete:"âŒ",channel_update:"ğŸ”§",server_update:"âš™ï¸",invite_create:"ğŸ”—",webhook_create:"ğŸ¤–",webhook_delete:"ğŸ—‘ï¸",emoji_create:"ğŸ˜€",emoji_delete:"ğŸ˜¢",pin_add:"ğŸ“Œ",pin_remove:"ğŸ“Œ",reaction_add:"â¤ï¸",reaction_remove:"ğŸ’”"})[t]||"ğŸ“",E=t=>t.includes("delete")||t.includes("remove")||t.includes("kick")||t.includes("ban")?"#ef4444":t.includes("create")||t.includes("add")||t.includes("join")?"#10b981":t.includes("edit")||t.includes("update")?"#f59e0b":"#6366f1",$=t=>{const n=new Date(t),a=Math.floor((new Date-n)/1e3);return a<60?"Az Ã¶nce":a<3600?`${Math.floor(a/60)} dakika Ã¶nce`:a<86400?`${Math.floor(a/3600)} saat Ã¶nce`:a<604800?`${Math.floor(a/86400)} gÃ¼n Ã¶nce`:n.toLocaleDateString("tr-TR",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})};return e.createElement("div",{className:"audit-logs-overlay",onClick:v},e.createElement("div",{className:"audit-logs-panel",onClick:t=>t.stopPropagation()},e.createElement("div",{className:"audit-header"},e.createElement("h2",null,"ğŸ“‹ Audit Logs"),e.createElement("button",{className:"close-btn",onClick:v},"Ã—")),e.createElement("div",{className:"filters-section"},e.createElement("div",{className:"filter-grid"},e.createElement("div",{className:"filter-group"},e.createElement("label",null,"Aksiyon TÃ¼rÃ¼"),e.createElement("select",{value:l.action_type,onChange:t=>s({...l,action_type:t.target.value})},e.createElement("option",{value:""},"TÃ¼mÃ¼"),e.createElement("optgroup",{label:"Mesajlar"},e.createElement("option",{value:"message_delete"},"Mesaj Silme"),e.createElement("option",{value:"message_edit"},"Mesaj DÃ¼zenleme"),e.createElement("option",{value:"pin_add"},"Pin Ekleme"),e.createElement("option",{value:"pin_remove"},"Pin KaldÄ±rma")),e.createElement("optgroup",{label:"Ãœyeler"},e.createElement("option",{value:"member_join"},"Ãœye KatÄ±ldÄ±"),e.createElement("option",{value:"member_leave"},"Ãœye AyrÄ±ldÄ±"),e.createElement("option",{value:"member_kick"},"Ãœye AtÄ±ldÄ±"),e.createElement("option",{value:"member_ban"},"Ãœye BanlandÄ±"),e.createElement("option",{value:"member_unban"},"Ban KaldÄ±rÄ±ldÄ±")),e.createElement("optgroup",{label:"Roller"},e.createElement("option",{value:"role_create"},"Rol OluÅŸturma"),e.createElement("option",{value:"role_delete"},"Rol Silme"),e.createElement("option",{value:"role_update"},"Rol GÃ¼ncelleme"),e.createElement("option",{value:"role_assign"},"Rol Atama"),e.createElement("option",{value:"role_remove"},"Rol KaldÄ±rma")),e.createElement("optgroup",{label:"Kanallar"},e.createElement("option",{value:"channel_create"},"Kanal OluÅŸturma"),e.createElement("option",{value:"channel_delete"},"Kanal Silme"),e.createElement("option",{value:"channel_update"},"Kanal GÃ¼ncelleme")),e.createElement("optgroup",{label:"DiÄŸer"},e.createElement("option",{value:"server_update"},"Sunucu GÃ¼ncelleme"),e.createElement("option",{value:"invite_create"},"Davet OluÅŸturma"),e.createElement("option",{value:"webhook_create"},"Webhook OluÅŸturma"),e.createElement("option",{value:"webhook_delete"},"Webhook Silme"),e.createElement("option",{value:"emoji_create"},"Emoji Ekleme"),e.createElement("option",{value:"emoji_delete"},"Emoji Silme")))),e.createElement("div",{className:"filter-group"},e.createElement("label",null,"BaÅŸlangÄ±Ã§ Tarihi"),e.createElement("input",{type:"datetime-local",value:l.start_date,onChange:t=>s({...l,start_date:t.target.value})})),e.createElement("div",{className:"filter-group"},e.createElement("label",null,"BitiÅŸ Tarihi"),e.createElement("input",{type:"datetime-local",value:l.end_date,onChange:t=>s({...l,end_date:t.target.value})})),e.createElement("div",{className:"filter-group"},e.createElement("label",null,"KullanÄ±cÄ± ID"),e.createElement("input",{type:"text",placeholder:"Aksiyon yapan kullanÄ±cÄ±",value:l.user_id,onChange:t=>s({...l,user_id:t.target.value})}))),e.createElement("div",{className:"filter-actions"},e.createElement("button",{className:"filter-btn apply-btn",onClick:j},"ğŸ” Filtrele"),e.createElement("button",{className:"filter-btn clear-btn",onClick:S},"ğŸ—‘ï¸ Temizle"),e.createElement("button",{className:"filter-btn export-btn",onClick:w},"ğŸ“¥ DÄ±ÅŸa Aktar"))),e.createElement("div",{className:"logs-content"},d&&m.length===0?e.createElement("div",{className:"loading-state"},e.createElement("div",{className:"spinner"}),e.createElement("p",null,"Loglar yÃ¼kleniyor...")):m.length===0?e.createElement("div",{className:"empty-state"},e.createElement("span",{className:"empty-icon"},"ğŸ“‹"),e.createElement("p",null,"HenÃ¼z audit log yok"),e.createElement("span",null,"Sunucudaki aksiyonlar burada gÃ¶rÃ¼necek")):e.createElement(e.Fragment,null,e.createElement("div",{className:"logs-list"},m.map(t=>e.createElement("div",{key:t.id,className:"log-entry",style:{borderLeftColor:E(t.action_type)}},e.createElement("div",{className:"log-icon",style:{background:`${E(t.action_type)}20`}},A(t.action_type)),e.createElement("div",{className:"log-details"},e.createElement("div",{className:"log-header-row"},e.createElement("span",{className:"log-action",style:{color:E(t.action_type)}},t.action_display||t.action_type),e.createElement("span",{className:"log-time"},$(t.created_at))),e.createElement("div",{className:"log-description"},t.description||"AÃ§Ä±klama yok"),t.metadata&&Object.keys(t.metadata).length>0&&e.createElement("div",{className:"log-metadata"},Object.entries(t.metadata).map(([n,r])=>e.createElement("div",{key:n,className:"metadata-item"},e.createElement("span",{className:"metadata-key"},n,":"),e.createElement("span",{className:"metadata-value"},JSON.stringify(r))))),e.createElement("div",{className:"log-footer"},t.user&&e.createElement("span",{className:"log-user"},"ğŸ‘¤ ",t.user.username||`User#${t.user.id}`),t.channel&&e.createElement("span",{className:"log-channel"},"ğŸ“¢ #",t.channel.name),t.target_user&&e.createElement("span",{className:"log-target"},"ğŸ¯ ",t.target_user.username)))))),y&&e.createElement("button",{className:"load-more-btn",onClick:()=>p(u+1),disabled:d},d?"â³ YÃ¼kleniyor...":"ğŸ“„ Daha Fazla YÃ¼kle")))))};export{R as default};
