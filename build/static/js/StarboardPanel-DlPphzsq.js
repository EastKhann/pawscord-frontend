import{r as l,n as e}from"./react-core-Cj7FUMmY.js";import{y as o}from"./ui-vendor-EA4dxvko.js";import{g as k}from"./index-BZ0XvVGG.js";import"./editor-vendor-D9c4a6XZ.js";import"./media-vendor-By68PLJG.js";import"./router-vendor-QeioVw-9.js";import"./icons-vendor-TGltgKsJ.js";import"./state-vendor-DGcbxrkI.js";import"./crypto-vendor-DK-7ILyQ.js";const A=({serverId:n,onClose:h})=>{const c=k(),[s,r]=l.useState({enabled:!1,channel_id:"",emoji:"â­",threshold:3,self_star:!1,allow_nsfw:!1}),[i,j]=l.useState([]),[x,p]=l.useState([]),[g,f]=l.useState(!0);l.useEffect(()=>{u(),m(),v()},[n]);const u=async()=>{try{const a=await fetch(`${c}/starboard/server/${n}/config/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(a.ok){const t=await a.json();r(t)}}catch{}finally{f(!1)}},m=async()=>{try{const a=await fetch(`${c}/starboard/server/${n}/messages/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(a.ok){const t=await a.json();j(t)}}catch{}},v=async()=>{try{const a=await fetch(`${c}/channels/server/${n}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(a.ok){const t=await a.json();p(t.filter(d=>d.type==="text"))}}catch{}},b=async()=>{try{(await fetch(`${c}/starboard/server/${n}/config/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`,"Content-Type":"application/json"},body:JSON.stringify(s)})).ok?o.success("âœ… Starboard ayarlarÄ± kaydedildi"):o.error("âŒ Kaydetme hatasÄ±")}catch{o.error("âŒ BaÄŸlantÄ± hatasÄ±")}},N=async a=>{try{(await fetch(`${c}/starboard/message/${a}/remove/`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}})).ok&&(o.success("âœ… Mesaj kaldÄ±rÄ±ldÄ±"),m())}catch{o.error("âŒ Silme hatasÄ±")}};return e.jsx("div",{className:"starboard-overlay",onClick:h,children:e.jsxs("div",{className:"starboard-panel",onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{className:"starboard-header",children:[e.jsx("h2",{children:"â­ Starboard"}),e.jsx("button",{className:"close-btn",onClick:h,children:"Ã—"})]}),e.jsx("div",{className:"starboard-content",children:g?e.jsxs("div",{className:"loading-state",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{children:"YÃ¼kleniyor..."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"config-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h3",{children:"âš™ï¸ Ayarlar"}),e.jsxs("label",{className:"toggle-switch",children:[e.jsx("input",{type:"checkbox",checked:s.enabled,onChange:a=>r({...s,enabled:a.target.checked})}),e.jsx("span",{className:"toggle-slider"})]})]}),e.jsxs("div",{className:"config-grid",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"ğŸ“¢ Starboard KanalÄ±"}),e.jsxs("select",{value:s.channel_id,onChange:a=>r({...s,channel_id:a.target.value}),children:[e.jsx("option",{value:"",children:"SeÃ§in"}),x.map(a=>e.jsxs("option",{value:a.id,children:["# ",a.name]},a.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"â­ Emoji"}),e.jsx("input",{type:"text",value:s.emoji,onChange:a=>r({...s,emoji:a.target.value}),placeholder:"â­"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"ğŸ¯ EÅŸik DeÄŸeri"}),e.jsx("input",{type:"number",min:"1",max:"50",value:s.threshold,onChange:a=>r({...s,threshold:parseInt(a.target.value)})}),e.jsx("small",{children:"MesajÄ±n starboard'a eklenebilmesi iÃ§in gereken minimum yÄ±ldÄ±z sayÄ±sÄ±"})]}),e.jsx("div",{className:"form-group",children:e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:s.self_star,onChange:a=>r({...s,self_star:a.target.checked})}),e.jsx("span",{children:"Kendi mesajÄ±na yÄ±ldÄ±z verebilir"})]})}),e.jsx("div",{className:"form-group",children:e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:s.allow_nsfw,onChange:a=>r({...s,allow_nsfw:a.target.checked})}),e.jsx("span",{children:"NSFW kanallardan izin ver"})]})})]}),e.jsx("button",{className:"save-btn",onClick:b,children:"ğŸ’¾ Kaydet"})]}),e.jsxs("div",{className:"stars-section",children:[e.jsxs("h3",{children:["â­ Starboard MesajlarÄ± (",i.length,")"]}),i.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("span",{className:"empty-icon",children:"â­"}),e.jsx("p",{children:"HenÃ¼z starboard mesajÄ± yok"})]}):e.jsx("div",{className:"stars-list",children:i.map(a=>e.jsxs("div",{className:"star-card",children:[e.jsxs("div",{className:"star-header",children:[e.jsxs("div",{className:"star-author",children:[a.author_avatar?e.jsx("img",{src:a.author_avatar,alt:""}):e.jsx("div",{className:"default-avatar",children:"ğŸ‘¤"}),e.jsx("span",{children:a.author_name})]}),e.jsx("div",{className:"star-count",children:e.jsxs("span",{children:[s.emoji," ",a.star_count]})})]}),e.jsxs("div",{className:"star-content",children:[e.jsx("p",{children:a.content}),a.attachments&&a.attachments.length>0&&e.jsx("div",{className:"star-attachments",children:a.attachments.map((t,d)=>e.jsx("img",{src:t,alt:""},d))})]}),e.jsxs("div",{className:"star-footer",children:[e.jsxs("span",{className:"star-channel",children:["# ",a.channel_name]}),e.jsx("span",{className:"star-time",children:new Date(a.created_at).toLocaleString("tr-TR")}),e.jsx("button",{className:"remove-btn",onClick:()=>N(a.message_id),children:"ğŸ—‘ï¸"})]})]},a.message_id))})]})]})})]})})};export{A as default};
