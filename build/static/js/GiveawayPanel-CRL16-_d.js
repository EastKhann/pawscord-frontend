import{r as s,ch as n}from"./react-core-B6hadH-M.js";import{g as G,h as g}from"./index-D_6pZib5.js";const M=({serverId:i,onClose:E})=>{const c=G(),[p,k]=s.useState([]),[f,N]=s.useState(!0),[y,o]=s.useState(!1),[w,_]=s.useState([]),[b,S]=s.useState([]),[t,r]=s.useState({title:"",description:"",prize:"",channel_id:"",winners_count:1,duration:3600,required_role_id:"",required_messages:0,required_invites:0,allow_multiple_entries:!1});s.useEffect(()=>{m(),z(),$()},[i]);const m=async()=>{try{const e=await fetch(`${c}/giveaways/server/${i}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(e.ok){const a=await e.json();k(a)}}catch(e){console.error("Error fetching giveaways:",e)}finally{N(!1)}},z=async()=>{try{const e=await fetch(`${c}/channels/server/${i}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(e.ok){const a=await e.json();_(a.filter(l=>l.type==="text"))}}catch(e){console.error("Error fetching channels:",e)}},$=async()=>{try{const e=await fetch(`${c}/roles/server/${i}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(e.ok){const a=await e.json();S(a)}}catch(e){console.error("Error fetching roles:",e)}},C=async()=>{if(!t.title||!t.prize||!t.channel_id){n.error("âŒ LÃ¼tfen tÃ¼m gerekli alanlarÄ± doldurun");return}try{(await fetch(`${c}/giveaways/create/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`,"Content-Type":"application/json"},body:JSON.stringify({server_id:i,...t})})).ok?(n.success("âœ… Ã‡ekiliÅŸ oluÅŸturuldu!"),o(!1),m(),r({title:"",description:"",prize:"",channel_id:"",winners_count:1,duration:3600,required_role_id:"",required_messages:0,required_invites:0,allow_multiple_entries:!1})):n.error("âŒ Ã‡ekiliÅŸ oluÅŸturulamadÄ±")}catch(e){console.error("Error creating giveaway:",e),n.error("âŒ BaÄŸlantÄ± hatasÄ±")}},q=async e=>{if(await g("Ã‡ekiliÅŸi sonlandÄ±rmak istediÄŸinize emin misiniz?"))try{const a=await fetch(`${c}/giveaways/${e}/end/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(a.ok){const l=await a.json();n.success(`âœ… Ã‡ekiliÅŸ sonlandÄ±! Kazananlar: ${l.winners.join(", ")}`),m()}else n.error("âŒ Ã‡ekiliÅŸ sonlandÄ±rÄ±lamadÄ±")}catch(a){console.error("Error ending giveaway:",a),n.error("âŒ BaÄŸlantÄ± hatasÄ±")}},B=async e=>{try{const a=await fetch(`${c}/giveaways/${e}/reroll/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(a.ok){const l=await a.json();n.success(`âœ… Yeni kazanan: ${l.new_winner}`),m()}else n.error("âŒ Reroll yapÄ±lamadÄ±")}catch(a){console.error("Error rerolling giveaway:",a),n.error("âŒ BaÄŸlantÄ± hatasÄ±")}},x=async e=>{if(await g("Ã‡ekiliÅŸi silmek istediÄŸinize emin misiniz?"))try{(await fetch(`${c}/giveaways/${e}/delete/`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}})).ok?(n.success("âœ… Ã‡ekiliÅŸ silindi"),m()):n.error("âŒ Ã‡ekiliÅŸ silinemedi")}catch(a){console.error("Error deleting giveaway:",a),n.error("âŒ BaÄŸlantÄ± hatasÄ±")}},R=e=>{const a={active:{text:"Aktif",color:"#10b981"},ended:{text:"SonlandÄ±",color:"#6b7280"},cancelled:{text:"Ä°ptal",color:"#ef4444"}};return a[e]||a.active},A=e=>{const a=new Date,l=new Date(e),d=Math.floor((l-a)/1e3);if(d<=0)return"Sona erdi";const v=Math.floor(d/86400),u=Math.floor(d%86400/3600),h=Math.floor(d%3600/60);return v>0?`${v}g ${u}s kaldÄ±`:u>0?`${u}s ${h}dk kaldÄ±`:`${h} dakika kaldÄ±`};return React.createElement("div",{className:"giveaway-panel-overlay",onClick:E},React.createElement("div",{className:"giveaway-panel",onClick:e=>e.stopPropagation()},React.createElement("div",{className:"giveaway-header"},React.createElement("h2",null,"ğŸ‰ Ã‡ekiliÅŸler"),React.createElement("button",{className:"close-btn",onClick:E},"Ã—")),React.createElement("div",{className:"giveaway-content"},React.createElement("div",{className:"giveaway-actions"},React.createElement("button",{className:"create-giveaway-btn",onClick:()=>o(!0)},"+ Yeni Ã‡ekiliÅŸ OluÅŸtur")),f?React.createElement("div",{className:"loading-state"},React.createElement("div",{className:"spinner"}),React.createElement("p",null,"Ã‡ekiliÅŸler yÃ¼kleniyor...")):p.length===0?React.createElement("div",{className:"empty-state"},React.createElement("span",{className:"empty-icon"},"ğŸ"),React.createElement("p",null,"HenÃ¼z Ã§ekiliÅŸ yok"),React.createElement("span",{className:"empty-hint"},"Yeni bir Ã§ekiliÅŸ oluÅŸturun!")):React.createElement("div",{className:"giveaways-list"},p.map(e=>React.createElement("div",{key:e.id,className:"giveaway-card"},React.createElement("div",{className:"giveaway-card-header"},React.createElement("h3",null,e.title),React.createElement("span",{className:"status-badge",style:{background:R(e.status).color}},R(e.status).text)),React.createElement("div",{className:"giveaway-card-body"},React.createElement("div",{className:"giveaway-prize"},React.createElement("span",{className:"prize-icon"},"ğŸ"),React.createElement("span",{className:"prize-text"},e.prize)),e.description&&React.createElement("p",{className:"giveaway-description"},e.description),React.createElement("div",{className:"giveaway-info"},React.createElement("div",{className:"info-item"},React.createElement("span",{className:"info-label"},"Kazanan SayÄ±sÄ±:"),React.createElement("span",{className:"info-value"},e.winners_count," kiÅŸi")),React.createElement("div",{className:"info-item"},React.createElement("span",{className:"info-label"},"KatÄ±lÄ±mcÄ±lar:"),React.createElement("span",{className:"info-value"},e.entries_count||0," kiÅŸi")),e.status==="active"&&React.createElement("div",{className:"info-item"},React.createElement("span",{className:"info-label"},"Kalan SÃ¼re:"),React.createElement("span",{className:"info-value time-remaining"},A(e.end_time)))),e.required_role_id&&React.createElement("div",{className:"requirement-badge"},"â­ Rol gereksinimi var"),e.required_messages>0&&React.createElement("div",{className:"requirement-badge"},"ğŸ’¬ ",e.required_messages," mesaj gerekli"),e.required_invites>0&&React.createElement("div",{className:"requirement-badge"},"ğŸ‘¥ ",e.required_invites," davet gerekli"),e.winners&&e.winners.length>0&&React.createElement("div",{className:"winners-section"},React.createElement("h4",null,"ğŸ‰ Kazananlar:"),React.createElement("ul",{className:"winners-list"},e.winners.map((a,l)=>React.createElement("li",{key:l},a))))),React.createElement("div",{className:"giveaway-card-footer"},e.status==="active"&&React.createElement("button",{className:"end-btn",onClick:()=>q(e.id)},"ğŸ SonlandÄ±r"),e.status==="ended"&&React.createElement("button",{className:"reroll-btn",onClick:()=>B(e.id)},"ğŸ”„ Reroll"),React.createElement("button",{className:"delete-btn",onClick:()=>x(e.id)},"ğŸ—‘ï¸ Sil")))))),y&&React.createElement("div",{className:"create-modal-overlay",onClick:()=>o(!1)},React.createElement("div",{className:"create-modal",onClick:e=>e.stopPropagation()},React.createElement("div",{className:"modal-header"},React.createElement("h3",null,"Yeni Ã‡ekiliÅŸ OluÅŸtur"),React.createElement("button",{className:"close-btn",onClick:()=>o(!1)},"Ã—")),React.createElement("div",{className:"modal-body"},React.createElement("div",{className:"form-group"},React.createElement("label",null,"BaÅŸlÄ±k *"),React.createElement("input",{type:"text",placeholder:"Discord Nitro Ã‡ekiliÅŸi",value:t.title,onChange:e=>r({...t,title:e.target.value})})),React.createElement("div",{className:"form-group"},React.createElement("label",null,"AÃ§Ä±klama"),React.createElement("textarea",{placeholder:"Ã‡ekiliÅŸ hakkÄ±nda detaylar...",value:t.description,onChange:e=>r({...t,description:e.target.value}),rows:"3"})),React.createElement("div",{className:"form-group"},React.createElement("label",null,"Ã–dÃ¼l *"),React.createElement("input",{type:"text",placeholder:"1 AylÄ±k Discord Nitro",value:t.prize,onChange:e=>r({...t,prize:e.target.value})})),React.createElement("div",{className:"form-row"},React.createElement("div",{className:"form-group"},React.createElement("label",null,"Kanal *"),React.createElement("select",{value:t.channel_id,onChange:e=>r({...t,channel_id:e.target.value})},React.createElement("option",{value:""},"Kanal SeÃ§in"),w.map(e=>React.createElement("option",{key:e.id,value:e.id},"# ",e.name)))),React.createElement("div",{className:"form-group"},React.createElement("label",null,"Kazanan SayÄ±sÄ±"),React.createElement("input",{type:"number",min:"1",max:"100",value:t.winners_count,onChange:e=>r({...t,winners_count:parseInt(e.target.value)})}))),React.createElement("div",{className:"form-group"},React.createElement("label",null,"SÃ¼re"),React.createElement("select",{value:t.duration,onChange:e=>r({...t,duration:parseInt(e.target.value)})},React.createElement("option",{value:"1800"},"30 dakika"),React.createElement("option",{value:"3600"},"1 saat"),React.createElement("option",{value:"10800"},"3 saat"),React.createElement("option",{value:"21600"},"6 saat"),React.createElement("option",{value:"43200"},"12 saat"),React.createElement("option",{value:"86400"},"1 gÃ¼n"),React.createElement("option",{value:"172800"},"2 gÃ¼n"),React.createElement("option",{value:"259200"},"3 gÃ¼n"),React.createElement("option",{value:"604800"},"1 hafta"))),React.createElement("div",{className:"requirements-section"},React.createElement("h4",null,"KatÄ±lÄ±m Gereksinimleri (Opsiyonel)"),React.createElement("div",{className:"form-group"},React.createElement("label",null,"Gerekli Rol"),React.createElement("select",{value:t.required_role_id,onChange:e=>r({...t,required_role_id:e.target.value})},React.createElement("option",{value:""},"Rol yok"),b.map(e=>React.createElement("option",{key:e.id,value:e.id},e.name)))),React.createElement("div",{className:"form-row"},React.createElement("div",{className:"form-group"},React.createElement("label",null,"Minimum Mesaj SayÄ±sÄ±"),React.createElement("input",{type:"number",min:"0",value:t.required_messages,onChange:e=>r({...t,required_messages:parseInt(e.target.value)})})),React.createElement("div",{className:"form-group"},React.createElement("label",null,"Minimum Davet SayÄ±sÄ±"),React.createElement("input",{type:"number",min:"0",value:t.required_invites,onChange:e=>r({...t,required_invites:parseInt(e.target.value)})}))),React.createElement("div",{className:"form-group"},React.createElement("label",{className:"checkbox-label"},React.createElement("input",{type:"checkbox",checked:t.allow_multiple_entries,onChange:e=>r({...t,allow_multiple_entries:e.target.checked})}),React.createElement("span",null,"Birden fazla katÄ±lÄ±ma izin ver"))))),React.createElement("div",{className:"modal-footer"},React.createElement("button",{className:"cancel-btn",onClick:()=>o(!1)},"Ä°ptal"),React.createElement("button",{className:"submit-btn",onClick:C},"ğŸ‰ Ã‡ekiliÅŸ OluÅŸtur"))))))};export{M as default};
