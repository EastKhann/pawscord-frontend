import{r as d,n as e}from"./react-core-zXIKm1Jm.js";import{ar as N,a as D,a1 as L,aa as C,b5 as B,b6 as V,Y as O,aB as R,s as M,aJ as G,ao as J,S as Y,aX as U,aP as H,w as I,p as X,j as q}from"./icons-vendor-BBdoVeJd.js";import{y as j}from"./ui-vendor-BGw4w3Ed.js";import"./editor-vendor-DiU449Dh.js";const ne=({userId:h,onClose:k,onUpdate:K,fetchWithAuth:g,apiBaseUrl:y})=>{const[r,i]=d.useState([]),[S,f]=d.useState(!0),[F,p]=d.useState(!1),[x,b]=d.useState(null),[n,o]=d.useState({type:"game",title:"",description:"",image_url:"",link_url:""}),[Q,Z]=d.useState(null),m=[{key:"game",label:"Oyun",icon:e.jsx(J,{}),color:"#9c27b0"},{key:"achievement",label:"Başarı",icon:e.jsx(Y,{}),color:"#ffc107"},{key:"art",label:"Sanat",icon:e.jsx(U,{}),color:"#e91e63"},{key:"music",label:"Müzik",icon:e.jsx(H,{}),color:"#00bcd4"},{key:"video",label:"Video",icon:e.jsx(I,{}),color:"#f44336"},{key:"code",label:"Proje",icon:e.jsx(X,{}),color:"#4caf50"},{key:"link",label:"Link",icon:e.jsx(q,{}),color:"#2196f3"}];d.useEffect(()=>{E()},[h]);const E=async()=>{f(!0);try{const s=await g(`${y}/users/${h}/showcase/`);if(s.ok){const a=await s.json();i(a.items||[])}else i([])}catch(s){console.error("Error fetching showcases:",s),i([])}f(!1)},_=async()=>{if(!n.title.trim()){j.error("Başlık gerekli");return}const s={id:Date.now(),...n,order:r.length};try{await g(`${y}/users/${h}/showcase/`,{method:"POST",headers:{Authorization:`Bearer ${token}`,"Content-Type":"application/json"},body:JSON.stringify(s)})}catch(a){console.error("Add showcase error:",a)}i([...r,s]),u(),j.success("Vitrin öğesi eklendi")},$=async()=>{if(!(!n.title.trim()||!x)){try{await fetch(`/api/users/${h}/showcase/${x.id}/`,{method:"PATCH",headers:{Authorization:`Bearer ${token}`,"Content-Type":"application/json"},body:JSON.stringify(n)})}catch(s){console.error("Edit showcase error:",s)}i(r.map(s=>s.id===x.id?{...s,...n}:s)),u(),j.success("Vitrin öğesi güncellendi")}},T=async s=>{if(window.confirm("Bu öğeyi silmek istediğinizden emin misiniz?")){try{await fetch(`/api/users/${h}/showcase/${s}/`,{method:"DELETE",headers:{Authorization:`Bearer ${token}`}})}catch(a){console.error("Delete showcase error:",a)}i(r.filter(a=>a.id!==s)),j.success("Vitrin öğesi silindi")}},w=async(s,a)=>{const l=r.findIndex(c=>c.id===s);if(a==="up"&&l===0||a==="down"&&l===r.length-1)return;const t=[...r],v=a==="up"?l-1:l+1;[t[l],t[v]]=[t[v],t[l]],t.forEach((c,P)=>c.order=P),i(t);try{await fetch(`/api/users/${h}/showcase/reorder/`,{method:"POST",headers:{Authorization:`Bearer ${token}`,"Content-Type":"application/json"},body:JSON.stringify({order:t.map(c=>c.id)})})}catch(c){console.error("Reorder showcase error:",c)}},u=()=>{o({type:"game",title:"",description:"",image_url:"",link_url:""}),p(!1),b(null)},z=s=>{b(s),o({type:s.type,title:s.title,description:s.description||"",image_url:s.image_url||"",link_url:s.link_url||""}),p(!0)},A=s=>m.find(a=>a.key===s)||m[0];return e.jsx("div",{className:"showcase-overlay",onClick:s=>s.target.className==="showcase-overlay"&&k(),children:e.jsxs("div",{className:"showcase-panel",children:[e.jsxs("div",{className:"panel-header",children:[e.jsxs("h2",{children:[e.jsx(N,{})," Profil Vitrini"]}),e.jsx("button",{className:"close-btn",onClick:k,children:e.jsx(D,{})})]}),e.jsxs("div",{className:"panel-info",children:[e.jsx(L,{}),e.jsx("p",{children:"Profilinizde gösterilecek en fazla 6 öğe seçebilirsiniz"})]}),e.jsx("div",{className:"showcase-list",children:S?e.jsx("div",{className:"loading",children:"Yükleniyor..."}):r.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx(N,{}),e.jsx("p",{children:"Henüz vitrin öğesi yok"}),e.jsxs("button",{onClick:()=>p(!0),children:[e.jsx(C,{})," İlk Öğeyi Ekle"]})]}):r.map((s,a)=>{const l=A(s.type);return e.jsxs("div",{className:"showcase-item",children:[e.jsxs("div",{className:"item-drag",children:[e.jsx("button",{onClick:()=>w(s.id,"up"),disabled:a===0,children:e.jsx(B,{})}),e.jsx("button",{onClick:()=>w(s.id,"down"),disabled:a===r.length-1,children:e.jsx(V,{})})]}),e.jsx("div",{className:"item-icon",style:{background:l.color},children:l.icon}),s.image_url&&e.jsx("div",{className:"item-image",children:e.jsx("img",{src:s.image_url,alt:s.title})}),e.jsxs("div",{className:"item-info",children:[e.jsx("span",{className:"item-type",children:l.label}),e.jsx("h4",{children:s.title}),s.description&&e.jsx("p",{children:s.description}),s.link_url&&e.jsxs("a",{href:s.link_url,target:"_blank",rel:"noopener noreferrer",children:[e.jsx(O,{})," Linke Git"]})]}),e.jsxs("div",{className:"item-actions",children:[e.jsx("button",{onClick:()=>z(s),children:e.jsx(R,{})}),e.jsx("button",{onClick:()=>T(s.id),children:e.jsx(M,{})})]})]},s.id)})}),r.length<6&&r.length>0&&e.jsxs("div",{className:"add-section",children:[e.jsxs("button",{className:"add-btn",onClick:()=>p(!0),children:[e.jsx(C,{})," Yeni Öğe Ekle"]}),e.jsxs("span",{className:"remaining",children:[6-r.length," slot kaldı"]})]}),F&&e.jsx("div",{className:"modal-overlay",onClick:()=>u(),children:e.jsxs("div",{className:"modal-content",onClick:s=>s.stopPropagation(),children:[e.jsx("h3",{children:x?"Öğeyi Düzenle":"Yeni Vitrin Öğesi"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Tür"}),e.jsx("div",{className:"type-selector",children:m.map(s=>e.jsxs("button",{className:`type-btn ${n.type===s.key?"selected":""}`,style:{"--color":s.color},onClick:()=>o({...n,type:s.key}),children:[s.icon,e.jsx("span",{children:s.label})]},s.key))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Başlık *"}),e.jsx("input",{type:"text",placeholder:"Örn: Valorant",value:n.title,onChange:s=>o({...n,title:s.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Açıklama"}),e.jsx("input",{type:"text",placeholder:"Örn: Diamond 3 Rank",value:n.description,onChange:s=>o({...n,description:s.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Görsel URL"}),e.jsx("input",{type:"text",placeholder:"https://...",value:n.image_url,onChange:s=>o({...n,image_url:s.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Link URL"}),e.jsx("input",{type:"text",placeholder:"https://...",value:n.link_url,onChange:s=>o({...n,link_url:s.target.value})})]}),e.jsxs("div",{className:"modal-actions",children:[e.jsx("button",{className:"cancel-btn",onClick:u,children:"İptal"}),e.jsxs("button",{className:"save-btn",onClick:x?$:_,children:[e.jsx(G,{})," ",x?"Güncelle":"Ekle"]})]})]})})]})})};export{ne as default};
