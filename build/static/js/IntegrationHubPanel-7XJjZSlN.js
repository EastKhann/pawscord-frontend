var I=Object.defineProperty;var s=(n,r)=>I(n,"name",{value:r,configurable:!0});import{r as j,j as e}from"./react-core-Djgtqrmb.js";import{cg as L,c0 as D,cv as H,b_ as K,bZ as Y,bX as G,bU as R,bY as J,cw as f,cx as U,a8 as q,aK as V,q as X,b$ as z,a9 as S,c as Z,az as T,j as _,an as $,k as C,a as B,t as Q}from"./icons-vendor-BW7dxHkX.js";import{y as b}from"./ui-vendor-IhB9Znpc.js";import{e as E,c as ee}from"./index-D_luy7FO.js";import"./media-vendor-CxFPycob.js";import"./router-vendor-gmJ9Mn-1.js";import"./state-vendor-BRqaXHJQ.js";import"./crypto-vendor-D1XRGppi.js";const A={github:J,spotify:R,twitch:G,youtube:Y,discord:K,slack:H,google:D,twitter:L},F={github:"#333",spotify:"#1db954",twitch:"#9146ff",youtube:"#ff0000",discord:"#5865f2",slack:"#4a154b",google:"#4285f4",twitter:"#1da1f2"},se=s(n=>{switch(n){case"development":return e.jsx(X,{});case"entertainment":return e.jsx(V,{});case"streaming":return e.jsx(q,{});case"productivity":return e.jsx(U,{});default:return e.jsx(f,{})}},"getCategoryIcon"),ae=s(n=>{const[r,c]=j.useState("connected"),[l,h]=j.useState([]),[u,a]=j.useState([]),[o,t]=j.useState(!0),[m,x]=j.useState(""),[i,N]=j.useState({show:!1,integration:null}),k=localStorage.getItem("access_token");j.useEffect(()=>{y()},[n]);const y=s(async()=>{t(!0);try{const[d,p]=await Promise.all([fetch(`/api/servers/${n}/integrations/`,{headers:{Authorization:`Bearer ${k}`}}),fetch("/api/integrations/available/",{headers:{Authorization:`Bearer ${k}`}})]);if(d.ok){const g=await d.json();h(g.integrations||[])}if(p.ok){const g=await p.json();a(g.integrations||[])}else a([])}catch{a([])}t(!1)},"fetchIntegrations"),w=s(async d=>{try{const p=await fetch(`/api/servers/${n}/integrations/connect/`,{method:"POST",headers:{Authorization:`Bearer ${k}`,"Content-Type":"application/json"},body:JSON.stringify({integration_type:d})});if(p.ok){const g=await p.json();g.oauth_url&&window.open(g.oauth_url,"_blank","width=500,height=600"),b.success(`${d} entegrasyon başlatıldı`),y()}else b.error("Bağlantı başlatılamadı")}catch{b.error("Bağlantı hatası")}},"handleConnect"),v=s(async d=>{if(await E("Bu entegrasyonu kaldırmak istediğinize emin misiniz?"))try{(await fetch(`/api/servers/${n}/integrations/${d}/disconnect/`,{method:"POST",headers:{Authorization:`Bearer ${k}`}})).ok&&(b.success("Entegrasyon kaldırıldı"),y())}catch{b.error("Entegrasyon kaldırılamadı")}},"handleDisconnect"),W=s(async d=>{try{(await fetch(`/api/servers/${n}/integrations/${d}/sync/`,{method:"POST",headers:{Authorization:`Bearer ${k}`}})).ok&&b.success("Senkronizasyon başlatıldı")}catch{b.error("Senkronizasyon başarısız")}},"handleSync"),M=u.filter(d=>d.name.toLowerCase().includes(m.toLowerCase())||d.description.toLowerCase().includes(m.toLowerCase())),O=l.map(d=>d.type),P=M.filter(d=>!O.includes(d.id));return{activeTab:r,setActiveTab:c,integrations:l,notConnected:P,loading:o,searchTerm:m,setSearchTerm:x,configModal:i,setConfigModal:N,token:k,handleConnect:w,handleDisconnect:v,handleSync:W,fetchIntegrations:y}},"useIntegrationHub"),ne=s(({integrations:n,icons:r,colors:c,onDisconnect:l,onSync:h,onConfigure:u})=>n.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx(z,{}),e.jsx("p",{children:"Henüz bağlı entegrasyon yok"}),e.jsx("span",{className:"hint",children:'"Mevcut" sekmesinden entegrasyon ekleyin'})]}):e.jsx("div",{className:"connected-list",children:n.map(a=>{const o=r[a.type]||f,t=c[a.type]||"#666";return e.jsxs("div",{className:"integration-card connected",children:[e.jsx("div",{className:"integration-icon",style:{background:t},children:e.jsx(o,{})}),e.jsxs("div",{className:"integration-info",children:[e.jsx("h4",{children:a.name}),e.jsxs("div",{className:"connection-info",children:[e.jsxs("span",{className:"status connected",children:[e.jsx(S,{})," Bağlı"]}),a.account_name&&e.jsxs("span",{className:"account",children:["@",a.account_name]})]}),e.jsxs("div",{className:"last-sync",children:["Son senkronizasyon: ",a.last_sync||"Hiç"]})]}),e.jsxs("div",{className:"integration-actions",children:[e.jsx("button",{className:"action-btn sync",onClick:s(()=>h(a.id),"onClick"),title:"Senkronize Et",children:e.jsx(Z,{})}),e.jsx("button",{className:"action-btn config",onClick:s(()=>u(a),"onClick"),title:"Ayarlar",children:e.jsx(T,{})}),e.jsx("button",{className:"action-btn disconnect",onClick:s(()=>l(a.id),"onClick"),title:"Bağlantıyı Kes",children:e.jsx(z,{})})]})]},a.id)})}),"ConnectedIntegrations"),te=s(({integrations:n,icons:r,colors:c,getCategoryIcon:l,onConnect:h})=>{const u=[...new Set(n.map(a=>a.category))];return n.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx(f,{}),e.jsx("p",{children:"Tüm entegrasyonlar zaten bağlı"})]}):e.jsx("div",{className:"available-list",children:u.map(a=>e.jsxs("div",{className:"category-section",children:[e.jsxs("h3",{className:"category-title",children:[l(a),a==="development"&&"Geliştirme",a==="entertainment"&&"Eğlence",a==="streaming"&&"Yayın",a==="productivity"&&"Üretkenlik",a==="content"&&"İçerik",a==="social"&&"Sosyal"]}),e.jsx("div",{className:"integrations-grid",children:n.filter(o=>o.category===a).map(o=>{const t=r[o.id]||f,m=c[o.id]||"#666";return e.jsxs("div",{className:"integration-card available",children:[e.jsx("div",{className:"integration-icon",style:{background:m},children:e.jsx(t,{})}),e.jsxs("div",{className:"integration-details",children:[e.jsx("h4",{children:o.name}),e.jsx("p",{children:o.description}),e.jsx("ul",{className:"features",children:o.features?.slice(0,3).map((x,i)=>e.jsxs("li",{children:[e.jsx(S,{})," ",x]},i))})]}),e.jsxs("button",{className:"connect-btn",onClick:s(()=>h(o.id),"onClick"),children:[e.jsx(_,{})," Bağla"]})]},o.id)})})]},a))})},"AvailableIntegrations"),oe=s(({serverId:n,token:r,onClose:c,onCreated:l})=>{const[h,u]=j.useState(""),[a,o]=j.useState(""),[t,m]=j.useState([]);j.useEffect(()=>{fetch(`/api/servers/${n}/channels/`,{headers:{Authorization:`Bearer ${r}`}}).then(i=>i.json()).then(i=>m(i.channels||[])).catch(()=>{})},[]);const x=s(async()=>{if(!h||!a){b.warning("Tüm alanları doldurun");return}try{(await fetch(`/api/servers/${n}/webhooks/`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"},body:JSON.stringify({name:h,channel_id:a})})).ok&&(b.success("Webhook oluşturuldu"),l())}catch{b.error("Webhook oluşturulamadı")}},"handleCreate");return e.jsx("div",{className:"modal-overlay",onClick:s(i=>i.target.className==="modal-overlay"&&c(),"onClick"),children:e.jsxs("div",{className:"webhook-modal",children:[e.jsxs("h3",{children:[e.jsx($,{})," Yeni Webhook Oluştur"]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Webhook Adı"}),e.jsx("input",{type:"text",value:h,onChange:s(i=>u(i.target.value),"onChange"),placeholder:"örn: GitHub Bot"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kanal"}),e.jsxs("select",{value:a,onChange:s(i=>o(i.target.value),"onChange"),children:[e.jsx("option",{value:"",children:"Kanal seçin..."}),t.map(i=>e.jsx("option",{value:i.id,children:i.name},i.id))]})]}),e.jsxs("div",{className:"modal-actions",children:[e.jsx("button",{className:"cancel-btn",onClick:c,children:"İptal"}),e.jsx("button",{className:"create-btn",onClick:x,children:"Oluştur"})]})]})})},"CreateWebhookModal"),ie=s(({serverId:n,token:r})=>{const[c,l]=j.useState([]),[h,u]=j.useState(!1);j.useEffect(()=>{a()},[]);const a=s(async()=>{try{const t=await fetch(`/api/servers/${n}/webhooks/`,{headers:{Authorization:`Bearer ${r}`}});if(t.ok){const m=await t.json();l(m.webhooks||[])}}catch{}},"fetchWebhooks"),o=s(async t=>{if(await E("Bu webhook'u silmek istediğinize emin misiniz?"))try{(await fetch(`/api/servers/${n}/webhooks/${t}/`,{method:"DELETE",headers:{Authorization:`Bearer ${r}`}})).ok&&(b.success("Webhook silindi"),a())}catch{b.error("Webhook silinemedi")}},"handleDeleteWebhook");return e.jsxs("div",{className:"webhooks-view",children:[e.jsxs("div",{className:"webhooks-header",children:[e.jsx("p",{children:"Webhooks ile dış servislerden otomatik mesajlar alın"}),e.jsxs("button",{className:"create-webhook-btn",onClick:s(()=>u(!0),"onClick"),children:[e.jsx($,{})," Yeni Webhook"]})]}),c.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx(C,{}),e.jsx("p",{children:"Henüz webhook oluşturulmamış"})]}):e.jsx("div",{className:"webhooks-list",children:c.map(t=>e.jsxs("div",{className:"webhook-item",children:[e.jsx("div",{className:"webhook-avatar",children:t.avatar?e.jsx("img",{src:t.avatar,alt:""}):e.jsx(C,{})}),e.jsxs("div",{className:"webhook-info",children:[e.jsx("h4",{children:t.name}),e.jsx("span",{className:"webhook-channel",children:t.channel_name}),e.jsxs("div",{className:"webhook-url",children:[e.jsxs("code",{children:[t.url.substring(0,40),"..."]}),e.jsx("button",{onClick:s(()=>{navigator.clipboard.writeText(t.url),b.success("URL kopyalandı")},"onClick"),children:"Kopyala"})]})]}),e.jsx("div",{className:"webhook-actions",children:e.jsx("button",{className:"action-btn delete",onClick:s(()=>o(t.id),"onClick"),children:e.jsx(B,{})})})]},t.id))}),h&&e.jsx(oe,{serverId:n,token:r,onClose:s(()=>u(!1),"onClose"),onCreated:s(()=>{a(),u(!1)},"onCreated")})]})},"WebhooksView"),ce=s(({integration:n,serverId:r,token:c,onClose:l,onSave:h})=>{const{overlayProps:u,dialogProps:a}=ee({onClose:l,label:"Entegrasyon Ayarları"}),[o,t]=j.useState({notifications_enabled:!0,notification_channel:"",auto_sync:!0,sync_interval:30}),m=s(async()=>{try{(await fetch(`/api/servers/${r}/integrations/${n.id}/configure/`,{method:"POST",headers:{Authorization:`Bearer ${c}`,"Content-Type":"application/json"},body:JSON.stringify(o)})).ok&&(b.success("Ayarlar kaydedildi"),h(),l())}catch{b.error("Ayarlar kaydedilemedi")}},"handleSave");return e.jsx("div",{className:"modal-overlay",...u,children:e.jsxs("div",{className:"config-modal",...a,children:[e.jsxs("h3",{children:[e.jsx(T,{})," ",n.name," Ayarları"]}),e.jsx("div",{className:"config-section",children:e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:o.notifications_enabled,onChange:s(x=>t({...o,notifications_enabled:x.target.checked}),"onChange")}),"Bildirimleri Etkinleştir"]})}),e.jsx("div",{className:"config-section",children:e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:o.auto_sync,onChange:s(x=>t({...o,auto_sync:x.target.checked}),"onChange")}),"Otomatik Senkronizasyon"]})}),o.auto_sync&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Senkronizasyon Aralığı (dakika)"}),e.jsx("input",{type:"number",value:o.sync_interval,onChange:s(x=>t({...o,sync_interval:parseInt(x.target.value)}),"onChange"),min:5,max:1440})]}),e.jsxs("div",{className:"modal-actions",children:[e.jsx("button",{className:"cancel-btn",onClick:l,children:"İptal"}),e.jsxs("button",{className:"save-btn",onClick:m,children:[e.jsx(S,{})," Kaydet"]})]})]})})},"ConfigurationModal"),pe=s(({serverId:n,onClose:r})=>{const{activeTab:c,setActiveTab:l,integrations:h,notConnected:u,loading:a,searchTerm:o,setSearchTerm:t,configModal:m,setConfigModal:x,token:i,handleConnect:N,handleDisconnect:k,handleSync:y,fetchIntegrations:w}=ae(n);return e.jsx("div",{className:"integration-hub-overlay",onClick:s(v=>v.target.className==="integration-hub-overlay"&&r(),"onClick"),children:e.jsxs("div",{className:"integration-hub-panel",children:[e.jsxs("div",{className:"panel-header",children:[e.jsxs("h2",{children:[e.jsx(f,{})," Entegrasyon Merkezi"]}),e.jsx("button",{className:"close-btn",onClick:r,children:e.jsx(B,{})})]}),e.jsx("div",{className:"tabs-bar",children:e.jsxs("div",{className:"tabs",children:[e.jsxs("button",{className:`tab ${c==="connected"?"active":""}`,onClick:s(()=>l("connected"),"onClick"),children:[e.jsx(_,{})," Bağlı (",h.length,")"]}),e.jsxs("button",{className:`tab ${c==="available"?"active":""}`,onClick:s(()=>l("available"),"onClick"),children:[e.jsx($,{})," Mevcut (",u.length,")"]}),e.jsxs("button",{className:`tab ${c==="webhooks"?"active":""}`,onClick:s(()=>l("webhooks"),"onClick"),children:[e.jsx(C,{})," Webhooks"]})]})}),c==="available"&&e.jsxs("div",{className:"search-bar",children:[e.jsx(Q,{}),e.jsx("input",{type:"text",placeholder:"Entegrasyon ara...",value:o,onChange:s(v=>t(v.target.value),"onChange")})]}),e.jsx("div",{className:"panel-content",children:a?e.jsx("div",{className:"loading",children:"Yükleniyor..."}):e.jsxs(e.Fragment,{children:[c==="connected"&&e.jsx(ne,{integrations:h,icons:A,colors:F,onDisconnect:k,onSync:y,onConfigure:s(v=>x({show:!0,integration:v}),"onConfigure")}),c==="available"&&e.jsx(te,{integrations:u,icons:A,colors:F,getCategoryIcon:se,onConnect:N}),c==="webhooks"&&e.jsx(ie,{serverId:n,token:i})]})}),m.show&&e.jsx(ce,{integration:m.integration,serverId:n,token:i,onClose:s(()=>x({show:!1,integration:null}),"onClose"),onSave:w})]})})},"IntegrationHubPanel");export{pe as default};
