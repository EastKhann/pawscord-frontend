import{r as s,b as e}from"./react-core-9vc7GIjk.js";import{t as b}from"./index-BmHz9cUO.js";import"./editor-vendor-DiU449Dh.js";import"./media-vendor-B-uSUaIv.js";import"./router-vendor-qCr-Mpaw.js";import"./crypto-vendor-C1qXRpJv.js";import"./icons-vendor-BHKL7tCa.js";import"./state-vendor-0vlBuk0v.js";const q=({onSend:w,onCancel:D})=>{const[n,u]=s.useState(!1),[o,i]=s.useState(!1),[p,l]=s.useState(0),[r,f]=s.useState(null),[m,Y]=s.useState(null),[y,v]=s.useState([]),[T,L]=s.useState(0),[$,g]=s.useState(0),[S,d]=s.useState(0),x=s.useRef(null),C=-80;s.useEffect(()=>{let t;return n&&(t=setInterval(()=>{l(a=>a+1)},1e3)),()=>clearInterval(t)},[n]);const B=async()=>{try{const t=await navigator.mediaDevices.getUserMedia({audio:!0}),a=new MediaRecorder(t),c=[];a.ondataavailable=N=>{c.push(N.data),K()},a.onstop=()=>{const N=new Blob(c,{type:"audio/webm"});f(N),t.getTracks().forEach(W=>W.stop())},a.start(100),Y(a),u(!0),i(!1),l(0)}catch(t){console.error("Microphone access error:",t),b.error("âŒ Mikrofon eriÅŸimi reddedildi")}},I=()=>{m&&n&&(m.stop(),u(!1),i(!1))},E=()=>{m&&n&&m.stop(),u(!1),i(!1),f(null),l(0),v([]),d(0),D?.()},M=t=>{t.preventDefault();const a=t.touches?t.touches[0].clientY:t.clientY;L(a),g(a),d(0),B()},R=t=>{if(!n||o)return;const a=t.touches?t.touches[0].clientY:t.clientY;g(a);const c=a-T;d(c),c<C&&(i(!0),b.success("ðŸ”’ KayÄ±t kilitlendi"))},h=t=>{t.preventDefault(),!o&&n&&(E(),b.info("KayÄ±t iptal edildi")),d(0)},U=()=>{r&&(w?.(r,p),f(null),l(0),v([]))},K=()=>{v(t=>[...t,Math.random()*100].slice(-50))},k=t=>{const a=Math.floor(t/60),c=t%60;return`${a}:${c.toString().padStart(2,"0")}`};return e.createElement("div",{className:"voice-message-container"},!n&&!r&&e.createElement("button",{ref:x,className:"btn-start-recording",onMouseDown:M,onMouseMove:R,onMouseUp:h,onMouseLeave:h,onTouchStart:M,onTouchMove:R,onTouchEnd:h,style:{cursor:"pointer",userSelect:"none",WebkitUserSelect:"none",touchAction:"none"}},e.createElement("span",{className:"mic-icon"},"ðŸŽ¤"),e.createElement("span",null,"BasÄ±lÄ± Tut")),n&&e.createElement("div",{className:"recording-ui"},!o&&e.createElement("div",{className:"swipe-indicator",style:{opacity:Math.max(0,Math.min(1,-S/80)),transform:`translateY(${Math.max(S,-100)}px)`}},e.createElement("div",{className:"lock-icon"},"ðŸ”’"),e.createElement("div",{className:"swipe-text"},"YukarÄ± kaydÄ±r")),o&&e.createElement("div",{className:"locked-indicator"},e.createElement("span",{className:"lock-icon"},"ðŸ”’"),e.createElement("span",null,"Kilitli")),e.createElement("div",{className:"waveform"},y.map((t,a)=>e.createElement("div",{key:a,className:"waveform-bar",style:{height:`${t}%`}}))),e.createElement("div",{className:"recording-info"},e.createElement("span",{className:"recording-indicator"},"ðŸ”´"),e.createElement("span",{className:"recording-time"},k(p))),e.createElement("div",{className:"recording-controls"},e.createElement("button",{className:"btn-cancel",onClick:E},"Ä°ptal"),o&&e.createElement("button",{className:"btn-stop",onClick:I},"Durdur"))),r&&!n&&e.createElement("div",{className:"preview-ui"},e.createElement("audio",{controls:!0,src:URL.createObjectURL(r)}),e.createElement("div",{className:"preview-info"},e.createElement("span",null,"Sesli mesaj â€¢ ",k(p))),e.createElement("div",{className:"preview-controls"},e.createElement("button",{className:"btn-cancel",onClick:E},"Sil"),e.createElement("button",{className:"btn-send",onClick:U},"GÃ¶nder ðŸ“¤"))))};export{q as default};
