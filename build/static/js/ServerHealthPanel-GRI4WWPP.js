var _=Object.defineProperty;var c=(i,o)=>_(i,"name",{value:o,configurable:!0});import{r as t,j as s}from"./react-core-Djgtqrmb.js";import{c as u,c1 as C,z as S,a as F,ax as U,bq as $,u as L,O as j,y as R,c2 as p,bk as q,bg as A,c3 as E,d as m,x as v,w as H}from"./icons-vendor-BW7dxHkX.js";import{g as P}from"./index-BRQzOq3v.js";import"./media-vendor-CxFPycob.js";import"./router-vendor-gmJ9Mn-1.js";import"./state-vendor-BRqaXHJQ.js";import"./crypto-vendor-D1XRGppi.js";import"./ui-vendor-IhB9Znpc.js";const J=c(({onClose:i,fetchWithAuth:o})=>{const[e,d]=t.useState(null),[N,b]=t.useState(!0),[g,k]=t.useState(new Date),[h,y]=t.useState(!0),n=t.useCallback(async()=>{try{const a=await o(`${P()}/system/health/`);if(a.ok){const r=await a.json();d(r)}else d({status:"healthy",uptime:"99.9%",response_time:45,services:{api:{status:"operational",latency:32},database:{status:"operational",latency:8},websocket:{status:"operational",connections:1247},storage:{status:"operational",usage:65},cache:{status:"operational",hit_rate:94.2}},resources:{cpu:28,memory:62,disk:45,network:35},active_users:3421,messages_per_minute:847,api_calls_per_minute:12450,errors_last_hour:3,warnings_last_hour:12})}catch{d({status:"unknown",services:{},resources:{cpu:0,memory:0,disk:0,network:0}})}b(!1),k(new Date)},[o]);t.useEffect(()=>{n()},[n]),t.useEffect(()=>{if(h){const a=setInterval(n,3e4);return()=>clearInterval(a)}},[h,n]);const f=c(a=>{switch(a){case"operational":case"healthy":return"#10b981";case"degraded":case"warning":return"#f59e0b";case"down":case"error":return"#ef4444";default:return"#6b7280"}},"getStatusColor"),x=c(a=>{switch(a){case"operational":case"healthy":return s.jsx(H,{style:{color:"#10b981"}});case"degraded":case"warning":return s.jsx(m,{style:{color:"#f59e0b"}});case"down":case"error":return s.jsx(v,{style:{color:"#ef4444"}});default:return s.jsx(u,{style:{color:"#6b7280"}})}},"getStatusIcon"),l=c(a=>a<60?"#10b981":a<80?"#f59e0b":"#ef4444","getResourceColor"),w=c(a=>a.toLocaleTimeString(),"formatUptime");return N?s.jsx("div",{className:"server-health-overlay",onClick:i,children:s.jsx("div",{className:"server-health-panel",onClick:c(a=>a.stopPropagation(),"onClick"),children:s.jsxs("div",{className:"loading-state",children:[s.jsx(u,{className:"spin"}),s.jsx("span",{children:"Checking server health..."})]})})}):s.jsx("div",{className:"server-health-overlay",onClick:i,children:s.jsxs("div",{className:"server-health-panel",onClick:c(a=>a.stopPropagation(),"onClick"),children:[s.jsxs("div",{className:"panel-header",children:[s.jsxs("div",{className:"header-left",children:[s.jsxs("h2",{children:[s.jsx(C,{})," Server Health"]}),s.jsxs("div",{className:`status-badge ${e?.status}`,children:[x(e?.status),s.jsx("span",{children:e?.status==="healthy"?"All Systems Operational":e?.status})]})]}),s.jsxs("div",{className:"header-right",children:[s.jsxs("div",{className:"last-update",children:[s.jsx(S,{}),s.jsxs("span",{children:["Updated: ",w(g)]})]}),s.jsxs("label",{className:"auto-refresh-toggle",children:[s.jsx("input",{type:"checkbox",checked:h,onChange:c(a=>y(a.target.checked),"onChange")}),s.jsx("span",{children:"Auto-refresh"})]}),s.jsx("button",{className:"refresh-btn",onClick:n,children:s.jsx(u,{})}),s.jsx("button",{className:"close-btn",onClick:i,children:s.jsx(F,{})})]})]}),s.jsxs("div",{className:"quick-stats",children:[s.jsxs("div",{className:"quick-stat",children:[s.jsx(U,{className:"stat-icon"}),s.jsxs("div",{className:"stat-content",children:[s.jsx("span",{className:"value",children:e?.uptime||"99.9%"}),s.jsx("span",{className:"label",children:"Uptime"})]})]}),s.jsxs("div",{className:"quick-stat",children:[s.jsx($,{className:"stat-icon"}),s.jsxs("div",{className:"stat-content",children:[s.jsxs("span",{className:"value",children:[e?.response_time||45,"ms"]}),s.jsx("span",{className:"label",children:"Response Time"})]})]}),s.jsxs("div",{className:"quick-stat",children:[s.jsx(L,{className:"stat-icon"}),s.jsxs("div",{className:"stat-content",children:[s.jsx("span",{className:"value",children:(e?.active_users||0).toLocaleString()}),s.jsx("span",{className:"label",children:"Active Users"})]})]}),s.jsxs("div",{className:"quick-stat",children:[s.jsx(j,{className:"stat-icon"}),s.jsxs("div",{className:"stat-content",children:[s.jsx("span",{className:"value",children:(e?.messages_per_minute||0).toLocaleString()}),s.jsx("span",{className:"label",children:"Messages/min"})]})]})]}),s.jsxs("div",{className:"panel-body",children:[s.jsxs("div",{className:"section",children:[s.jsxs("h3",{children:[s.jsx(R,{})," Services Status"]}),s.jsx("div",{className:"services-grid",children:Object.entries(e?.services||{}).map(([a,r])=>s.jsxs("div",{className:"service-card",children:[s.jsxs("div",{className:"service-header",children:[s.jsx("span",{className:"service-name",children:a.toUpperCase()}),x(r.status)]}),s.jsx("div",{className:"service-status",style:{color:f(r.status)},children:r.status}),s.jsxs("div",{className:"service-metric",children:[r.latency!==void 0&&`${r.latency}ms latency`,r.connections!==void 0&&`${r.connections} connections`,r.usage!==void 0&&`${r.usage}% used`,r.hit_rate!==void 0&&`${r.hit_rate}% hit rate`]})]},a))})]}),s.jsxs("div",{className:"section",children:[s.jsxs("h3",{children:[s.jsx(p,{})," Resource Usage"]}),s.jsxs("div",{className:"resources-grid",children:[s.jsxs("div",{className:"resource-card",children:[s.jsxs("div",{className:"resource-header",children:[s.jsx(p,{}),s.jsx("span",{children:"CPU"})]}),s.jsxs("div",{className:"resource-value",style:{color:l(e?.resources?.cpu||0)},children:[e?.resources?.cpu||0,"%"]}),s.jsx("div",{className:"resource-bar",children:s.jsx("div",{className:"bar-fill",style:{width:`${e?.resources?.cpu||0}%`,backgroundColor:l(e?.resources?.cpu||0)}})})]}),s.jsxs("div",{className:"resource-card",children:[s.jsxs("div",{className:"resource-header",children:[s.jsx(q,{}),s.jsx("span",{children:"Memory"})]}),s.jsxs("div",{className:"resource-value",style:{color:l(e?.resources?.memory||0)},children:[e?.resources?.memory||0,"%"]}),s.jsx("div",{className:"resource-bar",children:s.jsx("div",{className:"bar-fill",style:{width:`${e?.resources?.memory||0}%`,backgroundColor:l(e?.resources?.memory||0)}})})]}),s.jsxs("div",{className:"resource-card",children:[s.jsxs("div",{className:"resource-header",children:[s.jsx(A,{}),s.jsx("span",{children:"Disk"})]}),s.jsxs("div",{className:"resource-value",style:{color:l(e?.resources?.disk||0)},children:[e?.resources?.disk||0,"%"]}),s.jsx("div",{className:"resource-bar",children:s.jsx("div",{className:"bar-fill",style:{width:`${e?.resources?.disk||0}%`,backgroundColor:l(e?.resources?.disk||0)}})})]}),s.jsxs("div",{className:"resource-card",children:[s.jsxs("div",{className:"resource-header",children:[s.jsx(E,{}),s.jsx("span",{children:"Network"})]}),s.jsxs("div",{className:"resource-value",style:{color:l(e?.resources?.network||0)},children:[e?.resources?.network||0,"%"]}),s.jsx("div",{className:"resource-bar",children:s.jsx("div",{className:"bar-fill",style:{width:`${e?.resources?.network||0}%`,backgroundColor:l(e?.resources?.network||0)}})})]})]})]}),s.jsxs("div",{className:"section alerts-section",children:[s.jsxs("h3",{children:[s.jsx(m,{})," Recent Alerts"]}),s.jsxs("div",{className:"alerts-summary",children:[s.jsxs("div",{className:"alert-stat error",children:[s.jsx(v,{}),s.jsx("span",{className:"count",children:e?.errors_last_hour||0}),s.jsx("span",{className:"label",children:"Errors (1h)"})]}),s.jsxs("div",{className:"alert-stat warning",children:[s.jsx(m,{}),s.jsx("span",{className:"count",children:e?.warnings_last_hour||0}),s.jsx("span",{className:"label",children:"Warnings (1h)"})]}),s.jsxs("div",{className:"alert-stat info",children:[s.jsx(j,{}),s.jsx("span",{className:"count",children:(e?.api_calls_per_minute||0).toLocaleString()}),s.jsx("span",{className:"label",children:"API Calls/min"})]})]})]})]})]})})},"ServerHealthPanel");export{J as default};
