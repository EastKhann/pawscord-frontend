import{r as o,d as e,c9 as r}from"./react-core-DrOm_csO.js";import{g as j}from"./index-BYhWpPLp.js";const R=({serverId:c,onClose:p})=>{const i=j(),[v,f]=o.useState([]),[N,y]=o.useState(!0),[w,m]=o.useState(!1),[_,b]=o.useState([]),[S,z]=o.useState([]),[n,l]=o.useState({title:"",description:"",prize:"",channel_id:"",winners_count:1,duration:3600,required_role_id:"",required_messages:0,required_invites:0,allow_multiple_entries:!1});o.useEffect(()=>{d(),$(),C()},[c]);const d=async()=>{try{const a=await fetch(`${i}/giveaways/server/${c}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(a.ok){const t=await a.json();f(t)}}catch(a){console.error("Error fetching giveaways:",a)}finally{y(!1)}},$=async()=>{try{const a=await fetch(`${i}/channels/server/${c}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(a.ok){const t=await a.json();b(t.filter(s=>s.type==="text"))}}catch(a){console.error("Error fetching channels:",a)}},C=async()=>{try{const a=await fetch(`${i}/roles/server/${c}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(a.ok){const t=await a.json();z(t)}}catch(a){console.error("Error fetching roles:",a)}},q=async()=>{if(!n.title||!n.prize||!n.channel_id){r.error("âŒ LÃ¼tfen tÃ¼m gerekli alanlarÄ± doldurun");return}try{(await fetch(`${i}/giveaways/create/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`,"Content-Type":"application/json"},body:JSON.stringify({server_id:c,...n})})).ok?(r.success("âœ… Ã‡ekiliÅŸ oluÅŸturuldu!"),m(!1),d(),l({title:"",description:"",prize:"",channel_id:"",winners_count:1,duration:3600,required_role_id:"",required_messages:0,required_invites:0,allow_multiple_entries:!1})):r.error("âŒ Ã‡ekiliÅŸ oluÅŸturulamadÄ±")}catch(a){console.error("Error creating giveaway:",a),r.error("âŒ BaÄŸlantÄ± hatasÄ±")}},B=async a=>{if(window.confirm("Ã‡ekiliÅŸi sonlandÄ±rmak istediÄŸinize emin misiniz?"))try{const t=await fetch(`${i}/giveaways/${a}/end/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(t.ok){const s=await t.json();r.success(`âœ… Ã‡ekiliÅŸ sonlandÄ±! Kazananlar: ${s.winners.join(", ")}`),d()}else r.error("âŒ Ã‡ekiliÅŸ sonlandÄ±rÄ±lamadÄ±")}catch(t){console.error("Error ending giveaway:",t),r.error("âŒ BaÄŸlantÄ± hatasÄ±")}},x=async a=>{try{const t=await fetch(`${i}/giveaways/${a}/reroll/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(t.ok){const s=await t.json();r.success(`âœ… Yeni kazanan: ${s.new_winner}`),d()}else r.error("âŒ Reroll yapÄ±lamadÄ±")}catch(t){console.error("Error rerolling giveaway:",t),r.error("âŒ BaÄŸlantÄ± hatasÄ±")}},A=async a=>{if(window.confirm("Ã‡ekiliÅŸi silmek istediÄŸinize emin misiniz?"))try{(await fetch(`${i}/giveaways/${a}/delete/`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}})).ok?(r.success("âœ… Ã‡ekiliÅŸ silindi"),d()):r.error("âŒ Ã‡ekiliÅŸ silinemedi")}catch(t){console.error("Error deleting giveaway:",t),r.error("âŒ BaÄŸlantÄ± hatasÄ±")}},g=a=>{const t={active:{text:"Aktif",color:"#10b981"},ended:{text:"SonlandÄ±",color:"#6b7280"},cancelled:{text:"Ä°ptal",color:"#ef4444"}};return t[a]||t.active},G=a=>{const t=new Date,s=new Date(a),u=Math.floor((s-t)/1e3);if(u<=0)return"Sona erdi";const h=Math.floor(u/86400),E=Math.floor(u%86400/3600),k=Math.floor(u%3600/60);return h>0?`${h}g ${E}s kaldÄ±`:E>0?`${E}s ${k}dk kaldÄ±`:`${k} dakika kaldÄ±`};return e.createElement("div",{className:"giveaway-panel-overlay",onClick:p},e.createElement("div",{className:"giveaway-panel",onClick:a=>a.stopPropagation()},e.createElement("div",{className:"giveaway-header"},e.createElement("h2",null,"ğŸ‰ Ã‡ekiliÅŸler"),e.createElement("button",{className:"close-btn",onClick:p},"Ã—")),e.createElement("div",{className:"giveaway-content"},e.createElement("div",{className:"giveaway-actions"},e.createElement("button",{className:"create-giveaway-btn",onClick:()=>m(!0)},"+ Yeni Ã‡ekiliÅŸ OluÅŸtur")),N?e.createElement("div",{className:"loading-state"},e.createElement("div",{className:"spinner"}),e.createElement("p",null,"Ã‡ekiliÅŸler yÃ¼kleniyor...")):v.length===0?e.createElement("div",{className:"empty-state"},e.createElement("span",{className:"empty-icon"},"ğŸ"),e.createElement("p",null,"HenÃ¼z Ã§ekiliÅŸ yok"),e.createElement("span",{className:"empty-hint"},"Yeni bir Ã§ekiliÅŸ oluÅŸturun!")):e.createElement("div",{className:"giveaways-list"},v.map(a=>e.createElement("div",{key:a.id,className:"giveaway-card"},e.createElement("div",{className:"giveaway-card-header"},e.createElement("h3",null,a.title),e.createElement("span",{className:"status-badge",style:{background:g(a.status).color}},g(a.status).text)),e.createElement("div",{className:"giveaway-card-body"},e.createElement("div",{className:"giveaway-prize"},e.createElement("span",{className:"prize-icon"},"ğŸ"),e.createElement("span",{className:"prize-text"},a.prize)),a.description&&e.createElement("p",{className:"giveaway-description"},a.description),e.createElement("div",{className:"giveaway-info"},e.createElement("div",{className:"info-item"},e.createElement("span",{className:"info-label"},"Kazanan SayÄ±sÄ±:"),e.createElement("span",{className:"info-value"},a.winners_count," kiÅŸi")),e.createElement("div",{className:"info-item"},e.createElement("span",{className:"info-label"},"KatÄ±lÄ±mcÄ±lar:"),e.createElement("span",{className:"info-value"},a.entries_count||0," kiÅŸi")),a.status==="active"&&e.createElement("div",{className:"info-item"},e.createElement("span",{className:"info-label"},"Kalan SÃ¼re:"),e.createElement("span",{className:"info-value time-remaining"},G(a.end_time)))),a.required_role_id&&e.createElement("div",{className:"requirement-badge"},"â­ Rol gereksinimi var"),a.required_messages>0&&e.createElement("div",{className:"requirement-badge"},"ğŸ’¬ ",a.required_messages," mesaj gerekli"),a.required_invites>0&&e.createElement("div",{className:"requirement-badge"},"ğŸ‘¥ ",a.required_invites," davet gerekli"),a.winners&&a.winners.length>0&&e.createElement("div",{className:"winners-section"},e.createElement("h4",null,"ğŸ‰ Kazananlar:"),e.createElement("ul",{className:"winners-list"},a.winners.map((t,s)=>e.createElement("li",{key:s},t))))),e.createElement("div",{className:"giveaway-card-footer"},a.status==="active"&&e.createElement("button",{className:"end-btn",onClick:()=>B(a.id)},"ğŸ SonlandÄ±r"),a.status==="ended"&&e.createElement("button",{className:"reroll-btn",onClick:()=>x(a.id)},"ğŸ”„ Reroll"),e.createElement("button",{className:"delete-btn",onClick:()=>A(a.id)},"ğŸ—‘ï¸ Sil")))))),w&&e.createElement("div",{className:"create-modal-overlay",onClick:()=>m(!1)},e.createElement("div",{className:"create-modal",onClick:a=>a.stopPropagation()},e.createElement("div",{className:"modal-header"},e.createElement("h3",null,"Yeni Ã‡ekiliÅŸ OluÅŸtur"),e.createElement("button",{className:"close-btn",onClick:()=>m(!1)},"Ã—")),e.createElement("div",{className:"modal-body"},e.createElement("div",{className:"form-group"},e.createElement("label",null,"BaÅŸlÄ±k *"),e.createElement("input",{type:"text",placeholder:"Discord Nitro Ã‡ekiliÅŸi",value:n.title,onChange:a=>l({...n,title:a.target.value})})),e.createElement("div",{className:"form-group"},e.createElement("label",null,"AÃ§Ä±klama"),e.createElement("textarea",{placeholder:"Ã‡ekiliÅŸ hakkÄ±nda detaylar...",value:n.description,onChange:a=>l({...n,description:a.target.value}),rows:"3"})),e.createElement("div",{className:"form-group"},e.createElement("label",null,"Ã–dÃ¼l *"),e.createElement("input",{type:"text",placeholder:"1 AylÄ±k Discord Nitro",value:n.prize,onChange:a=>l({...n,prize:a.target.value})})),e.createElement("div",{className:"form-row"},e.createElement("div",{className:"form-group"},e.createElement("label",null,"Kanal *"),e.createElement("select",{value:n.channel_id,onChange:a=>l({...n,channel_id:a.target.value})},e.createElement("option",{value:""},"Kanal SeÃ§in"),_.map(a=>e.createElement("option",{key:a.id,value:a.id},"# ",a.name)))),e.createElement("div",{className:"form-group"},e.createElement("label",null,"Kazanan SayÄ±sÄ±"),e.createElement("input",{type:"number",min:"1",max:"100",value:n.winners_count,onChange:a=>l({...n,winners_count:parseInt(a.target.value)})}))),e.createElement("div",{className:"form-group"},e.createElement("label",null,"SÃ¼re"),e.createElement("select",{value:n.duration,onChange:a=>l({...n,duration:parseInt(a.target.value)})},e.createElement("option",{value:"1800"},"30 dakika"),e.createElement("option",{value:"3600"},"1 saat"),e.createElement("option",{value:"10800"},"3 saat"),e.createElement("option",{value:"21600"},"6 saat"),e.createElement("option",{value:"43200"},"12 saat"),e.createElement("option",{value:"86400"},"1 gÃ¼n"),e.createElement("option",{value:"172800"},"2 gÃ¼n"),e.createElement("option",{value:"259200"},"3 gÃ¼n"),e.createElement("option",{value:"604800"},"1 hafta"))),e.createElement("div",{className:"requirements-section"},e.createElement("h4",null,"KatÄ±lÄ±m Gereksinimleri (Opsiyonel)"),e.createElement("div",{className:"form-group"},e.createElement("label",null,"Gerekli Rol"),e.createElement("select",{value:n.required_role_id,onChange:a=>l({...n,required_role_id:a.target.value})},e.createElement("option",{value:""},"Rol yok"),S.map(a=>e.createElement("option",{key:a.id,value:a.id},a.name)))),e.createElement("div",{className:"form-row"},e.createElement("div",{className:"form-group"},e.createElement("label",null,"Minimum Mesaj SayÄ±sÄ±"),e.createElement("input",{type:"number",min:"0",value:n.required_messages,onChange:a=>l({...n,required_messages:parseInt(a.target.value)})})),e.createElement("div",{className:"form-group"},e.createElement("label",null,"Minimum Davet SayÄ±sÄ±"),e.createElement("input",{type:"number",min:"0",value:n.required_invites,onChange:a=>l({...n,required_invites:parseInt(a.target.value)})}))),e.createElement("div",{className:"form-group"},e.createElement("label",{className:"checkbox-label"},e.createElement("input",{type:"checkbox",checked:n.allow_multiple_entries,onChange:a=>l({...n,allow_multiple_entries:a.target.checked})}),e.createElement("span",null,"Birden fazla katÄ±lÄ±ma izin ver"))))),e.createElement("div",{className:"modal-footer"},e.createElement("button",{className:"cancel-btn",onClick:()=>m(!1)},"Ä°ptal"),e.createElement("button",{className:"submit-btn",onClick:q},"ğŸ‰ Ã‡ekiliÅŸ OluÅŸtur"))))))};export{R as default};
