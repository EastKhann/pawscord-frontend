import{r as d,n as s}from"./react-core-Cj7FUMmY.js";import{t as c}from"./index-BZ0XvVGG.js";import"./editor-vendor-D9c4a6XZ.js";import"./media-vendor-By68PLJG.js";import"./router-vendor-QeioVw-9.js";import"./icons-vendor-TGltgKsJ.js";import"./state-vendor-DGcbxrkI.js";import"./crypto-vendor-DK-7ILyQ.js";const D=({apiBaseUrl:u,onClose:j})=>{const[i,N]=d.useState([]),[y,v]=d.useState(!0),[t,o]=d.useState("all"),[B,f]=d.useState(null);d.useEffect(()=>{k()},[]);const k=async()=>{try{v(!0);const e=localStorage.getItem("access_token"),a=await fetch(`${u}/reports/list/`,{headers:{Authorization:`Bearer ${e}`}});if(a.ok){const n=await a.json();N(n.reports||[])}else c.error("‚ùå ≈ûikayetler y√ºklenemedi")}catch{c.error("‚ùå Baƒülantƒ± hatasƒ±")}finally{v(!1)}},m=async(e,a,n="")=>{try{const r=localStorage.getItem("access_token"),h=await fetch(`${u}/reports/handle/${e}/`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"},body:JSON.stringify({action:a,reason:n})});if(h.ok){const g=await h.json();N(i.map(p=>p.id===e?{...p,status:a==="dismiss"?"dismissed":"resolved",resolution:a}:p)),f(null),c.success(`‚úÖ ${x(a)}`)}else{const g=await h.json();c.error(`‚ùå ${g.error||"ƒ∞≈ülem ba≈üarƒ±sƒ±z"}`)}}catch{c.error("‚ùå Baƒülantƒ± hatasƒ±")}},x=e=>({ban:"Kullanƒ±cƒ± yasaklandƒ±",warn:"Kullanƒ±cƒ± uyarƒ±ldƒ±",delete_message:"Mesaj silindi",dismiss:"≈ûikayet reddedildi"})[e]||"ƒ∞≈ülem tamamlandƒ±",b=i.filter(e=>t==="all"?!0:t==="pending"?e.status==="pending":t==="resolved"?e.status==="resolved":t==="dismissed"?e.status==="dismissed":!0),S=e=>({pending:{label:"Bekliyor",className:"status-pending"},resolved:{label:"√á√∂z√ºld√º",className:"status-resolved"},dismissed:{label:"Reddedildi",className:"status-dismissed"}})[e]||{label:e,className:""},w=e=>({spam:{label:"Spam",className:"severity-low"},harassment:{label:"Taciz",className:"severity-high"},hate_speech:{label:"Nefret S√∂ylemi",className:"severity-critical"},inappropriate:{label:"Uygunsuz ƒ∞√ßerik",className:"severity-medium"},scam:{label:"Dolandƒ±rƒ±cƒ±lƒ±k",className:"severity-high"},other:{label:"Diƒüer",className:"severity-low"}})[e]||{label:e,className:""},R=e=>new Date(e).toLocaleString("tr-TR",{day:"2-digit",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}),l={total:i.length,pending:i.filter(e=>e.status==="pending").length,resolved:i.filter(e=>e.status==="resolved").length,dismissed:i.filter(e=>e.status==="dismissed").length};return s.jsx("div",{className:"reports-overlay",onClick:j,children:s.jsxs("div",{className:"reports-panel",onClick:e=>e.stopPropagation(),children:[s.jsxs("div",{className:"reports-header",children:[s.jsx("h2",{children:"üö® ≈ûikayet Y√∂netimi"}),s.jsx("button",{className:"close-btn",onClick:j,children:"‚úï"})]}),s.jsxs("div",{className:"reports-stats",children:[s.jsxs("div",{className:"stat-item",children:[s.jsx("span",{className:"stat-value",children:l.total}),s.jsx("span",{className:"stat-label",children:"Toplam"})]}),s.jsxs("div",{className:"stat-item pending",children:[s.jsx("span",{className:"stat-value",children:l.pending}),s.jsx("span",{className:"stat-label",children:"Bekliyor"})]}),s.jsxs("div",{className:"stat-item resolved",children:[s.jsx("span",{className:"stat-value",children:l.resolved}),s.jsx("span",{className:"stat-label",children:"√á√∂z√ºld√º"})]}),s.jsxs("div",{className:"stat-item dismissed",children:[s.jsx("span",{className:"stat-value",children:l.dismissed}),s.jsx("span",{className:"stat-label",children:"Reddedildi"})]})]}),s.jsxs("div",{className:"reports-filters",children:[s.jsxs("button",{className:t==="all"?"active":"",onClick:()=>o("all"),children:["T√ºm√º (",l.total,")"]}),s.jsxs("button",{className:t==="pending"?"active":"",onClick:()=>o("pending"),children:["Bekliyor (",l.pending,")"]}),s.jsxs("button",{className:t==="resolved"?"active":"",onClick:()=>o("resolved"),children:["√á√∂z√ºld√º (",l.resolved,")"]}),s.jsxs("button",{className:t==="dismissed"?"active":"",onClick:()=>o("dismissed"),children:["Reddedildi (",l.dismissed,")"]})]}),s.jsx("div",{className:"reports-content",children:y?s.jsxs("div",{className:"loading-state",children:[s.jsx("div",{className:"spinner"}),s.jsx("p",{children:"Y√ºkleniyor..."})]}):b.length===0?s.jsxs("div",{className:"empty-state",children:[s.jsx("div",{className:"empty-icon",children:"üéâ"}),s.jsx("h3",{children:"≈ûikayet yok"}),s.jsx("p",{children:"Bu filtre i√ßin ≈üikayet bulunamadƒ±"})]}):s.jsx("div",{className:"reports-list",children:b.map(e=>{const a=S(e.status),n=w(e.reason);return s.jsxs("div",{className:"report-card",children:[s.jsxs("div",{className:"report-header",children:[s.jsxs("div",{className:"report-meta",children:[s.jsx("span",{className:`status-badge ${a.className}`,children:a.label}),s.jsx("span",{className:`severity-badge ${n.className}`,children:n.label})]}),s.jsx("span",{className:"report-date",children:R(e.created_at)})]}),s.jsxs("div",{className:"report-body",children:[s.jsxs("div",{className:"report-info",children:[s.jsxs("div",{className:"info-row",children:[s.jsx("span",{className:"info-label",children:"Bildiren:"}),s.jsxs("span",{className:"info-value",children:["üë§ ",e.reporter_username]})]}),s.jsxs("div",{className:"info-row",children:[s.jsx("span",{className:"info-label",children:"Bildirilen:"}),s.jsxs("span",{className:"info-value",children:["‚ö†Ô∏è ",e.reported_user_username]})]}),e.message_content&&s.jsxs("div",{className:"info-row",children:[s.jsx("span",{className:"info-label",children:"Mesaj:"}),s.jsx("div",{className:"message-preview",children:e.message_content})]})]}),e.description&&s.jsxs("div",{className:"report-description",children:[s.jsx("strong",{children:"A√ßƒ±klama:"}),s.jsx("p",{children:e.description})]})]}),e.status==="pending"?s.jsxs("div",{className:"report-actions",children:[s.jsx("button",{className:"action-btn ban",onClick:()=>{const r=prompt("Yasaklama sebebi:");r&&m(e.id,"ban",r)},title:"Kullanƒ±cƒ±yƒ± Yasakla",children:"üö´ Yasakla"}),s.jsx("button",{className:"action-btn warn",onClick:()=>m(e.id,"warn","Uyarƒ± verildi"),title:"Kullanƒ±cƒ±yƒ± Uyar",children:"‚ö†Ô∏è Uyar"}),s.jsx("button",{className:"action-btn delete",onClick:()=>m(e.id,"delete_message","Mesaj silindi"),title:"Mesajƒ± Sil",children:"üóëÔ∏è Mesajƒ± Sil"}),s.jsx("button",{className:"action-btn dismiss",onClick:()=>m(e.id,"dismiss","Ge√ßersiz ≈üikayet"),title:"≈ûikayeti Reddet",children:"‚úï Reddet"})]}):s.jsxs("div",{className:"report-resolution",children:[s.jsx("span",{className:"resolution-label",children:"√á√∂z√ºm:"}),s.jsx("span",{className:"resolution-value",children:x(e.resolution)})]})]},e.id)})})})]})})};export{D as default};
