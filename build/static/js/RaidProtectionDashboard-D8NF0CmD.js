import{r as c,n as e}from"./react-core-BMiyQWF6.js";import{a4 as b,a as Y,R as q,aj as p,b5 as v,b0 as w,bi as G,h as Q,b4 as S,ar as C,d as A,a3 as U,D as $,t as W}from"./icons-vendor-T72gfvdf.js";import{t as u}from"./index-CbrAkfmn.js";import"./editor-vendor-D9c4a6XZ.js";import"./media-vendor-BuSyE8vR.js";import"./router-vendor-B86Z1mIL.js";import"./state-vendor-CAyNnPM4.js";import"./crypto-vendor-1Q6e4ZD-.js";const le=({serverId:l,apiBaseUrl:r,onClose:g})=>{const[d,j]=c.useState("overview"),[i,x]=c.useState({enabled:!1,level:"medium",lockdown_active:!1,verification_required:!1,auto_ban_enabled:!0}),[k,R]=c.useState([]),[m,y]=c.useState([]),[N,T]=c.useState([]),[t,o]=c.useState({join_rate_limit:10,join_time_window:60,mention_limit:10,message_rate_limit:15,new_account_threshold:7,auto_ban_suspicious:!0,captcha_on_join:!1,dm_on_join_warning:!0}),[X,L]=c.useState(!0),[h,K]=c.useState({blocked_today:0,verified_today:0,raids_detected:0,suspicious_accounts:0}),z=c.useRef(null);c.useEffect(()=>{F(),_(),P(),B();const s=setInterval(_,5e3);return()=>clearInterval(s)},[l]);const F=async()=>{try{const s=localStorage.getItem("access_token"),a=await fetch(`${r}/moderation/raid-protection/status/${l}/`,{headers:{Authorization:`Bearer ${s}`}});if(a.ok){const n=await a.json();x(n.status||i),o(n.settings||t),K(n.stats||h)}}catch{}finally{L(!1)}},_=async()=>{try{const s=localStorage.getItem("access_token"),a=await fetch(`${r}/moderation/raid-protection/activity/${l}/`,{headers:{Authorization:`Bearer ${s}`}});if(a.ok){const n=await a.json();R(n.activity||[])}}catch{}},P=async()=>{try{const s=localStorage.getItem("access_token"),a=await fetch(`${r}/moderation/raid-protection/pending/${l}/`,{headers:{Authorization:`Bearer ${s}`}});if(a.ok){const n=await a.json();y(n.pending||[])}}catch{}},B=async()=>{try{const s=localStorage.getItem("access_token"),a=await fetch(`${r}/moderation/raid-protection/logs/${l}/`,{headers:{Authorization:`Bearer ${s}`}});if(a.ok){const n=await a.json();T(n.logs||[])}}catch{}},D=async()=>{try{const s=localStorage.getItem("access_token"),a=i.enabled?"disable":"enable";(await fetch(`${r}/moderation/raid-protection/${a}/`,{method:"POST",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},body:JSON.stringify({server_id:l})})).ok&&(x({...i,enabled:!i.enabled}),u.success(i.enabled?"ðŸ”“ Raid korumasÄ± devre dÄ±ÅŸÄ±":"ðŸ›¡ï¸ Raid korumasÄ± aktif!"))}catch{}},H=async()=>{if(window.confirm(i.lockdown_active?"Sunucu kilidini aÃ§mak istediÄŸinizden emin misiniz?":"UYARI: Bu iÅŸlem sunucuyu kilitleyecek. Yeni Ã¼yeler katÄ±lamayacak. Devam?"))try{const a=localStorage.getItem("access_token"),n=i.lockdown_active?"unlock":"lockdown";(await fetch(`${r}/moderation/raid-protection/${n}/`,{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify({server_id:l})})).ok&&(x({...i,lockdown_active:!i.lockdown_active}),u.success(i.lockdown_active?"ðŸ”“ Sunucu kilidi aÃ§Ä±ldÄ±":"ðŸ”’ Sunucu kilitlendi!"))}catch{}},f=async(s,a)=>{try{const n=localStorage.getItem("access_token");(await fetch(`${r}/moderation/raid-protection/verify/`,{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify({server_id:l,user_id:s,action:a})})).ok&&(y(m.filter(J=>J.id!==s)),u.success(a==="approve"?"âœ… KullanÄ±cÄ± onaylandÄ±":"âŒ KullanÄ±cÄ± reddedildi"))}catch{}},O=async()=>{try{const s=localStorage.getItem("access_token");(await fetch(`${r}/moderation/raid-protection/settings/`,{method:"PUT",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},body:JSON.stringify({server_id:l,...t})})).ok&&u.success("âœ… Ayarlar kaydedildi!")}catch{}},E=s=>{switch(s){case"join":return"ðŸ‘‹";case"leave":return"ðŸšª";case"kick":return"ðŸ‘¢";case"ban":return"ðŸ”¨";case"suspicious":return"âš ï¸";case"raid_detected":return"ðŸš¨";case"verified":return"âœ…";default:return"ðŸ“‹"}},I=s=>{switch(s){case"join":return"#23a559";case"leave":return"#f0b132";case"kick":case"ban":return"#da373c";case"suspicious":case"raid_detected":return"#f0b132";case"verified":return"#5865f2";default:return"#72767d"}},M=s=>new Date(s).toLocaleTimeString("tr-TR",{hour:"2-digit",minute:"2-digit"});return e.jsx("div",{className:"raid-dashboard-overlay",onClick:g,children:e.jsxs("div",{className:"raid-dashboard",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"dashboard-header",children:[e.jsxs("h2",{children:[e.jsx(b,{})," Raid Koruma Paneli"]}),e.jsxs("div",{className:"header-status",children:[e.jsx("span",{className:`status-badge ${i.enabled?"active":"inactive"}`,children:i.enabled?"ðŸ›¡ï¸ Koruma Aktif":"âš ï¸ Koruma KapalÄ±"}),i.lockdown_active&&e.jsx("span",{className:"status-badge lockdown",children:"ðŸ”’ Lockdown"})]}),e.jsx("button",{className:"close-btn",onClick:g,children:e.jsx(Y,{})})]}),e.jsxs("div",{className:"dashboard-nav",children:[e.jsxs("button",{className:`nav-btn ${d==="overview"?"active":""}`,onClick:()=>j("overview"),children:[e.jsx(q,{})," Genel BakÄ±ÅŸ"]}),e.jsxs("button",{className:`nav-btn ${d==="verify"?"active":""}`,onClick:()=>j("verify"),children:[e.jsx(p,{})," DoÄŸrulama",m.length>0&&e.jsx("span",{className:"badge",children:m.length})]}),e.jsxs("button",{className:`nav-btn ${d==="logs"?"active":""}`,onClick:()=>j("logs"),children:[e.jsx(v,{})," Loglar"]}),e.jsxs("button",{className:`nav-btn ${d==="settings"?"active":""}`,onClick:()=>j("settings"),children:[e.jsx(w,{})," Ayarlar"]})]}),e.jsxs("div",{className:"dashboard-content",children:[d==="overview"&&e.jsxs("div",{className:"overview-view",children:[e.jsxs("div",{className:"quick-actions",children:[e.jsxs("button",{className:`action-btn ${i.enabled?"enabled":""}`,onClick:D,children:[e.jsx(b,{}),i.enabled?"KorumayÄ± Kapat":"KorumayÄ± AÃ§"]}),e.jsxs("button",{className:`action-btn lockdown ${i.lockdown_active?"active":""}`,onClick:H,children:[i.lockdown_active?e.jsx(G,{}):e.jsx(Q,{}),i.lockdown_active?"Kilidi AÃ§":"Sunucuyu Kilitle"]})]}),e.jsxs("div",{className:"stats-grid",children:[e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon blocked",children:e.jsx(S,{})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("span",{className:"stat-value",children:h.blocked_today}),e.jsx("span",{className:"stat-label",children:"BugÃ¼n Engellenen"})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon verified",children:e.jsx(C,{})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("span",{className:"stat-value",children:h.verified_today}),e.jsx("span",{className:"stat-label",children:"BugÃ¼n DoÄŸrulanan"})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon raids",children:e.jsx(A,{})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("span",{className:"stat-value",children:h.raids_detected}),e.jsx("span",{className:"stat-label",children:"Tespit Edilen Raid"})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon suspicious",children:e.jsx(U,{})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("span",{className:"stat-value",children:h.suspicious_accounts}),e.jsx("span",{className:"stat-label",children:"ÅžÃ¼pheli Hesap"})]})]})]}),e.jsxs("div",{className:"activity-section",children:[e.jsxs("h3",{children:[e.jsx($,{})," CanlÄ± Aktivite"]}),e.jsx("div",{className:"activity-feed",ref:z,children:k.length>0?k.map((s,a)=>e.jsxs("div",{className:"activity-item",style:{borderLeftColor:I(s.type)},children:[e.jsx("span",{className:"activity-icon",children:E(s.type)}),e.jsxs("div",{className:"activity-info",children:[e.jsx("span",{className:"activity-user",children:s.username}),e.jsx("span",{className:"activity-action",children:s.description})]}),e.jsx("span",{className:"activity-time",children:M(s.timestamp)})]},a)):e.jsx("div",{className:"no-activity",children:e.jsx("p",{children:"HenÃ¼z aktivite yok"})})})]})]}),d==="verify"&&e.jsxs("div",{className:"verify-view",children:[e.jsxs("h3",{children:[e.jsx(p,{})," Bekleyen DoÄŸrulamalar"]}),m.length>0?e.jsx("div",{className:"verifications-list",children:m.map(s=>e.jsxs("div",{className:"verification-card",children:[e.jsx("img",{src:s.avatar||"/default-avatar.png",alt:s.username,className:"user-avatar"}),e.jsxs("div",{className:"user-info",children:[e.jsx("h4",{children:s.username}),e.jsxs("div",{className:"user-meta",children:[e.jsxs("span",{children:[e.jsx($,{})," KatÄ±lÄ±m: ",new Date(s.joined_at).toLocaleDateString("tr-TR")]}),e.jsxs("span",{children:[e.jsx(W,{})," Hesap: ",s.account_age_days," gÃ¼n"]})]}),s.suspicious_reasons&&e.jsxs("div",{className:"suspicious-reasons",children:[e.jsx(A,{}),s.suspicious_reasons.map((a,n)=>e.jsx("span",{className:"reason-tag",children:a},n))]})]}),e.jsxs("div",{className:"verification-actions",children:[e.jsxs("button",{className:"approve-btn",onClick:()=>f(s.id,"approve"),children:[e.jsx(C,{})," Onayla"]}),e.jsxs("button",{className:"reject-btn",onClick:()=>f(s.id,"reject"),children:[e.jsx(S,{})," Reddet"]})]})]},s.id))}):e.jsxs("div",{className:"no-verifications",children:[e.jsx(p,{className:"empty-icon"}),e.jsx("p",{children:"Bekleyen doÄŸrulama yok"})]})]}),d==="logs"&&e.jsxs("div",{className:"logs-view",children:[e.jsxs("h3",{children:[e.jsx(v,{})," Raid LoglarÄ±"]}),N.length>0?e.jsx("div",{className:"logs-list",children:N.map((s,a)=>e.jsxs("div",{className:`log-item ${s.severity}`,children:[e.jsxs("div",{className:"log-header",children:[e.jsxs("span",{className:"log-type",children:[s.type==="raid_detected"&&"ðŸš¨ Raid Tespit Edildi",s.type==="mass_ban"&&"ðŸ”¨ Toplu Ban",s.type==="lockdown"&&"ðŸ”’ Lockdown",s.type==="unlock"&&"ðŸ”“ Kilit AÃ§Ä±ldÄ±",s.type==="suspicious_activity"&&"âš ï¸ ÅžÃ¼pheli Aktivite"]}),e.jsx("span",{className:"log-time",children:new Date(s.timestamp).toLocaleString("tr-TR")})]}),e.jsx("p",{className:"log-description",children:s.description}),s.affected_users&&e.jsxs("span",{className:"affected-count",children:[s.affected_users," kullanÄ±cÄ± etkilendi"]})]},a))}):e.jsxs("div",{className:"no-logs",children:[e.jsx(v,{className:"empty-icon"}),e.jsx("p",{children:"HenÃ¼z log kaydÄ± yok"})]})]}),d==="settings"&&e.jsxs("div",{className:"settings-view",children:[e.jsxs("h3",{children:[e.jsx(w,{})," Koruma AyarlarÄ±"]}),e.jsxs("div",{className:"settings-section",children:[e.jsx("h4",{children:"KatÄ±lÄ±m Limitleri"}),e.jsxs("div",{className:"setting-item",children:[e.jsxs("div",{className:"setting-info",children:[e.jsx("label",{children:"KatÄ±lÄ±m HÄ±z Limiti"}),e.jsx("p",{children:"Belirli sÃ¼re iÃ§inde maksimum katÄ±lÄ±m sayÄ±sÄ±"})]}),e.jsxs("div",{className:"setting-control",children:[e.jsx("input",{type:"number",value:t.join_rate_limit,onChange:s=>o({...t,join_rate_limit:parseInt(s.target.value)}),min:"1",max:"100"}),e.jsx("span",{children:"kiÅŸi /"}),e.jsx("input",{type:"number",value:t.join_time_window,onChange:s=>o({...t,join_time_window:parseInt(s.target.value)}),min:"10",max:"300"}),e.jsx("span",{children:"saniye"})]})]}),e.jsxs("div",{className:"setting-item",children:[e.jsxs("div",{className:"setting-info",children:[e.jsx("label",{children:"Yeni Hesap EÅŸiÄŸi"}),e.jsx("p",{children:"Bu gÃ¼nden eski hesaplar ÅŸÃ¼pheli sayÄ±lÄ±r"})]}),e.jsxs("div",{className:"setting-control",children:[e.jsx("input",{type:"number",value:t.new_account_threshold,onChange:s=>o({...t,new_account_threshold:parseInt(s.target.value)}),min:"1",max:"30"}),e.jsx("span",{children:"gÃ¼n"})]})]})]}),e.jsxs("div",{className:"settings-section",children:[e.jsx("h4",{children:"Mesaj Limitleri"}),e.jsxs("div",{className:"setting-item",children:[e.jsxs("div",{className:"setting-info",children:[e.jsx("label",{children:"Mention Limiti"}),e.jsx("p",{children:"Bir mesajdaki maksimum mention sayÄ±sÄ±"})]}),e.jsx("div",{className:"setting-control",children:e.jsx("input",{type:"number",value:t.mention_limit,onChange:s=>o({...t,mention_limit:parseInt(s.target.value)}),min:"1",max:"50"})})]}),e.jsxs("div",{className:"setting-item",children:[e.jsxs("div",{className:"setting-info",children:[e.jsx("label",{children:"Mesaj HÄ±z Limiti"}),e.jsx("p",{children:"10 saniyede maksimum mesaj sayÄ±sÄ±"})]}),e.jsx("div",{className:"setting-control",children:e.jsx("input",{type:"number",value:t.message_rate_limit,onChange:s=>o({...t,message_rate_limit:parseInt(s.target.value)}),min:"1",max:"50"})})]})]}),e.jsxs("div",{className:"settings-section",children:[e.jsx("h4",{children:"Otomatik Aksiyonlar"}),e.jsxs("div",{className:"setting-item toggle",children:[e.jsxs("div",{className:"setting-info",children:[e.jsx("label",{children:"ÅžÃ¼pheli HesaplarÄ± Otomatik Banla"}),e.jsx("p",{children:"Raid tespit edildiÄŸinde ÅŸÃ¼pheli hesaplarÄ± otomatik banla"})]}),e.jsxs("label",{className:"toggle-switch",children:[e.jsx("input",{type:"checkbox",checked:t.auto_ban_suspicious,onChange:s=>o({...t,auto_ban_suspicious:s.target.checked})}),e.jsx("span",{className:"slider"})]})]}),e.jsxs("div",{className:"setting-item toggle",children:[e.jsxs("div",{className:"setting-info",children:[e.jsx("label",{children:"KatÄ±lÄ±mda CAPTCHA"}),e.jsx("p",{children:"Yeni Ã¼yeler katÄ±lÄ±rken CAPTCHA doÄŸrulamasÄ± iste"})]}),e.jsxs("label",{className:"toggle-switch",children:[e.jsx("input",{type:"checkbox",checked:t.captcha_on_join,onChange:s=>o({...t,captcha_on_join:s.target.checked})}),e.jsx("span",{className:"slider"})]})]}),e.jsxs("div",{className:"setting-item toggle",children:[e.jsxs("div",{className:"setting-info",children:[e.jsx("label",{children:"KatÄ±lÄ±m UyarÄ± DM"}),e.jsx("p",{children:"ÅžÃ¼pheli hesap katÄ±ldÄ±ÄŸÄ±nda yÃ¶neticilere DM gÃ¶nder"})]}),e.jsxs("label",{className:"toggle-switch",children:[e.jsx("input",{type:"checkbox",checked:t.dm_on_join_warning,onChange:s=>o({...t,dm_on_join_warning:s.target.checked})}),e.jsx("span",{className:"slider"})]})]})]}),e.jsx("div",{className:"settings-actions",children:e.jsx("button",{className:"save-btn",onClick:O,children:"AyarlarÄ± Kaydet"})})]})]})]})})};export{le as default};
