import{r as i,d as e,X as S,as as m,cd as M,bM as P,bS as C,m as I,bT as A,aR as g,i as E,bR as O,v as G,aw as K,dp as W}from"./react-core-DrOm_csO.js";import{g as T,t as b}from"./index-DmEhdEtw.js";const V=({serverId:c,fetchWithAuth:d,apiBaseUrl:f,isAdmin:w=!1})=>{const[l,o]=i.useState({enabled:!0,sensitivity:"medium",actions:{warn:!0,mute:!0,kick:!1,ban:!1},patterns:{rapidMessages:!0,duplicateContent:!0,mentionSpam:!0,linkSpam:!0,capsLock:!0,zalgoText:!0},thresholds:{messagesPerMinute:10,duplicateThreshold:3,mentionLimit:5,linkLimit:3,capsPercentage:70},whitelist:[],customPatterns:[]}),[s,u]=i.useState({totalDetected:0,todayDetected:0,actionsToken:{warn:0,mute:0,kick:0,ban:0},topOffenders:[],recentDetections:[]}),[z,k]=i.useState(!0),[r,R]=i.useState("overview"),L={low:{messagesPerMinute:15,duplicateThreshold:5,mentionLimit:10,linkLimit:5,capsPercentage:80},medium:{messagesPerMinute:10,duplicateThreshold:3,mentionLimit:5,linkLimit:3,capsPercentage:70},high:{messagesPerMinute:7,duplicateThreshold:2,mentionLimit:3,linkLimit:2,capsPercentage:60},aggressive:{messagesPerMinute:5,duplicateThreshold:2,mentionLimit:2,linkLimit:1,capsPercentage:50}},v=i.useCallback(async()=>{k(!0);const a=f||T();try{const n=await d(`${a}/api/servers/${c}/spam-settings/`);if(n.ok){const y=await n.json();o(x=>({...x,...y}))}}catch(n){console.error("Failed to fetch spam settings:",n)}try{const n=await d(`${a}/api/servers/${c}/spam-stats/`);if(n.ok){const y=await n.json();u(x=>({...x,...y}))}else u({totalDetected:0,todayDetected:0,actionsTaken:{warn:0,mute:0,kick:0,ban:0},topOffenders:[],recentDetections:[]})}catch(n){console.error("Failed to fetch spam stats:",n),u({totalDetected:0,todayDetected:0,actionsTaken:{warn:0,mute:0,kick:0,ban:0},topOffenders:[],recentDetections:[]})}k(!1)},[c,d,f]);i.useEffect(()=>{v()},[v]);const D=a=>{o(n=>({...n,sensitivity:a,thresholds:L[a]}))},B=a=>{o(n=>({...n,patterns:{...n.patterns,[a]:!n.patterns[a]}}))},j=a=>{o(n=>({...n,actions:{...n.actions,[a]:!n.actions[a]}}))},F=async()=>{try{const a=f||T();(await d(`${a}/api/servers/${c}/spam-settings/`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)})).ok?b.success("Spam koruma ayarlarÄ± kaydedildi! âœ…"):b.error("Ayarlar kaydedilemedi")}catch(a){console.error("Failed to save settings:",a),b.error("Bir hata oluÅŸtu")}},h=a=>({rapidMessages:e.createElement(W,null),duplicateContent:e.createElement(C,null),mentionSpam:e.createElement(K,null),linkSpam:e.createElement(G,null),capsLock:e.createElement(I,null),zalgoText:e.createElement(O,null)})[a]||e.createElement(m,null),p=a=>({warn:"#faa61a",mute:"#5865f2",kick:"#f04747",ban:"#ed4245"})[a]||"#72767d";return z?e.createElement("div",{style:t.container},e.createElement("div",{style:t.loading},e.createElement(S,{className:"pulse",size:32,color:"#5865f2"}),e.createElement("span",null,"Spam koruma sistemi yÃ¼kleniyor..."))):e.createElement("div",{style:t.container},e.createElement("div",{style:t.header},e.createElement("div",{style:t.headerLeft},e.createElement(m,{size:24,color:"#43b581"}),e.createElement("div",null,e.createElement("h2",{style:t.title},"Spam Koruma Sistemi"),e.createElement("p",{style:t.subtitle},"ML tabanlÄ± akÄ±llÄ± spam algÄ±lama"))),e.createElement("div",{style:t.headerRight},e.createElement("div",{style:{...t.statusBadge,backgroundColor:l.enabled?"rgba(67, 181, 129, 0.2)":"rgba(240, 71, 71, 0.2)",color:l.enabled?"#43b581":"#f04747"}},l.enabled?"âœ“ Aktif":"âœ— KapalÄ±"))),e.createElement("div",{style:t.tabs},["overview","settings","logs"].map(a=>e.createElement("button",{key:a,style:{...t.tab,backgroundColor:r===a?"#5865f2":"transparent",color:r===a?"#fff":"#b9bbbe"},onClick:()=>R(a)},a==="overview"&&e.createElement(M,null),a==="settings"&&e.createElement(P,null),a==="logs"&&e.createElement(C,null),a==="overview"?"Genel BakÄ±ÅŸ":a==="settings"?"Ayarlar":"KayÄ±tlar"))),r==="overview"&&e.createElement("div",{style:t.content},e.createElement("div",{style:t.statsGrid},e.createElement("div",{style:t.statCard},e.createElement("div",{style:t.statIcon},e.createElement(m,{size:20,color:"#43b581"})),e.createElement("div",{style:t.statInfo},e.createElement("div",{style:t.statValue},s.totalDetected),e.createElement("div",{style:t.statLabel},"Toplam Tespit"))),e.createElement("div",{style:t.statCard},e.createElement("div",{style:t.statIcon},e.createElement(I,{size:20,color:"#faa61a"})),e.createElement("div",{style:t.statInfo},e.createElement("div",{style:t.statValue},s.todayDetected),e.createElement("div",{style:t.statLabel},"BugÃ¼n"))),e.createElement("div",{style:t.statCard},e.createElement("div",{style:t.statIcon},e.createElement(A,{size:20,color:"#f04747"})),e.createElement("div",{style:t.statInfo},e.createElement("div",{style:t.statValue},s.actionsTaken?.ban||0),e.createElement("div",{style:t.statLabel},"Ban"))),e.createElement("div",{style:t.statCard},e.createElement("div",{style:t.statIcon},e.createElement(S,{size:20,color:"#5865f2"})),e.createElement("div",{style:t.statInfo},e.createElement("div",{style:t.statValue},Object.values(l.patterns).filter(Boolean).length),e.createElement("div",{style:t.statLabel},"Aktif Kural")))),e.createElement("div",{style:t.section},e.createElement("h3",{style:t.sectionTitle},"Son Tespitler"),e.createElement("div",{style:t.detectionsList},s.recentDetections.map((a,n)=>e.createElement("div",{key:n,style:t.detectionItem},e.createElement("div",{style:t.detectionIcon},h(a.type)),e.createElement("div",{style:t.detectionInfo},e.createElement("div",{style:t.detectionUser},e.createElement("strong",null,a.username),e.createElement("span",{style:t.detectionType},a.type)),e.createElement("div",{style:t.detectionMessage},a.message.substring(0,50),"...")),e.createElement("div",{style:{...t.actionBadge,backgroundColor:p(a.action)}},a.action))))),e.createElement("div",{style:t.section},e.createElement("h3",{style:t.sectionTitle},"En Ã‡ok Ä°hlal Edenler"),e.createElement("div",{style:t.offendersList},s.topOffenders.map((a,n)=>e.createElement("div",{key:n,style:t.offenderItem},e.createElement("div",{style:t.offenderRank},"#",n+1),e.createElement("div",{style:t.offenderInfo},e.createElement("span",{style:t.offenderName},a.username),e.createElement("span",{style:t.offenderCount},a.count," ihlal")),e.createElement("div",{style:{...t.actionBadge,backgroundColor:p(a.lastAction)}},a.lastAction)))))),r==="settings"&&e.createElement("div",{style:t.content},e.createElement("div",{style:t.settingRow},e.createElement("div",{style:t.settingInfo},e.createElement(m,{size:18,color:"#43b581"}),e.createElement("div",null,e.createElement("div",{style:t.settingTitle},"Spam KorumasÄ±"),e.createElement("div",{style:t.settingDesc},"Otomatik spam algÄ±lama ve Ã¶nleme"))),e.createElement("button",{style:{...t.toggleButton,backgroundColor:l.enabled?"#43b581":"#72767d"},onClick:()=>o(a=>({...a,enabled:!a.enabled}))},l.enabled?e.createElement(g,null):e.createElement(E,null))),e.createElement("div",{style:t.section},e.createElement("h3",{style:t.sectionTitle},"Hassasiyet Seviyesi"),e.createElement("div",{style:t.sensitivityGrid},["low","medium","high","aggressive"].map(a=>e.createElement("button",{key:a,style:{...t.sensitivityButton,backgroundColor:l.sensitivity===a?"#5865f2":"#40444b",borderColor:l.sensitivity===a?"#5865f2":"transparent"},onClick:()=>D(a)},a==="low"&&"ðŸ¢ DÃ¼ÅŸÃ¼k",a==="medium"&&"âš–ï¸ Orta",a==="high"&&"ðŸ”¥ YÃ¼ksek",a==="aggressive"&&"âš¡ Agresif")))),e.createElement("div",{style:t.section},e.createElement("h3",{style:t.sectionTitle},"AlgÄ±lama KalÄ±plarÄ±"),e.createElement("div",{style:t.patternsGrid},Object.entries(l.patterns).map(([a,n])=>e.createElement("div",{key:a,style:t.patternItem},e.createElement("div",{style:t.patternInfo},h(a),e.createElement("span",null,a==="rapidMessages"?"HÄ±zlÄ± Mesaj":a==="duplicateContent"?"Tekrarlanan Ä°Ã§erik":a==="mentionSpam"?"Etiket Spam":a==="linkSpam"?"Link Spam":a==="capsLock"?"BÃœYÃœK HARF":"Zalgo Metin")),e.createElement("button",{style:{...t.miniToggle,backgroundColor:n?"#43b581":"#72767d"},onClick:()=>B(a)},n?e.createElement(g,{size:10}):e.createElement(E,{size:10})))))),e.createElement("div",{style:t.section},e.createElement("h3",{style:t.sectionTitle},"Otomatik Eylemler"),e.createElement("div",{style:t.actionsGrid},Object.entries(l.actions).map(([a,n])=>e.createElement("div",{key:a,style:t.actionItem},e.createElement("div",{style:t.actionInfo},e.createElement("div",{style:{...t.actionDot,backgroundColor:p(a)}}),e.createElement("span",null,a==="warn"?"Uyar":a==="mute"?"Sustur":a==="kick"?"At":"Yasakla")),e.createElement("button",{style:{...t.miniToggle,backgroundColor:n?"#43b581":"#72767d"},onClick:()=>j(a)},n?e.createElement(g,{size:10}):e.createElement(E,{size:10})))))),w&&e.createElement("button",{style:t.saveButton,onClick:F},e.createElement(g,null)," AyarlarÄ± Kaydet")),r==="logs"&&e.createElement("div",{style:t.content},e.createElement("div",{style:t.logsHeader},e.createElement("h3",{style:t.sectionTitle},"Spam KayÄ±tlarÄ±"),e.createElement("select",{style:t.filterSelect},e.createElement("option",{value:"all"},"TÃ¼m Eylemler"),e.createElement("option",{value:"warn"},"UyarÄ±lar"),e.createElement("option",{value:"mute"},"Susturmalar"),e.createElement("option",{value:"kick"},"Atmalar"),e.createElement("option",{value:"ban"},"Yasaklamalar"))),e.createElement("div",{style:t.logsList},s.recentDetections.map((a,n)=>e.createElement("div",{key:n,style:t.logItem},e.createElement("div",{style:t.logTime},new Date(a.timestamp).toLocaleString("tr-TR")),e.createElement("div",{style:t.logContent},e.createElement("strong",null,a.username)," - ",a.type,e.createElement("div",{style:t.logMessage},'"',a.message,'"')),e.createElement("div",{style:{...t.actionBadge,backgroundColor:p(a.action)}},a.action))))))},t={container:{backgroundColor:"#2f3136",borderRadius:"8px",overflow:"hidden"},loading:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"16px",padding:"60px",color:"#b9bbbe"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #202225"},headerLeft:{display:"flex",alignItems:"center",gap:"16px"},headerRight:{display:"flex",alignItems:"center"},title:{margin:0,fontSize:"18px",fontWeight:"600",color:"#fff"},subtitle:{margin:"4px 0 0",fontSize:"13px",color:"#72767d"},statusBadge:{padding:"6px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},tabs:{display:"flex",padding:"0 20px",borderBottom:"1px solid #202225",gap:"8px"},tab:{display:"flex",alignItems:"center",gap:"8px",padding:"12px 16px",border:"none",borderRadius:"4px 4px 0 0",cursor:"pointer",fontSize:"13px",fontWeight:"500",transition:"all 0.15s"},content:{padding:"20px"},statsGrid:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"12px",marginBottom:"24px"},statCard:{display:"flex",alignItems:"center",gap:"12px",padding:"16px",backgroundColor:"#202225",borderRadius:"8px"},statIcon:{display:"flex",alignItems:"center",justifyContent:"center",width:"40px",height:"40px",backgroundColor:"#36393f",borderRadius:"8px"},statInfo:{flex:1},statValue:{fontSize:"20px",fontWeight:"700",color:"#fff"},statLabel:{fontSize:"12px",color:"#72767d"},section:{marginBottom:"24px"},sectionTitle:{margin:"0 0 16px",fontSize:"14px",fontWeight:"600",color:"#fff",textTransform:"uppercase",letterSpacing:"0.5px"},detectionsList:{display:"flex",flexDirection:"column",gap:"8px"},detectionItem:{display:"flex",alignItems:"center",gap:"12px",padding:"12px 16px",backgroundColor:"#202225",borderRadius:"6px"},detectionIcon:{color:"#faa61a"},detectionInfo:{flex:1},detectionUser:{display:"flex",alignItems:"center",gap:"8px",color:"#fff",fontSize:"14px"},detectionType:{fontSize:"11px",color:"#72767d",backgroundColor:"#40444b",padding:"2px 6px",borderRadius:"3px"},detectionMessage:{fontSize:"12px",color:"#72767d",marginTop:"4px"},actionBadge:{padding:"4px 10px",borderRadius:"4px",color:"#fff",fontSize:"11px",fontWeight:"600",textTransform:"uppercase"},offendersList:{display:"flex",flexDirection:"column",gap:"8px"},offenderItem:{display:"flex",alignItems:"center",gap:"12px",padding:"12px 16px",backgroundColor:"#202225",borderRadius:"6px"},offenderRank:{width:"28px",height:"28px",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#40444b",borderRadius:"50%",fontSize:"12px",fontWeight:"600",color:"#fff"},offenderInfo:{flex:1,display:"flex",flexDirection:"column"},offenderName:{color:"#fff",fontSize:"14px",fontWeight:"500"},offenderCount:{color:"#72767d",fontSize:"12px"},settingRow:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px",backgroundColor:"#202225",borderRadius:"8px",marginBottom:"16px"},settingInfo:{display:"flex",alignItems:"center",gap:"12px"},settingTitle:{color:"#fff",fontSize:"14px",fontWeight:"500"},settingDesc:{color:"#72767d",fontSize:"12px"},toggleButton:{width:"44px",height:"24px",border:"none",borderRadius:"12px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",transition:"background-color 0.2s"},sensitivityGrid:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"8px"},sensitivityButton:{padding:"12px",border:"2px solid transparent",borderRadius:"8px",cursor:"pointer",color:"#fff",fontSize:"13px",fontWeight:"500",transition:"all 0.15s"},patternsGrid:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"8px"},patternItem:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 16px",backgroundColor:"#202225",borderRadius:"6px"},patternInfo:{display:"flex",alignItems:"center",gap:"10px",color:"#dcddde",fontSize:"13px"},miniToggle:{width:"28px",height:"18px",border:"none",borderRadius:"9px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",transition:"background-color 0.2s"},actionsGrid:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"8px"},actionItem:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 16px",backgroundColor:"#202225",borderRadius:"6px"},actionInfo:{display:"flex",alignItems:"center",gap:"8px",color:"#dcddde",fontSize:"13px"},actionDot:{width:"8px",height:"8px",borderRadius:"50%"},saveButton:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",width:"100%",padding:"12px",backgroundColor:"#43b581",border:"none",borderRadius:"4px",color:"#fff",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"background-color 0.15s"},logsHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},filterSelect:{padding:"8px 12px",backgroundColor:"#202225",border:"1px solid #40444b",borderRadius:"4px",color:"#dcddde",fontSize:"13px"},logsList:{display:"flex",flexDirection:"column",gap:"8px"},logItem:{display:"flex",alignItems:"flex-start",gap:"12px",padding:"12px 16px",backgroundColor:"#202225",borderRadius:"6px"},logTime:{fontSize:"11px",color:"#72767d",whiteSpace:"nowrap"},logContent:{flex:1,fontSize:"13px",color:"#dcddde"},logMessage:{fontSize:"12px",color:"#72767d",marginTop:"4px",fontStyle:"italic"}};export{V as default};
