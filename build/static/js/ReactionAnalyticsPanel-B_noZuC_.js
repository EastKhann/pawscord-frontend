import{r as n,n as e}from"./react-core-zXIKm1Jm.js";import{N as D,a as z,bt as F,bp as B,O as $,bu as T}from"./icons-vendor-BNHs0e-7.js";import{t as h}from"./index-CEfc8aoh.js";import"./editor-vendor-DiU449Dh.js";import"./media-vendor-BSOZ7IB3.js";import"./router-vendor-ltdGXAv4.js";import"./crypto-vendor-D_AcF0lD.js";import"./state-vendor-8NbFPBhQ.js";const X=({fetchWithAuth:l,apiBaseUrl:d,onClose:j,roomSlug:c})=>{const[i,v]=n.useState(null),[p,C]=n.useState([]),[f,S]=n.useState([]),[w,y]=n.useState(!1),[o,x]=n.useState("heatmap");n.useEffect(()=>{L(),R(),k()},[c]);const L=async()=>{y(!0);try{const s=await(await l(`${d}/rooms/${c}/reaction_heatmap/`)).json();v(s)}catch{h.error("Failed to load reaction heatmap")}finally{y(!1)}},R=async()=>{try{const s=await(await l(`${d}/rooms/${c}/reactions/daily/`)).json();C(s.stats||[])}catch{h.error("Failed to load daily stats")}},k=async()=>{try{const s=await(await l(`${d}/leaderboards/reactions/`)).json();S(s.leaderboard||[])}catch{h.error("Failed to load leaderboard")}},m=(a,s)=>{const r=a/s*100;return r>75?"#f04747":r>50?"#faa61a":r>25?"#5865f2":"#2c2f33"},g=Array.from({length:24},(a,s)=>s),b=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];return e.jsx("div",{style:t.overlay,children:e.jsxs("div",{style:t.modal,children:[e.jsxs("div",{style:t.header,children:[e.jsxs("div",{style:t.headerLeft,children:[e.jsx(D,{style:{marginRight:"10px",color:"#5865f2"}}),e.jsx("h2",{style:t.title,children:"Reaction Analytics"})]}),e.jsx("button",{onClick:j,style:t.closeButton,children:e.jsx(z,{})})]}),e.jsxs("div",{style:t.tabs,children:[e.jsxs("button",{onClick:()=>x("heatmap"),style:{...t.tab,...o==="heatmap"&&t.tabActive},children:[e.jsx(F,{style:{marginRight:"5px"}}),"Heatmap"]}),e.jsxs("button",{onClick:()=>x("daily"),style:{...t.tab,...o==="daily"&&t.tabActive},children:[e.jsx(B,{style:{marginRight:"5px"}}),"Daily Stats"]}),e.jsxs("button",{onClick:()=>x("leaderboard"),style:{...t.tab,...o==="leaderboard"&&t.tabActive},children:[e.jsx($,{style:{marginRight:"5px"}}),"Leaderboard"]})]}),e.jsx("div",{style:t.content,children:w?e.jsx("div",{style:t.loading,children:"Loading analytics..."}):o==="heatmap"?e.jsxs("div",{style:t.heatmapContainer,children:[e.jsxs("div",{style:t.heatmapGrid,children:[e.jsx("div",{style:t.heatmapYAxis,children:b.map(a=>e.jsx("div",{style:t.dayLabel,children:a},a))}),e.jsxs("div",{style:t.heatmapCells,children:[i&&i.data&&b.map((a,s)=>e.jsx("div",{style:t.heatmapRow,children:g.map(r=>{const u=i.data[s]?.[r]||0,A=Math.max(...i.data.flat().filter(I=>I)||[1]);return e.jsx("div",{style:{...t.heatmapCell,backgroundColor:m(u,A)},title:`${a} ${r}:00 - ${u} reactions`},r)})},a)),e.jsx("div",{style:t.heatmapXAxis,children:g.filter(a=>a%3===0).map(a=>e.jsxs("div",{style:t.hourLabel,children:[a,"h"]},a))})]})]}),e.jsxs("div",{style:t.legend,children:[e.jsx("span",{style:t.legendLabel,children:"Less"}),[0,25,50,75,100].map(a=>e.jsx("div",{style:{...t.legendBox,backgroundColor:m(a,100)}},a)),e.jsx("span",{style:t.legendLabel,children:"More"})]})]}):o==="daily"?e.jsx("div",{style:t.dailyStats,children:p.length===0?e.jsx("div",{style:t.empty,children:"No daily stats available"}):e.jsx("div",{style:t.chartContainer,children:p.map((a,s)=>e.jsxs("div",{style:t.statBar,children:[e.jsx("div",{style:t.statDate,children:new Date(a.date).toLocaleDateString()}),e.jsx("div",{style:t.barContainer,children:e.jsx("div",{style:{...t.bar,width:`${a.count/Math.max(...p.map(r=>r.count))*100}%`}})}),e.jsx("div",{style:t.statCount,children:a.count})]},s))})}):e.jsx("div",{style:t.leaderboard,children:f.length===0?e.jsx("div",{style:t.empty,children:"No leaderboard data available"}):f.map((a,s)=>e.jsxs("div",{style:t.leaderboardItem,children:[e.jsx("div",{style:t.rank,children:s===0?"ðŸ¥‡":s===1?"ðŸ¥ˆ":s===2?"ðŸ¥‰":`#${s+1}`}),e.jsxs("div",{style:t.userInfo,children:[e.jsx("div",{style:t.username,children:a.username}),e.jsxs("div",{style:t.userReactions,children:[e.jsx(T,{style:{color:"#f04747",marginRight:"5px"}}),a.reaction_count," reactions"]})]})]},s))})})]})})},t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999},modal:{backgroundColor:"#1e1e1e",borderRadius:"8px",width:"90%",maxWidth:"1000px",maxHeight:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #2c2f33"},headerLeft:{display:"flex",alignItems:"center"},title:{margin:0,fontSize:"20px",color:"#ffffff"},closeButton:{background:"none",border:"none",color:"#99aab5",cursor:"pointer",fontSize:"20px",padding:"5px"},tabs:{display:"flex",borderBottom:"1px solid #2c2f33",padding:"0 20px"},tab:{padding:"12px 20px",backgroundColor:"transparent",border:"none",color:"#99aab5",cursor:"pointer",fontSize:"14px",display:"flex",alignItems:"center",borderBottom:"2px solid transparent"},tabActive:{color:"#5865f2",borderBottom:"2px solid #5865f2"},content:{padding:"20px",overflowY:"auto",flex:1},loading:{textAlign:"center",color:"#99aab5",padding:"40px"},empty:{textAlign:"center",color:"#99aab5",padding:"40px"},heatmapContainer:{display:"flex",flexDirection:"column",gap:"20px"},heatmapGrid:{display:"flex",gap:"10px"},heatmapYAxis:{display:"flex",flexDirection:"column",justifyContent:"space-around"},dayLabel:{fontSize:"12px",color:"#99aab5",height:"20px",display:"flex",alignItems:"center"},heatmapCells:{flex:1},heatmapRow:{display:"flex",gap:"2px",marginBottom:"2px"},heatmapCell:{width:"20px",height:"20px",borderRadius:"2px",cursor:"pointer"},heatmapXAxis:{display:"flex",justifyContent:"space-around",marginTop:"5px"},hourLabel:{fontSize:"11px",color:"#99aab5"},legend:{display:"flex",alignItems:"center",gap:"5px",justifyContent:"center"},legendLabel:{fontSize:"12px",color:"#99aab5"},legendBox:{width:"15px",height:"15px",borderRadius:"2px"},dailyStats:{display:"flex",flexDirection:"column"},chartContainer:{display:"flex",flexDirection:"column",gap:"12px"},statBar:{display:"grid",gridTemplateColumns:"100px 1fr 60px",alignItems:"center",gap:"12px"},statDate:{fontSize:"13px",color:"#dcddde"},barContainer:{height:"24px",backgroundColor:"#2c2f33",borderRadius:"4px",overflow:"hidden"},bar:{height:"100%",backgroundColor:"#5865f2",transition:"width 0.3s"},statCount:{fontSize:"14px",fontWeight:"600",color:"#ffffff",textAlign:"right"},leaderboard:{display:"flex",flexDirection:"column",gap:"12px"},leaderboardItem:{backgroundColor:"#2c2f33",borderRadius:"6px",padding:"16px",display:"flex",alignItems:"center",gap:"16px"},rank:{fontSize:"24px",fontWeight:"600",minWidth:"60px",textAlign:"center"},userInfo:{flex:1},username:{fontSize:"16px",fontWeight:"600",color:"#ffffff",marginBottom:"4px"},userReactions:{fontSize:"14px",color:"#99aab5",display:"flex",alignItems:"center"}};export{X as default};
