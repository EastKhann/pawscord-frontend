import{r,d as e}from"./react-core-DrOm_csO.js";import{p as A}from"./index-DmEhdEtw.js";const T=({username:d,onEdit:g,compact:N=!1})=>{const[n,h]=r.useState(null),[y,S]=r.useState(!0),b=A;if(r.useEffect(()=>{(async()=>{try{const l=localStorage.getItem("access_token"),k=d?`${b}/profile/card/${d}/`:`${b}/profile/card/`,o=await fetch(k,{headers:{Authorization:`Bearer ${l}`}});o.ok&&h(await o.json())}catch(l){console.error("Failed to load profile:",l)}S(!1)})()},[d,b]),y)return e.createElement("div",{className:"profile-card loading"},e.createElement("div",{className:"loading-spinner"}));if(!n)return e.createElement("div",{className:"profile-card error"},"Profil yÃ¼klenemedi");const E=n.custom_colors||n.theme_colors;return e.createElement("div",{className:`profile-card ${N?"compact":""}`,style:{"--primary":E.primary,"--secondary":E.secondary,"--accent":E.accent,"--bg":E.background}},e.createElement("div",{className:"card-banner",style:{backgroundImage:n.banner?`url(${n.banner})`:void 0,backgroundColor:n.banner_color}},g&&e.createElement("button",{className:"edit-btn",onClick:g},"âœï¸")),e.createElement("div",{className:"card-avatar"},e.createElement("img",{src:n.avatar||"/default-avatar.png",alt:""}),n.status_text&&e.createElement("div",{className:"status-indicator",title:n.status_text},n.status_text.slice(0,1))),e.createElement("div",{className:"card-content"},n.badges&&n.badges.length>0&&e.createElement("div",{className:"card-badges"},n.badges.map(c=>{const l=D[c];return l?e.createElement("span",{key:c,className:"badge",style:{backgroundColor:l.color},title:l.name},l.icon):null})),e.createElement("h2",{className:"card-name"},n.display_name||n.username),e.createElement("p",{className:"card-username"},"@",n.username),n.bio&&e.createElement("p",{className:"card-bio"},n.bio),e.createElement("div",{className:"card-stats"},e.createElement("div",{className:"stat"},e.createElement("span",{className:"stat-value"},"Lv.",n.level),e.createElement("span",{className:"stat-label"},"Seviye")),e.createElement("div",{className:"stat"},e.createElement("span",{className:"stat-value"},n.xp?.toLocaleString()),e.createElement("span",{className:"stat-label"},"XP")),e.createElement("div",{className:"stat"},e.createElement("span",{className:"stat-value"},new Date(n.created_at).toLocaleDateString("tr-TR",{month:"short",year:"numeric"})),e.createElement("span",{className:"stat-label"},"KatÄ±lÄ±m"))),n.links&&n.links.length>0&&e.createElement("div",{className:"card-links"},n.links.map((c,l)=>e.createElement("a",{key:l,href:c.url,target:"_blank",rel:"noopener noreferrer",className:"link-item",title:c.name},c.icon))),n.spotify_connected&&e.createElement("div",{className:"spotify-badge"},"ðŸŽµ Spotify BaÄŸlÄ±"),n.is_premium&&e.createElement("div",{className:"premium-badge"},"ðŸ’Ž Premium")))},D={early_supporter:{name:"Early Supporter",icon:"ðŸŒŸ",color:"#FFD700"},premium:{name:"Premium",icon:"ðŸ’Ž",color:"#a855f7"},verified:{name:"Verified",icon:"âœ“",color:"#5865F2"},developer:{name:"Developer",icon:"ðŸ› ï¸",color:"#3b82f6"},bug_hunter:{name:"Bug Hunter",icon:"ðŸ›",color:"#22c55e"},top_contributor:{name:"Top Contributor",icon:"ðŸ†",color:"#f59e0b"},server_owner:{name:"Server Owner",icon:"ðŸ‘‘",color:"#ef4444"},moderator:{name:"Moderator",icon:"ðŸ›¡ï¸",color:"#10b981"},artist:{name:"Artist",icon:"ðŸŽ¨",color:"#ec4899"},streamer:{name:"Streamer",icon:"ðŸ“º",color:"#8b5cf6"}},F=({onClose:d,onSave:g})=>{const[N,n]=r.useState(null),[h,y]=r.useState([]),[S,b]=r.useState([]),[E,c]=r.useState(!0),[l,k]=r.useState(!1),[o,_]=r.useState("appearance"),[i,p]=r.useState({banner:"",banner_color:"#5865F2",theme:"default",bio:"",links:[]}),[C,w]=r.useState([]),[v,$]=r.useState({name:"",url:""}),u=A,B=r.useCallback(async()=>{try{const a=localStorage.getItem("access_token"),[t,m,f]=await Promise.all([fetch(`${u}/profile/card/`,{headers:{Authorization:`Bearer ${a}`}}),fetch(`${u}/profile/themes/`,{headers:{Authorization:`Bearer ${a}`}}),fetch(`${u}/profile/badges/`,{headers:{Authorization:`Bearer ${a}`}})]);if(t.ok){const s=await t.json();n(s),p({banner:s.banner||"",banner_color:s.banner_color||"#5865F2",theme:s.theme||"default",bio:s.bio||"",links:s.links||[]}),w(s.badges||[])}if(m.ok){const s=await m.json();y(s.themes||[])}if(f.ok){const s=await f.json();b(s.badges||[])}}catch(a){console.error("Failed to load data:",a)}c(!1)},[u]),P=async()=>{k(!0);try{const a=localStorage.getItem("access_token"),t=await fetch(`${u}/profile/card/update/`,{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify(i)});await fetch(`${u}/profile/badges/set/`,{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify({badges:C})}),t.ok&&(g?.(),d())}catch(a){console.error("Save failed:",a)}k(!1)},z=async()=>{if(v.url)try{const a=localStorage.getItem("access_token"),t=await fetch(`${u}/profile/links/add/`,{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify(v)});if(t.ok){const m=await t.json();p(f=>({...f,links:m.links})),$({name:"",url:""})}}catch(a){console.error("Add link failed:",a)}},L=async a=>{try{const t=localStorage.getItem("access_token"),m=await fetch(`${u}/profile/links/${a}/remove/`,{method:"DELETE",headers:{Authorization:`Bearer ${t}`}});if(m.ok){const f=await m.json();p(s=>({...s,links:f.links}))}}catch(t){console.error("Remove link failed:",t)}},R=a=>{w(t=>t.includes(a)?t.filter(m=>m!==a):t.length>=3?t:[...t,a])};return r.useEffect(()=>{B()},[B]),E?e.createElement("div",{className:"profile-editor-modal"},e.createElement("div",{className:"editor-loading"},e.createElement("div",{className:"loading-spinner"}))):e.createElement("div",{className:"profile-editor-overlay",onClick:a=>a.target===a.currentTarget&&d()},e.createElement("div",{className:"profile-editor-modal"},e.createElement("div",{className:"editor-header"},e.createElement("h2",null,"ðŸŽ¨ Profil KartÄ± DÃ¼zenle"),e.createElement("button",{className:"close-btn",onClick:d},"Ã—")),e.createElement("div",{className:"editor-tabs"},e.createElement("button",{className:o==="appearance"?"active":"",onClick:()=>_("appearance")},"ðŸŽ¨ GÃ¶rÃ¼nÃ¼m"),e.createElement("button",{className:o==="badges"?"active":"",onClick:()=>_("badges")},"ðŸ… Rozetler"),e.createElement("button",{className:o==="links"?"active":"",onClick:()=>_("links")},"ðŸ”— BaÄŸlantÄ±lar")),e.createElement("div",{className:"editor-content"},o==="appearance"&&e.createElement("div",{className:"appearance-tab"},e.createElement("div",{className:"form-group"},e.createElement("label",null,"Banner URL"),e.createElement("input",{type:"url",placeholder:"https://...",value:i.banner,onChange:a=>p(t=>({...t,banner:a.target.value}))})),e.createElement("div",{className:"form-group"},e.createElement("label",null,"Banner Rengi (resim yoksa)"),e.createElement("div",{className:"color-picker"},e.createElement("input",{type:"color",value:i.banner_color,onChange:a=>p(t=>({...t,banner_color:a.target.value}))}),e.createElement("span",null,i.banner_color))),e.createElement("div",{className:"form-group"},e.createElement("label",null,"Tema"),e.createElement("div",{className:"theme-grid"},h.map(a=>e.createElement("div",{key:a.id,className:`theme-option ${i.theme===a.id?"selected":""}`,onClick:()=>p(t=>({...t,theme:a.id})),style:{background:`linear-gradient(135deg, ${a.primary}, ${a.secondary})`}},e.createElement("span",{className:"theme-name"},a.id),e.createElement("div",{className:"theme-colors"},e.createElement("span",{style:{backgroundColor:a.accent}})))))),e.createElement("div",{className:"form-group"},e.createElement("label",null,"Biyografi"),e.createElement("textarea",{placeholder:"Kendiniz hakkÄ±nda bir ÅŸeyler yazÄ±n...",value:i.bio,onChange:a=>p(t=>({...t,bio:a.target.value.slice(0,500)})),rows:4,maxLength:500}),e.createElement("span",{className:"char-count"},i.bio.length,"/500"))),o==="badges"&&e.createElement("div",{className:"badges-tab"},e.createElement("p",{className:"badges-hint"},"Profilinizde gÃ¶rÃ¼ntÃ¼lenecek en fazla 3 rozet seÃ§in"),e.createElement("div",{className:"badges-grid"},S.map(a=>e.createElement("div",{key:a.id,className:`badge-option ${a.owned?"":"locked"} ${C.includes(a.id)?"selected":""}`,onClick:()=>a.owned&&R(a.id)},e.createElement("span",{className:"badge-icon",style:{backgroundColor:a.color}},a.icon),e.createElement("span",{className:"badge-name"},a.name),!a.owned&&e.createElement("span",{className:"lock-icon"},"ðŸ”’"))))),o==="links"&&e.createElement("div",{className:"links-tab"},e.createElement("p",{className:"links-hint"},"En fazla 5 baÄŸlantÄ± ekleyebilirsiniz"),e.createElement("div",{className:"current-links"},i.links.map((a,t)=>e.createElement("div",{key:t,className:"link-row"},e.createElement("span",{className:"link-icon"},a.icon),e.createElement("span",{className:"link-name"},a.name),e.createElement("a",{href:a.url,target:"_blank",rel:"noopener noreferrer",className:"link-url"},a.url.slice(0,40),"..."),e.createElement("button",{className:"remove-link",onClick:()=>L(t)},"Ã—")))),i.links.length<5&&e.createElement("div",{className:"add-link-form"},e.createElement("input",{type:"text",placeholder:"Ä°sim (opsiyonel)",value:v.name,onChange:a=>$(t=>({...t,name:a.target.value}))}),e.createElement("input",{type:"url",placeholder:"URL",value:v.url,onChange:a=>$(t=>({...t,url:a.target.value}))}),e.createElement("button",{onClick:z},"Ekle")))),e.createElement("div",{className:"editor-preview"},e.createElement("h4",null,"Ã–nizleme"),e.createElement(T,{username:N?.username,compact:!0})),e.createElement("div",{className:"editor-footer"},e.createElement("button",{className:"cancel-btn",onClick:d},"Ä°ptal"),e.createElement("button",{className:"save-btn",onClick:P,disabled:l},l?"Kaydediliyor...":"Kaydet"))))};export{T as ProfileCard,F as ProfileCardEditor,T as default};
