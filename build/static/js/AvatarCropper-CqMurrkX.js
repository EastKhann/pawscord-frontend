import{r as s,bE as b}from"./react-core-B6hadH-M.js";const k=({onCropComplete:R,onCancel:u,imageFile:p})=>{const[h,f]=s.useState(null),[w,v]=s.useState({unit:"%",width:50,aspect:1}),[l,E]=s.useState(null),m=s.useRef(null),d=s.useRef(null);s.useEffect(()=>{if(p){const e=new FileReader;e.addEventListener("load",()=>{f(e.result)}),e.readAsDataURL(p)}},[p]);const x=s.useCallback(e=>{m.current=e;const c=e.width,t=e.height,n=Math.min(c,t),i=(c-n)/2,r=(t-n)/2,a={unit:"px",width:n,height:n,x:i,y:r,aspect:1};v(a),E(a)},[]);s.useEffect(()=>{if(!l||!m.current||!d.current)return;const e=m.current,c=d.current,t=l,n=e.naturalWidth/e.width,i=e.naturalHeight/e.height,r=c.getContext("2d"),a=window.devicePixelRatio||1,o=180;c.width=o*a,c.height=o*a,r.setTransform(a,0,0,a,0,0),r.imageSmoothingQuality="high",r.drawImage(e,t.x*n,t.y*i,t.width*n,t.height*i,0,0,o,o)},[l]);const y=s.useCallback(async()=>{if(!l||!m.current||!d.current)return;const e=m.current,c=d.current,t=l,n=e.naturalWidth/e.width,i=e.naturalHeight/e.height,r=c.getContext("2d"),a=window.devicePixelRatio,o=512;return c.width=o*a,c.height=o*a,r.setTransform(a,0,0,a,0,0),r.imageSmoothingQuality="high",r.drawImage(e,t.x*n,t.y*i,t.width*n,t.height*i,0,0,o,o),new Promise(C=>{c.toBlob(g=>{if(!g){console.error("Canvas is empty");return}g.name="avatar.png",R(g),C()},"image/png",1)})},[l,R]);return React.createElement("div",{className:"avatar-cropper-modal",onClick:u},React.createElement("div",{className:"avatar-cropper-content",onClick:e=>e.stopPropagation()},React.createElement("div",{className:"avatar-cropper-header"},React.createElement("h2",null,"üì∏ Profil Fotoƒürafƒ±nƒ± D√ºzenle"),React.createElement("button",{className:"close-btn",onClick:u},"√ó")),React.createElement("div",{className:"avatar-cropper-body"},!h&&React.createElement("div",{style:{padding:"40px",textAlign:"center",color:"#dcddde"}},React.createElement("div",{style:{fontSize:"48px",marginBottom:"16px"}},"‚è≥"),React.createElement("p",null,"Fotoƒüraf y√ºkleniyor..."),!p&&React.createElement("p",{style:{color:"#f04747",marginTop:"8px"}},"‚ö†Ô∏è Dosya bulunamadƒ±!")),h&&React.createElement(React.Fragment,null,React.createElement("div",{className:"crop-container"},React.createElement(b,{crop:w,onChange:e=>v(e),onComplete:e=>E(e),aspect:1,circularCrop:!1,keepSelection:!0,minWidth:100,minHeight:100},React.createElement("img",{ref:m,src:h,alt:"Crop",onLoad:e=>x(e.currentTarget),style:{maxWidth:"100%",maxHeight:"55vh",display:"block",objectFit:"contain"}}))),React.createElement("div",{className:"preview-section"},React.createElement("h3",null,"√ñnizleme:"),React.createElement("div",{className:"preview-container"},React.createElement("canvas",{ref:d,style:{width:180,height:180,borderRadius:"50%",objectFit:"cover"}})),React.createElement("p",{className:"preview-note"},"‚ÑπÔ∏è Tam kare (1:1)")))),h&&React.createElement("div",{className:"avatar-cropper-footer"},React.createElement("button",{className:"btn-secondary",onClick:u},"ƒ∞ptal"),React.createElement("button",{className:"btn-primary",onClick:y},"‚úì Kaydet"))))};export{k as default};
