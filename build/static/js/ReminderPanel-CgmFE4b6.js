var S=Object.defineProperty;var t=(i,h)=>S(i,"name",{value:h,configurable:!0});import{r as c,j as e}from"./react-core-Djgtqrmb.js";import{y as n}from"./ui-vendor-IhB9Znpc.js";import{g as $,d as B}from"./index-Bohqi95c.js";import"./media-vendor-CxFPycob.js";import"./router-vendor-gmJ9Mn-1.js";import"./state-vendor-CbW2fAN9.js";import"./crypto-vendor-D1XRGppi.js";import"./icons-vendor-BMXAt4pj.js";const D=t(({serverId:i,onClose:h})=>{const o=$(),[p,j]=c.useState([]),[g,d]=c.useState(!1),[s,l]=c.useState({title:"",description:"",remind_at:"",repeat:"once",channel_id:"",mention_user_id:""}),[u,f]=c.useState([]),[k,v]=c.useState(!0);c.useEffect(()=>{m(),N()},[i]);const m=t(async()=>{try{const a=await fetch(`${o}/reminders/server/${i}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(a.ok){const r=await a.json();j(r)}}catch{}finally{v(!1)}},"fetchReminders"),N=t(async()=>{try{const a=await fetch(`${o}/channels/server/${i}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(a.ok){const r=await a.json();f(r.filter(w=>w.type==="text"))}}catch{}},"fetchChannels"),y=t(async()=>{if(!s.title||!s.remind_at||!s.channel_id){n.error("âŒ LÃ¼tfen gerekli alanlarÄ± doldurun");return}try{(await fetch(`${o}/reminders/create/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`,"Content-Type":"application/json"},body:JSON.stringify({server_id:i,...s})})).ok?(n.success("âœ… HatÄ±rlatÄ±cÄ± oluÅŸturuldu"),d(!1),m(),l({title:"",description:"",remind_at:"",repeat:"once",channel_id:"",mention_user_id:""})):n.error("âŒ OluÅŸturma hatasÄ±")}catch{n.error("âŒ BaÄŸlantÄ± hatasÄ±")}},"createReminder"),b=t(async a=>{if(await B("HatÄ±rlatÄ±cÄ±yÄ± silmek istediÄŸinize emin misiniz?"))try{(await fetch(`${o}/reminders/${a}/delete/`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}})).ok&&(n.success("âœ… HatÄ±rlatÄ±cÄ± silindi"),m())}catch{n.error("âŒ Silme hatasÄ±")}},"deleteReminder"),_=t(async a=>{try{(await fetch(`${o}/reminders/${a}/trigger/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}})).ok&&n.success("âœ… HatÄ±rlatÄ±cÄ± tetiklendi")}catch{n.error("âŒ Tetikleme hatasÄ±")}},"triggerNow"),C=t(a=>new Date(a).toLocaleString("tr-TR"),"formatTime"),x=t(a=>{const r={once:{text:"Bir kez",color:"#6b7280"},daily:{text:"GÃ¼nlÃ¼k",color:"#3b82f6"},weekly:{text:"HaftalÄ±k",color:"#8b5cf6"},monthly:{text:"AylÄ±k",color:"#ec4899"}};return r[a]||r.once},"getRepeatBadge");return e.jsx("div",{className:"reminder-overlay",onClick:h,children:e.jsxs("div",{className:"reminder-panel",onClick:t(a=>a.stopPropagation(),"onClick"),children:[e.jsxs("div",{className:"reminder-header",children:[e.jsx("h2",{children:"â° HatÄ±rlatÄ±cÄ±lar"}),e.jsx("button",{className:"close-btn",onClick:h,children:"Ã—"})]}),e.jsxs("div",{className:"reminder-content",children:[e.jsx("button",{className:"create-reminder-btn",onClick:t(()=>d(!0),"onClick"),children:"+ Yeni HatÄ±rlatÄ±cÄ±"}),k?e.jsxs("div",{className:"loading-state",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{children:"YÃ¼kleniyor..."})]}):p.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("span",{className:"empty-icon",children:"â°"}),e.jsx("p",{children:"HenÃ¼z hatÄ±rlatÄ±cÄ± yok"})]}):e.jsx("div",{className:"reminders-list",children:p.map(a=>e.jsxs("div",{className:"reminder-card",children:[e.jsxs("div",{className:"reminder-main",children:[e.jsx("h3",{children:a.title}),a.description&&e.jsx("p",{children:a.description}),e.jsxs("div",{className:"reminder-meta",children:[e.jsxs("span",{children:["â° ",C(a.remind_at)]}),e.jsxs("span",{children:["ğŸ“ ",u.find(r=>r.id===a.channel_id)?.name]}),e.jsxs("span",{className:"repeat-badge",style:{background:x(a.repeat).color},children:["ğŸ”„ ",x(a.repeat).text]})]})]}),e.jsxs("div",{className:"reminder-actions",children:[e.jsx("button",{className:"trigger-btn",onClick:t(()=>_(a.id),"onClick"),children:"â–¶ï¸ Tetikle"}),e.jsx("button",{className:"delete-btn",onClick:t(()=>b(a.id),"onClick"),children:"ğŸ—‘ï¸"})]})]},a.id))})]}),g&&e.jsx("div",{className:"create-modal-overlay",onClick:t(()=>d(!1),"onClick"),children:e.jsxs("div",{className:"create-modal",onClick:t(a=>a.stopPropagation(),"onClick"),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:"Yeni HatÄ±rlatÄ±cÄ±"}),e.jsx("button",{className:"close-btn",onClick:t(()=>d(!1),"onClick"),children:"Ã—"})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"BaÅŸlÄ±k *"}),e.jsx("input",{value:s.title,onChange:t(a=>l({...s,title:a.target.value}),"onChange")})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"AÃ§Ä±klama"}),e.jsx("textarea",{value:s.description,onChange:t(a=>l({...s,description:a.target.value}),"onChange"),rows:"3"})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Tarih/Saat *"}),e.jsx("input",{type:"datetime-local",value:s.remind_at,onChange:t(a=>l({...s,remind_at:a.target.value}),"onChange")})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Tekrar"}),e.jsxs("select",{value:s.repeat,onChange:t(a=>l({...s,repeat:a.target.value}),"onChange"),children:[e.jsx("option",{value:"once",children:"Bir kez"}),e.jsx("option",{value:"daily",children:"GÃ¼nlÃ¼k"}),e.jsx("option",{value:"weekly",children:"HaftalÄ±k"}),e.jsx("option",{value:"monthly",children:"AylÄ±k"})]})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kanal *"}),e.jsxs("select",{value:s.channel_id,onChange:t(a=>l({...s,channel_id:a.target.value}),"onChange"),children:[e.jsx("option",{value:"",children:"SeÃ§in"}),u.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"cancel-btn",onClick:t(()=>d(!1),"onClick"),children:"Ä°ptal"}),e.jsx("button",{className:"submit-btn",onClick:y,children:"â° OluÅŸtur"})]})]})})]})})},"ReminderPanel");export{D as default};
