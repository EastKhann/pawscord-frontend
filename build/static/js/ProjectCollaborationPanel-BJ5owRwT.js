import{r,d4 as L,l as _,aI as T,cn as A,c9 as P,K as O,Y as J,b$ as M}from"./react-core-B6hadH-M.js";import{t as o}from"./index-D_6pZib5.js";const G=({fetchWithAuth:s,apiBaseUrl:i,onClose:F,serverId:b})=>{const[g,B]=r.useState([]),[c,R]=r.useState(null),[E,I]=r.useState([]),[a,x]=r.useState(null),[d,n]=r.useState("projects"),[p,m]=r.useState(!1),[f,j]=r.useState(""),[v,C]=r.useState(""),[y,h]=r.useState(""),[S,k]=r.useState("");r.useEffect(()=>{D()},[]);const D=async()=>{try{const l=await(await s(`${i}/projects/?server_id=${b}`)).json();B(l.projects||[])}catch(t){console.error("Failed to fetch projects:",t)}},w=async t=>{try{const u=await(await s(`${i}/projects/${t}/`)).json();R(u.project),I(u.documents||[]),n("project-detail")}catch{o.error("Failed to load project")}},z=async()=>{if(!f.trim()){o.error("Project name required");return}m(!0);try{(await(await s(`${i}/projects/create/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:f,description:v,server_id:b})})).json()).project&&(o.success("Project created!"),j(""),C(""),n("projects"),D())}catch{o.error("Failed to create project")}finally{m(!1)}},N=async()=>{if(!y.trim()){o.error("Document title required");return}m(!0);try{(await(await s(`${i}/documents/create/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:y,content:S,project_id:c?.id})})).json()).document&&(o.success("Document created!"),h(""),k(""),w(c.id))}catch{o.error("Failed to create document")}finally{m(!1)}},$=async t=>{try{const u=await(await s(`${i}/documents/${t}/`)).json();x(u.document),n("document")}catch{o.error("Failed to load document")}},H=async()=>{if(a)try{await s(`${i}/documents/${a.id}/`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:a.content})}),o.success("Document saved!")}catch{o.error("Failed to save document")}};return React.createElement("div",{style:e.overlay},React.createElement("div",{style:e.modal},React.createElement("div",{style:e.header},React.createElement("div",{style:e.headerLeft},React.createElement(L,{style:{marginRight:"10px",color:"#5865f2"}}),React.createElement("h2",{style:e.title},"Project Collaboration")),React.createElement("button",{onClick:F,style:e.closeButton},React.createElement(_,null))),React.createElement("div",{style:e.breadcrumbs},React.createElement("button",{onClick:()=>{n("projects"),R(null)},style:e.breadcrumb},"Projects"),c&&React.createElement(React.Fragment,null,React.createElement("span",{style:e.breadcrumbSep},"/"),React.createElement("button",{onClick:()=>n("project-detail"),style:e.breadcrumb},c.name)),a&&React.createElement(React.Fragment,null,React.createElement("span",{style:e.breadcrumbSep},"/"),React.createElement("span",{style:e.breadcrumbActive},a.title))),React.createElement("div",{style:e.content},d==="projects"&&React.createElement(React.Fragment,null,React.createElement("button",{onClick:()=>n("create"),style:e.createProjectBtn},React.createElement(T,null)," New Project"),React.createElement("div",{style:e.projectsGrid},g.map(t=>React.createElement("div",{key:t.id,style:e.projectCard,onClick:()=>w(t.id)},React.createElement(A,{style:e.projectIcon}),React.createElement("h3",{style:e.projectName},t.name),React.createElement("p",{style:e.projectDesc},t.description),React.createElement("div",{style:e.projectStats},React.createElement("span",null,React.createElement(P,null)," ",t.stats?.documents||0),React.createElement("span",null,React.createElement(O,null)," ",t.member_count)))),g.length===0&&React.createElement("p",{style:e.emptyText},"No projects yet. Create one!"))),d==="create"&&React.createElement("div",{style:e.createForm},React.createElement("h3",{style:e.formTitle},"Create New Project"),React.createElement("input",{type:"text",placeholder:"Project Name",value:f,onChange:t=>j(t.target.value),style:e.input}),React.createElement("textarea",{placeholder:"Description (optional)",value:v,onChange:t=>C(t.target.value),style:e.textarea}),React.createElement("div",{style:e.formActions},React.createElement("button",{onClick:()=>n("projects"),style:e.cancelBtn},"Cancel"),React.createElement("button",{onClick:z,style:e.submitBtn,disabled:p},p?"Creating...":"Create Project"))),d==="project-detail"&&c&&React.createElement("div",{style:e.projectDetail},React.createElement("div",{style:e.projectHeader},React.createElement("div",null,React.createElement("h3",{style:e.projectTitle},c.name),React.createElement("p",{style:e.projectDescription},c.description)),React.createElement("button",{onClick:()=>n("create-doc"),style:e.newDocBtn},React.createElement(T,null)," New Document")),React.createElement("div",{style:e.documentsSection},React.createElement("h4",{style:e.sectionTitle},"Documents"),React.createElement("div",{style:e.documentsList},E.map(t=>React.createElement("div",{key:t.id,style:e.documentCard,onClick:()=>$(t.id)},React.createElement(P,{style:e.docIcon}),React.createElement("div",{style:e.docInfo},React.createElement("h4",{style:e.docTitle},t.title),React.createElement("span",{style:e.docMeta},React.createElement(J,null)," ",new Date(t.updated_at).toLocaleDateString()," Â· ",t.last_edited_by)))),E.length===0&&React.createElement("p",{style:e.emptyText},"No documents yet"))),React.createElement("div",{style:e.membersSection},React.createElement("h4",{style:e.sectionTitle},"Team Members"),React.createElement("div",{style:e.membersList},c.members?.map(t=>React.createElement("div",{key:t.id,style:e.memberBadge},React.createElement("span",{style:e.memberAvatar},t.username.charAt(0).toUpperCase()),React.createElement("span",null,t.username),React.createElement("span",{style:e.memberRole},t.role)))))),d==="create-doc"&&React.createElement("div",{style:e.createForm},React.createElement("h3",{style:e.formTitle},"Create New Document"),React.createElement("input",{type:"text",placeholder:"Document Title",value:y,onChange:t=>h(t.target.value),style:e.input}),React.createElement("textarea",{placeholder:"Start writing...",value:S,onChange:t=>k(t.target.value),style:{...e.textarea,minHeight:"200px"}}),React.createElement("div",{style:e.formActions},React.createElement("button",{onClick:()=>n("project-detail"),style:e.cancelBtn},"Cancel"),React.createElement("button",{onClick:N,style:e.submitBtn,disabled:p},p?"Creating...":"Create Document"))),d==="document"&&a&&React.createElement("div",{style:e.documentEditor},React.createElement("div",{style:e.editorHeader},React.createElement("input",{type:"text",value:a.title,onChange:t=>x({...a,title:t.target.value}),style:e.docTitleInput}),React.createElement("div",{style:e.editorActions},React.createElement("button",{onClick:H,style:e.saveBtn},"Save"),React.createElement("button",{style:e.historyBtn},React.createElement(M,null)," History"))),React.createElement("textarea",{value:a.content,onChange:t=>x({...a,content:t.target.value}),style:e.editor,placeholder:"Start writing your document..."}),React.createElement("div",{style:e.editorFooter},React.createElement("span",null,"Version ",a.version),React.createElement("span",null,"Last edited by ",a.last_edited_by))))))},e={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e4},modal:{backgroundColor:"#2f3136",borderRadius:"12px",width:"800px",maxHeight:"85vh",overflow:"hidden",display:"flex",flexDirection:"column"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #40444b"},headerLeft:{display:"flex",alignItems:"center"},title:{margin:0,color:"#fff",fontSize:"20px"},closeButton:{background:"none",border:"none",color:"#b9bbbe",cursor:"pointer",fontSize:"20px"},breadcrumbs:{display:"flex",alignItems:"center",padding:"10px 20px",gap:"8px",background:"#36393f"},breadcrumb:{background:"none",border:"none",color:"#5865f2",cursor:"pointer",fontSize:"14px"},breadcrumbSep:{color:"#72767d"},breadcrumbActive:{color:"#dcddde",fontSize:"14px"},content:{padding:"20px",overflowY:"auto",flex:1},createProjectBtn:{background:"#5865f2",border:"none",color:"#fff",padding:"10px 20px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",marginBottom:"20px"},projectsGrid:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"15px"},projectCard:{background:"#40444b",borderRadius:"10px",padding:"20px",cursor:"pointer",transition:"transform 0.2s",":hover":{transform:"translateY(-2px)"}},projectIcon:{color:"#faa61a",fontSize:"30px",marginBottom:"10px"},projectName:{color:"#fff",margin:"0 0 8px",fontSize:"16px"},projectDesc:{color:"#b9bbbe",fontSize:"13px",marginBottom:"15px"},projectStats:{display:"flex",gap:"15px",color:"#72767d",fontSize:"12px"},emptyText:{color:"#72767d",textAlign:"center",padding:"40px",gridColumn:"1 / -1"},createForm:{maxWidth:"500px",margin:"0 auto"},formTitle:{color:"#fff",marginBottom:"20px"},input:{width:"100%",background:"#40444b",border:"none",color:"#fff",padding:"12px",borderRadius:"6px",marginBottom:"15px"},textarea:{width:"100%",background:"#40444b",border:"none",color:"#fff",padding:"12px",borderRadius:"6px",marginBottom:"15px",minHeight:"100px",resize:"vertical"},formActions:{display:"flex",justifyContent:"flex-end",gap:"10px"},cancelBtn:{background:"#40444b",border:"none",color:"#fff",padding:"10px 20px",borderRadius:"6px",cursor:"pointer"},submitBtn:{background:"#5865f2",border:"none",color:"#fff",padding:"10px 20px",borderRadius:"6px",cursor:"pointer"},projectDetail:{display:"flex",flexDirection:"column",gap:"25px"},projectHeader:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},projectTitle:{color:"#fff",margin:"0 0 5px",fontSize:"24px"},projectDescription:{color:"#b9bbbe",margin:0},newDocBtn:{background:"#57f287",border:"none",color:"#000",padding:"10px 16px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},documentsSection:{},sectionTitle:{color:"#b9bbbe",fontSize:"12px",fontWeight:"600",textTransform:"uppercase",marginBottom:"10px"},documentsList:{display:"flex",flexDirection:"column",gap:"8px"},documentCard:{display:"flex",alignItems:"center",gap:"12px",background:"#40444b",padding:"12px 15px",borderRadius:"8px",cursor:"pointer"},docIcon:{color:"#5865f2",fontSize:"20px"},docInfo:{flex:1},docTitle:{color:"#fff",margin:0,fontSize:"14px"},docMeta:{color:"#72767d",fontSize:"12px",display:"flex",alignItems:"center",gap:"5px"},membersSection:{},membersList:{display:"flex",flexWrap:"wrap",gap:"10px"},memberBadge:{display:"flex",alignItems:"center",gap:"8px",background:"#40444b",padding:"8px 12px",borderRadius:"20px"},memberAvatar:{width:"24px",height:"24px",borderRadius:"50%",background:"#5865f2",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontSize:"12px"},memberRole:{color:"#72767d",fontSize:"11px",background:"#36393f",padding:"2px 6px",borderRadius:"4px"},documentEditor:{display:"flex",flexDirection:"column",height:"calc(85vh - 180px)"},editorHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},docTitleInput:{background:"transparent",border:"none",color:"#fff",fontSize:"24px",fontWeight:"bold",flex:1},editorActions:{display:"flex",gap:"10px"},saveBtn:{background:"#57f287",border:"none",color:"#000",padding:"8px 16px",borderRadius:"6px",cursor:"pointer"},historyBtn:{background:"#40444b",border:"none",color:"#fff",padding:"8px 16px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},editor:{flex:1,background:"#40444b",border:"none",color:"#dcddde",padding:"20px",borderRadius:"8px",fontSize:"14px",lineHeight:"1.6",resize:"none"},editorFooter:{display:"flex",justifyContent:"space-between",padding:"10px 0",color:"#72767d",fontSize:"12px"}};export{G as default};
