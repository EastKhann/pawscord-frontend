import{r as n,b as e}from"./react-core-9vc7GIjk.js";import{c3 as _,a as A,a1 as F,bk as O,b6 as B,n as J,x as M,aX as q}from"./icons-vendor-u_f-1GKM.js";import{t as a}from"./index-Bm9YmRqY.js";import"./editor-vendor-DiU449Dh.js";import"./media-vendor-B-uSUaIv.js";import"./router-vendor-u6fxj6P4.js";import"./crypto-vendor-C1qXRpJv.js";import"./state-vendor-0vlBuk0v.js";const U=({fetchWithAuth:i,apiBaseUrl:d,onClose:z,serverId:g})=>{const[E,I]=n.useState([]),[l,j]=n.useState(null),[v,R]=n.useState([]),[o,f]=n.useState(null),[p,c]=n.useState("projects"),[m,u]=n.useState(!1),[y,C]=n.useState(""),[h,S]=n.useState(""),[b,k]=n.useState(""),[D,w]=n.useState("");n.useEffect(()=>{T()},[]);const T=async()=>{try{const s=await(await i(`${d}/projects/?server_id=${g}`)).json();I(s.projects||[])}catch(r){console.error("Failed to fetch projects:",r)}},P=async r=>{try{const x=await(await i(`${d}/projects/${r}/`)).json();j(x.project),R(x.documents||[]),c("project-detail")}catch{a.error("Failed to load project")}},N=async()=>{if(!y.trim()){a.error("Project name required");return}u(!0);try{(await(await i(`${d}/projects/create/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:y,description:h,server_id:g})})).json()).project&&(a.success("Project created!"),C(""),S(""),c("projects"),T())}catch{a.error("Failed to create project")}finally{u(!1)}},H=async()=>{if(!b.trim()){a.error("Document title required");return}u(!0);try{(await(await i(`${d}/documents/create/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:b,content:D,project_id:l?.id})})).json()).document&&(a.success("Document created!"),k(""),w(""),P(l.id))}catch{a.error("Failed to create document")}finally{u(!1)}},$=async r=>{try{const x=await(await i(`${d}/documents/${r}/`)).json();f(x.document),c("document")}catch{a.error("Failed to load document")}},L=async()=>{if(o)try{await i(`${d}/documents/${o.id}/`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:o.content})}),a.success("Document saved!")}catch{a.error("Failed to save document")}};return e.createElement("div",{style:t.overlay},e.createElement("div",{style:t.modal},e.createElement("div",{style:t.header},e.createElement("div",{style:t.headerLeft},e.createElement(_,{style:{marginRight:"10px",color:"#5865f2"}}),e.createElement("h2",{style:t.title},"Project Collaboration")),e.createElement("button",{onClick:z,style:t.closeButton},e.createElement(A,null))),e.createElement("div",{style:t.breadcrumbs},e.createElement("button",{onClick:()=>{c("projects"),j(null)},style:t.breadcrumb},"Projects"),l&&e.createElement(e.Fragment,null,e.createElement("span",{style:t.breadcrumbSep},"/"),e.createElement("button",{onClick:()=>c("project-detail"),style:t.breadcrumb},l.name)),o&&e.createElement(e.Fragment,null,e.createElement("span",{style:t.breadcrumbSep},"/"),e.createElement("span",{style:t.breadcrumbActive},o.title))),e.createElement("div",{style:t.content},p==="projects"&&e.createElement(e.Fragment,null,e.createElement("button",{onClick:()=>c("create"),style:t.createProjectBtn},e.createElement(F,null)," New Project"),e.createElement("div",{style:t.projectsGrid},E.map(r=>e.createElement("div",{key:r.id,style:t.projectCard,onClick:()=>P(r.id)},e.createElement(O,{style:t.projectIcon}),e.createElement("h3",{style:t.projectName},r.name),e.createElement("p",{style:t.projectDesc},r.description),e.createElement("div",{style:t.projectStats},e.createElement("span",null,e.createElement(B,null)," ",r.stats?.documents||0),e.createElement("span",null,e.createElement(J,null)," ",r.member_count)))),E.length===0&&e.createElement("p",{style:t.emptyText},"No projects yet. Create one!"))),p==="create"&&e.createElement("div",{style:t.createForm},e.createElement("h3",{style:t.formTitle},"Create New Project"),e.createElement("input",{type:"text",placeholder:"Project Name",value:y,onChange:r=>C(r.target.value),style:t.input}),e.createElement("textarea",{placeholder:"Description (optional)",value:h,onChange:r=>S(r.target.value),style:t.textarea}),e.createElement("div",{style:t.formActions},e.createElement("button",{onClick:()=>c("projects"),style:t.cancelBtn},"Cancel"),e.createElement("button",{onClick:N,style:t.submitBtn,disabled:m},m?"Creating...":"Create Project"))),p==="project-detail"&&l&&e.createElement("div",{style:t.projectDetail},e.createElement("div",{style:t.projectHeader},e.createElement("div",null,e.createElement("h3",{style:t.projectTitle},l.name),e.createElement("p",{style:t.projectDescription},l.description)),e.createElement("button",{onClick:()=>c("create-doc"),style:t.newDocBtn},e.createElement(F,null)," New Document")),e.createElement("div",{style:t.documentsSection},e.createElement("h4",{style:t.sectionTitle},"Documents"),e.createElement("div",{style:t.documentsList},v.map(r=>e.createElement("div",{key:r.id,style:t.documentCard,onClick:()=>$(r.id)},e.createElement(B,{style:t.docIcon}),e.createElement("div",{style:t.docInfo},e.createElement("h4",{style:t.docTitle},r.title),e.createElement("span",{style:t.docMeta},e.createElement(M,null)," ",new Date(r.updated_at).toLocaleDateString()," Â· ",r.last_edited_by)))),v.length===0&&e.createElement("p",{style:t.emptyText},"No documents yet"))),e.createElement("div",{style:t.membersSection},e.createElement("h4",{style:t.sectionTitle},"Team Members"),e.createElement("div",{style:t.membersList},l.members?.map(r=>e.createElement("div",{key:r.id,style:t.memberBadge},e.createElement("span",{style:t.memberAvatar},r.username.charAt(0).toUpperCase()),e.createElement("span",null,r.username),e.createElement("span",{style:t.memberRole},r.role)))))),p==="create-doc"&&e.createElement("div",{style:t.createForm},e.createElement("h3",{style:t.formTitle},"Create New Document"),e.createElement("input",{type:"text",placeholder:"Document Title",value:b,onChange:r=>k(r.target.value),style:t.input}),e.createElement("textarea",{placeholder:"Start writing...",value:D,onChange:r=>w(r.target.value),style:{...t.textarea,minHeight:"200px"}}),e.createElement("div",{style:t.formActions},e.createElement("button",{onClick:()=>c("project-detail"),style:t.cancelBtn},"Cancel"),e.createElement("button",{onClick:H,style:t.submitBtn,disabled:m},m?"Creating...":"Create Document"))),p==="document"&&o&&e.createElement("div",{style:t.documentEditor},e.createElement("div",{style:t.editorHeader},e.createElement("input",{type:"text",value:o.title,onChange:r=>f({...o,title:r.target.value}),style:t.docTitleInput}),e.createElement("div",{style:t.editorActions},e.createElement("button",{onClick:L,style:t.saveBtn},"Save"),e.createElement("button",{style:t.historyBtn},e.createElement(q,null)," History"))),e.createElement("textarea",{value:o.content,onChange:r=>f({...o,content:r.target.value}),style:t.editor,placeholder:"Start writing your document..."}),e.createElement("div",{style:t.editorFooter},e.createElement("span",null,"Version ",o.version),e.createElement("span",null,"Last edited by ",o.last_edited_by))))))},t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e4},modal:{backgroundColor:"#2f3136",borderRadius:"12px",width:"800px",maxHeight:"85vh",overflow:"hidden",display:"flex",flexDirection:"column"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #40444b"},headerLeft:{display:"flex",alignItems:"center"},title:{margin:0,color:"#fff",fontSize:"20px"},closeButton:{background:"none",border:"none",color:"#b9bbbe",cursor:"pointer",fontSize:"20px"},breadcrumbs:{display:"flex",alignItems:"center",padding:"10px 20px",gap:"8px",background:"#36393f"},breadcrumb:{background:"none",border:"none",color:"#5865f2",cursor:"pointer",fontSize:"14px"},breadcrumbSep:{color:"#72767d"},breadcrumbActive:{color:"#dcddde",fontSize:"14px"},content:{padding:"20px",overflowY:"auto",flex:1},createProjectBtn:{background:"#5865f2",border:"none",color:"#fff",padding:"10px 20px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",marginBottom:"20px"},projectsGrid:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"15px"},projectCard:{background:"#40444b",borderRadius:"10px",padding:"20px",cursor:"pointer",transition:"transform 0.2s",":hover":{transform:"translateY(-2px)"}},projectIcon:{color:"#faa61a",fontSize:"30px",marginBottom:"10px"},projectName:{color:"#fff",margin:"0 0 8px",fontSize:"16px"},projectDesc:{color:"#b9bbbe",fontSize:"13px",marginBottom:"15px"},projectStats:{display:"flex",gap:"15px",color:"#72767d",fontSize:"12px"},emptyText:{color:"#72767d",textAlign:"center",padding:"40px",gridColumn:"1 / -1"},createForm:{maxWidth:"500px",margin:"0 auto"},formTitle:{color:"#fff",marginBottom:"20px"},input:{width:"100%",background:"#40444b",border:"none",color:"#fff",padding:"12px",borderRadius:"6px",marginBottom:"15px"},textarea:{width:"100%",background:"#40444b",border:"none",color:"#fff",padding:"12px",borderRadius:"6px",marginBottom:"15px",minHeight:"100px",resize:"vertical"},formActions:{display:"flex",justifyContent:"flex-end",gap:"10px"},cancelBtn:{background:"#40444b",border:"none",color:"#fff",padding:"10px 20px",borderRadius:"6px",cursor:"pointer"},submitBtn:{background:"#5865f2",border:"none",color:"#fff",padding:"10px 20px",borderRadius:"6px",cursor:"pointer"},projectDetail:{display:"flex",flexDirection:"column",gap:"25px"},projectHeader:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},projectTitle:{color:"#fff",margin:"0 0 5px",fontSize:"24px"},projectDescription:{color:"#b9bbbe",margin:0},newDocBtn:{background:"#57f287",border:"none",color:"#000",padding:"10px 16px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},documentsSection:{},sectionTitle:{color:"#b9bbbe",fontSize:"12px",fontWeight:"600",textTransform:"uppercase",marginBottom:"10px"},documentsList:{display:"flex",flexDirection:"column",gap:"8px"},documentCard:{display:"flex",alignItems:"center",gap:"12px",background:"#40444b",padding:"12px 15px",borderRadius:"8px",cursor:"pointer"},docIcon:{color:"#5865f2",fontSize:"20px"},docInfo:{flex:1},docTitle:{color:"#fff",margin:0,fontSize:"14px"},docMeta:{color:"#72767d",fontSize:"12px",display:"flex",alignItems:"center",gap:"5px"},membersSection:{},membersList:{display:"flex",flexWrap:"wrap",gap:"10px"},memberBadge:{display:"flex",alignItems:"center",gap:"8px",background:"#40444b",padding:"8px 12px",borderRadius:"20px"},memberAvatar:{width:"24px",height:"24px",borderRadius:"50%",background:"#5865f2",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontSize:"12px"},memberRole:{color:"#72767d",fontSize:"11px",background:"#36393f",padding:"2px 6px",borderRadius:"4px"},documentEditor:{display:"flex",flexDirection:"column",height:"calc(85vh - 180px)"},editorHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},docTitleInput:{background:"transparent",border:"none",color:"#fff",fontSize:"24px",fontWeight:"bold",flex:1},editorActions:{display:"flex",gap:"10px"},saveBtn:{background:"#57f287",border:"none",color:"#000",padding:"8px 16px",borderRadius:"6px",cursor:"pointer"},historyBtn:{background:"#40444b",border:"none",color:"#fff",padding:"8px 16px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},editor:{flex:1,background:"#40444b",border:"none",color:"#dcddde",padding:"20px",borderRadius:"8px",fontSize:"14px",lineHeight:"1.6",resize:"none"},editorFooter:{display:"flex",justifyContent:"space-between",padding:"10px 0",color:"#72767d",fontSize:"12px"}};export{U as default};
