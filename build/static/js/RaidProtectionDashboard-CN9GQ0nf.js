import{r as s,ay as f,l as Y,aj as J,aP as v,b$ as p,bV as b,cc as q,y as G,b_ as w,aX as S,o as C,ax as X,Y as $,K as Q}from"./react-core-B6hadH-M.js";import{t as R,h as U}from"./index-D_6pZib5.js";const te=({serverId:l,apiBaseUrl:r,onClose:g})=>{const[o,u]=s.useState("overview"),[a,E]=s.useState({enabled:!1,level:"medium",lockdown_active:!1,verification_required:!1,auto_ban_enabled:!0}),[k,j]=s.useState([]),[m,h]=s.useState([]),[y,A]=s.useState([]),[c,i]=s.useState({join_rate_limit:10,join_time_window:60,mention_limit:10,message_rate_limit:15,new_account_threshold:7,auto_ban_suspicious:!0,captcha_on_join:!1,dm_on_join_warning:!0}),[W,T]=s.useState(!0),[d,L]=s.useState({blocked_today:0,verified_today:0,raids_detected:0,suspicious_accounts:0}),K=s.useRef(null);s.useEffect(()=>{F(),N(),P(),z();const e=setInterval(N,5e3);return()=>clearInterval(e)},[l]);const F=async()=>{try{const e=localStorage.getItem("access_token"),t=await fetch(`${r}/moderation/raid-protection/status/${l}/`,{headers:{Authorization:`Bearer ${e}`}});if(t.ok){const n=await t.json();E(n.status||a),i(n.settings||c),L(n.stats||d)}}catch(e){console.error("Fetch protection status error:",e)}finally{T(!1)}},N=async()=>{try{const e=localStorage.getItem("access_token"),t=await fetch(`${r}/moderation/raid-protection/activity/${l}/`,{headers:{Authorization:`Bearer ${e}`}});if(t.ok){const n=await t.json();j(n.activity||[])}}catch(e){console.error("Fetch activity error:",e)}},P=async()=>{try{const e=localStorage.getItem("access_token"),t=await fetch(`${r}/moderation/raid-protection/pending/${l}/`,{headers:{Authorization:`Bearer ${e}`}});if(t.ok){const n=await t.json();h(n.pending||[])}}catch(e){console.error("Fetch pending error:",e)}},z=async()=>{try{const e=localStorage.getItem("access_token"),t=await fetch(`${r}/moderation/raid-protection/logs/${l}/`,{headers:{Authorization:`Bearer ${e}`}});if(t.ok){const n=await t.json();A(n.logs||[])}}catch(e){console.error("Fetch logs error:",e)}},B=async()=>{try{const e=localStorage.getItem("access_token"),t=a.enabled?"disable":"enable";(await fetch(`${r}/moderation/raid-protection/${t}/`,{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({server_id:l})})).ok&&(E({...a,enabled:!a.enabled}),R.success(a.enabled?"ðŸ”“ Raid korumasÄ± devre dÄ±ÅŸÄ±":"ðŸ›¡ï¸ Raid korumasÄ± aktif!"))}catch(e){console.error("Toggle protection error:",e)}},x=async()=>{if(await U(a.lockdown_active?"Sunucu kilidini aÃ§mak istediÄŸinizden emin misiniz?":"UYARI: Bu iÅŸlem sunucuyu kilitleyecek. Yeni Ã¼yeler katÄ±lamayacak. Devam?"))try{const t=localStorage.getItem("access_token"),n=a.lockdown_active?"unlock":"lockdown";(await fetch(`${r}/moderation/raid-protection/${n}/`,{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({server_id:l})})).ok&&(E({...a,lockdown_active:!a.lockdown_active}),R.success(a.lockdown_active?"ðŸ”“ Sunucu kilidi aÃ§Ä±ldÄ±":"ðŸ”’ Sunucu kilitlendi!"))}catch(t){console.error("Lockdown error:",t)}},_=async(e,t)=>{try{const n=localStorage.getItem("access_token");(await fetch(`${r}/moderation/raid-protection/verify/`,{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify({server_id:l,user_id:e,action:t})})).ok&&(h(m.filter(M=>M.id!==e)),R.success(t==="approve"?"âœ… KullanÄ±cÄ± onaylandÄ±":"âŒ KullanÄ±cÄ± reddedildi"))}catch(n){console.error("Verify user error:",n)}},D=async()=>{try{const e=localStorage.getItem("access_token");(await fetch(`${r}/moderation/raid-protection/settings/`,{method:"PUT",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({server_id:l,...c})})).ok&&R.success("âœ… Ayarlar kaydedildi!")}catch(e){console.error("Save settings error:",e)}},H=e=>{switch(e){case"join":return"ðŸ‘‹";case"leave":return"ðŸšª";case"kick":return"ðŸ‘¢";case"ban":return"ðŸ”¨";case"suspicious":return"âš ï¸";case"raid_detected":return"ðŸš¨";case"verified":return"âœ…";default:return"ðŸ“‹"}},O=e=>{switch(e){case"join":return"#23a559";case"leave":return"#f0b132";case"kick":case"ban":return"#da373c";case"suspicious":case"raid_detected":return"#f0b132";case"verified":return"#5865f2";default:return"#72767d"}},I=e=>new Date(e).toLocaleTimeString("tr-TR",{hour:"2-digit",minute:"2-digit"});return React.createElement("div",{className:"raid-dashboard-overlay",onClick:g},React.createElement("div",{className:"raid-dashboard",onClick:e=>e.stopPropagation()},React.createElement("div",{className:"dashboard-header"},React.createElement("h2",null,React.createElement(f,null)," Raid Koruma Paneli"),React.createElement("div",{className:"header-status"},React.createElement("span",{className:`status-badge ${a.enabled?"active":"inactive"}`},a.enabled?"ðŸ›¡ï¸ Koruma Aktif":"âš ï¸ Koruma KapalÄ±"),a.lockdown_active&&React.createElement("span",{className:"status-badge lockdown"},"ðŸ”’ Lockdown")),React.createElement("button",{className:"close-btn",onClick:g},React.createElement(Y,null))),React.createElement("div",{className:"dashboard-nav"},React.createElement("button",{className:`nav-btn ${o==="overview"?"active":""}`,onClick:()=>u("overview")},React.createElement(J,null)," Genel BakÄ±ÅŸ"),React.createElement("button",{className:`nav-btn ${o==="verify"?"active":""}`,onClick:()=>u("verify")},React.createElement(v,null)," DoÄŸrulama",m.length>0&&React.createElement("span",{className:"badge"},m.length)),React.createElement("button",{className:`nav-btn ${o==="logs"?"active":""}`,onClick:()=>u("logs")},React.createElement(p,null)," Loglar"),React.createElement("button",{className:`nav-btn ${o==="settings"?"active":""}`,onClick:()=>u("settings")},React.createElement(b,null)," Ayarlar")),React.createElement("div",{className:"dashboard-content"},o==="overview"&&React.createElement("div",{className:"overview-view"},React.createElement("div",{className:"quick-actions"},React.createElement("button",{className:`action-btn ${a.enabled?"enabled":""}`,onClick:B},React.createElement(f,null),a.enabled?"KorumayÄ± Kapat":"KorumayÄ± AÃ§"),React.createElement("button",{className:`action-btn lockdown ${a.lockdown_active?"active":""}`,onClick:x},a.lockdown_active?React.createElement(q,null):React.createElement(G,null),a.lockdown_active?"Kilidi AÃ§":"Sunucuyu Kilitle")),React.createElement("div",{className:"stats-grid"},React.createElement("div",{className:"stat-card"},React.createElement("div",{className:"stat-icon blocked"},React.createElement(w,null)),React.createElement("div",{className:"stat-info"},React.createElement("span",{className:"stat-value"},d.blocked_today),React.createElement("span",{className:"stat-label"},"BugÃ¼n Engellenen"))),React.createElement("div",{className:"stat-card"},React.createElement("div",{className:"stat-icon verified"},React.createElement(S,null)),React.createElement("div",{className:"stat-info"},React.createElement("span",{className:"stat-value"},d.verified_today),React.createElement("span",{className:"stat-label"},"BugÃ¼n DoÄŸrulanan"))),React.createElement("div",{className:"stat-card"},React.createElement("div",{className:"stat-icon raids"},React.createElement(C,null)),React.createElement("div",{className:"stat-info"},React.createElement("span",{className:"stat-value"},d.raids_detected),React.createElement("span",{className:"stat-label"},"Tespit Edilen Raid"))),React.createElement("div",{className:"stat-card"},React.createElement("div",{className:"stat-icon suspicious"},React.createElement(X,null)),React.createElement("div",{className:"stat-info"},React.createElement("span",{className:"stat-value"},d.suspicious_accounts),React.createElement("span",{className:"stat-label"},"ÅžÃ¼pheli Hesap")))),React.createElement("div",{className:"activity-section"},React.createElement("h3",null,React.createElement($,null)," CanlÄ± Aktivite"),React.createElement("div",{className:"activity-feed",ref:K},k.length>0?k.map((e,t)=>React.createElement("div",{key:t,className:"activity-item",style:{borderLeftColor:O(e.type)}},React.createElement("span",{className:"activity-icon"},H(e.type)),React.createElement("div",{className:"activity-info"},React.createElement("span",{className:"activity-user"},e.username),React.createElement("span",{className:"activity-action"},e.description)),React.createElement("span",{className:"activity-time"},I(e.timestamp)))):React.createElement("div",{className:"no-activity"},React.createElement("p",null,"HenÃ¼z aktivite yok"))))),o==="verify"&&React.createElement("div",{className:"verify-view"},React.createElement("h3",null,React.createElement(v,null)," Bekleyen DoÄŸrulamalar"),m.length>0?React.createElement("div",{className:"verifications-list"},m.map(e=>React.createElement("div",{key:e.id,className:"verification-card"},React.createElement("img",{src:e.avatar||"/default-avatar.png",alt:e.username,className:"user-avatar"}),React.createElement("div",{className:"user-info"},React.createElement("h4",null,e.username),React.createElement("div",{className:"user-meta"},React.createElement("span",null,React.createElement($,null)," KatÄ±lÄ±m: ",new Date(e.joined_at).toLocaleDateString("tr-TR")),React.createElement("span",null,React.createElement(Q,null)," Hesap: ",e.account_age_days," gÃ¼n")),e.suspicious_reasons&&React.createElement("div",{className:"suspicious-reasons"},React.createElement(C,null),e.suspicious_reasons.map((t,n)=>React.createElement("span",{key:n,className:"reason-tag"},t)))),React.createElement("div",{className:"verification-actions"},React.createElement("button",{className:"approve-btn",onClick:()=>_(e.id,"approve")},React.createElement(S,null)," Onayla"),React.createElement("button",{className:"reject-btn",onClick:()=>_(e.id,"reject")},React.createElement(w,null)," Reddet"))))):React.createElement("div",{className:"no-verifications"},React.createElement(v,{className:"empty-icon"}),React.createElement("p",null,"Bekleyen doÄŸrulama yok"))),o==="logs"&&React.createElement("div",{className:"logs-view"},React.createElement("h3",null,React.createElement(p,null)," Raid LoglarÄ±"),y.length>0?React.createElement("div",{className:"logs-list"},y.map((e,t)=>React.createElement("div",{key:t,className:`log-item ${e.severity}`},React.createElement("div",{className:"log-header"},React.createElement("span",{className:"log-type"},e.type==="raid_detected"&&"ðŸš¨ Raid Tespit Edildi",e.type==="mass_ban"&&"ðŸ”¨ Toplu Ban",e.type==="lockdown"&&"ðŸ”’ Lockdown",e.type==="unlock"&&"ðŸ”“ Kilit AÃ§Ä±ldÄ±",e.type==="suspicious_activity"&&"âš ï¸ ÅžÃ¼pheli Aktivite"),React.createElement("span",{className:"log-time"},new Date(e.timestamp).toLocaleString("tr-TR"))),React.createElement("p",{className:"log-description"},e.description),e.affected_users&&React.createElement("span",{className:"affected-count"},e.affected_users," kullanÄ±cÄ± etkilendi")))):React.createElement("div",{className:"no-logs"},React.createElement(p,{className:"empty-icon"}),React.createElement("p",null,"HenÃ¼z log kaydÄ± yok"))),o==="settings"&&React.createElement("div",{className:"settings-view"},React.createElement("h3",null,React.createElement(b,null)," Koruma AyarlarÄ±"),React.createElement("div",{className:"settings-section"},React.createElement("h4",null,"KatÄ±lÄ±m Limitleri"),React.createElement("div",{className:"setting-item"},React.createElement("div",{className:"setting-info"},React.createElement("label",null,"KatÄ±lÄ±m HÄ±z Limiti"),React.createElement("p",null,"Belirli sÃ¼re iÃ§inde maksimum katÄ±lÄ±m sayÄ±sÄ±")),React.createElement("div",{className:"setting-control"},React.createElement("input",{type:"number",value:c.join_rate_limit,onChange:e=>i({...c,join_rate_limit:parseInt(e.target.value)}),min:"1",max:"100"}),React.createElement("span",null,"kiÅŸi /"),React.createElement("input",{type:"number",value:c.join_time_window,onChange:e=>i({...c,join_time_window:parseInt(e.target.value)}),min:"10",max:"300"}),React.createElement("span",null,"saniye"))),React.createElement("div",{className:"setting-item"},React.createElement("div",{className:"setting-info"},React.createElement("label",null,"Yeni Hesap EÅŸiÄŸi"),React.createElement("p",null,"Bu gÃ¼nden eski hesaplar ÅŸÃ¼pheli sayÄ±lÄ±r")),React.createElement("div",{className:"setting-control"},React.createElement("input",{type:"number",value:c.new_account_threshold,onChange:e=>i({...c,new_account_threshold:parseInt(e.target.value)}),min:"1",max:"30"}),React.createElement("span",null,"gÃ¼n")))),React.createElement("div",{className:"settings-section"},React.createElement("h4",null,"Mesaj Limitleri"),React.createElement("div",{className:"setting-item"},React.createElement("div",{className:"setting-info"},React.createElement("label",null,"Mention Limiti"),React.createElement("p",null,"Bir mesajdaki maksimum mention sayÄ±sÄ±")),React.createElement("div",{className:"setting-control"},React.createElement("input",{type:"number",value:c.mention_limit,onChange:e=>i({...c,mention_limit:parseInt(e.target.value)}),min:"1",max:"50"}))),React.createElement("div",{className:"setting-item"},React.createElement("div",{className:"setting-info"},React.createElement("label",null,"Mesaj HÄ±z Limiti"),React.createElement("p",null,"10 saniyede maksimum mesaj sayÄ±sÄ±")),React.createElement("div",{className:"setting-control"},React.createElement("input",{type:"number",value:c.message_rate_limit,onChange:e=>i({...c,message_rate_limit:parseInt(e.target.value)}),min:"1",max:"50"})))),React.createElement("div",{className:"settings-section"},React.createElement("h4",null,"Otomatik Aksiyonlar"),React.createElement("div",{className:"setting-item toggle"},React.createElement("div",{className:"setting-info"},React.createElement("label",null,"ÅžÃ¼pheli HesaplarÄ± Otomatik Banla"),React.createElement("p",null,"Raid tespit edildiÄŸinde ÅŸÃ¼pheli hesaplarÄ± otomatik banla")),React.createElement("label",{className:"toggle-switch"},React.createElement("input",{type:"checkbox",checked:c.auto_ban_suspicious,onChange:e=>i({...c,auto_ban_suspicious:e.target.checked})}),React.createElement("span",{className:"slider"}))),React.createElement("div",{className:"setting-item toggle"},React.createElement("div",{className:"setting-info"},React.createElement("label",null,"KatÄ±lÄ±mda CAPTCHA"),React.createElement("p",null,"Yeni Ã¼yeler katÄ±lÄ±rken CAPTCHA doÄŸrulamasÄ± iste")),React.createElement("label",{className:"toggle-switch"},React.createElement("input",{type:"checkbox",checked:c.captcha_on_join,onChange:e=>i({...c,captcha_on_join:e.target.checked})}),React.createElement("span",{className:"slider"}))),React.createElement("div",{className:"setting-item toggle"},React.createElement("div",{className:"setting-info"},React.createElement("label",null,"KatÄ±lÄ±m UyarÄ± DM"),React.createElement("p",null,"ÅžÃ¼pheli hesap katÄ±ldÄ±ÄŸÄ±nda yÃ¶neticilere DM gÃ¶nder")),React.createElement("label",{className:"toggle-switch"},React.createElement("input",{type:"checkbox",checked:c.dm_on_join_warning,onChange:e=>i({...c,dm_on_join_warning:e.target.checked})}),React.createElement("span",{className:"slider"})))),React.createElement("div",{className:"settings-actions"},React.createElement("button",{className:"save-btn",onClick:D},"AyarlarÄ± Kaydet"))))))};export{te as default};
