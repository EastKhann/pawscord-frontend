import{r as m,aj as w,l as T,K as g,bt as z,Y as B,aD as D,c as L,c2 as j,c3 as I}from"./react-core-B6hadH-M.js";const A=({isOpen:c,onClose:s,serverId:l,serverName:r,fetchWithAuth:o,apiBaseUrl:d})=>{const[t,b]=m.useState(null),[i,v]=m.useState(null),[C,R]=m.useState(!0),[u,k]=m.useState("30d"),E=m.useCallback(async()=>{if(l){R(!0);try{const[a,n]=await Promise.all([o(`${d}/servers/${l}/analytics/?period=${u}`),o(`${d}/servers/${l}/analytics/compare/`)]);if(a.ok){const p=await a.json();b(p)}if(n.ok){const p=await n.json();v(p)}}catch(a){console.error("Analytics fetch error:",a)}finally{R(!1)}}},[l,u,o,d]);if(m.useEffect(()=>{c&&l&&E()},[c,l,E]),!c)return null;const S=React.createElement("div",{style:e.overlay,onClick:s},React.createElement("div",{style:e.modal,onClick:a=>a.stopPropagation()},React.createElement("div",{style:e.header},React.createElement("div",{style:e.headerLeft},React.createElement(w,{style:{color:"#5865f2"}}),React.createElement("h2",{style:e.title},r||"Sunucu"," Analytics")),React.createElement("div",{style:e.headerRight},React.createElement("select",{value:u,onChange:a=>k(a.target.value),style:e.periodSelect},React.createElement("option",{value:"7d"},"Son 7 GÃ¼n"),React.createElement("option",{value:"30d"},"Son 30 GÃ¼n"),React.createElement("option",{value:"90d"},"Son 90 GÃ¼n")),React.createElement("button",{onClick:s,style:e.closeBtn},React.createElement(T,null)))),React.createElement("div",{style:e.content},C?React.createElement("div",{style:e.loadingState},React.createElement("div",{style:e.spinner}),React.createElement("span",null,"Veriler yÃ¼kleniyor...")):t?React.createElement(React.Fragment,null,React.createElement("div",{style:e.statsRow},React.createElement(f,{icon:React.createElement(g,null),label:"Toplam Ãœye",value:t.member_growth?.total||0,change:i?.change?.active_users,color:"#5865f2"}),React.createElement(f,{icon:React.createElement(z,null),label:"Toplam Mesaj",value:t.message_stats?.total||0,subtext:`GÃ¼nlÃ¼k ort: ${t.message_stats?.daily_average||0}`,change:i?.change?.messages,color:"#43b581"}),React.createElement(f,{icon:React.createElement(g,null),label:"Aktif Ãœye",value:t.active_users?.total||0,subtext:`%${t.active_users?.activity_rate||0} aktivite`,color:"#faa61a"}),React.createElement(f,{icon:React.createElement(B,null),label:"En YoÄŸun Saat",value:t.peak_hours?.peak_hour_label||"-",color:"#f04747"})),React.createElement("div",{style:e.chartsRow},React.createElement("div",{style:e.chartCard},React.createElement("h3",{style:e.chartTitle},"ðŸ“ˆ Mesaj Aktivitesi"),React.createElement("div",{style:e.barChart},t.message_stats?.daily?.slice(-14).map((a,n)=>{const p=Math.max(...t.message_stats?.daily?.map(_=>_.count)||[1]),y=a.count/p*100;return React.createElement("div",{key:n,style:e.barContainer},React.createElement("div",{style:{...e.bar,height:`${Math.max(y,5)}%`},title:`${a.date}: ${a.count} mesaj`}),React.createElement("span",{style:e.barLabel},new Date(a.date).getDate()))}))),React.createElement("div",{style:e.chartCard},React.createElement("h3",{style:e.chartTitle},"â° Saatlik Aktivite"),React.createElement("div",{style:e.hourlyChart},t.peak_hours?.hourly?.map((a,n)=>{const p=Math.max(...t.peak_hours?.hourly||[1]),y=a/p;return React.createElement("div",{key:n,style:{...e.hourBlock,backgroundColor:`rgba(88, 101, 242, ${Math.max(y,.1)})`},title:`${n}:00 - ${a} mesaj`},n)})))),React.createElement("div",{style:e.listsRow},React.createElement("div",{style:e.listCard},React.createElement("h3",{style:e.listTitle},React.createElement(D,null)," PopÃ¼ler Kanallar"),React.createElement("div",{style:e.list},t.popular_channels?.slice(0,5).map((a,n)=>React.createElement("div",{key:n,style:e.listItem},React.createElement("span",{style:e.listRank},"#",n+1),React.createElement("span",{style:e.listName},a.name),React.createElement("span",{style:e.listValue},a.messages," mesaj"))),(!t.popular_channels||t.popular_channels.length===0)&&React.createElement("div",{style:e.emptyList},"Veri yok"))),React.createElement("div",{style:e.listCard},React.createElement("h3",{style:e.listTitle},React.createElement(g,null)," En Aktif Ãœyeler"),React.createElement("div",{style:e.list},t.active_users?.top_users?.slice(0,5).map((a,n)=>React.createElement("div",{key:n,style:e.listItem},React.createElement("span",{style:e.listRank},"#",n+1),React.createElement("span",{style:e.listName},a.username),React.createElement("span",{style:e.listValue},a.messages," mesaj"))),(!t.active_users?.top_users||t.active_users.top_users.length===0)&&React.createElement("div",{style:e.emptyList},"Veri yok"))),React.createElement("div",{style:e.listCard},React.createElement("h3",{style:e.listTitle},"ðŸ“Š Ä°Ã§erik DaÄŸÄ±lÄ±mÄ±"),React.createElement("div",{style:e.pieChart},t.content_breakdown&&React.createElement(React.Fragment,null,React.createElement(x,{label:"Metin",value:t.content_breakdown.text_only,total:t.message_stats?.total||1,color:"#5865f2"}),React.createElement(x,{label:"Resimli",value:t.content_breakdown.with_images,total:t.message_stats?.total||1,color:"#43b581"}),React.createElement(x,{label:"DosyalÄ±",value:t.content_breakdown.with_files,total:t.message_stats?.total||1,color:"#faa61a"}),React.createElement(x,{label:"Ses",value:t.content_breakdown.voice_messages,total:t.message_stats?.total||1,color:"#f04747"}))))),i&&React.createElement("div",{style:e.comparisonSection},React.createElement("h3",{style:e.sectionTitle},"ðŸ“Š HaftalÄ±k KarÅŸÄ±laÅŸtÄ±rma"),React.createElement("div",{style:e.comparisonGrid},React.createElement(h,{label:"Mesajlar",thisWeek:i.this_week?.messages,lastWeek:i.last_week?.messages,change:i.change?.messages}),React.createElement(h,{label:"Aktif Ãœyeler",thisWeek:i.this_week?.active_users,lastWeek:i.last_week?.active_users,change:i.change?.active_users})))):React.createElement("div",{style:e.errorState},React.createElement("span",{style:{fontSize:"48px"}},"ðŸ“Š"),React.createElement("p",null,"Analytics verileri yÃ¼klenemedi")))));return L.createPortal(S,document.body)},f=({icon:c,label:s,value:l,subtext:r,change:o,color:d})=>React.createElement("div",{style:e.statCard},React.createElement("div",{style:{...e.statIcon,backgroundColor:d}},c),React.createElement("div",{style:e.statInfo},React.createElement("span",{style:e.statLabel},s),React.createElement("span",{style:e.statValue},typeof l=="number"?l.toLocaleString():l),r&&React.createElement("span",{style:e.statSubtext},r),o!==void 0&&React.createElement("span",{style:{...e.statChange,color:o>=0?"#43b581":"#f04747"}},o>=0?React.createElement(j,null):React.createElement(I,null)," ",Math.abs(o),"%"))),x=({label:c,value:s,total:l,color:r})=>{const o=l>0?Math.round(s/l*100):0;return React.createElement("div",{style:e.contentBarContainer},React.createElement("div",{style:e.contentBarLabel},React.createElement("span",null,c),React.createElement("span",null,s," (",o,"%)")),React.createElement("div",{style:e.contentBarTrack},React.createElement("div",{style:{...e.contentBarFill,width:`${o}%`,backgroundColor:r}})))},h=({label:c,thisWeek:s,lastWeek:l,change:r})=>React.createElement("div",{style:e.comparisonCard},React.createElement("span",{style:e.comparisonLabel},c),React.createElement("div",{style:e.comparisonValues},React.createElement("div",{style:e.comparisonValue},React.createElement("span",{style:e.comparisonPeriod},"Bu Hafta"),React.createElement("span",{style:e.comparisonNumber},s?.toLocaleString()||0)),React.createElement("div",{style:e.comparisonValue},React.createElement("span",{style:e.comparisonPeriod},"GeÃ§en Hafta"),React.createElement("span",{style:e.comparisonNumber},l?.toLocaleString()||0))),r!==void 0&&React.createElement("span",{style:{...e.comparisonChange,color:r>=0?"#43b581":"#f04747"}},r>=0?"ðŸ“ˆ":"ðŸ“‰"," ",r>=0?"+":"",r,"%")),e={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},modal:{width:"95%",maxWidth:"1200px",maxHeight:"90vh",backgroundColor:"#2f3136",borderRadius:"12px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.5)",display:"flex",flexDirection:"column",overflow:"hidden"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px 24px",borderBottom:"1px solid #202225"},headerLeft:{display:"flex",alignItems:"center",gap:"12px"},headerRight:{display:"flex",alignItems:"center",gap:"12px"},title:{color:"#fff",fontSize:"20px",fontWeight:"600",margin:0},periodSelect:{padding:"8px 12px",backgroundColor:"#36393f",border:"1px solid #40444b",borderRadius:"4px",color:"#dcddde",fontSize:"14px",cursor:"pointer"},closeBtn:{background:"none",border:"none",color:"#72767d",fontSize:"20px",cursor:"pointer",padding:"4px"},content:{flex:1,overflowY:"auto",padding:"24px"},loadingState:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"60px",color:"#72767d",gap:"16px"},spinner:{width:"40px",height:"40px",border:"3px solid #36393f",borderTopColor:"#5865f2",borderRadius:"50%",animation:"spin 1s linear infinite"},errorState:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"60px",color:"#dcddde",textAlign:"center"},statsRow:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px",marginBottom:"24px"},statCard:{display:"flex",alignItems:"center",gap:"16px",padding:"20px",backgroundColor:"#36393f",borderRadius:"8px"},statIcon:{width:"48px",height:"48px",borderRadius:"12px",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontSize:"20px"},statInfo:{display:"flex",flexDirection:"column"},statLabel:{color:"#72767d",fontSize:"12px",marginBottom:"4px"},statValue:{color:"#fff",fontSize:"24px",fontWeight:"700"},statSubtext:{color:"#72767d",fontSize:"11px"},statChange:{fontSize:"12px",display:"flex",alignItems:"center",gap:"4px",marginTop:"4px"},chartsRow:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(350px, 1fr))",gap:"16px",marginBottom:"24px"},chartCard:{backgroundColor:"#36393f",borderRadius:"8px",padding:"20px"},chartTitle:{color:"#fff",fontSize:"14px",fontWeight:"600",marginBottom:"16px"},barChart:{display:"flex",alignItems:"flex-end",gap:"4px",height:"120px"},barContainer:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",height:"100%"},bar:{width:"100%",backgroundColor:"#5865f2",borderRadius:"4px 4px 0 0",transition:"height 0.3s",minHeight:"4px"},barLabel:{color:"#72767d",fontSize:"10px",marginTop:"4px"},hourlyChart:{display:"grid",gridTemplateColumns:"repeat(12, 1fr)",gap:"4px"},hourBlock:{aspectRatio:"1",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontSize:"10px",cursor:"default"},listsRow:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:"16px",marginBottom:"24px"},listCard:{backgroundColor:"#36393f",borderRadius:"8px",padding:"20px"},listTitle:{color:"#fff",fontSize:"14px",fontWeight:"600",marginBottom:"16px",display:"flex",alignItems:"center",gap:"8px"},list:{display:"flex",flexDirection:"column",gap:"8px"},listItem:{display:"flex",alignItems:"center",gap:"12px",padding:"8px 12px",backgroundColor:"#2f3136",borderRadius:"4px"},listRank:{color:"#5865f2",fontWeight:"600",width:"24px"},listName:{color:"#dcddde",flex:1},listValue:{color:"#72767d",fontSize:"12px"},emptyList:{color:"#72767d",textAlign:"center",padding:"20px"},pieChart:{display:"flex",flexDirection:"column",gap:"12px"},contentBarContainer:{display:"flex",flexDirection:"column",gap:"4px"},contentBarLabel:{display:"flex",justifyContent:"space-between",color:"#dcddde",fontSize:"12px"},contentBarTrack:{height:"8px",backgroundColor:"#202225",borderRadius:"4px",overflow:"hidden"},contentBarFill:{height:"100%",borderRadius:"4px",transition:"width 0.3s"},comparisonSection:{backgroundColor:"#36393f",borderRadius:"8px",padding:"20px"},sectionTitle:{color:"#fff",fontSize:"14px",fontWeight:"600",marginBottom:"16px"},comparisonGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px"},comparisonCard:{backgroundColor:"#2f3136",borderRadius:"8px",padding:"16px",display:"flex",flexDirection:"column",gap:"12px"},comparisonLabel:{color:"#fff",fontWeight:"600"},comparisonValues:{display:"flex",gap:"24px"},comparisonValue:{display:"flex",flexDirection:"column"},comparisonPeriod:{color:"#72767d",fontSize:"11px"},comparisonNumber:{color:"#dcddde",fontSize:"18px",fontWeight:"600"},comparisonChange:{fontSize:"14px"}};export{A as default};
