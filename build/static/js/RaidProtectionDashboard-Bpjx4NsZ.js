import{r as c,d as e,as as w,i as Y,ad as q,aJ as g,bS as k,bM as S,c4 as G,q as U,bR as C,aR as A,m as $,ar as Q,U as j,G as W}from"./react-core-DrOm_csO.js";import{t as v}from"./index-BYhWpPLp.js";const te=({serverId:i,apiBaseUrl:o,onClose:h})=>{const[m,E]=c.useState("overview"),[n,p]=c.useState({enabled:!1,level:"medium",lockdown_active:!1,verification_required:!1,auto_ban_enabled:!0}),[y,R]=c.useState([]),[d,N]=c.useState([]),[_,T]=c.useState([]),[s,r]=c.useState({join_rate_limit:10,join_time_window:60,mention_limit:10,message_rate_limit:15,new_account_threshold:7,auto_ban_suspicious:!0,captcha_on_join:!1,dm_on_join_warning:!0}),[X,L]=c.useState(!0),[u,K]=c.useState({blocked_today:0,verified_today:0,raids_detected:0,suspicious_accounts:0}),F=c.useRef(null);c.useEffect(()=>{z(),f(),P(),B();const t=setInterval(f,5e3);return()=>clearInterval(t)},[i]);const z=async()=>{try{const t=localStorage.getItem("access_token"),a=await fetch(`${o}/moderation/raid-protection/status/${i}/`,{headers:{Authorization:`Bearer ${t}`}});if(a.ok){const l=await a.json();p(l.status||n),r(l.settings||s),K(l.stats||u)}}catch(t){console.error("Fetch protection status error:",t)}finally{L(!1)}},f=async()=>{try{const t=localStorage.getItem("access_token"),a=await fetch(`${o}/moderation/raid-protection/activity/${i}/`,{headers:{Authorization:`Bearer ${t}`}});if(a.ok){const l=await a.json();R(l.activity||[])}}catch(t){console.error("Fetch activity error:",t)}},P=async()=>{try{const t=localStorage.getItem("access_token"),a=await fetch(`${o}/moderation/raid-protection/pending/${i}/`,{headers:{Authorization:`Bearer ${t}`}});if(a.ok){const l=await a.json();N(l.pending||[])}}catch(t){console.error("Fetch pending error:",t)}},B=async()=>{try{const t=localStorage.getItem("access_token"),a=await fetch(`${o}/moderation/raid-protection/logs/${i}/`,{headers:{Authorization:`Bearer ${t}`}});if(a.ok){const l=await a.json();T(l.logs||[])}}catch(t){console.error("Fetch logs error:",t)}},x=async()=>{try{const t=localStorage.getItem("access_token"),a=n.enabled?"disable":"enable";(await fetch(`${o}/moderation/raid-protection/${a}/`,{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({server_id:i})})).ok&&(p({...n,enabled:!n.enabled}),v.success(n.enabled?"ðŸ”“ Raid korumasÄ± devre dÄ±ÅŸÄ±":"ðŸ›¡ï¸ Raid korumasÄ± aktif!"))}catch(t){console.error("Toggle protection error:",t)}},D=async()=>{if(window.confirm(n.lockdown_active?"Sunucu kilidini aÃ§mak istediÄŸinizden emin misiniz?":"UYARI: Bu iÅŸlem sunucuyu kilitleyecek. Yeni Ã¼yeler katÄ±lamayacak. Devam?"))try{const a=localStorage.getItem("access_token"),l=n.lockdown_active?"unlock":"lockdown";(await fetch(`${o}/moderation/raid-protection/${l}/`,{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify({server_id:i})})).ok&&(p({...n,lockdown_active:!n.lockdown_active}),v.success(n.lockdown_active?"ðŸ”“ Sunucu kilidi aÃ§Ä±ldÄ±":"ðŸ”’ Sunucu kilitlendi!"))}catch(a){console.error("Lockdown error:",a)}},b=async(t,a)=>{try{const l=localStorage.getItem("access_token");(await fetch(`${o}/moderation/raid-protection/verify/`,{method:"POST",headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"},body:JSON.stringify({server_id:i,user_id:t,action:a})})).ok&&(N(d.filter(J=>J.id!==t)),v.success(a==="approve"?"âœ… KullanÄ±cÄ± onaylandÄ±":"âŒ KullanÄ±cÄ± reddedildi"))}catch(l){console.error("Verify user error:",l)}},H=async()=>{try{const t=localStorage.getItem("access_token");(await fetch(`${o}/moderation/raid-protection/settings/`,{method:"PUT",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({server_id:i,...s})})).ok&&v.success("âœ… Ayarlar kaydedildi!")}catch(t){console.error("Save settings error:",t)}},O=t=>{switch(t){case"join":return"ðŸ‘‹";case"leave":return"ðŸšª";case"kick":return"ðŸ‘¢";case"ban":return"ðŸ”¨";case"suspicious":return"âš ï¸";case"raid_detected":return"ðŸš¨";case"verified":return"âœ…";default:return"ðŸ“‹"}},I=t=>{switch(t){case"join":return"#23a559";case"leave":return"#f0b132";case"kick":case"ban":return"#da373c";case"suspicious":case"raid_detected":return"#f0b132";case"verified":return"#5865f2";default:return"#72767d"}},M=t=>new Date(t).toLocaleTimeString("tr-TR",{hour:"2-digit",minute:"2-digit"});return e.createElement("div",{className:"raid-dashboard-overlay",onClick:h},e.createElement("div",{className:"raid-dashboard",onClick:t=>t.stopPropagation()},e.createElement("div",{className:"dashboard-header"},e.createElement("h2",null,e.createElement(w,null)," Raid Koruma Paneli"),e.createElement("div",{className:"header-status"},e.createElement("span",{className:`status-badge ${n.enabled?"active":"inactive"}`},n.enabled?"ðŸ›¡ï¸ Koruma Aktif":"âš ï¸ Koruma KapalÄ±"),n.lockdown_active&&e.createElement("span",{className:"status-badge lockdown"},"ðŸ”’ Lockdown")),e.createElement("button",{className:"close-btn",onClick:h},e.createElement(Y,null))),e.createElement("div",{className:"dashboard-nav"},e.createElement("button",{className:`nav-btn ${m==="overview"?"active":""}`,onClick:()=>E("overview")},e.createElement(q,null)," Genel BakÄ±ÅŸ"),e.createElement("button",{className:`nav-btn ${m==="verify"?"active":""}`,onClick:()=>E("verify")},e.createElement(g,null)," DoÄŸrulama",d.length>0&&e.createElement("span",{className:"badge"},d.length)),e.createElement("button",{className:`nav-btn ${m==="logs"?"active":""}`,onClick:()=>E("logs")},e.createElement(k,null)," Loglar"),e.createElement("button",{className:`nav-btn ${m==="settings"?"active":""}`,onClick:()=>E("settings")},e.createElement(S,null)," Ayarlar")),e.createElement("div",{className:"dashboard-content"},m==="overview"&&e.createElement("div",{className:"overview-view"},e.createElement("div",{className:"quick-actions"},e.createElement("button",{className:`action-btn ${n.enabled?"enabled":""}`,onClick:x},e.createElement(w,null),n.enabled?"KorumayÄ± Kapat":"KorumayÄ± AÃ§"),e.createElement("button",{className:`action-btn lockdown ${n.lockdown_active?"active":""}`,onClick:D},n.lockdown_active?e.createElement(G,null):e.createElement(U,null),n.lockdown_active?"Kilidi AÃ§":"Sunucuyu Kilitle")),e.createElement("div",{className:"stats-grid"},e.createElement("div",{className:"stat-card"},e.createElement("div",{className:"stat-icon blocked"},e.createElement(C,null)),e.createElement("div",{className:"stat-info"},e.createElement("span",{className:"stat-value"},u.blocked_today),e.createElement("span",{className:"stat-label"},"BugÃ¼n Engellenen"))),e.createElement("div",{className:"stat-card"},e.createElement("div",{className:"stat-icon verified"},e.createElement(A,null)),e.createElement("div",{className:"stat-info"},e.createElement("span",{className:"stat-value"},u.verified_today),e.createElement("span",{className:"stat-label"},"BugÃ¼n DoÄŸrulanan"))),e.createElement("div",{className:"stat-card"},e.createElement("div",{className:"stat-icon raids"},e.createElement($,null)),e.createElement("div",{className:"stat-info"},e.createElement("span",{className:"stat-value"},u.raids_detected),e.createElement("span",{className:"stat-label"},"Tespit Edilen Raid"))),e.createElement("div",{className:"stat-card"},e.createElement("div",{className:"stat-icon suspicious"},e.createElement(Q,null)),e.createElement("div",{className:"stat-info"},e.createElement("span",{className:"stat-value"},u.suspicious_accounts),e.createElement("span",{className:"stat-label"},"ÅžÃ¼pheli Hesap")))),e.createElement("div",{className:"activity-section"},e.createElement("h3",null,e.createElement(j,null)," CanlÄ± Aktivite"),e.createElement("div",{className:"activity-feed",ref:F},y.length>0?y.map((t,a)=>e.createElement("div",{key:a,className:"activity-item",style:{borderLeftColor:I(t.type)}},e.createElement("span",{className:"activity-icon"},O(t.type)),e.createElement("div",{className:"activity-info"},e.createElement("span",{className:"activity-user"},t.username),e.createElement("span",{className:"activity-action"},t.description)),e.createElement("span",{className:"activity-time"},M(t.timestamp)))):e.createElement("div",{className:"no-activity"},e.createElement("p",null,"HenÃ¼z aktivite yok"))))),m==="verify"&&e.createElement("div",{className:"verify-view"},e.createElement("h3",null,e.createElement(g,null)," Bekleyen DoÄŸrulamalar"),d.length>0?e.createElement("div",{className:"verifications-list"},d.map(t=>e.createElement("div",{key:t.id,className:"verification-card"},e.createElement("img",{src:t.avatar||"/default-avatar.png",alt:t.username,className:"user-avatar"}),e.createElement("div",{className:"user-info"},e.createElement("h4",null,t.username),e.createElement("div",{className:"user-meta"},e.createElement("span",null,e.createElement(j,null)," KatÄ±lÄ±m: ",new Date(t.joined_at).toLocaleDateString("tr-TR")),e.createElement("span",null,e.createElement(W,null)," Hesap: ",t.account_age_days," gÃ¼n")),t.suspicious_reasons&&e.createElement("div",{className:"suspicious-reasons"},e.createElement($,null),t.suspicious_reasons.map((a,l)=>e.createElement("span",{key:l,className:"reason-tag"},a)))),e.createElement("div",{className:"verification-actions"},e.createElement("button",{className:"approve-btn",onClick:()=>b(t.id,"approve")},e.createElement(A,null)," Onayla"),e.createElement("button",{className:"reject-btn",onClick:()=>b(t.id,"reject")},e.createElement(C,null)," Reddet"))))):e.createElement("div",{className:"no-verifications"},e.createElement(g,{className:"empty-icon"}),e.createElement("p",null,"Bekleyen doÄŸrulama yok"))),m==="logs"&&e.createElement("div",{className:"logs-view"},e.createElement("h3",null,e.createElement(k,null)," Raid LoglarÄ±"),_.length>0?e.createElement("div",{className:"logs-list"},_.map((t,a)=>e.createElement("div",{key:a,className:`log-item ${t.severity}`},e.createElement("div",{className:"log-header"},e.createElement("span",{className:"log-type"},t.type==="raid_detected"&&"ðŸš¨ Raid Tespit Edildi",t.type==="mass_ban"&&"ðŸ”¨ Toplu Ban",t.type==="lockdown"&&"ðŸ”’ Lockdown",t.type==="unlock"&&"ðŸ”“ Kilit AÃ§Ä±ldÄ±",t.type==="suspicious_activity"&&"âš ï¸ ÅžÃ¼pheli Aktivite"),e.createElement("span",{className:"log-time"},new Date(t.timestamp).toLocaleString("tr-TR"))),e.createElement("p",{className:"log-description"},t.description),t.affected_users&&e.createElement("span",{className:"affected-count"},t.affected_users," kullanÄ±cÄ± etkilendi")))):e.createElement("div",{className:"no-logs"},e.createElement(k,{className:"empty-icon"}),e.createElement("p",null,"HenÃ¼z log kaydÄ± yok"))),m==="settings"&&e.createElement("div",{className:"settings-view"},e.createElement("h3",null,e.createElement(S,null)," Koruma AyarlarÄ±"),e.createElement("div",{className:"settings-section"},e.createElement("h4",null,"KatÄ±lÄ±m Limitleri"),e.createElement("div",{className:"setting-item"},e.createElement("div",{className:"setting-info"},e.createElement("label",null,"KatÄ±lÄ±m HÄ±z Limiti"),e.createElement("p",null,"Belirli sÃ¼re iÃ§inde maksimum katÄ±lÄ±m sayÄ±sÄ±")),e.createElement("div",{className:"setting-control"},e.createElement("input",{type:"number",value:s.join_rate_limit,onChange:t=>r({...s,join_rate_limit:parseInt(t.target.value)}),min:"1",max:"100"}),e.createElement("span",null,"kiÅŸi /"),e.createElement("input",{type:"number",value:s.join_time_window,onChange:t=>r({...s,join_time_window:parseInt(t.target.value)}),min:"10",max:"300"}),e.createElement("span",null,"saniye"))),e.createElement("div",{className:"setting-item"},e.createElement("div",{className:"setting-info"},e.createElement("label",null,"Yeni Hesap EÅŸiÄŸi"),e.createElement("p",null,"Bu gÃ¼nden eski hesaplar ÅŸÃ¼pheli sayÄ±lÄ±r")),e.createElement("div",{className:"setting-control"},e.createElement("input",{type:"number",value:s.new_account_threshold,onChange:t=>r({...s,new_account_threshold:parseInt(t.target.value)}),min:"1",max:"30"}),e.createElement("span",null,"gÃ¼n")))),e.createElement("div",{className:"settings-section"},e.createElement("h4",null,"Mesaj Limitleri"),e.createElement("div",{className:"setting-item"},e.createElement("div",{className:"setting-info"},e.createElement("label",null,"Mention Limiti"),e.createElement("p",null,"Bir mesajdaki maksimum mention sayÄ±sÄ±")),e.createElement("div",{className:"setting-control"},e.createElement("input",{type:"number",value:s.mention_limit,onChange:t=>r({...s,mention_limit:parseInt(t.target.value)}),min:"1",max:"50"}))),e.createElement("div",{className:"setting-item"},e.createElement("div",{className:"setting-info"},e.createElement("label",null,"Mesaj HÄ±z Limiti"),e.createElement("p",null,"10 saniyede maksimum mesaj sayÄ±sÄ±")),e.createElement("div",{className:"setting-control"},e.createElement("input",{type:"number",value:s.message_rate_limit,onChange:t=>r({...s,message_rate_limit:parseInt(t.target.value)}),min:"1",max:"50"})))),e.createElement("div",{className:"settings-section"},e.createElement("h4",null,"Otomatik Aksiyonlar"),e.createElement("div",{className:"setting-item toggle"},e.createElement("div",{className:"setting-info"},e.createElement("label",null,"ÅžÃ¼pheli HesaplarÄ± Otomatik Banla"),e.createElement("p",null,"Raid tespit edildiÄŸinde ÅŸÃ¼pheli hesaplarÄ± otomatik banla")),e.createElement("label",{className:"toggle-switch"},e.createElement("input",{type:"checkbox",checked:s.auto_ban_suspicious,onChange:t=>r({...s,auto_ban_suspicious:t.target.checked})}),e.createElement("span",{className:"slider"}))),e.createElement("div",{className:"setting-item toggle"},e.createElement("div",{className:"setting-info"},e.createElement("label",null,"KatÄ±lÄ±mda CAPTCHA"),e.createElement("p",null,"Yeni Ã¼yeler katÄ±lÄ±rken CAPTCHA doÄŸrulamasÄ± iste")),e.createElement("label",{className:"toggle-switch"},e.createElement("input",{type:"checkbox",checked:s.captcha_on_join,onChange:t=>r({...s,captcha_on_join:t.target.checked})}),e.createElement("span",{className:"slider"}))),e.createElement("div",{className:"setting-item toggle"},e.createElement("div",{className:"setting-info"},e.createElement("label",null,"KatÄ±lÄ±m UyarÄ± DM"),e.createElement("p",null,"ÅžÃ¼pheli hesap katÄ±ldÄ±ÄŸÄ±nda yÃ¶neticilere DM gÃ¶nder")),e.createElement("label",{className:"toggle-switch"},e.createElement("input",{type:"checkbox",checked:s.dm_on_join_warning,onChange:t=>r({...s,dm_on_join_warning:t.target.checked})}),e.createElement("span",{className:"slider"})))),e.createElement("div",{className:"settings-actions"},e.createElement("button",{className:"save-btn",onClick:H},"AyarlarÄ± Kaydet"))))))};export{te as default};
