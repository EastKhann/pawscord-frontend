import{r as c,L as f,l as C,w as k,aT as S,aH as L}from"./react-core-B6hadH-M.js";import{t as x}from"./index-D_6pZib5.js";const z=({fetchWithAuth:m,apiBaseUrl:u,onClose:g,roomSlug:y})=>{const[i,b]=c.useState([]),[R,p]=c.useState(!1),[r,h]=c.useState(""),[s,d]=c.useState([]);c.useEffect(()=>{E()},[]),c.useEffect(()=>{if(r){const e=i.filter(o=>o.text.toLowerCase().includes(r.toLowerCase())||o.speaker_username.toLowerCase().includes(r.toLowerCase()));d(e)}else d(i)},[r,i]);const E=async()=>{p(!0);try{const o=await(await m(`${u}/voice/transcripts/?room_slug=${y}`)).json();b(o.transcripts||[]),d(o.transcripts||[])}catch{x.error("Failed to load transcripts")}finally{p(!1)}},w=e=>{const o=`Voice Transcript
Speaker: ${e.speaker_username}
Date: ${new Date(e.created_at).toLocaleString()}
Confidence: ${(e.confidence*100).toFixed(1)}%

${e.text}
`,l=new Blob([o],{type:"text/plain"}),n=window.URL.createObjectURL(l),a=document.createElement("a");a.href=n,a.download=`transcript_${e.id}.txt`,document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(n),document.body.removeChild(a)},v=()=>{const e=[["Speaker","Date","Text","Confidence"],...s.map(a=>[a.speaker_username,new Date(a.created_at).toLocaleString(),`"${a.text.replace(/"/g,'""')}"`,`${(a.confidence*100).toFixed(1)}%`])].map(a=>a.join(",")).join(`
`),o=new Blob([e],{type:"text/csv"}),l=window.URL.createObjectURL(o),n=document.createElement("a");n.href=l,n.download=`voice_transcripts_${Date.now()}.csv`,document.body.appendChild(n),n.click(),window.URL.revokeObjectURL(l),document.body.removeChild(n),x.success("Transcripts exported")};return React.createElement("div",{style:t.overlay},React.createElement("div",{style:t.modal},React.createElement("div",{style:t.header},React.createElement("div",{style:t.headerLeft},React.createElement(f,{style:{marginRight:"10px",color:"#5865f2"}}),React.createElement("h2",{style:t.title},"Voice Transcripts")),React.createElement("button",{onClick:g,style:t.closeButton},React.createElement(C,null))),React.createElement("div",{style:t.toolbar},React.createElement("div",{style:t.searchBox},React.createElement(k,{style:{color:"#99aab5",marginRight:"8px"}}),React.createElement("input",{type:"text",value:r,onChange:e=>h(e.target.value),placeholder:"Search transcripts...",style:t.searchInput})),React.createElement("button",{onClick:v,style:t.exportButton},React.createElement(S,{style:{marginRight:"6px"}}),"Export All")),React.createElement("div",{style:t.content},R?React.createElement("div",{style:t.loading},"Loading transcripts..."):s.length===0?React.createElement("div",{style:t.empty},r?"No transcripts match your search":"No voice transcripts yet"):React.createElement("div",{style:t.transcriptsList},s.map((e,o)=>React.createElement("div",{key:o,style:t.transcriptCard},React.createElement("div",{style:t.transcriptHeader},React.createElement("div",{style:t.speaker},React.createElement(f,{style:{marginRight:"8px",color:"#5865f2",fontSize:"14px"}}),e.speaker_username),React.createElement("div",{style:t.metadata},React.createElement("span",{style:t.date},new Date(e.created_at).toLocaleString()),React.createElement("span",{style:{...t.confidence,color:e.confidence>=.8?"#43b581":e.confidence>=.6?"#faa61a":"#f04747"}},(e.confidence*100).toFixed(1),"% confidence"))),React.createElement("div",{style:t.transcriptText},e.text),e.duration&&React.createElement("div",{style:t.duration},"Duration: ",e.duration,"s"),React.createElement("button",{onClick:()=>w(e),style:t.downloadButton},React.createElement(L,{style:{marginRight:"6px"}}),"Download")))))))},t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999},modal:{backgroundColor:"#1e1e1e",borderRadius:"8px",width:"90%",maxWidth:"900px",maxHeight:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #2c2f33"},headerLeft:{display:"flex",alignItems:"center"},title:{margin:0,fontSize:"20px",color:"#ffffff"},closeButton:{background:"none",border:"none",color:"#99aab5",cursor:"pointer",fontSize:"20px",padding:"5px"},toolbar:{display:"flex",gap:"12px",padding:"15px 20px",borderBottom:"1px solid #2c2f33"},searchBox:{flex:1,display:"flex",alignItems:"center",backgroundColor:"#2c2f33",borderRadius:"4px",padding:"8px 12px"},searchInput:{flex:1,background:"none",border:"none",color:"#ffffff",fontSize:"14px",outline:"none"},exportButton:{padding:"8px 16px",backgroundColor:"#5865f2",border:"none",borderRadius:"4px",color:"#ffffff",cursor:"pointer",fontSize:"13px",display:"flex",alignItems:"center"},content:{padding:"20px",overflowY:"auto",flex:1},loading:{textAlign:"center",color:"#99aab5",padding:"40px"},empty:{textAlign:"center",color:"#99aab5",padding:"40px"},transcriptsList:{display:"flex",flexDirection:"column",gap:"16px"},transcriptCard:{backgroundColor:"#2c2f33",borderRadius:"8px",padding:"16px"},transcriptHeader:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"12px"},speaker:{fontSize:"14px",fontWeight:"600",color:"#ffffff",display:"flex",alignItems:"center"},metadata:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"4px"},date:{fontSize:"12px",color:"#99aab5"},confidence:{fontSize:"12px",fontWeight:"500"},transcriptText:{fontSize:"14px",color:"#dcddde",lineHeight:"1.6",marginBottom:"12px",padding:"12px",backgroundColor:"#1e1e1e",borderRadius:"4px"},duration:{fontSize:"12px",color:"#99aab5",marginBottom:"12px"},downloadButton:{padding:"6px 12px",backgroundColor:"#5865f2",border:"none",borderRadius:"4px",color:"#ffffff",cursor:"pointer",fontSize:"12px",display:"inline-flex",alignItems:"center"}};export{z as default};
