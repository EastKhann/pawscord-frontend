import{r as c,n as y,cl as k,l as w,aD as m,am as _,c8 as R,ax as b,ak as f,K as C,Y as F,bQ as A,a3 as $,c2 as x,c3 as S,c$ as D}from"./react-core-B6hadH-M.js";import{g as L}from"./index-D_6pZib5.js";const P=({serverId:i,onClose:l,fetchWithAuth:o})=>{const[t,n]=c.useState(null),[v,d]=c.useState(!0),[s,p]=c.useState(null),[r,h]=c.useState("week"),u=c.useCallback(async()=>{d(!0);try{const e=await o(`${L()}/servers/${i}/channel-analytics/?range=${r}`);if(e.ok){const a=await e.json();n(a)}else n({summary:{total_channels:24,active_channels:18,total_messages:45823,average_response_time:2.4},channels:[{id:1,name:"general",type:"text",messages:12450,active_users:234,growth:15.2,peak_hour:20},{id:2,name:"announcements",type:"text",messages:856,active_users:512,growth:8.4,peak_hour:12},{id:3,name:"memes",type:"text",messages:8932,active_users:189,growth:22.1,peak_hour:22},{id:4,name:"gaming",type:"text",messages:6721,active_users:145,growth:-3.2,peak_hour:21},{id:5,name:"music",type:"voice",messages:0,active_users:67,growth:5.8,peak_hour:19},{id:6,name:"help",type:"text",messages:3421,active_users:98,growth:0,peak_hour:14}],peak_hours:[{hour:20,activity:100},{hour:21,activity:95},{hour:22,activity:88},{hour:19,activity:82},{hour:18,activity:75}],engagement_rate:76.4})}catch(e){console.error("Error loading analytics:",e),n({summary:{},channels:[],peak_hours:[]})}d(!1)},[i,r,o]);c.useEffect(()=>{u()},[u]);const E=e=>e>=1e6?(e/1e6).toFixed(1)+"M":e>=1e3?(e/1e3).toFixed(1)+"K":e?.toString()||"0",N=e=>e>0?React.createElement(x,{className:"growth-up"}):e<0?React.createElement(S,{className:"growth-down"}):React.createElement(D,{className:"growth-neutral"}),g=e=>e==="voice"?React.createElement($,null):React.createElement(m,null);return v?React.createElement("div",{className:"channel-analytics-overlay",onClick:l},React.createElement("div",{className:"channel-analytics-panel",onClick:e=>e.stopPropagation()},React.createElement("div",{className:"loading-state"},React.createElement(y,{className:"spin"}),React.createElement("span",null,"Loading channel analytics...")))):React.createElement("div",{className:"channel-analytics-overlay",onClick:l},React.createElement("div",{className:"channel-analytics-panel",onClick:e=>e.stopPropagation()},React.createElement("div",{className:"panel-header"},React.createElement("div",{className:"header-info"},React.createElement("h2",null,React.createElement(k,null)," Channel Analytics"),React.createElement("span",{className:"subtitle"},"Track channel performance and engagement")),React.createElement("div",{className:"header-actions"},React.createElement("select",{value:r,onChange:e=>h(e.target.value),className:"time-select"},React.createElement("option",{value:"day"},"Last 24 Hours"),React.createElement("option",{value:"week"},"Last 7 Days"),React.createElement("option",{value:"month"},"Last 30 Days")),React.createElement("button",{className:"close-btn",onClick:l},React.createElement(w,null)))),React.createElement("div",{className:"summary-cards"},React.createElement("div",{className:"summary-card"},React.createElement("div",{className:"card-icon"},React.createElement(m,null)),React.createElement("div",{className:"card-content"},React.createElement("span",{className:"card-value"},t?.summary?.total_channels||0),React.createElement("span",{className:"card-label"},"Total Channels"))),React.createElement("div",{className:"summary-card"},React.createElement("div",{className:"card-icon active"},React.createElement(_,null)),React.createElement("div",{className:"card-content"},React.createElement("span",{className:"card-value"},t?.summary?.active_channels||0),React.createElement("span",{className:"card-label"},"Active Channels"))),React.createElement("div",{className:"summary-card"},React.createElement("div",{className:"card-icon"},React.createElement(R,null)),React.createElement("div",{className:"card-content"},React.createElement("span",{className:"card-value"},E(t?.summary?.total_messages)),React.createElement("span",{className:"card-label"},"Total Messages"))),React.createElement("div",{className:"summary-card"},React.createElement("div",{className:"card-icon"},React.createElement(b,null)),React.createElement("div",{className:"card-content"},React.createElement("span",{className:"card-value"},t?.engagement_rate||0,"%"),React.createElement("span",{className:"card-label"},"Engagement Rate")))),React.createElement("div",{className:"panel-body"},React.createElement("div",{className:"section"},React.createElement("h3",null,React.createElement(f,null)," Channel Leaderboard"),React.createElement("div",{className:"channel-list"},(t?.channels||[]).sort((e,a)=>a.messages-e.messages).map((e,a)=>React.createElement("div",{key:e.id,className:`channel-item ${s===e.id?"selected":""}`,onClick:()=>p(e.id===s?null:e.id)},React.createElement("span",{className:`rank ${a<3?"top":""}`},"#",a+1),React.createElement("span",{className:"channel-icon"},g(e.type)),React.createElement("div",{className:"channel-info"},React.createElement("span",{className:"channel-name"},e.name),React.createElement("div",{className:"channel-stats"},React.createElement("span",null,React.createElement(R,null)," ",E(e.messages)),React.createElement("span",null,React.createElement(C,null)," ",e.active_users))),React.createElement("div",{className:"channel-growth"},N(e.growth),React.createElement("span",{className:e.growth>0?"positive":e.growth<0?"negative":""},Math.abs(e.growth),"%")),React.createElement("div",{className:"channel-bar"},React.createElement("div",{className:"bar-fill",style:{width:`${e.messages/(t?.channels?.[0]?.messages||1)*100}%`}})))),(!t?.channels||t.channels.length===0)&&React.createElement("div",{className:"empty-state"},"No channel data available"))),React.createElement("div",{className:"section"},React.createElement("h3",null,React.createElement(F,null)," Peak Activity Hours"),React.createElement("div",{className:"peak-hours"},(t?.peak_hours||[]).map((e,a)=>React.createElement("div",{key:a,className:"peak-item"},React.createElement("span",{className:"peak-rank"},"#",a+1),React.createElement("div",{className:"peak-time"},React.createElement(A,null),React.createElement("span",null,e.hour,":00 - ",e.hour+1,":00")),React.createElement("div",{className:"peak-bar"},React.createElement("div",{className:"bar-fill",style:{width:`${e.activity}%`}})),React.createElement("span",{className:"peak-value"},e.activity,"%"))))),s&&React.createElement("div",{className:"section channel-details"},React.createElement("h3",null,React.createElement(m,null)," Channel Details"),(()=>{const e=t?.channels?.find(a=>a.id===s);return e?React.createElement("div",{className:"details-grid"},React.createElement("div",{className:"detail-card"},React.createElement("span",{className:"detail-label"},"Peak Hour"),React.createElement("span",{className:"detail-value"},e.peak_hour,":00")),React.createElement("div",{className:"detail-card"},React.createElement("span",{className:"detail-label"},"Active Users"),React.createElement("span",{className:"detail-value"},e.active_users)),React.createElement("div",{className:"detail-card"},React.createElement("span",{className:"detail-label"},"Weekly Growth"),React.createElement("span",{className:`detail-value ${e.growth>0?"positive":e.growth<0?"negative":""}`},e.growth>0?"+":"",e.growth,"%")),React.createElement("div",{className:"detail-card"},React.createElement("span",{className:"detail-label"},"Messages/Day"),React.createElement("span",{className:"detail-value"},Math.round(e.messages/7)))):null})()))))};export{P as default};
