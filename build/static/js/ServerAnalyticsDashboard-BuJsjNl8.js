import{r as x,n as e,l as T}from"./react-core-zXIKm1Jm.js";import{R as z,a as B,t as u,aA as D,D as L,a5 as I,b5 as A,b6 as $}from"./icons-vendor-BBdoVeJd.js";import"./editor-vendor-DiU449Dh.js";const M=({isOpen:r,onClose:d,serverId:l,serverName:o,fetchWithAuth:n,apiBaseUrl:h})=>{const[s,C]=x.useState(null),[c,k]=x.useState(null),[S,j]=x.useState(!0),[g,_]=x.useState("30d"),b=x.useCallback(async()=>{if(l){j(!0);try{const[a,i]=await Promise.all([n(`${h}/servers/${l}/analytics/?period=${g}`),n(`${h}/servers/${l}/analytics/compare/`)]);if(a.ok){const p=await a.json();C(p)}if(i.ok){const p=await i.json();k(p)}}catch(a){console.error("Analytics fetch error:",a)}finally{j(!1)}}},[l,g,n,h]);if(x.useEffect(()=>{r&&l&&b()},[r,l,b]),!r)return null;const w=e.jsx("div",{style:t.overlay,onClick:d,children:e.jsxs("div",{style:t.modal,onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{style:t.header,children:[e.jsxs("div",{style:t.headerLeft,children:[e.jsx(z,{style:{color:"#5865f2"}}),e.jsxs("h2",{style:t.title,children:[o||"Sunucu"," Analytics"]})]}),e.jsxs("div",{style:t.headerRight,children:[e.jsxs("select",{value:g,onChange:a=>_(a.target.value),style:t.periodSelect,children:[e.jsx("option",{value:"7d",children:"Son 7 GÃ¼n"}),e.jsx("option",{value:"30d",children:"Son 30 GÃ¼n"}),e.jsx("option",{value:"90d",children:"Son 90 GÃ¼n"})]}),e.jsx("button",{onClick:d,style:t.closeBtn,children:e.jsx(B,{})})]})]}),e.jsx("div",{style:t.content,children:S?e.jsxs("div",{style:t.loadingState,children:[e.jsx("div",{style:t.spinner}),e.jsx("span",{children:"Veriler yÃ¼kleniyor..."})]}):s?e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:t.statsRow,children:[e.jsx(m,{icon:e.jsx(u,{}),label:"Toplam Ãœye",value:s.member_growth?.total||0,change:c?.change?.active_users,color:"#5865f2"}),e.jsx(m,{icon:e.jsx(D,{}),label:"Toplam Mesaj",value:s.message_stats?.total||0,subtext:`GÃ¼nlÃ¼k ort: ${s.message_stats?.daily_average||0}`,change:c?.change?.messages,color:"#43b581"}),e.jsx(m,{icon:e.jsx(u,{}),label:"Aktif Ãœye",value:s.active_users?.total||0,subtext:`%${s.active_users?.activity_rate||0} aktivite`,color:"#faa61a"}),e.jsx(m,{icon:e.jsx(L,{}),label:"En YoÄŸun Saat",value:s.peak_hours?.peak_hour_label||"-",color:"#f04747"})]}),e.jsxs("div",{style:t.chartsRow,children:[e.jsxs("div",{style:t.chartCard,children:[e.jsx("h3",{style:t.chartTitle,children:"ðŸ“ˆ Mesaj Aktivitesi"}),e.jsx("div",{style:t.barChart,children:s.message_stats?.daily?.slice(-14).map((a,i)=>{const p=Math.max(...s.message_stats?.daily?.map(R=>R.count)||[1]),y=a.count/p*100;return e.jsxs("div",{style:t.barContainer,children:[e.jsx("div",{style:{...t.bar,height:`${Math.max(y,5)}%`},title:`${a.date}: ${a.count} mesaj`}),e.jsx("span",{style:t.barLabel,children:new Date(a.date).getDate()})]},i)})})]}),e.jsxs("div",{style:t.chartCard,children:[e.jsx("h3",{style:t.chartTitle,children:"â° Saatlik Aktivite"}),e.jsx("div",{style:t.hourlyChart,children:s.peak_hours?.hourly?.map((a,i)=>{const p=Math.max(...s.peak_hours?.hourly||[1]),y=a/p;return e.jsx("div",{style:{...t.hourBlock,backgroundColor:`rgba(88, 101, 242, ${Math.max(y,.1)})`},title:`${i}:00 - ${a} mesaj`,children:i},i)})})]})]}),e.jsxs("div",{style:t.listsRow,children:[e.jsxs("div",{style:t.listCard,children:[e.jsxs("h3",{style:t.listTitle,children:[e.jsx(I,{})," PopÃ¼ler Kanallar"]}),e.jsxs("div",{style:t.list,children:[s.popular_channels?.slice(0,5).map((a,i)=>e.jsxs("div",{style:t.listItem,children:[e.jsxs("span",{style:t.listRank,children:["#",i+1]}),e.jsx("span",{style:t.listName,children:a.name}),e.jsxs("span",{style:t.listValue,children:[a.messages," mesaj"]})]},i)),(!s.popular_channels||s.popular_channels.length===0)&&e.jsx("div",{style:t.emptyList,children:"Veri yok"})]})]}),e.jsxs("div",{style:t.listCard,children:[e.jsxs("h3",{style:t.listTitle,children:[e.jsx(u,{})," En Aktif Ãœyeler"]}),e.jsxs("div",{style:t.list,children:[s.active_users?.top_users?.slice(0,5).map((a,i)=>e.jsxs("div",{style:t.listItem,children:[e.jsxs("span",{style:t.listRank,children:["#",i+1]}),e.jsx("span",{style:t.listName,children:a.username}),e.jsxs("span",{style:t.listValue,children:[a.messages," mesaj"]})]},i)),(!s.active_users?.top_users||s.active_users.top_users.length===0)&&e.jsx("div",{style:t.emptyList,children:"Veri yok"})]})]}),e.jsxs("div",{style:t.listCard,children:[e.jsx("h3",{style:t.listTitle,children:"ðŸ“Š Ä°Ã§erik DaÄŸÄ±lÄ±mÄ±"}),e.jsx("div",{style:t.pieChart,children:s.content_breakdown&&e.jsxs(e.Fragment,{children:[e.jsx(f,{label:"Metin",value:s.content_breakdown.text_only,total:s.message_stats?.total||1,color:"#5865f2"}),e.jsx(f,{label:"Resimli",value:s.content_breakdown.with_images,total:s.message_stats?.total||1,color:"#43b581"}),e.jsx(f,{label:"DosyalÄ±",value:s.content_breakdown.with_files,total:s.message_stats?.total||1,color:"#faa61a"}),e.jsx(f,{label:"Ses",value:s.content_breakdown.voice_messages,total:s.message_stats?.total||1,color:"#f04747"})]})})]})]}),c&&e.jsxs("div",{style:t.comparisonSection,children:[e.jsx("h3",{style:t.sectionTitle,children:"ðŸ“Š HaftalÄ±k KarÅŸÄ±laÅŸtÄ±rma"}),e.jsxs("div",{style:t.comparisonGrid,children:[e.jsx(v,{label:"Mesajlar",thisWeek:c.this_week?.messages,lastWeek:c.last_week?.messages,change:c.change?.messages}),e.jsx(v,{label:"Aktif Ãœyeler",thisWeek:c.this_week?.active_users,lastWeek:c.last_week?.active_users,change:c.change?.active_users})]})]})]}):e.jsxs("div",{style:t.errorState,children:[e.jsx("span",{style:{fontSize:"48px"},children:"ðŸ“Š"}),e.jsx("p",{children:"Analytics verileri yÃ¼klenemedi"})]})})]})});return T.createPortal(w,document.body)},m=({icon:r,label:d,value:l,subtext:o,change:n,color:h})=>e.jsxs("div",{style:t.statCard,children:[e.jsx("div",{style:{...t.statIcon,backgroundColor:h},children:r}),e.jsxs("div",{style:t.statInfo,children:[e.jsx("span",{style:t.statLabel,children:d}),e.jsx("span",{style:t.statValue,children:typeof l=="number"?l.toLocaleString():l}),o&&e.jsx("span",{style:t.statSubtext,children:o}),n!==void 0&&e.jsxs("span",{style:{...t.statChange,color:n>=0?"#43b581":"#f04747"},children:[n>=0?e.jsx(A,{}):e.jsx($,{})," ",Math.abs(n),"%"]})]})]}),f=({label:r,value:d,total:l,color:o})=>{const n=l>0?Math.round(d/l*100):0;return e.jsxs("div",{style:t.contentBarContainer,children:[e.jsxs("div",{style:t.contentBarLabel,children:[e.jsx("span",{children:r}),e.jsxs("span",{children:[d," (",n,"%)"]})]}),e.jsx("div",{style:t.contentBarTrack,children:e.jsx("div",{style:{...t.contentBarFill,width:`${n}%`,backgroundColor:o}})})]})},v=({label:r,thisWeek:d,lastWeek:l,change:o})=>e.jsxs("div",{style:t.comparisonCard,children:[e.jsx("span",{style:t.comparisonLabel,children:r}),e.jsxs("div",{style:t.comparisonValues,children:[e.jsxs("div",{style:t.comparisonValue,children:[e.jsx("span",{style:t.comparisonPeriod,children:"Bu Hafta"}),e.jsx("span",{style:t.comparisonNumber,children:d?.toLocaleString()||0})]}),e.jsxs("div",{style:t.comparisonValue,children:[e.jsx("span",{style:t.comparisonPeriod,children:"GeÃ§en Hafta"}),e.jsx("span",{style:t.comparisonNumber,children:l?.toLocaleString()||0})]})]}),o!==void 0&&e.jsxs("span",{style:{...t.comparisonChange,color:o>=0?"#43b581":"#f04747"},children:[o>=0?"ðŸ“ˆ":"ðŸ“‰"," ",o>=0?"+":"",o,"%"]})]}),t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},modal:{width:"95%",maxWidth:"1200px",maxHeight:"90vh",backgroundColor:"#2f3136",borderRadius:"12px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.5)",display:"flex",flexDirection:"column",overflow:"hidden"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px 24px",borderBottom:"1px solid #202225"},headerLeft:{display:"flex",alignItems:"center",gap:"12px"},headerRight:{display:"flex",alignItems:"center",gap:"12px"},title:{color:"#fff",fontSize:"20px",fontWeight:"600",margin:0},periodSelect:{padding:"8px 12px",backgroundColor:"#36393f",border:"1px solid #40444b",borderRadius:"4px",color:"#dcddde",fontSize:"14px",cursor:"pointer"},closeBtn:{background:"none",border:"none",color:"#72767d",fontSize:"20px",cursor:"pointer",padding:"4px"},content:{flex:1,overflowY:"auto",padding:"24px"},loadingState:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"60px",color:"#72767d",gap:"16px"},spinner:{width:"40px",height:"40px",border:"3px solid #36393f",borderTopColor:"#5865f2",borderRadius:"50%",animation:"spin 1s linear infinite"},errorState:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"60px",color:"#dcddde",textAlign:"center"},statsRow:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px",marginBottom:"24px"},statCard:{display:"flex",alignItems:"center",gap:"16px",padding:"20px",backgroundColor:"#36393f",borderRadius:"8px"},statIcon:{width:"48px",height:"48px",borderRadius:"12px",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontSize:"20px"},statInfo:{display:"flex",flexDirection:"column"},statLabel:{color:"#72767d",fontSize:"12px",marginBottom:"4px"},statValue:{color:"#fff",fontSize:"24px",fontWeight:"700"},statSubtext:{color:"#72767d",fontSize:"11px"},statChange:{fontSize:"12px",display:"flex",alignItems:"center",gap:"4px",marginTop:"4px"},chartsRow:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(350px, 1fr))",gap:"16px",marginBottom:"24px"},chartCard:{backgroundColor:"#36393f",borderRadius:"8px",padding:"20px"},chartTitle:{color:"#fff",fontSize:"14px",fontWeight:"600",marginBottom:"16px"},barChart:{display:"flex",alignItems:"flex-end",gap:"4px",height:"120px"},barContainer:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",height:"100%"},bar:{width:"100%",backgroundColor:"#5865f2",borderRadius:"4px 4px 0 0",transition:"height 0.3s",minHeight:"4px"},barLabel:{color:"#72767d",fontSize:"10px",marginTop:"4px"},hourlyChart:{display:"grid",gridTemplateColumns:"repeat(12, 1fr)",gap:"4px"},hourBlock:{aspectRatio:"1",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontSize:"10px",cursor:"default"},listsRow:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:"16px",marginBottom:"24px"},listCard:{backgroundColor:"#36393f",borderRadius:"8px",padding:"20px"},listTitle:{color:"#fff",fontSize:"14px",fontWeight:"600",marginBottom:"16px",display:"flex",alignItems:"center",gap:"8px"},list:{display:"flex",flexDirection:"column",gap:"8px"},listItem:{display:"flex",alignItems:"center",gap:"12px",padding:"8px 12px",backgroundColor:"#2f3136",borderRadius:"4px"},listRank:{color:"#5865f2",fontWeight:"600",width:"24px"},listName:{color:"#dcddde",flex:1},listValue:{color:"#72767d",fontSize:"12px"},emptyList:{color:"#72767d",textAlign:"center",padding:"20px"},pieChart:{display:"flex",flexDirection:"column",gap:"12px"},contentBarContainer:{display:"flex",flexDirection:"column",gap:"4px"},contentBarLabel:{display:"flex",justifyContent:"space-between",color:"#dcddde",fontSize:"12px"},contentBarTrack:{height:"8px",backgroundColor:"#202225",borderRadius:"4px",overflow:"hidden"},contentBarFill:{height:"100%",borderRadius:"4px",transition:"width 0.3s"},comparisonSection:{backgroundColor:"#36393f",borderRadius:"8px",padding:"20px"},sectionTitle:{color:"#fff",fontSize:"14px",fontWeight:"600",marginBottom:"16px"},comparisonGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px"},comparisonCard:{backgroundColor:"#2f3136",borderRadius:"8px",padding:"16px",display:"flex",flexDirection:"column",gap:"12px"},comparisonLabel:{color:"#fff",fontWeight:"600"},comparisonValues:{display:"flex",gap:"24px"},comparisonValue:{display:"flex",flexDirection:"column"},comparisonPeriod:{color:"#72767d",fontSize:"11px"},comparisonNumber:{color:"#dcddde",fontSize:"18px",fontWeight:"600"},comparisonChange:{fontSize:"14px"}};export{M as default};
