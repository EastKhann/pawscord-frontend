import{r as c,ch as a}from"./react-core-B6hadH-M.js";import{g as W,h as S}from"./index-D_6pZib5.js";const q=({onClose:R})=>{const[o,l]=c.useState(!1),[Y,$]=c.useState([]),[v,C]=c.useState([]),[b,P]=c.useState([]),[d,f]=c.useState([]),[m,N]=c.useState(""),[w,A]=c.useState(""),[u,g]=c.useState(""),[F,T]=c.useState(null),[n,p]=c.useState("2fa"),s=W(),r=localStorage.getItem("access_token");c.useEffect(()=>{h(),z(),k(),E()},[]);const h=async()=>{try{const t=await(await fetch(`${s}/security/status/`,{headers:{Authorization:`Bearer ${r}`}})).json();T(t),l(t.two_factor_enabled||!1)}catch(e){console.error("Error fetching security status:",e)}},z=async()=>{try{const t=await(await fetch(`${s}/2fa/methods/`,{headers:{Authorization:`Bearer ${r}`}})).json();$(t.methods||[])}catch(e){console.error("Error fetching 2FA methods:",e)}},k=async()=>{try{const t=await(await fetch(`${s}/security/sessions/`,{headers:{Authorization:`Bearer ${r}`}})).json();C(t.sessions||[])}catch(e){console.error("Error fetching sessions:",e)}},E=async()=>{try{const t=await(await fetch(`${s}/security/ip-whitelist/`,{headers:{Authorization:`Bearer ${r}`}})).json();P(t.whitelist||[])}catch(e){console.error("Error fetching IP whitelist:",e)}},I=async()=>{try{const e=await fetch(`${s}/security/2fa/enable/`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"}}),t=await e.json();e.ok?(N(t.qr_code||""),f(t.backup_codes||[]),a.info("â„¹ï¸ QR kodu tarayÄ±n ve doÄŸrulama kodunu girin")):a.error(`âŒ ${t.error||"2FA etkinleÅŸtirilemedi"}`)}catch(e){console.error("Error enabling 2FA:",e),a.error("âŒ 2FA etkinleÅŸtirme hatasÄ±")}},B=async()=>{try{const e=await fetch(`${s}/security/2fa/verify-setup/`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"},body:JSON.stringify({code:w})}),t=await e.json();e.ok?(a.success("âœ… 2FA baÅŸarÄ±yla etkinleÅŸtirildi!"),l(!0),N(""),A(""),h()):a.error(`âŒ ${t.error||"GeÃ§ersiz kod"}`)}catch(e){console.error("Error verifying 2FA:",e),a.error("âŒ DoÄŸrulama hatasÄ±")}},j=async()=>{if(await S("2FA'yÄ± devre dÄ±ÅŸÄ± bÄ±rakmak istediÄŸinizden emin misiniz?"))try{const e=await fetch(`${s}/security/2fa/disable/`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"}}),t=await e.json();e.ok?(a.info("â„¹ï¸ 2FA devre dÄ±ÅŸÄ± bÄ±rakÄ±ldÄ±"),l(!1),h()):a.error(`âŒ ${t.error||"2FA devre dÄ±ÅŸÄ± bÄ±rakÄ±lamadÄ±"}`)}catch(e){console.error("Error disabling 2FA:",e),a.error("âŒ 2FA devre dÄ±ÅŸÄ± bÄ±rakma hatasÄ±")}},O=async()=>{try{const e=await fetch(`${s}/security/2fa/backup-codes/`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"}}),t=await e.json();e.ok?(f(t.backup_codes||[]),a.success("âœ… Yedek kodlar oluÅŸturuldu")):a.error(`âŒ ${t.error||"Yedek kodlar oluÅŸturulamadÄ±"}`)}catch(e){console.error("Error getting backup codes:",e),a.error("âŒ Yedek kod hatasÄ±")}},_=async e=>{try{const t=await fetch(`${s}/security/sessions/${e}/revoke/`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"}}),i=await t.json();t.ok?(a.success("âœ… Oturum sonlandÄ±rÄ±ldÄ±"),k()):a.error(`âŒ ${i.error||"Oturum sonlandÄ±rÄ±lamadÄ±"}`)}catch(t){console.error("Error revoking session:",t),a.error("âŒ Oturum sonlandÄ±rma hatasÄ±")}},D=async()=>{if(await S("TÃ¼m oturumlarÄ± sonlandÄ±rmak istediÄŸinizden emin misiniz?"))try{const e=await fetch(`${s}/security/sessions/revoke-all/`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"}}),t=await e.json();e.ok?(a.success("âœ… TÃ¼m oturumlar sonlandÄ±rÄ±ldÄ±"),k()):a.error(`âŒ ${t.error||"Oturumlar sonlandÄ±rÄ±lamadÄ±"}`)}catch(e){console.error("Error revoking all sessions:",e),a.error("âŒ Toplu sonlandÄ±rma hatasÄ±")}},L=async()=>{if(!u.trim()){a.error("âŒ IP adresi gerekli");return}try{const e=await fetch(`${s}/security/ip-whitelist/add/`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"},body:JSON.stringify({ip_address:u})}),t=await e.json();e.ok?(a.success("âœ… IP beyaz listeye eklendi"),g(""),E()):a.error(`âŒ ${t.error||"IP eklenemedi"}`)}catch(e){console.error("Error adding IP:",e),a.error("âŒ IP ekleme hatasÄ±")}},x=async e=>{try{(await fetch(`${s}/security/ip-whitelist/${e}/`,{method:"DELETE",headers:{Authorization:`Bearer ${r}`}})).ok?(a.success("âœ… IP beyaz listeden kaldÄ±rÄ±ldÄ±"),E()):a.error("âŒ IP kaldÄ±rÄ±lamadÄ±")}catch(t){console.error("Error removing IP:",t),a.error("âŒ IP kaldÄ±rma hatasÄ±")}},K=()=>{const e=d.join(`
`),t=new Blob([e],{type:"text/plain"}),i=window.URL.createObjectURL(t),y=document.createElement("a");y.href=i,y.download=`pawscord_backup_codes_${new Date().toISOString()}.txt`,y.click(),window.URL.revokeObjectURL(i),a.success("âœ… Yedek kodlar indirildi")};return React.createElement("div",{className:"security-overlay",onClick:R},React.createElement("div",{className:"security-panel",onClick:e=>e.stopPropagation()},React.createElement("div",{className:"security-header"},React.createElement("h2",null,"ğŸ”’ GÃ¼venlik AyarlarÄ±"),React.createElement("button",{className:"close-btn",onClick:R},"âœ•")),F&&React.createElement("div",{className:"security-status"},React.createElement("div",{className:"status-item"},React.createElement("span",{className:"status-icon"},"ğŸ”"),React.createElement("span",{className:"status-label"},"2FA:"),React.createElement("span",{className:`status-value ${o?"active":"inactive"}`},o?"Aktif":"Pasif")),React.createElement("div",{className:"status-item"},React.createElement("span",{className:"status-icon"},"ğŸ’»"),React.createElement("span",{className:"status-label"},"Aktif Oturumlar:"),React.createElement("span",{className:"status-value"},v.length)),React.createElement("div",{className:"status-item"},React.createElement("span",{className:"status-icon"},"ğŸŒ"),React.createElement("span",{className:"status-label"},"IP Whitelist:"),React.createElement("span",{className:"status-value"},b.length))),React.createElement("div",{className:"security-tabs"},React.createElement("button",{className:`tab-btn ${n==="2fa"?"active":""}`,onClick:()=>p("2fa")},"ğŸ” 2FA"),React.createElement("button",{className:`tab-btn ${n==="sessions"?"active":""}`,onClick:()=>p("sessions")},"ğŸ’» Oturumlar"),React.createElement("button",{className:`tab-btn ${n==="ip"?"active":""}`,onClick:()=>p("ip")},"ğŸŒ IP Whitelist")),React.createElement("div",{className:"security-content"},n==="2fa"&&React.createElement("div",{className:"tab-content"},React.createElement("h3",null,"Ä°ki FaktÃ¶rlÃ¼ Kimlik DoÄŸrulama (2FA)"),React.createElement("p",null,"HesabÄ±nÄ±zÄ± ekstra bir gÃ¼venlik katmanÄ±yla koruyun"),!o&&!m?React.createElement("div",{className:"enable-2fa"},React.createElement("button",{className:"enable-btn",onClick:I},"2FA'yÄ± EtkinleÅŸtir")):o?React.createElement("div",{className:"enabled-2fa"},React.createElement("div",{className:"success-message"},React.createElement("span",{className:"success-icon"},"âœ…"),React.createElement("span",null,"2FA aktif - HesabÄ±nÄ±z korunuyor")),React.createElement("button",{className:"disable-btn",onClick:j},"2FA'yÄ± Devre DÄ±ÅŸÄ± BÄ±rak"),React.createElement("button",{className:"backup-btn",onClick:O},"Yeni Yedek Kodlar OluÅŸtur")):React.createElement("div",{className:"setup-2fa"},React.createElement("div",{className:"qr-section"},React.createElement("h4",null,"1. QR Kodu TarayÄ±n"),m&&React.createElement("img",{src:m,alt:"2FA QR Code",className:"qr-code"}),React.createElement("p",null,"Authenticator uygulamanÄ±zla QR kodu tarayÄ±n")),React.createElement("div",{className:"verify-section"},React.createElement("h4",null,"2. DoÄŸrulama Kodunu Girin"),React.createElement("input",{type:"text",placeholder:"6 haneli kod",value:w,onChange:e=>A(e.target.value),maxLength:6,className:"verification-input"}),React.createElement("button",{className:"verify-btn",onClick:B},"DoÄŸrula ve EtkinleÅŸtir")),d.length>0&&React.createElement("div",{className:"backup-codes"},React.createElement("h4",null,"3. Yedek KodlarÄ±nÄ±z"),React.createElement("p",null,"Bu kodlarÄ± gÃ¼venli bir yerde saklayÄ±n!"),React.createElement("div",{className:"codes-grid"},d.map((e,t)=>React.createElement("div",{key:t,className:"backup-code"},e))),React.createElement("button",{className:"download-btn",onClick:K},"ğŸ“¥ KodlarÄ± Ä°ndir")))),n==="sessions"&&React.createElement("div",{className:"tab-content"},React.createElement("div",{className:"sessions-header"},React.createElement("h3",null,"Aktif Oturumlar"),React.createElement("button",{className:"revoke-all-btn",onClick:D},"TÃ¼mÃ¼nÃ¼ SonlandÄ±r")),React.createElement("div",{className:"sessions-list"},v.map(e=>React.createElement("div",{key:e.id,className:"session-card"},React.createElement("div",{className:"session-info"},React.createElement("div",{className:"session-device"},React.createElement("span",{className:"device-icon"},e.device_type==="mobile"?"ğŸ“±":"ğŸ’»"),React.createElement("div",{className:"device-details"},React.createElement("span",{className:"device-name"},e.device_name||"Bilinmeyen Cihaz"),React.createElement("span",{className:"device-location"},e.location||"Bilinmeyen Konum"))),React.createElement("div",{className:"session-meta"},React.createElement("span",{className:"session-ip"},"IP: ",e.ip_address),React.createElement("span",{className:"session-time"},"Son Aktivite: ",new Date(e.last_activity).toLocaleString("tr-TR")))),e.is_current?React.createElement("span",{className:"current-badge"},"Mevcut Oturum"):React.createElement("button",{className:"revoke-btn",onClick:()=>_(e.id)},"SonlandÄ±r"))))),n==="ip"&&React.createElement("div",{className:"tab-content"},React.createElement("h3",null,"IP Adresi Beyaz Listesi"),React.createElement("p",null,"Sadece izin verilen IP adreslerinden giriÅŸ yapÄ±n"),React.createElement("div",{className:"add-ip"},React.createElement("input",{type:"text",placeholder:"IP Adresi (Ã¶rn: 192.168.1.1)",value:u,onChange:e=>g(e.target.value),className:"ip-input"}),React.createElement("button",{className:"add-btn",onClick:L},"+ Ekle")),React.createElement("div",{className:"ip-list"},b.map(e=>React.createElement("div",{key:e.id,className:"ip-card"},React.createElement("div",{className:"ip-info"},React.createElement("span",{className:"ip-address"},e.ip_address),React.createElement("span",{className:"ip-added"},"Eklendi: ",new Date(e.created_at).toLocaleDateString("tr-TR"))),React.createElement("button",{className:"remove-btn",onClick:()=>x(e.id)},"KaldÄ±r"))))))))};export{q as default};
