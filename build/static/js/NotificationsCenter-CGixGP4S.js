var G=Object.defineProperty;var t=(i,f)=>G(i,"name",{value:f,configurable:!0});import{r as n,j as e}from"./react-core-Djgtqrmb.js";import{k as N,az as K,a as P,cF as Q,_ as X,V as Z,l as I,a9 as ee}from"./icons-vendor-BMXAt4pj.js";import{g as l,d as se}from"./index-D0nbcjO7.js";import"./media-vendor-CxFPycob.js";import"./router-vendor-gmJ9Mn-1.js";import"./state-vendor-CbW2fAN9.js";import"./crypto-vendor-D1XRGppi.js";import"./ui-vendor-IhB9Znpc.js";const me=t(({userId:i,onClose:f})=>{const[r,h]=n.useState([]),[x,j]=n.useState(0),[d,u]=n.useState("all"),[te,O]=n.useState(null),[p,v]=n.useState(!1),[D,R]=n.useState(!0),[b,y]=n.useState(!0),[k,S]=n.useState(!0),[w,$]=n.useState(!1),[C,E]=n.useState(!1),[_,A]=n.useState(!0);n.useEffect(()=>{B(),L()},[i,d]);const c=t(async(s,a={})=>{const T=localStorage.getItem("access_token"),o=await fetch(s,{...a,headers:{Authorization:`Bearer ${T}`,"Content-Type":"application/json",...a.headers}});if(!o.ok)throw new Error(`HTTP ${o.status}`);return await o.json()},"fetchWithAuth"),B=t(async()=>{try{const s=await c(`${l()}/notifications/${i}/list/?filter=${d}`);h(s.notifications||[]),j(s.unread_count||0)}catch{}finally{R(!1)}},"fetchNotifications"),L=t(async()=>{try{const s=await c(`${l()}/notifications/${i}/settings/`);O(s),y(s.push_enabled),S(s.email_enabled),$(s.mentions_only),E(s.dnd_enabled),A(s.sound_enabled)}catch{}},"fetchSettings"),z=t(async s=>{try{await c(`${l()}/notifications/${i}/${s}/read/`,{method:"POST"}),h(r.map(a=>a.id===s?{...a,read:!0}:a)),j(Math.max(0,x-1))}catch{}},"markAsRead"),U=t(async()=>{try{await c(`${l()}/notifications/${i}/read-all/`,{method:"POST"}),h(r.map(s=>({...s,read:!0}))),j(0),m("All notifications marked as read!")}catch{}},"markAllAsRead"),J=t(async s=>{try{await c(`${l()}/notifications/${i}/${s}/delete/`,{method:"DELETE"}),h(r.filter(a=>a.id!==s)),m("Notification deleted!")}catch{}},"deleteNotification"),H=t(async()=>{if(await se("Are you sure you want to clear all notifications?"))try{await c(`${l()}/notifications/${i}/clear/`,{method:"POST"}),h([]),j(0),m("All notifications cleared!")}catch{}},"clearAll"),V=t(async()=>{try{await c(`${l()}/notifications/${i}/settings/update/`,{method:"PUT",body:JSON.stringify({push_enabled:b,email_enabled:k,mentions_only:w,dnd_enabled:C,sound_enabled:_})}),m("Settings updated!"),v(!1)}catch{}},"updateSettings"),W=t(async()=>{try{await c(`${l()}/notifications/${i}/test/`,{method:"POST"}),m("Test notification sent!")}catch{}},"testNotification"),Y=t(s=>{switch(s){case"mention":return"ðŸ’¬";case"reply":return"â†©ï¸";case"like":return"â¤ï¸";case"follow":return"ðŸ‘¤";case"server_invite":return"ðŸ“§";case"role_update":return"ðŸ·ï¸";case"announcement":return"ðŸ“¢";default:return"ðŸ””"}},"getNotificationIcon"),q=t(s=>{const a=new Date(s),o=new Date-a,g=Math.floor(o/6e4),F=Math.floor(o/36e5),M=Math.floor(o/864e5);return g<1?"Just now":g<60?`${g}m ago`:F<24?`${F}h ago`:M<7?`${M}d ago`:a.toLocaleDateString()},"formatTimestamp"),m=t((s,a="success")=>{},"showToast");return D?e.jsx("div",{className:"notifications-overlay",children:e.jsxs("div",{className:"notifications-panel loading",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{children:"Loading Notifications..."})]})}):e.jsx("div",{className:"notifications-overlay",children:e.jsxs("div",{className:"notifications-panel",children:[e.jsxs("div",{className:"panel-header",children:[e.jsxs("div",{children:[e.jsxs("h2",{children:[e.jsx(N,{})," Notifications"]}),x>0&&e.jsxs("span",{className:"unread-badge",children:[x," new"]})]}),e.jsxs("div",{className:"header-actions",children:[e.jsx("button",{onClick:t(()=>v(!p),"onClick"),className:"btn-settings",children:e.jsx(K,{})}),e.jsx("button",{onClick:f,className:"btn-close",children:e.jsx(P,{})})]})]}),e.jsxs("div",{className:"filter-bar",children:[e.jsx("button",{className:d==="all"?"active":"",onClick:t(()=>u("all"),"onClick"),children:"All"}),e.jsx("button",{className:d==="unread"?"active":"",onClick:t(()=>u("unread"),"onClick"),children:"Unread"}),e.jsx("button",{className:d==="mentions"?"active":"",onClick:t(()=>u("mentions"),"onClick"),children:"Mentions"}),e.jsx("button",{className:d==="servers"?"active":"",onClick:t(()=>u("servers"),"onClick"),children:"Servers"})]}),p&&e.jsxs("div",{className:"settings-panel",children:[e.jsx("h3",{children:"Notification Settings"}),e.jsxs("div",{className:"setting-item",children:[e.jsxs("div",{className:"setting-info",children:[e.jsx(Q,{}),e.jsxs("div",{children:[e.jsx("h4",{children:"Push Notifications"}),e.jsx("p",{children:"Receive notifications on your device"})]})]}),e.jsxs("label",{className:"toggle",children:[e.jsx("input",{type:"checkbox",checked:b,onChange:t(s=>y(s.target.checked),"onChange")}),e.jsx("span",{className:"toggle-slider"})]})]}),e.jsxs("div",{className:"setting-item",children:[e.jsxs("div",{className:"setting-info",children:[e.jsx(X,{}),e.jsxs("div",{children:[e.jsx("h4",{children:"Email Notifications"}),e.jsx("p",{children:"Receive notifications via email"})]})]}),e.jsxs("label",{className:"toggle",children:[e.jsx("input",{type:"checkbox",checked:k,onChange:t(s=>S(s.target.checked),"onChange")}),e.jsx("span",{className:"toggle-slider"})]})]}),e.jsxs("div",{className:"setting-item",children:[e.jsxs("div",{className:"setting-info",children:[e.jsx(N,{}),e.jsxs("div",{children:[e.jsx("h4",{children:"Sound Effects"}),e.jsx("p",{children:"Play sound when you receive notifications"})]})]}),e.jsxs("label",{className:"toggle",children:[e.jsx("input",{type:"checkbox",checked:_,onChange:t(s=>A(s.target.checked),"onChange")}),e.jsx("span",{className:"toggle-slider"})]})]}),e.jsxs("div",{className:"setting-item",children:[e.jsxs("div",{className:"setting-info",children:[e.jsx(Z,{}),e.jsxs("div",{children:[e.jsx("h4",{children:"Mentions Only"}),e.jsx("p",{children:"Only notify when you're mentioned"})]})]}),e.jsxs("label",{className:"toggle",children:[e.jsx("input",{type:"checkbox",checked:w,onChange:t(s=>$(s.target.checked),"onChange")}),e.jsx("span",{className:"toggle-slider"})]})]}),e.jsxs("div",{className:"setting-item",children:[e.jsxs("div",{className:"setting-info",children:[e.jsx(I,{}),e.jsxs("div",{children:[e.jsx("h4",{children:"Do Not Disturb"}),e.jsx("p",{children:"Mute all notifications temporarily"})]})]}),e.jsxs("label",{className:"toggle",children:[e.jsx("input",{type:"checkbox",checked:C,onChange:t(s=>E(s.target.checked),"onChange")}),e.jsx("span",{className:"toggle-slider"})]})]}),e.jsxs("div",{className:"settings-actions",children:[e.jsx("button",{onClick:W,className:"btn-test",children:"Test Notification"}),e.jsx("button",{onClick:V,className:"btn-save",children:"Save Settings"})]})]}),e.jsxs("div",{className:"panel-actions",children:[x>0&&e.jsxs("button",{onClick:U,className:"btn-mark-read",children:[e.jsx(ee,{})," Mark All as Read"]}),r.length>0&&e.jsx("button",{onClick:H,className:"btn-clear",children:"Clear All"})]}),e.jsx("div",{className:"notifications-content",children:r.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx(N,{size:64}),e.jsx("h3",{children:"No Notifications"}),e.jsx("p",{children:"You're all caught up!"})]}):e.jsx("div",{className:"notifications-list",children:r.map(s=>e.jsxs("div",{className:`notification-item ${s.read?"":"unread"}`,onClick:t(()=>!s.read&&z(s.id),"onClick"),children:[e.jsx("div",{className:"notification-icon",children:Y(s.type)}),e.jsxs("div",{className:"notification-body",children:[e.jsxs("div",{className:"notification-header",children:[e.jsx("h4",{children:s.title}),e.jsx("span",{className:"notification-time",children:q(s.created_at)})]}),e.jsx("p",{className:"notification-message",children:s.message}),s.server_name&&e.jsxs("span",{className:"notification-server",children:["in ",s.server_name]})]}),e.jsx("button",{onClick:t(a=>{a.stopPropagation(),J(s.id)},"onClick"),className:"btn-delete-notification",children:e.jsx(P,{})}),!s.read&&e.jsx("div",{className:"unread-dot"})]},s.id))})})]})})},"NotificationsCenter");export{me as default};
