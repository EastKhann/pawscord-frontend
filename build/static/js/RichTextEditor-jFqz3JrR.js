import{r as s,n as t,x as R,E as I}from"./react-core-BMiyQWF6.js";import{i as M,a as F}from"./editor-vendor-D9c4a6XZ.js";import{af as k,ag as y,ah as W,ai as C,aj as z,p as v,r as E,ak as A}from"./icons-vendor-GUGjkvMm.js";const T=[{name:"zar-at",description:"1-100 arası zar at",icon:t.jsx(y,{})},{name:"yazitura",description:"Yazı tura at",icon:t.jsx(W,{})},{name:"tkm",description:"Taş Kağıt Makas oyna (@kullanici)",icon:t.jsx(C,{})},{name:"xox",description:"XOX oyunu başlat",icon:t.jsx(y,{})},{name:"sec",description:"Seçeneklerden birini seç (/sec a b c)",icon:t.jsx(k,{})},{name:"cuzdan",description:"Coin bakiyeni gör",icon:t.jsx(z,{})},{name:"transfer",description:"Coin gönder (/transfer @kullanici miktar)",icon:t.jsx(z,{})},{name:"kanban",description:"Kanban panosunu aç",icon:t.jsx(y,{})},{name:"kod",description:"Python kodu çalıştır",icon:t.jsx(v,{})},{name:"resimgelismis",description:"AI ile resim çiz",icon:t.jsx(C,{})},{name:"temizle",description:"Mesajları sil (Admin)",icon:t.jsx(E,{}),adminOnly:!0},{name:"yardim",description:"Komut listesini gör",icon:t.jsx(k,{})},{name:"tema",description:"Tema Mağazasını Aç",icon:t.jsx(y,{})},{name:"duyuru",description:"Sabit Duyuru Yap (/duyuru mesaj)",icon:t.jsx(E,{}),adminOnly:!0},{name:"sablon",description:"Hazır Şablonlar",icon:t.jsx(A,{})},{name:"shrug",description:"¯\\_(ツ)_/¯ gönder",icon:t.jsx(C,{})}],L=({query:l,onSelect:u,activeIndex:h})=>{const[c,g]=s.useState([]);return s.useEffect(()=>{if(l==null)return;const a=l.toLowerCase().replace("/",""),i=T.filter(d=>d.name.toLowerCase().startsWith(a));g(i)},[l]),c.length===0?null:t.jsxs("div",{style:x.container,children:[t.jsxs("div",{style:x.header,children:[t.jsx(k,{style:{marginRight:6}}),"KOMUTLAR"]}),t.jsx("div",{style:x.list,children:c.map((a,i)=>t.jsxs("div",{onClick:()=>u(a),style:{...x.item,backgroundColor:i===h?"#5865f2":"transparent"},children:[t.jsx("div",{style:x.iconWrapper,children:a.icon}),t.jsxs("div",{style:x.textWrapper,children:[t.jsxs("span",{style:{fontWeight:"bold",color:"white"},children:["/",a.name]}),t.jsx("span",{style:{fontSize:"0.85em",color:i===h?"#eee":"#b9bbbe",marginLeft:8},children:a.description})]})]},a.name))})]})},x={container:{position:"absolute",bottom:"100%",left:0,width:"300px",maxHeight:"300px",backgroundColor:"#2f3136",borderRadius:"8px",boxShadow:"0 -4px 15px rgba(0,0,0,0.4)",display:"flex",flexDirection:"column",marginBottom:"10px",overflow:"hidden",zIndex:1e3,border:"1px solid rgba(255,255,255,0.05)"},header:{padding:"8px 12px",fontSize:"0.75em",fontWeight:"bold",color:"#b9bbbe",backgroundColor:"#202225",borderBottom:"1px solid rgba(255,255,255,0.05)",display:"flex",alignItems:"center",letterSpacing:"0.5px"},list:{overflowY:"auto",padding:"0"},item:{display:"flex",alignItems:"center",padding:"10px 12px",cursor:"pointer",transition:"background-color 0.1s"},iconWrapper:{display:"flex",alignItems:"center",justifyContent:"center",width:"24px",height:"24px",marginRight:"10px",color:"white",fontSize:"1.1em"},textWrapper:{display:"flex",alignItems:"center",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}},K=s.forwardRef(({onSend:l,onChange:u,placeholder:h,initialValue:c="",onFileUpload:g},a)=>{const i=s.useRef(!1),[d,p]=s.useState(null),[w,j]=s.useState(0),e=R({extensions:[M,F.configure({placeholder:h||"Bir mesaj yaz..."})],content:c,editorProps:{handlePaste:(r,n,o)=>{const m=n.clipboardData?.items;if(m&&g)for(let f=0;f<m.length;f++){const b=m[f];if(b.kind==="file"){n.preventDefault();const S=b.getAsFile();return S&&g(S),!0}}return!1},handleKeyDown:(r,n)=>{if(d!==null){if(n.key==="ArrowUp")return n.preventDefault(),j(o=>Math.max(0,o-1)),!0;if(n.key==="ArrowDown")return n.preventDefault(),j(o=>o+1),!0;if(n.key==="Enter"){n.preventDefault();const o=d.toLowerCase().replace("/",""),m=T.filter(f=>f.name.toLowerCase().startsWith(o));if(m.length>0){const f=Math.max(0,Math.min(w,m.length-1)),b=m[f];e.commands.setContent(`/${b.name} `),e.commands.focus("end"),p(null)}return!0}if(n.key==="Escape")return n.preventDefault(),p(null),!0}if(n.key==="Enter"&&!n.shiftKey){if(n.preventDefault(),d!==null)return!0;const o=r.state.doc.textContent;return o.trim().length>0&&(i.current=!0,l(o),e.commands.clearContent(),u?.(""),setTimeout(()=>{i.current=!1},100)),!0}return!1}}});s.useEffect(()=>{if(!e)return;const r=()=>{if(i.current)return;const n=e.getText().trim();n.startsWith("/")?n.includes(" ")?p(null):(p(n),j(0)):d!==null&&p(null),u?.(n)};return e.on("update",r),()=>e.off("update",r)},[e,u]),s.useEffect(()=>{if(!e)return;const r=e.getText();c===""&&r!==""?e.commands.clearContent():c!==""&&r===""&&e.commands.setContent(c)},[e,c]);const D=s.useCallback(()=>{e&&e.chain().focus().run()},[e]);return s.useImperativeHandle(a,()=>({send:()=>{if(!e)return;const r=e.getText().trim();r&&(i.current=!0,l(r),e.commands.clearContent(),u?.(""),setTimeout(()=>{i.current=!1},100))},clear:()=>e?.commands.clearContent(),hasContent:()=>!!e?.getText().trim(),appendText:r=>{!e||!r||e.chain().focus().insertContent(r).run()}}),[e,l,u]),e?t.jsxs("div",{className:"rich-editor-wrapper",onClick:D,role:"textbox","aria-label":"Mesaj editörü",children:[t.jsx(I,{editor:e,className:"tiptap-editor"}),d!==null&&t.jsx(L,{query:d,activeIndex:w,onSelect:r=>{e&&(e.commands.setContent(`/${r.name} `),e.commands.focus("end"),p(null))}})]}):null});K.displayName="RichTextEditor";export{K as default};
