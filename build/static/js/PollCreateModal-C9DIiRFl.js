import{r as l,n as e}from"./react-core-BMiyQWF6.js";import{a as O,s as I,ac as z}from"./icons-vendor-T72gfvdf.js";import"./editor-vendor-D9c4a6XZ.js";const D=({onClose:i,fetchWithAuth:b,apiBaseUrl:f,activeRoomSlug:y})=>{const[a,j]=l.useState(""),[r,d]=l.useState(["",""]),[x,m]=l.useState(!1),[p,k]=l.useState("3600"),[c,g]=l.useState(!1),[h,s]=l.useState(null),v=(t,o)=>{const n=[...r];n[t]=o,d(n)},C=()=>{r.length<10&&d([...r,""])},S=t=>{if(r.length>2){const o=r.filter((n,u)=>u!==t);d(o)}},w=async t=>{if(t.preventDefault(),s(null),!a.trim()){s("Soru boş olamaz.");return}const o=r.filter(n=>n.trim()!=="");if(o.length<2){s("En az 2 seçenek girmelisiniz.");return}g(!0);try{const n=await b(`${f}/polls/create/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({room_slug:y,question:a,options:o,allow_multiple:x,expires_in:p?parseInt(p):null})});if(n.ok)i();else{const u=await n.json();s(u.error||"Anket oluşturulamadı.")}}catch(n){s("Bir hata oluştu: "+n.message)}finally{g(!1)}};return e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:e.jsxs("div",{style:{backgroundColor:"#36393f",padding:"20px",borderRadius:"8px",width:"400px",maxWidth:"90%",color:"white",display:"flex",flexDirection:"column",gap:"15px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h3",{style:{margin:0},children:"Anket Oluştur"}),e.jsx("button",{onClick:i,style:{background:"none",border:"none",color:"#b9bbbe",cursor:"pointer"},children:e.jsx(O,{})})]}),h&&e.jsx("div",{style:{color:"#ed4245",fontSize:"14px"},children:h}),e.jsx("input",{type:"text",placeholder:"Soru ne?",value:a,onChange:t=>j(t.target.value),style:{padding:"10px",borderRadius:"4px",border:"none",backgroundColor:"#202225",color:"white"}}),e.jsx("div",{style:{maxHeight:"200px",overflowY:"auto",display:"flex",flexDirection:"column",gap:"8px"},children:r.map((t,o)=>e.jsxs("div",{style:{display:"flex",gap:"5px"},children:[e.jsx("input",{type:"text",placeholder:`Seçenek ${o+1}`,value:t,onChange:n=>v(o,n.target.value),style:{flex:1,padding:"8px",borderRadius:"4px",border:"none",backgroundColor:"#202225",color:"white"}}),r.length>2&&e.jsx("button",{onClick:()=>S(o),style:{background:"none",border:"none",color:"#ed4245",cursor:"pointer"},children:e.jsx(I,{})})]},o))}),r.length<10&&e.jsxs("button",{onClick:C,style:{display:"flex",alignItems:"center",gap:"5px",background:"none",border:"none",color:"#3ba55d",cursor:"pointer",alignSelf:"flex-start"},children:[e.jsx(z,{})," Seçenek Ekle"]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"10px",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:x,onChange:t=>m(t.target.checked)}),"Birden çok seçime izin ver"]}),e.jsxs("select",{value:p,onChange:t=>k(t.target.value),style:{padding:"8px",borderRadius:"4px",backgroundColor:"#202225",color:"white",border:"none"},children:[e.jsx("option",{value:"3600",children:"1 Saat"}),e.jsx("option",{value:"86400",children:"24 Saat"}),e.jsx("option",{value:"604800",children:"1 Hafta"}),e.jsx("option",{value:"",children:"Süresiz"})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"10px"},children:[e.jsx("button",{onClick:i,style:{padding:"10px 20px",borderRadius:"4px",border:"none",backgroundColor:"transparent",color:"white",cursor:"pointer"},children:"İptal"}),e.jsx("button",{onClick:w,disabled:c,style:{padding:"10px 20px",borderRadius:"4px",border:"none",backgroundColor:"#5865f2",color:"white",cursor:"pointer",opacity:c?.7:1},children:c?"Oluşturuluyor...":"Oluştur"})]})]})})};export{D as default};
