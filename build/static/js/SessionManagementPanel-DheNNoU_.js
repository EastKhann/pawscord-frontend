import{r as c,d as e,cq as p,i as v,cr as b,U as E,E as S,bt as h,bs as k}from"./react-core-DrOm_csO.js";import{t as n}from"./index-DmEhdEtw.js";const w=({fetchWithAuth:i,apiBaseUrl:a,onClose:f})=>{const[s,m]=c.useState([]),[x,d]=c.useState(!1);c.useEffect(()=>{l()},[]);const l=async()=>{d(!0);try{const r=await(await i(`${a}/sessions/list/`)).json();m(r.sessions||[])}catch{n.error("Failed to load sessions")}finally{d(!1)}},u=async o=>{if(confirm("Are you sure you want to sign out this device?"))try{await i(`${a}/sessions/revoke/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_id:o})}),n.success("Session revoked successfully"),l()}catch{n.error("Failed to revoke session")}},y=async()=>{if(confirm("This will sign you out from ALL devices except this one. Continue?"))try{await i(`${a}/security/sessions/revoke-all/`,{method:"POST"}),n.success("All other sessions revoked"),l()}catch{n.error("Failed to revoke sessions")}},g=o=>{switch(o){case"mobile":return e.createElement(k,{style:{fontSize:"24px",color:"#5865f2"}});case"tablet":return e.createElement(h,{style:{fontSize:"24px",color:"#5865f2"}});default:return e.createElement(p,{style:{fontSize:"24px",color:"#5865f2"}})}};return e.createElement("div",{style:t.overlay},e.createElement("div",{style:t.modal},e.createElement("div",{style:t.header},e.createElement("div",{style:t.headerLeft},e.createElement(p,{style:{marginRight:"10px",color:"#5865f2"}}),e.createElement("h2",{style:t.title},"Active Sessions")),e.createElement("button",{onClick:f,style:t.closeButton},e.createElement(v,null))),e.createElement("div",{style:t.toolbar},e.createElement("div",{style:t.sessionCount},s.length," active ",s.length===1?"session":"sessions"),e.createElement("button",{onClick:y,style:t.revokeAllButton},"Sign Out All Other Devices")),e.createElement("div",{style:t.content},x?e.createElement("div",{style:t.loading},"Loading sessions..."):s.length===0?e.createElement("div",{style:t.empty},"No active sessions found"):e.createElement("div",{style:t.sessionsList},s.map((o,r)=>e.createElement("div",{key:r,style:{...t.sessionCard,...o.is_current&&t.currentSession}},e.createElement("div",{style:t.sessionIcon},g(o.device_type)),e.createElement("div",{style:t.sessionInfo},e.createElement("div",{style:t.sessionDevice},o.device_name||"Unknown Device",o.is_current&&e.createElement("span",{style:t.currentBadge},"Current Session")),e.createElement("div",{style:t.sessionDetails},e.createElement("div",{style:t.detailItem},e.createElement(b,{style:{marginRight:"5px",fontSize:"12px"}}),o.location||"Unknown Location"),e.createElement("div",{style:t.detailItem},e.createElement(E,{style:{marginRight:"5px",fontSize:"12px"}}),"Last active: ",new Date(o.last_activity).toLocaleString()),o.ip_address&&e.createElement("div",{style:t.detailItem},"IP: ",o.ip_address))),!o.is_current&&e.createElement("button",{onClick:()=>u(o.id),style:t.revokeButton,title:"Sign Out"},e.createElement(S,null))))))))},t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999},modal:{backgroundColor:"#1e1e1e",borderRadius:"8px",width:"90%",maxWidth:"700px",maxHeight:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #2c2f33"},headerLeft:{display:"flex",alignItems:"center"},title:{margin:0,fontSize:"20px",color:"#ffffff"},closeButton:{background:"none",border:"none",color:"#99aab5",cursor:"pointer",fontSize:"20px",padding:"5px"},toolbar:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"15px 20px",borderBottom:"1px solid #2c2f33"},sessionCount:{fontSize:"14px",color:"#dcddde"},revokeAllButton:{padding:"8px 16px",backgroundColor:"#f04747",border:"none",borderRadius:"4px",color:"#ffffff",cursor:"pointer",fontSize:"13px",fontWeight:"500"},content:{padding:"20px",overflowY:"auto",flex:1},loading:{textAlign:"center",color:"#99aab5",padding:"40px"},empty:{textAlign:"center",color:"#99aab5",padding:"40px"},sessionsList:{display:"flex",flexDirection:"column",gap:"16px"},sessionCard:{backgroundColor:"#2c2f33",borderRadius:"8px",padding:"16px",display:"flex",gap:"16px",alignItems:"flex-start"},currentSession:{border:"2px solid #43b581"},sessionIcon:{minWidth:"40px",display:"flex",alignItems:"center",justifyContent:"center"},sessionInfo:{flex:1},sessionDevice:{fontSize:"16px",fontWeight:"600",color:"#ffffff",marginBottom:"8px",display:"flex",alignItems:"center",gap:"12px"},currentBadge:{fontSize:"11px",padding:"4px 8px",backgroundColor:"#43b581",borderRadius:"4px",fontWeight:"600"},sessionDetails:{display:"flex",flexDirection:"column",gap:"4px"},detailItem:{fontSize:"13px",color:"#99aab5",display:"flex",alignItems:"center"},revokeButton:{background:"none",border:"none",color:"#f04747",cursor:"pointer",fontSize:"18px",padding:"8px"}};export{w as default};
