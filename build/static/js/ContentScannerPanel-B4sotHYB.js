import{r as u,ay as b,l as S,aT as F,V as E,b_ as v,ax as _,o as I}from"./react-core-B6hadH-M.js";import{t as l}from"./index-D_6pZib5.js";const j=({fetchWithAuth:c,apiBaseUrl:s,onClose:C,messageId:i})=>{const[r,m]=u.useState([]),[h,d]=u.useState(!1),[n,f]=u.useState("all");u.useEffect(()=>{i?x():y()},[i]);const x=async()=>{d(!0);try{const a=await(await c(`${s}/messages/${i}/scan_results/`)).json();m(a.results||[])}catch{l.error("Failed to load scan results")}finally{d(!1)}},y=async()=>{d(!0);try{const a=await(await c(`${s}/content_scanner/results/`)).json();m(a.results||[])}catch{l.error("Failed to load scan results")}finally{d(!1)}},k=async()=>{try{const a=await(await c(`${s}/content_scanner/export/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filter:n})})).blob(),p=window.URL.createObjectURL(a),o=document.createElement("a");o.href=p,o.download=`scan_results_${new Date().toISOString()}.csv`,document.body.appendChild(o),o.click(),o.remove(),l.success("Results exported successfully")}catch{l.error("Failed to export results")}},g=async(t,a)=>{try{await c(`${s}/content_scanner/results/${t}/review/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:a})}),l.success(`Content ${a}ed successfully`),i?x():y()}catch{l.error("Failed to review content")}},w=t=>{switch(t){case"safe":return React.createElement(E,{style:{color:"#43b581"}});case"flagged":return React.createElement(I,{style:{color:"#faa61a"}});case"blocked":return React.createElement(v,{style:{color:"#f04747"}});default:return React.createElement(b,null)}},B=t=>{switch(t){case"safe":return"#43b581";case"flagged":return"#faa61a";case"blocked":return"#f04747";default:return"#99aab5"}},R=r.filter(t=>n==="all"?!0:t.status===n);return React.createElement("div",{style:e.overlay},React.createElement("div",{style:e.modal},React.createElement("div",{style:e.header},React.createElement("div",{style:e.headerLeft},React.createElement(b,{style:{marginRight:"10px",color:"#5865f2"}}),React.createElement("h2",{style:e.title},"Content Scanner Results")),React.createElement("button",{onClick:C,style:e.closeButton},React.createElement(S,null))),React.createElement("div",{style:e.filters},React.createElement("button",{onClick:()=>f("all"),style:{...e.filterButton,...n==="all"&&e.filterButtonActive}},"All (",r.length,")"),React.createElement("button",{onClick:()=>f("safe"),style:{...e.filterButton,...n==="safe"&&e.filterButtonActive}},"âœ… Safe (",r.filter(t=>t.status==="safe").length,")"),React.createElement("button",{onClick:()=>f("flagged"),style:{...e.filterButton,...n==="flagged"&&e.filterButtonActive}},"âš ï¸ Flagged (",r.filter(t=>t.status==="flagged").length,")"),React.createElement("button",{onClick:()=>f("blocked"),style:{...e.filterButton,...n==="blocked"&&e.filterButtonActive}},"ðŸš« Blocked (",r.filter(t=>t.status==="blocked").length,")"),React.createElement("button",{onClick:k,style:e.exportButton},React.createElement(F,{style:{marginRight:"5px"}}),"Export")),React.createElement("div",{style:e.content},h?React.createElement("div",{style:e.loading},"Loading scan results..."):R.length===0?React.createElement("div",{style:e.empty},"No scan results found"):React.createElement("div",{style:e.resultsList},R.map((t,a)=>React.createElement("div",{key:a,style:e.resultCard},React.createElement("div",{style:e.resultHeader},React.createElement("div",{style:e.resultStatus},w(t.status),React.createElement("span",{style:{marginLeft:"8px",color:B(t.status),fontWeight:"600"}},t.status.toUpperCase())),React.createElement("div",{style:e.timestamp},new Date(t.scanned_at).toLocaleString())),React.createElement("div",{style:e.resultBody},React.createElement("div",{style:e.resultInfo},React.createElement("div",{style:e.infoRow},React.createElement("strong",null,"Type:")," ",t.content_type),t.confidence_score&&React.createElement("div",{style:e.infoRow},React.createElement("strong",null,"Confidence:"),React.createElement("div",{style:e.progressBar},React.createElement("div",{style:{...e.progressFill,width:`${t.confidence_score}%`,backgroundColor:t.confidence_score>80?"#f04747":t.confidence_score>50?"#faa61a":"#43b581"}})),React.createElement("span",null,t.confidence_score,"%")),t.flags&&t.flags.length>0&&React.createElement("div",{style:e.infoRow},React.createElement("strong",null,"Flags:"),React.createElement("div",{style:e.flags},t.flags.map((p,o)=>React.createElement("span",{key:o,style:e.flag},p)))),t.reason&&React.createElement("div",{style:e.infoRow},React.createElement("strong",null,"Reason:")," ",t.reason)),t.status==="flagged"&&React.createElement("div",{style:e.actions},React.createElement("button",{onClick:()=>g(t.id,"approve"),style:{...e.actionButton,...e.approveButton}},React.createElement(E,{style:{marginRight:"5px"}}),"Approve"),React.createElement("button",{onClick:()=>g(t.id,"block"),style:{...e.actionButton,...e.blockButton}},React.createElement(v,{style:{marginRight:"5px"}}),"Block"),React.createElement("button",{onClick:()=>g(t.id,"ignore"),style:{...e.actionButton,...e.ignoreButton}},React.createElement(_,{style:{marginRight:"5px"}}),"Ignore")))))))))},e={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999},modal:{backgroundColor:"#1e1e1e",borderRadius:"8px",width:"90%",maxWidth:"900px",maxHeight:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #2c2f33"},headerLeft:{display:"flex",alignItems:"center"},title:{margin:0,fontSize:"20px",color:"#ffffff"},closeButton:{background:"none",border:"none",color:"#99aab5",cursor:"pointer",fontSize:"20px",padding:"5px"},filters:{display:"flex",gap:"10px",padding:"15px 20px",borderBottom:"1px solid #2c2f33",flexWrap:"wrap"},filterButton:{padding:"8px 16px",backgroundColor:"#2c2f33",border:"none",borderRadius:"4px",color:"#ffffff",cursor:"pointer",fontSize:"14px",transition:"background-color 0.2s"},filterButtonActive:{backgroundColor:"#5865f2"},exportButton:{marginLeft:"auto",padding:"8px 16px",backgroundColor:"#43b581",border:"none",borderRadius:"4px",color:"#ffffff",cursor:"pointer",fontSize:"14px",display:"flex",alignItems:"center"},content:{padding:"20px",overflowY:"auto",flex:1},loading:{textAlign:"center",color:"#99aab5",padding:"40px"},empty:{textAlign:"center",color:"#99aab5",padding:"40px"},resultsList:{display:"flex",flexDirection:"column",gap:"15px"},resultCard:{backgroundColor:"#2c2f33",borderRadius:"6px",padding:"15px"},resultHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},resultStatus:{display:"flex",alignItems:"center",fontSize:"14px"},timestamp:{fontSize:"12px",color:"#99aab5"},resultBody:{display:"flex",flexDirection:"column",gap:"15px"},resultInfo:{display:"flex",flexDirection:"column",gap:"8px"},infoRow:{display:"flex",alignItems:"center",gap:"10px",fontSize:"14px",color:"#dcddde"},progressBar:{flex:1,height:"8px",backgroundColor:"#1e1e1e",borderRadius:"4px",overflow:"hidden"},progressFill:{height:"100%",transition:"width 0.3s"},flags:{display:"flex",flexWrap:"wrap",gap:"5px"},flag:{padding:"4px 8px",backgroundColor:"#f04747",borderRadius:"4px",fontSize:"12px",color:"#ffffff"},actions:{display:"flex",gap:"10px",justifyContent:"flex-end"},actionButton:{padding:"8px 16px",border:"none",borderRadius:"4px",color:"#ffffff",cursor:"pointer",fontSize:"14px",display:"flex",alignItems:"center"},approveButton:{backgroundColor:"#43b581"},blockButton:{backgroundColor:"#f04747"},ignoreButton:{backgroundColor:"#99aab5"}};export{j as default};
