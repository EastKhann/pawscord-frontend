import{r,j as e}from"./react-vendor-D8Fi5F9E.js";import{O as F,a as L,am as i,bz as y,aT as V,u as $}from"./icons-vendor-CKPm393i.js";import{t as a}from"./index-CczO-z4z.js";import"./media-vendor-Dp18sh1g.js";import"./router-vendor-CTPwQFnc.js";import"./crypto-vendor-Cz32ecGD.js";import"./state-vendor-De5qIGw3.js";const J=({fetchWithAuth:d,apiBaseUrl:p,onClose:j,username:N})=>{const[l,s]=r.useState("balance"),[x,w]=r.useState(0),[v,z]=r.useState([]),[P,B]=r.useState(!0),[c,I]=r.useState(100),[b,D]=r.useState("card"),[f,C]=r.useState(""),[m,S]=r.useState(""),[T,k]=r.useState("");r.useEffect(()=>{h(),g()},[]);const h=async()=>{try{const o=await(await d(`${p}/users/balance/`)).json();w(o.balance||0)}catch(n){console.error("Failed to load balance:",n),a.error("Failed to load balance")}finally{B(!1)}},g=async()=>{try{const o=await(await d(`${p}/payments/history/`)).json();z(o.transactions||[])}catch(n){console.error("Failed to load transactions:",n)}},A=async()=>{if(c<100){a.error("Minimum purchase is 100 coins");return}if(!b){a.error("Please select a payment method");return}try{const n=await d(`${p}/payments/coins/purchase/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:parseInt(c),payment_method:b,currency:"USD"})});if(!n.ok){const u=await n.json();throw new Error(u.error||"Payment failed")}const o=await n.json();o.success?(a.success(`Successfully purchased ${c} coins!`),h(),g(),s("balance")):a.error(o.error||"Payment failed")}catch(n){console.error("Payment error:",n),a.error(n.message||"Payment processing failed")}},R=async()=>{if(!f||!m){a.error("Please fill in all fields");return}const n=parseInt(m);if(n<=0||n>x){a.error("Invalid transfer amount");return}try{const u=await(await d(`${p}/api/coins/transfer/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({recipient:f,amount:n,note:T})})).json();u.success?(a.success(`Transferred ${n} coins to ${f}`),h(),g(),C(""),S(""),k(""),s("balance")):a.error(u.error||"Transfer failed")}catch(o){console.error("Transfer error:",o),a.error("Transfer failed")}},W=[{amount:100,price:.99,bonus:0},{amount:500,price:4.99,bonus:50},{amount:1e3,price:9.99,bonus:150},{amount:2500,price:19.99,bonus:500},{amount:5e3,price:39.99,bonus:1e3}];return e.jsx("div",{style:t.overlay,onClick:j,children:e.jsxs("div",{style:t.modal,onClick:n=>n.stopPropagation(),children:[e.jsxs("div",{style:t.header,children:[e.jsxs("div",{style:t.headerLeft,children:[e.jsx(F,{style:{fontSize:"24px",color:"#faa61a"}}),e.jsx("h2",{style:{margin:0,fontSize:"20px"},children:"Payment Center"})]}),e.jsx("button",{onClick:j,style:t.closeBtn,children:e.jsx(L,{})})]}),e.jsxs("div",{style:t.tabs,children:[e.jsxs("button",{onClick:()=>s("balance"),style:{...t.tab,...l==="balance"&&t.activeTab},children:[e.jsx(i,{})," Balance"]}),e.jsxs("button",{onClick:()=>s("buy"),style:{...t.tab,...l==="buy"&&t.activeTab},children:[e.jsx(y,{})," Buy Coins"]}),e.jsxs("button",{onClick:()=>s("transfer"),style:{...t.tab,...l==="transfer"&&t.activeTab},children:[e.jsx(i,{})," Transfer"]}),e.jsxs("button",{onClick:()=>s("history"),style:{...t.tab,...l==="history"&&t.activeTab},children:[e.jsx(V,{})," History"]})]}),e.jsx("div",{style:t.content,children:P?e.jsx("div",{style:t.loading,children:"Loading..."}):l==="balance"?e.jsxs("div",{style:t.balanceView,children:[e.jsxs("div",{style:t.balanceCard,children:[e.jsx(i,{style:{fontSize:"48px",color:"#faa61a"}}),e.jsx("div",{style:t.balanceAmount,children:x.toLocaleString()}),e.jsx("div",{style:t.balanceLabel,children:"Current Balance"})]}),e.jsxs("div",{style:t.quickActions,children:[e.jsxs("button",{onClick:()=>s("buy"),style:t.actionBtn,children:[e.jsx(y,{})," Buy Coins"]}),e.jsxs("button",{onClick:()=>s("transfer"),style:t.actionBtn,children:[e.jsx(i,{})," Transfer Coins"]})]})]}):l==="buy"?e.jsxs("div",{style:t.buyView,children:[e.jsx("h3",{style:t.sectionTitle,children:"Select Coin Package"}),e.jsx("div",{style:t.packages,children:W.map((n,o)=>e.jsxs("div",{onClick:()=>I(n.amount),style:{...t.package,...c===n.amount&&t.selectedPackage},children:[e.jsx(i,{style:{fontSize:"32px",color:"#faa61a"}}),e.jsx("div",{style:t.pkgAmount,children:n.amount.toLocaleString()}),n.bonus>0&&e.jsxs("div",{style:t.bonus,children:["+",n.bonus," BONUS"]}),e.jsxs("div",{style:t.price,children:["$",n.price]}),c===n.amount&&e.jsx($,{style:{position:"absolute",top:"10px",right:"10px",color:"#43b581"}})]},o))}),e.jsxs("div",{style:t.paymentMethod,children:[e.jsx("label",{style:t.label,children:"Payment Method"}),e.jsxs("select",{value:b,onChange:n=>D(n.target.value),style:t.select,children:[e.jsx("option",{value:"card",children:"Credit/Debit Card"}),e.jsx("option",{value:"paypal",children:"PayPal"}),e.jsx("option",{value:"crypto",children:"Cryptocurrency"})]})]}),e.jsxs("button",{onClick:A,style:t.purchaseBtn,children:[e.jsx(y,{})," Purchase ",c," Coins"]})]}):l==="transfer"?e.jsxs("div",{style:t.transferView,children:[e.jsx("h3",{style:t.sectionTitle,children:"Transfer Coins"}),e.jsxs("div",{style:t.form,children:[e.jsxs("div",{style:t.formGroup,children:[e.jsx("label",{style:t.label,children:"Recipient Username"}),e.jsx("input",{type:"text",value:f,onChange:n=>C(n.target.value),placeholder:"@username",style:t.input})]}),e.jsxs("div",{style:t.formGroup,children:[e.jsx("label",{style:t.label,children:"Amount"}),e.jsx("input",{type:"number",value:m,onChange:n=>S(n.target.value),placeholder:"0",min:"1",max:x,style:t.input}),e.jsxs("div",{style:t.hint,children:["Available: ",x," coins"]})]}),e.jsxs("div",{style:t.formGroup,children:[e.jsx("label",{style:t.label,children:"Note (Optional)"}),e.jsx("input",{type:"text",value:T,onChange:n=>k(n.target.value),placeholder:"Add a message...",style:t.input})]}),e.jsxs("button",{onClick:R,style:t.transferBtn,children:[e.jsx(i,{})," Transfer Coins"]})]})]}):e.jsxs("div",{style:t.historyView,children:[e.jsx("h3",{style:t.sectionTitle,children:"Transaction History"}),v.length===0?e.jsx("div",{style:t.empty,children:"No transactions yet"}):e.jsx("div",{style:t.transactions,children:v.map((n,o)=>e.jsxs("div",{style:t.transaction,children:[e.jsx("div",{style:t.txIcon,children:n.type==="purchase"?e.jsx(y,{style:{color:"#5865f2"}}):n.type==="transfer_sent"?e.jsx(i,{style:{color:"#f04747"}}):e.jsx(i,{style:{color:"#43b581"}})}),e.jsxs("div",{style:t.txDetails,children:[e.jsx("div",{style:t.txTitle,children:n.description}),e.jsx("div",{style:t.txDate,children:new Date(n.created_at).toLocaleString()})]}),e.jsxs("div",{style:{...t.txAmount,color:n.amount>0?"#43b581":"#f04747"},children:[n.amount>0?"+":"",n.amount]})]},o))})]})})]})})},t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999},modal:{backgroundColor:"#1e1e1e",borderRadius:"8px",width:"90%",maxWidth:"800px",maxHeight:"80vh",display:"flex",flexDirection:"column",color:"#fff"},header:{padding:"20px",borderBottom:"1px solid #444",display:"flex",justifyContent:"space-between",alignItems:"center"},headerLeft:{display:"flex",alignItems:"center",gap:"12px"},closeBtn:{background:"none",border:"none",color:"#fff",fontSize:"24px",cursor:"pointer",padding:"8px"},tabs:{display:"flex",borderBottom:"1px solid #444",padding:"0 20px"},tab:{background:"none",border:"none",color:"#99aab5",padding:"12px 20px",cursor:"pointer",fontSize:"14px",display:"flex",alignItems:"center",gap:"8px",borderBottom:"2px solid transparent",transition:"all 0.2s"},activeTab:{color:"#5865f2",borderBottomColor:"#5865f2"},content:{padding:"20px",overflowY:"auto",flex:1},loading:{textAlign:"center",padding:"40px",color:"#99aab5"},balanceView:{display:"flex",flexDirection:"column",alignItems:"center",gap:"30px"},balanceCard:{backgroundColor:"#2c2f33",borderRadius:"12px",padding:"40px",textAlign:"center",width:"100%",maxWidth:"400px",display:"flex",flexDirection:"column",alignItems:"center",gap:"16px"},balanceAmount:{fontSize:"48px",fontWeight:"bold",color:"#faa61a"},balanceLabel:{fontSize:"14px",color:"#99aab5"},quickActions:{display:"flex",gap:"12px",width:"100%",maxWidth:"400px"},actionBtn:{flex:1,padding:"12px 20px",backgroundColor:"#5865f2",border:"none",borderRadius:"6px",color:"#fff",cursor:"pointer",fontSize:"14px",fontWeight:"600",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",transition:"background 0.2s"},buyView:{display:"flex",flexDirection:"column",gap:"20px"},sectionTitle:{fontSize:"16px",fontWeight:"600",margin:0,marginBottom:"12px"},packages:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(140px, 1fr))",gap:"12px"},package:{backgroundColor:"#2c2f33",borderRadius:"8px",padding:"20px",textAlign:"center",cursor:"pointer",border:"2px solid transparent",transition:"all 0.2s",position:"relative",display:"flex",flexDirection:"column",alignItems:"center",gap:"8px"},selectedPackage:{borderColor:"#5865f2",backgroundColor:"#2c3136"},pkgAmount:{fontSize:"24px",fontWeight:"bold",color:"#faa61a"},bonus:{fontSize:"10px",color:"#43b581",fontWeight:"bold",padding:"2px 8px",backgroundColor:"rgba(67, 181, 129, 0.1)",borderRadius:"4px"},price:{fontSize:"18px",fontWeight:"600",color:"#fff"},paymentMethod:{marginTop:"12px"},label:{display:"block",fontSize:"14px",fontWeight:"600",marginBottom:"8px",color:"#dcddde"},select:{width:"100%",padding:"10px",backgroundColor:"#2c2f33",border:"1px solid #444",borderRadius:"4px",color:"#fff",fontSize:"14px"},purchaseBtn:{width:"100%",padding:"14px",backgroundColor:"#43b581",border:"none",borderRadius:"6px",color:"#fff",fontSize:"16px",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",marginTop:"12px"},transferView:{maxWidth:"500px",margin:"0 auto"},form:{display:"flex",flexDirection:"column",gap:"16px"},formGroup:{display:"flex",flexDirection:"column",gap:"8px"},input:{padding:"10px",backgroundColor:"#2c2f33",border:"1px solid #444",borderRadius:"4px",color:"#fff",fontSize:"14px"},hint:{fontSize:"12px",color:"#99aab5"},transferBtn:{width:"100%",padding:"14px",backgroundColor:"#5865f2",border:"none",borderRadius:"6px",color:"#fff",fontSize:"16px",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",marginTop:"12px"},historyView:{display:"flex",flexDirection:"column",gap:"16px"},transactions:{display:"flex",flexDirection:"column",gap:"8px"},transaction:{backgroundColor:"#2c2f33",borderRadius:"6px",padding:"16px",display:"flex",alignItems:"center",gap:"12px"},txIcon:{fontSize:"24px",display:"flex",alignItems:"center",justifyContent:"center"},txDetails:{flex:1},txTitle:{fontSize:"14px",fontWeight:"600"},txDate:{fontSize:"12px",color:"#99aab5",marginTop:"4px"},txAmount:{fontSize:"18px",fontWeight:"bold"},empty:{textAlign:"center",padding:"40px",color:"#99aab5"}};export{J as default};
