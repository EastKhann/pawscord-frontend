import{r as n,d as e,aO as C,aK as d,i as S,bx as j,aF as L,cb as I,aD as W,ch as x}from"./react-core-CecKX_Gm.js";import{t as c}from"./index-DwScqZjU.js";const M=({fetchWithAuth:p,apiBaseUrl:m,onClose:y,username:D})=>{const[g,k]=n.useState([]),[w,B]=n.useState(!0),[i,z]=n.useState(0),[l,P]=n.useState("all"),[o,s]=n.useState(null),u=[{id:"all",name:"All Items",icon:C},{id:"cosmetics",name:"Cosmetics",icon:j},{id:"badges",name:"Badges",icon:L},{id:"boosters",name:"Boosters",icon:I},{id:"special",name:"Special",icon:W}];n.useEffect(()=>{R(),b()},[]);const R=async()=>{try{const r=await(await p(`${m}/api/store/items/`)).json();k(r.items||[])}catch(t){console.error("Failed to load store items:",t),c.error("Failed to load store")}finally{B(!1)}},b=async()=>{try{const r=await(await p(`${m}/users/balance/`)).json();z(r.balance||0)}catch(t){console.error("Failed to load balance:",t)}},F=async t=>{if(i<t.price){c.error("Insufficient coins!");return}if(window.confirm(`Purchase ${t.name} for ${t.price} coins?`))try{const v=await(await p(`${m}/api/store/buy/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({item_id:t.id})})).json();v.success?(c.success(`Successfully purchased ${t.name}!`),b(),s(null)):c.error(v.error||"Purchase failed")}catch(r){console.error("Purchase error:",r),c.error("Purchase failed")}},h=l==="all"?g:g.filter(t=>t.category===l),E=g.filter(t=>t.featured),f=t=>{const r={common:"#b0b0b0",uncommon:"#1eff00",rare:"#0070dd",epic:"#a335ee",legendary:"#ff8000"};return r[t]||r.common};return e.createElement("div",{style:a.overlay,onClick:y},e.createElement("div",{style:a.modal,onClick:t=>t.stopPropagation()},e.createElement("div",{style:a.header},e.createElement("div",{style:a.headerLeft},e.createElement(C,{style:{fontSize:"24px",color:"#5865f2"}}),e.createElement("h2",{style:{margin:0,fontSize:"20px"}},"Item Store")),e.createElement("div",{style:a.headerRight},e.createElement("div",{style:a.balance},e.createElement(d,{style:{color:"#faa61a"}}),e.createElement("span",null,i.toLocaleString())),e.createElement("button",{onClick:y,style:a.closeBtn},e.createElement(S,null)))),e.createElement("div",{style:a.categories},u.map(t=>{const r=t.icon;return e.createElement("button",{key:t.id,onClick:()=>P(t.id),style:{...a.categoryBtn,...l===t.id&&a.activeCategoryBtn}},e.createElement(r,null),e.createElement("span",null,t.name))})),e.createElement("div",{style:a.content},w?e.createElement("div",{style:a.loading},"Loading store..."):e.createElement(e.Fragment,null,l==="all"&&E.length>0&&e.createElement("div",{style:a.section},e.createElement("h3",{style:a.sectionTitle},e.createElement(I,{style:{color:"#f04747"}})," Featured Items"),e.createElement("div",{style:a.itemsGrid},E.map(t=>e.createElement("div",{key:t.id,style:a.itemCard,onClick:()=>s(t)},t.image?e.createElement("img",{src:t.image,alt:t.name,style:a.itemImage}):e.createElement("div",{style:a.itemPlaceholder},e.createElement(x,{style:{fontSize:"48px",color:"#99aab5"}})),e.createElement("div",{style:a.itemInfo},e.createElement("div",{style:{...a.itemName,color:f(t.rarity)}},t.name),e.createElement("div",{style:a.itemPrice},e.createElement(d,{style:{color:"#faa61a"}}),t.price.toLocaleString())),t.limited&&e.createElement("div",{style:a.limitedBadge},"LIMITED"))))),e.createElement("div",{style:a.section},e.createElement("h3",{style:a.sectionTitle},u.find(t=>t.id===l)?.name||"All Items"),h.length===0?e.createElement("div",{style:a.empty},"No items in this category"):e.createElement("div",{style:a.itemsGrid},h.map(t=>e.createElement("div",{key:t.id,style:a.itemCard,onClick:()=>s(t)},t.image?e.createElement("img",{src:t.image,alt:t.name,style:a.itemImage}):e.createElement("div",{style:a.itemPlaceholder},e.createElement(x,{style:{fontSize:"48px",color:"#99aab5"}})),e.createElement("div",{style:a.itemInfo},e.createElement("div",{style:{...a.itemName,color:f(t.rarity)}},t.name),e.createElement("div",{style:a.itemPrice},e.createElement(d,{style:{color:"#faa61a"}}),t.price.toLocaleString())),t.limited&&e.createElement("div",{style:a.limitedBadge},"LIMITED"))))))),o&&e.createElement("div",{style:a.detailOverlay,onClick:()=>s(null)},e.createElement("div",{style:a.detailModal,onClick:t=>t.stopPropagation()},e.createElement("button",{onClick:()=>s(null),style:a.detailClose},e.createElement(S,null)),o.image?e.createElement("img",{src:o.image,alt:o.name,style:a.detailImage}):e.createElement("div",{style:a.detailPlaceholder},e.createElement(x,{style:{fontSize:"120px",color:"#99aab5"}})),e.createElement("h2",{style:{...a.detailName,color:f(o.rarity)}},o.name),e.createElement("div",{style:a.detailRarity},o.rarity.toUpperCase()),e.createElement("p",{style:a.detailDescription},o.description||"No description available."),e.createElement("div",{style:a.detailPrice},e.createElement(d,{style:{fontSize:"24px",color:"#faa61a"}}),e.createElement("span",{style:{fontSize:"32px",fontWeight:"bold"}},o.price.toLocaleString())),e.createElement("button",{onClick:()=>F(o),disabled:i<o.price,style:{...a.purchaseBtn,...i<o.price&&a.purchaseBtnDisabled}},i<o.price?"Insufficient Coins":"Purchase")))))},a={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999},modal:{backgroundColor:"#1e1e1e",borderRadius:"8px",width:"95%",maxWidth:"1200px",maxHeight:"90vh",display:"flex",flexDirection:"column",color:"#fff"},header:{padding:"20px",borderBottom:"1px solid #444",display:"flex",justifyContent:"space-between",alignItems:"center"},headerLeft:{display:"flex",alignItems:"center",gap:"12px"},headerRight:{display:"flex",alignItems:"center",gap:"16px"},balance:{display:"flex",alignItems:"center",gap:"8px",backgroundColor:"#2c2f33",padding:"8px 16px",borderRadius:"20px",fontSize:"16px",fontWeight:"600"},closeBtn:{background:"none",border:"none",color:"#fff",fontSize:"24px",cursor:"pointer",padding:"8px"},categories:{display:"flex",gap:"8px",padding:"16px 20px",borderBottom:"1px solid #444",overflowX:"auto"},categoryBtn:{background:"none",border:"none",color:"#99aab5",padding:"10px 16px",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:"600",display:"flex",alignItems:"center",gap:"8px",whiteSpace:"nowrap",transition:"all 0.2s"},activeCategoryBtn:{backgroundColor:"#5865f2",color:"#fff"},content:{padding:"20px",overflowY:"auto",flex:1},loading:{textAlign:"center",padding:"40px",color:"#99aab5"},section:{marginBottom:"32px"},sectionTitle:{fontSize:"18px",fontWeight:"600",marginBottom:"16px",display:"flex",alignItems:"center",gap:"8px"},itemsGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(180px, 1fr))",gap:"16px"},itemCard:{backgroundColor:"#2c2f33",borderRadius:"8px",padding:"12px",cursor:"pointer",transition:"transform 0.2s",position:"relative",overflow:"hidden"},itemImage:{width:"100%",height:"150px",objectFit:"cover",borderRadius:"6px",marginBottom:"8px"},itemPlaceholder:{width:"100%",height:"150px",backgroundColor:"#202225",borderRadius:"6px",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"8px"},itemInfo:{display:"flex",flexDirection:"column",gap:"8px"},itemName:{fontSize:"14px",fontWeight:"600",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},itemPrice:{display:"flex",alignItems:"center",gap:"6px",fontSize:"16px",fontWeight:"bold"},limitedBadge:{position:"absolute",top:"12px",right:"12px",backgroundColor:"#f04747",color:"#fff",padding:"4px 8px",borderRadius:"4px",fontSize:"10px",fontWeight:"bold"},empty:{textAlign:"center",padding:"40px",color:"#99aab5"},detailOverlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.9)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e6},detailModal:{backgroundColor:"#2c2f33",borderRadius:"12px",padding:"32px",maxWidth:"500px",width:"90%",position:"relative",textAlign:"center"},detailClose:{position:"absolute",top:"16px",right:"16px",background:"none",border:"none",color:"#fff",fontSize:"24px",cursor:"pointer"},detailImage:{width:"100%",maxHeight:"300px",objectFit:"cover",borderRadius:"8px",marginBottom:"20px"},detailPlaceholder:{width:"100%",height:"300px",backgroundColor:"#202225",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"20px"},detailName:{fontSize:"28px",fontWeight:"bold",marginBottom:"12px"},detailRarity:{display:"inline-block",padding:"6px 12px",backgroundColor:"#202225",borderRadius:"6px",fontSize:"12px",fontWeight:"bold",marginBottom:"16px"},detailDescription:{fontSize:"14px",color:"#dcddde",lineHeight:"1.6",marginBottom:"24px"},detailPrice:{display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",marginBottom:"24px",color:"#faa61a"},purchaseBtn:{width:"100%",padding:"14px",backgroundColor:"#43b581",border:"none",borderRadius:"6px",color:"#fff",fontSize:"16px",fontWeight:"600",cursor:"pointer",transition:"background 0.2s"},purchaseBtnDisabled:{backgroundColor:"#555",cursor:"not-allowed"}};export{M as default};
