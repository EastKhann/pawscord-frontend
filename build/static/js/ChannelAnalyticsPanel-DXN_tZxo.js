import{r as n,n as s}from"./react-core-BMiyQWF6.js";import{c as k,bo as w,a as _,a7 as d,U as b,bc as p,a3 as f,S as C,t as F,D as A,aU as S,J as $,b6 as D,b7 as L,c0 as M}from"./icons-vendor-GUGjkvMm.js";import{g as T}from"./index-CTFF7TqV.js";import"./editor-vendor-D9c4a6XZ.js";import"./media-vendor-BuSyE8vR.js";import"./router-vendor-B86Z1mIL.js";import"./state-vendor-CAyNnPM4.js";import"./crypto-vendor-1Q6e4ZD-.js";const J=({serverId:h,onClose:i,fetchWithAuth:m})=>{const[l,r]=n.useState(null),[v,o]=n.useState(!0),[c,u]=n.useState(null),[t,N]=n.useState("week"),x=n.useCallback(async()=>{o(!0);try{const a=await m(`${T()}/servers/${h}/channel-analytics/?range=${t}`);if(a.ok){const e=await a.json();r(e)}else r({summary:{total_channels:24,active_channels:18,total_messages:45823,average_response_time:2.4},channels:[{id:1,name:"general",type:"text",messages:12450,active_users:234,growth:15.2,peak_hour:20},{id:2,name:"announcements",type:"text",messages:856,active_users:512,growth:8.4,peak_hour:12},{id:3,name:"memes",type:"text",messages:8932,active_users:189,growth:22.1,peak_hour:22},{id:4,name:"gaming",type:"text",messages:6721,active_users:145,growth:-3.2,peak_hour:21},{id:5,name:"music",type:"voice",messages:0,active_users:67,growth:5.8,peak_hour:19},{id:6,name:"help",type:"text",messages:3421,active_users:98,growth:0,peak_hour:14}],peak_hours:[{hour:20,activity:100},{hour:21,activity:95},{hour:22,activity:88},{hour:19,activity:82},{hour:18,activity:75}],engagement_rate:76.4})}catch{r({summary:{},channels:[],peak_hours:[]})}o(!1)},[h,t,m]);n.useEffect(()=>{x()},[x]);const j=a=>a>=1e6?(a/1e6).toFixed(1)+"M":a>=1e3?(a/1e3).toFixed(1)+"K":a?.toString()||"0",g=a=>a>0?s.jsx(D,{className:"growth-up"}):a<0?s.jsx(L,{className:"growth-down"}):s.jsx(M,{className:"growth-neutral"}),y=a=>a==="voice"?s.jsx($,{}):s.jsx(d,{});return v?s.jsx("div",{className:"channel-analytics-overlay",onClick:i,children:s.jsx("div",{className:"channel-analytics-panel",onClick:a=>a.stopPropagation(),children:s.jsxs("div",{className:"loading-state",children:[s.jsx(k,{className:"spin"}),s.jsx("span",{children:"Loading channel analytics..."})]})})}):s.jsx("div",{className:"channel-analytics-overlay",onClick:i,children:s.jsxs("div",{className:"channel-analytics-panel",onClick:a=>a.stopPropagation(),children:[s.jsxs("div",{className:"panel-header",children:[s.jsxs("div",{className:"header-info",children:[s.jsxs("h2",{children:[s.jsx(w,{})," Channel Analytics"]}),s.jsx("span",{className:"subtitle",children:"Track channel performance and engagement"})]}),s.jsxs("div",{className:"header-actions",children:[s.jsxs("select",{value:t,onChange:a=>N(a.target.value),className:"time-select",children:[s.jsx("option",{value:"day",children:"Last 24 Hours"}),s.jsx("option",{value:"week",children:"Last 7 Days"}),s.jsx("option",{value:"month",children:"Last 30 Days"})]}),s.jsx("button",{className:"close-btn",onClick:i,children:s.jsx(_,{})})]})]}),s.jsxs("div",{className:"summary-cards",children:[s.jsxs("div",{className:"summary-card",children:[s.jsx("div",{className:"card-icon",children:s.jsx(d,{})}),s.jsxs("div",{className:"card-content",children:[s.jsx("span",{className:"card-value",children:l?.summary?.total_channels||0}),s.jsx("span",{className:"card-label",children:"Total Channels"})]})]}),s.jsxs("div",{className:"summary-card",children:[s.jsx("div",{className:"card-icon active",children:s.jsx(b,{})}),s.jsxs("div",{className:"card-content",children:[s.jsx("span",{className:"card-value",children:l?.summary?.active_channels||0}),s.jsx("span",{className:"card-label",children:"Active Channels"})]})]}),s.jsxs("div",{className:"summary-card",children:[s.jsx("div",{className:"card-icon",children:s.jsx(p,{})}),s.jsxs("div",{className:"card-content",children:[s.jsx("span",{className:"card-value",children:j(l?.summary?.total_messages)}),s.jsx("span",{className:"card-label",children:"Total Messages"})]})]}),s.jsxs("div",{className:"summary-card",children:[s.jsx("div",{className:"card-icon",children:s.jsx(f,{})}),s.jsxs("div",{className:"card-content",children:[s.jsxs("span",{className:"card-value",children:[l?.engagement_rate||0,"%"]}),s.jsx("span",{className:"card-label",children:"Engagement Rate"})]})]})]}),s.jsxs("div",{className:"panel-body",children:[s.jsxs("div",{className:"section",children:[s.jsxs("h3",{children:[s.jsx(C,{})," Channel Leaderboard"]}),s.jsxs("div",{className:"channel-list",children:[(l?.channels||[]).sort((a,e)=>e.messages-a.messages).map((a,e)=>s.jsxs("div",{className:`channel-item ${c===a.id?"selected":""}`,onClick:()=>u(a.id===c?null:a.id),children:[s.jsxs("span",{className:`rank ${e<3?"top":""}`,children:["#",e+1]}),s.jsx("span",{className:"channel-icon",children:y(a.type)}),s.jsxs("div",{className:"channel-info",children:[s.jsx("span",{className:"channel-name",children:a.name}),s.jsxs("div",{className:"channel-stats",children:[s.jsxs("span",{children:[s.jsx(p,{})," ",j(a.messages)]}),s.jsxs("span",{children:[s.jsx(F,{})," ",a.active_users]})]})]}),s.jsxs("div",{className:"channel-growth",children:[g(a.growth),s.jsxs("span",{className:a.growth>0?"positive":a.growth<0?"negative":"",children:[Math.abs(a.growth),"%"]})]}),s.jsx("div",{className:"channel-bar",children:s.jsx("div",{className:"bar-fill",style:{width:`${a.messages/(l?.channels?.[0]?.messages||1)*100}%`}})})]},a.id)),(!l?.channels||l.channels.length===0)&&s.jsx("div",{className:"empty-state",children:"No channel data available"})]})]}),s.jsxs("div",{className:"section",children:[s.jsxs("h3",{children:[s.jsx(A,{})," Peak Activity Hours"]}),s.jsx("div",{className:"peak-hours",children:(l?.peak_hours||[]).map((a,e)=>s.jsxs("div",{className:"peak-item",children:[s.jsxs("span",{className:"peak-rank",children:["#",e+1]}),s.jsxs("div",{className:"peak-time",children:[s.jsx(S,{}),s.jsxs("span",{children:[a.hour,":00 - ",a.hour+1,":00"]})]}),s.jsx("div",{className:"peak-bar",children:s.jsx("div",{className:"bar-fill",style:{width:`${a.activity}%`}})}),s.jsxs("span",{className:"peak-value",children:[a.activity,"%"]})]},e))})]}),c&&s.jsxs("div",{className:"section channel-details",children:[s.jsxs("h3",{children:[s.jsx(d,{})," Channel Details"]}),(()=>{const a=l?.channels?.find(e=>e.id===c);return a?s.jsxs("div",{className:"details-grid",children:[s.jsxs("div",{className:"detail-card",children:[s.jsx("span",{className:"detail-label",children:"Peak Hour"}),s.jsxs("span",{className:"detail-value",children:[a.peak_hour,":00"]})]}),s.jsxs("div",{className:"detail-card",children:[s.jsx("span",{className:"detail-label",children:"Active Users"}),s.jsx("span",{className:"detail-value",children:a.active_users})]}),s.jsxs("div",{className:"detail-card",children:[s.jsx("span",{className:"detail-label",children:"Weekly Growth"}),s.jsxs("span",{className:`detail-value ${a.growth>0?"positive":a.growth<0?"negative":""}`,children:[a.growth>0?"+":"",a.growth,"%"]})]}),s.jsxs("div",{className:"detail-card",children:[s.jsx("span",{className:"detail-label",children:"Messages/Day"}),s.jsx("span",{className:"detail-value",children:Math.round(a.messages/7)})]})]}):null})()]})]})]})})};export{J as default};
