import{r,d as e,c9 as c}from"./react-core-DrOm_csO.js";import{g as w}from"./index-DmEhdEtw.js";const x=({serverId:o,onClose:u})=>{const l=w(),[i,h]=r.useState([]),[E,g]=r.useState(!0),[p,k]=r.useState(!1),[n,s]=r.useState({include_channels:!0,include_roles:!0,include_messages:!1,include_settings:!0,include_emojis:!0});r.useEffect(()=>{m()},[o]);const m=async()=>{try{const t=await fetch(`${l}/backups/server/${o}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(t.ok){const a=await t.json();h(a)}}catch(t){console.error("Error:",t)}finally{g(!1)}},b=async()=>{k(!0);try{(await fetch(`${l}/backups/create/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`,"Content-Type":"application/json"},body:JSON.stringify({server_id:o,...n})})).ok?(c.success("âœ… Yedek oluÅŸturuluyor..."),m()):c.error("âŒ Yedek oluÅŸturulamadÄ±")}catch{c.error("âŒ BaÄŸlantÄ± hatasÄ±")}finally{k(!1)}},y=async t=>{if(window.confirm("Sunucuyu bu yedeÄŸe geri yÃ¼klemek istediÄŸinize emin misiniz? Bu iÅŸlem geri alÄ±namaz!"))try{(await fetch(`${l}/backups/${t}/restore/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}})).ok?c.success("âœ… Sunucu geri yÃ¼kleniyor..."):c.error("âŒ Geri yÃ¼kleme hatasÄ±")}catch{c.error("âŒ BaÄŸlantÄ± hatasÄ±")}},f=async t=>{try{const a=await fetch(`${l}/backups/${t}/download/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(a.ok){const S=await a.blob(),v=window.URL.createObjectURL(S),d=document.createElement("a");d.href=v,d.download=`backup_${t}.json`,d.click(),c.success("âœ… Yedek indiriliyor")}}catch{c.error("âŒ Ä°ndirme hatasÄ±")}},N=async t=>{if(window.confirm("YedeÄŸi silmek istediÄŸinize emin misiniz?"))try{(await fetch(`${l}/backups/${t}/delete/`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}})).ok&&(c.success("âœ… Yedek silindi"),m())}catch{c.error("âŒ Silme hatasÄ±")}},_=t=>t<1024?t+" B":t<1024*1024?(t/1024).toFixed(2)+" KB":(t/(1024*1024)).toFixed(2)+" MB",B=t=>{const a={completed:{text:"TamamlandÄ±",color:"#22c55e",icon:"âœ…"},processing:{text:"Ä°ÅŸleniyor",color:"#f59e0b",icon:"â³"},failed:{text:"BaÅŸarÄ±sÄ±z",color:"#ef4444",icon:"âŒ"}};return a[t]||a.processing};return e.createElement("div",{className:"backup-overlay",onClick:u},e.createElement("div",{className:"backup-panel",onClick:t=>t.stopPropagation()},e.createElement("div",{className:"backup-header"},e.createElement("h2",null,"ğŸ’¾ Sunucu Yedekleme"),e.createElement("button",{className:"close-btn",onClick:u},"Ã—")),e.createElement("div",{className:"backup-content"},e.createElement("div",{className:"create-backup-section"},e.createElement("h3",null,"Yeni Yedek OluÅŸtur"),e.createElement("div",{className:"backup-options"},e.createElement("label",{className:"option-label"},e.createElement("input",{type:"checkbox",checked:n.include_channels,onChange:t=>s({...n,include_channels:t.target.checked})}),e.createElement("span",null,"ğŸ“ KanallarÄ± dahil et")),e.createElement("label",{className:"option-label"},e.createElement("input",{type:"checkbox",checked:n.include_roles,onChange:t=>s({...n,include_roles:t.target.checked})}),e.createElement("span",null,"ğŸ­ Rolleri dahil et")),e.createElement("label",{className:"option-label"},e.createElement("input",{type:"checkbox",checked:n.include_messages,onChange:t=>s({...n,include_messages:t.target.checked})}),e.createElement("span",null,"ğŸ’¬ MesajlarÄ± dahil et (son 100)")),e.createElement("label",{className:"option-label"},e.createElement("input",{type:"checkbox",checked:n.include_settings,onChange:t=>s({...n,include_settings:t.target.checked})}),e.createElement("span",null,"âš™ï¸ AyarlarÄ± dahil et")),e.createElement("label",{className:"option-label"},e.createElement("input",{type:"checkbox",checked:n.include_emojis,onChange:t=>s({...n,include_emojis:t.target.checked})}),e.createElement("span",null,"ğŸ˜€ Emojileri dahil et"))),e.createElement("button",{className:"create-backup-btn",onClick:b,disabled:p},p?"â³ OluÅŸturuluyor...":"ğŸ’¾ Yedek OluÅŸtur")),E?e.createElement("div",{className:"loading-state"},e.createElement("div",{className:"spinner"}),e.createElement("p",null,"YÃ¼kleniyor...")):i.length===0?e.createElement("div",{className:"empty-state"},e.createElement("span",{className:"empty-icon"},"ğŸ’¾"),e.createElement("p",null,"HenÃ¼z yedek yok")):e.createElement("div",{className:"backups-list"},e.createElement("h3",null,"Mevcut Yedekler (",i.length,")"),i.map(t=>{const a=B(t.status);return e.createElement("div",{key:t.id,className:"backup-card"},e.createElement("div",{className:"backup-info"},e.createElement("div",{className:"backup-main"},e.createElement("h4",null,"Yedek #",t.id),e.createElement("div",{className:"backup-meta"},e.createElement("span",null,"ğŸ“… ",new Date(t.created_at).toLocaleString("tr-TR")),e.createElement("span",null,"ğŸ“¦ ",_(t.file_size)),e.createElement("span",{className:"status-badge",style:{background:a.color}},a.icon," ",a.text)),e.createElement("div",{className:"backup-includes"},t.includes_channels&&e.createElement("span",{className:"include-badge"},"ğŸ“ Kanallar"),t.includes_roles&&e.createElement("span",{className:"include-badge"},"ğŸ­ Roller"),t.includes_messages&&e.createElement("span",{className:"include-badge"},"ğŸ’¬ Mesajlar"),t.includes_settings&&e.createElement("span",{className:"include-badge"},"âš™ï¸ Ayarlar"),t.includes_emojis&&e.createElement("span",{className:"include-badge"},"ğŸ˜€ Emojiler")))),t.status==="completed"&&e.createElement("div",{className:"backup-actions"},e.createElement("button",{className:"restore-btn",onClick:()=>y(t.id)},"ğŸ”„ Geri YÃ¼kle"),e.createElement("button",{className:"download-btn",onClick:()=>f(t.id)},"ğŸ“¥ Ä°ndir"),e.createElement("button",{className:"delete-btn",onClick:()=>N(t.id)},"ğŸ—‘ï¸ Sil")))})))))};export{x as default};
