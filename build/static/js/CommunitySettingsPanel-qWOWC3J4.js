import{r as m,n as e}from"./react-core-BMiyQWF6.js";import{t as Q,a as v,bl as Y,bm as O,aZ as B,a$ as N,cz as L,a4 as y,aK as P,a9 as H,a8 as Z,aB as I,cF as J,cG as M,d as U}from"./icons-vendor-GUGjkvMm.js";import{t as f}from"./index-5Qs4G3EW.js";import"./editor-vendor-D9c4a6XZ.js";import"./media-vendor-BuSyE8vR.js";import"./router-vendor-B86Z1mIL.js";import"./state-vendor-CAyNnPM4.js";import"./crypto-vendor-1Q6e4ZD-.js";const oe=({apiBaseUrl:n,serverId:i,onClose:c})=>{const[a,s]=m.useState({is_community:!1,rules_channel_id:"",public_updates_channel_id:"",verification_level:"medium",explicit_content_filter:"medium",default_notifications:"mentions",description:"",preferred_locale:"tr",features:{welcome_screen:!0,member_screening:!1,discovery:!1}}),[d,t]=m.useState([]),[g,j]=m.useState([]),[_,C]=m.useState([]),[S,T]=m.useState(!0),[k,b]=m.useState(!1),[u,p]=m.useState("general");m.useEffect(()=>{F(),$()},[]);const F=async()=>{try{const l=localStorage.getItem("access_token"),r=await fetch(`${n}/servers/${i}/community/settings/`,{headers:{Authorization:`Bearer ${l}`}});if(r.ok){const o=await r.json();s(h=>({...h,...o})),t(o.rules||[]),j(o.screening_questions||[])}}catch{}finally{T(!1)}},$=async()=>{try{const l=localStorage.getItem("access_token"),r=await fetch(`${n}/servers/${i}/channels/`,{headers:{Authorization:`Bearer ${l}`}});if(r.ok){const o=await r.json();C((o.channels||o||[]).filter(h=>h.type!=="category"))}}catch{}},w=async()=>{b(!0);try{const l=localStorage.getItem("access_token");(await fetch(`${n}/servers/${i}/community/settings/`,{method:"PUT",headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"},body:JSON.stringify({...a,rules:d,screening_questions:g})})).ok&&f.success("âœ… Topluluk ayarlarÄ± kaydedildi")}catch{f.error("Kaydetme baÅŸarÄ±sÄ±z")}finally{b(!1)}},K=()=>{t(l=>[...l,{id:Date.now(),title:"",description:""}])},z=(l,r,o)=>{t(h=>h.map(x=>x.id===l?{...x,[r]:o}:x))},E=l=>{t(r=>r.filter(o=>o.id!==l))},A=()=>{j(l=>[...l,{id:Date.now(),question:"",required:!1}])},R=(l,r,o)=>{j(h=>h.map(x=>x.id===l?{...x,[r]:o}:x))},G=l=>{j(r=>r.filter(o=>o.id!==l))},q=[{value:"none",label:"Yok",description:"Herkes mesaj gÃ¶nderebilir"},{value:"low",label:"DÃ¼ÅŸÃ¼k",description:"E-posta doÄŸrulamasÄ± gerekli"},{value:"medium",label:"Orta",description:"5 dakika kayÄ±tlÄ± olmalÄ±"},{value:"high",label:"YÃ¼ksek",description:"10 dakika sunucuda olmalÄ±"},{value:"highest",label:"En YÃ¼ksek",description:"Telefon doÄŸrulamasÄ± gerekli"}],D=[{value:"disabled",label:"KapalÄ±",description:"Ä°Ã§erik filtresi yok"},{value:"medium",label:"Orta",description:"RolsÃ¼z Ã¼yeler iÃ§in filtrele"},{value:"high",label:"YÃ¼ksek",description:"TÃ¼m mesajlarÄ± filtrele"}];return S?e.jsx("div",{className:"community-settings-overlay",onClick:c,children:e.jsx("div",{className:"community-settings-panel",onClick:l=>l.stopPropagation(),children:e.jsx("div",{className:"loading",children:"YÃ¼kleniyor..."})})}):e.jsx("div",{className:"community-settings-overlay",onClick:c,children:e.jsxs("div",{className:"community-settings-panel",onClick:l=>l.stopPropagation(),children:[e.jsxs("div",{className:"panel-header",children:[e.jsxs("h2",{children:[e.jsx(Q,{})," Topluluk AyarlarÄ±"]}),e.jsx("button",{className:"close-btn",onClick:c,children:e.jsx(v,{})})]}),e.jsxs("div",{className:"community-toggle",children:[e.jsxs("div",{className:"toggle-info",children:[e.jsx("span",{className:"toggle-label",children:"Topluluk Sunucusu"}),e.jsx("span",{className:"toggle-description",children:"Topluluk Ã¶zelliklerini aktifleÅŸtir (keÅŸfet, karÅŸÄ±lama ekranÄ± vb.)"})]}),e.jsx("button",{className:`toggle-btn ${a.is_community?"active":""}`,onClick:()=>s(l=>({...l,is_community:!l.is_community})),children:a.is_community?e.jsx(Y,{}):e.jsx(O,{})})]}),e.jsxs("div",{className:"tabs",children:[e.jsxs("button",{className:`tab ${u==="general"?"active":""}`,onClick:()=>p("general"),children:[e.jsx(B,{})," Genel"]}),e.jsxs("button",{className:`tab ${u==="rules"?"active":""}`,onClick:()=>p("rules"),children:[e.jsx(N,{})," Kurallar"]}),e.jsxs("button",{className:`tab ${u==="screening"?"active":""}`,onClick:()=>p("screening"),children:[e.jsx(L,{})," Ãœye Tarama"]}),e.jsxs("button",{className:`tab ${u==="safety"?"active":""}`,onClick:()=>p("safety"),children:[e.jsx(y,{})," GÃ¼venlik"]})]}),e.jsxs("div",{className:"panel-content",children:[u==="general"&&e.jsx(V,{settings:a,setSettings:s,channels:_}),u==="rules"&&e.jsx(W,{rules:d,onAdd:K,onUpdate:z,onRemove:E}),u==="screening"&&e.jsx(X,{questions:g,onAdd:A,onUpdate:R,onRemove:G}),u==="safety"&&e.jsx(ee,{settings:a,setSettings:s,verificationLevels:q,contentFilters:D})]}),e.jsxs("div",{className:"panel-footer",children:[e.jsx("button",{className:"cancel-btn",onClick:c,children:"Ä°ptal"}),e.jsxs("button",{className:"save-btn",onClick:w,disabled:k,children:[e.jsx(P,{})," ",k?"Kaydediliyor...":"Kaydet"]})]})]})})},V=({settings:n,setSettings:i,channels:c})=>e.jsxs("div",{className:"settings-tab",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Sunucu AÃ§Ä±klamasÄ±"}),e.jsx("textarea",{value:n.description,onChange:a=>i(s=>({...s,description:a.target.value})),placeholder:"Sunucunuz hakkÄ±nda kÄ±sa bir aÃ§Ä±klama...",rows:"3",maxLength:300}),e.jsxs("span",{className:"char-count",children:[n.description?.length||0,"/300"]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:[e.jsx(N,{})," Kurallar KanalÄ±"]}),e.jsxs("select",{value:n.rules_channel_id,onChange:a=>i(s=>({...s,rules_channel_id:a.target.value})),children:[e.jsx("option",{value:"",children:"SeÃ§in..."}),c.map(a=>e.jsxs("option",{value:a.id,children:["#",a.name]},a.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:[e.jsx(H,{})," GÃ¼ncellemeler KanalÄ±"]}),e.jsxs("select",{value:n.public_updates_channel_id,onChange:a=>i(s=>({...s,public_updates_channel_id:a.target.value})),children:[e.jsx("option",{value:"",children:"SeÃ§in..."}),c.map(a=>e.jsxs("option",{value:a.id,children:["#",a.name]},a.id))]})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:[e.jsx(Z,{})," Tercih Edilen Dil"]}),e.jsxs("select",{value:n.preferred_locale,onChange:a=>i(s=>({...s,preferred_locale:a.target.value})),children:[e.jsx("option",{value:"tr",children:"ðŸ‡¹ðŸ‡· TÃ¼rkÃ§e"}),e.jsx("option",{value:"en",children:"ðŸ‡¬ðŸ‡§ English"}),e.jsx("option",{value:"de",children:"ðŸ‡©ðŸ‡ª Deutsch"}),e.jsx("option",{value:"fr",children:"ðŸ‡«ðŸ‡· FranÃ§ais"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:[e.jsx(I,{})," VarsayÄ±lan Bildirimler"]}),e.jsxs("select",{value:n.default_notifications,onChange:a=>i(s=>({...s,default_notifications:a.target.value})),children:[e.jsx("option",{value:"all",children:"TÃ¼m Mesajlar"}),e.jsx("option",{value:"mentions",children:"Sadece Etiketler"})]})]})]}),e.jsxs("div",{className:"feature-toggles",children:[e.jsx("h4",{children:"Ã–zellikler"}),e.jsxs("label",{className:"feature-item",children:[e.jsx("span",{children:"KarÅŸÄ±lama EkranÄ±"}),e.jsx("input",{type:"checkbox",checked:n.features?.welcome_screen,onChange:a=>i(s=>({...s,features:{...s.features,welcome_screen:a.target.checked}}))})]}),e.jsxs("label",{className:"feature-item",children:[e.jsx("span",{children:"Ãœye Tarama"}),e.jsx("input",{type:"checkbox",checked:n.features?.member_screening,onChange:a=>i(s=>({...s,features:{...s.features,member_screening:a.target.checked}}))})]}),e.jsxs("label",{className:"feature-item",children:[e.jsx("span",{children:"Sunucu KeÅŸfet"}),e.jsx("input",{type:"checkbox",checked:n.features?.discovery,onChange:a=>i(s=>({...s,features:{...s.features,discovery:a.target.checked}}))})]})]})]}),W=({rules:n,onAdd:i,onUpdate:c,onRemove:a})=>e.jsxs("div",{className:"settings-tab",children:[e.jsxs("div",{className:"tab-header",children:[e.jsx("h4",{children:"Sunucu KurallarÄ±"}),e.jsx("button",{className:"add-btn",onClick:i,children:"+ Kural Ekle"})]}),n.length===0?e.jsxs("div",{className:"empty-rules",children:[e.jsx(J,{}),e.jsx("p",{children:"HenÃ¼z kural eklenmemiÅŸ"})]}):e.jsx("div",{className:"rules-list",children:n.map((s,d)=>e.jsxs("div",{className:"rule-item",children:[e.jsx("span",{className:"rule-number",children:d+1}),e.jsxs("div",{className:"rule-content",children:[e.jsx("input",{type:"text",placeholder:"Kural baÅŸlÄ±ÄŸÄ±...",value:s.title,onChange:t=>c(s.id,"title",t.target.value)}),e.jsx("textarea",{placeholder:"Kural aÃ§Ä±klamasÄ±...",value:s.description,onChange:t=>c(s.id,"description",t.target.value),rows:"2"})]}),e.jsx("button",{className:"remove-btn",onClick:()=>a(s.id),children:e.jsx(v,{})})]},s.id))})]}),X=({questions:n,onAdd:i,onUpdate:c,onRemove:a})=>e.jsxs("div",{className:"settings-tab",children:[e.jsxs("div",{className:"tab-header",children:[e.jsx("h4",{children:"Ãœye Tarama SorularÄ±"}),e.jsx("button",{className:"add-btn",onClick:i,children:"+ Soru Ekle"})]}),e.jsx("p",{className:"tab-description",children:"Yeni Ã¼yeler sunucuya katÄ±lmadan Ã¶nce bu sorularÄ± yanÄ±tlamalÄ±dÄ±r."}),n.length===0?e.jsxs("div",{className:"empty-rules",children:[e.jsx(M,{}),e.jsx("p",{children:"HenÃ¼z soru eklenmemiÅŸ"})]}):e.jsx("div",{className:"questions-list",children:n.map((s,d)=>e.jsxs("div",{className:"question-item",children:[e.jsx("span",{className:"question-number",children:d+1}),e.jsxs("div",{className:"question-content",children:[e.jsx("input",{type:"text",placeholder:"Soruyu yazÄ±n...",value:s.question,onChange:t=>c(s.id,"question",t.target.value)}),e.jsxs("label",{className:"required-toggle",children:[e.jsx("input",{type:"checkbox",checked:s.required,onChange:t=>c(s.id,"required",t.target.checked)}),e.jsx("span",{children:"Zorunlu"})]})]}),e.jsx("button",{className:"remove-btn",onClick:()=>a(s.id),children:e.jsx(v,{})})]},s.id))})]}),ee=({settings:n,setSettings:i,verificationLevels:c,contentFilters:a})=>e.jsxs("div",{className:"settings-tab",children:[e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:[e.jsx(y,{})," DoÄŸrulama Seviyesi"]}),e.jsx("div",{className:"level-options",children:c.map(s=>e.jsxs("label",{className:`level-option ${n.verification_level===s.value?"selected":""}`,children:[e.jsx("input",{type:"radio",name:"verification",value:s.value,checked:n.verification_level===s.value,onChange:d=>i(t=>({...t,verification_level:d.target.value}))}),e.jsxs("div",{className:"level-info",children:[e.jsx("span",{className:"level-label",children:s.label}),e.jsx("span",{className:"level-desc",children:s.description})]})]},s.value))})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:[e.jsx(U,{})," Ä°Ã§erik Filtresi"]}),e.jsx("div",{className:"level-options",children:a.map(s=>e.jsxs("label",{className:`level-option ${n.explicit_content_filter===s.value?"selected":""}`,children:[e.jsx("input",{type:"radio",name:"content-filter",value:s.value,checked:n.explicit_content_filter===s.value,onChange:d=>i(t=>({...t,explicit_content_filter:d.target.value}))}),e.jsxs("div",{className:"level-info",children:[e.jsx("span",{className:"level-label",children:s.label}),e.jsx("span",{className:"level-desc",children:s.description})]})]},s.value))})]})]});export{oe as default};
