import{r as u,K as G,l as p,ci as Q,cj as Y,bV as O,bX as h,dy as L,ay as y,bD as P,aF as B,aE as H,bt as V,dE as I,t as J,o as M}from"./react-core-B6hadH-M.js";import{t as f}from"./index-D_6pZib5.js";const te=({apiBaseUrl:l,serverId:c,onClose:r})=>{const[a,e]=u.useState({is_community:!1,rules_channel_id:"",public_updates_channel_id:"",verification_level:"medium",explicit_content_filter:"medium",default_notifications:"mentions",description:"",preferred_locale:"tr",features:{welcome_screen:!0,member_screening:!1,discovery:!1}}),[o,n]=u.useState([]),[g,R]=u.useState([]),[N,_]=u.useState([]),[C,S]=u.useState(!0),[k,b]=u.useState(!1),[m,v]=u.useState("general");u.useEffect(()=>{F(),T()},[]);const F=async()=>{try{const t=localStorage.getItem("access_token"),s=await fetch(`${l}/servers/${c}/community/settings/`,{headers:{Authorization:`Bearer ${t}`}});if(s.ok){const i=await s.json();e(d=>({...d,...i})),n(i.rules||[]),R(i.screening_questions||[])}}catch(t){console.error("Fetch settings error:",t)}finally{S(!1)}},T=async()=>{try{const t=localStorage.getItem("access_token"),s=await fetch(`${l}/servers/${c}/channels/`,{headers:{Authorization:`Bearer ${t}`}});if(s.ok){const i=await s.json();_((i.channels||i||[]).filter(d=>d.type!=="category"))}}catch(t){console.error("Fetch channels error:",t)}},x=async()=>{b(!0);try{const t=localStorage.getItem("access_token");(await fetch(`${l}/servers/${c}/community/settings/`,{method:"PUT",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({...a,rules:o,screening_questions:g})})).ok&&f.success("âœ… Topluluk ayarlarÄ± kaydedildi")}catch(t){console.error("Save error:",t),f.error("Kaydetme baÅŸarÄ±sÄ±z")}finally{b(!1)}},$=()=>{n(t=>[...t,{id:Date.now(),title:"",description:""}])},w=(t,s,i)=>{n(d=>d.map(E=>E.id===t?{...E,[s]:i}:E))},K=t=>{n(s=>s.filter(i=>i.id!==t))},z=()=>{R(t=>[...t,{id:Date.now(),question:"",required:!1}])},A=(t,s,i)=>{R(d=>d.map(E=>E.id===t?{...E,[s]:i}:E))},j=t=>{R(s=>s.filter(i=>i.id!==t))},D=[{value:"none",label:"Yok",description:"Herkes mesaj gÃ¶nderebilir"},{value:"low",label:"DÃ¼ÅŸÃ¼k",description:"E-posta doÄŸrulamasÄ± gerekli"},{value:"medium",label:"Orta",description:"5 dakika kayÄ±tlÄ± olmalÄ±"},{value:"high",label:"YÃ¼ksek",description:"10 dakika sunucuda olmalÄ±"},{value:"highest",label:"En YÃ¼ksek",description:"Telefon doÄŸrulamasÄ± gerekli"}],q=[{value:"disabled",label:"KapalÄ±",description:"Ä°Ã§erik filtresi yok"},{value:"medium",label:"Orta",description:"RolsÃ¼z Ã¼yeler iÃ§in filtrele"},{value:"high",label:"YÃ¼ksek",description:"TÃ¼m mesajlarÄ± filtrele"}];return C?React.createElement("div",{className:"community-settings-overlay",onClick:r},React.createElement("div",{className:"community-settings-panel",onClick:t=>t.stopPropagation()},React.createElement("div",{className:"loading"},"YÃ¼kleniyor..."))):React.createElement("div",{className:"community-settings-overlay",onClick:r},React.createElement("div",{className:"community-settings-panel",onClick:t=>t.stopPropagation()},React.createElement("div",{className:"panel-header"},React.createElement("h2",null,React.createElement(G,null)," Topluluk AyarlarÄ±"),React.createElement("button",{className:"close-btn",onClick:r},React.createElement(p,null))),React.createElement("div",{className:"community-toggle"},React.createElement("div",{className:"toggle-info"},React.createElement("span",{className:"toggle-label"},"Topluluk Sunucusu"),React.createElement("span",{className:"toggle-description"},"Topluluk Ã¶zelliklerini aktifleÅŸtir (keÅŸfet, karÅŸÄ±lama ekranÄ± vb.)")),React.createElement("button",{className:`toggle-btn ${a.is_community?"active":""}`,onClick:()=>e(t=>({...t,is_community:!t.is_community}))},a.is_community?React.createElement(Q,null):React.createElement(Y,null))),React.createElement("div",{className:"tabs"},React.createElement("button",{className:`tab ${m==="general"?"active":""}`,onClick:()=>v("general")},React.createElement(O,null)," Genel"),React.createElement("button",{className:`tab ${m==="rules"?"active":""}`,onClick:()=>v("rules")},React.createElement(h,null)," Kurallar"),React.createElement("button",{className:`tab ${m==="screening"?"active":""}`,onClick:()=>v("screening")},React.createElement(L,null)," Ãœye Tarama"),React.createElement("button",{className:`tab ${m==="safety"?"active":""}`,onClick:()=>v("safety")},React.createElement(y,null)," GÃ¼venlik")),React.createElement("div",{className:"panel-content"},m==="general"&&React.createElement(U,{settings:a,setSettings:e,channels:N}),m==="rules"&&React.createElement(X,{rules:o,onAdd:$,onUpdate:w,onRemove:K}),m==="screening"&&React.createElement(Z,{questions:g,onAdd:z,onUpdate:A,onRemove:j}),m==="safety"&&React.createElement(W,{settings:a,setSettings:e,verificationLevels:D,contentFilters:q})),React.createElement("div",{className:"panel-footer"},React.createElement("button",{className:"cancel-btn",onClick:r},"Ä°ptal"),React.createElement("button",{className:"save-btn",onClick:x,disabled:k},React.createElement(P,null)," ",k?"Kaydediliyor...":"Kaydet"))))},U=({settings:l,setSettings:c,channels:r})=>React.createElement("div",{className:"settings-tab"},React.createElement("div",{className:"form-group"},React.createElement("label",null,"Sunucu AÃ§Ä±klamasÄ±"),React.createElement("textarea",{value:l.description,onChange:a=>c(e=>({...e,description:a.target.value})),placeholder:"Sunucunuz hakkÄ±nda kÄ±sa bir aÃ§Ä±klama...",rows:"3",maxLength:300}),React.createElement("span",{className:"char-count"},l.description?.length||0,"/300")),React.createElement("div",{className:"form-row"},React.createElement("div",{className:"form-group"},React.createElement("label",null,React.createElement(h,null)," Kurallar KanalÄ±"),React.createElement("select",{value:l.rules_channel_id,onChange:a=>c(e=>({...e,rules_channel_id:a.target.value}))},React.createElement("option",{value:""},"SeÃ§in..."),r.map(a=>React.createElement("option",{key:a.id,value:a.id},"#",a.name)))),React.createElement("div",{className:"form-group"},React.createElement("label",null,React.createElement(B,null)," GÃ¼ncellemeler KanalÄ±"),React.createElement("select",{value:l.public_updates_channel_id,onChange:a=>c(e=>({...e,public_updates_channel_id:a.target.value}))},React.createElement("option",{value:""},"SeÃ§in..."),r.map(a=>React.createElement("option",{key:a.id,value:a.id},"#",a.name))))),React.createElement("div",{className:"form-row"},React.createElement("div",{className:"form-group"},React.createElement("label",null,React.createElement(H,null)," Tercih Edilen Dil"),React.createElement("select",{value:l.preferred_locale,onChange:a=>c(e=>({...e,preferred_locale:a.target.value}))},React.createElement("option",{value:"tr"},"ðŸ‡¹ðŸ‡· TÃ¼rkÃ§e"),React.createElement("option",{value:"en"},"ðŸ‡¬ðŸ‡§ English"),React.createElement("option",{value:"de"},"ðŸ‡©ðŸ‡ª Deutsch"),React.createElement("option",{value:"fr"},"ðŸ‡«ðŸ‡· FranÃ§ais"))),React.createElement("div",{className:"form-group"},React.createElement("label",null,React.createElement(V,null)," VarsayÄ±lan Bildirimler"),React.createElement("select",{value:l.default_notifications,onChange:a=>c(e=>({...e,default_notifications:a.target.value}))},React.createElement("option",{value:"all"},"TÃ¼m Mesajlar"),React.createElement("option",{value:"mentions"},"Sadece Etiketler")))),React.createElement("div",{className:"feature-toggles"},React.createElement("h4",null,"Ã–zellikler"),React.createElement("label",{className:"feature-item"},React.createElement("span",null,"KarÅŸÄ±lama EkranÄ±"),React.createElement("input",{type:"checkbox",checked:l.features?.welcome_screen,onChange:a=>c(e=>({...e,features:{...e.features,welcome_screen:a.target.checked}}))})),React.createElement("label",{className:"feature-item"},React.createElement("span",null,"Ãœye Tarama"),React.createElement("input",{type:"checkbox",checked:l.features?.member_screening,onChange:a=>c(e=>({...e,features:{...e.features,member_screening:a.target.checked}}))})),React.createElement("label",{className:"feature-item"},React.createElement("span",null,"Sunucu KeÅŸfet"),React.createElement("input",{type:"checkbox",checked:l.features?.discovery,onChange:a=>c(e=>({...e,features:{...e.features,discovery:a.target.checked}}))})))),X=({rules:l,onAdd:c,onUpdate:r,onRemove:a})=>React.createElement("div",{className:"settings-tab"},React.createElement("div",{className:"tab-header"},React.createElement("h4",null,"Sunucu KurallarÄ±"),React.createElement("button",{className:"add-btn",onClick:c},"+ Kural Ekle")),l.length===0?React.createElement("div",{className:"empty-rules"},React.createElement(I,null),React.createElement("p",null,"HenÃ¼z kural eklenmemiÅŸ")):React.createElement("div",{className:"rules-list"},l.map((e,o)=>React.createElement("div",{key:e.id,className:"rule-item"},React.createElement("span",{className:"rule-number"},o+1),React.createElement("div",{className:"rule-content"},React.createElement("input",{type:"text",placeholder:"Kural baÅŸlÄ±ÄŸÄ±...",value:e.title,onChange:n=>r(e.id,"title",n.target.value)}),React.createElement("textarea",{placeholder:"Kural aÃ§Ä±klamasÄ±...",value:e.description,onChange:n=>r(e.id,"description",n.target.value),rows:"2"})),React.createElement("button",{className:"remove-btn",onClick:()=>a(e.id)},React.createElement(p,null)))))),Z=({questions:l,onAdd:c,onUpdate:r,onRemove:a})=>React.createElement("div",{className:"settings-tab"},React.createElement("div",{className:"tab-header"},React.createElement("h4",null,"Ãœye Tarama SorularÄ±"),React.createElement("button",{className:"add-btn",onClick:c},"+ Soru Ekle")),React.createElement("p",{className:"tab-description"},"Yeni Ã¼yeler sunucuya katÄ±lmadan Ã¶nce bu sorularÄ± yanÄ±tlamalÄ±dÄ±r."),l.length===0?React.createElement("div",{className:"empty-rules"},React.createElement(J,null),React.createElement("p",null,"HenÃ¼z soru eklenmemiÅŸ")):React.createElement("div",{className:"questions-list"},l.map((e,o)=>React.createElement("div",{key:e.id,className:"question-item"},React.createElement("span",{className:"question-number"},o+1),React.createElement("div",{className:"question-content"},React.createElement("input",{type:"text",placeholder:"Soruyu yazÄ±n...",value:e.question,onChange:n=>r(e.id,"question",n.target.value)}),React.createElement("label",{className:"required-toggle"},React.createElement("input",{type:"checkbox",checked:e.required,onChange:n=>r(e.id,"required",n.target.checked)}),React.createElement("span",null,"Zorunlu"))),React.createElement("button",{className:"remove-btn",onClick:()=>a(e.id)},React.createElement(p,null)))))),W=({settings:l,setSettings:c,verificationLevels:r,contentFilters:a})=>React.createElement("div",{className:"settings-tab"},React.createElement("div",{className:"form-group"},React.createElement("label",null,React.createElement(y,null)," DoÄŸrulama Seviyesi"),React.createElement("div",{className:"level-options"},r.map(e=>React.createElement("label",{key:e.value,className:`level-option ${l.verification_level===e.value?"selected":""}`},React.createElement("input",{type:"radio",name:"verification",value:e.value,checked:l.verification_level===e.value,onChange:o=>c(n=>({...n,verification_level:o.target.value}))}),React.createElement("div",{className:"level-info"},React.createElement("span",{className:"level-label"},e.label),React.createElement("span",{className:"level-desc"},e.description)))))),React.createElement("div",{className:"form-group"},React.createElement("label",null,React.createElement(M,null)," Ä°Ã§erik Filtresi"),React.createElement("div",{className:"level-options"},a.map(e=>React.createElement("label",{key:e.value,className:`level-option ${l.explicit_content_filter===e.value?"selected":""}`},React.createElement("input",{type:"radio",name:"content-filter",value:e.value,checked:l.explicit_content_filter===e.value,onChange:o=>c(n=>({...n,explicit_content_filter:o.target.value}))}),React.createElement("div",{className:"level-info"},React.createElement("span",{className:"level-label"},e.label),React.createElement("span",{className:"level-desc"},e.description)))))));export{te as default};
