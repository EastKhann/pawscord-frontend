import{r as l,A as F,l as T,aI as z,b$ as L,v as I,V as D,o as j,a5 as N}from"./react-core-B6hadH-M.js";import{t as a}from"./index-D_6pZib5.js";const A=({fetchWithAuth:n,apiBaseUrl:c,onClose:h,roomSlug:i})=>{const[y,R]=l.useState([]),[u,v]=l.useState([]),[E,b]=l.useState(!1),[x,d]=l.useState(!1),[p,k]=l.useState(null),[r,s]=l.useState({name:"",url:"",events:[]}),w=["message.created","message.updated","message.deleted","member.joined","member.left","member.updated","channel.created","channel.updated","channel.deleted","role.created","role.updated","role.deleted"];l.useEffect(()=>{m()},[i]);const m=async()=>{b(!0);try{const o=await(await n(`${c}/rooms/${i}/webhooks/`)).json();R(o.webhooks||[])}catch{a.error("Failed to load webhooks")}finally{b(!1)}},g=async t=>{try{const f=await(await n(`${c}/webhooks/${t}/deliveries/`)).json();v(f.deliveries||[]),k(t)}catch{a.error("Failed to load delivery logs")}},C=async()=>{if(!r.name||!r.url){a.error("Name and URL are required");return}try{await n(`${c}/webhooks/create/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...r,room_slug:i})}),a.success("Webhook created successfully"),d(!1),s({name:"",url:"",events:[]}),m()}catch{a.error("Failed to create webhook")}},S=async t=>{if(confirm("Are you sure you want to delete this webhook?"))try{await n(`${c}/webhooks/${t}/delete/`,{method:"DELETE"}),a.success("Webhook deleted successfully"),m()}catch{a.error("Failed to delete webhook")}},B=async t=>{try{await n(`${c}/webhook/deliveries/retry/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({delivery_id:t})}),a.success("Delivery retried successfully"),p&&g(p)}catch{a.error("Failed to retry delivery")}},W=t=>{s(o=>({...o,events:o.events.includes(t)?o.events.filter(f=>f!==t):[...o.events,t]}))};return React.createElement("div",{style:e.overlay},React.createElement("div",{style:e.modal},React.createElement("div",{style:e.header},React.createElement("div",{style:e.headerLeft},React.createElement(F,{style:{marginRight:"10px",color:"#5865f2"}}),React.createElement("h2",{style:e.title},"Channel Webhooks")),React.createElement("button",{onClick:h,style:e.closeButton},React.createElement(T,null))),React.createElement("div",{style:e.content},E?React.createElement("div",{style:e.loading},"Loading webhooks..."):React.createElement(React.Fragment,null,React.createElement("div",{style:e.section},React.createElement("div",{style:e.sectionHeader},React.createElement("h3",{style:e.sectionTitle},"Webhooks"),React.createElement("button",{onClick:()=>d(!x),style:e.addButton},React.createElement(z,{style:{marginRight:"5px"}}),"Create Webhook")),x&&React.createElement("div",{style:e.createForm},React.createElement("div",{style:e.formGroup},React.createElement("label",{style:e.label},"Webhook Name"),React.createElement("input",{type:"text",value:r.name,onChange:t=>s({...r,name:t.target.value}),placeholder:"My Webhook",style:e.input})),React.createElement("div",{style:e.formGroup},React.createElement("label",{style:e.label},"Payload URL"),React.createElement("input",{type:"url",value:r.url,onChange:t=>s({...r,url:t.target.value}),placeholder:"https://example.com/webhook",style:e.input})),React.createElement("div",{style:e.formGroup},React.createElement("label",{style:e.label},"Events to Subscribe"),React.createElement("div",{style:e.eventsGrid},w.map(t=>React.createElement("label",{key:t,style:e.eventCheckbox},React.createElement("input",{type:"checkbox",checked:r.events.includes(t),onChange:()=>W(t)}),React.createElement("span",{style:e.eventLabel},t))))),React.createElement("div",{style:e.formActions},React.createElement("button",{onClick:C,style:e.createButton},"Create Webhook"),React.createElement("button",{onClick:()=>d(!1),style:e.cancelButton},"Cancel"))),React.createElement("div",{style:e.webhooksList},y.length===0?React.createElement("div",{style:e.empty},"No webhooks configured for this channel"):y.map(t=>React.createElement("div",{key:t.id,style:e.webhookCard},React.createElement("div",{style:e.webhookHeader},React.createElement("div",null,React.createElement("div",{style:e.webhookName},t.name),React.createElement("div",{style:e.webhookUrl},t.url),React.createElement("div",{style:e.webhookEvents},t.events?.join(", ")||"All events")),React.createElement("div",{style:e.webhookActions},React.createElement("button",{onClick:()=>g(t.id),style:e.iconButton,title:"View Deliveries"},React.createElement(L,null)),React.createElement("button",{onClick:()=>S(t.id),style:{...e.iconButton,color:"#f04747"},title:"Delete Webhook"},React.createElement(I,null)))))))),p&&React.createElement("div",{style:e.section},React.createElement("h3",{style:e.sectionTitle},"Recent Deliveries"),React.createElement("div",{style:e.deliveriesList},u.length===0?React.createElement("div",{style:e.empty},"No deliveries yet"):u.map(t=>React.createElement("div",{key:t.id,style:e.deliveryCard},React.createElement("div",{style:e.deliveryHeader},React.createElement("div",{style:e.deliveryStatus},t.status==="success"?React.createElement(D,{style:{color:"#43b581"}}):React.createElement(j,{style:{color:"#f04747"}}),React.createElement("span",{style:e.deliveryStatusText},t.status==="success"?"Success":"Failed")),React.createElement("div",{style:e.deliveryTime},new Date(t.delivered_at).toLocaleString())),React.createElement("div",{style:e.deliveryBody},React.createElement("div",{style:e.deliveryInfo},React.createElement("strong",null,"Event:")," ",t.event_type),React.createElement("div",{style:e.deliveryInfo},React.createElement("strong",null,"Response Code:")," ",t.response_code||"N/A"),t.error&&React.createElement("div",{style:e.deliveryError},React.createElement("strong",null,"Error:")," ",t.error)),t.status==="failed"&&React.createElement("button",{onClick:()=>B(t.id),style:e.retryButton},React.createElement(N,{style:{marginRight:"5px"}}),"Retry")))))))))},e={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999},modal:{backgroundColor:"#1e1e1e",borderRadius:"8px",width:"90%",maxWidth:"900px",maxHeight:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #2c2f33"},headerLeft:{display:"flex",alignItems:"center"},title:{margin:0,fontSize:"20px",color:"#ffffff"},closeButton:{background:"none",border:"none",color:"#99aab5",cursor:"pointer",fontSize:"20px",padding:"5px"},content:{padding:"20px",overflowY:"auto",flex:1},loading:{textAlign:"center",color:"#99aab5",padding:"40px"},section:{marginBottom:"24px"},sectionHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},sectionTitle:{margin:0,fontSize:"16px",color:"#ffffff",fontWeight:"600"},addButton:{padding:"8px 16px",backgroundColor:"#5865f2",border:"none",borderRadius:"4px",color:"#ffffff",cursor:"pointer",fontSize:"14px",display:"flex",alignItems:"center"},createForm:{backgroundColor:"#2c2f33",borderRadius:"6px",padding:"20px",marginBottom:"16px"},formGroup:{marginBottom:"16px"},label:{display:"block",color:"#dcddde",fontSize:"14px",marginBottom:"8px",fontWeight:"500"},input:{width:"100%",padding:"10px",backgroundColor:"#1e1e1e",border:"1px solid #2c2f33",borderRadius:"4px",color:"#ffffff",fontSize:"14px"},eventsGrid:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"8px"},eventCheckbox:{display:"flex",alignItems:"center",gap:"8px",color:"#dcddde",fontSize:"14px",cursor:"pointer"},eventLabel:{userSelect:"none"},formActions:{display:"flex",gap:"10px",justifyContent:"flex-end"},createButton:{padding:"10px 20px",backgroundColor:"#43b581",border:"none",borderRadius:"4px",color:"#ffffff",cursor:"pointer",fontSize:"14px",fontWeight:"500"},cancelButton:{padding:"10px 20px",backgroundColor:"#4f545c",border:"none",borderRadius:"4px",color:"#ffffff",cursor:"pointer",fontSize:"14px"},webhooksList:{display:"flex",flexDirection:"column",gap:"12px"},empty:{textAlign:"center",color:"#99aab5",padding:"40px"},webhookCard:{backgroundColor:"#2c2f33",borderRadius:"6px",padding:"16px"},webhookHeader:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},webhookName:{fontSize:"16px",fontWeight:"600",color:"#ffffff",marginBottom:"4px"},webhookUrl:{fontSize:"13px",color:"#5865f2",marginBottom:"4px",wordBreak:"break-all"},webhookEvents:{fontSize:"12px",color:"#99aab5"},webhookActions:{display:"flex",gap:"8px"},iconButton:{background:"none",border:"none",color:"#99aab5",cursor:"pointer",fontSize:"16px",padding:"5px"},deliveriesList:{display:"flex",flexDirection:"column",gap:"12px",maxHeight:"300px",overflowY:"auto"},deliveryCard:{backgroundColor:"#2c2f33",borderRadius:"6px",padding:"12px"},deliveryHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},deliveryStatus:{display:"flex",alignItems:"center",gap:"8px"},deliveryStatusText:{fontSize:"14px",fontWeight:"600",color:"#ffffff"},deliveryTime:{fontSize:"12px",color:"#99aab5"},deliveryBody:{display:"flex",flexDirection:"column",gap:"4px",fontSize:"13px",color:"#dcddde"},deliveryInfo:{display:"flex",gap:"8px"},deliveryError:{color:"#f04747",marginTop:"4px"},retryButton:{marginTop:"12px",padding:"6px 12px",backgroundColor:"#5865f2",border:"none",borderRadius:"4px",color:"#ffffff",cursor:"pointer",fontSize:"12px",display:"flex",alignItems:"center"}};export{A as default};
