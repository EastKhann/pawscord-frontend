import{r as i,d as e,c9 as o}from"./react-core-DrOm_csO.js";import{g as z}from"./index-BYhWpPLp.js";const T=({serverId:l,onClose:k})=>{const[d,p]=i.useState([]),[b,g]=i.useState(!1),[K,f]=i.useState(null),[n,s]=i.useState({name:"",description:"",response:"",trigger_type:"exact",enabled:!0,cooldown:0,permissions:"everyone",delete_trigger:!1,embed:!1,embed_color:"#5865f2"}),[N,y]=i.useState(!0),[E,C]=i.useState(null),c=z();i.useEffect(()=>{l&&(v(),h())},[l]);const v=async()=>{try{const t=localStorage.getItem("access_token"),a=await fetch(`${c}/commands/server/${l}/`,{headers:{Authorization:`Bearer ${t}`}});if(a.ok){const r=await a.json();p(r.commands||[])}}catch(t){console.error("Error fetching commands:",t)}finally{y(!1)}},h=async()=>{try{const t=localStorage.getItem("access_token"),a=await fetch(`${c}/commands/server/${l}/stats/`,{headers:{Authorization:`Bearer ${t}`}});if(a.ok){const r=await a.json();C(r)}}catch(t){console.error("Error fetching stats:",t)}},w=async()=>{if(!n.name||!n.response){o.error("âŒ Komut adÄ± ve yanÄ±t zorunludur");return}try{const t=localStorage.getItem("access_token"),a=await fetch(`${c}/commands/create/`,{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({server_id:l,...n})});if(a.ok){const r=await a.json();p([...d,r.command]),s({name:"",description:"",response:"",trigger_type:"exact",enabled:!0,cooldown:0,permissions:"everyone",delete_trigger:!1,embed:!1,embed_color:"#5865f2"}),g(!1),o.success("âœ… Komut oluÅŸturuldu"),h()}else o.error("âŒ Komut oluÅŸturulamadÄ±")}catch(t){console.error("Error creating command:",t),o.error("âŒ BaÄŸlantÄ± hatasÄ±")}},_=async t=>{if(window.confirm("Bu komutu silmek istediÄŸinizden emin misiniz?"))try{const a=localStorage.getItem("access_token");(await fetch(`${c}/commands/${t}/delete/`,{method:"DELETE",headers:{Authorization:`Bearer ${a}`}})).ok?(p(d.filter(u=>u.id!==t)),o.success("âœ… Komut silindi"),h()):o.error("âŒ Komut silinemedi")}catch(a){console.error("Error deleting command:",a),o.error("âŒ BaÄŸlantÄ± hatasÄ±")}},$=async(t,a)=>{try{const r=localStorage.getItem("access_token");(await fetch(`${c}/commands/${t}/toggle/`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"},body:JSON.stringify({enabled:a})})).ok&&(p(d.map(m=>m.id===t?{...m,enabled:a}:m)),o.success(`âœ… Komut ${a?"etkinleÅŸtirildi":"devre dÄ±ÅŸÄ± bÄ±rakÄ±ldÄ±"}`))}catch(r){console.error("Error toggling command:",r),o.error("âŒ Ä°ÅŸlem baÅŸarÄ±sÄ±z")}},S=async()=>{try{const t=localStorage.getItem("access_token"),a=await fetch(`${c}/commands/server/${l}/export/`,{headers:{Authorization:`Bearer ${t}`}});if(a.ok){const r=await a.blob(),u=window.URL.createObjectURL(r),m=document.createElement("a");m.href=u,m.download=`commands_${l}.json`,m.click(),o.success("âœ… Komutlar dÄ±ÅŸa aktarÄ±ldÄ±")}}catch(t){console.error("Error exporting commands:",t),o.error("âŒ DÄ±ÅŸa aktarma baÅŸarÄ±sÄ±z")}},x=async t=>{const a=new FormData;a.append("file",t),a.append("server_id",l);try{const r=localStorage.getItem("access_token");(await fetch(`${c}/commands/import/`,{method:"POST",headers:{Authorization:`Bearer ${r}`},body:a})).ok?(v(),o.success("âœ… Komutlar iÃ§e aktarÄ±ldÄ±")):o.error("âŒ Ä°Ã§e aktarma baÅŸarÄ±sÄ±z")}catch(r){console.error("Error importing commands:",r),o.error("âŒ BaÄŸlantÄ± hatasÄ±")}};return N?e.createElement("div",{className:"custom-commands-overlay"},e.createElement("div",{className:"custom-commands-panel"},e.createElement("div",{className:"loading-state"},e.createElement("div",{className:"spinner"}),e.createElement("p",null,"Komutlar yÃ¼kleniyor...")))):e.createElement("div",{className:"custom-commands-overlay",onClick:k},e.createElement("div",{className:"custom-commands-panel",onClick:t=>t.stopPropagation()},e.createElement("div",{className:"commands-header"},e.createElement("h2",null,"âš¡ Ã–zel Komutlar"),e.createElement("button",{className:"close-btn",onClick:k},"Ã—")),e.createElement("div",{className:"commands-content"},E&&e.createElement("div",{className:"stats-overview"},e.createElement("div",{className:"stat-card"},e.createElement("span",{className:"stat-value"},E.total_commands||0),e.createElement("span",{className:"stat-label"},"Toplam Komut")),e.createElement("div",{className:"stat-card"},e.createElement("span",{className:"stat-value"},E.enabled_commands||0),e.createElement("span",{className:"stat-label"},"Aktif")),e.createElement("div",{className:"stat-card"},e.createElement("span",{className:"stat-value"},E.total_uses||0),e.createElement("span",{className:"stat-label"},"KullanÄ±m"))),e.createElement("div",{className:"action-buttons"},e.createElement("button",{className:"create-btn",onClick:()=>g(!0)},"â• Yeni Komut"),e.createElement("button",{className:"export-btn",onClick:S},"ğŸ“¤ DÄ±ÅŸa Aktar"),e.createElement("label",{className:"import-btn"},"ğŸ“¥ Ä°Ã§e Aktar",e.createElement("input",{type:"file",accept:".json",onChange:t=>t.target.files[0]&&x(t.target.files[0]),style:{display:"none"}}))),b&&e.createElement("div",{className:"command-form"},e.createElement("h3",null,"Yeni Komut OluÅŸtur"),e.createElement("div",{className:"form-grid"},e.createElement("div",{className:"form-group"},e.createElement("label",null,"Komut AdÄ± *"),e.createElement("input",{type:"text",placeholder:"!komut",value:n.name,onChange:t=>s({...n,name:t.target.value})})),e.createElement("div",{className:"form-group"},e.createElement("label",null,"AÃ§Ä±klama"),e.createElement("input",{type:"text",placeholder:"Komut aÃ§Ä±klamasÄ±",value:n.description,onChange:t=>s({...n,description:t.target.value})})),e.createElement("div",{className:"form-group full-width"},e.createElement("label",null,"YanÄ±t *"),e.createElement("textarea",{placeholder:"Komut yanÄ±tÄ± (deÄŸiÅŸkenler: {user}, {server}, {channel})",value:n.response,onChange:t=>s({...n,response:t.target.value}),rows:3})),e.createElement("div",{className:"form-group"},e.createElement("label",null,"Tetikleme Tipi"),e.createElement("select",{value:n.trigger_type,onChange:t=>s({...n,trigger_type:t.target.value})},e.createElement("option",{value:"exact"},"Tam EÅŸleÅŸme"),e.createElement("option",{value:"contains"},"Ä°Ã§erir"),e.createElement("option",{value:"starts_with"},"Ä°le BaÅŸlar"),e.createElement("option",{value:"regex"},"Regex"))),e.createElement("div",{className:"form-group"},e.createElement("label",null,"Ä°zinler"),e.createElement("select",{value:n.permissions,onChange:t=>s({...n,permissions:t.target.value})},e.createElement("option",{value:"everyone"},"Herkes"),e.createElement("option",{value:"mods"},"ModeratÃ¶rler"),e.createElement("option",{value:"admins"},"Adminler"))),e.createElement("div",{className:"form-group"},e.createElement("label",null,"Cooldown (saniye)"),e.createElement("input",{type:"number",min:"0",max:"300",value:n.cooldown,onChange:t=>s({...n,cooldown:parseInt(t.target.value)})})),e.createElement("div",{className:"form-group"},e.createElement("label",{className:"checkbox-label"},e.createElement("input",{type:"checkbox",checked:n.delete_trigger,onChange:t=>s({...n,delete_trigger:t.target.checked})}),"Tetikleyici mesajÄ± sil")),e.createElement("div",{className:"form-group"},e.createElement("label",{className:"checkbox-label"},e.createElement("input",{type:"checkbox",checked:n.embed,onChange:t=>s({...n,embed:t.target.checked})}),"Embed olarak gÃ¶nder")),n.embed&&e.createElement("div",{className:"form-group"},e.createElement("label",null,"Embed Rengi"),e.createElement("input",{type:"color",value:n.embed_color,onChange:t=>s({...n,embed_color:t.target.value})}))),e.createElement("div",{className:"form-actions"},e.createElement("button",{className:"cancel-btn",onClick:()=>g(!1)},"Ä°ptal"),e.createElement("button",{className:"submit-btn",onClick:w},"OluÅŸtur"))),e.createElement("div",{className:"commands-list"},d.length>0?d.map(t=>e.createElement("div",{key:t.id,className:`command-card ${t.enabled?"":"disabled"}`},e.createElement("div",{className:"command-header"},e.createElement("div",{className:"command-info"},e.createElement("h4",null,t.name),t.description&&e.createElement("p",null,t.description)),e.createElement("label",{className:"toggle-switch"},e.createElement("input",{type:"checkbox",checked:t.enabled,onChange:a=>$(t.id,a.target.checked)}),e.createElement("span",{className:"slider"}))),e.createElement("div",{className:"command-response"},e.createElement("strong",null,"YanÄ±t:")," ",t.response),e.createElement("div",{className:"command-meta"},e.createElement("span",{className:"meta-item"},"ğŸ¯ ",t.trigger_type),e.createElement("span",{className:"meta-item"},"ğŸ‘¥ ",t.permissions),t.cooldown>0&&e.createElement("span",{className:"meta-item"},"â±ï¸ ",t.cooldown,"s"),e.createElement("span",{className:"meta-item"},"ğŸ“Š ",t.use_count||0," kullanÄ±m")),e.createElement("div",{className:"command-actions"},e.createElement("button",{className:"edit-btn",onClick:()=>f(t.id)},"âœï¸"),e.createElement("button",{className:"delete-btn",onClick:()=>_(t.id)},"ğŸ—‘ï¸")))):!b&&e.createElement("div",{className:"empty-state"},e.createElement("div",{className:"empty-icon"},"âš¡"),e.createElement("h3",null,"HenÃ¼z Ã¶zel komut yok"),e.createElement("p",null,"Sunucunuz iÃ§in Ã¶zel komutlar oluÅŸturun"))))))};export{T as default};
