var o=Object.defineProperty;var d=(e,t)=>o(e,"name",{value:t,configurable:!0});import{r as i,a as R,j as h}from"./react-core-Djgtqrmb.js";import{q as y,V as I}from"./perf-vendor-BfRgZ-u9.js";const m=i.memo(({index:e,style:t,data:s})=>{const{messages:r,renderMessage:a,setItemSize:c,getItemSize:u}=s,l=i.useRef();i.useEffect(()=>{if(l.current){const n=l.current.getBoundingClientRect().height;n!==u(e)&&c(e,n)}},[e,u,c]);const f=r[e];return f?h.jsx("div",{style:t,ref:l,children:a(f,e)}):null},(e,t)=>e.index===t.index&&e.style.top===t.style.top&&e.style.height===t.style.height&&e.data.messages[e.index]?.id===t.data.messages[t.index]?.id&&e.data.messages[e.index]?.content===t.data.messages[t.index]?.content&&e.data.messages[e.index]?.reactions?.length===t.data.messages[t.index]?.reactions?.length);m.displayName="VirtualMessageRow";const S=i.memo(({messages:e,renderMessage:t,scrollToBottom:s=!1,estimatedItemSize:r=80})=>{const a=i.useRef(),c=i.useRef({}),u=i.useCallback(n=>c.current[n]||r,[r]),l=i.useCallback((n,g)=>{c.current[n]!==g&&(c.current[n]=g,a.current&&a.current.resetAfterIndex(n,!1))},[]);i.useEffect(()=>{s&&a.current&&e.length>0&&requestAnimationFrame(()=>{a.current?.scrollToItem(e.length-1,"end")})},[e.length,s]),i.useEffect(()=>{e.length===0&&(c.current={})},[e.length]);const f=R.useMemo(()=>({messages:e,renderMessage:t,setItemSize:l,getItemSize:u}),[e,t,l,u]);return!e||e.length===0?null:h.jsx(y,{children:d(({height:n,width:g})=>h.jsx(I,{ref:a,height:n,width:g,itemCount:e.length,itemSize:u,itemData:f,overscanCount:3,useIsScrolling:!0,children:m}),"children")})});S.displayName="VirtualMessageList";export{S as default};
