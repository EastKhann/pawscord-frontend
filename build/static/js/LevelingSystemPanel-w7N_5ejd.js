import{r as v,n as e}from"./react-core-DA61mcWm.js";import{y as d}from"./ui-vendor-BrUQ4r0A.js";import{h as R,g as P}from"./index-wBOWb2zj.js";import"./editor-vendor-D9c4a6XZ.js";import"./media-vendor-tDmQW26m.js";import"./router-vendor-2etVlp2q.js";import"./icons-vendor-l2qVv93x.js";import"./state-vendor-CjqIs3K2.js";import"./crypto-vendor-DiGIAuUm.js";const X={enabled:!1,xp_per_message:15,xp_cooldown:60,level_up_message:"Tebrikler {user}! Seviye {level} oldun! ðŸŽ‰",announce_channel_id:"",stack_roles:!1,reset_on_leave:!1},A=n=>n===1?"#fbbf24":n===2?"#c0c0c0":n===3?"#cd7f32":"#6366f1",E=n=>{const t=100-n;return Math.max(1,Math.floor((-50+Math.sqrt(2500-20*t))/10))},C=n=>5*n**2+50*n+100,z=n=>{const[c,s]=v.useState(X),[t,h]=v.useState([]),[o,r]=v.useState({level:1,role_id:""}),[x,u]=v.useState([]),[p,g]=v.useState([]),[f,j]=v.useState([]),[b,y]=v.useState(!0),a=P(),m=()=>({Authorization:`Bearer ${localStorage.getItem("access_token")}`}),k=()=>({...m(),"Content-Type":"application/json"}),S=async()=>{try{const l=await fetch(`${a}/leveling/server/${n}/config/`,{headers:m()});if(l.ok){const i=await l.json();i.config&&s(i.config)}}catch{}finally{y(!1)}},N=async()=>{try{const l=await fetch(`${a}/leveling/server/${n}/roles/`,{headers:m()});if(l.ok){const i=await l.json();h(i.roles||[])}}catch{}},w=async()=>{try{const l=await fetch(`${a}/servers/${n}/roles/`,{headers:m()});if(l.ok){const i=await l.json();u(i.roles||[])}}catch{}},$=async()=>{try{const l=await fetch(`${a}/servers/${n}/channels/`,{headers:m()});if(l.ok){const i=await l.json();g(i.channels||[])}}catch{}},_=async()=>{try{const l=await fetch(`${a}/leveling/server/${n}/leaderboard/`,{headers:m()});if(l.ok){const i=await l.json();j(i.leaderboard||[])}}catch{}};return v.useEffect(()=>{n&&(S(),N(),w(),$(),_())},[n]),{config:c,updateConfig:(l,i)=>s({...c,[l]:i}),levelRoles:t,newRole:o,setNewRole:r,roles:x,channels:p,leaderboard:f,loading:b,saveConfig:async()=>{try{(await fetch(`${a}/leveling/server/${n}/config/update/`,{method:"POST",headers:k(),body:JSON.stringify(c)})).ok?d.success("âœ… Ayarlar kaydedildi"):d.error("âŒ Kaydetme baÅŸarÄ±sÄ±z")}catch{d.error("âŒ Hata oluÅŸtu")}},addLevelRole:async()=>{if(!o.role_id){d.error("âš ï¸ Rol seÃ§in");return}try{(await fetch(`${a}/leveling/server/${n}/roles/add/`,{method:"POST",headers:k(),body:JSON.stringify(o)})).ok&&(N(),r({level:1,role_id:""}),d.success("âœ… Rol eklendi"))}catch{d.error("âŒ Hata")}},removeLevelRole:async l=>{try{(await fetch(`${a}/leveling/server/${n}/roles/${l}/delete/`,{method:"DELETE",headers:m()})).ok&&(N(),d.success("âœ… Rol kaldÄ±rÄ±ldÄ±"))}catch{d.error("âŒ Hata")}},resetUserXP:async l=>{if(await R("Bu kullanÄ±cÄ±nÄ±n XP'sini sÄ±fÄ±rlamak istediÄŸinize emin misiniz?"))try{(await fetch(`${a}/leveling/server/${n}/user/${l}/reset/`,{method:"POST",headers:m()})).ok&&(_(),d.success("âœ… XP sÄ±fÄ±rlandÄ±"))}catch{d.error("âŒ Hata")}}}},H=({levelRoles:n,newRole:c,setNewRole:s,roles:t,addLevelRole:h,removeLevelRole:o})=>e.jsxs("div",{className:"level-roles-section",children:[e.jsxs("h3",{children:["ðŸŽ¯"," Seviye Rolleri"]}),e.jsxs("div",{className:"add-role-form",children:[e.jsx("input",{type:"number",min:"1",max:"100",value:c.level,onChange:r=>s({...c,level:parseInt(r.target.value)||1}),placeholder:"Seviye",className:"level-input"}),e.jsxs("select",{value:c.role_id,onChange:r=>s({...c,role_id:r.target.value}),className:"role-select",children:[e.jsxs("option",{value:"",children:["Rol se","Ã§","in"]}),t.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]}),e.jsxs("button",{className:"add-role-btn",onClick:h,children:["âž•"," Ekle"]})]}),n.length>0?e.jsx("div",{className:"level-roles-list",children:n.map(r=>e.jsxs("div",{className:"level-role-item",children:[e.jsxs("span",{className:"level-badge",children:["Lv. ",r.level]}),e.jsx("span",{className:"role-name",children:r.role_name||"Rol"}),e.jsx("button",{className:"remove-role-btn",onClick:()=>o(r.id),children:"âœ–"})]},r.id))}):e.jsxs("p",{className:"no-data",children:["Hen","Ã¼","z seviye rol","Ã¼"," yok"]})]}),T=({leaderboard:n,resetUserXP:c})=>e.jsxs("div",{className:"leaderboard-section",children:[e.jsxs("h3",{children:["ðŸ†"," S","Ä±","ralama"]}),n.length>0?e.jsx("div",{className:"leaderboard-list",children:n.map((s,t)=>{const h=t+1,o=E(s.xp),r=C(o+1),x=C(o),u=(s.xp-x)/(r-x)*100;return e.jsxs("div",{className:"leaderboard-item",children:[e.jsxs("span",{className:"rank",style:{color:A(h)},children:["#",h]}),e.jsx("img",{className:"user-avatar",src:s.avatar||`https://ui-avatars.com/api/?name=${s.username}`,alt:s.username}),e.jsxs("div",{className:"user-info",children:[e.jsx("span",{className:"username",children:s.username}),e.jsx("div",{className:"xp-bar-container",children:e.jsx("div",{className:"xp-bar",style:{width:`${Math.min(u,100)}%`,background:"linear-gradient(90deg, #5865f2, #7289da)"}})}),e.jsxs("span",{className:"xp-text",children:["Seviye ",o," ","â€¢"," ",s.xp," XP"]})]}),e.jsxs("button",{className:"reset-xp-btn",onClick:()=>c(s.user_id),children:["ðŸ”„"," S","Ä±","f","Ä±","rla"]})]},s.user_id)})}):e.jsxs("p",{className:"no-data",children:["Hen","Ã¼","z veri yok"]})]}),Z=({serverId:n,onClose:c})=>{const{config:s,updateConfig:t,levelRoles:h,newRole:o,setNewRole:r,roles:x,channels:u,leaderboard:p,loading:g,saveConfig:f,addLevelRole:j,removeLevelRole:b,resetUserXP:y}=z(n);return g?e.jsx("div",{className:"leveling-overlay",children:e.jsx("div",{className:"leveling-panel",children:e.jsxs("div",{className:"loading-state",children:[e.jsx("div",{className:"spinner"}),e.jsxs("p",{children:["Seviye sistemi y","Ã¼","kleniyor..."]})]})})}):e.jsx("div",{className:"leveling-overlay",onClick:c,children:e.jsxs("div",{className:"leveling-panel",onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{className:"leveling-header",children:[e.jsxs("h2",{children:["â­"," Seviye Sistemi"]}),e.jsx("button",{className:"close-btn",onClick:c,children:"Ã—"})]}),e.jsxs("div",{className:"leveling-content",children:[e.jsxs("div",{className:"config-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsxs("h3",{children:["âš™ï¸"," Genel Ayarlar"]}),e.jsxs("label",{className:"toggle-switch",children:[e.jsx("input",{type:"checkbox",checked:s.enabled,onChange:a=>t("enabled",a.target.checked)}),e.jsx("span",{className:"slider"}),e.jsx("span",{className:"toggle-label",children:s.enabled?"Aktif":"Pasif"})]})]}),e.jsxs("div",{className:"form-grid",children:[e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["Mesaj Ba","ÅŸÄ±","na XP"]}),e.jsx("input",{type:"number",min:"1",max:"100",value:s.xp_per_message,onChange:a=>t("xp_per_message",parseInt(a.target.value)),disabled:!s.enabled})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"XP Cooldown (saniye)"}),e.jsx("input",{type:"number",min:"0",max:"300",value:s.xp_cooldown,onChange:a=>t("xp_cooldown",parseInt(a.target.value)),disabled:!s.enabled})]}),e.jsxs("div",{className:"form-group full-width",children:[e.jsxs("label",{children:["Duyuru Kanal","Ä±"]}),e.jsxs("select",{value:s.announce_channel_id,onChange:a=>t("announce_channel_id",a.target.value),disabled:!s.enabled,children:[e.jsxs("option",{value:"",children:["Se","Ã§","iniz (opsiyonel)"]}),u.map(a=>e.jsxs("option",{value:a.id,children:["#",a.name]},a.id))]})]}),e.jsxs("div",{className:"form-group full-width",children:[e.jsxs("label",{children:["Seviye Atlama Mesaj","Ä±"]}),e.jsx("textarea",{value:s.level_up_message,onChange:a=>t("level_up_message",a.target.value),disabled:!s.enabled,rows:"2"}),e.jsxs("span",{className:"hint",children:["Kullan","Ä±","labilir: ","{user}",", ","{level}"]})]}),e.jsx("div",{className:"form-group",children:e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:s.stack_roles,onChange:a=>t("stack_roles",a.target.checked),disabled:!s.enabled}),e.jsxs("span",{children:["Rolleri biriktir (","Ã¶","nceki seviye rollerini kald","Ä±","rma)"]})]})}),e.jsx("div",{className:"form-group",children:e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:s.reset_on_leave,onChange:a=>t("reset_on_leave",a.target.checked),disabled:!s.enabled}),e.jsxs("span",{children:["Sunucudan ayr","Ä±","l","Ä±","nca XP'yi s","Ä±","f","Ä±","rla"]})]})})]}),e.jsxs("button",{className:"save-btn",onClick:f,children:["ðŸ’¾"," Ayarlar","Ä±"," Kaydet"]})]}),e.jsx(H,{levelRoles:h,newRole:o,setNewRole:r,roles:x,addLevelRole:j,removeLevelRole:b}),e.jsx(T,{leaderboard:p,resetUserXP:y})]})]})})};export{Z as default};
