import{r as c,d as e}from"./react-core-DrOm_csO.js";import{t as m}from"./index-BYhWpPLp.js";const j=({apiBaseUrl:N,onClose:v})=>{const[n,E]=c.useState([]),[f,b]=c.useState(!0),[s,o]=c.useState("all"),[C,h]=c.useState(null);c.useEffect(()=>{S()},[]);const S=async()=>{try{b(!0);const a=localStorage.getItem("access_token"),t=await fetch(`${N}/reports/list/`,{headers:{Authorization:`Bearer ${a}`}});if(t.ok){const r=await t.json();E(r.reports||[])}else m.error("‚ùå ≈ûikayetler y√ºklenemedi")}catch(a){console.error("Fetch reports error:",a),m.error("‚ùå Baƒülantƒ± hatasƒ±")}finally{b(!1)}},d=async(a,t,r="")=>{try{const i=localStorage.getItem("access_token"),u=await fetch(`${N}/reports/handle/${a}/`,{method:"POST",headers:{Authorization:`Bearer ${i}`,"Content-Type":"application/json"},body:JSON.stringify({action:t,reason:r})});if(u.ok){const k=await u.json();E(n.map(p=>p.id===a?{...p,status:t==="dismiss"?"dismissed":"resolved",resolution:t}:p)),h(null),m.success(`‚úÖ ${g(t)}`)}else{const k=await u.json();m.error(`‚ùå ${k.error||"ƒ∞≈ülem ba≈üarƒ±sƒ±z"}`)}}catch(i){console.error("Handle report error:",i),m.error("‚ùå Baƒülantƒ± hatasƒ±")}},g=a=>({ban:"Kullanƒ±cƒ± yasaklandƒ±",warn:"Kullanƒ±cƒ± uyarƒ±ldƒ±",delete_message:"Mesaj silindi",dismiss:"≈ûikayet reddedildi"})[a]||"ƒ∞≈ülem tamamlandƒ±",y=n.filter(a=>s==="all"?!0:s==="pending"?a.status==="pending":s==="resolved"?a.status==="resolved":s==="dismissed"?a.status==="dismissed":!0),w=a=>({pending:{label:"Bekliyor",className:"status-pending"},resolved:{label:"√á√∂z√ºld√º",className:"status-resolved"},dismissed:{label:"Reddedildi",className:"status-dismissed"}})[a]||{label:a,className:""},R=a=>({spam:{label:"Spam",className:"severity-low"},harassment:{label:"Taciz",className:"severity-high"},hate_speech:{label:"Nefret S√∂ylemi",className:"severity-critical"},inappropriate:{label:"Uygunsuz ƒ∞√ßerik",className:"severity-medium"},scam:{label:"Dolandƒ±rƒ±cƒ±lƒ±k",className:"severity-high"},other:{label:"Diƒüer",className:"severity-low"}})[a]||{label:a,className:""},B=a=>new Date(a).toLocaleString("tr-TR",{day:"2-digit",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}),l={total:n.length,pending:n.filter(a=>a.status==="pending").length,resolved:n.filter(a=>a.status==="resolved").length,dismissed:n.filter(a=>a.status==="dismissed").length};return e.createElement("div",{className:"reports-overlay",onClick:v},e.createElement("div",{className:"reports-panel",onClick:a=>a.stopPropagation()},e.createElement("div",{className:"reports-header"},e.createElement("h2",null,"üö® ≈ûikayet Y√∂netimi"),e.createElement("button",{className:"close-btn",onClick:v},"‚úï")),e.createElement("div",{className:"reports-stats"},e.createElement("div",{className:"stat-item"},e.createElement("span",{className:"stat-value"},l.total),e.createElement("span",{className:"stat-label"},"Toplam")),e.createElement("div",{className:"stat-item pending"},e.createElement("span",{className:"stat-value"},l.pending),e.createElement("span",{className:"stat-label"},"Bekliyor")),e.createElement("div",{className:"stat-item resolved"},e.createElement("span",{className:"stat-value"},l.resolved),e.createElement("span",{className:"stat-label"},"√á√∂z√ºld√º")),e.createElement("div",{className:"stat-item dismissed"},e.createElement("span",{className:"stat-value"},l.dismissed),e.createElement("span",{className:"stat-label"},"Reddedildi"))),e.createElement("div",{className:"reports-filters"},e.createElement("button",{className:s==="all"?"active":"",onClick:()=>o("all")},"T√ºm√º (",l.total,")"),e.createElement("button",{className:s==="pending"?"active":"",onClick:()=>o("pending")},"Bekliyor (",l.pending,")"),e.createElement("button",{className:s==="resolved"?"active":"",onClick:()=>o("resolved")},"√á√∂z√ºld√º (",l.resolved,")"),e.createElement("button",{className:s==="dismissed"?"active":"",onClick:()=>o("dismissed")},"Reddedildi (",l.dismissed,")")),e.createElement("div",{className:"reports-content"},f?e.createElement("div",{className:"loading-state"},e.createElement("div",{className:"spinner"}),e.createElement("p",null,"Y√ºkleniyor...")):y.length===0?e.createElement("div",{className:"empty-state"},e.createElement("div",{className:"empty-icon"},"üéâ"),e.createElement("h3",null,"≈ûikayet yok"),e.createElement("p",null,"Bu filtre i√ßin ≈üikayet bulunamadƒ±")):e.createElement("div",{className:"reports-list"},y.map(a=>{const t=w(a.status),r=R(a.reason);return e.createElement("div",{key:a.id,className:"report-card"},e.createElement("div",{className:"report-header"},e.createElement("div",{className:"report-meta"},e.createElement("span",{className:`status-badge ${t.className}`},t.label),e.createElement("span",{className:`severity-badge ${r.className}`},r.label)),e.createElement("span",{className:"report-date"},B(a.created_at))),e.createElement("div",{className:"report-body"},e.createElement("div",{className:"report-info"},e.createElement("div",{className:"info-row"},e.createElement("span",{className:"info-label"},"Bildiren:"),e.createElement("span",{className:"info-value"},"üë§ ",a.reporter_username)),e.createElement("div",{className:"info-row"},e.createElement("span",{className:"info-label"},"Bildirilen:"),e.createElement("span",{className:"info-value"},"‚ö†Ô∏è ",a.reported_user_username)),a.message_content&&e.createElement("div",{className:"info-row"},e.createElement("span",{className:"info-label"},"Mesaj:"),e.createElement("div",{className:"message-preview"},a.message_content))),a.description&&e.createElement("div",{className:"report-description"},e.createElement("strong",null,"A√ßƒ±klama:"),e.createElement("p",null,a.description))),a.status==="pending"?e.createElement("div",{className:"report-actions"},e.createElement("button",{className:"action-btn ban",onClick:()=>{const i=prompt("Yasaklama sebebi:");i&&d(a.id,"ban",i)},title:"Kullanƒ±cƒ±yƒ± Yasakla"},"üö´ Yasakla"),e.createElement("button",{className:"action-btn warn",onClick:()=>d(a.id,"warn","Uyarƒ± verildi"),title:"Kullanƒ±cƒ±yƒ± Uyar"},"‚ö†Ô∏è Uyar"),e.createElement("button",{className:"action-btn delete",onClick:()=>d(a.id,"delete_message","Mesaj silindi"),title:"Mesajƒ± Sil"},"üóëÔ∏è Mesajƒ± Sil"),e.createElement("button",{className:"action-btn dismiss",onClick:()=>d(a.id,"dismiss","Ge√ßersiz ≈üikayet"),title:"≈ûikayeti Reddet"},"‚úï Reddet")):e.createElement("div",{className:"report-resolution"},e.createElement("span",{className:"resolution-label"},"√á√∂z√ºm:"),e.createElement("span",{className:"resolution-value"},g(a.resolution))))})))))};export{j as default};
