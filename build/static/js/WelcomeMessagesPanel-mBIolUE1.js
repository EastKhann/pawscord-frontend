import{r as o,ch as r}from"./react-core-B6hadH-M.js";import{g as S}from"./index-D_6pZib5.js";const M=({serverId:s,onClose:d})=>{const[a,t]=o.useState({welcome_enabled:!1,welcome_channel_id:"",welcome_message:"HoÅŸ geldin {user}! {server} sunucusuna katÄ±ldÄ±n!",welcome_embed:!1,welcome_embed_color:"#5865f2",welcome_embed_title:"HoÅŸ Geldin!",welcome_embed_description:"{user} sunucuya katÄ±ldÄ±!",welcome_dm:!1,welcome_dm_message:"Merhaba {user}! {server} sunucusuna hoÅŸ geldin!",goodbye_enabled:!1,goodbye_channel_id:"",goodbye_message:"{user} sunucudan ayrÄ±ldÄ±. HoÅŸÃ§a kal!",goodbye_embed:!1,goodbye_embed_color:"#ed4245",auto_role_enabled:!1,auto_role_ids:[]}),[i,E]=o.useState([]),[_,R]=o.useState([]),[m,h]=o.useState(null),[p,w]=o.useState(!0),[$,x]=o.useState(null),n=S();o.useEffect(()=>{s&&(f(),y(),v(),b())},[s]);const f=async()=>{try{const e=localStorage.getItem("access_token"),c=await fetch(`${n}/welcome-messages/server/${s}/`,{headers:{Authorization:`Bearer ${e}`}});if(c.ok){const l=await c.json();l.config&&t(l.config)}}catch(e){console.error("Error fetching config:",e)}finally{w(!1)}},y=async()=>{try{const e=localStorage.getItem("access_token"),c=await fetch(`${n}/servers/${s}/channels/`,{headers:{Authorization:`Bearer ${e}`}});if(c.ok){const l=await c.json();E(l.channels||[])}}catch(e){console.error("Error fetching channels:",e)}},v=async()=>{try{const e=localStorage.getItem("access_token"),c=await fetch(`${n}/servers/${s}/roles/`,{headers:{Authorization:`Bearer ${e}`}});if(c.ok){const l=await c.json();R(l.roles||[])}}catch(e){console.error("Error fetching roles:",e)}},b=async()=>{try{const e=localStorage.getItem("access_token"),c=await fetch(`${n}/welcome-messages/server/${s}/stats/`,{headers:{Authorization:`Bearer ${e}`}});if(c.ok){const l=await c.json();h(l)}}catch(e){console.error("Error fetching stats:",e)}},k=async()=>{try{const e=localStorage.getItem("access_token");(await fetch(`${n}/welcome-messages/server/${s}/update/`,{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify(a)})).ok?(r.success("âœ… KarÅŸÄ±lama ayarlarÄ± kaydedildi"),b()):r.error("âŒ Kaydetme baÅŸarÄ±sÄ±z")}catch(e){console.error("Error saving config:",e),r.error("âŒ Kaydetme baÅŸarÄ±sÄ±z")}},N=async()=>{try{const e=localStorage.getItem("access_token");(await fetch(`${n}/welcome-messages/server/${s}/test/`,{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({type:"welcome"})})).ok?r.success("âœ… Test mesajÄ± gÃ¶nderildi"):r.error("âŒ Test mesajÄ± gÃ¶nderilemedi")}catch(e){console.error("Error testing message:",e),r.error("âŒ Test baÅŸarÄ±sÄ±z")}},g=(e,c)=>{t({...a,[e]:a[e]+` ${c}`})},u=[{code:"{user}",desc:"KullanÄ±cÄ± adÄ±"},{code:"{user_mention}",desc:"KullanÄ±cÄ± mention"},{code:"{server}",desc:"Sunucu adÄ±"},{code:"{member_count}",desc:"Ãœye sayÄ±sÄ±"},{code:"{user_id}",desc:"KullanÄ±cÄ± ID"}];return p?React.createElement("div",{className:"welcome-messages-overlay"},React.createElement("div",{className:"welcome-messages-panel"},React.createElement("div",{className:"loading-state"},React.createElement("div",{className:"spinner"}),React.createElement("p",null,"KarÅŸÄ±lama mesajlarÄ± yÃ¼kleniyor...")))):React.createElement("div",{className:"welcome-messages-overlay",onClick:d},React.createElement("div",{className:"welcome-messages-panel",onClick:e=>e.stopPropagation()},React.createElement("div",{className:"welcome-header"},React.createElement("h2",null,"ğŸ‘‹ KarÅŸÄ±lama & Veda MesajlarÄ±"),React.createElement("button",{className:"close-btn",onClick:d},"Ã—")),m&&React.createElement("div",{className:"stats-overview"},React.createElement("div",{className:"stat-card"},React.createElement("span",{className:"stat-icon"},"ğŸ‘‹"),React.createElement("span",{className:"stat-value"},m.total_welcomes||0),React.createElement("span",{className:"stat-label"},"Toplam KarÅŸÄ±lama")),React.createElement("div",{className:"stat-card"},React.createElement("span",{className:"stat-icon"},"ğŸ˜¢"),React.createElement("span",{className:"stat-value"},m.total_goodbyes||0),React.createElement("span",{className:"stat-label"},"Toplam Veda")),React.createElement("div",{className:"stat-card"},React.createElement("span",{className:"stat-icon"},"ğŸ“…"),React.createElement("span",{className:"stat-value"},m.welcomes_today||0),React.createElement("span",{className:"stat-label"},"BugÃ¼n KatÄ±lan"))),React.createElement("div",{className:"config-content"},React.createElement("div",{className:"config-section"},React.createElement("div",{className:"section-header"},React.createElement("h3",null,"ğŸ‘‹ HoÅŸ Geldin MesajlarÄ±"),React.createElement("label",{className:"toggle-switch"},React.createElement("input",{type:"checkbox",checked:a.welcome_enabled,onChange:e=>t({...a,welcome_enabled:e.target.checked})}),React.createElement("span",{className:"slider"}),React.createElement("span",{className:"toggle-label"},a.welcome_enabled?"âœ“ Aktif":"âœ— Pasif"))),React.createElement("div",{className:"form-grid"},React.createElement("div",{className:"form-group full-width"},React.createElement("label",null,"KarÅŸÄ±lama KanalÄ±"),React.createElement("select",{value:a.welcome_channel_id,onChange:e=>t({...a,welcome_channel_id:e.target.value}),disabled:!a.welcome_enabled},React.createElement("option",{value:""},"Kanal seÃ§in"),i.map(e=>React.createElement("option",{key:e.id,value:e.id},e.name)))),React.createElement("div",{className:"form-group full-width"},React.createElement("label",null,"HoÅŸ Geldin MesajÄ±"),React.createElement("textarea",{value:a.welcome_message,onChange:e=>t({...a,welcome_message:e.target.value}),disabled:!a.welcome_enabled,rows:"3"}),React.createElement("div",{className:"variables-bar"},u.map(e=>React.createElement("button",{key:e.code,className:"variable-btn",onClick:()=>g("welcome_message",e.code),disabled:!a.welcome_enabled,title:e.desc},e.code)))),React.createElement("div",{className:"form-group"},React.createElement("label",{className:"checkbox-label"},React.createElement("input",{type:"checkbox",checked:a.welcome_embed,onChange:e=>t({...a,welcome_embed:e.target.checked}),disabled:!a.welcome_enabled}),React.createElement("span",null,"Embed olarak gÃ¶nder"))),a.welcome_embed&&React.createElement(React.Fragment,null,React.createElement("div",{className:"form-group"},React.createElement("label",null,"Embed Rengi"),React.createElement("input",{type:"color",value:a.welcome_embed_color,onChange:e=>t({...a,welcome_embed_color:e.target.value}),disabled:!a.welcome_enabled})),React.createElement("div",{className:"form-group full-width"},React.createElement("label",null,"Embed BaÅŸlÄ±k"),React.createElement("input",{type:"text",value:a.welcome_embed_title,onChange:e=>t({...a,welcome_embed_title:e.target.value}),disabled:!a.welcome_enabled})),React.createElement("div",{className:"form-group full-width"},React.createElement("label",null,"Embed AÃ§Ä±klama"),React.createElement("textarea",{value:a.welcome_embed_description,onChange:e=>t({...a,welcome_embed_description:e.target.value}),disabled:!a.welcome_enabled,rows:"3"}))),React.createElement("div",{className:"form-group full-width"},React.createElement("label",{className:"checkbox-label"},React.createElement("input",{type:"checkbox",checked:a.welcome_dm,onChange:e=>t({...a,welcome_dm:e.target.checked}),disabled:!a.welcome_enabled}),React.createElement("span",null,"KullanÄ±cÄ±ya DM gÃ¶nder"))),a.welcome_dm&&React.createElement("div",{className:"form-group full-width"},React.createElement("label",null,"DM MesajÄ±"),React.createElement("textarea",{value:a.welcome_dm_message,onChange:e=>t({...a,welcome_dm_message:e.target.value}),disabled:!a.welcome_enabled,rows:"3"}))),React.createElement("button",{className:"test-btn",onClick:N,disabled:!a.welcome_enabled},"ğŸ§ª Test Et")),React.createElement("div",{className:"config-section"},React.createElement("div",{className:"section-header"},React.createElement("h3",null,"ğŸ˜¢ Veda MesajlarÄ±"),React.createElement("label",{className:"toggle-switch"},React.createElement("input",{type:"checkbox",checked:a.goodbye_enabled,onChange:e=>t({...a,goodbye_enabled:e.target.checked})}),React.createElement("span",{className:"slider"}),React.createElement("span",{className:"toggle-label"},a.goodbye_enabled?"âœ“ Aktif":"âœ— Pasif"))),React.createElement("div",{className:"form-grid"},React.createElement("div",{className:"form-group full-width"},React.createElement("label",null,"Veda KanalÄ±"),React.createElement("select",{value:a.goodbye_channel_id,onChange:e=>t({...a,goodbye_channel_id:e.target.value}),disabled:!a.goodbye_enabled},React.createElement("option",{value:""},"Kanal seÃ§in"),i.map(e=>React.createElement("option",{key:e.id,value:e.id},e.name)))),React.createElement("div",{className:"form-group full-width"},React.createElement("label",null,"Veda MesajÄ±"),React.createElement("textarea",{value:a.goodbye_message,onChange:e=>t({...a,goodbye_message:e.target.value}),disabled:!a.goodbye_enabled,rows:"3"}),React.createElement("div",{className:"variables-bar"},u.map(e=>React.createElement("button",{key:e.code,className:"variable-btn",onClick:()=>g("goodbye_message",e.code),disabled:!a.goodbye_enabled,title:e.desc},e.code)))),React.createElement("div",{className:"form-group"},React.createElement("label",{className:"checkbox-label"},React.createElement("input",{type:"checkbox",checked:a.goodbye_embed,onChange:e=>t({...a,goodbye_embed:e.target.checked}),disabled:!a.goodbye_enabled}),React.createElement("span",null,"Embed olarak gÃ¶nder"))),a.goodbye_embed&&React.createElement("div",{className:"form-group"},React.createElement("label",null,"Embed Rengi"),React.createElement("input",{type:"color",value:a.goodbye_embed_color,onChange:e=>t({...a,goodbye_embed_color:e.target.value}),disabled:!a.goodbye_enabled})))),React.createElement("div",{className:"config-section"},React.createElement("div",{className:"section-header"},React.createElement("h3",null,"â­ Otomatik Rol"),React.createElement("label",{className:"toggle-switch"},React.createElement("input",{type:"checkbox",checked:a.auto_role_enabled,onChange:e=>t({...a,auto_role_enabled:e.target.checked})}),React.createElement("span",{className:"slider"}),React.createElement("span",{className:"toggle-label"},a.auto_role_enabled?"âœ“ Aktif":"âœ— Pasif"))),React.createElement("div",{className:"form-group"},React.createElement("label",null,"Otomatik verilecek roller"),React.createElement("div",{className:"roles-selector"},_.map(e=>React.createElement("label",{key:e.id,className:"role-checkbox"},React.createElement("input",{type:"checkbox",checked:a.auto_role_ids.includes(e.id),onChange:c=>{const l=c.target.checked?[...a.auto_role_ids,e.id]:a.auto_role_ids.filter(C=>C!==e.id);t({...a,auto_role_ids:l})},disabled:!a.auto_role_enabled}),React.createElement("span",null,e.name)))))),React.createElement("button",{className:"save-btn",onClick:k},"ğŸ’¾ AyarlarÄ± Kaydet"))))};export{M as default};
