{"version":3,"file":"LanguageSelector-O70Km-tX.js","sources":["../../../src/contexts/LanguageContext.js","../../../src/components/LanguageSelector.js"],"sourcesContent":["// frontend/src/contexts/LanguageContext.js\r\n// üåê INTERNATIONALIZATION CONTEXT (Enhanced with i18next)\r\n\r\nimport { createContext, useContext, useState, useEffect, useCallback } from 'react';\r\nimport i18n from '../i18n';\r\nimport api from '../api';\r\n\r\nconst LanguageContext = createContext();\r\n\r\n// Default translations (Turkish fallback)\r\nconst defaultTranslations = {\r\n    'common.save': 'Kaydet',\r\n    'common.cancel': 'ƒ∞ptal',\r\n    'common.loading': 'Y√ºkleniyor...',\r\n    'common.error': 'Hata',\r\n    'common.success': 'Ba≈üarƒ±lƒ±',\r\n};\r\n\r\nexport const LanguageProvider = ({ children }) => {\r\n    const [currentLanguage, setCurrentLanguage] = useState('tr');\r\n    const [translations, setTranslations] = useState(defaultTranslations);\r\n    const [languages, setLanguages] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [direction, setDirection] = useState('ltr');\r\n\r\n    // Load available languages\r\n    useEffect(() => {\r\n        const loadLanguages = async () => {\r\n            try {\r\n                const response = await api.get('/i18n/languages/');\r\n                setLanguages(response.data.languages);\r\n            } catch (error) {\r\n                console.error('Failed to load languages:', error);\r\n            }\r\n        };\r\n        loadLanguages();\r\n    }, []);\r\n\r\n    // Load user's language preference\r\n    useEffect(() => {\r\n        const loadUserLanguage = async () => {\r\n            try {\r\n                const stored = localStorage.getItem('language');\r\n                if (stored) {\r\n                    setCurrentLanguage(stored);\r\n                    await loadTranslations(stored);\r\n                } else {\r\n                    // Try to get from API if logged in\r\n                    try {\r\n                        const response = await api.get('/i18n/user/');\r\n                        setCurrentLanguage(response.data.code);\r\n                        await loadTranslations(response.data.code);\r\n                    } catch {\r\n                        // Not logged in, use browser language or default\r\n                        const browserLang = navigator.language.split('-')[0];\r\n                        const supported = ['tr', 'en', 'de', 'fr', 'es', 'ru', 'ar', 'ja', 'ko', 'zh'];\r\n                        const lang = supported.includes(browserLang) ? browserLang : 'tr';\r\n                        setCurrentLanguage(lang);\r\n                        await loadTranslations(lang);\r\n                    }\r\n                }\r\n            } catch (error) {\r\n                console.error('Failed to load user language:', error);\r\n            }\r\n            setLoading(false);\r\n        };\r\n        loadUserLanguage();\r\n    }, []);\r\n\r\n    // Load translations for a language\r\n    const loadTranslations = async (langCode) => {\r\n        try {\r\n            const response = await api.get(`/i18n/translations/${langCode}/`);\r\n            setTranslations(response.data.translations);\r\n            setDirection(response.data.language?.direction || 'ltr');\r\n\r\n            // Update document direction for RTL languages\r\n            document.documentElement.dir = response.data.language?.direction || 'ltr';\r\n            document.documentElement.lang = langCode;\r\n        } catch (error) {\r\n            console.error('Failed to load translations:', error);\r\n            // Fallback to default\r\n            setTranslations(defaultTranslations);\r\n        }\r\n    };\r\n\r\n    // Change language\r\n    const changeLanguage = useCallback(async (langCode) => {\r\n        setCurrentLanguage(langCode);\r\n        localStorage.setItem('language', langCode);\r\n        localStorage.setItem('pawscord_language', langCode);\r\n        i18n.changeLanguage(langCode); // Sync i18next\r\n        await loadTranslations(langCode);\r\n\r\n        // Save to server if logged in\r\n        try {\r\n            await api.post('/i18n/user/set/', { language: langCode });\r\n        } catch {\r\n            // Not logged in, that's fine\r\n        }\r\n    }, []);\r\n\r\n    // Translation function with interpolation + i18next fallback\r\n    const t = useCallback((key, params = {}) => {\r\n        let text = translations[key];\r\n\r\n        // Fallback to i18next bundled translations if API translation missing\r\n        if (!text || text === key) {\r\n            const i18nKey = key.replace(/^([^.]+)\\./, '$1.');\r\n            const i18nResult = i18n.t(i18nKey, params);\r\n            if (i18nResult !== i18nKey) {\r\n                return i18nResult;\r\n            }\r\n        }\r\n\r\n        if (!text) return key;\r\n\r\n        // Handle interpolation {param}\r\n        Object.entries(params).forEach(([param, value]) => {\r\n            text = text.replace(new RegExp(`\\\\{${param}\\\\}`, 'g'), value);\r\n        });\r\n\r\n        return text;\r\n    }, [translations]);\r\n\r\n    // Get language info\r\n    const getLanguageInfo = useCallback((code) => {\r\n        return languages.find(l => l.code === code);\r\n    }, [languages]);\r\n\r\n    const value = {\r\n        currentLanguage,\r\n        languages,\r\n        translations,\r\n        loading,\r\n        direction,\r\n        t,\r\n        changeLanguage,\r\n        getLanguageInfo\r\n    };\r\n\r\n    return (\r\n        <LanguageContext.Provider value={value}>\r\n            {children}\r\n        </LanguageContext.Provider>\r\n    );\r\n};\r\n\r\n// Hook for using language context\r\nexport const useLanguage = () => {\r\n    const context = useContext(LanguageContext);\r\n    if (!context) {\r\n        throw new Error('useLanguage must be used within a LanguageProvider');\r\n    }\r\n    return context;\r\n};\r\n\r\n// Hook for just the translate function\r\nexport const useTranslation = () => {\r\n    const { t } = useLanguage();\r\n    return t;\r\n};\r\n\r\nexport default LanguageContext;\r\n","// frontend/src/components/LanguageSelector.js\r\n// üåê LANGUAGE SELECTOR COMPONENT\r\n\r\nimport { useState } from 'react';\r\nimport { useLanguage } from '../contexts/LanguageContext';\r\nimport './LanguageSelector.css';\r\n\r\n// ========================================\r\n// üåê LANGUAGE SELECTOR DROPDOWN\r\n// ========================================\r\nexport const LanguageSelector = ({ compact = false }) => {\r\n    const { currentLanguage, languages, changeLanguage, getLanguageInfo } = useLanguage();\r\n    const [isOpen, setIsOpen] = useState(false);\r\n\r\n    const currentLang = getLanguageInfo(currentLanguage) || {\r\n        code: 'tr',\r\n        name: 'T√ºrk√ße',\r\n        flag: 'üáπüá∑'\r\n    };\r\n\r\n    const handleSelect = (langCode) => {\r\n        changeLanguage(langCode);\r\n        setIsOpen(false);\r\n    };\r\n\r\n    return (\r\n        <div className={`language-selector ${compact ? 'compact' : ''}`}>\r\n            <button\r\n                className=\"language-toggle\"\r\n                onClick={() => setIsOpen(!isOpen)}\r\n            >\r\n                <span className=\"lang-flag\">{currentLang.flag}</span>\r\n                {!compact && (\r\n                    <>\r\n                        <span className=\"lang-name\">{currentLang.native_name || currentLang.name}</span>\r\n                        <span className=\"lang-arrow\">{isOpen ? '‚ñ≤' : '‚ñº'}</span>\r\n                    </>\r\n                )}\r\n            </button>\r\n\r\n            {isOpen && (\r\n                <div className=\"language-dropdown\">\r\n                    {languages.map((lang) => (\r\n                        <button\r\n                            key={lang.code}\r\n                            className={`language-option ${lang.code === currentLanguage ? 'active' : ''}`}\r\n                            onClick={() => handleSelect(lang.code)}\r\n                        >\r\n                            <span className=\"lang-flag\">{lang.flag}</span>\r\n                            <span className=\"lang-name\">{lang.native_name}</span>\r\n                            {lang.code === currentLanguage && (\r\n                                <span className=\"lang-check\">‚úì</span>\r\n                            )}\r\n                        </button>\r\n                    ))}\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\n// ========================================\r\n// üåê LANGUAGE SETTINGS PANEL\r\n// ========================================\r\nexport const LanguageSettings = ({ onClose }) => {\r\n    const { currentLanguage, languages, changeLanguage, direction } = useLanguage();\r\n    const [selectedLang, setSelectedLang] = useState(currentLanguage);\r\n\r\n    const handleSave = () => {\r\n        changeLanguage(selectedLang);\r\n        onClose?.();\r\n    };\r\n\r\n    return (\r\n        <div className=\"language-settings-panel\">\r\n            <div className=\"panel-header\">\r\n                <h2>üåê Dil Ayarlarƒ± / Language Settings</h2>\r\n                <button className=\"close-btn\" onClick={onClose}>‚úï</button>\r\n            </div>\r\n\r\n            <div className=\"panel-content\">\r\n                <p className=\"settings-desc\">\r\n                    Aray√ºz dilini se√ßin / Select interface language\r\n                </p>\r\n\r\n                <div className=\"languages-grid\">\r\n                    {languages.map((lang) => (\r\n                        <button\r\n                            key={lang.code}\r\n                            className={`language-card ${lang.code === selectedLang ? 'selected' : ''}`}\r\n                            onClick={() => setSelectedLang(lang.code)}\r\n                        >\r\n                            <span className=\"card-flag\">{lang.flag}</span>\r\n                            <div className=\"card-info\">\r\n                                <span className=\"card-native\">{lang.native_name}</span>\r\n                                <span className=\"card-name\">{lang.name}</span>\r\n                            </div>\r\n                            {lang.direction === 'rtl' && (\r\n                                <span className=\"rtl-badge\">RTL</span>\r\n                            )}\r\n                            {lang.code === selectedLang && (\r\n                                <span className=\"selected-check\">‚úì</span>\r\n                            )}\r\n                        </button>\r\n                    ))}\r\n                </div>\r\n\r\n                <div className=\"settings-info\">\r\n                    <div className=\"info-item\">\r\n                        <span className=\"info-icon\">üìù</span>\r\n                        <span>Metin y√∂n√º: {direction === 'rtl' ? 'Saƒüdan Sola' : 'Soldan Saƒüa'}</span>\r\n                    </div>\r\n                    <div className=\"info-item\">\r\n                        <span className=\"info-icon\">üîÑ</span>\r\n                        <span>Deƒüi≈üiklikler anƒ±nda uygulanƒ±r</span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"panel-footer\">\r\n                <button className=\"btn-cancel\" onClick={onClose}>\r\n                    ƒ∞ptal / Cancel\r\n                </button>\r\n                <button className=\"btn-save\" onClick={handleSave}>\r\n                    Kaydet / Save\r\n                </button>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\n// ========================================\r\n// üåê INLINE LANGUAGE SWITCHER\r\n// ========================================\r\nexport const InlineLanguageSwitcher = () => {\r\n    const { currentLanguage, languages, changeLanguage } = useLanguage();\r\n\r\n    return (\r\n        <div className=\"inline-language-switcher\">\r\n            {languages.slice(0, 4).map((lang) => (\r\n                <button\r\n                    key={lang.code}\r\n                    className={`inline-lang-btn ${lang.code === currentLanguage ? 'active' : ''}`}\r\n                    onClick={() => changeLanguage(lang.code)}\r\n                    title={lang.native_name}\r\n                >\r\n                    {lang.flag}\r\n                </button>\r\n            ))}\r\n        </div>\r\n    );\r\n};\r\n\r\n// ========================================\r\n// üåê TRANSLATED TEXT COMPONENT\r\n// ========================================\r\nexport const T = ({ id, params = {}, as: Component = 'span', ...props }) => {\r\n    const { t } = useLanguage();\r\n    return <Component {...props}>{t(id, params)}</Component>;\r\n};\r\n\r\nexport default LanguageSelector;\r\n"],"names":["createContext","useContext","useState","jsxs","jsx","Fragment"],"mappings":";;;;;;;;;;AAOA,MAAM,kBAAkBA,aAAAA,cAAA;AA8IjB,MAAM,cAAc,6BAAM;AAC7B,QAAM,UAAUC,aAAAA,WAAW,eAAe;AAC1C,MAAI,CAAC,SAAS;AACV,UAAM,IAAI,MAAM,oDAAoD;AAAA,EACxE;AACA,SAAO;AACX,GAN2B;AC3IpB,MAAM,mBAAmB,wBAAC,EAAE,UAAU,YAAY;AACrD,QAAM,EAAE,iBAAiB,WAAW,gBAAgB,gBAAA,IAAoB,YAAA;AACxE,QAAM,CAAC,QAAQ,SAAS,IAAIC,aAAAA,SAAS,KAAK;AAE1C,QAAM,cAAc,gBAAgB,eAAe,KAAK;AAAA,IAEpD,MAAM;AAAA,IACN,MAAM;AAAA,EAAA;AAGV,QAAM,eAAe,wBAAC,aAAa;AAC/B,mBAAe,QAAQ;AACvB,cAAU,KAAK;AAAA,EACnB,GAHqB;AAKrB,gDACK,OAAA,EAAI,WAAW,qBAAqB,UAAU,YAAY,EAAE,IACzD,UAAA;AAAA,IAAAC,kCAAAA;AAAAA,MAAC;AAAA,MAAA;AAAA,QACG,WAAU;AAAA,QACV,SAAS,6BAAM,UAAU,CAAC,MAAM,GAAvB;AAAA,QAET,UAAA;AAAA,UAAAC,kCAAAA,IAAC,QAAA,EAAK,WAAU,aAAa,UAAA,YAAY,MAAK;AAAA,UAC7C,CAAC,WACED,kCAAAA,KAAAE,kBAAAA,UAAA,EACI,UAAA;AAAA,YAAAD,sCAAC,UAAK,WAAU,aAAa,UAAA,YAAY,eAAe,YAAY,MAAK;AAAA,kDACxE,QAAA,EAAK,WAAU,cAAc,UAAA,SAAS,MAAM,IAAA,CAAI;AAAA,UAAA,EAAA,CACrD;AAAA,QAAA;AAAA,MAAA;AAAA,IAAA;AAAA,IAIP,gDACI,OAAA,EAAI,WAAU,qBACV,UAAA,UAAU,IAAI,CAAC,SACZD,kCAAAA;AAAAA,MAAC;AAAA,MAAA;AAAA,QAEG,WAAW,mBAAmB,KAAK,SAAS,kBAAkB,WAAW,EAAE;AAAA,QAC3E,SAAS,6BAAM,aAAa,KAAK,IAAI,GAA5B;AAAA,QAET,UAAA;AAAA,UAAAC,kCAAAA,IAAC,QAAA,EAAK,WAAU,aAAa,UAAA,KAAK,MAAK;AAAA,UACvCA,kCAAAA,IAAC,QAAA,EAAK,WAAU,aAAa,eAAK,aAAY;AAAA,UAC7C,KAAK,SAAS,yDACV,QAAA,EAAK,WAAU,cAAa,UAAA,IAAA,CAAC;AAAA,QAAA;AAAA,MAAA;AAAA,MAP7B,KAAK;AAAA,IAAA,CAUjB,EAAA,CACL;AAAA,EAAA,GAER;AAER,GAjDgC;AAsDzB,MAAM,mBAAmB,wBAAC,EAAE,cAAc;AAC7C,QAAM,EAAE,iBAAiB,WAAW,gBAAgB,UAAA,IAAc,YAAA;AAClE,QAAM,CAAC,cAAc,eAAe,IAAIF,aAAAA,SAAS,eAAe;AAEhE,QAAM,aAAa,6BAAM;AACrB,mBAAe,YAAY;AAC3B,cAAA;AAAA,EACJ,GAHmB;AAKnB,SACIC,kCAAAA,KAAC,OAAA,EAAI,WAAU,2BACX,UAAA;AAAA,IAAAA,kCAAAA,KAAC,OAAA,EAAI,WAAU,gBACX,UAAA;AAAA,MAAAC,kCAAAA,IAAC,QAAG,UAAA,sCAAA,CAAmC;AAAA,4CACtC,UAAA,EAAO,WAAU,aAAY,SAAS,SAAS,UAAA,IAAA,CAAC;AAAA,IAAA,GACrD;AAAA,IAEAD,kCAAAA,KAAC,OAAA,EAAI,WAAU,iBACX,UAAA;AAAA,MAAAC,kCAAAA,IAAC,KAAA,EAAE,WAAU,iBAAgB,UAAA,mDAE7B;AAAA,4CAEC,OAAA,EAAI,WAAU,kBACV,UAAA,UAAU,IAAI,CAAC,SACZD,kCAAAA;AAAAA,QAAC;AAAA,QAAA;AAAA,UAEG,WAAW,iBAAiB,KAAK,SAAS,eAAe,aAAa,EAAE;AAAA,UACxE,SAAS,6BAAM,gBAAgB,KAAK,IAAI,GAA/B;AAAA,UAET,UAAA;AAAA,YAAAC,kCAAAA,IAAC,QAAA,EAAK,WAAU,aAAa,UAAA,KAAK,MAAK;AAAA,YACvCD,kCAAAA,KAAC,OAAA,EAAI,WAAU,aACX,UAAA;AAAA,cAAAC,kCAAAA,IAAC,QAAA,EAAK,WAAU,eAAe,UAAA,KAAK,aAAY;AAAA,cAChDA,kCAAAA,IAAC,QAAA,EAAK,WAAU,aAAa,eAAK,KAAA,CAAK;AAAA,YAAA,GAC3C;AAAA,YACC,KAAK,cAAc,+CACf,QAAA,EAAK,WAAU,aAAY,UAAA,OAAG;AAAA,YAElC,KAAK,SAAS,sDACV,QAAA,EAAK,WAAU,kBAAiB,UAAA,IAAA,CAAC;AAAA,UAAA;AAAA,QAAA;AAAA,QAbjC,KAAK;AAAA,MAAA,CAgBjB,GACL;AAAA,MAEAD,kCAAAA,KAAC,OAAA,EAAI,WAAU,iBACX,UAAA;AAAA,QAAAA,kCAAAA,KAAC,OAAA,EAAI,WAAU,aACX,UAAA;AAAA,UAAAC,kCAAAA,IAAC,QAAA,EAAK,WAAU,aAAY,UAAA,MAAE;AAAA,iDAC7B,QAAA,EAAK,UAAA;AAAA,YAAA;AAAA,YAAa,cAAc,QAAQ,gBAAgB;AAAA,UAAA,EAAA,CAAc;AAAA,QAAA,GAC3E;AAAA,QACAD,kCAAAA,KAAC,OAAA,EAAI,WAAU,aACX,UAAA;AAAA,UAAAC,kCAAAA,IAAC,QAAA,EAAK,WAAU,aAAY,UAAA,MAAE;AAAA,UAC9BA,kCAAAA,IAAC,UAAK,UAAA,iCAAA,CAA8B;AAAA,QAAA,EAAA,CACxC;AAAA,MAAA,EAAA,CACJ;AAAA,IAAA,GACJ;AAAA,IAEAD,kCAAAA,KAAC,OAAA,EAAI,WAAU,gBACX,UAAA;AAAA,MAAAC,sCAAC,UAAA,EAAO,WAAU,cAAa,SAAS,SAAS,UAAA,kBAEjD;AAAA,4CACC,UAAA,EAAO,WAAU,YAAW,SAAS,YAAY,UAAA,gBAAA,CAElD;AAAA,IAAA,EAAA,CACJ;AAAA,EAAA,GACJ;AAER,GAjEgC;AAsEzB,MAAM,yBAAyB,6BAAM;AACxC,QAAM,EAAE,iBAAiB,WAAW,eAAA,IAAmB,YAAA;AAEvD,SACIA,kCAAAA,IAAC,OAAA,EAAI,WAAU,4BACV,UAAA,UAAU,MAAM,GAAG,CAAC,EAAE,IAAI,CAAC,SACxBA,kCAAAA;AAAAA,IAAC;AAAA,IAAA;AAAA,MAEG,WAAW,mBAAmB,KAAK,SAAS,kBAAkB,WAAW,EAAE;AAAA,MAC3E,SAAS,6BAAM,eAAe,KAAK,IAAI,GAA9B;AAAA,MACT,OAAO,KAAK;AAAA,MAEX,UAAA,KAAK;AAAA,IAAA;AAAA,IALD,KAAK;AAAA,EAAA,CAOjB,GACL;AAER,GAjBsC;AAsB/B,MAAM,IAAI,wBAAC,EAAE,IAAI,SAAS,CAAA,GAAI,IAAI,YAAY,QAAQ,GAAG,YAAY;AACxE,QAAM,EAAE,EAAA,IAAM,YAAA;AACd,+CAAQ,WAAA,EAAW,GAAG,OAAQ,UAAA,EAAE,IAAI,MAAM,GAAE;AAChD,GAHiB;"}