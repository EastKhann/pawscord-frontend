import{r as s,j as e,b as V}from"./react-vendor-D8Fi5F9E.js";import{b as Y,L as M}from"./router-vendor-CTPwQFnc.js";import{y as J,M as X,E as Z,N as K,u as ee,v as te}from"./icons-vendor-CKPm393i.js";import{Q as w,L as z}from"./grammarQuestions-DGt-yM1z.js";import{A as oe}from"./index-DMOkrgup.js";import"./media-vendor-Dp18sh1g.js";import"./crypto-vendor-Cz32ecGD.js";import"./state-vendor-De5qIGw3.js";const N=oe,pe=()=>{const T=Y(),[W,h]=s.useState("level-select"),[b,I]=s.useState(null),[u,A]=s.useState(0),[x,f]=s.useState(""),[m,y]=s.useState(""),[d,j]=s.useState(!1),[a,k]=s.useState(null),[R,L]=s.useState(0),[v,_]=s.useState([]),[O,q]=s.useState(!0),$=()=>localStorage.getItem("access_token"),B=s.useCallback(async(o,i={})=>{const l=$();if(!l)return null;const p=i.headers||{};p.Authorization=`Bearer ${l}`,p["Content-Type"]="application/json";try{const n=await fetch(o,{...i,headers:p});return n.status===401?(T("/"),null):n}catch(n){return console.error("API Error:",n),null}},[T]);s.useEffect(()=>{(async()=>{const i=await B(`${N}/eng-learn/grammar/known/`);if(i&&i.ok){const l=await i.json();_(l||[])}q(!1)})()},[B]);const D=s.useMemo(()=>b?w.filter(o=>o.level===b&&!v.includes(o.id)):[],[b,v]),r=D[u],c=D.length,P=c>0?(u+1)/c*100:0,H=o=>{I(o),A(0),L(0),j(!1),k(null),f(""),y(""),h("quiz")},U=()=>{let o="";r.type==="choice"?o=x:o=m.trim();const i=o.toLowerCase()===r.answer.toLowerCase();k(i),j(!0),i&&L(l=>l+1)},E=async()=>{if(r)try{await B(`${N}/eng-learn/grammar/mark-known/`,{method:"POST",body:JSON.stringify({question_id:r.id})}),_(o=>[...o,r.id]),Q()}catch(o){console.error("ƒ∞≈üaretleme hatasƒ±:",o)}},Q=()=>{u+1<c?(A(o=>o+1),j(!1),k(null),f(""),y("")):h("result")},S=()=>{h("level-select"),I(null)};if(O)return e.jsx("div",{style:t.container,children:"Y√ºkleniyor..."});if(W==="level-select"){const o=z.filter(n=>n.id.startsWith("A")),i=z.filter(n=>n.id.startsWith("B")),l=z.filter(n=>n.id.startsWith("C")),p=n=>{const G=w.filter(g=>g.level===n.id).length,F=w.filter(g=>g.level===n.id&&v.includes(g.id)).length,C=G-F;return e.jsxs("button",{onClick:()=>C>0?H(n.id):alert("Tebrikler! Bu seviyedeki t√ºm sorularƒ± tamamladƒ±n."),style:{...t.levelCard,borderTop:`5px solid ${n.color}`,opacity:C===0?.6:1},children:[e.jsx("div",{style:t.levelIcon,children:n.icon}),e.jsx("div",{style:t.levelName,children:n.name}),e.jsx("div",{style:t.levelCount,children:C===0?"Tamamlandƒ±! üéâ":`${F} / ${G} Tamamlandƒ±`})]},n.id)};return e.jsx("div",{style:t.scrollWrapper,children:e.jsxs("div",{style:t.container,children:[e.jsxs("div",{style:t.headerArea,children:[e.jsxs(M,{to:"/eng-learn",style:t.backLink,children:[e.jsx(J,{})," Merkez"]}),e.jsx("h1",{style:t.mainTitle,children:"Seviyeni Se√ß"}),e.jsx("p",{style:t.subTitle,children:"Kendini test etmek i√ßin bir zorluk seviyesi se√ß."})]}),e.jsxs("div",{style:t.columnsWrapper,children:[e.jsx("div",{style:t.column,children:o.map(n=>p(n))}),e.jsx("div",{style:t.column,children:i.map(n=>p(n))}),e.jsx("div",{style:t.column,children:l.map(n=>p(n))})]})]})})}if(W==="result"){const o=c>0?R/c*100:100;let i="Gayet iyi!";return o===100?i="M√ºkemmel! üèÜ":o<50&&(i="Biraz daha √ßalƒ±≈ümalƒ±sƒ±n. üí™"),e.jsx("div",{style:t.scrollWrapper,children:e.jsx("div",{style:t.container,children:e.jsxs("div",{style:t.resultCard,children:[e.jsx(X,{size:60,color:"#faa61a",style:{marginBottom:"20px"}}),e.jsx("h2",{style:t.resultTitle,children:"Oturum Tamamlandƒ±!"}),e.jsxs("p",{style:t.resultScore,children:["Skorun: ",R," / ",c]}),e.jsx("p",{style:t.resultMessage,children:i}),e.jsxs("div",{style:t.resultBtnGroup,children:[e.jsxs("button",{onClick:S,style:t.primaryBtn,children:[e.jsx(Z,{style:{marginRight:"8px"}})," Men√ºye D√∂n"]}),e.jsx(M,{to:"/eng-learn",style:t.secondaryBtn,children:"Merkeze D√∂n"})]})]})})})}return r?e.jsx("div",{style:t.scrollWrapper,children:e.jsxs("div",{style:t.container,children:[e.jsxs("div",{style:t.topBar,children:[e.jsx("button",{onClick:S,style:t.smallBackBtn,children:"‚úï √áƒ±k"}),e.jsx("div",{style:t.progressBarBg,children:e.jsx("div",{style:{...t.progressBarFill,width:`${P}%`}})})]}),e.jsxs("div",{style:t.quizBox,children:[e.jsx("div",{style:t.questionSection,children:e.jsx("h2",{style:t.questionText,children:r.question.split("_____").map((o,i,l)=>e.jsxs(V.Fragment,{children:[o,i<l.length-1&&e.jsx("span",{style:{...t.blankSpace,borderColor:d?a?"#43b581":"#f04747":"#7289da"},children:d?(r.type==="choice"?x:m)||"___":"_____"})]},i))})}),e.jsxs("div",{style:t.interactionArea,children:[r.type==="choice"&&e.jsx("div",{style:t.optionsGrid,children:r.options.map((o,i)=>{let l=t.optionBtn;return d?o===r.answer?l={...l,...t.correctBtn}:o===x?l={...l,...t.wrongBtn}:l={...l,opacity:.5}:x===o&&(l={...l,...t.selectedBtn}),e.jsx("button",{onClick:()=>!d&&f(o),style:l,disabled:d,children:o},i)})}),r.type==="input"&&e.jsx("input",{type:"text",value:m,onChange:o=>y(o.target.value),placeholder:"Cevabƒ± buraya yazƒ±n...",style:{...t.textInput,borderColor:d?a?"#43b581":"#f04747":"#7289da"},disabled:d})]}),e.jsx("div",{style:t.footer,children:d?e.jsxs("div",{style:{...t.feedbackBox,borderLeft:a?"5px solid #43b581":"5px solid #f04747",backgroundColor:a?"rgba(67, 181, 129, 0.1)":"rgba(240, 71, 71, 0.1)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"15px"},children:[a?e.jsx(ee,{size:28,color:"#43b581"}):e.jsx(te,{size:28,color:"#f04747"}),e.jsxs("div",{children:[e.jsx("strong",{style:{fontSize:"1.2em",color:a?"#43b581":"#f04747",display:"block"},children:a?"Doƒüru Cevap!":"Yanlƒ±≈ü Cevap"}),!a&&e.jsxs("span",{style:{color:"#dbdee1",fontSize:"0.9em"},children:["Doƒürusu: ",e.jsx("strong",{style:{color:"#43b581"},children:r.answer})]})]})]}),r.explanation&&e.jsxs("div",{style:t.explanationContainer,children:[r.explanation.title&&e.jsxs("div",{style:t.expTitle,children:["üìñ ",r.explanation.title]}),r.explanation.translation&&e.jsx("div",{style:t.expTranslation,children:e.jsxs("em",{children:['"',r.explanation.translation,'"']})}),e.jsx("div",{style:t.separator}),r.explanation.rule&&e.jsxs("div",{style:t.expSection,children:[e.jsx("strong",{style:{color:"#f0b232"},children:"Kural:"})," ",r.explanation.rule]}),r.explanation.tips&&e.jsxs("div",{style:t.expSection,children:[e.jsx("strong",{style:{color:"#00a8fc"},children:"ƒ∞pucu:"})," ",r.explanation.tips]}),r.explanation.examples&&e.jsxs("div",{style:{...t.expSection,marginTop:"10px"},children:[e.jsx("strong",{style:{color:"#dbdee1",display:"block",marginBottom:3},children:"√ñrnekler:"}),r.explanation.examples.map((o,i)=>e.jsxs("div",{style:t.exampleItem,children:["‚Ä¢ ",o]},i))]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:[e.jsx("button",{onClick:Q,style:a?t.nextBtnCorrect:t.nextBtnWrong,children:u+1===c?"Bƒ∞Tƒ∞R VE SONU√áLARI G√ñR":"DEVAM ET"}),e.jsxs("button",{onClick:E,style:t.feedbackKnownBtn,children:[e.jsx(K,{})," Bunu aslƒ±nda biliyordum (√ñƒürenildi Say)"]})]})]}):e.jsxs("div",{style:t.actionButtonGroup,children:[e.jsxs("button",{onClick:E,style:t.knownBtn,title:"Bunu biliyorum, bir daha sorma",children:[e.jsx(K,{})," Biliyorum (Ge√ß)"]}),e.jsx("button",{onClick:U,style:t.checkBtn,disabled:r.type==="choice"?!x:!m,children:"KONTROL ET"})]})})]})]})}):e.jsx("div",{style:t.container,children:e.jsxs("div",{style:t.resultCard,children:[e.jsx("h2",{children:"Harika! üéâ"}),e.jsx("p",{children:"Bu seviyedeki t√ºm sorularƒ± bitirdin."}),e.jsx("button",{onClick:S,style:t.primaryBtn,children:"Geri D√∂n"})]})})},t={scrollWrapper:{width:"100%",height:"100dvh",overflowY:"auto",backgroundColor:"var(--background-primary)"},container:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",minHeight:"100%",color:"var(--text-primary)",padding:"20px",paddingBottom:"50px",boxSizing:"border-box",fontFamily:"'Poppins', sans-serif"},headerArea:{width:"100%",maxWidth:"800px",marginBottom:"30px",textAlign:"center",position:"relative"},backLink:{display:"inline-flex",alignItems:"center",gap:"8px",textDecoration:"none",color:"var(--text-secondary)",fontWeight:"600",fontSize:"0.9em",marginBottom:"15px",alignSelf:"flex-start"},mainTitle:{fontSize:"clamp(1.8em, 5vw, 2.5em)",marginBottom:"10px",color:"#fff"},subTitle:{fontSize:"1em",color:"var(--text-muted)",textAlign:"center"},columnsWrapper:{display:"flex",flexWrap:"wrap",gap:"20px",width:"100%",maxWidth:"1000px",justifyContent:"center",alignItems:"flex-start"},column:{flex:"1 1 280px",display:"flex",flexDirection:"column",gap:"20px"},levelCard:{backgroundColor:"#2b2d31",padding:"25px",borderRadius:"16px",border:"2px solid transparent",cursor:"pointer",display:"flex",alignItems:"center",boxShadow:"0 4px 0 rgba(0,0,0,0.2)",transition:"transform 0.1s, border-color 0.2s",color:"#dbdee1",textAlign:"left",gap:"15px"},levelIcon:{fontSize:"2.5em"},levelName:{fontSize:"1.2em",fontWeight:"700",color:"white"},levelCount:{fontSize:"0.9em",color:"#949ba4"},quizBox:{width:"100%",maxWidth:"700px",backgroundColor:"#2b2d31",padding:"40px",borderRadius:"24px",boxShadow:"0 10px 30px rgba(0,0,0,0.3)",marginTop:"20px"},questionText:{fontSize:"1.5em",textAlign:"center",lineHeight:"1.6",color:"white",fontWeight:"600"},optionsGrid:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"15px",marginTop:"30px"},optionBtn:{padding:"20px",fontSize:"1.1em",fontWeight:"600",borderRadius:"12px",border:"2px solid #404249",backgroundColor:"#313338",color:"#dbdee1",cursor:"pointer",transition:"all 0.1s",boxShadow:"0 4px 0 #1e1f22"},selectedBtn:{borderColor:"#5865f2",backgroundColor:"rgba(88, 101, 242, 0.1)",color:"#5865f2"},correctBtn:{borderColor:"#23a559",backgroundColor:"#23a559",color:"white",boxShadow:"0 4px 0 #187d41"},wrongBtn:{borderColor:"#da373c",backgroundColor:"#da373c",color:"white",boxShadow:"0 4px 0 #a1282c"},footer:{marginTop:"30px",display:"flex",justifyContent:"space-between",gap:"10px"},checkBtn:{padding:"15px 30px",borderRadius:"12px",border:"none",backgroundColor:"#5865f2",color:"white",fontSize:"1em",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 0 #4752c4",width:"100%"},knownBtn:{padding:"15px",borderRadius:"12px",border:"2px solid #404249",backgroundColor:"transparent",color:"#949ba4",fontWeight:"bold",cursor:"pointer"},topBar:{width:"100%",maxWidth:"600px",display:"flex",alignItems:"center",gap:"15px",marginBottom:"20px"},smallBackBtn:{background:"none",border:"none",color:"var(--text-muted)",fontSize:"1em",cursor:"pointer",fontWeight:"bold"},progressBarBg:{flex:1,height:"10px",backgroundColor:"var(--background-tertiary)",borderRadius:"5px",overflow:"hidden"},progressBarFill:{height:"100%",backgroundColor:"#5865f2",borderRadius:"5px",transition:"width 0.5s ease"},questionSection:{marginBottom:"20px",minHeight:"80px",display:"flex",alignItems:"center",justifyContent:"center"},blankSpace:{display:"inline-block",borderBottom:"2px solid",padding:"0 5px",minWidth:"40px",textAlign:"center",margin:"0 4px",color:"var(--text-link)",fontWeight:"bold"},interactionArea:{marginBottom:"20px"},textInput:{width:"100%",padding:"15px",fontSize:"1.1em",borderRadius:"10px",border:"2px solid",backgroundColor:"var(--background-primary)",color:"var(--text-primary)",outline:"none",boxSizing:"border-box"},actionButtonGroup:{display:"flex",gap:"10px",flexWrap:"wrap"},feedbackBox:{display:"flex",flexDirection:"column",gap:"10px",padding:"20px",borderRadius:"12px",animation:"slideUp 0.3s ease",textAlign:"left",boxShadow:"0 4px 15px rgba(0,0,0,0.2)"},explanationContainer:{backgroundColor:"rgba(0,0,0,0.2)",padding:"15px",borderRadius:"8px",marginTop:"5px",marginBottom:"15px",border:"1px solid rgba(255,255,255,0.05)"},expTitle:{color:"#fff",fontWeight:"bold",fontSize:"1.1em",marginBottom:"5px"},expTranslation:{color:"#949ba4",fontSize:"0.95em",marginBottom:"10px"},separator:{height:"1px",backgroundColor:"rgba(255,255,255,0.1)",margin:"10px 0"},expSection:{fontSize:"0.95em",color:"#dbdee1",lineHeight:"1.5",marginBottom:"8px"},exampleItem:{fontSize:"0.9em",color:"#b9bbbe",paddingLeft:"10px",borderLeft:"2px solid #5865f2",marginBottom:"4px",fontStyle:"italic"},nextBtnCorrect:{padding:"12px",borderRadius:"8px",border:"none",backgroundColor:"#43b581",color:"white",fontWeight:"bold",cursor:"pointer",width:"100%",fontSize:"1em"},nextBtnWrong:{padding:"12px",borderRadius:"8px",border:"none",backgroundColor:"#f04747",color:"white",fontWeight:"bold",cursor:"pointer",width:"100%",fontSize:"1em"},feedbackKnownBtn:{background:"transparent",border:"none",color:"#949ba4",fontSize:"0.9em",cursor:"pointer",padding:"10px",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",transition:"color 0.2s",opacity:.8},resultCard:{backgroundColor:"var(--background-secondary)",padding:"40px 20px",borderRadius:"20px",display:"flex",flexDirection:"column",alignItems:"center",boxShadow:"0 10px 25px rgba(0,0,0,0.3)",maxWidth:"400px",width:"100%",margin:"auto"},resultTitle:{fontSize:"1.8em",color:"#fff",margin:"10px 0"},resultScore:{fontSize:"1.4em",color:"#7289da",fontWeight:"bold",marginBottom:"20px"},resultMessage:{fontSize:"1.1em",color:"var(--text-muted)",marginBottom:"30px"},resultBtnGroup:{width:"100%",display:"flex",flexDirection:"column",gap:"10px"},primaryBtn:{width:"100%",padding:"15px",borderRadius:"10px",border:"none",backgroundColor:"#5865f2",color:"white",fontWeight:"bold",fontSize:"1em",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},secondaryBtn:{width:"100%",padding:"15px",borderRadius:"10px",border:"2px solid var(--background-tertiary)",backgroundColor:"transparent",color:"var(--text-secondary)",fontWeight:"bold",textAlign:"center",textDecoration:"none",boxSizing:"border-box",display:"block"}};export{pe as default};
