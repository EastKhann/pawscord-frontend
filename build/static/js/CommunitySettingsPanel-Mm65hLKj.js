import{r as d,d as e,G as O,i as k,ca as Q,cb as Y,bM as L,bO as N,dr as P,as as _,bu as B,az as H,ay as M,bk as I,dx as J,dy as U,m as V}from"./react-core-DrOm_csO.js";import{t as y}from"./index-DmEhdEtw.js";const le=({apiBaseUrl:n,serverId:c,onClose:s})=>{const[t,a]=d.useState({is_community:!1,rules_channel_id:"",public_updates_channel_id:"",verification_level:"medium",explicit_content_filter:"medium",default_notifications:"mentions",description:"",preferred_locale:"tr",features:{welcome_screen:!0,member_screening:!1,discovery:!1}}),[m,r]=d.useState([]),[b,p]=d.useState([]),[C,S]=d.useState([]),[F,T]=d.useState(!0),[f,h]=d.useState(!1),[u,g]=d.useState("general");d.useEffect(()=>{x(),$()},[]);const x=async()=>{try{const l=localStorage.getItem("access_token"),i=await fetch(`${n}/servers/${c}/community/settings/`,{headers:{Authorization:`Bearer ${l}`}});if(i.ok){const o=await i.json();a(E=>({...E,...o})),r(o.rules||[]),p(o.screening_questions||[])}}catch(l){console.error("Fetch settings error:",l)}finally{T(!1)}},$=async()=>{try{const l=localStorage.getItem("access_token"),i=await fetch(`${n}/servers/${c}/channels/`,{headers:{Authorization:`Bearer ${l}`}});if(i.ok){const o=await i.json();S((o.channels||o||[]).filter(E=>E.type!=="category"))}}catch(l){console.error("Fetch channels error:",l)}},w=async()=>{h(!0);try{const l=localStorage.getItem("access_token");(await fetch(`${n}/servers/${c}/community/settings/`,{method:"PUT",headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"},body:JSON.stringify({...t,rules:m,screening_questions:b})})).ok&&y.success("âœ… Topluluk ayarlarÄ± kaydedildi")}catch(l){console.error("Save error:",l),y.error("Kaydetme baÅŸarÄ±sÄ±z")}finally{h(!1)}},K=()=>{r(l=>[...l,{id:Date.now(),title:"",description:""}])},z=(l,i,o)=>{r(E=>E.map(v=>v.id===l?{...v,[i]:o}:v))},A=l=>{r(i=>i.filter(o=>o.id!==l))},R=()=>{p(l=>[...l,{id:Date.now(),question:"",required:!1}])},G=(l,i,o)=>{p(E=>E.map(v=>v.id===l?{...v,[i]:o}:v))},j=l=>{p(i=>i.filter(o=>o.id!==l))},q=[{value:"none",label:"Yok",description:"Herkes mesaj gÃ¶nderebilir"},{value:"low",label:"DÃ¼ÅŸÃ¼k",description:"E-posta doÄŸrulamasÄ± gerekli"},{value:"medium",label:"Orta",description:"5 dakika kayÄ±tlÄ± olmalÄ±"},{value:"high",label:"YÃ¼ksek",description:"10 dakika sunucuda olmalÄ±"},{value:"highest",label:"En YÃ¼ksek",description:"Telefon doÄŸrulamasÄ± gerekli"}],D=[{value:"disabled",label:"KapalÄ±",description:"Ä°Ã§erik filtresi yok"},{value:"medium",label:"Orta",description:"RolsÃ¼z Ã¼yeler iÃ§in filtrele"},{value:"high",label:"YÃ¼ksek",description:"TÃ¼m mesajlarÄ± filtrele"}];return F?e.createElement("div",{className:"community-settings-overlay",onClick:s},e.createElement("div",{className:"community-settings-panel",onClick:l=>l.stopPropagation()},e.createElement("div",{className:"loading"},"YÃ¼kleniyor..."))):e.createElement("div",{className:"community-settings-overlay",onClick:s},e.createElement("div",{className:"community-settings-panel",onClick:l=>l.stopPropagation()},e.createElement("div",{className:"panel-header"},e.createElement("h2",null,e.createElement(O,null)," Topluluk AyarlarÄ±"),e.createElement("button",{className:"close-btn",onClick:s},e.createElement(k,null))),e.createElement("div",{className:"community-toggle"},e.createElement("div",{className:"toggle-info"},e.createElement("span",{className:"toggle-label"},"Topluluk Sunucusu"),e.createElement("span",{className:"toggle-description"},"Topluluk Ã¶zelliklerini aktifleÅŸtir (keÅŸfet, karÅŸÄ±lama ekranÄ± vb.)")),e.createElement("button",{className:`toggle-btn ${t.is_community?"active":""}`,onClick:()=>a(l=>({...l,is_community:!l.is_community}))},t.is_community?e.createElement(Q,null):e.createElement(Y,null))),e.createElement("div",{className:"tabs"},e.createElement("button",{className:`tab ${u==="general"?"active":""}`,onClick:()=>g("general")},e.createElement(L,null)," Genel"),e.createElement("button",{className:`tab ${u==="rules"?"active":""}`,onClick:()=>g("rules")},e.createElement(N,null)," Kurallar"),e.createElement("button",{className:`tab ${u==="screening"?"active":""}`,onClick:()=>g("screening")},e.createElement(P,null)," Ãœye Tarama"),e.createElement("button",{className:`tab ${u==="safety"?"active":""}`,onClick:()=>g("safety")},e.createElement(_,null)," GÃ¼venlik")),e.createElement("div",{className:"panel-content"},u==="general"&&e.createElement(Z,{settings:t,setSettings:a,channels:C}),u==="rules"&&e.createElement(W,{rules:m,onAdd:K,onUpdate:z,onRemove:A}),u==="screening"&&e.createElement(X,{questions:b,onAdd:R,onUpdate:G,onRemove:j}),u==="safety"&&e.createElement(ee,{settings:t,setSettings:a,verificationLevels:q,contentFilters:D})),e.createElement("div",{className:"panel-footer"},e.createElement("button",{className:"cancel-btn",onClick:s},"Ä°ptal"),e.createElement("button",{className:"save-btn",onClick:w,disabled:f},e.createElement(B,null)," ",f?"Kaydediliyor...":"Kaydet"))))},Z=({settings:n,setSettings:c,channels:s})=>e.createElement("div",{className:"settings-tab"},e.createElement("div",{className:"form-group"},e.createElement("label",null,"Sunucu AÃ§Ä±klamasÄ±"),e.createElement("textarea",{value:n.description,onChange:t=>c(a=>({...a,description:t.target.value})),placeholder:"Sunucunuz hakkÄ±nda kÄ±sa bir aÃ§Ä±klama...",rows:"3",maxLength:300}),e.createElement("span",{className:"char-count"},n.description?.length||0,"/300")),e.createElement("div",{className:"form-row"},e.createElement("div",{className:"form-group"},e.createElement("label",null,e.createElement(N,null)," Kurallar KanalÄ±"),e.createElement("select",{value:n.rules_channel_id,onChange:t=>c(a=>({...a,rules_channel_id:t.target.value}))},e.createElement("option",{value:""},"SeÃ§in..."),s.map(t=>e.createElement("option",{key:t.id,value:t.id},"#",t.name)))),e.createElement("div",{className:"form-group"},e.createElement("label",null,e.createElement(H,null)," GÃ¼ncellemeler KanalÄ±"),e.createElement("select",{value:n.public_updates_channel_id,onChange:t=>c(a=>({...a,public_updates_channel_id:t.target.value}))},e.createElement("option",{value:""},"SeÃ§in..."),s.map(t=>e.createElement("option",{key:t.id,value:t.id},"#",t.name))))),e.createElement("div",{className:"form-row"},e.createElement("div",{className:"form-group"},e.createElement("label",null,e.createElement(M,null)," Tercih Edilen Dil"),e.createElement("select",{value:n.preferred_locale,onChange:t=>c(a=>({...a,preferred_locale:t.target.value}))},e.createElement("option",{value:"tr"},"ðŸ‡¹ðŸ‡· TÃ¼rkÃ§e"),e.createElement("option",{value:"en"},"ðŸ‡¬ðŸ‡§ English"),e.createElement("option",{value:"de"},"ðŸ‡©ðŸ‡ª Deutsch"),e.createElement("option",{value:"fr"},"ðŸ‡«ðŸ‡· FranÃ§ais"))),e.createElement("div",{className:"form-group"},e.createElement("label",null,e.createElement(I,null)," VarsayÄ±lan Bildirimler"),e.createElement("select",{value:n.default_notifications,onChange:t=>c(a=>({...a,default_notifications:t.target.value}))},e.createElement("option",{value:"all"},"TÃ¼m Mesajlar"),e.createElement("option",{value:"mentions"},"Sadece Etiketler")))),e.createElement("div",{className:"feature-toggles"},e.createElement("h4",null,"Ã–zellikler"),e.createElement("label",{className:"feature-item"},e.createElement("span",null,"KarÅŸÄ±lama EkranÄ±"),e.createElement("input",{type:"checkbox",checked:n.features?.welcome_screen,onChange:t=>c(a=>({...a,features:{...a.features,welcome_screen:t.target.checked}}))})),e.createElement("label",{className:"feature-item"},e.createElement("span",null,"Ãœye Tarama"),e.createElement("input",{type:"checkbox",checked:n.features?.member_screening,onChange:t=>c(a=>({...a,features:{...a.features,member_screening:t.target.checked}}))})),e.createElement("label",{className:"feature-item"},e.createElement("span",null,"Sunucu KeÅŸfet"),e.createElement("input",{type:"checkbox",checked:n.features?.discovery,onChange:t=>c(a=>({...a,features:{...a.features,discovery:t.target.checked}}))})))),W=({rules:n,onAdd:c,onUpdate:s,onRemove:t})=>e.createElement("div",{className:"settings-tab"},e.createElement("div",{className:"tab-header"},e.createElement("h4",null,"Sunucu KurallarÄ±"),e.createElement("button",{className:"add-btn",onClick:c},"+ Kural Ekle")),n.length===0?e.createElement("div",{className:"empty-rules"},e.createElement(J,null),e.createElement("p",null,"HenÃ¼z kural eklenmemiÅŸ")):e.createElement("div",{className:"rules-list"},n.map((a,m)=>e.createElement("div",{key:a.id,className:"rule-item"},e.createElement("span",{className:"rule-number"},m+1),e.createElement("div",{className:"rule-content"},e.createElement("input",{type:"text",placeholder:"Kural baÅŸlÄ±ÄŸÄ±...",value:a.title,onChange:r=>s(a.id,"title",r.target.value)}),e.createElement("textarea",{placeholder:"Kural aÃ§Ä±klamasÄ±...",value:a.description,onChange:r=>s(a.id,"description",r.target.value),rows:"2"})),e.createElement("button",{className:"remove-btn",onClick:()=>t(a.id)},e.createElement(k,null)))))),X=({questions:n,onAdd:c,onUpdate:s,onRemove:t})=>e.createElement("div",{className:"settings-tab"},e.createElement("div",{className:"tab-header"},e.createElement("h4",null,"Ãœye Tarama SorularÄ±"),e.createElement("button",{className:"add-btn",onClick:c},"+ Soru Ekle")),e.createElement("p",{className:"tab-description"},"Yeni Ã¼yeler sunucuya katÄ±lmadan Ã¶nce bu sorularÄ± yanÄ±tlamalÄ±dÄ±r."),n.length===0?e.createElement("div",{className:"empty-rules"},e.createElement(U,null),e.createElement("p",null,"HenÃ¼z soru eklenmemiÅŸ")):e.createElement("div",{className:"questions-list"},n.map((a,m)=>e.createElement("div",{key:a.id,className:"question-item"},e.createElement("span",{className:"question-number"},m+1),e.createElement("div",{className:"question-content"},e.createElement("input",{type:"text",placeholder:"Soruyu yazÄ±n...",value:a.question,onChange:r=>s(a.id,"question",r.target.value)}),e.createElement("label",{className:"required-toggle"},e.createElement("input",{type:"checkbox",checked:a.required,onChange:r=>s(a.id,"required",r.target.checked)}),e.createElement("span",null,"Zorunlu"))),e.createElement("button",{className:"remove-btn",onClick:()=>t(a.id)},e.createElement(k,null)))))),ee=({settings:n,setSettings:c,verificationLevels:s,contentFilters:t})=>e.createElement("div",{className:"settings-tab"},e.createElement("div",{className:"form-group"},e.createElement("label",null,e.createElement(_,null)," DoÄŸrulama Seviyesi"),e.createElement("div",{className:"level-options"},s.map(a=>e.createElement("label",{key:a.value,className:`level-option ${n.verification_level===a.value?"selected":""}`},e.createElement("input",{type:"radio",name:"verification",value:a.value,checked:n.verification_level===a.value,onChange:m=>c(r=>({...r,verification_level:m.target.value}))}),e.createElement("div",{className:"level-info"},e.createElement("span",{className:"level-label"},a.label),e.createElement("span",{className:"level-desc"},a.description)))))),e.createElement("div",{className:"form-group"},e.createElement("label",null,e.createElement(V,null)," Ä°Ã§erik Filtresi"),e.createElement("div",{className:"level-options"},t.map(a=>e.createElement("label",{key:a.value,className:`level-option ${n.explicit_content_filter===a.value?"selected":""}`},e.createElement("input",{type:"radio",name:"content-filter",value:a.value,checked:n.explicit_content_filter===a.value,onChange:m=>c(r=>({...r,explicit_content_filter:m.target.value}))}),e.createElement("div",{className:"level-info"},e.createElement("span",{className:"level-label"},a.label),e.createElement("span",{className:"level-desc"},a.description)))))));export{le as default};
