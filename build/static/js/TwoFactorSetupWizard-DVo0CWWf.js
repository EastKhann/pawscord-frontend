import{r as a,b as e}from"./react-core-9vc7GIjk.js";import{Z as k,a as I,aZ as w}from"./icons-vendor-u_f-1GKM.js";import{t as r}from"./index-Bm9YmRqY.js";import"./editor-vendor-DiU449Dh.js";import"./media-vendor-B-uSUaIv.js";import"./router-vendor-u6fxj6P4.js";import"./crypto-vendor-C1qXRpJv.js";import"./state-vendor-0vlBuk0v.js";const j=({fetchWithAuth:d,apiBaseUrl:u,onClose:m})=>{const[i,p]=a.useState(1),[f,x]=a.useState(""),[g,b]=a.useState(""),[y,h]=a.useState([]),[c,C]=a.useState(""),[l,s]=a.useState(!1),E=async()=>{s(!0);try{const n=await(await d(`${u}/auth/2fa/enable/`,{method:"POST"})).json();x(n.qr_code),b(n.secret),p(2),r.success("2FA setup initiated")}catch{r.error("Failed to start 2FA setup")}finally{s(!1)}},v=async()=>{if(!c||c.length!==6){r.error("Please enter a 6-digit code");return}s(!0);try{const n=await(await d(`${u}/auth/2fa/verify-setup/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:c})})).json();n.success?(h(n.backup_codes||[]),p(4),r.success("2FA enabled successfully!")):r.error("Invalid verification code")}catch{r.error("Failed to verify code")}finally{s(!1)}},S=()=>{navigator.clipboard.writeText(y.join(`
`)),r.success("Backup codes copied to clipboard")};return e.createElement("div",{style:t.overlay},e.createElement("div",{style:t.modal},e.createElement("div",{style:t.header},e.createElement("div",{style:t.headerLeft},e.createElement(k,{style:{marginRight:"10px",color:"#43b581"}}),e.createElement("h2",{style:t.title},"Two-Factor Authentication Setup")),e.createElement("button",{onClick:m,style:t.closeButton},e.createElement(I,null))),e.createElement("div",{style:t.content},i===1&&e.createElement("div",{style:t.stepContainer},e.createElement("div",{style:t.stepIcon},"ðŸ”’"),e.createElement("h3",{style:t.stepTitle},"Enhance Your Account Security"),e.createElement("p",{style:t.stepDescription},"Two-factor authentication adds an extra layer of security to your account. You'll need your phone's authentication app to complete setup."),e.createElement("div",{style:t.requirements},e.createElement("div",{style:t.requirementItem},"âœ“ Install an authenticator app (Google Authenticator, Authy, etc.)"),e.createElement("div",{style:t.requirementItem},"âœ“ Have your phone ready to scan a QR code"),e.createElement("div",{style:t.requirementItem},"âœ“ Save backup codes in a secure location")),e.createElement("button",{onClick:E,style:t.primaryButton,disabled:l},l?"Starting...":"Begin Setup")),i===2&&e.createElement("div",{style:t.stepContainer},e.createElement("div",{style:t.stepIcon},"ðŸ“±"),e.createElement("h3",{style:t.stepTitle},"Scan QR Code"),e.createElement("p",{style:t.stepDescription},"Open your authenticator app and scan this QR code."),f&&e.createElement("div",{style:t.qrContainer},e.createElement("img",{src:f,alt:"QR Code",style:t.qrCode})),e.createElement("div",{style:t.manualEntry},e.createElement("div",{style:t.manualLabel},"Or enter this code manually:"),e.createElement("div",{style:t.secretCode},g)),e.createElement("button",{onClick:()=>p(3),style:t.primaryButton},"Next Step")),i===3&&e.createElement("div",{style:t.stepContainer},e.createElement("div",{style:t.stepIcon},"ðŸ”‘"),e.createElement("h3",{style:t.stepTitle},"Verify Setup"),e.createElement("p",{style:t.stepDescription},"Enter the 6-digit code from your authenticator app to complete setup."),e.createElement("input",{type:"text",value:c,onChange:o=>C(o.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",style:t.codeInput,maxLength:6}),e.createElement("button",{onClick:v,style:t.primaryButton,disabled:l},l?"Verifying...":"Verify & Enable 2FA")),i===4&&e.createElement("div",{style:t.stepContainer},e.createElement("div",{style:t.stepIcon},"âœ…"),e.createElement("h3",{style:t.stepTitle},"Setup Complete!"),e.createElement("p",{style:t.stepDescription},"Save these backup codes in a secure location. You can use them if you lose access to your authenticator app."),e.createElement("div",{style:t.backupCodesContainer},y.map((o,n)=>e.createElement("div",{key:n,style:t.backupCode},o))),e.createElement("button",{onClick:S,style:t.copyButton},e.createElement(w,{style:{marginRight:"8px"}}),"Copy Backup Codes"),e.createElement("button",{onClick:m,style:t.primaryButton},"Done")))))},t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.9)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999},modal:{backgroundColor:"#1e1e1e",borderRadius:"8px",width:"90%",maxWidth:"550px",maxHeight:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.6)"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #2c2f33"},headerLeft:{display:"flex",alignItems:"center"},title:{margin:0,fontSize:"18px",color:"#ffffff"},closeButton:{background:"none",border:"none",color:"#99aab5",cursor:"pointer",fontSize:"20px",padding:"5px"},content:{padding:"32px",overflowY:"auto",flex:1},stepContainer:{display:"flex",flexDirection:"column",alignItems:"center",gap:"20px"},stepIcon:{fontSize:"64px"},stepTitle:{margin:0,fontSize:"22px",color:"#ffffff",textAlign:"center"},stepDescription:{margin:0,fontSize:"14px",color:"#dcddde",textAlign:"center",lineHeight:"1.5"},requirements:{width:"100%",backgroundColor:"#2c2f33",borderRadius:"8px",padding:"16px",display:"flex",flexDirection:"column",gap:"8px"},requirementItem:{fontSize:"14px",color:"#dcddde"},qrContainer:{backgroundColor:"#ffffff",borderRadius:"8px",padding:"16px"},qrCode:{width:"200px",height:"200px"},manualEntry:{width:"100%",backgroundColor:"#2c2f33",borderRadius:"8px",padding:"16px",textAlign:"center"},manualLabel:{fontSize:"12px",color:"#99aab5",marginBottom:"8px"},secretCode:{fontSize:"16px",fontFamily:"monospace",color:"#5865f2",fontWeight:"600",letterSpacing:"2px"},codeInput:{width:"200px",padding:"16px",fontSize:"24px",textAlign:"center",backgroundColor:"#2c2f33",border:"2px solid #5865f2",borderRadius:"8px",color:"#ffffff",fontFamily:"monospace",letterSpacing:"8px"},backupCodesContainer:{width:"100%",backgroundColor:"#2c2f33",borderRadius:"8px",padding:"16px",display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"12px"},backupCode:{fontSize:"14px",fontFamily:"monospace",color:"#dcddde",backgroundColor:"#1e1e1e",padding:"8px",borderRadius:"4px",textAlign:"center"},primaryButton:{padding:"12px 32px",backgroundColor:"#43b581",border:"none",borderRadius:"4px",color:"#ffffff",cursor:"pointer",fontSize:"16px",fontWeight:"600"},copyButton:{padding:"10px 24px",backgroundColor:"#5865f2",border:"none",borderRadius:"4px",color:"#ffffff",cursor:"pointer",fontSize:"14px",display:"flex",alignItems:"center"}};export{j as default};
