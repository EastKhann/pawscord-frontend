import{r as i,n as e}from"./react-core-zXIKm1Jm.js";import{t as o}from"./index-DzDUXmXs.js";import{G as v,c1 as f,q as S,cJ as k,ac as D,bn as F}from"./icons-vendor-BBdoVeJd.js";import"./editor-vendor-DiU449Dh.js";import"./media-vendor-BSOZ7IB3.js";import"./router-vendor-PJALNo1v.js";import"./crypto-vendor-D_AcF0lD.js";import"./state-vendor-8NbFPBhQ.js";const H=({username:z,apiBaseUrl:u,fetchWithAuth:h,currentRoomSlug:C})=>{const[n,x]=i.useState("chat"),[b,j]=i.useState([]),[c,d]=i.useState(""),[m,l]=i.useState(!1),[p,w]=i.useState({used:0,limit:100}),[y,A]=i.useState([]),g=i.useRef(null);i.useEffect(()=>{N()},[]),i.useEffect(()=>{I()},[b]);const I=()=>{g.current?.scrollIntoView({behavior:"smooth"})},N=async()=>{try{const a=await(await h(`${u}/ai/quota/`)).json();w(a)}catch(s){console.error("Failed to fetch AI quota:",s)}},$=async s=>{if(s.preventDefault(),!c.trim()||m)return;const a=c.trim();d(""),j(t=>[...t,{role:"user",content:a,timestamp:new Date}]),l(!0);try{const r=await(await h(`${u}/ai/chat/`,{method:"POST",body:JSON.stringify({message:a,context:C||"general"})})).json();j(q=>[...q,{role:"assistant",content:r.response,timestamp:new Date}]),N(),o.success("ğŸ¤– AI yanÄ±tladÄ±!")}catch(t){console.error("AI chat error:",t),o.error("âŒ AI hatasÄ±!"),j(r=>[...r,{role:"assistant",content:"ÃœzgÃ¼nÃ¼m, bir hata oluÅŸtu.",timestamp:new Date,error:!0}])}finally{l(!1)}},R=async s=>{l(!0);try{const t=await(await h(`${u}/ai/smart-reply/`,{method:"POST",body:JSON.stringify({message_id:s,count:3})})).json();A(t.suggestions||[]),o.success("ğŸ’¡ AkÄ±llÄ± cevaplar hazÄ±r!")}catch(a){console.error("Smart reply error:",a),o.error("âŒ AkÄ±llÄ± cevap hatasÄ±!")}finally{l(!1)}},K=async s=>{l(!0);try{const t=await(await h(`${u}/ai/summarize/`,{method:"POST",body:JSON.stringify({message_ids:s,max_length:200})})).json();j(r=>[...r,{role:"assistant",content:`ğŸ“ **Ã–zet:**

${t.summary}`,timestamp:new Date,type:"summary"}]),o.success("ğŸ“ Mesajlar Ã¶zetlendi!")}catch(a){console.error("Summarize error:",a),o.error("âŒ Ã–zetleme hatasÄ±!")}finally{l(!1)}},O=async s=>{l(!0);try{const t=await(await h(`${u}/ai/code/`,{method:"POST",body:JSON.stringify({prompt:s,language:"javascript"})})).json();j(r=>[...r,{role:"assistant",content:`\`\`\`${t.language}
${t.code}
\`\`\`

${t.explanation||""}`,timestamp:new Date,type:"code"}]),o.success("ğŸ’» Kod oluÅŸturuldu!")}catch(a){console.error("Code generation error:",a),o.error("âŒ Kod Ã¼retme hatasÄ±!")}finally{l(!1)}},T=()=>{const s=p.used/p.limit*100,a=s>90?"#ed4245":s>70?"#faa61a":"#43b581";return e.jsxs("div",{className:"ai-quota-container",children:[e.jsxs("div",{className:"ai-quota-info",children:[e.jsx(F,{}),e.jsxs("span",{children:["AI KullanÄ±m: ",p.used," / ",p.limit]})]}),e.jsx("div",{className:"ai-quota-bar",children:e.jsx("div",{className:"ai-quota-fill",style:{width:`${s}%`,backgroundColor:a}})})]})};return e.jsxs("div",{className:"ai-chatbot-panel",children:[e.jsxs("div",{className:"ai-header",children:[e.jsxs("div",{className:"ai-header-left",children:[e.jsx(v,{size:28}),e.jsxs("div",{children:[e.jsx("h3",{className:"ai-title",children:"AI Assistant"}),e.jsx("p",{className:"ai-subtitle",children:"Discord'u geÃ§en AI Ã¶zellikleri"})]})]}),T()]}),e.jsxs("div",{className:"ai-tabs",children:[e.jsxs("button",{className:n==="chat"?"active":"",onClick:()=>x("chat"),children:[e.jsx(v,{})," Chat"]}),e.jsxs("button",{className:n==="smart-reply"?"active":"",onClick:()=>x("smart-reply"),children:[e.jsx(f,{})," Smart Reply"]}),e.jsxs("button",{className:n==="summarize"?"active":"",onClick:()=>x("summarize"),children:[e.jsx(S,{})," Ã–zetle"]}),e.jsxs("button",{className:n==="code"?"active":"",onClick:()=>x("code"),children:[e.jsx(k,{})," Kod OluÅŸtur"]})]}),n==="chat"&&e.jsxs("div",{className:"ai-chat-container",children:[e.jsxs("div",{className:"ai-messages",children:[b.length===0?e.jsxs("div",{className:"ai-empty-state",children:[e.jsx(v,{size:48}),e.jsx("h4",{children:"AI Assistant'a HoÅŸ Geldin!"}),e.jsx("p",{children:"Soru sor, kod yazdÄ±r, mesajlarÄ± Ã¶zetle veya aÃ§Ä±klama iste."}),e.jsxs("div",{className:"ai-suggestions",children:[e.jsx("button",{onClick:()=>d("JavaScript ile bir todo list nasÄ±l yapÄ±lÄ±r?"),children:"ğŸ’» Kod Ã¶rneÄŸi iste"}),e.jsx("button",{onClick:()=>d("React hooks nedir?"),children:"ğŸ“ Kavram aÃ§Ä±kla"}),e.jsx("button",{onClick:()=>d("BugÃ¼n hava nasÄ±l?"),children:"ğŸ’¬ Sohbet et"})]})]}):b.map((s,a)=>e.jsxs("div",{className:`ai-message ${s.role} ${s.error?"error":""}`,children:[e.jsx("div",{className:"ai-message-avatar",children:s.role==="user"?"ğŸ‘¤":"ğŸ¤–"}),e.jsxs("div",{className:"ai-message-content",children:[e.jsxs("div",{className:"ai-message-header",children:[e.jsx("strong",{children:s.role==="user"?z:"AI Assistant"}),e.jsx("span",{className:"ai-message-time",children:s.timestamp.toLocaleTimeString("tr-TR",{hour:"2-digit",minute:"2-digit"})})]}),e.jsx("div",{className:"ai-message-text",children:s.content.split("```").map((t,r)=>r%2===0?e.jsx("span",{children:t},r):e.jsx("pre",{className:"ai-code-block",children:e.jsx("code",{children:t})},r))})]})]},a)),e.jsx("div",{ref:g})]}),e.jsxs("form",{onSubmit:$,className:"ai-input-form",children:[e.jsx("input",{type:"text",value:c,onChange:s=>d(s.target.value),placeholder:"AI'ya bir ÅŸey sor...",disabled:m,className:"ai-input"}),e.jsx("button",{type:"submit",disabled:m||!c.trim(),className:"ai-send-btn",children:m?"â³":e.jsx(D,{})})]})]}),n==="smart-reply"&&e.jsxs("div",{className:"ai-feature-container",children:[e.jsxs("div",{className:"ai-feature-header",children:[e.jsx(f,{size:32}),e.jsx("h4",{children:"AkÄ±llÄ± Cevap Ã–nerileri"}),e.jsx("p",{children:"Mesajlara otomatik yanÄ±t Ã¶nerileri"})]}),e.jsx("button",{onClick:()=>R("last-message-id"),disabled:m,className:"ai-action-btn",children:"ğŸ’¡ Son Mesaja AkÄ±llÄ± Cevap Ã–ner"}),y.length>0&&e.jsxs("div",{className:"ai-smart-replies",children:[e.jsx("h5",{children:"Ã–nerilen Cevaplar:"}),y.map((s,a)=>e.jsxs("div",{className:"ai-smart-reply-item",children:[e.jsx("span",{children:s}),e.jsx("button",{onClick:()=>d(s),children:"Kullan"})]},a))]})]}),n==="summarize"&&e.jsxs("div",{className:"ai-feature-container",children:[e.jsxs("div",{className:"ai-feature-header",children:[e.jsx(S,{size:32}),e.jsx("h4",{children:"Mesaj Ã–zetleme"}),e.jsx("p",{children:"Uzun konuÅŸmalarÄ± tek paragrafta Ã¶zetle"})]}),e.jsx("button",{onClick:()=>K(["msg1","msg2","msg3"]),disabled:m,className:"ai-action-btn",children:"ğŸ“ Son 50 MesajÄ± Ã–zetle"})]}),n==="code"&&e.jsxs("div",{className:"ai-feature-container",children:[e.jsxs("div",{className:"ai-feature-header",children:[e.jsx(k,{size:32}),e.jsx("h4",{children:"Kod Ãœretimi"}),e.jsx("p",{children:"AI ile kod yaz, GitHub Copilot gibi"})]}),e.jsxs("form",{onSubmit:s=>{s.preventDefault(),O(c)},className:"ai-code-form",children:[e.jsx("textarea",{value:c,onChange:s=>d(s.target.value),placeholder:"Ne yapmak istiyorsun? Ã–rn: 'React'te bir sayaÃ§ komponenti yap'",rows:4,className:"ai-code-textarea"}),e.jsx("button",{type:"submit",disabled:m||!c.trim(),className:"ai-action-btn",children:"ğŸ’» Kod Ãœret"})]})]})]})};export{H as default};
