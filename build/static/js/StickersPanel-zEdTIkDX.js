import{r as c,d as e}from"./react-core-DrOm_csO.js";const z=({serverId:r,onClose:p})=>{const[n,u]=c.useState([]),[E,P]=c.useState([]),[g,i]=c.useState(!0),[l,f]=c.useState("my-stickers"),[$,o]=c.useState(!1),[h,N]=c.useState(!1),[m,y]=c.useState(""),[d,S]=c.useState(null),[v,b]=c.useState("");c.useEffect(()=>{l==="my-stickers"?w():C()},[l,r]);const w=async()=>{try{i(!0);const t=localStorage.getItem("access_token"),a=await fetch(`/api/stickers/${r}/list/`,{headers:{Authorization:`Bearer ${t}`}});if(a.ok){const s=await a.json();u(s.stickers||[])}}catch(t){console.error("Error fetching stickers:",t)}finally{i(!1)}},C=async()=>{try{i(!0);const t=localStorage.getItem("access_token"),a=await fetch("/api/stickers/packs/",{headers:{Authorization:`Bearer ${t}`}});if(a.ok){const s=await a.json();P(s.packs||[])}}catch(t){console.error("Error fetching sticker packs:",t)}finally{i(!1)}},F=async()=>{if(!m.trim()||!d){console.error("âŒ Please provide sticker name and file");return}const t=new FormData;t.append("name",m),t.append("sticker",d);try{N(!0);const a=localStorage.getItem("access_token"),s=await fetch(`/api/stickers/${r}/upload/`,{method:"POST",headers:{Authorization:`Bearer ${a}`},body:t});if(s.ok)console.log("âœ… Sticker uploaded"),o(!1),y(""),S(null),b(""),w();else{const k=await s.json();console.error("âŒ",k.error||"Failed to upload sticker")}}catch(a){console.error("Error uploading sticker:",a)}finally{N(!1)}},U=async t=>{if(window.confirm("Delete this sticker?"))try{const a=localStorage.getItem("access_token");(await fetch(`/api/stickers/${r}/${t}/delete/`,{method:"DELETE",headers:{Authorization:`Bearer ${a}`}})).ok?(console.log("âœ… Sticker deleted"),u(n.filter(k=>k.id!==t))):console.error("âŒ Failed to delete sticker")}catch(a){console.error("Error deleting sticker:",a)}},B=async t=>{try{const a=localStorage.getItem("access_token");(await fetch(`/api/stickers/${r}/install-pack/`,{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify({pack_id:t})})).ok?(console.log("âœ… Sticker pack installed"),C()):console.error("âŒ Failed to install pack")}catch(a){console.error("Error installing pack:",a)}},_=t=>{const a=t.target.files[0];if(a){if(!a.type.startsWith("image/")){console.error("âŒ Please select an image file");return}if(a.size>512*1024){console.error("âŒ File size must be less than 512KB");return}S(a),b(URL.createObjectURL(a))}};return e.createElement("div",{className:"stickers-panel-overlay",onClick:p},e.createElement("div",{className:"stickers-panel-modal",onClick:t=>t.stopPropagation()},e.createElement("div",{className:"stickers-panel-header"},e.createElement("h2",null,"ðŸŽ¨ Stickers"),e.createElement("button",{className:"close-btn",onClick:p},"âœ•")),e.createElement("div",{className:"stickers-tabs"},e.createElement("button",{className:`tab-btn ${l==="my-stickers"?"active":""}`,onClick:()=>f("my-stickers")},"ðŸ“ My Stickers"),e.createElement("button",{className:`tab-btn ${l==="packs"?"active":""}`,onClick:()=>f("packs")},"ðŸ“¦ Sticker Packs")),e.createElement("div",{className:"stickers-panel-content"},l==="my-stickers"&&e.createElement(e.Fragment,null,e.createElement("div",{className:"sticker-actions"},e.createElement("button",{className:"upload-sticker-btn",onClick:()=>o(!0)},"âž• Upload Sticker"),e.createElement("p",{className:"sticker-count"},n.length," stickers")),g?e.createElement("div",{className:"loading-spinner"},"Loading stickers..."):n.length===0?e.createElement("div",{className:"empty-state"},e.createElement("div",{className:"empty-icon"},"ðŸŽ¨"),e.createElement("h3",null,"No Stickers Yet"),e.createElement("p",null,"Upload your first custom sticker")):e.createElement("div",{className:"stickers-grid"},n.map(t=>e.createElement("div",{key:t.id,className:"sticker-card"},e.createElement("img",{src:t.url,alt:t.name,className:"sticker-image"}),e.createElement("div",{className:"sticker-name"},t.name),e.createElement("button",{className:"delete-sticker-btn",onClick:()=>U(t.id),title:"Delete"},"ðŸ—‘ï¸"))))),l==="packs"&&e.createElement(e.Fragment,null,g?e.createElement("div",{className:"loading-spinner"},"Loading packs..."):E.length===0?e.createElement("div",{className:"empty-state"},e.createElement("div",{className:"empty-icon"},"ðŸ“¦"),e.createElement("h3",null,"No Packs Available"),e.createElement("p",null,"Check back later for new sticker packs")):e.createElement("div",{className:"packs-grid"},E.map(t=>e.createElement("div",{key:t.id,className:"pack-card"},e.createElement("div",{className:"pack-preview"},t.preview_stickers?.slice(0,4).map((a,s)=>e.createElement("img",{key:s,src:a.url,alt:"",className:"pack-preview-img"}))),e.createElement("div",{className:"pack-info"},e.createElement("h3",null,t.name),e.createElement("p",null,t.sticker_count," stickers")),e.createElement("button",{className:`install-pack-btn ${t.installed?"installed":""}`,onClick:()=>!t.installed&&B(t.id),disabled:t.installed},t.installed?"âœ“ Installed":"âž• Install")))))),$&&e.createElement("div",{className:"upload-modal-overlay",onClick:()=>o(!1)},e.createElement("div",{className:"upload-modal",onClick:t=>t.stopPropagation()},e.createElement("h3",null,"âž• Upload Sticker"),e.createElement("div",{className:"form-group"},e.createElement("label",null,"Sticker Name"),e.createElement("input",{type:"text",value:m,onChange:t=>y(t.target.value),placeholder:"My Sticker",maxLength:32,className:"sticker-name-input"})),e.createElement("div",{className:"form-group"},e.createElement("label",null,"Sticker Image"),e.createElement("div",{className:"file-upload-area",onClick:()=>document.getElementById("sticker-file").click()},v?e.createElement("img",{src:v,alt:"Preview",className:"upload-preview"}):e.createElement(e.Fragment,null,e.createElement("div",{className:"upload-icon"},"ðŸ“¤"),e.createElement("p",null,"Click to select image"),e.createElement("p",{className:"upload-hint"},"PNG, GIF â€¢ Max 512KB â€¢ 512x512px recommended"))),e.createElement("input",{id:"sticker-file",type:"file",accept:"image/*",onChange:_,style:{display:"none"}})),e.createElement("div",{className:"modal-actions"},e.createElement("button",{className:"cancel-btn",onClick:()=>o(!1)},"Cancel"),e.createElement("button",{className:"upload-btn",onClick:F,disabled:h||!m||!d},h?"Uploading...":"Upload"))))))};export{z as default};
