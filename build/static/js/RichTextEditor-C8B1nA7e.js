import{r,aL as b,aM as g,aN as D,aO as R,aP as w,H as M,J as S,aQ as I}from"./react-core-B6hadH-M.js";import{u as F,i as W,a as v,E as A}from"./tiptap-BCdCrRso.js";import"./recharts-D4RWr7CS.js";const z=[{name:"zar-at",description:"1-100 arası zar at",icon:React.createElement(g,null)},{name:"yazitura",description:"Yazı tura at",icon:React.createElement(D,null)},{name:"tkm",description:"Taş Kağıt Makas oyna (@kullanici)",icon:React.createElement(R,null)},{name:"xox",description:"XOX oyunu başlat",icon:React.createElement(g,null)},{name:"sec",description:"Seçeneklerden birini seç (/sec a b c)",icon:React.createElement(b,null)},{name:"cuzdan",description:"Coin bakiyeni gör",icon:React.createElement(w,null)},{name:"transfer",description:"Coin gönder (/transfer @kullanici miktar)",icon:React.createElement(w,null)},{name:"kanban",description:"Kanban panosunu aç",icon:React.createElement(g,null)},{name:"kod",description:"Python kodu çalıştır",icon:React.createElement(M,null)},{name:"resimgelismis",description:"AI ile resim çiz",icon:React.createElement(R,null)},{name:"temizle",description:"Mesajları sil (Admin)",icon:React.createElement(S,null),adminOnly:!0},{name:"yardim",description:"Komut listesini gör",icon:React.createElement(b,null)},{name:"tema",description:"Tema Mağazasını Aç",icon:React.createElement(g,null)},{name:"duyuru",description:"Sabit Duyuru Yap (/duyuru mesaj)",icon:React.createElement(S,null),adminOnly:!0},{name:"sablon",description:"Hazır Şablonlar",icon:React.createElement(I,null)},{name:"shrug",description:"¯\\_(ツ)_/¯ gönder",icon:React.createElement(R,null)}],L=({query:o,onSelect:m,activeIndex:x})=>{const[s,h]=r.useState([]);return r.useEffect(()=>{if(o==null)return;const i=o.toLowerCase().replace("/",""),a=z.filter(c=>c.name.toLowerCase().startsWith(i));h(a)},[o]),s.length===0?null:React.createElement("div",{style:p.container},React.createElement("div",{style:p.header},React.createElement(b,{style:{marginRight:6}}),"KOMUTLAR"),React.createElement("div",{style:p.list},s.map((i,a)=>React.createElement("div",{key:i.name,onClick:()=>m(i),style:{...p.item,backgroundColor:a===x?"#5865f2":"transparent"}},React.createElement("div",{style:p.iconWrapper},i.icon),React.createElement("div",{style:p.textWrapper},React.createElement("span",{style:{fontWeight:"bold",color:"white"}},"/",i.name),React.createElement("span",{style:{fontSize:"0.85em",color:a===x?"#eee":"#b9bbbe",marginLeft:8}},i.description))))))},p={container:{position:"absolute",bottom:"100%",left:0,width:"300px",maxHeight:"300px",backgroundColor:"#2f3136",borderRadius:"8px",boxShadow:"0 -4px 15px rgba(0,0,0,0.4)",display:"flex",flexDirection:"column",marginBottom:"10px",overflow:"hidden",zIndex:1e3,border:"1px solid rgba(255,255,255,0.05)"},header:{padding:"8px 12px",fontSize:"0.75em",fontWeight:"bold",color:"#b9bbbe",backgroundColor:"#202225",borderBottom:"1px solid rgba(255,255,255,0.05)",display:"flex",alignItems:"center",letterSpacing:"0.5px"},list:{overflowY:"auto",padding:"0"},item:{display:"flex",alignItems:"center",padding:"10px 12px",cursor:"pointer",transition:"background-color 0.1s"},iconWrapper:{display:"flex",alignItems:"center",justifyContent:"center",width:"24px",height:"24px",marginRight:"10px",color:"white",fontSize:"1.1em"},textWrapper:{display:"flex",alignItems:"center",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}},O=r.forwardRef(({onSend:o,onChange:m,placeholder:x,initialValue:s="",onFileUpload:h},i)=>{const a=r.useRef(!1),[c,f]=r.useState(null),[C,y]=r.useState(0),e=F({extensions:[W,v.configure({placeholder:x||"Bir mesaj yaz..."})],content:s,editorProps:{handlePaste:(n,t,l)=>{const u=t.clipboardData?.items;if(u&&h)for(let d=0;d<u.length;d++){const E=u[d];if(E.kind==="file"){t.preventDefault();const k=E.getAsFile();return k&&h(k),!0}}return!1},handleKeyDown:(n,t)=>{if(c!==null){if(t.key==="ArrowUp")return t.preventDefault(),y(l=>Math.max(0,l-1)),!0;if(t.key==="ArrowDown")return t.preventDefault(),y(l=>l+1),!0;if(t.key==="Enter"){t.preventDefault();const l=c.toLowerCase().replace("/",""),u=z.filter(d=>d.name.toLowerCase().startsWith(l));if(u.length>0){const d=Math.max(0,Math.min(C,u.length-1)),E=u[d];e.commands.setContent(`/${E.name} `),e.commands.focus("end"),f(null)}return!0}if(t.key==="Escape")return t.preventDefault(),f(null),!0}if(t.key==="Enter"&&!t.shiftKey){if(t.preventDefault(),c!==null)return!0;const l=n.state.doc.textContent;return l.trim().length>0&&(a.current=!0,o(l),e.commands.clearContent(),m?.(""),setTimeout(()=>{a.current=!1},100)),!0}return!1}}});r.useEffect(()=>{if(!e)return;const n=()=>{if(a.current)return;const t=e.getText().trim();t.startsWith("/")?t.includes(" ")?f(null):(f(t),y(0)):c!==null&&f(null),m?.(t)};return e.on("update",n),()=>e.off("update",n)},[e,m]),r.useEffect(()=>{if(!e)return;const n=e.getText();s===""&&n!==""?e.commands.clearContent():s!==""&&n===""&&e.commands.setContent(s)},[e,s]);const T=r.useCallback(()=>{e&&e.chain().focus().run()},[e]);return r.useImperativeHandle(i,()=>({send:()=>{if(!e)return;const n=e.getText().trim();n&&(a.current=!0,o(n),e.commands.clearContent(),m?.(""),setTimeout(()=>{a.current=!1},100))},clear:()=>e?.commands.clearContent(),hasContent:()=>!!e?.getText().trim(),appendText:n=>{!e||!n||e.chain().focus().insertContent(n).run()}}),[e,o,m]),e?React.createElement("div",{className:"rich-editor-wrapper",onClick:T,role:"textbox","aria-label":"Mesaj editörü"},React.createElement(A,{editor:e,className:"tiptap-editor"}),c!==null&&React.createElement(L,{query:c,activeIndex:C,onSelect:n=>{e&&(e.commands.setContent(`/${n.name} `),e.commands.focus("end"),f(null))}})):null});O.displayName="RichTextEditor";export{O as default};
