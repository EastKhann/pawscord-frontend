import{r,b as e}from"./react-core-9vc7GIjk.js";import{R as _,i as m,a as g,bu as h,C as f,bt as k,bk as $,O as v,z as w}from"./icons-vendor-NoxEirJf.js";import{g as C}from"./index-DR3ngHaW.js";import"./editor-vendor-DiU449Dh.js";import"./media-vendor-B-uSUaIv.js";import"./router-vendor-u6fxj6P4.js";import"./crypto-vendor-C1qXRpJv.js";import"./state-vendor-0vlBuk0v.js";const z=({serverId:u,onClose:i,fetchWithAuth:d})=>{const[t,o]=r.useState(null),[b,p]=r.useState(!0),[l,n]=r.useState("overview"),[E,j]=r.useState("week"),N=r.useCallback(async()=>{p(!0);try{const a=await d(`${C()}/servers/${u}/reaction-stats/?range=${E}`);if(a.ok){const s=await a.json();o(s)}else o({total_reactions:0,unique_emojis:0,top_emojis:[],top_reactors:[],hourly_distribution:Array(24).fill(0),daily_trend:[],most_reacted_messages:[]})}catch(a){console.error("Error loading reaction stats:",a),o({total_reactions:0,unique_emojis:0,top_emojis:[],top_reactors:[],hourly_distribution:Array(24).fill(0),daily_trend:[],most_reacted_messages:[]})}p(!1)},[u,E,d]);r.useEffect(()=>{N()},[N]);const c=a=>a>=1e6?(a/1e6).toFixed(1)+"M":a>=1e3?(a/1e3).toFixed(1)+"K":a?.toString()||"0",y=()=>t?.hourly_distribution?Math.max(...t.hourly_distribution,1):1;return b?e.createElement("div",{className:"reaction-stats-overlay",onClick:i},e.createElement("div",{className:"reaction-stats-panel",onClick:a=>a.stopPropagation()},e.createElement("div",{className:"loading-spinner"},e.createElement(_,{className:"spin"}),e.createElement("span",null,"Loading reaction statistics...")))):e.createElement("div",{className:"reaction-stats-overlay",onClick:i},e.createElement("div",{className:"reaction-stats-panel",onClick:a=>a.stopPropagation()},e.createElement("div",{className:"panel-header"},e.createElement("div",{className:"header-info"},e.createElement("h2",null,e.createElement(m,null)," Reaction Statistics"),e.createElement("span",{className:"subtitle"},"Discover emoji trends and patterns")),e.createElement("div",{className:"header-actions"},e.createElement("select",{value:E,onChange:a=>j(a.target.value),className:"time-range-select"},e.createElement("option",{value:"day"},"Last 24 Hours"),e.createElement("option",{value:"week"},"Last 7 Days"),e.createElement("option",{value:"month"},"Last 30 Days"),e.createElement("option",{value:"all"},"All Time")),e.createElement("button",{className:"close-btn",onClick:i},e.createElement(g,null)))),e.createElement("div",{className:"stats-overview"},e.createElement("div",{className:"stat-card"},e.createElement("div",{className:"stat-icon"},e.createElement(h,null)),e.createElement("div",{className:"stat-info"},e.createElement("span",{className:"stat-value"},c(t?.total_reactions)),e.createElement("span",{className:"stat-label"},"Total Reactions"))),e.createElement("div",{className:"stat-card"},e.createElement("div",{className:"stat-icon"},e.createElement(m,null)),e.createElement("div",{className:"stat-info"},e.createElement("span",{className:"stat-value"},c(t?.unique_emojis)),e.createElement("span",{className:"stat-label"},"Unique Emojis"))),e.createElement("div",{className:"stat-card"},e.createElement("div",{className:"stat-icon"},e.createElement(f,null)),e.createElement("div",{className:"stat-info"},e.createElement("span",{className:"stat-value"},c(t?.top_reactors?.length)),e.createElement("span",{className:"stat-label"},"Active Reactors"))),e.createElement("div",{className:"stat-card"},e.createElement("div",{className:"stat-icon"},e.createElement(k,null)),e.createElement("div",{className:"stat-info"},e.createElement("span",{className:"stat-value"},t?.top_emojis?.[0]?.emoji||"ðŸ”¥"),e.createElement("span",{className:"stat-label"},"Top Emoji")))),e.createElement("div",{className:"tabs"},e.createElement("button",{className:`tab ${l==="overview"?"active":""}`,onClick:()=>n("overview")},e.createElement($,null)," Overview"),e.createElement("button",{className:`tab ${l==="emojis"?"active":""}`,onClick:()=>n("emojis")},e.createElement(m,null)," Top Emojis"),e.createElement("button",{className:`tab ${l==="users"?"active":""}`,onClick:()=>n("users")},e.createElement(v,null)," Top Reactors"),e.createElement("button",{className:`tab ${l==="time"?"active":""}`,onClick:()=>n("time")},e.createElement(w,null)," Activity Pattern")),e.createElement("div",{className:"tab-content"},l==="overview"&&e.createElement("div",{className:"overview-tab"},e.createElement("div",{className:"section"},e.createElement("h3",null,"ðŸ”¥ Trending Emojis"),e.createElement("div",{className:"emoji-grid"},(t?.top_emojis||[]).slice(0,10).map((a,s)=>e.createElement("div",{key:s,className:"emoji-item"},e.createElement("span",{className:"emoji"},a.emoji),e.createElement("span",{className:"count"},c(a.count)),e.createElement("div",{className:"progress-bar"},e.createElement("div",{className:"progress",style:{width:`${a.count/(t?.top_emojis?.[0]?.count||1)*100}%`}})))),(!t?.top_emojis||t.top_emojis.length===0)&&e.createElement("div",{className:"empty-state"},"No reaction data yet")))),l==="emojis"&&e.createElement("div",{className:"emojis-tab"},e.createElement("div",{className:"emoji-leaderboard"},(t?.top_emojis||[]).map((a,s)=>e.createElement("div",{key:s,className:`leaderboard-item ${s<3?"top-three":""}`},e.createElement("span",{className:"rank"},"#",s+1),e.createElement("span",{className:"emoji-large"},a.emoji),e.createElement("div",{className:"emoji-details"},e.createElement("span",{className:"emoji-name"},a.name||"Custom Emoji"),e.createElement("span",{className:"emoji-usage"},c(a.count)," uses")),e.createElement("div",{className:"emoji-bar"},e.createElement("div",{className:"bar-fill",style:{width:`${a.count/(t?.top_emojis?.[0]?.count||1)*100}%`}})))),(!t?.top_emojis||t.top_emojis.length===0)&&e.createElement("div",{className:"empty-state"},e.createElement(m,{size:48}),e.createElement("p",null,"No emoji data available")))),l==="users"&&e.createElement("div",{className:"users-tab"},e.createElement("div",{className:"user-leaderboard"},(t?.top_reactors||[]).map((a,s)=>e.createElement("div",{key:s,className:`user-item ${s<3?"top-three":""}`},e.createElement("span",{className:`rank rank-${s+1}`},s<3?e.createElement(v,null):`#${s+1}`),e.createElement("div",{className:"user-avatar"},a.avatar?e.createElement("img",{src:a.avatar,alt:a.username}):a.username?.charAt(0).toUpperCase()||"?"),e.createElement("div",{className:"user-info"},e.createElement("span",{className:"username"},a.username),e.createElement("span",{className:"reaction-count"},c(a.count)," reactions")),e.createElement("div",{className:"user-favorite"},e.createElement("span",{className:"favorite-emoji"},a.favorite_emoji||"â¤ï¸")))),(!t?.top_reactors||t.top_reactors.length===0)&&e.createElement("div",{className:"empty-state"},e.createElement(v,{size:48}),e.createElement("p",null,"No reactor data available")))),l==="time"&&e.createElement("div",{className:"time-tab"},e.createElement("div",{className:"section"},e.createElement("h3",null,"â° Hourly Activity"),e.createElement("div",{className:"hourly-chart"},(t?.hourly_distribution||Array(24).fill(0)).map((a,s)=>e.createElement("div",{key:s,className:"hour-bar"},e.createElement("div",{className:"bar",style:{height:`${Math.max(a/y()*100,5)}%`},title:`${s}:00 - ${a} reactions`}),e.createElement("span",{className:"hour-label"},s)))),e.createElement("p",{className:"chart-note"},"Hours shown in your local timezone"))))))};export{z as default};
