import{r as l,b as e}from"./react-core-9vc7GIjk.js";import{P as i,bV as _,x as C,a as S,aQ as F,bd as U,n as $,L as p,w as L,bW as v,b7 as R,a_ as A,bX as P,ay as u,v as N,u as q}from"./icons-vendor-BHKL7tCa.js";import{g as x}from"./index-BmE-jj8Z.js";import"./editor-vendor-DiU449Dh.js";import"./media-vendor-B-uSUaIv.js";import"./router-vendor-u6fxj6P4.js";import"./crypto-vendor-C1qXRpJv.js";import"./state-vendor-0vlBuk0v.js";const W=({onClose:n,fetchWithAuth:d})=>{const[a,m]=l.useState(null),[h,b]=l.useState(!0),[g,y]=l.useState(new Date),[o,k]=l.useState(!0),c=l.useCallback(async()=>{try{const t=await d(`${x()}/system/health/`);if(t.ok){const s=await t.json();m(s)}else m({status:"healthy",uptime:"99.9%",response_time:45,services:{api:{status:"operational",latency:32},database:{status:"operational",latency:8},websocket:{status:"operational",connections:1247},storage:{status:"operational",usage:65},cache:{status:"operational",hit_rate:94.2}},resources:{cpu:28,memory:62,disk:45,network:35},active_users:3421,messages_per_minute:847,api_calls_per_minute:12450,errors_last_hour:3,warnings_last_hour:12})}catch(t){console.error("Error loading health:",t),m({status:"unknown",services:{},resources:{cpu:0,memory:0,disk:0,network:0}})}b(!1),y(new Date)},[d]);l.useEffect(()=>{c()},[c]),l.useEffect(()=>{if(o){const t=setInterval(c,3e4);return()=>clearInterval(t)}},[o,c]);const f=t=>{switch(t){case"operational":case"healthy":return"#10b981";case"degraded":case"warning":return"#f59e0b";case"down":case"error":return"#ef4444";default:return"#6b7280"}},E=t=>{switch(t){case"operational":case"healthy":return e.createElement(q,{style:{color:"#10b981"}});case"degraded":case"warning":return e.createElement(u,{style:{color:"#f59e0b"}});case"down":case"error":return e.createElement(N,{style:{color:"#ef4444"}});default:return e.createElement(i,{style:{color:"#6b7280"}})}},r=t=>t<60?"#10b981":t<80?"#f59e0b":"#ef4444",w=t=>t.toLocaleTimeString();return h?e.createElement("div",{className:"server-health-overlay",onClick:n},e.createElement("div",{className:"server-health-panel",onClick:t=>t.stopPropagation()},e.createElement("div",{className:"loading-state"},e.createElement(i,{className:"spin"}),e.createElement("span",null,"Checking server health...")))):e.createElement("div",{className:"server-health-overlay",onClick:n},e.createElement("div",{className:"server-health-panel",onClick:t=>t.stopPropagation()},e.createElement("div",{className:"panel-header"},e.createElement("div",{className:"header-left"},e.createElement("h2",null,e.createElement(_,null)," Server Health"),e.createElement("div",{className:`status-badge ${a?.status}`},E(a?.status),e.createElement("span",null,a?.status==="healthy"?"All Systems Operational":a?.status))),e.createElement("div",{className:"header-right"},e.createElement("div",{className:"last-update"},e.createElement(C,null),e.createElement("span",null,"Updated: ",w(g))),e.createElement("label",{className:"auto-refresh-toggle"},e.createElement("input",{type:"checkbox",checked:o,onChange:t=>k(t.target.checked)}),e.createElement("span",null,"Auto-refresh")),e.createElement("button",{className:"refresh-btn",onClick:c},e.createElement(i,null)),e.createElement("button",{className:"close-btn",onClick:n},e.createElement(S,null)))),e.createElement("div",{className:"quick-stats"},e.createElement("div",{className:"quick-stat"},e.createElement(F,{className:"stat-icon"}),e.createElement("div",{className:"stat-content"},e.createElement("span",{className:"value"},a?.uptime||"99.9%"),e.createElement("span",{className:"label"},"Uptime"))),e.createElement("div",{className:"quick-stat"},e.createElement(U,{className:"stat-icon"}),e.createElement("div",{className:"stat-content"},e.createElement("span",{className:"value"},a?.response_time||45,"ms"),e.createElement("span",{className:"label"},"Response Time"))),e.createElement("div",{className:"quick-stat"},e.createElement($,{className:"stat-icon"}),e.createElement("div",{className:"stat-content"},e.createElement("span",{className:"value"},(a?.active_users||0).toLocaleString()),e.createElement("span",{className:"label"},"Active Users"))),e.createElement("div",{className:"quick-stat"},e.createElement(p,{className:"stat-icon"}),e.createElement("div",{className:"stat-content"},e.createElement("span",{className:"value"},(a?.messages_per_minute||0).toLocaleString()),e.createElement("span",{className:"label"},"Messages/min")))),e.createElement("div",{className:"panel-body"},e.createElement("div",{className:"section"},e.createElement("h3",null,e.createElement(L,null)," Services Status"),e.createElement("div",{className:"services-grid"},Object.entries(a?.services||{}).map(([t,s])=>e.createElement("div",{key:t,className:"service-card"},e.createElement("div",{className:"service-header"},e.createElement("span",{className:"service-name"},t.toUpperCase()),E(s.status)),e.createElement("div",{className:"service-status",style:{color:f(s.status)}},s.status),e.createElement("div",{className:"service-metric"},s.latency!==void 0&&`${s.latency}ms latency`,s.connections!==void 0&&`${s.connections} connections`,s.usage!==void 0&&`${s.usage}% used`,s.hit_rate!==void 0&&`${s.hit_rate}% hit rate`))))),e.createElement("div",{className:"section"},e.createElement("h3",null,e.createElement(v,null)," Resource Usage"),e.createElement("div",{className:"resources-grid"},e.createElement("div",{className:"resource-card"},e.createElement("div",{className:"resource-header"},e.createElement(v,null),e.createElement("span",null,"CPU")),e.createElement("div",{className:"resource-value",style:{color:r(a?.resources?.cpu||0)}},a?.resources?.cpu||0,"%"),e.createElement("div",{className:"resource-bar"},e.createElement("div",{className:"bar-fill",style:{width:`${a?.resources?.cpu||0}%`,backgroundColor:r(a?.resources?.cpu||0)}}))),e.createElement("div",{className:"resource-card"},e.createElement("div",{className:"resource-header"},e.createElement(R,null),e.createElement("span",null,"Memory")),e.createElement("div",{className:"resource-value",style:{color:r(a?.resources?.memory||0)}},a?.resources?.memory||0,"%"),e.createElement("div",{className:"resource-bar"},e.createElement("div",{className:"bar-fill",style:{width:`${a?.resources?.memory||0}%`,backgroundColor:r(a?.resources?.memory||0)}}))),e.createElement("div",{className:"resource-card"},e.createElement("div",{className:"resource-header"},e.createElement(A,null),e.createElement("span",null,"Disk")),e.createElement("div",{className:"resource-value",style:{color:r(a?.resources?.disk||0)}},a?.resources?.disk||0,"%"),e.createElement("div",{className:"resource-bar"},e.createElement("div",{className:"bar-fill",style:{width:`${a?.resources?.disk||0}%`,backgroundColor:r(a?.resources?.disk||0)}}))),e.createElement("div",{className:"resource-card"},e.createElement("div",{className:"resource-header"},e.createElement(P,null),e.createElement("span",null,"Network")),e.createElement("div",{className:"resource-value",style:{color:r(a?.resources?.network||0)}},a?.resources?.network||0,"%"),e.createElement("div",{className:"resource-bar"},e.createElement("div",{className:"bar-fill",style:{width:`${a?.resources?.network||0}%`,backgroundColor:r(a?.resources?.network||0)}}))))),e.createElement("div",{className:"section alerts-section"},e.createElement("h3",null,e.createElement(u,null)," Recent Alerts"),e.createElement("div",{className:"alerts-summary"},e.createElement("div",{className:"alert-stat error"},e.createElement(N,null),e.createElement("span",{className:"count"},a?.errors_last_hour||0),e.createElement("span",{className:"label"},"Errors (1h)")),e.createElement("div",{className:"alert-stat warning"},e.createElement(u,null),e.createElement("span",{className:"count"},a?.warnings_last_hour||0),e.createElement("span",{className:"label"},"Warnings (1h)")),e.createElement("div",{className:"alert-stat info"},e.createElement(p,null),e.createElement("span",{className:"count"},(a?.api_calls_per_minute||0).toLocaleString()),e.createElement("span",{className:"label"},"API Calls/min")))))))};export{W as default};
