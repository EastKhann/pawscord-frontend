var z=Object.defineProperty;var u=(c,b)=>z(c,"name",{value:b,configurable:!0});import{r,j as e}from"./react-core-Djgtqrmb.js";import{v as $}from"./index-Dy0QUtja.js";import"./media-vendor-CxFPycob.js";import"./router-vendor-ClgLnMjk.js";import"./state-vendor-BRqaXHJQ.js";import"./crypto-vendor-D1XRGppi.js";import"./icons-vendor-BW7dxHkX.js";import"./ui-vendor-IhB9Znpc.js";const R={early_supporter:{name:"Early Supporter",icon:"ðŸŒŸ",color:"#FFD700"},premium:{name:"Premium",icon:"ðŸ’Ž",color:"#a855f7"},verified:{name:"Verified",icon:"âœ“",color:"#5865F2"},developer:{name:"Developer",icon:"ðŸ› ï¸",color:"#3b82f6"},bug_hunter:{name:"Bug Hunter",icon:"ðŸ›",color:"#22c55e"},top_contributor:{name:"Top Contributor",icon:"ðŸ†",color:"#f59e0b"},server_owner:{name:"Server Owner",icon:"ðŸ‘‘",color:"#ef4444"},moderator:{name:"Moderator",icon:"ðŸ›¡ï¸",color:"#10b981"},artist:{name:"Artist",icon:"ðŸŽ¨",color:"#ec4899"},streamer:{name:"Streamer",icon:"ðŸ“º",color:"#8b5cf6"}};function E(c,b){const[n,s]=r.useState(null),[m,f]=r.useState([]),[y,x]=r.useState([]),[g,o]=r.useState(!0),[h,k]=r.useState(!1),[S,_]=r.useState("appearance"),[C,v]=r.useState({banner:"",banner_color:"#5865F2",theme:"default",bio:"",links:[]}),[a,t]=r.useState([]),[w,B]=r.useState({name:"",url:""}),j=$,T=r.useCallback(async()=>{try{const l=localStorage.getItem("access_token"),[i,p,N]=await Promise.all([fetch(`${j}/profile/card/`,{headers:{Authorization:`Bearer ${l}`}}),fetch(`${j}/profile/themes/`,{headers:{Authorization:`Bearer ${l}`}}),fetch(`${j}/profile/badges/`,{headers:{Authorization:`Bearer ${l}`}})]);if(i.ok){const d=await i.json();s(d),v({banner:d.banner||"",banner_color:d.banner_color||"#5865F2",theme:d.theme||"default",bio:d.bio||"",links:d.links||[]}),t(d.badges||[])}if(p.ok){const d=await p.json();f(d.themes||[])}if(N.ok){const d=await N.json();x(d.badges||[])}}catch{}o(!1)},[j]),L=u(async()=>{k(!0);try{const l=localStorage.getItem("access_token"),i=await fetch(`${j}/profile/card/update/`,{method:"POST",headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"},body:JSON.stringify(C)});await fetch(`${j}/profile/badges/set/`,{method:"POST",headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"},body:JSON.stringify({badges:a})}),i.ok&&(b?.(),c())}catch{}k(!1)},"handleSave"),A=u(async()=>{if(w.url)try{const l=localStorage.getItem("access_token"),i=await fetch(`${j}/profile/links/add/`,{method:"POST",headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"},body:JSON.stringify(w)});if(i.ok){const p=await i.json();v(N=>({...N,links:p.links})),B({name:"",url:""})}}catch{}},"handleAddLink"),D=u(async l=>{try{const i=localStorage.getItem("access_token"),p=await fetch(`${j}/profile/links/${l}/remove/`,{method:"DELETE",headers:{Authorization:`Bearer ${i}`}});if(p.ok){const N=await p.json();v(d=>({...d,links:N.links}))}}catch{}},"handleRemoveLink"),P=u(l=>{t(i=>i.includes(l)?i.filter(p=>p!==l):i.length>=3?i:[...i,l])},"toggleBadge");return r.useEffect(()=>{T()},[T]),{profile:n,themes:m,badges:y,loading:g,saving:h,activeTab:S,setActiveTab:_,formData:C,setFormData:v,selectedBadges:a,newLink:w,setNewLink:B,handleSave:L,handleAddLink:A,handleRemoveLink:D,toggleBadge:P}}u(E,"useProfileCardEditor");const O=r.memo(({onClose:c,onSave:b})=>{const n=E(c,b),{setActiveTab:s,setFormData:m,setNewLink:f}=n,y=r.useCallback(a=>{a.target===a.currentTarget&&c()},[c]),x=r.useCallback(()=>s("appearance"),[s]),g=r.useCallback(()=>s("badges"),[s]),o=r.useCallback(()=>s("links"),[s]),h=r.useCallback(a=>m(t=>({...t,banner:a.target.value})),[m]),k=r.useCallback(a=>m(t=>({...t,banner_color:a.target.value})),[m]),S=r.useCallback(a=>m(t=>({...t,theme:a})),[m]),_=r.useCallback(a=>m(t=>({...t,bio:a.target.value.slice(0,500)})),[m]),C=r.useCallback(a=>f(t=>({...t,name:a.target.value})),[f]),v=r.useCallback(a=>f(t=>({...t,url:a.target.value})),[f]);return n.loading?e.jsx("div",{className:"profile-editor-modal",children:e.jsx("div",{className:"editor-loading",children:e.jsx("div",{className:"loading-spinner"})})}):e.jsx("div",{className:"profile-editor-overlay",onClick:y,children:e.jsxs("div",{className:"profile-editor-modal",children:[e.jsxs("div",{className:"editor-header",children:[e.jsxs("h2",{children:["ðŸŽ¨"," Profil KartÄ± DÃ¼zenle"]}),e.jsx("button",{className:"close-btn",onClick:c,children:"Ã—"})]}),e.jsxs("div",{className:"editor-tabs",children:[e.jsxs("button",{className:n.activeTab==="appearance"?"active":"",onClick:x,children:["ðŸŽ¨"," GÃ¶rÃ¼nÃ¼m"]}),e.jsxs("button",{className:n.activeTab==="badges"?"active":"",onClick:g,children:["ðŸ…"," Rozetler"]}),e.jsxs("button",{className:n.activeTab==="links"?"active":"",onClick:o,children:["ðŸ”—"," BaÄŸlantÄ±lar"]})]}),e.jsxs("div",{className:"editor-content",children:[n.activeTab==="appearance"&&e.jsxs("div",{className:"appearance-tab",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Banner URL"}),e.jsx("input",{type:"url",placeholder:"https://...",value:n.formData.banner,onChange:h})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Banner Rengi (resim yoksa)"}),e.jsxs("div",{className:"color-picker",children:[e.jsx("input",{type:"color",value:n.formData.banner_color,onChange:k}),e.jsx("span",{children:n.formData.banner_color})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Tema"}),e.jsx("div",{className:"theme-grid",children:n.themes.map(a=>e.jsxs("div",{className:`theme-option ${n.formData.theme===a.id?"selected":""}`,onClick:u(()=>S(a.id),"onClick"),style:{background:`linear-gradient(135deg, ${a.primary}, ${a.secondary})`},children:[e.jsx("span",{className:"theme-name",children:a.id}),e.jsx("div",{className:"theme-colors",children:e.jsx("span",{style:{backgroundColor:a.accent}})})]},a.id))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Biyografi"}),e.jsx("textarea",{placeholder:"Kendiniz hakkÄ±nda bir ÅŸeyler yazÄ±n...",value:n.formData.bio,onChange:_,rows:4,maxLength:500}),e.jsxs("span",{className:"char-count",children:[n.formData.bio.length,"/500"]})]})]}),n.activeTab==="badges"&&e.jsxs("div",{className:"badges-tab",children:[e.jsx("p",{className:"badges-hint",children:"Profilinizde gÃ¶rÃ¼ntÃ¼lenecek en fazla 3 rozet seÃ§in"}),e.jsx("div",{className:"badges-grid",children:n.badges.map(a=>e.jsxs("div",{className:`badge-option ${a.owned?"":"locked"} ${n.selectedBadges.includes(a.id)?"selected":""}`,onClick:u(()=>a.owned&&n.toggleBadge(a.id),"onClick"),children:[e.jsx("span",{className:"badge-icon",style:{backgroundColor:a.color},children:a.icon}),e.jsx("span",{className:"badge-name",children:a.name}),!a.owned&&e.jsx("span",{className:"lock-icon",children:"ðŸ”’"})]},a.id))})]}),n.activeTab==="links"&&e.jsxs("div",{className:"links-tab",children:[e.jsx("p",{className:"links-hint",children:"En fazla 5 baÄŸlantÄ± ekleyebilirsiniz"}),e.jsx("div",{className:"current-links",children:n.formData.links.map((a,t)=>e.jsxs("div",{className:"link-row",children:[e.jsx("span",{className:"link-icon",children:a.icon}),e.jsx("span",{className:"link-name",children:a.name}),e.jsxs("a",{href:a.url,target:"_blank",rel:"noopener noreferrer",className:"link-url",children:[a.url.slice(0,40),"..."]}),e.jsx("button",{className:"remove-link",onClick:u(()=>n.handleRemoveLink(t),"onClick"),children:"Ã—"})]},t))}),n.formData.links.length<5&&e.jsxs("div",{className:"add-link-form",children:[e.jsx("input",{type:"text",placeholder:"Ä°sim (opsiyonel)",value:n.newLink.name,onChange:C}),e.jsx("input",{type:"url",placeholder:"URL",value:n.newLink.url,onChange:v}),e.jsx("button",{onClick:n.handleAddLink,children:"Ekle"})]})]})]}),e.jsxs("div",{className:"editor-preview",children:[e.jsx("h4",{children:"Ã–nizleme"}),e.jsx(F,{username:n.profile?.username,compact:!0})]}),e.jsxs("div",{className:"editor-footer",children:[e.jsx("button",{className:"cancel-btn",onClick:c,children:"Ä°ptal"}),e.jsx("button",{className:"save-btn",onClick:n.handleSave,disabled:n.saving,children:n.saving?"Kaydediliyor...":"Kaydet"})]})]})})});O.displayName="ProfileCardEditor";const F=u(({username:c,onEdit:b,compact:n=!1})=>{const[s,m]=r.useState(null),[f,y]=r.useState(!0),x=$;if(r.useEffect(()=>{(async()=>{try{const o=localStorage.getItem("access_token"),h=c?`${x}/profile/card/${c}/`:`${x}/profile/card/`,k=await fetch(h,{headers:{Authorization:`Bearer ${o}`}});k.ok&&m(await k.json())}catch{}y(!1)})()},[c,x]),f)return e.jsx("div",{className:"profile-card loading",children:e.jsx("div",{className:"loading-spinner"})});if(!s)return e.jsx("div",{className:"profile-card error",children:"Profil yÃ¼klenemedi"});const g=s.custom_colors||s.theme_colors;return e.jsxs("div",{className:`profile-card ${n?"compact":""}`,style:{"--primary":g.primary,"--secondary":g.secondary,"--accent":g.accent,"--bg":g.background},children:[e.jsx("div",{className:"card-banner",style:{backgroundImage:s.banner?`url(${s.banner})`:void 0,backgroundColor:s.banner_color},children:b&&e.jsx("button",{className:"edit-btn",onClick:b,children:"âœï¸"})}),e.jsxs("div",{className:"card-avatar",children:[e.jsx("img",{src:s.avatar||"/default-avatar.png",alt:""}),s.status_text&&e.jsx("div",{className:"status-indicator",title:s.status_text,children:s.status_text.slice(0,1)})]}),e.jsxs("div",{className:"card-content",children:[s.badges?.length>0&&e.jsx("div",{className:"card-badges",children:s.badges.map(o=>{const h=R[o];return h?e.jsx("span",{className:"badge",style:{backgroundColor:h.color},title:h.name,children:h.icon},o):null})}),e.jsx("h2",{className:"card-name",children:s.display_name||s.username}),e.jsxs("p",{className:"card-username",children:["@",s.username]}),s.bio&&e.jsx("p",{className:"card-bio",children:s.bio}),e.jsxs("div",{className:"card-stats",children:[e.jsxs("div",{className:"stat",children:[e.jsxs("span",{className:"stat-value",children:["Lv.",s.level]}),e.jsx("span",{className:"stat-label",children:"Seviye"})]}),e.jsxs("div",{className:"stat",children:[e.jsx("span",{className:"stat-value",children:s.xp?.toLocaleString()}),e.jsx("span",{className:"stat-label",children:"XP"})]}),e.jsxs("div",{className:"stat",children:[e.jsx("span",{className:"stat-value",children:new Date(s.created_at).toLocaleDateString("tr-TR",{month:"short",year:"numeric"})}),e.jsx("span",{className:"stat-label",children:"KatÄ±lÄ±m"})]})]}),s.links?.length>0&&e.jsx("div",{className:"card-links",children:s.links.map((o,h)=>e.jsx("a",{href:o.url,target:"_blank",rel:"noopener noreferrer",className:"link-item",title:o.name,children:o.icon},h))}),s.spotify_connected&&e.jsxs("div",{className:"spotify-badge",children:["ðŸŽµ"," Spotify BaÄŸlÄ±"]}),s.is_premium&&e.jsxs("div",{className:"premium-badge",children:["ðŸ’Ž"," Premium"]})]})]})},"ProfileCard");export{F as ProfileCard,O as ProfileCardEditor,F as default};
