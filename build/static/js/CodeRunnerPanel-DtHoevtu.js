var ae=Object.defineProperty;var n=(p,c)=>ae(p,"name",{value:c,configurable:!0});import{r as a,j as e}from"./react-core-Djgtqrmb.js";import{q as o,cq as ne,b2 as te,a as z,aB as P,aY as g,f as K,b6 as le,z as E,aV as ie,aN as re,D as ce,bs as oe,w as de,d as he,cJ as ue}from"./icons-vendor-BW7dxHkX.js";import{y as i}from"./ui-vendor-IhB9Znpc.js";const me=n(({serverId:p,channelId:c,onClose:x})=>{const[l,u]=a.useState(""),[r,m]=a.useState("python"),[j,d]=a.useState(""),[O,b]=a.useState(!1),[S,k]=a.useState(null),[C,A]=a.useState([]),[B,N]=a.useState(!1),[w,R]=a.useState([]),[D,f]=a.useState(!1),[F,W]=a.useState(!1),h=localStorage.getItem("access_token"),T=[{id:"python",name:"Python",icon:e.jsx(ue,{}),template:`# Python Code
print("Hello, World!")`},{id:"cpp",name:"C++",icon:e.jsx(o,{}),template:`#include <iostream>
using namespace std;

int main() {
    cout << "Hello, World!" << endl;
    return 0;
}`},{id:"c",name:"C",icon:e.jsx(o,{}),template:`#include <stdio.h>

int main() {
    printf("Hello, World!\\n");
    return 0;
}`},{id:"ruby",name:"Ruby",icon:e.jsx(o,{}),template:`# Ruby Code
puts "Hello, World!"`},{id:"go",name:"Go",icon:e.jsx(o,{}),template:`package main

import "fmt"

func main() {
    fmt.Println("Hello, World!")
}`},{id:"rust",name:"Rust",icon:e.jsx(o,{}),template:`fn main() {
    println!("Hello, World!");
}`}];a.useEffect(()=>{H(),v()},[]),a.useEffect(()=>{const s=T.find(t=>t.id===r);s&&!l&&u(s.template)},[r]);const H=n(async()=>{try{const s=await fetch("/api/code-runner/history/",{headers:{Authorization:`Bearer ${h}`}});if(s.ok){const t=await s.json();A(t.history||[])}}catch{}},"fetchHistory"),v=n(async()=>{try{const s=await fetch("/api/code-runner/snippets/",{headers:{Authorization:`Bearer ${h}`}});if(s.ok){const t=await s.json();R(t.snippets||[])}}catch{}},"fetchSavedSnippets"),M=n(async()=>{if(!l.trim()){i.warning("Kod boş olamaz");return}b(!0),d("Çalıştırılıyor...");const s=Date.now();try{const t=await fetch("/api/code-runner/execute/",{method:"POST",headers:{Authorization:`Bearer ${h}`,"Content-Type":"application/json"},body:JSON.stringify({code:l,language:r,channel_id:c})}),y=await t.json(),se=Date.now();k(se-s),t.ok?(d(y.output||"Çıktı yok"),y.error&&d(`Hata:
${y.error}`)):d(`Hata: ${y.message||"Kod çalıştırılamadı"}`),H()}catch{d("Bağlantı hatası")}b(!1)},"handleRunCode"),G=n(async()=>{try{await fetch("/api/code-runner/stop/",{method:"POST",headers:{Authorization:`Bearer ${h}`}}),b(!1),d("Çalıştırma durduruldu")}catch{i.error("Durdurma başarısız")}},"handleStopExecution"),J=n(async s=>{try{(await fetch("/api/code-runner/snippets/",{method:"POST",headers:{Authorization:`Bearer ${h}`,"Content-Type":"application/json"},body:JSON.stringify({name:s,code:l,language:r})})).ok&&(i.success("Snippet kaydedildi"),v(),f(!1))}catch{i.error("Kaydetme başarısız")}},"handleSaveSnippet"),$=n(s=>{u(s.code),m(s.language),N(!1)},"handleLoadSnippet"),_=n(async s=>{try{await fetch(`/api/code-runner/snippets/${s}/`,{method:"DELETE",headers:{Authorization:`Bearer ${h}`}}),i.success("Snippet silindi"),v()}catch{i.error("Silme başarısız")}},"handleDeleteSnippet"),L=n(()=>{navigator.clipboard.writeText(j),i.success("Çıktı kopyalandı")},"handleCopyOutput"),q=n(()=>{u(""),d(""),k(null)},"handleClearAll"),I=n(async()=>{if(!c){i.warning("Paylaşım için kanal gerekli");return}try{(await fetch(`/api/channels/${c}/messages/`,{method:"POST",headers:{Authorization:`Bearer ${h}`,"Content-Type":"application/json"},body:JSON.stringify({content:`\`\`\`${r}
${l}
\`\`\`
**Çıktı:**
\`\`\`
${j}
\`\`\``})})).ok&&i.success("Kanala paylaşıldı")}catch{i.error("Paylaşım başarısız")}},"handleShareToChannel"),V=a.useCallback(s=>{s.target.className.includes("code-runner-overlay")&&x()},[x]),Y=a.useCallback(()=>W(s=>!s),[]),Q=a.useCallback(()=>N(s=>!s),[]),U=a.useCallback(()=>f(!0),[]),X=a.useCallback(()=>f(!1),[]),Z=a.useCallback(s=>u(s.target.value),[]),ee=a.useCallback(()=>N(!1),[]);return e.jsx("div",{className:`code-runner-overlay ${F?"fullscreen":""}`,onClick:V,children:e.jsxs("div",{className:"code-runner-panel",children:[e.jsxs("div",{className:"panel-header",children:[e.jsxs("h2",{children:[e.jsx(o,{})," Kod Çalıştırıcı"]}),e.jsxs("div",{className:"header-actions",children:[e.jsx("button",{className:"fullscreen-btn",onClick:Y,children:F?e.jsx(ne,{}):e.jsx(te,{})}),e.jsx("button",{className:"close-btn",onClick:x,children:e.jsx(z,{})})]})]}),e.jsxs("div",{className:"toolbar",children:[e.jsx("div",{className:"language-selector",children:T.map(s=>e.jsxs("button",{className:`lang-btn ${r===s.id?"active":""}`,onClick:n(()=>m(s.id),"onClick"),title:s.name,children:[s.icon,e.jsx("span",{children:s.name})]},s.id))}),e.jsxs("div",{className:"toolbar-actions",children:[e.jsxs("button",{className:"action-btn",onClick:Q,children:[e.jsx(P,{})," Geçmiş"]}),e.jsxs("button",{className:"action-btn",onClick:U,children:[e.jsx(g,{})," Kaydet"]}),e.jsxs("button",{className:"action-btn clear",onClick:q,children:[e.jsx(K,{})," Temizle"]})]})]}),e.jsxs("div",{className:"editor-container",children:[e.jsxs("div",{className:"code-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsxs("span",{children:[e.jsx(o,{})," Kod"]}),e.jsxs("span",{className:"line-count",children:[l.split(`
`).length," satır"]})]}),e.jsx("textarea",{className:"code-editor",value:l,onChange:Z,placeholder:"Kodunuzu buraya yazın...",spellCheck:"false"})]}),e.jsxs("div",{className:"output-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsxs("span",{children:[e.jsx(le,{})," Çıktı"]}),e.jsxs("div",{className:"output-actions",children:[S&&e.jsxs("span",{className:"exec-time",children:[e.jsx(E,{})," ",S,"ms"]}),e.jsx("button",{onClick:L,title:"Kopyala",children:e.jsx(ie,{})})]})]}),e.jsx("pre",{className:`output-display ${j.includes("Hata")?"error":""}`,children:j||"Çıktı burada görünecek..."})]})]}),e.jsxs("div",{className:"run-bar",children:[O?e.jsxs("button",{className:"stop-btn",onClick:G,children:[e.jsx(ce,{})," Durdur"]}):e.jsxs("button",{className:"run-btn",onClick:M,children:[e.jsx(re,{})," Çalıştır"]}),c&&e.jsxs("button",{className:"share-btn",onClick:I,children:[e.jsx(o,{})," Kanala Paylaş"]})]}),B&&e.jsxs("div",{className:"history-sidebar",children:[e.jsxs("div",{className:"sidebar-header",children:[e.jsxs("h3",{children:[e.jsx(P,{})," Geçmiş & Snippets"]}),e.jsx("button",{onClick:ee,children:e.jsx(z,{})})]}),e.jsxs("div",{className:"sidebar-section",children:[e.jsxs("h4",{children:[e.jsx(oe,{})," Kaydedilen Snippets"]}),w.length===0?e.jsx("p",{className:"empty-msg",children:"Henüz snippet yok"}):e.jsx("div",{className:"snippets-list",children:w.map(s=>e.jsxs("div",{className:"snippet-item",children:[e.jsxs("div",{className:"snippet-info",onClick:n(()=>$(s),"onClick"),children:[e.jsx("span",{className:"snippet-name",children:s.name}),e.jsx("span",{className:"snippet-lang",children:s.language})]}),e.jsx("button",{className:"delete-snippet",onClick:n(()=>_(s.id),"onClick"),children:e.jsx(K,{})})]},s.id))})]}),e.jsxs("div",{className:"sidebar-section",children:[e.jsxs("h4",{children:[e.jsx(E,{})," Son Çalıştırmalar"]}),C.length===0?e.jsx("p",{className:"empty-msg",children:"Geçmiş yok"}):e.jsx("div",{className:"history-list",children:C.slice(0,10).map((s,t)=>e.jsxs("div",{className:"history-item",onClick:n(()=>$(s),"onClick"),children:[e.jsxs("div",{className:"history-info",children:[e.jsx("span",{className:"history-lang",children:s.language}),e.jsx("span",{className:`history-status ${s.success?"success":"error"}`,children:s.success?e.jsx(de,{}):e.jsx(he,{})})]}),e.jsxs("code",{className:"history-preview",children:[s.code?.substring(0,50),"..."]}),e.jsxs("span",{className:"history-time",children:[s.exec_time,"ms"]})]},t))})]})]}),D&&e.jsx(pe,{onClose:X,onSave:J,language:r})]})})},"CodeRunnerPanel"),pe=n(({onClose:p,onSave:c,language:x})=>{const[l,u]=a.useState(""),r=n(()=>{if(!l.trim()){i.warning("Snippet adı gerekli");return}c(l)},"handleSubmit");return e.jsx("div",{className:"modal-overlay",onClick:n(m=>m.target.className==="modal-overlay"&&p(),"onClick"),children:e.jsxs("div",{className:"save-modal",children:[e.jsxs("h3",{children:[e.jsx(g,{})," Snippet Kaydet"]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Snippet Adı"}),e.jsx("input",{type:"text",value:l,onChange:n(m=>u(m.target.value),"onChange"),placeholder:"örn: Fibonacci Hesaplama"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Dil"}),e.jsx("input",{type:"text",value:x,disabled:!0})]}),e.jsxs("div",{className:"modal-actions",children:[e.jsx("button",{className:"cancel-btn",onClick:p,children:"İptal"}),e.jsxs("button",{className:"save-submit-btn",onClick:r,children:[e.jsx(g,{})," Kaydet"]})]})]})})},"SaveSnippetModal"),Ne=a.memo(me);export{Ne as default};
