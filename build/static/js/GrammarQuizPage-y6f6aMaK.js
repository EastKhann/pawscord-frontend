import{H as V,r as i,d as e,N as O,O as Y,a7 as J,W as X,a8 as M,J as Z,K as ee}from"./react-core-DMT_QkRe.js";import{Q as w,L as z}from"./grammarQuestions-A4AYX2rb.js";import{A as te}from"./index-DuRbhGVU.js";const N=te,ae=()=>{const T=V(),[W,b]=i.useState("level-select"),[f,I]=i.useState(null),[u,A]=i.useState(0),[m,y]=i.useState(""),[x,h]=i.useState(""),[c,k]=i.useState(!1),[s,E]=i.useState(null),[R,L]=i.useState(0),[v,_]=i.useState([]),[j,q]=i.useState(!0),$=()=>localStorage.getItem("access_token"),B=i.useCallback(async(n,a={})=>{const l=$();if(!l)return null;const p=a.headers||{};p.Authorization=`Bearer ${l}`,p["Content-Type"]="application/json";try{const r=await fetch(n,{...a,headers:p});return r.status===401?(T("/"),null):r}catch(r){return console.error("API Error:",r),null}},[T]);i.useEffect(()=>{(async()=>{const a=await B(`${N}/eng-learn/grammar/known/`);if(a&&a.ok){const l=await a.json();_(l||[])}q(!1)})()},[B]);const D=i.useMemo(()=>f?w.filter(n=>n.level===f&&!v.includes(n.id)):[],[f,v]),o=D[u],d=D.length,H=d>0?(u+1)/d*100:0,P=n=>{I(n),A(0),L(0),k(!1),E(null),y(""),h(""),b("quiz")},U=()=>{let n="";o.type==="choice"?n=m:n=x.trim();const a=n.toLowerCase()===o.answer.toLowerCase();E(a),k(!0),a&&L(l=>l+1)},Q=async()=>{if(o)try{await B(`${N}/eng-learn/grammar/mark-known/`,{method:"POST",body:JSON.stringify({question_id:o.id})}),_(n=>[...n,o.id]),G()}catch(n){console.error("ƒ∞≈üaretleme hatasƒ±:",n)}},G=()=>{u+1<d?(A(n=>n+1),k(!1),E(null),y(""),h("")):b("result")},S=()=>{b("level-select"),I(null)};if(j)return e.createElement("div",{style:t.container},"Y√ºkleniyor...");if(W==="level-select"){const n=z.filter(r=>r.id.startsWith("A")),a=z.filter(r=>r.id.startsWith("B")),l=z.filter(r=>r.id.startsWith("C")),p=r=>{const F=w.filter(g=>g.level===r.id).length,K=w.filter(g=>g.level===r.id&&v.includes(g.id)).length,C=F-K;return e.createElement("button",{key:r.id,onClick:()=>C>0?P(r.id):alert("Tebrikler! Bu seviyedeki t√ºm sorularƒ± tamamladƒ±n."),style:{...t.levelCard,borderTop:`5px solid ${r.color}`,opacity:C===0?.6:1}},e.createElement("div",{style:t.levelIcon},r.icon),e.createElement("div",{style:t.levelName},r.name),e.createElement("div",{style:t.levelCount},C===0?"Tamamlandƒ±! üéâ":`${K} / ${F} Tamamlandƒ±`))};return e.createElement("div",{style:t.scrollWrapper},e.createElement("div",{style:t.container},e.createElement("div",{style:t.headerArea},e.createElement(O,{to:"/eng-learn",style:t.backLink},e.createElement(Y,null)," Merkez"),e.createElement("h1",{style:t.mainTitle},"Seviyeni Se√ß"),e.createElement("p",{style:t.subTitle},"Kendini test etmek i√ßin bir zorluk seviyesi se√ß.")),e.createElement("div",{style:t.columnsWrapper},e.createElement("div",{style:t.column},n.map(r=>p(r))),e.createElement("div",{style:t.column},a.map(r=>p(r))),e.createElement("div",{style:t.column},l.map(r=>p(r))))))}if(W==="result"){const n=d>0?R/d*100:100;let a="Gayet iyi!";return n===100?a="M√ºkemmel! üèÜ":n<50&&(a="Biraz daha √ßalƒ±≈ümalƒ±sƒ±n. üí™"),e.createElement("div",{style:t.scrollWrapper},e.createElement("div",{style:t.container},e.createElement("div",{style:t.resultCard},e.createElement(J,{size:60,color:"#faa61a",style:{marginBottom:"20px"}}),e.createElement("h2",{style:t.resultTitle},"Oturum Tamamlandƒ±!"),e.createElement("p",{style:t.resultScore},"Skorun: ",R," / ",d),e.createElement("p",{style:t.resultMessage},a),e.createElement("div",{style:t.resultBtnGroup},e.createElement("button",{onClick:S,style:t.primaryBtn},e.createElement(X,{style:{marginRight:"8px"}})," Men√ºye D√∂n"),e.createElement(O,{to:"/eng-learn",style:t.secondaryBtn},"Merkeze D√∂n")))))}return o?e.createElement("div",{style:t.scrollWrapper},e.createElement("div",{style:t.container},e.createElement("div",{style:t.topBar},e.createElement("button",{onClick:S,style:t.smallBackBtn},"‚úï √áƒ±k"),e.createElement("div",{style:t.progressBarBg},e.createElement("div",{style:{...t.progressBarFill,width:`${H}%`}}))),e.createElement("div",{style:t.quizBox},e.createElement("div",{style:t.questionSection},e.createElement("h2",{style:t.questionText},o.question.split("_____").map((n,a,l)=>e.createElement(e.Fragment,{key:a},n,a<l.length-1&&e.createElement("span",{style:{...t.blankSpace,borderColor:c?s?"#43b581":"#f04747":"#7289da"}},c?(o.type==="choice"?m:x)||"___":"_____"))))),e.createElement("div",{style:t.interactionArea},o.type==="choice"&&e.createElement("div",{style:t.optionsGrid},o.options.map((n,a)=>{let l=t.optionBtn;return c?n===o.answer?l={...l,...t.correctBtn}:n===m?l={...l,...t.wrongBtn}:l={...l,opacity:.5}:m===n&&(l={...l,...t.selectedBtn}),e.createElement("button",{key:a,onClick:()=>!c&&y(n),style:l,disabled:c},n)})),o.type==="input"&&e.createElement("input",{type:"text",value:x,onChange:n=>h(n.target.value),placeholder:"Cevabƒ± buraya yazƒ±n...",style:{...t.textInput,borderColor:c?s?"#43b581":"#f04747":"#7289da"},disabled:c})),e.createElement("div",{style:t.footer},c?e.createElement("div",{style:{...t.feedbackBox,borderLeft:s?"5px solid #43b581":"5px solid #f04747",backgroundColor:s?"rgba(67, 181, 129, 0.1)":"rgba(240, 71, 71, 0.1)"}},e.createElement("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"15px"}},s?e.createElement(Z,{size:28,color:"#43b581"}):e.createElement(ee,{size:28,color:"#f04747"}),e.createElement("div",null,e.createElement("strong",{style:{fontSize:"1.2em",color:s?"#43b581":"#f04747",display:"block"}},s?"Doƒüru Cevap!":"Yanlƒ±≈ü Cevap"),!s&&e.createElement("span",{style:{color:"#dbdee1",fontSize:"0.9em"}},"Doƒürusu: ",e.createElement("strong",{style:{color:"#43b581"}},o.answer)))),o.explanation&&e.createElement("div",{style:t.explanationContainer},o.explanation.title&&e.createElement("div",{style:t.expTitle},"üìñ ",o.explanation.title),o.explanation.translation&&e.createElement("div",{style:t.expTranslation},e.createElement("em",null,'"',o.explanation.translation,'"')),e.createElement("div",{style:t.separator}),o.explanation.rule&&e.createElement("div",{style:t.expSection},e.createElement("strong",{style:{color:"#f0b232"}},"Kural:")," ",o.explanation.rule),o.explanation.tips&&e.createElement("div",{style:t.expSection},e.createElement("strong",{style:{color:"#00a8fc"}},"ƒ∞pucu:")," ",o.explanation.tips),o.explanation.examples&&e.createElement("div",{style:{...t.expSection,marginTop:"10px"}},e.createElement("strong",{style:{color:"#dbdee1",display:"block",marginBottom:3}},"√ñrnekler:"),o.explanation.examples.map((n,a)=>e.createElement("div",{key:a,style:t.exampleItem},"‚Ä¢ ",n)))),e.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"10px"}},e.createElement("button",{onClick:G,style:s?t.nextBtnCorrect:t.nextBtnWrong},u+1===d?"Bƒ∞Tƒ∞R VE SONU√áLARI G√ñR":"DEVAM ET"),e.createElement("button",{onClick:Q,style:t.feedbackKnownBtn},e.createElement(M,null)," Bunu aslƒ±nda biliyordum (√ñƒürenildi Say)"))):e.createElement("div",{style:t.actionButtonGroup},e.createElement("button",{onClick:Q,style:t.knownBtn,title:"Bunu biliyorum, bir daha sorma"},e.createElement(M,null)," Biliyorum (Ge√ß)"),e.createElement("button",{onClick:U,style:t.checkBtn,disabled:o.type==="choice"?!m:!x},"KONTROL ET")))))):e.createElement("div",{style:t.container},e.createElement("div",{style:t.resultCard},e.createElement("h2",null,"Harika! üéâ"),e.createElement("p",null,"Bu seviyedeki t√ºm sorularƒ± bitirdin."),e.createElement("button",{onClick:S,style:t.primaryBtn},"Geri D√∂n")))},t={scrollWrapper:{width:"100%",height:"100dvh",overflowY:"auto",backgroundColor:"var(--background-primary)"},container:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",minHeight:"100%",color:"var(--text-primary)",padding:"20px",paddingBottom:"50px",boxSizing:"border-box",fontFamily:"'Poppins', sans-serif"},headerArea:{width:"100%",maxWidth:"800px",marginBottom:"30px",textAlign:"center",position:"relative"},backLink:{display:"inline-flex",alignItems:"center",gap:"8px",textDecoration:"none",color:"var(--text-secondary)",fontWeight:"600",fontSize:"0.9em",marginBottom:"15px",alignSelf:"flex-start"},mainTitle:{fontSize:"clamp(1.8em, 5vw, 2.5em)",marginBottom:"10px",color:"#fff"},subTitle:{fontSize:"1em",color:"var(--text-muted)",textAlign:"center"},columnsWrapper:{display:"flex",flexWrap:"wrap",gap:"20px",width:"100%",maxWidth:"1000px",justifyContent:"center",alignItems:"flex-start"},column:{flex:"1 1 280px",display:"flex",flexDirection:"column",gap:"20px"},levelCard:{backgroundColor:"#2b2d31",padding:"25px",borderRadius:"16px",border:"2px solid transparent",cursor:"pointer",display:"flex",alignItems:"center",boxShadow:"0 4px 0 rgba(0,0,0,0.2)",transition:"transform 0.1s, border-color 0.2s",color:"#dbdee1",textAlign:"left",gap:"15px"},levelIcon:{fontSize:"2.5em"},levelName:{fontSize:"1.2em",fontWeight:"700",color:"white"},levelCount:{fontSize:"0.9em",color:"#949ba4"},quizBox:{width:"100%",maxWidth:"700px",backgroundColor:"#2b2d31",padding:"40px",borderRadius:"24px",boxShadow:"0 10px 30px rgba(0,0,0,0.3)",marginTop:"20px"},questionText:{fontSize:"1.5em",textAlign:"center",lineHeight:"1.6",color:"white",fontWeight:"600"},optionsGrid:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"15px",marginTop:"30px"},optionBtn:{padding:"20px",fontSize:"1.1em",fontWeight:"600",borderRadius:"12px",border:"2px solid #404249",backgroundColor:"#313338",color:"#dbdee1",cursor:"pointer",transition:"all 0.1s",boxShadow:"0 4px 0 #1e1f22"},selectedBtn:{borderColor:"#5865f2",backgroundColor:"rgba(88, 101, 242, 0.1)",color:"#5865f2"},correctBtn:{borderColor:"#23a559",backgroundColor:"#23a559",color:"white",boxShadow:"0 4px 0 #187d41"},wrongBtn:{borderColor:"#da373c",backgroundColor:"#da373c",color:"white",boxShadow:"0 4px 0 #a1282c"},footer:{marginTop:"30px",display:"flex",justifyContent:"space-between",gap:"10px"},checkBtn:{padding:"15px 30px",borderRadius:"12px",border:"none",backgroundColor:"#5865f2",color:"white",fontSize:"1em",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 0 #4752c4",width:"100%"},knownBtn:{padding:"15px",borderRadius:"12px",border:"2px solid #404249",backgroundColor:"transparent",color:"#949ba4",fontWeight:"bold",cursor:"pointer"},topBar:{width:"100%",maxWidth:"600px",display:"flex",alignItems:"center",gap:"15px",marginBottom:"20px"},smallBackBtn:{background:"none",border:"none",color:"var(--text-muted)",fontSize:"1em",cursor:"pointer",fontWeight:"bold"},progressBarBg:{flex:1,height:"10px",backgroundColor:"var(--background-tertiary)",borderRadius:"5px",overflow:"hidden"},progressBarFill:{height:"100%",backgroundColor:"#5865f2",borderRadius:"5px",transition:"width 0.5s ease"},questionSection:{marginBottom:"20px",minHeight:"80px",display:"flex",alignItems:"center",justifyContent:"center"},blankSpace:{display:"inline-block",borderBottom:"2px solid",padding:"0 5px",minWidth:"40px",textAlign:"center",margin:"0 4px",color:"var(--text-link)",fontWeight:"bold"},interactionArea:{marginBottom:"20px"},textInput:{width:"100%",padding:"15px",fontSize:"1.1em",borderRadius:"10px",border:"2px solid",backgroundColor:"var(--background-primary)",color:"var(--text-primary)",outline:"none",boxSizing:"border-box"},actionButtonGroup:{display:"flex",gap:"10px",flexWrap:"wrap"},feedbackBox:{display:"flex",flexDirection:"column",gap:"10px",padding:"20px",borderRadius:"12px",animation:"slideUp 0.3s ease",textAlign:"left",boxShadow:"0 4px 15px rgba(0,0,0,0.2)"},explanationContainer:{backgroundColor:"rgba(0,0,0,0.2)",padding:"15px",borderRadius:"8px",marginTop:"5px",marginBottom:"15px",border:"1px solid rgba(255,255,255,0.05)"},expTitle:{color:"#fff",fontWeight:"bold",fontSize:"1.1em",marginBottom:"5px"},expTranslation:{color:"#949ba4",fontSize:"0.95em",marginBottom:"10px"},separator:{height:"1px",backgroundColor:"rgba(255,255,255,0.1)",margin:"10px 0"},expSection:{fontSize:"0.95em",color:"#dbdee1",lineHeight:"1.5",marginBottom:"8px"},exampleItem:{fontSize:"0.9em",color:"#b9bbbe",paddingLeft:"10px",borderLeft:"2px solid #5865f2",marginBottom:"4px",fontStyle:"italic"},nextBtnCorrect:{padding:"12px",borderRadius:"8px",border:"none",backgroundColor:"#43b581",color:"white",fontWeight:"bold",cursor:"pointer",width:"100%",fontSize:"1em"},nextBtnWrong:{padding:"12px",borderRadius:"8px",border:"none",backgroundColor:"#f04747",color:"white",fontWeight:"bold",cursor:"pointer",width:"100%",fontSize:"1em"},feedbackKnownBtn:{background:"transparent",border:"none",color:"#949ba4",fontSize:"0.9em",cursor:"pointer",padding:"10px",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",transition:"color 0.2s",opacity:.8},resultCard:{backgroundColor:"var(--background-secondary)",padding:"40px 20px",borderRadius:"20px",display:"flex",flexDirection:"column",alignItems:"center",boxShadow:"0 10px 25px rgba(0,0,0,0.3)",maxWidth:"400px",width:"100%",margin:"auto"},resultTitle:{fontSize:"1.8em",color:"#fff",margin:"10px 0"},resultScore:{fontSize:"1.4em",color:"#7289da",fontWeight:"bold",marginBottom:"20px"},resultMessage:{fontSize:"1.1em",color:"var(--text-muted)",marginBottom:"30px"},resultBtnGroup:{width:"100%",display:"flex",flexDirection:"column",gap:"10px"},primaryBtn:{width:"100%",padding:"15px",borderRadius:"10px",border:"none",backgroundColor:"#5865f2",color:"white",fontWeight:"bold",fontSize:"1em",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},secondaryBtn:{width:"100%",padding:"15px",borderRadius:"10px",border:"2px solid var(--background-tertiary)",backgroundColor:"transparent",color:"var(--text-secondary)",fontWeight:"bold",textAlign:"center",textDecoration:"none",boxSizing:"border-box",display:"block"}};export{ae as default};
