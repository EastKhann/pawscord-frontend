import{r as l,a1 as L,a$ as S,l as X,bU as G,cm as _,d5 as H,bD as J}from"./react-core-B6hadH-M.js";import{t as i}from"./index-D_6pZib5.js";const V=({fetchWithAuth:r,apiBaseUrl:n,onClose:x})=>{const[a,w]=l.useState({}),[d,m]=l.useState({}),[h,R]=l.useState([]),[f,v]=l.useState(0),[u,c]=l.useState([]),[E,b]=l.useState(!1),[y,z]=l.useState("face_shapes"),[g,k]=l.useState("customize"),P=[{id:"face_shapes",name:"Face",icon:"üë§"},{id:"skin_tones",name:"Skin",icon:"üé®"},{id:"eyes",name:"Eyes",icon:"üëÅÔ∏è"},{id:"eye_colors",name:"Eye Color",icon:"üîµ"},{id:"hairstyles",name:"Hair",icon:"üíá"},{id:"hair_colors",name:"Hair Color",icon:"üåà"},{id:"mouths",name:"Mouth",icon:"üëÑ"},{id:"accessories",name:"Accessories",icon:"üëì"},{id:"backgrounds",name:"Background",icon:"üñºÔ∏è"},{id:"expressions",name:"Expression",icon:"üòä"}];l.useEffect(()=>{T(),j(),C()},[]);const T=async()=>{try{const o=await(await r(`${n}/avatar-studio/parts/`)).json();w(o.parts||{}),v(o.user_coins||0)}catch(e){console.error("Failed to fetch parts:",e)}},j=async()=>{try{const o=await(await r(`${n}/avatar-studio/my-avatar/`)).json();m(o.avatar||A()),R(o.owned_items||[])}catch(e){console.error("Failed to fetch avatar:",e)}},C=async()=>{try{const o=await(await r(`${n}/avatar-studio/presets/`)).json();c(o.presets||[])}catch(e){console.error("Failed to fetch presets:",e)}},A=()=>({face_shape:"round",skin_tone:"medium",eyes:"normal",eye_color:"brown",hairstyle:"short",hair_color:"black",mouth:"smile",accessory:"none",background:"solid_gray",expression:"default"}),B=(e,o)=>{e.replace("s","").replace("_color","_color").replace("_tone","_tone");let s=e;e==="face_shapes"?s="face_shape":e==="skin_tones"?s="skin_tone":e==="hairstyles"?s="hairstyle":e==="mouths"?s="mouth":e==="accessories"?s="accessory":e==="backgrounds"?s="background":e==="expressions"?s="expression":e==="eyes"?s="eyes":e==="eye_colors"?s="eye_color":e==="hair_colors"&&(s="hair_color"),m({...d,[s]:o})},F=async(e,o)=>{b(!0);try{const p=await(await r(`${n}/avatar-studio/purchase/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({category:e,item_id:o})})).json();p.message?(i.success(p.message),v(p.new_balance),R(p.owned_items)):i.error(p.error||"Purchase failed")}catch{i.error("Purchase failed")}finally{b(!1)}},D=async()=>{b(!0);try{const o=await(await r(`${n}/avatar-studio/save/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({config:d})})).json();o.message?i.success("Avatar saved!"):i.error(o.error||"Save failed")}catch{i.error("Save failed")}finally{b(!1)}},N=async()=>{try{const o=await(await r(`${n}/avatar-studio/randomize/`,{method:"POST"})).json();o.avatar&&(m(o.avatar),i.success("Randomized!"))}catch{i.error("Failed to randomize")}},O=async()=>{const e=prompt("Enter preset name:");if(e)try{(await(await r(`${n}/avatar-studio/presets/save/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,config:d})})).json()).preset_id&&(i.success("Preset saved!"),C())}catch{i.error("Failed to save preset")}},$=e=>{m(e.config),k("customize")};return React.createElement("div",{style:t.overlay},React.createElement("div",{style:t.modal},React.createElement("div",{style:t.header},React.createElement("div",{style:t.headerLeft},React.createElement(L,{style:{marginRight:"10px",color:"#5865f2"}}),React.createElement("h2",{style:t.title},"Avatar Studio")),React.createElement("div",{style:t.coinsDisplay},React.createElement(S,{style:{color:"#faa61a"}}),React.createElement("span",null,f)),React.createElement("button",{onClick:x,style:t.closeButton},React.createElement(X,null))),React.createElement("div",{style:t.tabs},React.createElement("button",{onClick:()=>k("customize"),style:g==="customize"?t.activeTab:t.tab},React.createElement(G,null)," Customize"),React.createElement("button",{onClick:()=>k("presets"),style:g==="presets"?t.activeTab:t.tab},React.createElement(_,null)," Presets")),React.createElement("div",{style:t.mainContent},g==="customize"&&React.createElement(React.Fragment,null,React.createElement("div",{style:t.previewSection},React.createElement(I,{avatar:d,parts:a}),React.createElement("div",{style:t.previewActions},React.createElement("button",{onClick:N,style:t.actionBtn},React.createElement(H,null)," Random"),React.createElement("button",{onClick:O,style:t.actionBtn},React.createElement(_,null)," Save Preset"),React.createElement("button",{onClick:D,style:t.saveBtn,disabled:E},React.createElement(J,null)," ",E?"Saving...":"Save Avatar"))),React.createElement("div",{style:t.customizeSection},React.createElement("div",{style:t.categoryTabs},P.map(e=>React.createElement("button",{key:e.id,onClick:()=>z(e.id),style:y===e.id?t.catActive:t.catBtn},React.createElement("span",null,e.icon),React.createElement("span",{style:t.catName},e.name)))),React.createElement("div",{style:t.itemsGrid},(a[y]||[]).map(e=>{const o=e.free||h.includes(e.id),s=Object.values(d).includes(e.id);return React.createElement("div",{key:e.id,style:{...t.itemCard,...s?t.itemSelected:{},...o?{}:t.itemLocked},onClick:()=>o&&B(y,e.id)},e.color&&e.color!=="gradient"&&e.color!=="galaxy"&&e.color!=="rainbow"?React.createElement("div",{style:{...t.colorSwatch,background:e.color}}):React.createElement("span",{style:t.itemPreview},e.name?.charAt(0)||e.id.charAt(0).toUpperCase()),React.createElement("span",{style:t.itemName},e.name||e.id),!o&&React.createElement("button",{onClick:p=>{p.stopPropagation(),F(y,e.id)},style:t.buyBtn,disabled:E||f<(e.coins||0)},React.createElement(S,null)," ",e.coins))})))),g==="presets"&&React.createElement("div",{style:t.presetsGrid},u.map(e=>React.createElement("div",{key:e.id,style:t.presetCard},React.createElement(I,{avatar:e.config,parts:a,mini:!0}),React.createElement("span",{style:t.presetName},e.name),React.createElement("button",{onClick:()=>$(e),style:t.loadBtn},"Load"))),u.length===0&&React.createElement("p",{style:t.emptyText},"No presets saved yet")))))},I=({avatar:r,parts:n,mini:x=!1})=>{const a=x?80:200,d=n.backgrounds?.find(c=>c.id===r.background)?.color||"#36393f",h=n.skin_tones?.find(c=>c.id===r.skin_tone)?.color||"#D2B48C",f=n.hair_colors?.find(c=>c.id===r.hair_color)?.color||"#1C1C1C",u=n.eye_colors?.find(c=>c.id===r.eye_color)?.color||"#8B4513";return React.createElement("div",{style:{width:a,height:a,borderRadius:"50%",background:d,display:"flex",alignItems:"center",justifyContent:"center",position:"relative",overflow:"hidden",border:"4px solid #40444b"}},React.createElement("div",{style:{width:a*.7,height:a*.8,borderRadius:r.face_shape==="round"?"50%":r.face_shape==="oval"?"50% 50% 45% 45%":r.face_shape==="square"?"10%":"50%",background:h,position:"relative"}},React.createElement("div",{style:{position:"absolute",top:-a*.1,left:"50%",transform:"translateX(-50%)",width:a*.7,height:a*.3,background:f,borderRadius:"50% 50% 0 0"}}),React.createElement("div",{style:{position:"absolute",top:"35%",left:"50%",transform:"translateX(-50%)",display:"flex",gap:a*.15}},React.createElement("div",{style:{width:a*.1,height:a*.1,borderRadius:"50%",background:u}}),React.createElement("div",{style:{width:a*.1,height:a*.1,borderRadius:"50%",background:u}})),React.createElement("div",{style:{position:"absolute",bottom:"20%",left:"50%",transform:"translateX(-50%)",width:a*.2,height:a*.05,background:r.mouth==="smile"?"#e8a0a0":"#d4a0a0",borderRadius:r.mouth==="smile"?"0 0 50% 50%":"4px"}})),r.accessory==="glasses"&&React.createElement("div",{style:{position:"absolute",top:"32%",left:"50%",transform:"translateX(-50%)",width:a*.5,height:a*.12,border:"2px solid #333",borderRadius:"4px",background:"transparent"}}),r.accessory==="crown"&&React.createElement("div",{style:{position:"absolute",top:0,left:"50%",transform:"translateX(-50%)",fontSize:a*.2}},"üëë"),r.accessory==="cat_ears"&&React.createElement("div",{style:{position:"absolute",top:a*.05,left:"50%",transform:"translateX(-50%)",fontSize:a*.15}},"üê±"))},t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e4},modal:{backgroundColor:"#2f3136",borderRadius:"12px",width:"900px",maxHeight:"90vh",overflow:"hidden",display:"flex",flexDirection:"column"},header:{display:"flex",alignItems:"center",padding:"20px",borderBottom:"1px solid #40444b"},headerLeft:{display:"flex",alignItems:"center",flex:1},title:{margin:0,color:"#fff",fontSize:"20px"},coinsDisplay:{display:"flex",alignItems:"center",gap:"6px",color:"#fff",marginRight:"20px",background:"#40444b",padding:"6px 12px",borderRadius:"20px"},closeButton:{background:"none",border:"none",color:"#b9bbbe",cursor:"pointer",fontSize:"20px"},tabs:{display:"flex",padding:"10px 20px",gap:"10px",borderBottom:"1px solid #40444b"},tab:{background:"#40444b",border:"none",color:"#b9bbbe",padding:"8px 16px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},activeTab:{background:"#5865f2",border:"none",color:"#fff",padding:"8px 16px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},mainContent:{display:"flex",padding:"20px",gap:"20px",overflowY:"auto",flex:1},previewSection:{width:"250px",display:"flex",flexDirection:"column",alignItems:"center",gap:"20px"},previewActions:{display:"flex",flexDirection:"column",gap:"10px",width:"100%"},actionBtn:{background:"#40444b",border:"none",color:"#fff",padding:"10px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},saveBtn:{background:"#57f287",border:"none",color:"#000",padding:"12px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",fontWeight:"bold"},customizeSection:{flex:1},categoryTabs:{display:"flex",flexWrap:"wrap",gap:"8px",marginBottom:"15px"},catBtn:{background:"#40444b",border:"none",color:"#b9bbbe",padding:"8px 12px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",fontSize:"12px"},catActive:{background:"#5865f2",border:"none",color:"#fff",padding:"8px 12px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",fontSize:"12px"},catName:{display:"none"},itemsGrid:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"10px"},itemCard:{background:"#40444b",borderRadius:"8px",padding:"12px",display:"flex",flexDirection:"column",alignItems:"center",gap:"8px",cursor:"pointer",position:"relative"},itemSelected:{border:"2px solid #5865f2",background:"#36393f"},itemLocked:{opacity:.7,cursor:"default"},colorSwatch:{width:"40px",height:"40px",borderRadius:"50%",border:"2px solid #fff"},itemPreview:{width:"40px",height:"40px",borderRadius:"50%",background:"#5865f2",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontWeight:"bold"},itemName:{color:"#dcddde",fontSize:"11px",textAlign:"center"},buyBtn:{position:"absolute",bottom:"8px",right:"8px",background:"#faa61a",border:"none",color:"#000",padding:"4px 8px",borderRadius:"4px",cursor:"pointer",fontSize:"10px",display:"flex",alignItems:"center",gap:"4px"},presetsGrid:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"15px",width:"100%"},presetCard:{background:"#40444b",borderRadius:"10px",padding:"15px",display:"flex",flexDirection:"column",alignItems:"center",gap:"10px"},presetName:{color:"#fff",fontSize:"14px"},loadBtn:{background:"#5865f2",border:"none",color:"#fff",padding:"6px 16px",borderRadius:"4px",cursor:"pointer"},emptyText:{color:"#72767d",textAlign:"center",gridColumn:"1 / -1",padding:"40px"}};export{V as default};
