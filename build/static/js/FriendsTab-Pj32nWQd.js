import{b as N,r as o,j as e}from"./react-vendor-D8Fi5F9E.js";import{ab as E,a as v,c as Y,a0 as M,ae as W}from"./icons-vendor-BPCemF_6.js";import{u as J}from"./index-Bijt1sLR.js";import{L as C}from"./LazyImage-DecNWMsX.js";import"./media-vendor-Dp18sh1g.js";import"./router-vendor-CTPwQFnc.js";import"./crypto-vendor-Cz32ecGD.js";import"./state-vendor-De5qIGw3.js";const q=new Set(["fps monitor","msi afterburner","rivatuner","fraps","nvidia geforce experience","amd radeon software","obs","obs studio","streamlabs","xsplit","nvidia shadowplay","movavi video suite","movavi","camtasia","bandicam","soundpad","voicemod","discord overlay","teamspeak","mumble","overwolf","razer cortex","steam","epic games launcher","origin","uplay","battle.net","gog galaxy","ea app","xbox app","microsoft store"]),U=i=>{if(!i)return!1;const l=i.toLowerCase().trim();for(const x of q)if(l.includes(x)||x.includes(l))return!0;return!1},X=({fetchWithAuth:i,apiBaseUrl:l,getDeterministicAvatar:x,onStartDM:B,onClose:_,onPendingCountChange:j,onlineUsers:y=[]})=>{const[f,g]=o.useState("all"),[h,L]=o.useState([]),[u,D]=o.useState([]),[k,K]=o.useState([]),[m,R]=o.useState(""),[Q,$]=o.useState(!0),[c,a]=o.useState(null),{globalData:I}=J();console.log("ðŸ‘¥ [FriendsTab] onlineUsers prop:",y);const d=o.useCallback(async()=>{try{const n=await i(`${l}/friends/list/`);if(n.ok){const r=await n.json();L(r.friends||[]),D(r.incoming_requests||[]),K(r.outgoing_requests||[]),j&&j((r.incoming_requests||[]).length)}}catch(n){console.error("ArkadaÅŸ listesi Ã§ekilemedi:",n)}finally{$(!1)}},[l,i,j]);o.useEffect(()=>{d()},[d]),o.useEffect(()=>{I?.type==="friend_list_update"&&(console.log("ðŸ”” CANLI BÄ°LDÄ°RÄ°M: Yeni arkadaÅŸ isteÄŸi/yanÄ±tÄ± geldi!"),d(),a({type:"info",text:'ðŸ”” ArkadaÅŸ listeniz gÃ¼ncellendi! "Bekleyenler" sekmesini kontrol edin.'}),setTimeout(()=>a(null),5e3))},[I,d]);const H=o.useCallback(async n=>{if(n.preventDefault(),!!m.trim())try{const r=await i(`${l}/friends/send/`,{method:"POST",body:JSON.stringify({username:m.trim()})}),s=await r.json();r.ok?(a({type:"success",text:`âœ… Ä°stek gÃ¶nderildi: ${m}`}),R(""),d()):a({type:"error",text:`âŒ ${s.error||"Hata."}`})}catch{a({type:"error",text:"âŒ Sunucu hatasÄ±."})}},[m,l,i,d]),S=o.useCallback(async(n,r)=>{try{(await i(`${l}/friends/respond/${n}/`,{method:"POST",body:JSON.stringify({action:r})})).ok&&(d(),a({type:"success",text:r==="accept"?"ArkadaÅŸlÄ±k kabul edildi!":"Ä°stek reddedildi."}))}catch(s){console.error("Ä°ÅŸlem baÅŸarÄ±sÄ±z:",s)}},[l,i,d]),O=o.useCallback(async(n,r)=>{if(window.confirm(`${r} ile arkadaÅŸlÄ±ÄŸÄ± sonlandÄ±rmak istediÄŸinize emin misiniz?`))try{(await i(`${l}/friends/remove/${n}/`,{method:"DELETE"})).ok?(d(),a({type:"success",text:"âŒ ArkadaÅŸlÄ±k sonlandÄ±rÄ±ldÄ±."})):a({type:"error",text:"âŒ Silme baÅŸarÄ±sÄ±z."})}catch(s){console.error("ArkadaÅŸ silme hatasÄ±:",s),a({type:"error",text:"âŒ Sunucu hatasÄ±."})}},[l,i,d]);return e.jsxs("div",{style:t.container,children:[e.jsxs("div",{style:t.topBar,children:[e.jsxs("div",{style:t.headerLeft,children:[e.jsxs("div",{style:t.title,children:[e.jsx(E,{style:{marginRight:"10px"}}),"ArkadaÅŸlar"]}),e.jsxs("div",{style:t.tabButtons,children:[e.jsxs("button",{style:{...t.tabBtn,...f==="all"?t.activeTabBtn:{}},onClick:()=>{g("all"),a(null)},children:["TÃ¼mÃ¼ (",h.length,")"]}),e.jsxs("button",{style:{...t.tabBtn,...f==="pending"?t.activeTabBtn:{}},onClick:()=>{g("pending"),a(null)},children:["Bekleyenler",u.length>0&&e.jsx("span",{style:t.badgePulse,children:u.length})]}),e.jsx("button",{style:{...t.addFriendBtn,...f==="add"?t.activeAddFriendBtn:{}},onClick:()=>{g("add"),a(null)},children:"ArkadaÅŸ Ekle"})]})]}),e.jsx("button",{onClick:_,style:t.closeHeaderBtn,title:"Kapat",children:e.jsx(v,{})})]}),e.jsxs("div",{style:t.contentArea,children:[c&&e.jsxs("div",{style:{marginBottom:"20px",padding:"12px",borderRadius:"8px",backgroundColor:c.type==="success"?"rgba(67, 181, 129, 0.2)":c.type==="info"?"rgba(88, 101, 242, 0.2)":"rgba(240, 71, 71, 0.2)",color:c.type==="success"?"#43b581":c.type==="info"?"#dee0fc":"#f04747",border:`1px solid ${c.type==="success"?"#43b581":c.type==="info"?"#5865f2":"#f04747"}`,display:"flex",alignItems:"center",gap:"10px",animation:"fadeIn 0.3s ease"},children:[c.type==="info"&&e.jsx(Y,{}),c.text]}),f==="add"&&e.jsxs("div",{style:t.addSection,children:[e.jsx("h3",{style:{color:"#fff",marginBottom:"10px"},children:"ARKADAÅž EKLE"}),e.jsx("p",{style:{color:"#b9bbbe",fontSize:"0.9em",marginBottom:"20px"},children:"KullanÄ±cÄ± adÄ±nÄ± girerek arkadaÅŸ ekleyebilirsin."}),e.jsxs("form",{onSubmit:H,style:t.addForm,children:[e.jsx("input",{type:"text",value:m,onChange:n=>R(n.target.value),placeholder:"KullanÄ±cÄ± AdÄ± veya ArkadaÅŸ Kodu (Ã–rn: 8392014)",style:t.input,autoFocus:!0}),e.jsxs("button",{type:"submit",style:t.sendRequestBtn,children:[e.jsx(M,{style:{marginRight:"5px"}})," GÃ¶nder"]})]})]}),f==="all"&&e.jsxs("div",{style:t.listContainer,children:[e.jsxs("h4",{style:t.listHeader,children:["ARKADAÅžLAR â€” ",h.length]}),h.length===0?e.jsxs("div",{style:t.emptyState,children:[e.jsx("div",{style:{fontSize:"3em",marginBottom:"10px"},children:"ðŸ¥º"}),e.jsx("p",{style:t.emptyText,children:"HenÃ¼z kimseyle arkadaÅŸ deÄŸilsin."}),e.jsx("button",{onClick:()=>g("add"),style:t.emptyBtn,children:"ArkadaÅŸ Ekle"})]}):h.map(n=>{console.log("ðŸ”¥ [FriendsTab] RAW friend data:",n);const r=localStorage.getItem("chat_username")||"",s=n.sender_username===r,p=s?n.receiver_username:n.sender_username,A=s?n.receiver_avatar:n.sender_avatar,b=s?n.receiver_activity:n.sender_activity,T=Array.isArray(y)&&y.includes(p),z=T?"online":"offline";console.log("ðŸ”¥ [FriendsTab] Processed friend:",{friendId:n.id,myUsername:r,iAmSender:s,friendUsername:p,displayAvatar:A,isReallyOnline:T,onlineUsersArray:y});const P={online:"Ã‡evrimiÃ§i",idle:"BoÅŸta",dnd:"RahatsÄ±z Etmeyin",invisible:"GÃ¶rÃ¼nmez",offline:"Ã‡evrimdÄ±ÅŸÄ±"}[z]||"Ã‡evrimdÄ±ÅŸÄ±",G={online:"#23a559",idle:"#f0b232",dnd:"#f23f43",invisible:"#80848e",offline:"#80848e"}[z]||"#80848e";return e.jsxs("div",{style:t.listItem,children:[e.jsxs("div",{style:t.userInfo,onClick:()=>B(p),children:[e.jsx(C,{src:A||x(p),style:t.avatar,alt:"avatar"}),e.jsxs("div",{style:{marginLeft:"12px",display:"flex",flexDirection:"column",overflow:"hidden"},children:[e.jsx("div",{style:t.username,children:p}),e.jsx("div",{style:{...t.status,color:G},children:P}),b?.spotify&&e.jsxs("span",{style:{fontSize:"10px",color:"#1db954",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",marginTop:"2px"},children:["ðŸŽµ ",b.spotify.track]}),b?.steam&&!U(b.steam.game)&&e.jsxs("span",{style:{fontSize:"10px",color:"#66c0f4",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",marginTop:"2px"},children:["ðŸŽ® ",b.steam.game]})]})]}),e.jsxs("div",{style:t.actions,children:[e.jsx("button",{style:t.iconButton,title:"Mesaj At",onClick:w=>{w.stopPropagation(),B(p)},children:e.jsx(E,{})}),e.jsx("button",{style:{...t.iconButton,backgroundColor:"#ed4245"},title:"ArkadaÅŸlÄ±ktan Ã‡Ä±kar",onClick:w=>{w.stopPropagation(),O(n.id,p)},children:e.jsx(v,{})})]})]},n.id)})]}),f==="pending"&&e.jsxs("div",{style:t.listContainer,children:[e.jsxs("h4",{style:t.listHeader,children:["BEKLEYEN Ä°STEKLER â€” ",u.length]}),u.length===0&&k.length===0&&e.jsx("p",{style:t.emptyText,children:"Bekleyen istek yok."}),u.map(n=>{const r=n.sender_username||"Unknown",s=n.sender_avatar;return e.jsxs("div",{style:{...t.listItem,backgroundColor:"rgba(250, 166, 26, 0.1)"},children:[e.jsxs("div",{style:t.userInfo,children:[e.jsx(C,{src:s||x(r),style:t.avatar,alt:"avatar"}),e.jsxs("div",{style:{marginLeft:"12px"},children:[e.jsx("strong",{style:{color:"white",display:"block"},children:r}),e.jsx("span",{style:{fontSize:"0.8em",color:"#faa61a"},children:"Sana istek gÃ¶nderdi!"})]})]}),e.jsxs("div",{style:t.actions,children:[e.jsx("button",{onClick:()=>S(n.id,"accept"),style:t.acceptBtn,title:"Kabul Et",children:e.jsx(W,{})}),e.jsx("button",{onClick:()=>S(n.id,"reject"),style:t.rejectBtn,title:"Reddet",children:e.jsx(v,{})})]})]},n.id)}),k.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("h4",{style:{...t.listHeader,marginTop:"30px"},children:["GÃ–NDERDÄ°KLERÄ°M â€” ",k.length]}),k.map(n=>{const r=n.receiver_username||"Unknown",s=n.receiver_avatar;return e.jsxs("div",{style:t.listItem,children:[e.jsxs("div",{style:t.userInfo,children:[e.jsx(C,{src:s||x(r),style:t.avatar,alt:"avatar"}),e.jsxs("span",{style:{marginLeft:"12px",color:"#b9bbbe"},children:[r," (Bekliyor...)"]})]}),e.jsx("button",{onClick:()=>S(n.id,"reject"),style:t.rejectBtn,title:"Ä°ptal Et",children:e.jsx(v,{})})]},n.id)})]})]})]})]})},t={container:{display:"flex",flexDirection:"column",height:"100%",backgroundColor:"#313338",color:"#dcddde"},topBar:{padding:"10px 15px",borderBottom:"1px solid #1f2023",display:"flex",alignItems:"center",justifyContent:"space-between",backgroundColor:"#313338",height:"50px",boxSizing:"border-box"},headerLeft:{display:"flex",alignItems:"center",flex:1,overflow:"hidden"},title:{fontSize:"1em",fontWeight:"bold",color:"#fff",display:"flex",alignItems:"center",marginRight:"10px",paddingRight:"10px",borderRight:"1px solid #4f545c",whiteSpace:"nowrap"},tabButtons:{display:"flex",gap:"10px",overflowX:"auto"},tabBtn:{background:"none",border:"none",color:"#b9bbbe",cursor:"pointer",fontSize:"0.9em",padding:"2px 8px",borderRadius:"4px",fontWeight:"500",transition:"all 0.2s",whiteSpace:"nowrap",display:"flex",alignItems:"center",gap:"5px"},activeTabBtn:{color:"#fff",backgroundColor:"rgba(79,84,92,0.32)"},addFriendBtn:{backgroundColor:"#23a559",color:"#fff",border:"none",borderRadius:"4px",padding:"2px 10px",fontSize:"0.9em",fontWeight:"bold",cursor:"pointer",transition:"all 0.2s",whiteSpace:"nowrap"},activeAddFriendBtn:{backgroundColor:"transparent",color:"#23a559",border:"1px solid transparent"},closeHeaderBtn:{background:"none",border:"none",color:"#b9bbbe",fontSize:"1.5em",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",padding:"5px",borderRadius:"50%"},contentArea:{flexGrow:1,padding:"20px",overflowY:"auto"},addSection:{maxWidth:"100%",borderBottom:"1px solid #4f545c",paddingBottom:"20px"},addForm:{display:"flex",flexDirection:window.innerWidth<=768?"column":"row",gap:"10px",backgroundColor:"#1e1f22",padding:"10px",borderRadius:"8px",border:"1px solid #1e1f22",alignItems:"stretch",marginTop:"10px"},input:{flexGrow:1,background:"transparent",border:"none",color:"#fff",fontSize:"1em",outline:"none",minHeight:"40px"},sendRequestBtn:{backgroundColor:"#5865f2",color:"#fff",border:"none",padding:"10px 20px",borderRadius:"4px",cursor:"pointer",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",whiteSpace:"nowrap"},listContainer:{},listHeader:{fontSize:"0.8em",color:"#b9bbbe",textTransform:"uppercase",marginBottom:"15px",borderBottom:"1px solid #4f545c",paddingBottom:"10px"},emptyState:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",marginTop:"50px"},emptyText:{color:"#72767d",fontStyle:"italic",marginBottom:"20px",textAlign:"center"},emptyBtn:{padding:"10px 20px",backgroundColor:"#5865f2",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"bold"},listItem:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px",borderTop:"1px solid #4f545c",cursor:"pointer",transition:"background-color 0.2s"},userInfo:{display:"flex",alignItems:"center"},avatar:{width:"32px",height:"32px",borderRadius:"50%",objectFit:"cover"},username:{color:"#fff",fontWeight:"600"},status:{fontSize:"0.8em",color:"#b9bbbe"},actions:{display:"flex",gap:"10px"},iconButton:{padding:"8px",borderRadius:"50%",backgroundColor:"#2f3136",border:"none",color:"#b9bbbe",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},acceptBtn:{padding:"8px",borderRadius:"50%",backgroundColor:"#2f3136",border:"none",color:"#43b581",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},rejectBtn:{padding:"8px",borderRadius:"50%",backgroundColor:"#2f3136",border:"none",color:"#f04747",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},badgePulse:{backgroundColor:"#f04747",color:"#fff",borderRadius:"50%",padding:"1px 6px",fontSize:"0.75em",marginLeft:"5px",animation:"pulseBadge 1.5s infinite"}},F=document.createElement("style");F.innerText=`
  @keyframes pulseBadge {
    0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(240, 71, 71, 0.7); }
    70% { transform: scale(1.1); box-shadow: 0 0 0 6px rgba(240, 71, 71, 0); }
    100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(240, 71, 71, 0); }
  }
  @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
`;document.head.appendChild(F);const ae=N.memo(X);export{ae as default};
