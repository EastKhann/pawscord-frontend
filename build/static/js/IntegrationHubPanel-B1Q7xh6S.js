import{r as d,d as e,dj as v,i as _,v as A,aC as N,p as f,o as L,d4 as H,cP as I,dk as K,cN as D,cM as G,cK as R,cH as Y,cL as J,cO as F,aR as w,l as U,bM as T,c9 as h,dl as Q,aQ as V,bB as q,B as X}from"./react-core-DrOm_csO.js";const ce=({serverId:l,onClose:i})=>{const[o,m]=d.useState("connected"),[u,s]=d.useState([]),[t,c]=d.useState([]),[a,E]=d.useState(!0),[k,r]=d.useState(""),[C,S]=d.useState({show:!1,integration:null}),y=localStorage.getItem("access_token"),$={github:J,spotify:Y,twitch:R,youtube:G,discord:D,slack:K,google:I,twitter:H},z={github:"#333",spotify:"#1db954",twitch:"#9146ff",youtube:"#ff0000",discord:"#5865f2",slack:"#4a154b",google:"#4285f4",twitter:"#1da1f2"};d.useEffect(()=>{g()},[l]);const g=async()=>{E(!0);try{const[n,b]=await Promise.all([fetch(`/api/servers/${l}/integrations/`,{headers:{Authorization:`Bearer ${y}`}}),fetch("/api/integrations/available/",{headers:{Authorization:`Bearer ${y}`}})]);if(n.ok){const p=await n.json();s(p.integrations||[])}if(b.ok){const p=await b.json();c(p.integrations||[])}else c([])}catch(n){console.error("Error fetching integrations:",n),c([])}E(!1)},W=async n=>{try{const b=await fetch(`/api/servers/${l}/integrations/connect/`,{method:"POST",headers:{Authorization:`Bearer ${y}`,"Content-Type":"application/json"},body:JSON.stringify({integration_type:n})});if(b.ok){const p=await b.json();p.oauth_url&&window.open(p.oauth_url,"_blank","width=500,height=600"),h.success(`${n} entegrasyon başlatıldı`),g()}else h.error("Bağlantı başlatılamadı")}catch{h.error("Bağlantı hatası")}},M=async n=>{if(window.confirm("Bu entegrasyonu kaldırmak istediğinize emin misiniz?"))try{(await fetch(`/api/servers/${l}/integrations/${n}/disconnect/`,{method:"POST",headers:{Authorization:`Bearer ${y}`}})).ok&&(h.success("Entegrasyon kaldırıldı"),g())}catch{h.error("Entegrasyon kaldırılamadı")}},O=async n=>{try{(await fetch(`/api/servers/${l}/integrations/${n}/sync/`,{method:"POST",headers:{Authorization:`Bearer ${y}`}})).ok&&h.success("Senkronizasyon başlatıldı")}catch{h.error("Senkronizasyon başarısız")}},j=n=>{switch(n){case"development":return e.createElement(X,null);case"entertainment":return e.createElement(q,null);case"streaming":return e.createElement(V,null);case"productivity":return e.createElement(Q,null);default:return e.createElement(v,null)}},x=t.filter(n=>n.name.toLowerCase().includes(k.toLowerCase())||n.description.toLowerCase().includes(k.toLowerCase())),P=u.map(n=>n.type),B=x.filter(n=>!P.includes(n.id));return e.createElement("div",{className:"integration-hub-overlay",onClick:n=>n.target.className==="integration-hub-overlay"&&i()},e.createElement("div",{className:"integration-hub-panel"},e.createElement("div",{className:"panel-header"},e.createElement("h2",null,e.createElement(v,null)," Entegrasyon Merkezi"),e.createElement("button",{className:"close-btn",onClick:i},e.createElement(_,null))),e.createElement("div",{className:"tabs-bar"},e.createElement("div",{className:"tabs"},e.createElement("button",{className:`tab ${o==="connected"?"active":""}`,onClick:()=>m("connected")},e.createElement(A,null)," Bağlı (",u.length,")"),e.createElement("button",{className:`tab ${o==="available"?"active":""}`,onClick:()=>m("available")},e.createElement(N,null)," Mevcut (",B.length,")"),e.createElement("button",{className:`tab ${o==="webhooks"?"active":""}`,onClick:()=>m("webhooks")},e.createElement(f,null)," Webhooks"))),o==="available"&&e.createElement("div",{className:"search-bar"},e.createElement(L,null),e.createElement("input",{type:"text",placeholder:"Entegrasyon ara...",value:k,onChange:n=>r(n.target.value)})),e.createElement("div",{className:"panel-content"},a?e.createElement("div",{className:"loading"},"Yükleniyor..."):e.createElement(e.Fragment,null,o==="connected"&&e.createElement(Z,{integrations:u,icons:$,colors:z,onDisconnect:M,onSync:O,onConfigure:n=>S({show:!0,integration:n})}),o==="available"&&e.createElement(ee,{integrations:B,icons:$,colors:z,getCategoryIcon:j,onConnect:W}),o==="webhooks"&&e.createElement(te,{serverId:l,token:y}))),C.show&&e.createElement(ne,{integration:C.integration,serverId:l,token:y,onClose:()=>S({show:!1,integration:null}),onSave:g})))},Z=({integrations:l,icons:i,colors:o,onDisconnect:m,onSync:u,onConfigure:s})=>l.length===0?e.createElement("div",{className:"empty-state"},e.createElement(F,null),e.createElement("p",null,"Henüz bağlı entegrasyon yok"),e.createElement("span",{className:"hint"},'"Mevcut" sekmesinden entegrasyon ekleyin')):e.createElement("div",{className:"connected-list"},l.map(t=>{const c=i[t.type]||v,a=o[t.type]||"#666";return e.createElement("div",{key:t.id,className:"integration-card connected"},e.createElement("div",{className:"integration-icon",style:{background:a}},e.createElement(c,null)),e.createElement("div",{className:"integration-info"},e.createElement("h4",null,t.name),e.createElement("div",{className:"connection-info"},e.createElement("span",{className:"status connected"},e.createElement(w,null)," Bağlı"),t.account_name&&e.createElement("span",{className:"account"},"@",t.account_name)),e.createElement("div",{className:"last-sync"},"Son senkronizasyon: ",t.last_sync||"Hiç")),e.createElement("div",{className:"integration-actions"},e.createElement("button",{className:"action-btn sync",onClick:()=>u(t.id),title:"Senkronize Et"},e.createElement(U,null)),e.createElement("button",{className:"action-btn config",onClick:()=>s(t),title:"Ayarlar"},e.createElement(T,null)),e.createElement("button",{className:"action-btn disconnect",onClick:()=>m(t.id),title:"Bağlantıyı Kes"},e.createElement(F,null))))})),ee=({integrations:l,icons:i,colors:o,getCategoryIcon:m,onConnect:u})=>{const s=[...new Set(l.map(t=>t.category))];return l.length===0?e.createElement("div",{className:"empty-state"},e.createElement(v,null),e.createElement("p",null,"Tüm entegrasyonlar zaten bağlı")):e.createElement("div",{className:"available-list"},s.map(t=>e.createElement("div",{key:t,className:"category-section"},e.createElement("h3",{className:"category-title"},m(t),t==="development"&&"Geliştirme",t==="entertainment"&&"Eğlence",t==="streaming"&&"Yayın",t==="productivity"&&"Üretkenlik",t==="content"&&"İçerik",t==="social"&&"Sosyal"),e.createElement("div",{className:"integrations-grid"},l.filter(c=>c.category===t).map(c=>{const a=i[c.id]||v,E=o[c.id]||"#666";return e.createElement("div",{key:c.id,className:"integration-card available"},e.createElement("div",{className:"integration-icon",style:{background:E}},e.createElement(a,null)),e.createElement("div",{className:"integration-details"},e.createElement("h4",null,c.name),e.createElement("p",null,c.description),e.createElement("ul",{className:"features"},c.features?.slice(0,3).map((k,r)=>e.createElement("li",{key:r},e.createElement(w,null)," ",k)))),e.createElement("button",{className:"connect-btn",onClick:()=>u(c.id)},e.createElement(A,null)," Bağla"))})))))},te=({serverId:l,token:i})=>{const[o,m]=d.useState([]),[u,s]=d.useState(!1);d.useEffect(()=>{t()},[]);const t=async()=>{try{const a=await fetch(`/api/servers/${l}/webhooks/`,{headers:{Authorization:`Bearer ${i}`}});if(a.ok){const E=await a.json();m(E.webhooks||[])}}catch(a){console.error("Error fetching webhooks:",a)}},c=async a=>{if(window.confirm("Bu webhook'u silmek istediğinize emin misiniz?"))try{(await fetch(`/api/servers/${l}/webhooks/${a}/`,{method:"DELETE",headers:{Authorization:`Bearer ${i}`}})).ok&&(h.success("Webhook silindi"),t())}catch{h.error("Webhook silinemedi")}};return e.createElement("div",{className:"webhooks-view"},e.createElement("div",{className:"webhooks-header"},e.createElement("p",null,"Webhooks ile dış servislerden otomatik mesajlar alın"),e.createElement("button",{className:"create-webhook-btn",onClick:()=>s(!0)},e.createElement(N,null)," Yeni Webhook")),o.length===0?e.createElement("div",{className:"empty-state"},e.createElement(f,null),e.createElement("p",null,"Henüz webhook oluşturulmamış")):e.createElement("div",{className:"webhooks-list"},o.map(a=>e.createElement("div",{key:a.id,className:"webhook-item"},e.createElement("div",{className:"webhook-avatar"},a.avatar?e.createElement("img",{src:a.avatar,alt:""}):e.createElement(f,null)),e.createElement("div",{className:"webhook-info"},e.createElement("h4",null,a.name),e.createElement("span",{className:"webhook-channel"},"#",a.channel_name),e.createElement("div",{className:"webhook-url"},e.createElement("code",null,a.url.substring(0,40),"..."),e.createElement("button",{onClick:()=>{navigator.clipboard.writeText(a.url),h.success("URL kopyalandı")}},"Kopyala"))),e.createElement("div",{className:"webhook-actions"},e.createElement("button",{className:"action-btn delete",onClick:()=>c(a.id)},e.createElement(_,null)))))),u&&e.createElement(ae,{serverId:l,token:i,onClose:()=>s(!1),onCreated:()=>{t(),s(!1)}}))},ae=({serverId:l,token:i,onClose:o,onCreated:m})=>{const[u,s]=d.useState(""),[t,c]=d.useState(""),[a,E]=d.useState([]);d.useEffect(()=>{fetch(`/api/servers/${l}/channels/`,{headers:{Authorization:`Bearer ${i}`}}).then(r=>r.json()).then(r=>E(r.channels||[])).catch(()=>{})},[]);const k=async()=>{if(!u||!t){h.warning("Tüm alanları doldurun");return}try{(await fetch(`/api/servers/${l}/webhooks/`,{method:"POST",headers:{Authorization:`Bearer ${i}`,"Content-Type":"application/json"},body:JSON.stringify({name:u,channel_id:t})})).ok&&(h.success("Webhook oluşturuldu"),m())}catch{h.error("Webhook oluşturulamadı")}};return e.createElement("div",{className:"modal-overlay",onClick:r=>r.target.className==="modal-overlay"&&o()},e.createElement("div",{className:"webhook-modal"},e.createElement("h3",null,e.createElement(N,null)," Yeni Webhook Oluştur"),e.createElement("div",{className:"form-group"},e.createElement("label",null,"Webhook Adı"),e.createElement("input",{type:"text",value:u,onChange:r=>s(r.target.value),placeholder:"örn: GitHub Bot"})),e.createElement("div",{className:"form-group"},e.createElement("label",null,"Kanal"),e.createElement("select",{value:t,onChange:r=>c(r.target.value)},e.createElement("option",{value:""},"Kanal seçin..."),a.map(r=>e.createElement("option",{key:r.id,value:r.id},"#",r.name)))),e.createElement("div",{className:"modal-actions"},e.createElement("button",{className:"cancel-btn",onClick:o},"İptal"),e.createElement("button",{className:"create-btn",onClick:k},"Oluştur"))))},ne=({integration:l,serverId:i,token:o,onClose:m,onSave:u})=>{const[s,t]=d.useState({notifications_enabled:!0,notification_channel:"",auto_sync:!0,sync_interval:30}),c=async()=>{try{(await fetch(`/api/servers/${i}/integrations/${l.id}/configure/`,{method:"POST",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"},body:JSON.stringify(s)})).ok&&(h.success("Ayarlar kaydedildi"),u(),m())}catch{h.error("Ayarlar kaydedilemedi")}};return e.createElement("div",{className:"modal-overlay",onClick:a=>a.target.className==="modal-overlay"&&m()},e.createElement("div",{className:"config-modal"},e.createElement("h3",null,e.createElement(T,null)," ",l.name," Ayarları"),e.createElement("div",{className:"config-section"},e.createElement("label",{className:"checkbox-label"},e.createElement("input",{type:"checkbox",checked:s.notifications_enabled,onChange:a=>t({...s,notifications_enabled:a.target.checked})}),"Bildirimleri Etkinleştir")),e.createElement("div",{className:"config-section"},e.createElement("label",{className:"checkbox-label"},e.createElement("input",{type:"checkbox",checked:s.auto_sync,onChange:a=>t({...s,auto_sync:a.target.checked})}),"Otomatik Senkronizasyon")),s.auto_sync&&e.createElement("div",{className:"form-group"},e.createElement("label",null,"Senkronizasyon Aralığı (dakika)"),e.createElement("input",{type:"number",value:s.sync_interval,onChange:a=>t({...s,sync_interval:parseInt(a.target.value)}),min:5,max:1440})),e.createElement("div",{className:"modal-actions"},e.createElement("button",{className:"cancel-btn",onClick:m},"İptal"),e.createElement("button",{className:"save-btn",onClick:c},e.createElement(w,null)," Kaydet"))))};export{ce as default};
