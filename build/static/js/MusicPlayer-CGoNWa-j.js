var D=Object.defineProperty;var a=(n,o)=>D(n,"name",{value:o,configurable:!0});import{r,j as e}from"./react-core-Djgtqrmb.js";import{bZ as V,bU as G,ca as J,cs as K,aM as Y,aN as Z,ct as H,I as W,cu as X,an as ee,au as se,G as ae,a as q}from"./icons-vendor-BMXAt4pj.js";import{s as u,t as c}from"./index-D0nbcjO7.js";import"./media-vendor-CxFPycob.js";import"./router-vendor-gmJ9Mn-1.js";import"./state-vendor-CbW2fAN9.js";import"./crypto-vendor-D1XRGppi.js";import"./ui-vendor-IhB9Znpc.js";const me=a(({channelId:n})=>{const[o,y]=r.useState(!1),[i,h]=r.useState(null),[l,x]=r.useState([]),[j,v]=r.useState(70),[m,A]=r.useState(!1),[S,B]=r.useState(!1),[b,E]=r.useState(!1),[g,$]=r.useState(!1),[T,p]=r.useState(!1),[k,C]=r.useState(""),[P,w]=r.useState(0),[N,z]=r.useState(0),d=r.useRef(null);r.useEffect(()=>{R();const s=setInterval(()=>{o&&d.current&&(w(d.current.currentTime),z(d.current.duration))},1e3);return()=>clearInterval(s)},[o]);const R=a(async()=>{try{const s=await fetch(`${u}/music/${n}/status/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(s.ok){const t=await s.json();h(t.current_track),x(t.queue||[]),y(t.is_playing),v(t.volume||70)}}catch{}},"fetchPlayerStatus"),U=a(async()=>{try{(await fetch(`${u}/music/${n}/${o?"pause":"play"}/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}})).ok&&(y(!o),c.success(o?"⏸️ Durakladı":"▶️ Çalıyor"))}catch{c.error("❌ İşlem başarısız")}},"handlePlayPause"),I=a(async()=>{try{const s=await fetch(`${u}/music/${n}/skip/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(s.ok){const t=await s.json();h(t.current_track),c.success("⏭️ Sonraki şarkı")}}catch{c.error("❌ Atlama başarısız")}},"handleNext"),M=a(async()=>{try{const s=await fetch(`${u}/music/${n}/previous/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(s.ok){const t=await s.json();h(t.current_track),c.success("⏮️ Önceki şarkı")}}catch{c.error("❌ Geri alma başarısız")}},"handlePrevious"),O=a(async s=>{v(s);try{await fetch(`${u}/music/${n}/volume/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`,"Content-Type":"application/json"},body:JSON.stringify({volume:s})})}catch{}},"handleVolumeChange"),F=a(async()=>{if(!k.trim()){c.error("❌ URL girin");return}try{const s=await fetch(`${u}/music/${n}/add/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`,"Content-Type":"application/json"},body:JSON.stringify({url:k})});if(s.ok){const t=await s.json();x([...l,t.track]),C(""),p(!1),c.success("✅ Sıraya eklendi")}else c.error("❌ Eklenemedi")}catch{c.error("❌ Bağlantı hatası")}},"handleAddTrack"),L=a(async s=>{try{(await fetch(`${u}/music/${n}/remove/${s}/`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}})).ok&&(x(l.filter(f=>f.id!==s)),c.success("✅ Sıradan çıkarıldı"))}catch{c.error("❌ İşlem başarısız")}},"removeFromQueue"),_=a(s=>{if(!s||isNaN(s))return"0:00";const t=Math.floor(s/60),f=Math.floor(s%60);return`${t}:${f.toString().padStart(2,"0")}`},"formatTime"),Q=a(s=>{const t=s.target.value/100*N;w(t),d.current&&(d.current.currentTime=t)},"handleSeek");return e.jsxs("div",{className:"music-player",children:[e.jsx("audio",{ref:d,src:i?.audio_url}),e.jsxs("div",{className:"player-main",children:[e.jsx("div",{className:"track-info",children:i?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:i.thumbnail||"/default-music.png",alt:i.title,className:"track-thumbnail"}),e.jsxs("div",{className:"track-details",children:[e.jsx("div",{className:"track-title",children:i.title}),e.jsx("div",{className:"track-artist",children:i.artist||"Bilinmeyen Sanatçı"})]}),e.jsxs("div",{className:"track-source",children:[i.source==="youtube"&&e.jsx(V,{className:"source-icon youtube"}),i.source==="spotify"&&e.jsx(G,{className:"source-icon spotify"})]})]}):e.jsx("div",{className:"no-track",children:e.jsx("span",{children:"Şarkı seçilmedi"})})}),e.jsxs("div",{className:"player-controls",children:[e.jsxs("div",{className:"control-buttons",children:[e.jsx("button",{className:`control-btn ${S?"active":""}`,onClick:a(()=>B(!S),"onClick"),title:"Karıştır",children:e.jsx(J,{})}),e.jsx("button",{className:"control-btn",onClick:M,title:"Önceki",children:e.jsx(K,{})}),e.jsx("button",{className:"control-btn play-btn",onClick:U,children:o?e.jsx(Y,{}):e.jsx(Z,{})}),e.jsx("button",{className:"control-btn",onClick:I,title:"Sonraki",children:e.jsx(H,{})}),e.jsx("button",{className:`control-btn ${b?"active":""}`,onClick:a(()=>E(!b),"onClick"),title:"Tekrarla",children:e.jsx(W,{})})]}),e.jsxs("div",{className:"progress-container",children:[e.jsx("span",{className:"time-display",children:_(P)}),e.jsx("input",{type:"range",className:"progress-bar",min:"0",max:"100",value:P/N*100||0,onChange:Q}),e.jsx("span",{className:"time-display",children:_(N)})]})]}),e.jsxs("div",{className:"player-extras",children:[e.jsxs("button",{className:"extra-btn",onClick:a(()=>$(!g),"onClick"),title:"Sıra",children:[e.jsx(X,{}),l.length>0&&e.jsx("span",{className:"queue-count",children:l.length})]}),e.jsx("button",{className:"extra-btn",onClick:a(()=>p(!T),"onClick"),title:"Şarkı Ekle",children:e.jsx(ee,{})}),e.jsxs("div",{className:"volume-control",children:[e.jsx("button",{className:"extra-btn",onClick:a(()=>A(!m),"onClick"),children:m||j===0?e.jsx(se,{}):e.jsx(ae,{})}),e.jsx("input",{type:"range",className:"volume-slider",min:"0",max:"100",value:m?0:j,onChange:a(s=>O(parseInt(s.target.value)),"onChange")}),e.jsxs("span",{className:"volume-display",children:[m?0:j,"%"]})]})]})]}),g&&e.jsxs("div",{className:"queue-panel",children:[e.jsxs("div",{className:"queue-header",children:[e.jsxs("h3",{children:["Sıra (",l.length,")"]}),e.jsx("button",{className:"close-btn",onClick:a(()=>$(!1),"onClick"),children:e.jsx(q,{})})]}),e.jsx("div",{className:"queue-list",children:l.length===0?e.jsx("div",{className:"queue-empty",children:"Sıra boş"}):l.map((s,t)=>e.jsxs("div",{className:"queue-item",children:[e.jsx("span",{className:"queue-index",children:t+1}),e.jsx("img",{src:s.thumbnail,alt:s.title,className:"queue-thumbnail"}),e.jsxs("div",{className:"queue-track-info",children:[e.jsx("div",{className:"queue-track-title",children:s.title}),e.jsx("div",{className:"queue-track-artist",children:s.artist||"Bilinmeyen"})]}),e.jsx("button",{className:"remove-btn",onClick:a(()=>L(s.id),"onClick"),title:"Sıradan Çıkar",children:e.jsx(q,{})})]},s.id))})]}),T&&e.jsx("div",{className:"add-track-modal",children:e.jsxs("div",{className:"add-track-content",children:[e.jsx("h3",{children:"Şarkı Ekle"}),e.jsx("input",{type:"text",className:"track-url-input",placeholder:"YouTube veya Spotify URL'si girin...",value:k,onChange:a(s=>C(s.target.value),"onChange"),onKeyPress:a(s=>s.key==="Enter"&&F(),"onKeyPress")}),e.jsxs("div",{className:"modal-actions",children:[e.jsx("button",{className:"btn-cancel",onClick:a(()=>p(!1),"onClick"),children:"İptal"}),e.jsx("button",{className:"btn-add",onClick:F,children:"Ekle"})]})]})})]})},"MusicPlayer");export{me as default};
