import{r as l,n as e}from"./react-core-zXIKm1Jm.js";import{t as u}from"./index-Cp1Y5xwx.js";import{a4 as y,a as C,b3 as _,bn as b,aV as L,bo as I,aZ as B}from"./icons-vendor-DZdpmN99.js";import"./editor-vendor-DiU449Dh.js";import"./media-vendor-BSOZ7IB3.js";import"./router-vendor-PJALNo1v.js";import"./crypto-vendor-D_AcF0lD.js";import"./state-vendor-8NbFPBhQ.js";const V=({serverId:a,fetchWithAuth:r,apiBaseUrl:d,onClose:p})=>{const[o,c]=l.useState({enabled:!1,join_rate_limit:10,new_account_age:7,verification_level:"medium",auto_kick_suspicious:!0,lockdown_mode:!1}),[g,v]=l.useState([]),[x,R]=l.useState({blocked_joins:0,kicked_users:0,raid_attempts:0,last_raid:null}),[z,m]=l.useState(!0);l.useEffect(()=>{j(),f();const i=setInterval(f,3e4);return()=>clearInterval(i)},[a]);const j=async()=>{try{const i=await r(`${d}/moderation/raid-protection/${a}/`);if(i.ok){const s=await i.json();c(s)}}catch(i){console.error("Failed to load raid protection:",i)}m(!1)},f=async()=>{try{const i=await r(`${d}/moderation/raid-protection/check/`,{method:"POST",body:JSON.stringify({server_id:a})});if(i.ok){const s=await i.json();v(s.recent_activity||[]),s.raid_detected&&u.error(`‚ö†Ô∏è RAID DETECTED!
${s.message}

Automatic protection activated.`)}}catch(i){console.error("Failed to check raid activity:",i)}},k=async()=>{try{const i=await r(`${d}/moderation/raid-protection/enable/`,{method:"POST",body:JSON.stringify({server_id:a,enabled:!o.enabled})});if(i.ok){const s=await i.json();c({...o,enabled:!o.enabled})}}catch(i){console.error("Failed to toggle raid protection:",i)}},n=async(i,s)=>{const h={...o,[i]:s};c(h);try{await r(`${d}/moderation/raid-protection/update/`,{method:"POST",body:JSON.stringify({server_id:a,...h})})}catch(S){console.error("Failed to update setting:",S)}},w=async()=>{if(window.confirm(`‚ö†Ô∏è LOCKDOWN MODE

This will:
- Block all new joins
- Require manual approval for each user
- Kick suspicious accounts

Activate?`))try{await n("lockdown_mode",!0),u.success("üîí Lockdown Mode Activated!")}catch(i){console.error("Failed to activate lockdown:",i)}};return e.jsx("div",{style:t.overlay,onClick:p,children:e.jsxs("div",{style:t.panel,onClick:i=>i.stopPropagation(),children:[e.jsxs("div",{style:t.header,children:[e.jsxs("div",{style:t.headerLeft,children:[e.jsx(y,{style:{...t.headerIcon,color:o.enabled?"#43b581":"#72767d"}}),e.jsx("h2",{style:t.title,children:"Raid Protection"}),o.lockdown_mode&&e.jsx("span",{style:t.lockdownBadge,children:"üîí LOCKDOWN"})]}),e.jsx("button",{onClick:p,style:t.closeButton,children:e.jsx(C,{})})]}),e.jsxs("div",{style:t.statsGrid,children:[e.jsxs("div",{style:t.statCard,children:[e.jsx(_,{style:{...t.statIcon,color:"#ed4245"}}),e.jsx("div",{style:t.statValue,children:x.blocked_joins}),e.jsx("div",{style:t.statLabel,children:"Blocked Joins"})]}),e.jsxs("div",{style:t.statCard,children:[e.jsx(b,{style:{...t.statIcon,color:"#f0b132"}}),e.jsx("div",{style:t.statValue,children:x.kicked_users}),e.jsx("div",{style:t.statLabel,children:"Auto-Kicked"})]}),e.jsxs("div",{style:t.statCard,children:[e.jsx(L,{style:{...t.statIcon,color:"#f04747"}}),e.jsx("div",{style:t.statValue,children:x.raid_attempts}),e.jsx("div",{style:t.statLabel,children:"Raid Attempts"})]}),e.jsxs("div",{style:t.statCard,children:[e.jsx(I,{style:{...t.statIcon,color:"#5865f2"}}),e.jsx("div",{style:t.statValue,children:o.enabled?"ACTIVE":"OFF"}),e.jsx("div",{style:t.statLabel,children:"Status"})]})]}),e.jsxs("div",{style:t.section,children:[e.jsxs("div",{style:t.sectionHeader,children:[e.jsxs("h3",{style:t.sectionTitle,children:[e.jsx(B,{})," Protection Settings"]}),e.jsxs("label",{style:t.masterSwitch,children:[e.jsx("input",{type:"checkbox",checked:o.enabled,onChange:k}),e.jsx("span",{style:t.switchSlider}),e.jsx("span",{style:t.switchLabel,children:o.enabled?"Enabled":"Disabled"})]})]}),e.jsxs("div",{style:t.settings,children:[e.jsxs("div",{style:t.setting,children:[e.jsxs("div",{style:t.settingInfo,children:[e.jsx("div",{style:t.settingLabel,children:"Join Rate Limit"}),e.jsxs("div",{style:t.settingDesc,children:["Maximum users per minute: ",o.join_rate_limit]})]}),e.jsx("input",{type:"range",min:"5",max:"50",value:o.join_rate_limit,onChange:i=>n("join_rate_limit",parseInt(i.target.value)),style:t.slider,disabled:!o.enabled})]}),e.jsxs("div",{style:t.setting,children:[e.jsxs("div",{style:t.settingInfo,children:[e.jsx("div",{style:t.settingLabel,children:"New Account Age Limit"}),e.jsxs("div",{style:t.settingDesc,children:["Block accounts younger than ",o.new_account_age," days"]})]}),e.jsxs("select",{value:o.new_account_age,onChange:i=>n("new_account_age",parseInt(i.target.value)),style:t.select,disabled:!o.enabled,children:[e.jsx("option",{value:"1",children:"1 day"}),e.jsx("option",{value:"3",children:"3 days"}),e.jsx("option",{value:"7",children:"7 days"}),e.jsx("option",{value:"14",children:"14 days"}),e.jsx("option",{value:"30",children:"30 days"})]})]}),e.jsxs("div",{style:t.setting,children:[e.jsxs("div",{style:t.settingInfo,children:[e.jsx("div",{style:t.settingLabel,children:"Verification Level"}),e.jsxs("div",{style:t.settingDesc,children:[o.verification_level==="low"&&"Basic: Email verification",o.verification_level==="medium"&&"Medium: Email + Phone",o.verification_level==="high"&&"High: Email + Phone + Captcha"]})]}),e.jsxs("select",{value:o.verification_level,onChange:i=>n("verification_level",i.target.value),style:t.select,disabled:!o.enabled,children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"})]})]}),e.jsxs("div",{style:t.setting,children:[e.jsxs("div",{style:t.settingInfo,children:[e.jsx("div",{style:t.settingLabel,children:"Auto-Kick Suspicious Accounts"}),e.jsx("div",{style:t.settingDesc,children:"Automatically kick accounts flagged as suspicious"})]}),e.jsxs("label",{style:t.toggleSwitch,children:[e.jsx("input",{type:"checkbox",checked:o.auto_kick_suspicious,onChange:i=>n("auto_kick_suspicious",i.target.checked),disabled:!o.enabled}),e.jsx("span",{style:t.toggleSlider})]})]}),e.jsxs("div",{style:t.setting,children:[e.jsxs("div",{style:t.settingInfo,children:[e.jsx("div",{style:t.settingLabel,children:"üîí Lockdown Mode"}),e.jsx("div",{style:t.settingDesc,children:"Block ALL new joins (emergency mode)"})]}),o.lockdown_mode?e.jsx("button",{onClick:()=>n("lockdown_mode",!1),style:t.lockdownDeactivateBtn,children:"Deactivate"}):e.jsx("button",{onClick:w,style:t.lockdownBtn,disabled:!o.enabled,children:"Activate"})]})]})]}),e.jsxs("div",{style:t.section,children:[e.jsxs("h3",{style:t.sectionTitle,children:[e.jsx(b,{})," Recent Activity"]}),e.jsx("div",{style:t.activityList,children:g.length===0?e.jsx("div",{style:t.empty,children:"No suspicious activity detected"}):g.map((i,s)=>e.jsxs("div",{style:t.activityItem,children:[e.jsx("div",{style:t.activityIcon,children:i.type==="raid"?"‚ö†Ô∏è":i.type==="suspicious"?"üëÄ":"‚úÖ"}),e.jsxs("div",{style:t.activityContent,children:[e.jsx("div",{style:t.activityText,children:i.message}),e.jsx("div",{style:t.activityTime,children:new Date(i.timestamp).toLocaleString()})]}),i.action&&e.jsx("div",{style:t.activityAction,children:e.jsx("span",{style:t.actionBadge,children:i.action})})]},s))})]}),e.jsxs("div",{style:t.infoBox,children:[e.jsx(y,{style:t.infoIcon}),e.jsxs("div",{style:t.infoContent,children:[e.jsx("strong",{children:"How Raid Protection Works:"}),e.jsxs("ul",{style:t.infoList,children:[e.jsx("li",{children:"Monitors join rate (users per minute)"}),e.jsx("li",{children:"Checks account age and activity"}),e.jsx("li",{children:"Auto-kicks suspicious patterns"}),e.jsx("li",{children:"Activates lockdown during active raids"})]})]})]})]})})},t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,backdropFilter:"blur(5px)"},panel:{backgroundColor:"#2b2d31",borderRadius:"12px",width:"90%",maxWidth:"900px",maxHeight:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.5)",overflow:"hidden"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #1e1f22"},headerLeft:{display:"flex",alignItems:"center",gap:"12px"},headerIcon:{fontSize:"24px"},title:{margin:0,color:"#fff",fontSize:"24px",fontWeight:"600"},lockdownBadge:{backgroundColor:"#ed4245",color:"#fff",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"700",animation:"pulse 1.5s infinite"},closeButton:{background:"none",border:"none",color:"#b9bbbe",cursor:"pointer",fontSize:"24px",padding:"8px",borderRadius:"4px"},statsGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:"16px",padding:"20px",borderBottom:"1px solid #1e1f22"},statCard:{backgroundColor:"#1e1f22",borderRadius:"8px",padding:"16px",textAlign:"center"},statIcon:{fontSize:"32px",marginBottom:"8px"},statValue:{fontSize:"28px",fontWeight:"bold",color:"#fff",marginBottom:"4px"},statLabel:{fontSize:"13px",color:"#b9bbbe"},section:{padding:"20px",borderBottom:"1px solid #1e1f22",overflowY:"auto"},sectionHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},sectionTitle:{color:"#fff",fontSize:"18px",fontWeight:"600",margin:0,display:"flex",alignItems:"center",gap:"8px"},masterSwitch:{display:"flex",alignItems:"center",gap:"12px",cursor:"pointer"},switchSlider:{position:"relative",width:"48px",height:"24px",backgroundColor:"#72767d",borderRadius:"24px",transition:"0.3s"},switchLabel:{color:"#fff",fontSize:"14px",fontWeight:"600"},settings:{display:"flex",flexDirection:"column",gap:"20px"},setting:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px",backgroundColor:"#1e1f22",borderRadius:"8px"},settingInfo:{flex:1},settingLabel:{color:"#fff",fontSize:"15px",fontWeight:"600",marginBottom:"4px"},settingDesc:{color:"#b9bbbe",fontSize:"13px"},slider:{width:"200px",marginLeft:"20px"},select:{backgroundColor:"#2b2d31",border:"1px solid #1e1f22",borderRadius:"6px",padding:"8px 12px",color:"#fff",fontSize:"14px",marginLeft:"20px",minWidth:"150px"},toggleSwitch:{position:"relative",width:"48px",height:"24px",marginLeft:"20px"},toggleSlider:{position:"absolute",cursor:"pointer",top:0,left:0,right:0,bottom:0,backgroundColor:"#72767d",transition:"0.3s",borderRadius:"24px"},lockdownBtn:{backgroundColor:"#ed4245",color:"#fff",border:"none",borderRadius:"6px",padding:"8px 16px",cursor:"pointer",fontSize:"14px",fontWeight:"600",marginLeft:"20px"},lockdownDeactivateBtn:{backgroundColor:"#43b581",color:"#fff",border:"none",borderRadius:"6px",padding:"8px 16px",cursor:"pointer",fontSize:"14px",fontWeight:"600",marginLeft:"20px"},activityList:{display:"flex",flexDirection:"column",gap:"12px"},empty:{textAlign:"center",color:"#b9bbbe",padding:"40px",fontSize:"14px"},activityItem:{display:"flex",alignItems:"center",gap:"12px",padding:"12px",backgroundColor:"#1e1f22",borderRadius:"6px"},activityIcon:{fontSize:"24px"},activityContent:{flex:1},activityText:{color:"#fff",fontSize:"14px",marginBottom:"4px"},activityTime:{color:"#72767d",fontSize:"12px"},activityAction:{marginLeft:"auto"},actionBadge:{padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"600",backgroundColor:"#5865f2",color:"#fff"},infoBox:{display:"flex",gap:"16px",padding:"20px",backgroundColor:"rgba(88, 101, 242, 0.1)",borderTop:"1px solid #5865f2"},infoIcon:{fontSize:"24px",color:"#5865f2",marginTop:"4px"},infoContent:{color:"#fff",fontSize:"14px"},infoList:{margin:"8px 0 0 0",paddingLeft:"20px",color:"#b9bbbe"}};export{V as default};
