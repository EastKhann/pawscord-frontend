import{r as o,n as e}from"./react-core-BMiyQWF6.js";import{y as l}from"./ui-vendor-6RMGJYFH.js";import{g as $}from"./index-BvQlif5M.js";import"./editor-vendor-D9c4a6XZ.js";import"./media-vendor-BuSyE8vR.js";import"./router-vendor-B86Z1mIL.js";import"./icons-vendor-T72gfvdf.js";import"./state-vendor-CAyNnPM4.js";import"./crypto-vendor-1Q6e4ZD-.js";const D=({serverId:c,onClose:h})=>{const n=$(),[m,p]=o.useState([]),[v,g]=o.useState([]),[j,x]=o.useState(!0),[a,t]=o.useState({role_id:"",trigger_type:"on_join",delay:0,required_level:0,required_invites:0,required_messages:0,remove_after:0,enabled:!0}),u=[{value:"on_join",label:"Sunucuya KatÄ±lÄ±nca",icon:"ğŸ‘‹"},{value:"on_verify",label:"DoÄŸrulama SonrasÄ±",icon:"âœ…"},{value:"on_level",label:"Seviyeye UlaÅŸÄ±nca",icon:"â­"},{value:"on_invites",label:"Davet SayÄ±sÄ±",icon:"ğŸ‘¥"},{value:"on_messages",label:"Mesaj SayÄ±sÄ±",icon:"ğŸ’¬"},{value:"on_reaction",label:"Reaksiyon Verince",icon:"ğŸ˜€"},{value:"on_boost",label:"Sunucu Boost",icon:"ğŸš€"}];o.useEffect(()=>{d(),_()},[c]);const d=async()=>{try{const s=await fetch(`${n}/auto-roles/server/${c}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(s.ok){const r=await s.json();p(r)}}catch{}finally{x(!1)}},_=async()=>{try{const s=await fetch(`${n}/roles/server/${c}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(s.ok){const r=await s.json();g(r)}}catch{}},y=async()=>{if(!a.role_id){l.error("âŒ LÃ¼tfen rol seÃ§in");return}try{(await fetch(`${n}/auto-roles/create/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`,"Content-Type":"application/json"},body:JSON.stringify({server_id:c,...a})})).ok?(l.success("âœ… Otomatik rol oluÅŸturuldu"),d(),t({role_id:"",trigger_type:"on_join",delay:0,required_level:0,required_invites:0,required_messages:0,remove_after:0,enabled:!0})):l.error("âŒ Otomatik rol oluÅŸturulamadÄ±")}catch{l.error("âŒ BaÄŸlantÄ± hatasÄ±")}},f=async(s,r)=>{try{(await fetch(`${n}/auto-roles/${s}/toggle/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}})).ok?(l.success(r?"âœ… Otomatik rol devre dÄ±ÅŸÄ±":"âœ… Otomatik rol aktif"),d()):l.error("âŒ Durum gÃ¼ncellenemedi")}catch{l.error("âŒ BaÄŸlantÄ± hatasÄ±")}},k=async s=>{if(window.confirm("Otomatik rolÃ¼ silmek istediÄŸinize emin misiniz?"))try{(await fetch(`${n}/auto-roles/${s}/delete/`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}})).ok?(l.success("âœ… Otomatik rol silindi"),d()):l.error("âŒ Otomatik rol silinemedi")}catch{l.error("âŒ BaÄŸlantÄ± hatasÄ±")}},N=s=>{const r=v.find(i=>i.id===s);return r?r.name:"Bilinmeyen Rol"},b=s=>{const r=u.find(i=>i.value===s);return r?r.label:s},S=s=>{const r=u.find(i=>i.value===s);return r?r.icon:"âš™ï¸"},q=s=>{if(s===0)return"AnÄ±nda";const r=Math.floor(s/60),i=Math.floor(r/60);return i>0?`${i} saat`:`${r} dakika`};return e.jsx("div",{className:"autoroles-panel-overlay",onClick:h,children:e.jsxs("div",{className:"autoroles-panel",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"autoroles-header",children:[e.jsx("h2",{children:"âš¡ Otomatik Roller"}),e.jsx("button",{className:"close-btn",onClick:h,children:"Ã—"})]}),e.jsxs("div",{className:"autoroles-content",children:[e.jsxs("div",{className:"create-autorole-section",children:[e.jsx("h3",{children:"Yeni Otomatik Rol Ekle"}),e.jsxs("div",{className:"create-form",children:[e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Rol *"}),e.jsxs("select",{value:a.role_id,onChange:s=>t({...a,role_id:s.target.value}),children:[e.jsx("option",{value:"",children:"Rol SeÃ§in"}),v.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Tetikleyici"}),e.jsx("select",{value:a.trigger_type,onChange:s=>t({...a,trigger_type:s.target.value}),children:u.map(s=>e.jsxs("option",{value:s.value,children:[s.icon," ",s.label]},s.value))})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Gecikme (Saniye)"}),e.jsx("input",{type:"number",min:"0",placeholder:"0 = AnÄ±nda",value:a.delay,onChange:s=>t({...a,delay:parseInt(s.target.value)||0})})]}),a.trigger_type==="on_level"&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Gerekli Seviye"}),e.jsx("input",{type:"number",min:"1",value:a.required_level,onChange:s=>t({...a,required_level:parseInt(s.target.value)||0})})]}),a.trigger_type==="on_invites"&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Gerekli Davet"}),e.jsx("input",{type:"number",min:"1",value:a.required_invites,onChange:s=>t({...a,required_invites:parseInt(s.target.value)||0})})]}),a.trigger_type==="on_messages"&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Gerekli Mesaj"}),e.jsx("input",{type:"number",min:"1",value:a.required_messages,onChange:s=>t({...a,required_messages:parseInt(s.target.value)||0})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Otomatik KaldÄ±r (Saat)"}),e.jsx("input",{type:"number",min:"0",placeholder:"0 = HiÃ§bir zaman",value:a.remove_after,onChange:s=>t({...a,remove_after:parseInt(s.target.value)||0})})]})]}),e.jsx("button",{className:"create-btn",onClick:y,children:"âš¡ Otomatik Rol OluÅŸtur"})]})]}),e.jsxs("div",{className:"autoroles-list-section",children:[e.jsxs("h3",{children:["Aktif Otomatik Roller (",m.length,")"]}),j?e.jsxs("div",{className:"loading-state",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{children:"Otomatik roller yÃ¼kleniyor..."})]}):m.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("span",{className:"empty-icon",children:"âš¡"}),e.jsx("p",{children:"HenÃ¼z otomatik rol yok"}),e.jsx("span",{className:"empty-hint",children:"KullanÄ±cÄ±lara otomatik rol atamalarÄ± yapabilirsiniz"})]}):e.jsx("div",{className:"autoroles-list",children:m.map(s=>e.jsxs("div",{className:`autorole-card ${s.enabled?"":"disabled"}`,children:[e.jsxs("div",{className:"autorole-card-header",children:[e.jsxs("div",{className:"role-info",children:[e.jsx("span",{className:"trigger-icon",children:S(s.trigger_type)}),e.jsxs("div",{children:[e.jsx("h4",{children:N(s.role_id)}),e.jsx("span",{className:"trigger-label",children:b(s.trigger_type)})]})]}),e.jsxs("div",{className:"autorole-actions",children:[e.jsx("button",{className:`toggle-btn ${s.enabled?"active":""}`,onClick:()=>f(s.id,s.enabled),children:s.enabled?"âœ“":"â—‹"}),e.jsx("button",{className:"delete-btn",onClick:()=>k(s.id),children:"ğŸ—‘ï¸"})]})]}),e.jsxs("div",{className:"autorole-details",children:[s.delay>0&&e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-icon",children:"â±ï¸"}),e.jsxs("span",{children:["Gecikme: ",q(s.delay)]})]}),s.required_level>0&&e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-icon",children:"â­"}),e.jsxs("span",{children:["Seviye ",s.required_level," gerekli"]})]}),s.required_invites>0&&e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-icon",children:"ğŸ‘¥"}),e.jsxs("span",{children:[s.required_invites," davet gerekli"]})]}),s.required_messages>0&&e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-icon",children:"ğŸ’¬"}),e.jsxs("span",{children:[s.required_messages," mesaj gerekli"]})]}),s.remove_after>0&&e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-icon",children:"ğŸ”„"}),e.jsxs("span",{children:[s.remove_after," saat sonra kaldÄ±rÄ±lÄ±r"]})]}),s.uses_count>0&&e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-icon",children:"ğŸ“Š"}),e.jsxs("span",{children:[s.uses_count," kere kullanÄ±ldÄ±"]})]})]})]},s.id))})]})]})]})})};export{D as default};
