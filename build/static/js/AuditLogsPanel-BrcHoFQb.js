import{r as c,ch as E}from"./react-core-B6hadH-M.js";import{g as A}from"./index-D_6pZib5.js";const C=({serverId:r,onClose:_})=>{const[i,g]=c.useState([]),[a,o]=c.useState({action_type:"",user_id:"",target_user_id:"",channel_id:"",start_date:"",end_date:""}),[u,v]=c.useState(!0),[m,d]=c.useState(1),[f,k]=c.useState(!0),b=A();c.useEffect(()=>{r&&h()},[r,m]);const h=async()=>{v(!0);try{const e=localStorage.getItem("access_token"),l=new URLSearchParams({page:m,...Object.fromEntries(Object.entries(a).filter(([t,s])=>s!==""))}),n=await fetch(`${b}/audit-logs/server/${r}/?${l}`,{headers:{Authorization:`Bearer ${e}`}});if(n.ok){const t=await n.json();g(m===1?t.logs||[]:[...i,...t.logs||[]]),k(t.has_more||!1)}}catch(e){console.error("Error fetching audit logs:",e),E.error("âŒ Audit loglarÄ± yÃ¼klenemedi")}finally{v(!1)}},y=()=>{d(1),h()},N=()=>{o({action_type:"",user_id:"",target_user_id:"",channel_id:"",start_date:"",end_date:""}),d(1)},j=async()=>{try{const e=localStorage.getItem("access_token"),l=new URLSearchParams({...Object.fromEntries(Object.entries(a).filter(([t,s])=>s!==""))}),n=await fetch(`${b}/audit-logs/server/${r}/export/?${l}`,{headers:{Authorization:`Bearer ${e}`}});if(n.ok){const t=await n.blob(),s=window.URL.createObjectURL(t),R=document.createElement("a");R.href=s,R.download=`audit_logs_${r}.csv`,R.click(),E.success("âœ… Audit loglarÄ± dÄ±ÅŸa aktarÄ±ldÄ±")}}catch(e){console.error("Error exporting logs:",e),E.error("âŒ DÄ±ÅŸa aktarma baÅŸarÄ±sÄ±z")}},S=e=>({message_delete:"ğŸ—‘ï¸",message_edit:"âœï¸",member_join:"ğŸ‘‹",member_leave:"ğŸ‘‹",member_kick:"ğŸš«",member_ban:"ğŸ”¨",member_unban:"âœ…",role_create:"ğŸ­",role_delete:"ğŸ—‘ï¸",role_update:"ğŸ¨",role_assign:"â­",role_remove:"â–",channel_create:"â•",channel_delete:"âŒ",channel_update:"ğŸ”§",server_update:"âš™ï¸",invite_create:"ğŸ”—",webhook_create:"ğŸ¤–",webhook_delete:"ğŸ—‘ï¸",emoji_create:"ğŸ˜€",emoji_delete:"ğŸ˜¢",pin_add:"ğŸ“Œ",pin_remove:"ğŸ“Œ",reaction_add:"â¤ï¸",reaction_remove:"ğŸ’”"})[e]||"ğŸ“",p=e=>e.includes("delete")||e.includes("remove")||e.includes("kick")||e.includes("ban")?"#ef4444":e.includes("create")||e.includes("add")||e.includes("join")?"#10b981":e.includes("edit")||e.includes("update")?"#f59e0b":"#6366f1",w=e=>{const l=new Date(e),t=Math.floor((new Date-l)/1e3);return t<60?"Az Ã¶nce":t<3600?`${Math.floor(t/60)} dakika Ã¶nce`:t<86400?`${Math.floor(t/3600)} saat Ã¶nce`:t<604800?`${Math.floor(t/86400)} gÃ¼n Ã¶nce`:l.toLocaleDateString("tr-TR",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})};return React.createElement("div",{className:"audit-logs-overlay",onClick:_},React.createElement("div",{className:"audit-logs-panel",onClick:e=>e.stopPropagation()},React.createElement("div",{className:"audit-header"},React.createElement("h2",null,"ğŸ“‹ Audit Logs"),React.createElement("button",{className:"close-btn",onClick:_},"Ã—")),React.createElement("div",{className:"filters-section"},React.createElement("div",{className:"filter-grid"},React.createElement("div",{className:"filter-group"},React.createElement("label",null,"Aksiyon TÃ¼rÃ¼"),React.createElement("select",{value:a.action_type,onChange:e=>o({...a,action_type:e.target.value})},React.createElement("option",{value:""},"TÃ¼mÃ¼"),React.createElement("optgroup",{label:"Mesajlar"},React.createElement("option",{value:"message_delete"},"Mesaj Silme"),React.createElement("option",{value:"message_edit"},"Mesaj DÃ¼zenleme"),React.createElement("option",{value:"pin_add"},"Pin Ekleme"),React.createElement("option",{value:"pin_remove"},"Pin KaldÄ±rma")),React.createElement("optgroup",{label:"Ãœyeler"},React.createElement("option",{value:"member_join"},"Ãœye KatÄ±ldÄ±"),React.createElement("option",{value:"member_leave"},"Ãœye AyrÄ±ldÄ±"),React.createElement("option",{value:"member_kick"},"Ãœye AtÄ±ldÄ±"),React.createElement("option",{value:"member_ban"},"Ãœye BanlandÄ±"),React.createElement("option",{value:"member_unban"},"Ban KaldÄ±rÄ±ldÄ±")),React.createElement("optgroup",{label:"Roller"},React.createElement("option",{value:"role_create"},"Rol OluÅŸturma"),React.createElement("option",{value:"role_delete"},"Rol Silme"),React.createElement("option",{value:"role_update"},"Rol GÃ¼ncelleme"),React.createElement("option",{value:"role_assign"},"Rol Atama"),React.createElement("option",{value:"role_remove"},"Rol KaldÄ±rma")),React.createElement("optgroup",{label:"Kanallar"},React.createElement("option",{value:"channel_create"},"Kanal OluÅŸturma"),React.createElement("option",{value:"channel_delete"},"Kanal Silme"),React.createElement("option",{value:"channel_update"},"Kanal GÃ¼ncelleme")),React.createElement("optgroup",{label:"DiÄŸer"},React.createElement("option",{value:"server_update"},"Sunucu GÃ¼ncelleme"),React.createElement("option",{value:"invite_create"},"Davet OluÅŸturma"),React.createElement("option",{value:"webhook_create"},"Webhook OluÅŸturma"),React.createElement("option",{value:"webhook_delete"},"Webhook Silme"),React.createElement("option",{value:"emoji_create"},"Emoji Ekleme"),React.createElement("option",{value:"emoji_delete"},"Emoji Silme")))),React.createElement("div",{className:"filter-group"},React.createElement("label",null,"BaÅŸlangÄ±Ã§ Tarihi"),React.createElement("input",{type:"datetime-local",value:a.start_date,onChange:e=>o({...a,start_date:e.target.value})})),React.createElement("div",{className:"filter-group"},React.createElement("label",null,"BitiÅŸ Tarihi"),React.createElement("input",{type:"datetime-local",value:a.end_date,onChange:e=>o({...a,end_date:e.target.value})})),React.createElement("div",{className:"filter-group"},React.createElement("label",null,"KullanÄ±cÄ± ID"),React.createElement("input",{type:"text",placeholder:"Aksiyon yapan kullanÄ±cÄ±",value:a.user_id,onChange:e=>o({...a,user_id:e.target.value})}))),React.createElement("div",{className:"filter-actions"},React.createElement("button",{className:"filter-btn apply-btn",onClick:y},"ğŸ” Filtrele"),React.createElement("button",{className:"filter-btn clear-btn",onClick:N},"ğŸ—‘ï¸ Temizle"),React.createElement("button",{className:"filter-btn export-btn",onClick:j},"ğŸ“¥ DÄ±ÅŸa Aktar"))),React.createElement("div",{className:"logs-content"},u&&i.length===0?React.createElement("div",{className:"loading-state"},React.createElement("div",{className:"spinner"}),React.createElement("p",null,"Loglar yÃ¼kleniyor...")):i.length===0?React.createElement("div",{className:"empty-state"},React.createElement("span",{className:"empty-icon"},"ğŸ“‹"),React.createElement("p",null,"HenÃ¼z audit log yok"),React.createElement("span",null,"Sunucudaki aksiyonlar burada gÃ¶rÃ¼necek")):React.createElement(React.Fragment,null,React.createElement("div",{className:"logs-list"},i.map(e=>React.createElement("div",{key:e.id,className:"log-entry",style:{borderLeftColor:p(e.action_type)}},React.createElement("div",{className:"log-icon",style:{background:`${p(e.action_type)}20`}},S(e.action_type)),React.createElement("div",{className:"log-details"},React.createElement("div",{className:"log-header-row"},React.createElement("span",{className:"log-action",style:{color:p(e.action_type)}},e.action_display||e.action_type),React.createElement("span",{className:"log-time"},w(e.created_at))),React.createElement("div",{className:"log-description"},e.description||"AÃ§Ä±klama yok"),e.metadata&&Object.keys(e.metadata).length>0&&React.createElement("div",{className:"log-metadata"},Object.entries(e.metadata).map(([l,n])=>React.createElement("div",{key:l,className:"metadata-item"},React.createElement("span",{className:"metadata-key"},l,":"),React.createElement("span",{className:"metadata-value"},JSON.stringify(n))))),React.createElement("div",{className:"log-footer"},e.user&&React.createElement("span",{className:"log-user"},"ğŸ‘¤ ",e.user.username||`User#${e.user.id}`),e.channel&&React.createElement("span",{className:"log-channel"},"ğŸ“¢ #",e.channel.name),e.target_user&&React.createElement("span",{className:"log-target"},"ğŸ¯ ",e.target_user.username)))))),f&&React.createElement("button",{className:"load-more-btn",onClick:()=>d(m+1),disabled:u},u?"â³ YÃ¼kleniyor...":"ğŸ“„ Daha Fazla YÃ¼kle")))))};export{C as default};
