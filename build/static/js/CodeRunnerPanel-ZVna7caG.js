import{r as a,H as s,dl as V,bp as Y,l as H,b$ as z,bD as f,v as x,aL as q,Y as K,bo as Q,bT as U,a2 as X,cn as Z,V as ee,o as te,dF as ae,ch as c}from"./react-core-B6hadH-M.js";const le=({serverId:R,channelId:i,onClose:d})=>{const[n,m]=a.useState(""),[l,u]=a.useState("python"),[p,r]=a.useState(""),[P,h]=a.useState(!1),[g,S]=a.useState(null),[k,A]=a.useState([]),[C,y]=a.useState(!1),[w,O]=a.useState([]),[B,N]=a.useState(!1),[b,D]=a.useState(!1),o=localStorage.getItem("access_token"),F=[{id:"python",name:"Python",icon:React.createElement(ae,null),template:`# Python Code
print("Hello, World!")`},{id:"cpp",name:"C++",icon:React.createElement(s,null),template:`#include <iostream>
using namespace std;

int main() {
    cout << "Hello, World!" << endl;
    return 0;
}`},{id:"c",name:"C",icon:React.createElement(s,null),template:`#include <stdio.h>

int main() {
    printf("Hello, World!\\n");
    return 0;
}`},{id:"ruby",name:"Ruby",icon:React.createElement(s,null),template:`# Ruby Code
puts "Hello, World!"`},{id:"go",name:"Go",icon:React.createElement(s,null),template:`package main

import "fmt"

func main() {
    fmt.Println("Hello, World!")
}`},{id:"rust",name:"Rust",icon:React.createElement(s,null),template:`fn main() {
    println!("Hello, World!");
}`}];a.useEffect(()=>{T(),v()},[]),a.useEffect(()=>{const e=F.find(t=>t.id===l);e&&!n&&m(e.template)},[l]);const T=async()=>{try{const e=await fetch("/api/code-runner/history/",{headers:{Authorization:`Bearer ${o}`}});if(e.ok){const t=await e.json();A(t.history||[])}}catch(e){console.error("Error fetching history:",e)}},v=async()=>{try{const e=await fetch("/api/code-runner/snippets/",{headers:{Authorization:`Bearer ${o}`}});if(e.ok){const t=await e.json();O(t.snippets||[])}}catch(e){console.error("Error fetching snippets:",e)}},j=async()=>{if(!n.trim()){c.warning("Kod boş olamaz");return}h(!0),r("Çalıştırılıyor...");const e=Date.now();try{const t=await fetch("/api/code-runner/execute/",{method:"POST",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"},body:JSON.stringify({code:n,language:l,channel_id:i})}),E=await t.json(),I=Date.now();S(I-e),t.ok?(r(E.output||"Çıktı yok"),E.error&&r(`Hata:
${E.error}`)):r(`Hata: ${E.message||"Kod çalıştırılamadı"}`),T()}catch{r("Bağlantı hatası")}h(!1)},W=async()=>{try{await fetch("/api/code-runner/stop/",{method:"POST",headers:{Authorization:`Bearer ${o}`}}),h(!1),r("Çalıştırma durduruldu")}catch{c.error("Durdurma başarısız")}},G=async e=>{try{(await fetch("/api/code-runner/snippets/",{method:"POST",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"},body:JSON.stringify({name:e,code:n,language:l})})).ok&&(c.success("Snippet kaydedildi"),v(),N(!1))}catch{c.error("Kaydetme başarısız")}},$=e=>{m(e.code),u(e.language),y(!1)},L=async e=>{try{await fetch(`/api/code-runner/snippets/${e}/`,{method:"DELETE",headers:{Authorization:`Bearer ${o}`}}),c.success("Snippet silindi"),v()}catch{c.error("Silme başarısız")}},J=()=>{navigator.clipboard.writeText(p),c.success("Çıktı kopyalandı")},M=()=>{m(""),r(""),S(null)},_=async()=>{if(!i){c.warning("Paylaşım için kanal gerekli");return}try{(await fetch(`/api/channels/${i}/messages/`,{method:"POST",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"},body:JSON.stringify({content:`\`\`\`${l}
${n}
\`\`\`
**Çıktı:**
\`\`\`
${p}
\`\`\``})})).ok&&c.success("Kanala paylaşıldı")}catch{c.error("Paylaşım başarısız")}};return React.createElement("div",{className:`code-runner-overlay ${b?"fullscreen":""}`,onClick:e=>e.target.className.includes("code-runner-overlay")&&d()},React.createElement("div",{className:"code-runner-panel"},React.createElement("div",{className:"panel-header"},React.createElement("h2",null,React.createElement(s,null)," Kod Çalıştırıcı"),React.createElement("div",{className:"header-actions"},React.createElement("button",{className:"fullscreen-btn",onClick:()=>D(!b)},b?React.createElement(V,null):React.createElement(Y,null)),React.createElement("button",{className:"close-btn",onClick:d},React.createElement(H,null)))),React.createElement("div",{className:"toolbar"},React.createElement("div",{className:"language-selector"},F.map(e=>React.createElement("button",{key:e.id,className:`lang-btn ${l===e.id?"active":""}`,onClick:()=>u(e.id),title:e.name},e.icon,React.createElement("span",null,e.name)))),React.createElement("div",{className:"toolbar-actions"},React.createElement("button",{className:"action-btn",onClick:()=>y(!C)},React.createElement(z,null)," Geçmiş"),React.createElement("button",{className:"action-btn",onClick:()=>N(!0)},React.createElement(f,null)," Kaydet"),React.createElement("button",{className:"action-btn clear",onClick:M},React.createElement(x,null)," Temizle"))),React.createElement("div",{className:"editor-container"},React.createElement("div",{className:"code-section"},React.createElement("div",{className:"section-header"},React.createElement("span",null,React.createElement(s,null)," Kod"),React.createElement("span",{className:"line-count"},n.split(`
`).length," satır")),React.createElement("textarea",{className:"code-editor",value:n,onChange:e=>m(e.target.value),placeholder:"Kodunuzu buraya yazın...",spellCheck:"false"})),React.createElement("div",{className:"output-section"},React.createElement("div",{className:"section-header"},React.createElement("span",null,React.createElement(q,null)," Çıktı"),React.createElement("div",{className:"output-actions"},g&&React.createElement("span",{className:"exec-time"},React.createElement(K,null)," ",g,"ms"),React.createElement("button",{onClick:J,title:"Kopyala"},React.createElement(Q,null)))),React.createElement("pre",{className:`output-display ${p.includes("Hata")?"error":""}`},p||"Çıktı burada görünecek..."))),React.createElement("div",{className:"run-bar"},P?React.createElement("button",{className:"stop-btn",onClick:W},React.createElement(X,null)," Durdur"):React.createElement("button",{className:"run-btn",onClick:j},React.createElement(U,null)," Çalıştır"),i&&React.createElement("button",{className:"share-btn",onClick:_},React.createElement(s,null)," Kanala Paylaş")),C&&React.createElement("div",{className:"history-sidebar"},React.createElement("div",{className:"sidebar-header"},React.createElement("h3",null,React.createElement(z,null)," Geçmiş & Snippets"),React.createElement("button",{onClick:()=>y(!1)},React.createElement(H,null))),React.createElement("div",{className:"sidebar-section"},React.createElement("h4",null,React.createElement(Z,null)," Kaydedilen Snippets"),w.length===0?React.createElement("p",{className:"empty-msg"},"Henüz snippet yok"):React.createElement("div",{className:"snippets-list"},w.map(e=>React.createElement("div",{key:e.id,className:"snippet-item"},React.createElement("div",{className:"snippet-info",onClick:()=>$(e)},React.createElement("span",{className:"snippet-name"},e.name),React.createElement("span",{className:"snippet-lang"},e.language)),React.createElement("button",{className:"delete-snippet",onClick:()=>L(e.id)},React.createElement(x,null)))))),React.createElement("div",{className:"sidebar-section"},React.createElement("h4",null,React.createElement(K,null)," Son Çalıştırmalar"),k.length===0?React.createElement("p",{className:"empty-msg"},"Geçmiş yok"):React.createElement("div",{className:"history-list"},k.slice(0,10).map((e,t)=>React.createElement("div",{key:t,className:"history-item",onClick:()=>$(e)},React.createElement("div",{className:"history-info"},React.createElement("span",{className:"history-lang"},e.language),React.createElement("span",{className:`history-status ${e.success?"success":"error"}`},e.success?React.createElement(ee,null):React.createElement(te,null))),React.createElement("code",{className:"history-preview"},e.code?.substring(0,50),"..."),React.createElement("span",{className:"history-time"},e.exec_time,"ms")))))),B&&React.createElement(ne,{onClose:()=>N(!1),onSave:G,language:l})))},ne=({onClose:R,onSave:i,language:d})=>{const[n,m]=a.useState(""),l=()=>{if(!n.trim()){c.warning("Snippet adı gerekli");return}i(n)};return React.createElement("div",{className:"modal-overlay",onClick:u=>u.target.className==="modal-overlay"&&R()},React.createElement("div",{className:"save-modal"},React.createElement("h3",null,React.createElement(f,null)," Snippet Kaydet"),React.createElement("div",{className:"form-group"},React.createElement("label",null,"Snippet Adı"),React.createElement("input",{type:"text",value:n,onChange:u=>m(u.target.value),placeholder:"örn: Fibonacci Hesaplama"})),React.createElement("div",{className:"form-group"},React.createElement("label",null,"Dil"),React.createElement("input",{type:"text",value:d,disabled:!0})),React.createElement("div",{className:"modal-actions"},React.createElement("button",{className:"cancel-btn",onClick:R},"İptal"),React.createElement("button",{className:"save-submit-btn",onClick:l},React.createElement(f,null)," Kaydet"))))};export{le as default};
