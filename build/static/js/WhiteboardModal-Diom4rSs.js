var B=Object.defineProperty;var s=(u,h)=>B(u,"name",{value:h,configurable:!0});import{r as l,j as r}from"./react-core-Djgtqrmb.js";import{a as M,aO as D,aP as E,f as O}from"./icons-vendor-BW7dxHkX.js";import{c as z}from"./index-GGLPABCW.js";import"./media-vendor-CxFPycob.js";import"./router-vendor-ClgLnMjk.js";import"./state-vendor-BRqaXHJQ.js";import"./crypto-vendor-D1XRGppi.js";import"./ui-vendor-IhB9Znpc.js";const G=s(({roomSlug:u,onClose:h,wsProtocol:g,apiHost:y})=>{const{overlayProps:w,dialogProps:j}=z({onClose:h,label:"Ã‡izim TahtasÄ±"}),t=l.useRef(null),d=l.useRef(null),[C,b]=l.useState(!1),[p,f]=l.useState("#000000"),[x,k]=l.useState(3);l.useEffect(()=>{const e=`${g}://${y}/ws/whiteboard/${u}/`;return d.current=new WebSocket(e),d.current.onmessage=n=>{const{x:c,y:a,type:v,color:T,width:W,prevX:X,prevY:Y}=JSON.parse(n.data),i=t.current.getContext("2d");v==="draw"?(i.beginPath(),i.moveTo(X,Y),i.lineTo(c,a),i.strokeStyle=T,i.lineWidth=W,i.lineCap="round",i.stroke()):v==="clear"&&i.clearRect(0,0,t.current.width,t.current.height)},()=>d.current.close()},[u,g,y]),l.useEffect(()=>{const e=t.current;e.width=800,e.height=600;const n=e.getContext("2d");n.fillStyle="white",n.fillRect(0,0,e.width,e.height)},[]);const S=s(({nativeEvent:e})=>{const{offsetX:n,offsetY:c}=e;b(!0),t.current.lastX=n,t.current.lastY=c},"startDrawing"),R=s(({nativeEvent:e})=>{if(!C)return;const{offsetX:n,offsetY:c}=e,a=t.current.getContext("2d");a.beginPath(),a.moveTo(t.current.lastX,t.current.lastY),a.lineTo(n,c),a.strokeStyle=p,a.lineWidth=x,a.lineCap="round",a.stroke(),d.current.readyState===WebSocket.OPEN&&d.current.send(JSON.stringify({type:"draw",x:n,y:c,prevX:t.current.lastX,prevY:t.current.lastY,color:p,width:x})),t.current.lastX=n,t.current.lastY=c},"draw"),m=s(()=>{b(!1)},"stopDrawing"),P=s(()=>{const e=t.current.getContext("2d");e.fillStyle="white",e.fillRect(0,0,t.current.width,t.current.height),d.current.send(JSON.stringify({type:"clear"}))},"clearBoard");return r.jsx("div",{style:o.overlay,...w,children:r.jsxs("div",{style:o.modal,...j,children:[r.jsxs("div",{style:o.header,children:[r.jsx("h3",{children:"ðŸŽ¨ Ortak Ã‡izim TahtasÄ±"}),r.jsx("button",{onClick:h,style:o.closeBtn,children:r.jsx(M,{})})]}),r.jsxs("div",{style:o.toolbar,children:[r.jsx("input",{type:"color",value:p,onChange:s(e=>f(e.target.value),"onChange"),style:o.colorPicker}),r.jsx("input",{type:"range",min:"1",max:"20",value:x,onChange:s(e=>k(e.target.value),"onChange")}),r.jsx("button",{onClick:s(()=>f("#ffffff"),"onClick"),style:o.toolBtn,children:r.jsx(D,{})}),r.jsx("button",{onClick:s(()=>f("#000000"),"onClick"),style:o.toolBtn,children:r.jsx(E,{})}),r.jsx("button",{onClick:P,style:{...o.toolBtn,color:"red"},children:r.jsx(O,{})})]}),r.jsx("div",{style:o.canvasContainer,children:r.jsx("canvas",{ref:t,onMouseDown:S,onMouseMove:R,onMouseUp:m,onMouseLeave:m,style:o.canvas})})]})})},"WhiteboardModal"),o={overlay:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0.85)",zIndex:3e3,display:"flex",justifyContent:"center",alignItems:"center"},modal:{backgroundColor:"#2b2d31",borderRadius:"12px",padding:"10px",display:"flex",flexDirection:"column",gap:"10px"},header:{display:"flex",justifyContent:"space-between",color:"white",padding:"0 10px"},closeBtn:{background:"none",border:"none",color:"white",fontSize:"1.5em",cursor:"pointer"},toolbar:{display:"flex",gap:"10px",alignItems:"center",backgroundColor:"#1e1f22",padding:"10px",borderRadius:"8px"},canvasContainer:{border:"1px solid #1e1f22",borderRadius:"4px",overflow:"hidden",backgroundColor:"white"},canvas:{cursor:"crosshair",touchAction:"none"},toolBtn:{background:"none",border:"none",color:"#ccc",fontSize:"1.2em",cursor:"pointer"},colorPicker:{border:"none",width:"30px",height:"30px",cursor:"pointer",padding:0}};export{G as default};
