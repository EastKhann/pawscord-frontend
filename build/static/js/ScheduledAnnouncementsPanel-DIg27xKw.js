import{r as o,j as e}from"./react-vendor-D8Fi5F9E.js";import{a7 as R,Z as $,a as M,x as E,bl as q,m as P}from"./icons-vendor-CfNiWYc_.js";import{t as l}from"./index-BxkyDgli.js";import"./media-vendor-Dp18sh1g.js";import"./router-vendor-CTPwQFnc.js";import"./crypto-vendor-Cz32ecGD.js";import"./state-vendor-De5qIGw3.js";const Q=({fetchWithAuth:i,apiBaseUrl:d,onClose:g,serverId:y})=>{const[b,I]=o.useState([]),[D,L]=o.useState(!0),[j,c]=o.useState(!1),[p,v]=o.useState(""),[u,S]=o.useState(""),[x,C]=o.useState(""),[h,k]=o.useState(""),[w,z]=o.useState(""),[a,T]=o.useState(!1),[A,F]=o.useState("daily");o.useEffect(()=>{f()},[]);const f=async()=>{try{const s=await(await i(`${d}/servers/${y}/announcements/scheduled/`)).json();I(s.announcements||[])}catch(t){console.error("Failed to load scheduled announcements:",t),l.error("Failed to load announcements")}finally{L(!1)}},G=async t=>{if(t.preventDefault(),!p||!u||!x||!h){l.error("Please fill in all required fields");return}const s=`${x}T${h}:00`;try{const r=await(await i(`${d}/servers/${y}/announcements/schedule/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:p,message:u,scheduled_at:s,channel_id:w||null,recurring:a,recurring_type:a?A:null})})).json();r.success?(l.success("Announcement scheduled successfully!"),f(),B(),c(!1)):l.error(r.error||"Failed to schedule announcement")}catch(m){console.error("Schedule error:",m),l.error("Failed to schedule announcement")}},W=async t=>{if(window.confirm("Delete this scheduled announcement?"))try{await i(`${d}/announcements/${t}/delete/`,{method:"DELETE"}),l.success("Announcement deleted"),f()}catch(s){console.error("Delete error:",s),l.error("Failed to delete announcement")}},B=()=>{v(""),S(""),C(""),k(""),z(""),T(!1),F("daily")},_=t=>{const s=new Date,r=(new Date(t)-s)/(1e3*60*60);return r<0?"#f04747":r<24?"#faa61a":"#43b581"};return e.jsx("div",{style:n.overlay,onClick:g,children:e.jsxs("div",{style:n.modal,onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{style:n.header,children:[e.jsxs("div",{style:n.headerLeft,children:[e.jsx(R,{style:{fontSize:"24px",color:"#5865f2"}}),e.jsx("h2",{style:{margin:0,fontSize:"20px"},children:"Scheduled Announcements"})]}),e.jsxs("div",{style:n.headerRight,children:[!j&&e.jsxs("button",{onClick:()=>c(!0),style:n.addBtn,children:[e.jsx($,{})," Schedule New"]}),e.jsx("button",{onClick:g,style:n.closeBtn,children:e.jsx(M,{})})]})]}),e.jsx("div",{style:n.content,children:j?e.jsxs("div",{style:n.createForm,children:[e.jsx("h3",{style:n.formTitle,children:"Schedule New Announcement"}),e.jsxs("form",{onSubmit:G,children:[e.jsxs("div",{style:n.formGroup,children:[e.jsx("label",{style:n.label,children:"Title *"}),e.jsx("input",{type:"text",value:p,onChange:t=>v(t.target.value),placeholder:"Announcement title...",style:n.input,required:!0})]}),e.jsxs("div",{style:n.formGroup,children:[e.jsx("label",{style:n.label,children:"Message *"}),e.jsx("textarea",{value:u,onChange:t=>S(t.target.value),placeholder:"Announcement message...",style:{...n.input,minHeight:"120px"},required:!0})]}),e.jsxs("div",{style:n.formRow,children:[e.jsxs("div",{style:n.formGroup,children:[e.jsx("label",{style:n.label,children:"Date *"}),e.jsx("input",{type:"date",value:x,onChange:t=>C(t.target.value),style:n.input,required:!0})]}),e.jsxs("div",{style:n.formGroup,children:[e.jsx("label",{style:n.label,children:"Time *"}),e.jsx("input",{type:"time",value:h,onChange:t=>k(t.target.value),style:n.input,required:!0})]})]}),e.jsxs("div",{style:n.formGroup,children:[e.jsx("label",{style:n.label,children:"Channel ID (Optional)"}),e.jsx("input",{type:"text",value:w,onChange:t=>z(t.target.value),placeholder:"Leave empty for all channels",style:n.input})]}),e.jsx("div",{style:n.checkboxGroup,children:e.jsxs("label",{style:n.checkboxLabel,children:[e.jsx("input",{type:"checkbox",checked:a,onChange:t=>T(t.target.checked),style:n.checkbox}),e.jsx("span",{children:"Recurring Announcement"})]})}),a&&e.jsxs("div",{style:n.formGroup,children:[e.jsx("label",{style:n.label,children:"Repeat"}),e.jsxs("select",{value:A,onChange:t=>F(t.target.value),style:n.select,children:[e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"monthly",children:"Monthly"})]})]}),e.jsxs("div",{style:n.formActions,children:[e.jsxs("button",{type:"submit",style:n.submitBtn,children:[e.jsx(E,{})," Schedule Announcement"]}),e.jsx("button",{type:"button",onClick:()=>{c(!1),B()},style:n.cancelBtn,children:"Cancel"})]})]})]}):D?e.jsx("div",{style:n.loading,children:"Loading..."}):b.length===0?e.jsxs("div",{style:n.empty,children:[e.jsx(R,{style:{fontSize:"48px",color:"#99aab5",marginBottom:"16px"}}),e.jsx("p",{children:"No scheduled announcements"}),e.jsx("p",{style:{fontSize:"14px",color:"#99aab5"},children:"Schedule your first announcement to get started"})]}):e.jsx("div",{style:n.announcementsList,children:b.map(t=>e.jsxs("div",{style:n.announcementCard,children:[e.jsx("div",{style:{...n.statusIndicator,backgroundColor:_(t.scheduled_at)}}),e.jsxs("div",{style:n.announcementContent,children:[e.jsx("h3",{style:n.announcementTitle,children:t.title}),e.jsx("p",{style:n.announcementMessage,children:t.message}),e.jsxs("div",{style:n.announcementMeta,children:[e.jsxs("span",{children:[e.jsx(q,{})," ",new Date(t.scheduled_at).toLocaleString()]}),t.recurring&&e.jsxs(e.Fragment,{children:[e.jsx("span",{style:{margin:"0 8px"},children:"â€¢"}),e.jsxs("span",{children:["ðŸ” ",t.recurring_type]})]}),t.channel_id&&e.jsxs(e.Fragment,{children:[e.jsx("span",{style:{margin:"0 8px"},children:"â€¢"}),e.jsxs("span",{children:["ðŸ“º Channel: ",t.channel_id]})]})]})]}),e.jsx("div",{style:n.announcementActions,children:e.jsx("button",{onClick:()=>W(t.id),style:n.deleteIconBtn,title:"Delete",children:e.jsx(P,{})})})]},t.id))})})]})})},n={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999},modal:{backgroundColor:"#1e1e1e",borderRadius:"8px",width:"90%",maxWidth:"900px",maxHeight:"85vh",display:"flex",flexDirection:"column",color:"#fff"},header:{padding:"20px",borderBottom:"1px solid #444",display:"flex",justifyContent:"space-between",alignItems:"center"},headerLeft:{display:"flex",alignItems:"center",gap:"12px"},headerRight:{display:"flex",alignItems:"center",gap:"12px"},addBtn:{padding:"8px 16px",backgroundColor:"#43b581",border:"none",borderRadius:"6px",color:"#fff",fontSize:"14px",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px"},closeBtn:{background:"none",border:"none",color:"#fff",fontSize:"24px",cursor:"pointer",padding:"8px"},content:{padding:"20px",overflowY:"auto",flex:1},loading:{textAlign:"center",padding:"40px",color:"#99aab5"},empty:{textAlign:"center",padding:"60px 20px",color:"#dcddde"},createForm:{maxWidth:"600px",margin:"0 auto"},formTitle:{fontSize:"18px",fontWeight:"600",marginBottom:"24px"},formGroup:{marginBottom:"20px"},formRow:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},label:{display:"block",fontSize:"14px",fontWeight:"600",marginBottom:"8px",color:"#dcddde"},input:{width:"100%",padding:"10px",backgroundColor:"#2c2f33",border:"1px solid #444",borderRadius:"6px",color:"#fff",fontSize:"14px",boxSizing:"border-box"},select:{width:"100%",padding:"10px",backgroundColor:"#2c2f33",border:"1px solid #444",borderRadius:"6px",color:"#fff",fontSize:"14px"},checkboxGroup:{marginBottom:"20px"},checkboxLabel:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",fontSize:"14px"},checkbox:{width:"18px",height:"18px",cursor:"pointer"},formActions:{display:"flex",gap:"12px",marginTop:"24px"},submitBtn:{flex:1,padding:"12px",backgroundColor:"#5865f2",border:"none",borderRadius:"6px",color:"#fff",fontSize:"16px",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},cancelBtn:{padding:"12px 24px",backgroundColor:"#4e5058",border:"none",borderRadius:"6px",color:"#fff",fontSize:"16px",fontWeight:"600",cursor:"pointer"},announcementsList:{display:"flex",flexDirection:"column",gap:"12px"},announcementCard:{backgroundColor:"#2c2f33",borderRadius:"8px",padding:"20px",display:"flex",gap:"16px",position:"relative",overflow:"hidden"},statusIndicator:{position:"absolute",left:0,top:0,bottom:0,width:"4px"},announcementContent:{flex:1,paddingLeft:"12px"},announcementTitle:{fontSize:"18px",fontWeight:"600",marginBottom:"8px"},announcementMessage:{fontSize:"14px",color:"#dcddde",marginBottom:"12px",lineHeight:"1.6"},announcementMeta:{fontSize:"12px",color:"#99aab5",display:"flex",alignItems:"center",flexWrap:"wrap"},announcementActions:{display:"flex",alignItems:"flex-start",gap:"8px"},deleteIconBtn:{padding:"8px",backgroundColor:"#f04747",border:"none",borderRadius:"6px",color:"#fff",cursor:"pointer",fontSize:"14px"}};export{Q as default};
