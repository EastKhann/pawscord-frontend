import{r as s,d as a,aD as p,ds as G,dt as L,o as P,cl as j}from"./react-core-DrOm_csO.js";function T({apiBaseUrl:r,fetchWithAuth:o,onSelectGIF:g}){const[v,N]=s.useState([]),[w,F]=s.useState([]),[n,f]=s.useState("all"),[c,S]=s.useState(""),[l,E]=s.useState("grid"),[i,u]=s.useState(new Set),[h,y]=s.useState(!1);s.useEffect(()=>{k(),b(),C()},[n,c]);const k=async()=>{y(!0);try{const e=new URLSearchParams;n!=="all"&&e.append("category",n),c&&e.append("search",c);const t=await o(`${r}/gifs/list_local/?${e}`);if(t.ok){const m=await t.json();N(m.gifs||[])}}catch(e){console.error("Error loading GIFs:",e)}finally{y(!1)}},b=async()=>{try{const e=await o(`${r}/gifs/categories/`);if(e.ok){const t=await e.json();F(t.categories||[])}}catch(e){console.error("Error loading categories:",e)}},C=async()=>{try{const e=await o(`${r}/gifs/favorites/`);if(e.ok){const t=await e.json();u(new Set(t.gif_ids||[]))}}catch(e){console.error("Error loading favorites:",e)}},$=async e=>{try{const t=i.has(e),m=t?`${r}/gifs/favorites/remove/`:`${r}/gifs/favorites/add/`;if((await o(m,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({gif_id:e})})).ok){const d=new Set(i);t?d.delete(e):d.add(e),u(d)}}catch(t){console.error("Error toggling favorite:",t)}};return a.createElement("div",{className:"gif-picker-panel"},a.createElement("div",{className:"gif-header"},a.createElement("h2",null,a.createElement(p,null)," GIF Library"),a.createElement("div",{className:"view-controls"},a.createElement("button",{className:`view-btn ${l==="grid"?"active":""}`,onClick:()=>E("grid")},a.createElement(G,null)),a.createElement("button",{className:`view-btn ${l==="list"?"active":""}`,onClick:()=>E("list")},a.createElement(L,null)))),a.createElement("div",{className:"gif-search"},a.createElement(P,{className:"search-icon"}),a.createElement("input",{type:"text",placeholder:"Search GIFs...",value:c,onChange:e=>S(e.target.value),className:"search-input"})),a.createElement("div",{className:"gif-categories"},a.createElement("button",{className:`category-btn ${n==="all"?"active":""}`,onClick:()=>f("all")},"All"),w.map(e=>a.createElement("button",{key:e.id,className:`category-btn ${n===e.id?"active":""}`,onClick:()=>f(e.id)},e.name))),a.createElement("div",{className:`gif-grid ${l}`},h?a.createElement("div",{className:"gif-loading"},"Loading GIFs..."):v.length===0?a.createElement("div",{className:"empty-gifs"},a.createElement(p,{className:"empty-icon"}),a.createElement("p",null,"No GIFs found")):v.map(e=>a.createElement("div",{key:e.id,className:"gif-item"},a.createElement("img",{src:e.url,alt:e.name,onClick:()=>g&&g(e),className:"gif-image"}),a.createElement("div",{className:"gif-overlay"},a.createElement("button",{className:`fav-btn ${i.has(e.id)?"favorited":""}`,onClick:t=>{t.stopPropagation(),$(e.id)}},a.createElement(j,null)))))))}export{T as default};
