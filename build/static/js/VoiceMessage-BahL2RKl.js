import{r as a}from"./react-core-B6hadH-M.js";import{t as h}from"./index-D_6pZib5.js";const j=({onSend:k,onCancel:w})=>{const[c,d]=a.useState(!1),[n,r]=a.useState(!1),[u,l]=a.useState(0),[o,R]=a.useState(null),[i,D]=a.useState(null),[Y,p]=a.useState([]),[y,T]=a.useState(0),[W,N]=a.useState(0),[g,m]=a.useState(0),L=a.useRef(null),x=-80;a.useEffect(()=>{let e;return c&&(e=setInterval(()=>{l(t=>t+1)},1e3)),()=>clearInterval(e)},[c]);const C=async()=>{try{const e=await navigator.mediaDevices.getUserMedia({audio:!0}),t=new MediaRecorder(e),s=[];t.ondataavailable=E=>{s.push(E.data),U()},t.onstop=()=>{const E=new Blob(s,{type:"audio/webm"});R(E),e.getTracks().forEach(K=>K.stop())},t.start(100),D(t),d(!0),r(!1),l(0)}catch(e){console.error("Microphone access error:",e),h.error("âŒ Mikrofon eriÅŸimi reddedildi")}},B=()=>{i&&c&&(i.stop(),d(!1),r(!1))},f=()=>{i&&c&&i.stop(),d(!1),r(!1),R(null),l(0),p([]),m(0),w?.()},S=e=>{e.preventDefault();const t=e.touches?e.touches[0].clientY:e.clientY;T(t),N(t),m(0),C()},b=e=>{if(!c||n)return;const t=e.touches?e.touches[0].clientY:e.clientY;N(t);const s=t-y;m(s),s<x&&(r(!0),h.success("ðŸ”’ KayÄ±t kilitlendi"))},v=e=>{e.preventDefault(),!n&&c&&(f(),h.info("KayÄ±t iptal edildi")),m(0)},I=()=>{o&&(k?.(o,u),R(null),l(0),p([]))},U=()=>{p(e=>[...e,Math.random()*100].slice(-50))},M=e=>{const t=Math.floor(e/60),s=e%60;return`${t}:${s.toString().padStart(2,"0")}`};return React.createElement("div",{className:"voice-message-container"},!c&&!o&&React.createElement("button",{ref:L,className:"btn-start-recording",onMouseDown:S,onMouseMove:b,onMouseUp:v,onMouseLeave:v,onTouchStart:S,onTouchMove:b,onTouchEnd:v,style:{cursor:"pointer",userSelect:"none",WebkitUserSelect:"none",touchAction:"none"}},React.createElement("span",{className:"mic-icon"},"ðŸŽ¤"),React.createElement("span",null,"BasÄ±lÄ± Tut")),c&&React.createElement("div",{className:"recording-ui"},!n&&React.createElement("div",{className:"swipe-indicator",style:{opacity:Math.max(0,Math.min(1,-g/80)),transform:`translateY(${Math.max(g,-100)}px)`}},React.createElement("div",{className:"lock-icon"},"ðŸ”’"),React.createElement("div",{className:"swipe-text"},"YukarÄ± kaydÄ±r")),n&&React.createElement("div",{className:"locked-indicator"},React.createElement("span",{className:"lock-icon"},"ðŸ”’"),React.createElement("span",null,"Kilitli")),React.createElement("div",{className:"waveform"},Y.map((e,t)=>React.createElement("div",{key:t,className:"waveform-bar",style:{height:`${e}%`}}))),React.createElement("div",{className:"recording-info"},React.createElement("span",{className:"recording-indicator"},"ðŸ”´"),React.createElement("span",{className:"recording-time"},M(u))),React.createElement("div",{className:"recording-controls"},React.createElement("button",{className:"btn-cancel",onClick:f},"Ä°ptal"),n&&React.createElement("button",{className:"btn-stop",onClick:B},"Durdur"))),o&&!c&&React.createElement("div",{className:"preview-ui"},React.createElement("audio",{controls:!0,src:URL.createObjectURL(o)}),React.createElement("div",{className:"preview-info"},React.createElement("span",null,"Sesli mesaj â€¢ ",M(u))),React.createElement("div",{className:"preview-controls"},React.createElement("button",{className:"btn-cancel",onClick:f},"Sil"),React.createElement("button",{className:"btn-send",onClick:I},"GÃ¶nder ðŸ“¤"))))};export{j as default};
