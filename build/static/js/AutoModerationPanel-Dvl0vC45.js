import{r as o,b as e}from"./react-core-9vc7GIjk.js";import{B as z,a3 as B,$ as h,bh as T,bi as F,aA as O,o as P,az as j,aX as x}from"./icons-vendor-NoxEirJf.js";import{t as n}from"./index-C8QEFqrd.js";import"./editor-vendor-DiU449Dh.js";import"./media-vendor-B-uSUaIv.js";import"./router-vendor-u6fxj6P4.js";import"./crypto-vendor-C1qXRpJv.js";import"./state-vendor-0vlBuk0v.js";const I=({serverId:c,onClose:d})=>{const[i,m]=o.useState([]),[k,E]=o.useState(!0),[f,u]=o.useState(!1),[Y,p]=o.useState(null),[t,r]=o.useState({name:"",type:"spam",action:"warn",enabled:!0,keywords:[],threshold:5,duration:60});o.useEffect(()=>{v()},[c]);const v=async()=>{E(!0);try{const a=await fetch(`/api/moderation/auto-mod/rules/${c}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(a.ok){const l=await a.json();m(l.rules||[])}}catch{n.error("âŒ Kurallar yÃ¼klenemedi")}finally{E(!1)}},g=async()=>{if(!t.name.trim()){n.error("âŒ Kural adÄ± girin");return}try{const a=await fetch(`/api/moderation/auto-mod/rules/${c}/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`,"Content-Type":"application/json"},body:JSON.stringify(t)});if(a.ok){const l=await a.json();m([...i,l.rule]),u(!1),C(),n.success("âœ… Kural oluÅŸturuldu")}else n.error("âŒ Kural oluÅŸturulamadÄ±")}catch{n.error("âŒ BaÄŸlantÄ± hatasÄ±")}},N=async(a,l)=>{try{const s=await fetch(`/api/moderation/auto-mod/rules/${c}/${a}/`,{method:"PUT",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`,"Content-Type":"application/json"},body:JSON.stringify(l)});if(s.ok){const $=await s.json();m(i.map(y=>y.id===a?$.rule:y)),p(null),n.success("âœ… Kural gÃ¼ncellendi")}}catch{n.error("âŒ GÃ¼ncelleme baÅŸarÄ±sÄ±z")}},b=async a=>{if(confirm("Bu kuralÄ± silmek istediÄŸinizden emin misiniz?"))try{(await fetch(`/api/moderation/auto-mod/rules/${c}/${a}/`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}})).ok&&(m(i.filter(s=>s.id!==a)),n.success("âœ… Kural silindi"))}catch{n.error("âŒ Silme baÅŸarÄ±sÄ±z")}},w=async(a,l)=>{await N(a,{enabled:l})},C=()=>{r({name:"",type:"spam",action:"warn",enabled:!0,keywords:[],threshold:5,duration:60})},S=a=>{a.trim()&&!t.keywords.includes(a.trim())&&r({...t,keywords:[...t.keywords,a.trim()]})},K=a=>{r({...t,keywords:t.keywords.filter(l=>l!==a)})},R=a=>{switch(a){case"spam":return e.createElement(x,null);case"profanity":return e.createElement(j,null);case"caps":return"ğŸ”¤";case"links":return"ğŸ”—";case"mentions":return"@";default:return e.createElement(h,null)}},A=a=>{switch(a){case"warn":return"#faa61a";case"mute":return"#ff9500";case"kick":return"#ff3b30";case"ban":return"#ff0000";default:return"#8b5cf6"}};return e.createElement("div",{className:"auto-mod-panel-overlay",onClick:d},e.createElement("div",{className:"auto-mod-panel",onClick:a=>a.stopPropagation()},e.createElement("div",{className:"panel-header"},e.createElement(z,{className:"header-icon"}),e.createElement("h2",null,"Otomatik Moderasyon"),e.createElement("button",{className:"close-btn",onClick:d},"Ã—")),e.createElement("div",{className:"panel-actions"},e.createElement("button",{className:"btn-create",onClick:()=>u(!0)},e.createElement(B,null)," Yeni Kural")),k?e.createElement("div",{className:"loading-state"},e.createElement("div",{className:"spinner"}),e.createElement("p",null,"YÃ¼kleniyor...")):e.createElement("div",{className:"rules-list"},i.length===0?e.createElement("div",{className:"empty-state"},e.createElement(h,{size:48}),e.createElement("h3",null,"Kural Yok"),e.createElement("p",null,"Otomatik moderasyon kurallarÄ± oluÅŸturun")):i.map(a=>e.createElement("div",{key:a.id,className:`rule-card ${a.enabled?"":"disabled"}`},e.createElement("div",{className:"rule-header"},e.createElement("div",{className:"rule-icon"},R(a.type)),e.createElement("div",{className:"rule-info"},e.createElement("h3",null,a.name),e.createElement("span",{className:"rule-type"},a.type)),e.createElement("div",{className:"rule-actions"},e.createElement("button",{className:"action-btn toggle",onClick:()=>w(a.id,!a.enabled),title:a.enabled?"Devre DÄ±ÅŸÄ± BÄ±rak":"EtkinleÅŸtir"},a.enabled?e.createElement(T,null):e.createElement(F,null)),e.createElement("button",{className:"action-btn edit",onClick:()=>p(a),title:"DÃ¼zenle"},e.createElement(O,null)),e.createElement("button",{className:"action-btn delete",onClick:()=>b(a.id),title:"Sil"},e.createElement(P,null)))),e.createElement("div",{className:"rule-details"},e.createElement("div",{className:"detail-item"},e.createElement("span",{className:"label"},"Aksiyon:"),e.createElement("span",{className:"value action-badge",style:{backgroundColor:A(a.action)}},a.action)),a.keywords&&a.keywords.length>0&&e.createElement("div",{className:"detail-item"},e.createElement("span",{className:"label"},"Anahtar Kelimeler:"),e.createElement("div",{className:"keywords"},a.keywords.map((l,s)=>e.createElement("span",{key:s,className:"keyword"},l)))),a.threshold&&e.createElement("div",{className:"detail-item"},e.createElement("span",{className:"label"},"EÅŸik:"),e.createElement("span",{className:"value"},a.threshold)))))),f&&e.createElement("div",{className:"rule-editor-modal"},e.createElement("div",{className:"rule-editor"},e.createElement("h3",null,"Yeni Kural OluÅŸtur"),e.createElement("div",{className:"form-group"},e.createElement("label",null,"Kural AdÄ±"),e.createElement("input",{type:"text",value:t.name,onChange:a=>r({...t,name:a.target.value}),placeholder:"Ã–rn: Spam Engelleme"})),e.createElement("div",{className:"form-row"},e.createElement("div",{className:"form-group"},e.createElement("label",null,"Kural Tipi"),e.createElement("select",{value:t.type,onChange:a=>r({...t,type:a.target.value})},e.createElement("option",{value:"spam"},"Spam"),e.createElement("option",{value:"profanity"},"KÃ¼fÃ¼r"),e.createElement("option",{value:"caps"},"BÃ¼yÃ¼k Harf"),e.createElement("option",{value:"links"},"Link"),e.createElement("option",{value:"mentions"},"Mention"))),e.createElement("div",{className:"form-group"},e.createElement("label",null,"Aksiyon"),e.createElement("select",{value:t.action,onChange:a=>r({...t,action:a.target.value})},e.createElement("option",{value:"warn"},"Uyar"),e.createElement("option",{value:"mute"},"Sustur"),e.createElement("option",{value:"kick"},"At"),e.createElement("option",{value:"ban"},"Yasakla")))),e.createElement("div",{className:"form-group"},e.createElement("label",null,"Anahtar Kelimeler (Enter ile ekle)"),e.createElement("input",{type:"text",placeholder:"Kelime girin ve Enter'a basÄ±n",onKeyPress:a=>{a.key==="Enter"&&(S(a.target.value),a.target.value="")}}),e.createElement("div",{className:"keywords-list"},t.keywords.map((a,l)=>e.createElement("span",{key:l,className:"keyword-chip"},a,e.createElement("button",{onClick:()=>K(a)},"Ã—"))))),e.createElement("div",{className:"form-row"},e.createElement("div",{className:"form-group"},e.createElement("label",null,"EÅŸik"),e.createElement("input",{type:"number",value:t.threshold,onChange:a=>r({...t,threshold:parseInt(a.target.value)}),min:"1"})),e.createElement("div",{className:"form-group"},e.createElement("label",null,"SÃ¼re (saniye)"),e.createElement("input",{type:"number",value:t.duration,onChange:a=>r({...t,duration:parseInt(a.target.value)}),min:"1"}))),e.createElement("div",{className:"modal-actions"},e.createElement("button",{className:"btn-cancel",onClick:()=>u(!1)},"Ä°ptal"),e.createElement("button",{className:"btn-save",onClick:g},"OluÅŸtur"))))))};export{I as default};
