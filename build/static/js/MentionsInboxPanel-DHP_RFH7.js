import{a as B,r as i,n as e}from"./react-core-BMiyQWF6.js";import{l as I,c as F,a as M,a7 as _,i as H,aB as W}from"./icons-vendor-T72gfvdf.js";import{A as $}from"./index-CbrAkfmn.js";import"./editor-vendor-D9c4a6XZ.js";import"./media-vendor-BuSyE8vR.js";import"./router-vendor-B86Z1mIL.js";import"./state-vendor-CAyNnPM4.js";import"./crypto-vendor-1Q6e4ZD-.js";const A=({isOpen:x,onClose:u,onNavigateToMessage:y,currentUsername:c})=>{const[f,j]=i.useState([]),[a,h]=i.useState(!1),[S,k]=i.useState(1),[m,z]=i.useState(!1),[b,C]=i.useState(0),[g,L]=i.useState(""),s=i.useCallback(async(n=1,r=!1)=>{h(!0);try{const l=localStorage.getItem("access_token");let o=`${$}/api/mentions/inbox/?page=${n}&page_size=25`;g&&(o+=`&room_id=${g}`);const d=await fetch(o,{headers:{Authorization:`Bearer ${l}`}});if(d.ok){const p=await d.json();j(w=>r?[...w,...p.results]:p.results),z(p.has_next),C(p.total),k(n)}}catch{}finally{h(!1)}},[g]);i.useEffect(()=>{x&&s(1)},[x,s]);const R=()=>{m&&s(S+1,!0)},T=n=>{const r=new Date(n),o=new Date-r;return o<6e4?"Az √∂nce":o<36e5?`${Math.floor(o/6e4)} dk √∂nce`:o<864e5?`${Math.floor(o/36e5)} sa √∂nce`:o<6048e5?`${Math.floor(o/864e5)} g√ºn √∂nce`:r.toLocaleDateString("tr-TR")},v=n=>{if(!n||!c)return n;const r=new RegExp(`(@${c})`,"gi");return n.split(r).map((o,d)=>r.test(o)?e.jsx("span",{style:t.mentionHighlight,children:o},d):o)};return x?e.jsx("div",{style:t.overlay,children:e.jsxs("div",{style:t.panel,children:[e.jsxs("div",{style:t.header,children:[e.jsxs("div",{style:t.headerLeft,children:[e.jsx(I,{style:{color:"#5865F2",fontSize:18}}),e.jsx("h3",{style:t.title,children:"Bahsedilmeler"}),b>0&&e.jsx("span",{style:t.badge,children:b})]}),e.jsxs("div",{style:t.headerRight,children:[e.jsx("button",{onClick:()=>s(1),style:t.refreshBtn,title:"Yenile",children:e.jsx(F,{style:a?{animation:"spin 1s linear infinite"}:{}})}),e.jsx("button",{onClick:u,style:t.closeBtn,children:e.jsx(M,{})})]})]}),e.jsx("div",{style:t.content,children:a&&f.length===0?e.jsxs("div",{style:t.emptyState,children:[e.jsx("div",{style:t.spinner}),e.jsx("p",{children:"Y√ºkleniyor..."})]}):f.length===0?e.jsxs("div",{style:t.emptyState,children:[e.jsx("span",{style:{fontSize:48},children:"üì≠"}),e.jsx("p",{style:t.emptyTitle,children:"Bahsedilme yok"}),e.jsxs("p",{style:t.emptySubtitle,children:["Birisi seni @",c," ile etiketlediƒüinde burada g√∂r√ºn√ºr"]})]}):e.jsxs(e.Fragment,{children:[f.map(n=>e.jsxs("div",{style:t.mentionItem,onClick:()=>y?.(n),children:[e.jsxs("div",{style:t.mentionHeader,children:[e.jsx("span",{style:t.mentionUser,children:n.username}),e.jsx("span",{style:t.mentionTime,children:T(n.timestamp)})]}),e.jsxs("div",{style:t.mentionContent,children:[v(n.content?.slice(0,200)),n.content?.length>200&&"..."]}),e.jsxs("div",{style:t.mentionFooter,children:[n.room_name&&e.jsxs("span",{style:t.roomTag,children:[e.jsx(_,{style:{fontSize:10}}),n.room_name]}),n.is_pinned&&e.jsxs("span",{style:t.pinnedTag,children:[e.jsx(H,{style:{fontSize:10}})," Sabitlenmi≈ü"]}),n.has_thread&&e.jsxs("span",{style:t.threadTag,children:[e.jsx(W,{style:{fontSize:10}})," Thread"]})]})]},n.id)),m&&e.jsx("button",{onClick:R,style:t.loadMoreBtn,disabled:a,children:a?"Y√ºkleniyor...":"Daha Fazla G√∂ster"})]})})]})}):null},t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.6)",display:"flex",justifyContent:"center",alignItems:"flex-start",paddingTop:"60px",zIndex:1e3},panel:{width:"500px",maxWidth:"90vw",maxHeight:"80vh",backgroundColor:"#2f3136",borderRadius:"12px",overflow:"hidden",display:"flex",flexDirection:"column",boxShadow:"0 8px 32px rgba(0,0,0,0.4)"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 20px",borderBottom:"1px solid #202225",backgroundColor:"#292b2f"},headerLeft:{display:"flex",alignItems:"center",gap:"10px"},headerRight:{display:"flex",alignItems:"center",gap:"8px"},title:{margin:0,fontSize:"16px",fontWeight:600,color:"#fff"},badge:{backgroundColor:"#ed4245",color:"#fff",fontSize:"11px",fontWeight:700,padding:"2px 6px",borderRadius:"10px",minWidth:"18px",textAlign:"center"},refreshBtn:{background:"none",border:"none",color:"#b9bbbe",cursor:"pointer",padding:"6px",borderRadius:"4px",fontSize:"14px"},closeBtn:{background:"none",border:"none",color:"#b9bbbe",cursor:"pointer",padding:"6px",borderRadius:"4px",fontSize:"16px"},content:{flex:1,overflowY:"auto",padding:"8px"},emptyState:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"48px 24px",color:"#72767d"},emptyTitle:{fontSize:"16px",fontWeight:600,color:"#dcddde",margin:"12px 0 4px"},emptySubtitle:{fontSize:"13px",textAlign:"center"},mentionItem:{padding:"12px 16px",borderRadius:"8px",cursor:"pointer",transition:"background 0.15s",marginBottom:"4px",borderLeft:"3px solid #5865F2",backgroundColor:"rgba(88, 101, 242, 0.06)"},mentionHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"6px"},mentionUser:{fontWeight:600,color:"#fff",fontSize:"14px"},mentionTime:{color:"#72767d",fontSize:"12px"},mentionContent:{color:"#dcddde",fontSize:"14px",lineHeight:1.5,wordBreak:"break-word"},mentionHighlight:{backgroundColor:"rgba(88, 101, 242, 0.3)",color:"#dee0fc",padding:"1px 3px",borderRadius:"3px",fontWeight:600},mentionFooter:{display:"flex",gap:"8px",marginTop:"8px"},roomTag:{display:"flex",alignItems:"center",gap:"4px",backgroundColor:"rgba(255,255,255,0.06)",color:"#b9bbbe",padding:"2px 8px",borderRadius:"4px",fontSize:"12px"},pinnedTag:{display:"flex",alignItems:"center",gap:"4px",backgroundColor:"rgba(250, 166, 26, 0.1)",color:"#faa61a",padding:"2px 8px",borderRadius:"4px",fontSize:"12px"},threadTag:{display:"flex",alignItems:"center",gap:"4px",backgroundColor:"rgba(88, 101, 242, 0.1)",color:"#5865F2",padding:"2px 8px",borderRadius:"4px",fontSize:"12px"},loadMoreBtn:{width:"100%",padding:"10px",backgroundColor:"#5865F2",color:"#fff",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:500,marginTop:"8px"},spinner:{width:32,height:32,border:"3px solid #5865F2",borderTopColor:"transparent",borderRadius:"50%",animation:"spin 0.8s linear infinite",marginBottom:12}},J=B.memo(A);export{J as default};
