var ne=Object.defineProperty;var n=(i,g)=>ne(i,"name",{value:g,configurable:!0});import{r as t,j as e}from"./react-core-Djgtqrmb.js";import{k as N,az as ie,a as M,cF as ce,_ as le,V as oe,l as re,a9 as de}from"./icons-vendor-BW7dxHkX.js";import{g as l,e as he}from"./index-GGLPABCW.js";import"./media-vendor-CxFPycob.js";import"./router-vendor-ClgLnMjk.js";import"./state-vendor-BRqaXHJQ.js";import"./crypto-vendor-D1XRGppi.js";import"./ui-vendor-IhB9Znpc.js";const me=n(({userId:i,onClose:g})=>{const[r,h]=t.useState([]),[u,x]=t.useState(0),[d,j]=t.useState("all"),[ue,P]=t.useState(null),[D,p]=t.useState(!1),[O,R]=t.useState(!0),[b,v]=t.useState(!0),[k,y]=t.useState(!0),[C,S]=t.useState(!1),[w,$]=t.useState(!1),[E,_]=t.useState(!0),B=t.useCallback(()=>p(s=>!s),[]),L=t.useCallback(()=>j("all"),[]),U=t.useCallback(()=>j("unread"),[]),z=t.useCallback(()=>j("mentions"),[]),J=t.useCallback(()=>j("servers"),[]),H=t.useCallback(s=>v(s.target.checked),[]),V=t.useCallback(s=>y(s.target.checked),[]),W=t.useCallback(s=>_(s.target.checked),[]),Y=t.useCallback(s=>S(s.target.checked),[]),q=t.useCallback(s=>$(s.target.checked),[]);t.useEffect(()=>{G(),K()},[i,d]);const c=n(async(s,a={})=>{const A=localStorage.getItem("access_token"),o=await fetch(s,{...a,headers:{Authorization:`Bearer ${A}`,"Content-Type":"application/json",...a.headers}});if(!o.ok)throw new Error(`HTTP ${o.status}`);return await o.json()},"fetchWithAuth"),G=n(async()=>{try{const s=await c(`${l()}/notifications/${i}/list/?filter=${d}`);h(s.notifications||[]),x(s.unread_count||0)}catch{}finally{R(!1)}},"fetchNotifications"),K=n(async()=>{try{const s=await c(`${l()}/notifications/${i}/settings/`);P(s),v(s.push_enabled),y(s.email_enabled),S(s.mentions_only),$(s.dnd_enabled),_(s.sound_enabled)}catch{}},"fetchSettings"),Q=n(async s=>{try{await c(`${l()}/notifications/${i}/${s}/read/`,{method:"POST"}),h(r.map(a=>a.id===s?{...a,read:!0}:a)),x(Math.max(0,u-1))}catch{}},"markAsRead"),X=n(async()=>{try{await c(`${l()}/notifications/${i}/read-all/`,{method:"POST"}),h(r.map(s=>({...s,read:!0}))),x(0),m("All notifications marked as read!")}catch{}},"markAllAsRead"),Z=n(async s=>{try{await c(`${l()}/notifications/${i}/${s}/delete/`,{method:"DELETE"}),h(r.filter(a=>a.id!==s)),m("Notification deleted!")}catch{}},"deleteNotification"),I=n(async()=>{if(await he("Are you sure you want to clear all notifications?"))try{await c(`${l()}/notifications/${i}/clear/`,{method:"POST"}),h([]),x(0),m("All notifications cleared!")}catch{}},"clearAll"),ee=n(async()=>{try{await c(`${l()}/notifications/${i}/settings/update/`,{method:"PUT",body:JSON.stringify({push_enabled:b,email_enabled:k,mentions_only:C,dnd_enabled:w,sound_enabled:E})}),m("Settings updated!"),p(!1)}catch{}},"updateSettings"),se=n(async()=>{try{await c(`${l()}/notifications/${i}/test/`,{method:"POST"}),m("Test notification sent!")}catch{}},"testNotification"),te=n(s=>{switch(s){case"mention":return"ðŸ’¬";case"reply":return"â†©ï¸";case"like":return"â¤ï¸";case"follow":return"ðŸ‘¤";case"server_invite":return"ðŸ“§";case"role_update":return"ðŸ·ï¸";case"announcement":return"ðŸ“¢";default:return"ðŸ””"}},"getNotificationIcon"),ae=n(s=>{const a=new Date(s),o=new Date-a,f=Math.floor(o/6e4),F=Math.floor(o/36e5),T=Math.floor(o/864e5);return f<1?"Just now":f<60?`${f}m ago`:F<24?`${F}h ago`:T<7?`${T}d ago`:a.toLocaleDateString()},"formatTimestamp"),m=n((s,a="success")=>{},"showToast");return O?e.jsx("div",{className:"notifications-overlay",children:e.jsxs("div",{className:"notifications-panel loading",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{children:"Loading Notifications..."})]})}):e.jsx("div",{className:"notifications-overlay",children:e.jsxs("div",{className:"notifications-panel",children:[e.jsxs("div",{className:"panel-header",children:[e.jsxs("div",{children:[e.jsxs("h2",{children:[e.jsx(N,{})," Notifications"]}),u>0&&e.jsxs("span",{className:"unread-badge",children:[u," new"]})]}),e.jsxs("div",{className:"header-actions",children:[e.jsx("button",{onClick:B,className:"btn-settings",children:e.jsx(ie,{})}),e.jsx("button",{onClick:g,className:"btn-close",children:e.jsx(M,{})})]})]}),e.jsxs("div",{className:"filter-bar",children:[e.jsx("button",{className:d==="all"?"active":"",onClick:L,children:"All"}),e.jsx("button",{className:d==="unread"?"active":"",onClick:U,children:"Unread"}),e.jsx("button",{className:d==="mentions"?"active":"",onClick:z,children:"Mentions"}),e.jsx("button",{className:d==="servers"?"active":"",onClick:J,children:"Servers"})]}),D&&e.jsxs("div",{className:"settings-panel",children:[e.jsx("h3",{children:"Notification Settings"}),e.jsxs("div",{className:"setting-item",children:[e.jsxs("div",{className:"setting-info",children:[e.jsx(ce,{}),e.jsxs("div",{children:[e.jsx("h4",{children:"Push Notifications"}),e.jsx("p",{children:"Receive notifications on your device"})]})]}),e.jsxs("label",{className:"toggle",children:[e.jsx("input",{type:"checkbox",checked:b,onChange:H}),e.jsx("span",{className:"toggle-slider"})]})]}),e.jsxs("div",{className:"setting-item",children:[e.jsxs("div",{className:"setting-info",children:[e.jsx(le,{}),e.jsxs("div",{children:[e.jsx("h4",{children:"Email Notifications"}),e.jsx("p",{children:"Receive notifications via email"})]})]}),e.jsxs("label",{className:"toggle",children:[e.jsx("input",{type:"checkbox",checked:k,onChange:V}),e.jsx("span",{className:"toggle-slider"})]})]}),e.jsxs("div",{className:"setting-item",children:[e.jsxs("div",{className:"setting-info",children:[e.jsx(N,{}),e.jsxs("div",{children:[e.jsx("h4",{children:"Sound Effects"}),e.jsx("p",{children:"Play sound when you receive notifications"})]})]}),e.jsxs("label",{className:"toggle",children:[e.jsx("input",{type:"checkbox",checked:E,onChange:W}),e.jsx("span",{className:"toggle-slider"})]})]}),e.jsxs("div",{className:"setting-item",children:[e.jsxs("div",{className:"setting-info",children:[e.jsx(oe,{}),e.jsxs("div",{children:[e.jsx("h4",{children:"Mentions Only"}),e.jsx("p",{children:"Only notify when you're mentioned"})]})]}),e.jsxs("label",{className:"toggle",children:[e.jsx("input",{type:"checkbox",checked:C,onChange:Y}),e.jsx("span",{className:"toggle-slider"})]})]}),e.jsxs("div",{className:"setting-item",children:[e.jsxs("div",{className:"setting-info",children:[e.jsx(re,{}),e.jsxs("div",{children:[e.jsx("h4",{children:"Do Not Disturb"}),e.jsx("p",{children:"Mute all notifications temporarily"})]})]}),e.jsxs("label",{className:"toggle",children:[e.jsx("input",{type:"checkbox",checked:w,onChange:q}),e.jsx("span",{className:"toggle-slider"})]})]}),e.jsxs("div",{className:"settings-actions",children:[e.jsx("button",{onClick:se,className:"btn-test",children:"Test Notification"}),e.jsx("button",{onClick:ee,className:"btn-save",children:"Save Settings"})]})]}),e.jsxs("div",{className:"panel-actions",children:[u>0&&e.jsxs("button",{onClick:X,className:"btn-mark-read",children:[e.jsx(de,{})," Mark All as Read"]}),r.length>0&&e.jsx("button",{onClick:I,className:"btn-clear",children:"Clear All"})]}),e.jsx("div",{className:"notifications-content",children:r.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx(N,{size:64}),e.jsx("h3",{children:"No Notifications"}),e.jsx("p",{children:"You're all caught up!"})]}):e.jsx("div",{className:"notifications-list",children:r.map(s=>e.jsxs("div",{className:`notification-item ${s.read?"":"unread"}`,onClick:n(()=>!s.read&&Q(s.id),"onClick"),children:[e.jsx("div",{className:"notification-icon",children:te(s.type)}),e.jsxs("div",{className:"notification-body",children:[e.jsxs("div",{className:"notification-header",children:[e.jsx("h4",{children:s.title}),e.jsx("span",{className:"notification-time",children:ae(s.created_at)})]}),e.jsx("p",{className:"notification-message",children:s.message}),s.server_name&&e.jsxs("span",{className:"notification-server",children:["in ",s.server_name]})]}),e.jsx("button",{onClick:n(a=>{a.stopPropagation(),Z(s.id)},"onClick"),className:"btn-delete-notification",children:e.jsx(M,{})}),!s.read&&e.jsx("div",{className:"unread-dot"})]},s.id))})})]})})},"NotificationsCenter"),ye=t.memo(me);export{ye as default};
