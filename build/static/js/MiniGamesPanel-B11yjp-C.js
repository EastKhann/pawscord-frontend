import{r as p,b as e}from"./react-core-9vc7GIjk.js";import{ah as T,a as G,c2 as R,M as B,n as I,aq as j,aP as z}from"./icons-vendor-u_f-1GKM.js";import{t as b}from"./index-CUykE5-R.js";import"./editor-vendor-DiU449Dh.js";import"./media-vendor-B-uSUaIv.js";import"./router-vendor-u6fxj6P4.js";import"./crypto-vendor-C1qXRpJv.js";import"./state-vendor-0vlBuk0v.js";const M=({fetchWithAuth:d,apiBaseUrl:s,onClose:c,serverId:r})=>{const[x,n]=p.useState([]),[o,l]=p.useState(null),[y,v]=p.useState([]),[k,E]=p.useState(!1),[u,f]=p.useState("games");p.useEffect(()=>{w(),h()},[]);const w=async()=>{try{const i=await(await d(`${s}/games/?server_id=${r}`)).json();n(i.games||[])}catch(a){console.error("Failed to fetch games:",a)}},h=async()=>{try{const i=await(await d(`${s}/games/leaderboard/?server_id=${r}`)).json();v(i.leaderboard||[])}catch(a){console.error("Failed to fetch leaderboard:",a)}},_=async a=>{E(!0);try{const g=await(await d(`${s}/games/create/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({game_type:a,server_id:r})})).json();g.game&&(l(g.game),f("playing"),b.success(`${g.game.game_type} started!`))}catch{b.error("Failed to create game")}finally{E(!1)}},C=async(a,i={})=>{if(o)try{const m=await(await d(`${s}/games/${o.id}/action/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:a,data:i})})).json();return m.game&&l(m.game),m.status==="finished"&&(b.success(`Game over! ${m.winners?.join(", ")} won ${m.reward} coins!`),setTimeout(()=>{l(null),f("games"),h()},3e3)),m}catch{b.error("Action failed")}},S={trivia:"ðŸ§ ",word_chain:"ðŸ“",tic_tac_toe:"â­•",rock_paper_scissors:"âœŠ",number_guess:"ðŸ”¢",emoji_quiz:"ðŸ˜€",hangman:"ðŸŽ¯",memory_match:"ðŸƒ"};return e.createElement("div",{style:t.overlay},e.createElement("div",{style:t.modal},e.createElement("div",{style:t.header},e.createElement("div",{style:t.headerLeft},e.createElement(T,{style:{marginRight:"10px",color:"#5865f2"}}),e.createElement("h2",{style:t.title},"Mini Games")),e.createElement("button",{onClick:c,style:t.closeButton},e.createElement(G,null))),e.createElement("div",{style:t.tabs},e.createElement("button",{onClick:()=>f("games"),style:u==="games"?t.activeTab:t.tab},e.createElement(R,null)," Games"),e.createElement("button",{onClick:()=>f("leaderboard"),style:u==="leaderboard"?t.activeTab:t.tab},e.createElement(B,null)," Leaderboard")),e.createElement("div",{style:t.content},u==="games"&&e.createElement("div",{style:t.gamesGrid},x.map(a=>e.createElement("div",{key:a.id,style:t.gameCard},e.createElement("span",{style:t.gameIcon},S[a.id]||"ðŸŽ®"),e.createElement("h3",{style:t.gameName},a.name),e.createElement("p",{style:t.gameDesc},a.description),e.createElement("div",{style:t.gameInfo},e.createElement("span",null,e.createElement(I,null)," ",a.min_players,"-",a.max_players),e.createElement("span",null,e.createElement(j,null)," ",a.reward_coins)),e.createElement("button",{onClick:()=>_(a.id),style:t.playButton,disabled:k},e.createElement(z,null)," Play")))),u==="playing"&&o&&e.createElement(L,{game:o,onAction:C}),u==="leaderboard"&&e.createElement("div",{style:t.leaderboard},y.map((a,i)=>e.createElement("div",{key:a.username,style:t.leaderboardRow},e.createElement("span",{style:t.rank},"#",i+1),e.createElement("span",{style:t.playerName},a.username),e.createElement("span",{style:t.wins},a.wins," wins"),e.createElement("span",{style:t.totalScore},a.total_score," pts"))),y.length===0&&e.createElement("p",{style:t.emptyText},"No games played yet!")))))},L=({game:d,onAction:s})=>{const{game_type:c,state:r,players:x}=d;if(c==="trivia"){const n=r.questions?.[r.current_question];return e.createElement("div",{style:t.gameArea},e.createElement("h3",null,"Question ",r.current_question+1,"/",r.questions?.length),e.createElement("p",{style:t.question},n?.question),e.createElement("div",{style:t.options},n?.options.map((o,l)=>e.createElement("button",{key:l,onClick:()=>s("answer",{answer:l}),style:t.optionButton},o))))}if(c==="tic_tac_toe")return e.createElement("div",{style:t.gameArea},e.createElement("h3",null,"Tic Tac Toe"),e.createElement("div",{style:t.ticTacToeBoard},r.board?.map((n,o)=>e.createElement("button",{key:o,onClick:()=>s("move",{position:o}),style:t.ticTacToeCell,disabled:n!==null},n===0?"âŒ":n===1?"â­•":""))));if(c==="number_guess"){const[n,o]=p.useState("");return e.createElement("div",{style:t.gameArea},e.createElement("h3",null,"Guess the Number (1-100)"),e.createElement("p",null,"Guesses left: ",r.max_guesses-(r.guesses?.length||0)),r.hints?.length>0&&e.createElement("p",null,"Last hint: Go ",r.hints[r.hints.length-1]),e.createElement("input",{type:"number",value:n,onChange:l=>o(l.target.value),style:t.guessInput,min:"1",max:"100"}),e.createElement("button",{onClick:()=>{s("guess",{number:parseInt(n)}),o("")},style:t.guessButton},"Guess!"))}if(c==="rock_paper_scissors")return e.createElement("div",{style:t.gameArea},e.createElement("h3",null,"Rock Paper Scissors - Round ",r.current_round,"/",r.max_rounds),e.createElement("div",{style:t.rpsButtons},["rock","paper","scissors"].map(n=>e.createElement("button",{key:n,onClick:()=>s("choose",{choice:n}),style:t.rpsButton},n==="rock"?"ðŸª¨":n==="paper"?"ðŸ“„":"âœ‚ï¸",e.createElement("span",null,n)))));if(c==="hangman"){const[n,o]=p.useState("");return e.createElement("div",{style:t.gameArea},e.createElement("h3",null,"Hangman"),e.createElement("p",{style:t.hangmanWord},r.display?.join(" ")),e.createElement("p",null,"Wrong guesses: ",r.wrong_guesses,"/",r.max_wrong),e.createElement("p",null,"Used: ",r.guessed_letters?.join(", ")),e.createElement("input",{type:"text",value:n,onChange:l=>o(l.target.value.slice(-1).toUpperCase()),style:t.letterInput,maxLength:1}),e.createElement("button",{onClick:()=>{s("guess_letter",{letter:n}),o("")},style:t.guessButton},"Guess Letter"))}return e.createElement("div",{style:t.gameArea},e.createElement("h3",null,"Game: ",c),e.createElement("p",null,"Game is in progress..."))},t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e4},modal:{backgroundColor:"#2f3136",borderRadius:"12px",width:"700px",maxHeight:"85vh",overflow:"hidden",display:"flex",flexDirection:"column"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #40444b"},headerLeft:{display:"flex",alignItems:"center"},title:{margin:0,color:"#fff",fontSize:"20px"},closeButton:{background:"none",border:"none",color:"#b9bbbe",cursor:"pointer",fontSize:"20px"},tabs:{display:"flex",padding:"10px 20px",gap:"10px"},tab:{background:"#40444b",border:"none",color:"#b9bbbe",padding:"8px 16px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},activeTab:{background:"#5865f2",border:"none",color:"#fff",padding:"8px 16px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},content:{padding:"20px",overflowY:"auto",flex:1},gamesGrid:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"15px"},gameCard:{background:"#40444b",borderRadius:"10px",padding:"15px",textAlign:"center"},gameIcon:{fontSize:"40px"},gameName:{color:"#fff",margin:"10px 0 5px"},gameDesc:{color:"#b9bbbe",fontSize:"12px",marginBottom:"10px"},gameInfo:{display:"flex",justifyContent:"center",gap:"15px",color:"#b9bbbe",fontSize:"12px",marginBottom:"10px"},playButton:{background:"#5865f2",border:"none",color:"#fff",padding:"8px 20px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",margin:"0 auto"},gameArea:{textAlign:"center",color:"#fff"},question:{fontSize:"18px",marginBottom:"20px"},options:{display:"flex",flexDirection:"column",gap:"10px"},optionButton:{background:"#40444b",border:"none",color:"#fff",padding:"12px",borderRadius:"8px",cursor:"pointer",fontSize:"14px",transition:"background 0.2s"},ticTacToeBoard:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"5px",width:"200px",margin:"20px auto"},ticTacToeCell:{width:"60px",height:"60px",background:"#40444b",border:"none",borderRadius:"8px",fontSize:"30px",cursor:"pointer"},guessInput:{background:"#40444b",border:"none",color:"#fff",padding:"10px",borderRadius:"6px",width:"100px",textAlign:"center",fontSize:"18px"},guessButton:{background:"#5865f2",border:"none",color:"#fff",padding:"10px 20px",borderRadius:"6px",cursor:"pointer",marginLeft:"10px"},letterInput:{background:"#40444b",border:"none",color:"#fff",padding:"10px",borderRadius:"6px",width:"50px",textAlign:"center",fontSize:"24px",textTransform:"uppercase"},rpsButtons:{display:"flex",justifyContent:"center",gap:"20px"},rpsButton:{background:"#40444b",border:"none",color:"#fff",padding:"20px",borderRadius:"12px",cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",gap:"5px",fontSize:"40px"},hangmanWord:{fontSize:"32px",letterSpacing:"8px",marginBottom:"20px"},leaderboard:{display:"flex",flexDirection:"column",gap:"10px"},leaderboardRow:{display:"flex",alignItems:"center",gap:"15px",background:"#40444b",padding:"12px 15px",borderRadius:"8px"},rank:{color:"#faa61a",fontWeight:"bold",width:"40px"},playerName:{color:"#fff",flex:1},wins:{color:"#57f287"},totalScore:{color:"#b9bbbe"},emptyText:{color:"#72767d",textAlign:"center",padding:"40px"}};export{M as default};
