var L=Object.defineProperty;var r=(s,l)=>L(s,"name",{value:l,configurable:!0});import{r as c,j as e}from"./react-core-Djgtqrmb.js";import{be as u,C as z,ba as D,a as j,a9 as _,f as P,ay as W,a0 as A,V as M}from"./icons-vendor-BW7dxHkX.js";import{t as U,d as T}from"./index-m2zCEI_Z.js";import"./media-vendor-CxFPycob.js";import"./router-vendor-gmJ9Mn-1.js";import"./state-vendor-BRqaXHJQ.js";import"./crypto-vendor-D1XRGppi.js";import"./ui-vendor-IhB9Znpc.js";const $=r(({serverId:s,fetchWithAuth:l,apiBaseUrl:d})=>{const[p,x]=c.useState([]),[n,v]=c.useState("pending"),[g,C]=c.useState("all"),[S,h]=c.useState(null),[R,a]=c.useState(!0),[k,w]=c.useState({pending:0,resolved:0,dismissed:0,total:0}),m=r(async()=>{a(!0);try{const i=new URLSearchParams({server:s,status:n!=="all"?n:"",report_type:g!=="all"?g:""}),f=await l(`${d}/moderation/reports/?${i}`);if(f.ok){const y=await f.json();x(y.results||y)}}catch{}a(!1)},"loadReports"),b=r(async()=>{try{const i=await l(`${d}/moderation/reports/stats/${s}/`);if(i.ok){const f=await i.json();w(f)}}catch{}},"loadStats");return{reports:p,filter:n,setFilter:v,typeFilter:g,setTypeFilter:C,selectedReport:S,setSelectedReport:h,loading:R,stats:k,loadReports:m,loadStats:b,handleReport:r(async(i,f,y="")=>{try{(await l(`${d}/moderation/reports/${i}/handle/`,{method:"POST",body:JSON.stringify({action:f,reason:y,moderator_notes:y})})).ok?(m(),b(),h(null)):U.error("❌ Failed to handle report")}catch{}},"handleReport"),getReportIcon:r(i=>{switch(i){case"message":return e.jsx(D,{});case"user":return e.jsx(z,{});case"server":return e.jsx(u,{});default:return e.jsx(u,{})}},"getReportIcon"),getReportBadgeColor:r(i=>{switch(i){case"pending":return"#f0b132";case"resolved":return"#43b581";case"dismissed":return"#72767d";default:return"#5865f2"}},"getReportBadgeColor"),getSeverityColor:r(i=>{switch(i){case"low":return"#43b581";case"medium":return"#f0b132";case"high":return"#ed4245";case"critical":return"#a12929";default:return"#72767d"}},"getSeverityColor")}},"useReportSystem"),t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,backdropFilter:"blur(5px)"},panel:{backgroundColor:"#2b2d31",borderRadius:"12px",width:"90%",maxWidth:"1000px",maxHeight:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.5)",overflow:"hidden"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #1e1f22"},headerLeft:{display:"flex",alignItems:"center",gap:"12px"},headerIcon:{fontSize:"24px",color:"#f0b132"},title:{margin:0,color:"#fff",fontSize:"24px",fontWeight:"600"},closeButton:{background:"none",border:"none",color:"#b9bbbe",cursor:"pointer",fontSize:"24px",padding:"8px"},statsGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"16px",padding:"20px",borderBottom:"1px solid #1e1f22"},statCard:{backgroundColor:"#1e1f22",borderRadius:"8px",padding:"16px",textAlign:"center"},statIcon:{fontSize:"32px",marginBottom:"8px"},statValue:{fontSize:"28px",fontWeight:"bold",color:"#fff",marginBottom:"4px"},statLabel:{fontSize:"13px",color:"#b9bbbe"},filters:{padding:"16px 20px",borderBottom:"1px solid #1e1f22",backgroundColor:"#1e1f22"},filterGroup:{display:"flex",alignItems:"center",gap:"12px"},filterIcon:{color:"#b9bbbe",fontSize:"16px"},filterSelect:{backgroundColor:"#2b2d31",border:"1px solid #1e1f22",borderRadius:"6px",padding:"8px 12px",color:"#fff",fontSize:"14px",cursor:"pointer"},reportsList:{flex:1,overflowY:"auto",padding:"20px"},loading:{textAlign:"center",color:"#b9bbbe",padding:"40px",fontSize:"14px"},empty:{textAlign:"center",color:"#b9bbbe",padding:"60px"},emptyIcon:{fontSize:"48px",marginBottom:"16px",opacity:.5},reportCard:{backgroundColor:"#1e1f22",borderRadius:"8px",padding:"16px",marginBottom:"12px",cursor:"pointer",transition:"background-color 0.2s",":hover":{backgroundColor:"#2b2d31"}},reportHeader:{display:"flex",alignItems:"flex-start",gap:"12px",marginBottom:"12px"},reportIcon:{fontSize:"20px",color:"#f0b132",marginTop:"4px"},reportInfo:{flex:1},reportTitle:{color:"#fff",fontSize:"16px",fontWeight:"600",marginBottom:"4px"},reportMeta:{color:"#72767d",fontSize:"13px",display:"flex",gap:"8px"},reportBadges:{display:"flex",gap:"8px"},badge:{padding:"4px 8px",borderRadius:"4px",fontSize:"11px",fontWeight:"600",color:"#fff",textTransform:"uppercase"},reportContent:{paddingLeft:"32px"},reportText:{color:"#b9bbbe",fontSize:"14px",margin:"0 0 12px 0"},reportedContent:{backgroundColor:"#2b2d31",padding:"12px",borderRadius:"6px",borderLeft:"3px solid #ed4245",marginBottom:"12px"},reportedUser:{display:"flex",alignItems:"center",gap:"8px",color:"#b9bbbe",fontSize:"13px"},modalOverlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10001},modal:{backgroundColor:"#2b2d31",borderRadius:"12px",width:"90%",maxWidth:"600px",maxHeight:"80vh",display:"flex",flexDirection:"column",overflow:"hidden"},modalHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #1e1f22"},modalTitle:{margin:0,color:"#fff",fontSize:"20px",fontWeight:"600"},modalClose:{background:"none",border:"none",color:"#b9bbbe",cursor:"pointer",fontSize:"20px"},modalContent:{flex:1,overflowY:"auto",padding:"20px"},detailRow:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 0",borderBottom:"1px solid #1e1f22",color:"#fff",fontSize:"14px"},detailSection:{marginTop:"20px"},detailText:{color:"#b9bbbe",fontSize:"14px",marginTop:"8px",lineHeight:"1.5"},messageBox:{backgroundColor:"#1e1f22",padding:"12px",borderRadius:"6px",borderLeft:"3px solid #ed4245",color:"#fff",fontSize:"14px",marginTop:"8px"},modalActions:{display:"flex",gap:"12px",padding:"16px 20px",borderTop:"1px solid #1e1f22",flexWrap:"wrap"},actionBtn:{flex:1,backgroundColor:"#43b581",color:"#fff",border:"none",borderRadius:"6px",padding:"10px 16px",cursor:"pointer",fontSize:"14px",fontWeight:"600",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",minWidth:"120px"}},V=r(({report:s,onClose:l,onHandle:d,getReportBadgeColor:p,getSeverityColor:x})=>s?e.jsx("div",{style:t.modalOverlay,onClick:l,children:e.jsxs("div",{style:t.modal,onClick:r(n=>n.stopPropagation(),"onClick"),children:[e.jsxs("div",{style:t.modalHeader,children:[e.jsx("h3",{style:t.modalTitle,children:"Report Details"}),e.jsx("button",{onClick:l,style:t.modalClose,children:e.jsx(j,{})})]}),e.jsxs("div",{style:t.modalContent,children:[e.jsxs("div",{style:t.detailRow,children:[e.jsx("strong",{children:"Report Type:"}),e.jsx("span",{children:s.report_type})]}),e.jsxs("div",{style:t.detailRow,children:[e.jsx("strong",{children:"Status:"}),e.jsx("span",{style:{...t.badge,backgroundColor:p(s.status)},children:s.status})]}),e.jsxs("div",{style:t.detailRow,children:[e.jsx("strong",{children:"Severity:"}),e.jsx("span",{style:{...t.badge,backgroundColor:x(s.severity)},children:s.severity||"N/A"})]}),e.jsxs("div",{style:t.detailRow,children:[e.jsx("strong",{children:"Reporter:"}),e.jsx("span",{children:s.reporter_username})]}),e.jsxs("div",{style:t.detailRow,children:[e.jsx("strong",{children:"Reported User:"}),e.jsx("span",{children:s.reported_username||"N/A"})]}),e.jsxs("div",{style:t.detailRow,children:[e.jsx("strong",{children:"Created:"}),e.jsx("span",{children:new Date(s.created_at).toLocaleString()})]}),e.jsxs("div",{style:t.detailSection,children:[e.jsx("strong",{children:"Reason:"}),e.jsx("p",{style:t.detailText,children:s.reason})]}),e.jsxs("div",{style:t.detailSection,children:[e.jsx("strong",{children:"Description:"}),e.jsx("p",{style:t.detailText,children:s.description})]}),s.message_content&&e.jsxs("div",{style:t.detailSection,children:[e.jsx("strong",{children:"Reported Message:"}),e.jsx("div",{style:t.messageBox,children:s.message_content})]}),s.moderator_notes&&e.jsxs("div",{style:t.detailSection,children:[e.jsx("strong",{children:"Moderator Notes:"}),e.jsx("p",{style:t.detailText,children:s.moderator_notes})]})]}),s.status==="pending"&&e.jsxs("div",{style:t.modalActions,children:[e.jsxs("button",{onClick:r(()=>{const n=prompt("Resolution notes (optional):");d(s.id,"resolve",n||"")},"onClick"),style:t.actionBtn,children:[e.jsx(_,{})," Resolve"]}),s.message_id&&e.jsxs("button",{onClick:r(async()=>{await T("Delete this message?")&&d(s.id,"delete_message")},"onClick"),style:{...t.actionBtn,backgroundColor:"#ed4245"},children:[e.jsx(P,{})," Delete Message"]}),s.reported_user&&e.jsxs("button",{onClick:r(async()=>{if(await T("Ban this user?")){const n=prompt("Ban reason:");n&&d(s.id,"ban_user",n)}},"onClick"),style:{...t.actionBtn,backgroundColor:"#a12929"},children:[e.jsx(W,{})," Ban User"]}),e.jsxs("button",{onClick:r(()=>{const n=prompt("Dismiss reason:");n&&d(s.id,"dismiss",n)},"onClick"),style:{...t.actionBtn,backgroundColor:"#72767d"},children:[e.jsx(j,{})," Dismiss"]})]})]})}):null,"ReportDetailModal"),X=r(({serverId:s,fetchWithAuth:l,apiBaseUrl:d,onClose:p})=>{const{reports:x,filter:n,setFilter:v,typeFilter:g,setTypeFilter:C,selectedReport:S,setSelectedReport:h,loading:R,stats:a,loadReports:k,loadStats:w,handleReport:m,getReportIcon:b,getReportBadgeColor:B,getSeverityColor:I}=$({serverId:s,fetchWithAuth:l,apiBaseUrl:d});return c.useEffect(()=>{k(),w()},[s,n,g]),e.jsx("div",{style:t.overlay,onClick:p,children:e.jsxs("div",{style:t.panel,onClick:r(o=>o.stopPropagation(),"onClick"),children:[e.jsxs("div",{style:t.header,children:[e.jsxs("div",{style:t.headerLeft,children:[e.jsx(u,{style:t.headerIcon}),e.jsx("h2",{style:t.title,children:"Report System"})]}),e.jsx("button",{onClick:p,style:t.closeButton,children:e.jsx(j,{})})]}),e.jsxs("div",{style:t.statsGrid,children:[e.jsxs("div",{style:t.statCard,children:[e.jsx(u,{style:{...t.statIcon,color:"#f0b132"}}),e.jsx("div",{style:t.statValue,children:a.pending}),e.jsx("div",{style:t.statLabel,children:"Pending"})]}),e.jsxs("div",{style:t.statCard,children:[e.jsx(_,{style:{...t.statIcon,color:"#43b581"}}),e.jsx("div",{style:t.statValue,children:a.resolved}),e.jsx("div",{style:t.statLabel,children:"Resolved"})]}),e.jsxs("div",{style:t.statCard,children:[e.jsx(j,{style:{...t.statIcon,color:"#72767d"}}),e.jsx("div",{style:t.statValue,children:a.dismissed}),e.jsx("div",{style:t.statLabel,children:"Dismissed"})]}),e.jsxs("div",{style:t.statCard,children:[e.jsx(A,{style:{...t.statIcon,color:"#5865f2"}}),e.jsx("div",{style:t.statValue,children:a.total}),e.jsx("div",{style:t.statLabel,children:"Total Reports"})]})]}),e.jsx("div",{style:t.filters,children:e.jsxs("div",{style:t.filterGroup,children:[e.jsx(M,{style:t.filterIcon}),e.jsxs("select",{value:n,onChange:r(o=>v(o.target.value),"onChange"),style:t.filterSelect,children:[e.jsx("option",{value:"all",children:"All Reports"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"resolved",children:"Resolved"}),e.jsx("option",{value:"dismissed",children:"Dismissed"})]}),e.jsxs("select",{value:g,onChange:r(o=>C(o.target.value),"onChange"),style:t.filterSelect,children:[e.jsx("option",{value:"all",children:"All Types"}),e.jsx("option",{value:"message",children:"Messages"}),e.jsx("option",{value:"user",children:"Users"}),e.jsx("option",{value:"server",children:"Server"})]})]})}),e.jsx("div",{style:t.reportsList,children:R?e.jsx("div",{style:t.loading,children:"Loading reports..."}):x.length===0?e.jsxs("div",{style:t.empty,children:[e.jsx(u,{style:t.emptyIcon}),e.jsx("p",{children:"No reports found"})]}):x.map(o=>e.jsxs("div",{style:t.reportCard,onClick:r(()=>h(o),"onClick"),children:[e.jsxs("div",{style:t.reportHeader,children:[e.jsx("div",{style:t.reportIcon,children:b(o.report_type)}),e.jsxs("div",{style:t.reportInfo,children:[e.jsx("div",{style:t.reportTitle,children:o.reason||`${o.report_type} Report`}),e.jsxs("div",{style:t.reportMeta,children:[e.jsxs("span",{children:["By: ",o.reporter_username||"Unknown"]}),e.jsx("span",{children:"•"}),e.jsx("span",{children:new Date(o.created_at).toLocaleString()})]})]}),e.jsxs("div",{style:t.reportBadges,children:[e.jsx("span",{style:{...t.badge,backgroundColor:B(o.status)},children:o.status}),o.severity&&e.jsx("span",{style:{...t.badge,backgroundColor:I(o.severity)},children:o.severity})]})]}),e.jsxs("div",{style:t.reportContent,children:[e.jsx("p",{style:t.reportText,children:o.description}),o.message_content&&e.jsxs("div",{style:t.reportedContent,children:[e.jsx("strong",{children:"Reported Content:"}),e.jsx("p",{children:o.message_content})]}),o.reported_username&&e.jsxs("div",{style:t.reportedUser,children:[e.jsx(z,{}),e.jsxs("span",{children:["Reported User: ",o.reported_username]})]})]})]},o.id))}),e.jsx(V,{report:S,onClose:r(()=>h(null),"onClose"),onHandle:m,getReportBadgeColor:B,getSeverityColor:I})]})})},"ReportSystemPanel");export{X as default};
