var $=Object.defineProperty;var n=(h,p)=>$(h,"name",{value:p,configurable:!0});import{r as a,j as e}from"./react-core-Djgtqrmb.js";import{t as b}from"./index-D0nbcjO7.js";import"./media-vendor-CxFPycob.js";import"./router-vendor-gmJ9Mn-1.js";import"./state-vendor-CbW2fAN9.js";import"./crypto-vendor-D1XRGppi.js";import"./icons-vendor-BMXAt4pj.js";import"./ui-vendor-IhB9Znpc.js";const J=n(({onSend:h,onCancel:p})=>{const[c,f]=a.useState(!1),[r,l]=a.useState(!1),[v,d]=a.useState(0),[i,x]=a.useState(null),[u,Y]=a.useState(null),[y,j]=a.useState([]),[T,E]=a.useState(0),[O,M]=a.useState(0),[R,m]=a.useState(0),L=a.useRef(null),C=-80;a.useEffect(()=>{let s;return c&&(s=setInterval(()=>{d(t=>t+1)},1e3)),()=>clearInterval(s)},[c]);const B=n(async()=>{try{const s=await navigator.mediaDevices.getUserMedia({audio:!0}),t=new MediaRecorder(s),o=[];t.ondataavailable=S=>{o.push(S.data),K()},t.onstop=()=>{const S=new Blob(o,{type:"audio/webm"});x(S),s.getTracks().forEach(W=>W.stop())},t.start(100),Y(t),f(!0),l(!1),d(0)}catch{b.error("âŒ Mikrofon eriÅŸimi reddedildi")}},"startRecording"),I=n(()=>{u&&c&&(u.stop(),f(!1),l(!1))},"stopRecording"),N=n(()=>{u&&c&&u.stop(),f(!1),l(!1),x(null),d(0),j([]),m(0),p?.()},"cancelRecording"),w=n(s=>{s.preventDefault();const t=s.touches?s.touches[0].clientY:s.clientY;E(t),M(t),m(0),B()},"handleRecordStart"),k=n(s=>{if(!c||r)return;const t=s.touches?s.touches[0].clientY:s.clientY;M(t);const o=t-T;m(o),o<C&&(l(!0),b.success("ðŸ”’ KayÄ±t kilitlendi"))},"handleRecordMove"),g=n(s=>{s.preventDefault(),!r&&c&&(N(),b.info("KayÄ±t iptal edildi")),m(0)},"handleRecordEnd"),U=n(()=>{i&&(h?.(i,v),x(null),d(0),j([]))},"sendVoiceMessage"),K=n(()=>{j(s=>[...s,Math.random()*100].slice(-50))},"updateWaveform"),D=n(s=>{const t=Math.floor(s/60),o=s%60;return`${t}:${o.toString().padStart(2,"0")}`},"formatTime");return e.jsxs("div",{className:"voice-message-container",children:[!c&&!i&&e.jsxs("button",{ref:L,className:"btn-start-recording",onMouseDown:w,onMouseMove:k,onMouseUp:g,onMouseLeave:g,onTouchStart:w,onTouchMove:k,onTouchEnd:g,style:{cursor:"pointer",userSelect:"none",WebkitUserSelect:"none",touchAction:"none"},children:[e.jsx("span",{className:"mic-icon",children:"ðŸŽ¤"}),e.jsx("span",{children:"BasÄ±lÄ± Tut"})]}),c&&e.jsxs("div",{className:"recording-ui",children:[!r&&e.jsxs("div",{className:"swipe-indicator",style:{opacity:Math.max(0,Math.min(1,-R/80)),transform:`translateY(${Math.max(R,-100)}px)`},children:[e.jsx("div",{className:"lock-icon",children:"ðŸ”’"}),e.jsx("div",{className:"swipe-text",children:"YukarÄ± kaydÄ±r"})]}),r&&e.jsxs("div",{className:"locked-indicator",children:[e.jsx("span",{className:"lock-icon",children:"ðŸ”’"}),e.jsx("span",{children:"Kilitli"})]}),e.jsx("div",{className:"waveform",children:y.map((s,t)=>e.jsx("div",{className:"waveform-bar",style:{height:`${s}%`}},t))}),e.jsxs("div",{className:"recording-info",children:[e.jsx("span",{className:"recording-indicator",children:"ðŸ”´"}),e.jsx("span",{className:"recording-time",children:D(v)})]}),e.jsxs("div",{className:"recording-controls",children:[e.jsx("button",{className:"btn-cancel",onClick:N,children:"Ä°ptal"}),r&&e.jsx("button",{className:"btn-stop",onClick:I,children:"Durdur"})]})]}),i&&!c&&e.jsxs("div",{className:"preview-ui",children:[e.jsx("audio",{controls:!0,src:URL.createObjectURL(i)}),e.jsx("div",{className:"preview-info",children:e.jsxs("span",{children:["Sesli mesaj â€¢ ",D(v)]})}),e.jsxs("div",{className:"preview-controls",children:[e.jsx("button",{className:"btn-cancel",onClick:N,children:"Sil"}),e.jsx("button",{className:"btn-send",onClick:U,children:"GÃ¶nder ðŸ“¤"})]})]})]})},"VoiceMessage");export{J as default};
