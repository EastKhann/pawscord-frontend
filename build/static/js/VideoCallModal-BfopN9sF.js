var w=Object.defineProperty;var a=(i,l)=>w(i,"name",{value:l,configurable:!0});import{r,j as e}from"./react-core-Djgtqrmb.js";import{az as R,cq as F,b2 as V,a as B,bL as z,E as A,bb as M,bK as P,cr as D}from"./icons-vendor-BW7dxHkX.js";import{c as K}from"./index-BT6pEMKq.js";import"./media-vendor-CxFPycob.js";import"./router-vendor-ClgLnMjk.js";import"./state-vendor-BRqaXHJQ.js";import"./crypto-vendor-D1XRGppi.js";import"./ui-vendor-IhB9Znpc.js";const G=a(i=>{const l=Math.floor(i/60),s=i%60;return`${l.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`},"formatDuration");function L(i,l,s){const[y,u]=r.useState(!1),[f,v]=r.useState(!1),[h,d]=r.useState(""),[p,g]=r.useState(""),[x,o]=r.useState({cameras:[],microphones:[]}),[m,j]=r.useState("720p"),n=r.useRef(null),c=r.useRef(null),I=r.useRef(null);return r.useEffect(()=>{i&&(async()=>{try{const b=await navigator.mediaDevices.enumerateDevices(),C=b.filter(S=>S.kind==="videoinput"),k=b.filter(S=>S.kind==="audioinput");o({cameras:C,microphones:k}),C.length>0&&!h&&d(C[0].deviceId),k.length>0&&!p&&g(k[0].deviceId)}catch{}})()},[i]),r.useEffect(()=>{n.current&&l&&(n.current.srcObject=l)},[l]),r.useEffect(()=>{c.current&&s&&(c.current.srcObject=s)},[s]),{isFullscreen:y,showSettings:f,setShowSettings:v,selectedCamera:h,setSelectedCamera:d,selectedMicrophone:p,setSelectedMicrophone:g,devices:x,videoQuality:m,setVideoQuality:j,localVideoRef:n,remoteVideoRef:c,containerRef:I,toggleFullscreen:a(async()=>{if(document.fullscreenElement)await document.exitFullscreen(),u(!1);else try{await I.current?.requestFullscreen(),u(!0)}catch{}},"toggleFullscreen")}}a(L,"useVideoCall");const t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.95)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center"},container:{width:"100%",height:"100%",backgroundColor:"#1e1f22",display:"flex",flexDirection:"column",position:"relative"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 24px",backgroundColor:"#2f3136",borderBottom:"1px solid #1e1f22"},headerInfo:{display:"flex",alignItems:"center",gap:"12px"},avatar:{width:"40px",height:"40px",borderRadius:"50%",backgroundColor:"#5865f2",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"18px",fontWeight:"bold",color:"#fff"},userInfo:{display:"flex",flexDirection:"column",gap:"4px"},username:{fontSize:"16px",fontWeight:"bold",color:"#fff"},status:{fontSize:"13px",color:"#b9bbbe"},headerActions:{display:"flex",gap:"8px"},headerButton:{backgroundColor:"transparent",border:"none",color:"#b9bbbe",fontSize:"18px",cursor:"pointer",padding:"8px",borderRadius:"4px",transition:"background-color 0.2s"},closeButton:{backgroundColor:"#f04747",border:"none",color:"#fff",fontSize:"18px",cursor:"pointer",padding:"8px 12px",borderRadius:"4px"},settingsPanel:{position:"absolute",top:"70px",right:"24px",backgroundColor:"#2f3136",border:"1px solid #1e1f22",borderRadius:"8px",padding:"16px",width:"280px",zIndex:100,boxShadow:"0 8px 16px rgba(0,0,0,0.4)"},settingsTitle:{fontSize:"14px",fontWeight:"bold",color:"#fff",marginBottom:"12px"},settingGroup:{marginBottom:"12px"},settingLabel:{display:"block",fontSize:"12px",color:"#b9bbbe",marginBottom:"6px"},settingSelect:{width:"100%",backgroundColor:"#40444b",border:"1px solid #1e1f22",borderRadius:"4px",padding:"8px",color:"#dcddde",fontSize:"13px"},videoGrid:{flex:1,position:"relative",backgroundColor:"#000"},remoteVideoContainer:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},remoteVideo:{width:"100%",height:"100%",objectFit:"contain"},videoPlaceholder:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"16px",color:"#b9bbbe"},placeholderAvatar:{width:"120px",height:"120px",borderRadius:"50%",backgroundColor:"#5865f2",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"48px",fontWeight:"bold",color:"#fff"},localVideoContainer:{position:"absolute",bottom:"100px",right:"24px",width:"240px",height:"180px",borderRadius:"8px",overflow:"hidden",border:"2px solid #5865f2",backgroundColor:"#000",boxShadow:"0 4px 12px rgba(0,0,0,0.5)"},localVideo:{width:"100%",height:"100%",objectFit:"cover",transform:"scaleX(-1)"},localVideoPlaceholder:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#2f3136"},placeholderAvatarSmall:{width:"60px",height:"60px",borderRadius:"50%",backgroundColor:"#5865f2",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"24px",fontWeight:"bold",color:"#fff"},controls:{display:"flex",justifyContent:"center",alignItems:"center",gap:"16px",padding:"24px",backgroundColor:"#2f3136"},controlButton:{width:"56px",height:"56px",borderRadius:"50%",border:"none",backgroundColor:"#40444b",color:"#fff",fontSize:"20px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},controlButtonActive:{backgroundColor:"#f04747"},hangupButton:{width:"56px",height:"56px",borderRadius:"50%",border:"none",backgroundColor:"#f04747",color:"#fff",fontSize:"20px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"}},J=a(({isOpen:i,onClose:l,targetUser:s,currentUser:y,localStream:u,remoteStream:f,onToggleVideo:v,onToggleMute:h,isVideoEnabled:d,isMuted:p,callDuration:g=0,callStatus:x="connecting"})=>{const o=L(i,u,f),{overlayProps:m,dialogProps:j}=K({onClose:l,isOpen:i,label:"Video Call"});return i?e.jsx("div",{style:t.overlay,...m,children:e.jsxs("div",{ref:o.containerRef,style:t.container,...j,children:[e.jsxs("div",{style:t.header,children:[e.jsxs("div",{style:t.headerInfo,children:[e.jsx("div",{style:t.avatar,children:s?.username?.[0]?.toUpperCase()||"U"}),e.jsxs("div",{style:t.userInfo,children:[e.jsx("span",{style:t.username,children:s?.username||"Unknown"}),e.jsxs("span",{style:t.status,children:[x==="connecting"&&"ðŸ”„ BaÄŸlanÄ±yor...",x==="active"&&`â±ï¸ ${G(g)}`,x==="ended"&&"ðŸ“ž Arama sona erdi"]})]})]}),e.jsxs("div",{style:t.headerActions,children:[e.jsx("button",{onClick:a(()=>o.setShowSettings(!o.showSettings),"onClick"),style:t.headerButton,title:"Ayarlar",children:e.jsx(R,{})}),e.jsx("button",{onClick:o.toggleFullscreen,style:t.headerButton,title:"Tam ekran",children:o.isFullscreen?e.jsx(F,{}):e.jsx(V,{})}),e.jsx("button",{onClick:l,style:t.closeButton,title:"Kapat",children:e.jsx(B,{})})]})]}),o.showSettings&&e.jsxs("div",{style:t.settingsPanel,children:[e.jsx("h4",{style:t.settingsTitle,children:"Video AyarlarÄ±"}),e.jsxs("div",{style:t.settingGroup,children:[e.jsx("label",{style:t.settingLabel,children:"Kamera"}),e.jsx("select",{value:o.selectedCamera,onChange:a(n=>o.setSelectedCamera(n.target.value),"onChange"),style:t.settingSelect,children:o.devices.cameras.map((n,c)=>e.jsx("option",{value:n.deviceId,children:n.label||`Kamera ${c+1}`},n.deviceId))})]}),e.jsxs("div",{style:t.settingGroup,children:[e.jsx("label",{style:t.settingLabel,children:"Mikrofon"}),e.jsx("select",{value:o.selectedMicrophone,onChange:a(n=>o.setSelectedMicrophone(n.target.value),"onChange"),style:t.settingSelect,children:o.devices.microphones.map((n,c)=>e.jsx("option",{value:n.deviceId,children:n.label||`Mikrofon ${c+1}`},n.deviceId))})]}),e.jsxs("div",{style:t.settingGroup,children:[e.jsx("label",{style:t.settingLabel,children:"Kalite"}),e.jsxs("select",{value:o.videoQuality,onChange:a(n=>o.setVideoQuality(n.target.value),"onChange"),style:t.settingSelect,children:[e.jsx("option",{value:"480p",children:"480p (DÃ¼ÅŸÃ¼k)"}),e.jsx("option",{value:"720p",children:"720p (Orta)"}),e.jsx("option",{value:"1080p",children:"1080p (YÃ¼ksek)"})]})]})]}),e.jsxs("div",{style:t.videoGrid,children:[e.jsx("div",{style:t.remoteVideoContainer,children:f?e.jsx("video",{ref:o.remoteVideoRef,autoPlay:!0,playsInline:!0,style:t.remoteVideo}):e.jsxs("div",{style:t.videoPlaceholder,children:[e.jsx("div",{style:t.placeholderAvatar,children:s?.username?.[0]?.toUpperCase()||"U"}),e.jsx("p",{children:"Kamera aÃ§Ä±lmadÄ±"})]})}),e.jsx("div",{style:t.localVideoContainer,children:u&&d?e.jsx("video",{ref:o.localVideoRef,autoPlay:!0,playsInline:!0,muted:!0,style:t.localVideo}):e.jsx("div",{style:t.localVideoPlaceholder,children:e.jsx("div",{style:t.placeholderAvatarSmall,children:y?.[0]?.toUpperCase()||"M"})})})]}),e.jsxs("div",{style:t.controls,children:[e.jsx("button",{onClick:h,style:{...t.controlButton,...p&&t.controlButtonActive},title:p?"Mikrofonu aÃ§":"Mikrofonu kapat",children:p?e.jsx(z,{}):e.jsx(A,{})}),e.jsx("button",{onClick:v,style:{...t.controlButton,...!d&&t.controlButtonActive},title:d?"KamerayÄ± kapat":"KamerayÄ± aÃ§",children:d?e.jsx(M,{}):e.jsx(P,{})}),e.jsx("button",{onClick:l,style:t.hangupButton,title:"AramayÄ± sonlandÄ±r",children:e.jsx(D,{style:{transform:"rotate(135deg)"}})})]})]})}):null},"VideoCallModal");export{J as default};
