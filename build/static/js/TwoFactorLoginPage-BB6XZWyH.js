import{r as t,n as e}from"./react-core-zXIKm1Jm.js";import{b as S,c as C}from"./router-vendor-ltdGXAv4.js";import{E as A,a2 as v,a3 as z}from"./icons-vendor-BBdoVeJd.js";import{a as F,A as L}from"./index-BG_AnZTm.js";import"./editor-vendor-DiU449Dh.js";import"./media-vendor-BSOZ7IB3.js";import"./crypto-vendor-D_AcF0lD.js";import"./state-vendor-8NbFPBhQ.js";const P=()=>{const{login:k}=F(),a=S(),[m]=C(),[u,y]=t.useState(""),[n,g]=t.useState(!1),[f,h]=t.useState(""),[b,s]=t.useState(""),[l,x]=t.useState(!1),c=m.get("temp_token");if(t.useEffect(()=>{c||(console.warn("üîê [2FA] No temp_token found, redirecting to login"),a("/login"))},[c,a]),!c)return null;const j=async r=>{r.preventDefault(),s(""),x(!0);const d=n?f:u;if(!d){s("Kod gerekli"),x(!1);return}try{console.log("üîê [2FA] Verifying code with temp_token...");const p=await fetch(`${L}/security/2fa/verify-login/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({temp_token:c,code:d})}),i=await p.json();p.ok&&i.verified?(console.log("‚úÖ [2FA] Verification successful, logging in..."),k(i.access,i.refresh),a("/")):(console.error("‚ùå [2FA] Verification failed:",i),s(i.error||"Ge√ßersiz kod"))}catch(p){console.error("‚ùå [2FA] Network error:",p),s("Baƒülantƒ± hatasƒ± olu≈ütu")}finally{x(!1)}};return e.jsx("div",{style:o.container,children:e.jsxs("div",{style:o.card,children:[e.jsxs("button",{onClick:()=>a("/login"),style:o.backButton,children:[e.jsx(A,{})," Geri"]}),e.jsx(v,{style:o.icon}),e.jsx("h2",{style:o.title,children:"ƒ∞ki Fakt√∂rl√º Doƒürulama"}),e.jsx("p",{style:o.subtitle,children:n?"Yedek kodunuzu girin":"Authenticator uygulamanƒ±zdaki 6 haneli kodu girin"}),e.jsxs("form",{onSubmit:j,style:o.form,children:[n?e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"text",placeholder:"Yedek kod",value:f,onChange:r=>h(r.target.value),style:o.backupInput,autoFocus:!0,disabled:l}),e.jsx("button",{type:"button",onClick:()=>g(!1),style:o.backupLink,children:"‚Üê Authenticator kodu kullan"})]}):e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"text",maxLength:6,placeholder:"000000",value:u,onChange:r=>{const d=r.target.value.replace(/\D/g,"");y(d)},style:o.codeInput,autoFocus:!0,disabled:l}),e.jsxs("button",{type:"button",onClick:()=>g(!0),style:o.backupLink,children:[e.jsx(z,{})," Yedek kod kullan"]})]}),b&&e.jsxs("div",{style:o.error,children:["‚ùå ",b]}),e.jsx("button",{type:"submit",style:o.submitButton,disabled:l||!n&&u.length!==6||n&&!f,children:l?"Doƒürulanƒ±yor...":"Giri≈ü Yap"})]}),e.jsxs("div",{style:o.info,children:[e.jsx("p",{style:o.infoTitle,children:"üí° ƒ∞pu√ßlarƒ±:"}),e.jsxs("ul",{style:o.infoList,children:[e.jsx("li",{children:"Kod s√ºrekli deƒüi≈üir (30 saniyede bir)"}),e.jsx("li",{children:"Telefonunuzu kaybettiyseniz yedek kod kullanƒ±n"}),e.jsx("li",{children:"Her yedek kod sadece bir kere kullanƒ±labilir"})]})]})]})})},o={container:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#1e1f22",padding:"20px"},card:{backgroundColor:"#2b2d31",borderRadius:"12px",padding:"40px",maxWidth:"500px",width:"100%",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.5)",position:"relative"},backButton:{position:"absolute",top:"20px",left:"20px",background:"none",border:"none",color:"#b9bbbe",cursor:"pointer",fontSize:"16px",display:"flex",alignItems:"center",gap:"8px",transition:"color 0.2s"},icon:{fontSize:"64px",color:"#5865f2",display:"block",margin:"0 auto 20px"},title:{color:"#fff",fontSize:"28px",textAlign:"center",margin:"0 0 10px 0"},subtitle:{color:"#b9bbbe",fontSize:"16px",textAlign:"center",marginBottom:"30px"},form:{display:"flex",flexDirection:"column",gap:"15px"},codeInput:{backgroundColor:"#1e1f22",border:"2px solid #5865f2",borderRadius:"6px",padding:"16px",color:"#fff",fontSize:"32px",textAlign:"center",letterSpacing:"8px",fontFamily:"monospace",outline:"none"},backupInput:{backgroundColor:"#1e1f22",border:"1px solid #1e1f22",borderRadius:"6px",padding:"12px",color:"#fff",fontSize:"16px",textAlign:"center",fontFamily:"monospace",outline:"none"},backupLink:{background:"none",border:"none",color:"#5865f2",cursor:"pointer",fontSize:"14px",textAlign:"center",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},error:{backgroundColor:"#da373c",color:"#fff",padding:"12px",borderRadius:"6px",fontSize:"14px",textAlign:"center"},submitButton:{backgroundColor:"#5865f2",color:"#fff",border:"none",borderRadius:"6px",padding:"12px",fontSize:"16px",fontWeight:"bold",cursor:"pointer",transition:"background-color 0.2s"},info:{backgroundColor:"#1e1f22",borderRadius:"8px",padding:"15px",marginTop:"20px"},infoTitle:{color:"#fff",fontSize:"14px",fontWeight:"bold",margin:"0 0 10px 0"},infoList:{color:"#b9bbbe",fontSize:"14px",margin:0,paddingLeft:"20px"}};export{P as default};
