import{r as i,n as e}from"./react-core-Cj7FUMmY.js";import{a5 as k,a as I,aA as w}from"./icons-vendor-TGltgKsJ.js";import{t as r}from"./index-DmJP8UbA.js";import"./editor-vendor-D9c4a6XZ.js";import"./media-vendor-BsD1gqUZ.js";import"./router-vendor-QeioVw-9.js";import"./state-vendor-MN-5i-Jz.js";import"./crypto-vendor-DK-7ILyQ.js";const E=({fetchWithAuth:p,apiBaseUrl:u,onClose:x})=>{const[s,l]=i.useState(1),[f,h]=i.useState(""),[m,g]=i.useState(""),[y,b]=i.useState([]),[a,C]=i.useState(""),[c,d]=i.useState(!1),j=async()=>{d(!0);try{const n=await(await p(`${u}/auth/2fa/enable/`,{method:"POST"})).json();h(n.qr_code),g(n.secret),l(2),r.success("2FA setup initiated")}catch{r.error("Failed to start 2FA setup")}finally{d(!1)}},v=async()=>{if(!a||a.length!==6){r.error("Please enter a 6-digit code");return}d(!0);try{const n=await(await p(`${u}/auth/2fa/verify-setup/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:a})})).json();n.success?(b(n.backup_codes||[]),l(4),r.success("2FA enabled successfully!")):r.error("Invalid verification code")}catch{r.error("Failed to verify code")}finally{d(!1)}},S=()=>{navigator.clipboard.writeText(y.join(`
`)),r.success("Backup codes copied to clipboard")};return e.jsx("div",{style:t.overlay,children:e.jsxs("div",{style:t.modal,children:[e.jsxs("div",{style:t.header,children:[e.jsxs("div",{style:t.headerLeft,children:[e.jsx(k,{style:{marginRight:"10px",color:"#43b581"}}),e.jsx("h2",{style:t.title,children:"Two-Factor Authentication Setup"})]}),e.jsx("button",{onClick:x,style:t.closeButton,children:e.jsx(I,{})})]}),e.jsxs("div",{style:t.content,children:[s===1&&e.jsxs("div",{style:t.stepContainer,children:[e.jsx("div",{style:t.stepIcon,children:"ðŸ”’"}),e.jsx("h3",{style:t.stepTitle,children:"Enhance Your Account Security"}),e.jsx("p",{style:t.stepDescription,children:"Two-factor authentication adds an extra layer of security to your account. You'll need your phone's authentication app to complete setup."}),e.jsxs("div",{style:t.requirements,children:[e.jsx("div",{style:t.requirementItem,children:"âœ“ Install an authenticator app (Google Authenticator, Authy, etc.)"}),e.jsx("div",{style:t.requirementItem,children:"âœ“ Have your phone ready to scan a QR code"}),e.jsx("div",{style:t.requirementItem,children:"âœ“ Save backup codes in a secure location"})]}),e.jsx("button",{onClick:j,style:t.primaryButton,disabled:c,children:c?"Starting...":"Begin Setup"})]}),s===2&&e.jsxs("div",{style:t.stepContainer,children:[e.jsx("div",{style:t.stepIcon,children:"ðŸ“±"}),e.jsx("h3",{style:t.stepTitle,children:"Scan QR Code"}),e.jsx("p",{style:t.stepDescription,children:"Open your authenticator app and scan this QR code."}),f&&e.jsx("div",{style:t.qrContainer,children:e.jsx("img",{src:f,alt:"QR Code",style:t.qrCode})}),e.jsxs("div",{style:t.manualEntry,children:[e.jsx("div",{style:t.manualLabel,children:"Or enter this code manually:"}),e.jsx("div",{style:t.secretCode,children:m})]}),e.jsx("button",{onClick:()=>l(3),style:t.primaryButton,children:"Next Step"})]}),s===3&&e.jsxs("div",{style:t.stepContainer,children:[e.jsx("div",{style:t.stepIcon,children:"ðŸ”‘"}),e.jsx("h3",{style:t.stepTitle,children:"Verify Setup"}),e.jsx("p",{style:t.stepDescription,children:"Enter the 6-digit code from your authenticator app to complete setup."}),e.jsx("input",{type:"text",value:a,onChange:o=>C(o.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",style:t.codeInput,maxLength:6}),e.jsx("button",{onClick:v,style:t.primaryButton,disabled:c,children:c?"Verifying...":"Verify & Enable 2FA"})]}),s===4&&e.jsxs("div",{style:t.stepContainer,children:[e.jsx("div",{style:t.stepIcon,children:"âœ…"}),e.jsx("h3",{style:t.stepTitle,children:"Setup Complete!"}),e.jsx("p",{style:t.stepDescription,children:"Save these backup codes in a secure location. You can use them if you lose access to your authenticator app."}),e.jsx("div",{style:t.backupCodesContainer,children:y.map((o,n)=>e.jsx("div",{style:t.backupCode,children:o},n))}),e.jsxs("button",{onClick:S,style:t.copyButton,children:[e.jsx(w,{style:{marginRight:"8px"}}),"Copy Backup Codes"]}),e.jsx("button",{onClick:x,style:t.primaryButton,children:"Done"})]})]})]})})},t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.9)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999},modal:{backgroundColor:"#1e1e1e",borderRadius:"8px",width:"90%",maxWidth:"550px",maxHeight:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.6)"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #2c2f33"},headerLeft:{display:"flex",alignItems:"center"},title:{margin:0,fontSize:"18px",color:"#ffffff"},closeButton:{background:"none",border:"none",color:"#99aab5",cursor:"pointer",fontSize:"20px",padding:"5px"},content:{padding:"32px",overflowY:"auto",flex:1},stepContainer:{display:"flex",flexDirection:"column",alignItems:"center",gap:"20px"},stepIcon:{fontSize:"64px"},stepTitle:{margin:0,fontSize:"22px",color:"#ffffff",textAlign:"center"},stepDescription:{margin:0,fontSize:"14px",color:"#dcddde",textAlign:"center",lineHeight:"1.5"},requirements:{width:"100%",backgroundColor:"#2c2f33",borderRadius:"8px",padding:"16px",display:"flex",flexDirection:"column",gap:"8px"},requirementItem:{fontSize:"14px",color:"#dcddde"},qrContainer:{backgroundColor:"#ffffff",borderRadius:"8px",padding:"16px"},qrCode:{width:"200px",height:"200px"},manualEntry:{width:"100%",backgroundColor:"#2c2f33",borderRadius:"8px",padding:"16px",textAlign:"center"},manualLabel:{fontSize:"12px",color:"#99aab5",marginBottom:"8px"},secretCode:{fontSize:"16px",fontFamily:"monospace",color:"#5865f2",fontWeight:"600",letterSpacing:"2px"},codeInput:{width:"200px",padding:"16px",fontSize:"24px",textAlign:"center",backgroundColor:"#2c2f33",border:"2px solid #5865f2",borderRadius:"8px",color:"#ffffff",fontFamily:"monospace",letterSpacing:"8px"},backupCodesContainer:{width:"100%",backgroundColor:"#2c2f33",borderRadius:"8px",padding:"16px",display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"12px"},backupCode:{fontSize:"14px",fontFamily:"monospace",color:"#dcddde",backgroundColor:"#1e1e1e",padding:"8px",borderRadius:"4px",textAlign:"center"},primaryButton:{padding:"12px 32px",backgroundColor:"#43b581",border:"none",borderRadius:"4px",color:"#ffffff",cursor:"pointer",fontSize:"16px",fontWeight:"600"},copyButton:{padding:"10px 24px",backgroundColor:"#5865f2",border:"none",borderRadius:"4px",color:"#ffffff",cursor:"pointer",fontSize:"14px",display:"flex",alignItems:"center"}};export{E as default};
