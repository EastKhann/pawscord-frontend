import{R as I,r,j as n}from"./react-vendor-D4QjtNWS.js";import"./vendor-Brv1On52.js";import"./state-vendor-T8XA44Ud.js";import"./perf-vendor-CmoV45_-.js";const G=({onSelect:k,onClose:u,localGifListUrl:c,absoluteHostUrl:w,fetchWithAuth:f})=>{const[i,C]=r.useState(""),[a,g]=r.useState([]),[x,l]=r.useState([]),[m,h]=r.useState(!0),[d,y]=r.useState(null),p=r.useRef(null);r.useEffect(()=>{function e(t){p.current&&!p.current.contains(t.target)&&t.target.textContent!=="GIF"&&u()}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[u]),r.useEffect(()=>{c&&(async()=>{h(!0),y(null);try{const t=await f(c);if(!t.ok)throw new Error(`Yerel API Hatası: ${t.status}`);const s=await t.json();Array.isArray(s)?(g(s),l(s)):(g([]),l([]))}catch(t){console.error("Yerel GIF yükleme hatası:",t),y("GIF koleksiyonu yüklenemedi. Django sunucusunu ve 'gifs' klasörünü kontrol edin.")}finally{h(!1)}})()},[c,f]),r.useEffect(()=>{if(!a.length)return;if(!i){l(a);return}const e=i.toLowerCase(),t=a.filter(s=>{const b=s.substring(s.lastIndexOf("/")+1);return b.substring(0,b.lastIndexOf(".")).toLowerCase().includes(e)});l(t)},[i,a]);const j=e=>{k(e)},v=e=>e.startsWith("http")?e:`${w}${e}`;return n.jsx("div",{style:o.pickerOverlay,children:n.jsxs("div",{style:o.pickerContainer,ref:p,children:[n.jsx("input",{type:"text",placeholder:"Koleksiyonda ara (dosya adına göre)...",value:i,onChange:e=>C(e.target.value),style:o.searchInput,disabled:m||d}),n.jsxs("div",{style:o.gifGrid,children:[d&&n.jsx("p",{style:o.errorText,children:d}),m?n.jsx("p",{style:o.loadingText,children:"Yerel koleksiyon yükleniyor..."}):x.length>0?x.map(e=>n.jsx("div",{style:o.gifWrapper,onClick:()=>j(e),title:e.substring(e.lastIndexOf("/")+1),children:n.jsx("img",{src:v(e),alt:e.substring(e.lastIndexOf("/")+1),style:o.gifImage,onError:t=>{t.target.style.display="none",t.target.parentNode.style.backgroundColor="#444"}})},e)):!d&&n.jsxs("p",{style:o.noResultsText,children:["'",i,"' için sonuç bulunamadı."]})]})]})})},o={pickerOverlay:{position:"fixed",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",zIndex:1500,pointerEvents:"none"},pickerContainer:{position:"absolute",bottom:"100px",width:"400px",height:"350px",backgroundColor:"#2f3136",borderRadius:"8px",boxShadow:"0 5px 15px rgba(0,0,0,0.5)",display:"flex",flexDirection:"column",padding:"10px",pointerEvents:"auto"},searchInput:{width:"calc(100% - 20px)",padding:"10px",marginBottom:"10px",borderRadius:"4px",border:"1px solid #5865f2",backgroundColor:"#444",color:"white",outline:"none",fontSize:"1em"},gifGrid:{flexGrow:1,overflowY:"auto",display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"10px",paddingRight:"5px"},gifWrapper:{width:"100%",paddingTop:"75%",position:"relative",borderRadius:"4px",overflow:"hidden",cursor:"pointer",backgroundColor:"#3a3d43",transition:"transform 0.1s"},gifImage:{position:"absolute",top:0,left:0,width:"100%",height:"100%",objectFit:"cover"},loadingText:{color:"#b9bbbe",gridColumn:"1 / -1",textAlign:"center",marginTop:"50px"},errorText:{color:"#f04747",gridColumn:"1 / -1",textAlign:"center",marginTop:"50px",fontWeight:"bold"},noResultsText:{color:"#b9bbbe",gridColumn:"1 / -1",textAlign:"center",marginTop:"50px"}},O=I.memo(G);export{O as default};
