import{r as l,d as e,cl as u,i as C,az as R,M as z,bv as k,J as D}from"./react-core-DMT_QkRe.js";import{t as n}from"./index-grPt_ios.js";const F=({fetchWithAuth:s,apiBaseUrl:i,onClose:y})=>{const[d,g]=l.useState([]),[E,c]=l.useState(!1),[p,x]=l.useState(!1);l.useEffect(()=>{f()},[]);const f=async()=>{c(!0);try{const r=await(await s(`${i}/api/gdpr/exports/`)).json();g(r.exports||[])}catch{n.error("Failed to load exports")}finally{c(!1)}},b=async()=>{x(!0);try{await s(`${i}/api/gdpr/request-export/`,{method:"POST"}),n.success("Export requested. You will be notified when it's ready (usually within 24 hours)"),f()}catch{n.error("Failed to request export")}finally{x(!1)}},w=async o=>{try{const S=await(await s(`${i}/api/gdpr/exports/${o}/download/`)).blob(),m=window.URL.createObjectURL(S),a=document.createElement("a");a.href=m,a.download=`pawscord_data_export_${o}.zip`,document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(m),document.body.removeChild(a),n.success("Export downloaded")}catch{n.error("Failed to download export")}},h=o=>{switch(o){case"completed":return e.createElement(D,{style:{color:"#43b581"}});case"failed":return e.createElement(k,{style:{color:"#f04747"}});default:return e.createElement(z,{style:{color:"#faa61a"}})}},v=o=>{switch(o){case"pending":return"Processing...";case"completed":return"Ready to Download";case"failed":return"Failed";default:return o}};return e.createElement("div",{style:t.overlay},e.createElement("div",{style:t.modal},e.createElement("div",{style:t.header},e.createElement("div",{style:t.headerLeft},e.createElement(u,{style:{marginRight:"10px",color:"#5865f2"}}),e.createElement("h2",{style:t.title},"GDPR Data Export")),e.createElement("button",{onClick:y,style:t.closeButton},e.createElement(C,null))),e.createElement("div",{style:t.info},e.createElement("p",{style:t.infoText},"Request a complete archive of your data. This includes messages, media, profile information, and activity logs. Exports are usually ready within 24 hours."),e.createElement("button",{onClick:b,disabled:p,style:t.requestButton},p?"Requesting...":"Request New Export")),e.createElement("div",{style:t.content},E?e.createElement("div",{style:t.loading},"Loading exports..."):d.length===0?e.createElement("div",{style:t.empty},e.createElement(u,{style:{fontSize:"48px",color:"#2c2f33",marginBottom:"16px"}}),e.createElement("div",null,"No exports yet"),e.createElement("div",{style:t.emptySubtext},"Request your first data export above")):e.createElement("div",{style:t.exportsList},d.map((o,r)=>e.createElement("div",{key:r,style:t.exportCard},e.createElement("div",{style:t.exportIcon},h(o.status)),e.createElement("div",{style:t.exportInfo},e.createElement("div",{style:t.exportStatus},v(o.status)),e.createElement("div",{style:t.exportMeta},"Requested: ",new Date(o.created_at).toLocaleString()),o.completed_at&&e.createElement("div",{style:t.exportMeta},"Completed: ",new Date(o.completed_at).toLocaleString()),o.file_size&&e.createElement("div",{style:t.exportMeta},"Size: ",(o.file_size/1024/1024).toFixed(2)," MB"),o.expires_at&&e.createElement("div",{style:t.exportMeta},"Expires: ",new Date(o.expires_at).toLocaleDateString())),o.status==="completed"&&e.createElement("button",{onClick:()=>w(o.id),style:t.downloadButton,title:"Download"},e.createElement(R,{style:{marginRight:"6px"}}),"Download")))))))},t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999},modal:{backgroundColor:"#1e1e1e",borderRadius:"8px",width:"90%",maxWidth:"700px",maxHeight:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #2c2f33"},headerLeft:{display:"flex",alignItems:"center"},title:{margin:0,fontSize:"20px",color:"#ffffff"},closeButton:{background:"none",border:"none",color:"#99aab5",cursor:"pointer",fontSize:"20px",padding:"5px"},info:{padding:"20px",borderBottom:"1px solid #2c2f33"},infoText:{fontSize:"14px",color:"#dcddde",lineHeight:"1.6",margin:"0 0 16px 0"},requestButton:{padding:"10px 20px",backgroundColor:"#5865f2",border:"none",borderRadius:"4px",color:"#ffffff",cursor:"pointer",fontSize:"14px",fontWeight:"600",width:"100%"},content:{padding:"20px",overflowY:"auto",flex:1},loading:{textAlign:"center",color:"#99aab5",padding:"40px"},empty:{textAlign:"center",color:"#99aab5",padding:"60px 20px",display:"flex",flexDirection:"column",alignItems:"center"},emptySubtext:{fontSize:"13px",marginTop:"8px"},exportsList:{display:"flex",flexDirection:"column",gap:"12px"},exportCard:{backgroundColor:"#2c2f33",borderRadius:"8px",padding:"16px",display:"flex",gap:"16px",alignItems:"flex-start"},exportIcon:{fontSize:"24px",minWidth:"30px",display:"flex",alignItems:"center",justifyContent:"center"},exportInfo:{flex:1},exportStatus:{fontSize:"16px",fontWeight:"600",color:"#ffffff",marginBottom:"6px"},exportMeta:{fontSize:"13px",color:"#99aab5",marginTop:"4px"},downloadButton:{padding:"8px 16px",backgroundColor:"#43b581",border:"none",borderRadius:"4px",color:"#ffffff",cursor:"pointer",fontSize:"13px",fontWeight:"500",display:"flex",alignItems:"center"}};export{F as default};
