import{r as s,a0 as v,ay as p,cl as F,bV as A,b$ as h,o as C,c0 as P,aX as m,l as x,b_ as M,A as O,aC as G,dw as K}from"./react-core-B6hadH-M.js";import{g as S,t as R}from"./index-D_6pZib5.js";const $=({serverId:r,fetchWithAuth:c,apiBaseUrl:g,isAdmin:I=!1})=>{const[n,i]=s.useState({enabled:!0,sensitivity:"medium",actions:{warn:!0,mute:!0,kick:!1,ban:!1},patterns:{rapidMessages:!0,duplicateContent:!0,mentionSpam:!0,linkSpam:!0,capsLock:!0,zalgoText:!0},thresholds:{messagesPerMinute:10,duplicateThreshold:3,mentionLimit:5,linkLimit:3,capsPercentage:70},whitelist:[],customPatterns:[]}),[l,f]=s.useState({totalDetected:0,todayDetected:0,actionsToken:{warn:0,mute:0,kick:0,ban:0},topOffenders:[],recentDetections:[]}),[T,E]=s.useState(!0),[o,w]=s.useState("overview"),z={low:{messagesPerMinute:15,duplicateThreshold:5,mentionLimit:10,linkLimit:5,capsPercentage:80},medium:{messagesPerMinute:10,duplicateThreshold:3,mentionLimit:5,linkLimit:3,capsPercentage:70},high:{messagesPerMinute:7,duplicateThreshold:2,mentionLimit:3,linkLimit:2,capsPercentage:60},aggressive:{messagesPerMinute:5,duplicateThreshold:2,mentionLimit:2,linkLimit:1,capsPercentage:50}},b=s.useCallback(async()=>{E(!0);const t=g||S();try{const a=await c(`${t}/api/servers/${r}/spam-settings/`);if(a.ok){const u=await a.json();i(y=>({...y,...u}))}}catch(a){console.error("Failed to fetch spam settings:",a)}try{const a=await c(`${t}/api/servers/${r}/spam-stats/`);if(a.ok){const u=await a.json();f(y=>({...y,...u}))}else f({totalDetected:0,todayDetected:0,actionsTaken:{warn:0,mute:0,kick:0,ban:0},topOffenders:[],recentDetections:[]})}catch(a){console.error("Failed to fetch spam stats:",a),f({totalDetected:0,todayDetected:0,actionsTaken:{warn:0,mute:0,kick:0,ban:0},topOffenders:[],recentDetections:[]})}E(!1)},[r,c,g]);s.useEffect(()=>{b()},[b]);const L=t=>{i(a=>({...a,sensitivity:t,thresholds:z[t]}))},D=t=>{i(a=>({...a,patterns:{...a.patterns,[t]:!a.patterns[t]}}))},B=t=>{i(a=>({...a,actions:{...a.actions,[t]:!a.actions[t]}}))},j=async()=>{try{const t=g||S();(await c(`${t}/api/servers/${r}/spam-settings/`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})).ok?R.success("Spam koruma ayarlarÄ± kaydedildi! âœ…"):R.error("Ayarlar kaydedilemedi")}catch(t){console.error("Failed to save settings:",t),R.error("Bir hata oluÅŸtu")}},k=t=>({rapidMessages:React.createElement(K,null),duplicateContent:React.createElement(h,null),mentionSpam:React.createElement(G,null),linkSpam:React.createElement(O,null),capsLock:React.createElement(C,null),zalgoText:React.createElement(M,null)})[t]||React.createElement(p,null),d=t=>({warn:"#faa61a",mute:"#5865f2",kick:"#f04747",ban:"#ed4245"})[t]||"#72767d";return T?React.createElement("div",{style:e.container},React.createElement("div",{style:e.loading},React.createElement(v,{className:"pulse",size:32,color:"#5865f2"}),React.createElement("span",null,"Spam koruma sistemi yÃ¼kleniyor..."))):React.createElement("div",{style:e.container},React.createElement("div",{style:e.header},React.createElement("div",{style:e.headerLeft},React.createElement(p,{size:24,color:"#43b581"}),React.createElement("div",null,React.createElement("h2",{style:e.title},"Spam Koruma Sistemi"),React.createElement("p",{style:e.subtitle},"ML tabanlÄ± akÄ±llÄ± spam algÄ±lama"))),React.createElement("div",{style:e.headerRight},React.createElement("div",{style:{...e.statusBadge,backgroundColor:n.enabled?"rgba(67, 181, 129, 0.2)":"rgba(240, 71, 71, 0.2)",color:n.enabled?"#43b581":"#f04747"}},n.enabled?"âœ“ Aktif":"âœ— KapalÄ±"))),React.createElement("div",{style:e.tabs},["overview","settings","logs"].map(t=>React.createElement("button",{key:t,style:{...e.tab,backgroundColor:o===t?"#5865f2":"transparent",color:o===t?"#fff":"#b9bbbe"},onClick:()=>w(t)},t==="overview"&&React.createElement(F,null),t==="settings"&&React.createElement(A,null),t==="logs"&&React.createElement(h,null),t==="overview"?"Genel BakÄ±ÅŸ":t==="settings"?"Ayarlar":"KayÄ±tlar"))),o==="overview"&&React.createElement("div",{style:e.content},React.createElement("div",{style:e.statsGrid},React.createElement("div",{style:e.statCard},React.createElement("div",{style:e.statIcon},React.createElement(p,{size:20,color:"#43b581"})),React.createElement("div",{style:e.statInfo},React.createElement("div",{style:e.statValue},l.totalDetected),React.createElement("div",{style:e.statLabel},"Toplam Tespit"))),React.createElement("div",{style:e.statCard},React.createElement("div",{style:e.statIcon},React.createElement(C,{size:20,color:"#faa61a"})),React.createElement("div",{style:e.statInfo},React.createElement("div",{style:e.statValue},l.todayDetected),React.createElement("div",{style:e.statLabel},"BugÃ¼n"))),React.createElement("div",{style:e.statCard},React.createElement("div",{style:e.statIcon},React.createElement(P,{size:20,color:"#f04747"})),React.createElement("div",{style:e.statInfo},React.createElement("div",{style:e.statValue},l.actionsTaken?.ban||0),React.createElement("div",{style:e.statLabel},"Ban"))),React.createElement("div",{style:e.statCard},React.createElement("div",{style:e.statIcon},React.createElement(v,{size:20,color:"#5865f2"})),React.createElement("div",{style:e.statInfo},React.createElement("div",{style:e.statValue},Object.values(n.patterns).filter(Boolean).length),React.createElement("div",{style:e.statLabel},"Aktif Kural")))),React.createElement("div",{style:e.section},React.createElement("h3",{style:e.sectionTitle},"Son Tespitler"),React.createElement("div",{style:e.detectionsList},l.recentDetections.map((t,a)=>React.createElement("div",{key:a,style:e.detectionItem},React.createElement("div",{style:e.detectionIcon},k(t.type)),React.createElement("div",{style:e.detectionInfo},React.createElement("div",{style:e.detectionUser},React.createElement("strong",null,t.username),React.createElement("span",{style:e.detectionType},t.type)),React.createElement("div",{style:e.detectionMessage},t.message.substring(0,50),"...")),React.createElement("div",{style:{...e.actionBadge,backgroundColor:d(t.action)}},t.action))))),React.createElement("div",{style:e.section},React.createElement("h3",{style:e.sectionTitle},"En Ã‡ok Ä°hlal Edenler"),React.createElement("div",{style:e.offendersList},l.topOffenders.map((t,a)=>React.createElement("div",{key:a,style:e.offenderItem},React.createElement("div",{style:e.offenderRank},"#",a+1),React.createElement("div",{style:e.offenderInfo},React.createElement("span",{style:e.offenderName},t.username),React.createElement("span",{style:e.offenderCount},t.count," ihlal")),React.createElement("div",{style:{...e.actionBadge,backgroundColor:d(t.lastAction)}},t.lastAction)))))),o==="settings"&&React.createElement("div",{style:e.content},React.createElement("div",{style:e.settingRow},React.createElement("div",{style:e.settingInfo},React.createElement(p,{size:18,color:"#43b581"}),React.createElement("div",null,React.createElement("div",{style:e.settingTitle},"Spam KorumasÄ±"),React.createElement("div",{style:e.settingDesc},"Otomatik spam algÄ±lama ve Ã¶nleme"))),React.createElement("button",{style:{...e.toggleButton,backgroundColor:n.enabled?"#43b581":"#72767d"},onClick:()=>i(t=>({...t,enabled:!t.enabled}))},n.enabled?React.createElement(m,null):React.createElement(x,null))),React.createElement("div",{style:e.section},React.createElement("h3",{style:e.sectionTitle},"Hassasiyet Seviyesi"),React.createElement("div",{style:e.sensitivityGrid},["low","medium","high","aggressive"].map(t=>React.createElement("button",{key:t,style:{...e.sensitivityButton,backgroundColor:n.sensitivity===t?"#5865f2":"#40444b",borderColor:n.sensitivity===t?"#5865f2":"transparent"},onClick:()=>L(t)},t==="low"&&"ðŸ¢ DÃ¼ÅŸÃ¼k",t==="medium"&&"âš–ï¸ Orta",t==="high"&&"ðŸ”¥ YÃ¼ksek",t==="aggressive"&&"âš¡ Agresif")))),React.createElement("div",{style:e.section},React.createElement("h3",{style:e.sectionTitle},"AlgÄ±lama KalÄ±plarÄ±"),React.createElement("div",{style:e.patternsGrid},Object.entries(n.patterns).map(([t,a])=>React.createElement("div",{key:t,style:e.patternItem},React.createElement("div",{style:e.patternInfo},k(t),React.createElement("span",null,t==="rapidMessages"?"HÄ±zlÄ± Mesaj":t==="duplicateContent"?"Tekrarlanan Ä°Ã§erik":t==="mentionSpam"?"Etiket Spam":t==="linkSpam"?"Link Spam":t==="capsLock"?"BÃœYÃœK HARF":"Zalgo Metin")),React.createElement("button",{style:{...e.miniToggle,backgroundColor:a?"#43b581":"#72767d"},onClick:()=>D(t)},a?React.createElement(m,{size:10}):React.createElement(x,{size:10})))))),React.createElement("div",{style:e.section},React.createElement("h3",{style:e.sectionTitle},"Otomatik Eylemler"),React.createElement("div",{style:e.actionsGrid},Object.entries(n.actions).map(([t,a])=>React.createElement("div",{key:t,style:e.actionItem},React.createElement("div",{style:e.actionInfo},React.createElement("div",{style:{...e.actionDot,backgroundColor:d(t)}}),React.createElement("span",null,t==="warn"?"Uyar":t==="mute"?"Sustur":t==="kick"?"At":"Yasakla")),React.createElement("button",{style:{...e.miniToggle,backgroundColor:a?"#43b581":"#72767d"},onClick:()=>B(t)},a?React.createElement(m,{size:10}):React.createElement(x,{size:10})))))),I&&React.createElement("button",{style:e.saveButton,onClick:j},React.createElement(m,null)," AyarlarÄ± Kaydet")),o==="logs"&&React.createElement("div",{style:e.content},React.createElement("div",{style:e.logsHeader},React.createElement("h3",{style:e.sectionTitle},"Spam KayÄ±tlarÄ±"),React.createElement("select",{style:e.filterSelect},React.createElement("option",{value:"all"},"TÃ¼m Eylemler"),React.createElement("option",{value:"warn"},"UyarÄ±lar"),React.createElement("option",{value:"mute"},"Susturmalar"),React.createElement("option",{value:"kick"},"Atmalar"),React.createElement("option",{value:"ban"},"Yasaklamalar"))),React.createElement("div",{style:e.logsList},l.recentDetections.map((t,a)=>React.createElement("div",{key:a,style:e.logItem},React.createElement("div",{style:e.logTime},new Date(t.timestamp).toLocaleString("tr-TR")),React.createElement("div",{style:e.logContent},React.createElement("strong",null,t.username)," - ",t.type,React.createElement("div",{style:e.logMessage},'"',t.message,'"')),React.createElement("div",{style:{...e.actionBadge,backgroundColor:d(t.action)}},t.action))))))},e={container:{backgroundColor:"#2f3136",borderRadius:"8px",overflow:"hidden"},loading:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"16px",padding:"60px",color:"#b9bbbe"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #202225"},headerLeft:{display:"flex",alignItems:"center",gap:"16px"},headerRight:{display:"flex",alignItems:"center"},title:{margin:0,fontSize:"18px",fontWeight:"600",color:"#fff"},subtitle:{margin:"4px 0 0",fontSize:"13px",color:"#72767d"},statusBadge:{padding:"6px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},tabs:{display:"flex",padding:"0 20px",borderBottom:"1px solid #202225",gap:"8px"},tab:{display:"flex",alignItems:"center",gap:"8px",padding:"12px 16px",border:"none",borderRadius:"4px 4px 0 0",cursor:"pointer",fontSize:"13px",fontWeight:"500",transition:"all 0.15s"},content:{padding:"20px"},statsGrid:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"12px",marginBottom:"24px"},statCard:{display:"flex",alignItems:"center",gap:"12px",padding:"16px",backgroundColor:"#202225",borderRadius:"8px"},statIcon:{display:"flex",alignItems:"center",justifyContent:"center",width:"40px",height:"40px",backgroundColor:"#36393f",borderRadius:"8px"},statInfo:{flex:1},statValue:{fontSize:"20px",fontWeight:"700",color:"#fff"},statLabel:{fontSize:"12px",color:"#72767d"},section:{marginBottom:"24px"},sectionTitle:{margin:"0 0 16px",fontSize:"14px",fontWeight:"600",color:"#fff",textTransform:"uppercase",letterSpacing:"0.5px"},detectionsList:{display:"flex",flexDirection:"column",gap:"8px"},detectionItem:{display:"flex",alignItems:"center",gap:"12px",padding:"12px 16px",backgroundColor:"#202225",borderRadius:"6px"},detectionIcon:{color:"#faa61a"},detectionInfo:{flex:1},detectionUser:{display:"flex",alignItems:"center",gap:"8px",color:"#fff",fontSize:"14px"},detectionType:{fontSize:"11px",color:"#72767d",backgroundColor:"#40444b",padding:"2px 6px",borderRadius:"3px"},detectionMessage:{fontSize:"12px",color:"#72767d",marginTop:"4px"},actionBadge:{padding:"4px 10px",borderRadius:"4px",color:"#fff",fontSize:"11px",fontWeight:"600",textTransform:"uppercase"},offendersList:{display:"flex",flexDirection:"column",gap:"8px"},offenderItem:{display:"flex",alignItems:"center",gap:"12px",padding:"12px 16px",backgroundColor:"#202225",borderRadius:"6px"},offenderRank:{width:"28px",height:"28px",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#40444b",borderRadius:"50%",fontSize:"12px",fontWeight:"600",color:"#fff"},offenderInfo:{flex:1,display:"flex",flexDirection:"column"},offenderName:{color:"#fff",fontSize:"14px",fontWeight:"500"},offenderCount:{color:"#72767d",fontSize:"12px"},settingRow:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px",backgroundColor:"#202225",borderRadius:"8px",marginBottom:"16px"},settingInfo:{display:"flex",alignItems:"center",gap:"12px"},settingTitle:{color:"#fff",fontSize:"14px",fontWeight:"500"},settingDesc:{color:"#72767d",fontSize:"12px"},toggleButton:{width:"44px",height:"24px",border:"none",borderRadius:"12px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",transition:"background-color 0.2s"},sensitivityGrid:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"8px"},sensitivityButton:{padding:"12px",border:"2px solid transparent",borderRadius:"8px",cursor:"pointer",color:"#fff",fontSize:"13px",fontWeight:"500",transition:"all 0.15s"},patternsGrid:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"8px"},patternItem:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 16px",backgroundColor:"#202225",borderRadius:"6px"},patternInfo:{display:"flex",alignItems:"center",gap:"10px",color:"#dcddde",fontSize:"13px"},miniToggle:{width:"28px",height:"18px",border:"none",borderRadius:"9px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",transition:"background-color 0.2s"},actionsGrid:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"8px"},actionItem:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 16px",backgroundColor:"#202225",borderRadius:"6px"},actionInfo:{display:"flex",alignItems:"center",gap:"8px",color:"#dcddde",fontSize:"13px"},actionDot:{width:"8px",height:"8px",borderRadius:"50%"},saveButton:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",width:"100%",padding:"12px",backgroundColor:"#43b581",border:"none",borderRadius:"4px",color:"#fff",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"background-color 0.15s"},logsHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},filterSelect:{padding:"8px 12px",backgroundColor:"#202225",border:"1px solid #40444b",borderRadius:"4px",color:"#dcddde",fontSize:"13px"},logsList:{display:"flex",flexDirection:"column",gap:"8px"},logItem:{display:"flex",alignItems:"flex-start",gap:"12px",padding:"12px 16px",backgroundColor:"#202225",borderRadius:"6px"},logTime:{fontSize:"11px",color:"#72767d",whiteSpace:"nowrap"},logContent:{flex:1,fontSize:"13px",color:"#dcddde"},logMessage:{fontSize:"12px",color:"#72767d",marginTop:"4px",fontStyle:"italic"}};export{$ as default};
