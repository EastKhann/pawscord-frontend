{"version":3,"file":"GifPicker-DRHla4ZE.js","sources":["../../../src/GifPicker.js"],"sourcesContent":["// frontend/src/GifPicker.js (Mutlak URL ile çalışan kesin çözüm)\r\n\r\nimport React, { useState, useEffect, useRef } from 'react';\r\n// <<< DÜZELTME: absoluteHostUrl prop'u eklendi >>>\r\nconst GifPicker = ({ onSelect, onClose, localGifListUrl, absoluteHostUrl, fetchWithAuth }) => {\r\n    const [searchTerm, setSearchTerm] = useState('');\r\n    const [allGifs, setAllGifs] = useState([]);\r\n    const [filteredGifs, setFilteredGifs] = useState([]);\r\n    const [isLoading, setIsLoading] = useState(true);\r\n    const [error, setError] = useState(null);\r\n\r\n    const pickerRef = useRef(null);\r\n\r\n    // Dışarı tıklamayı kapatma mantığı\r\n    useEffect(() => {\r\n        function handleClickOutside(event) {\r\n            if (pickerRef.current && !pickerRef.current.contains(event.target) && event.target.textContent !== 'GIF') {\r\n                onClose();\r\n            }\r\n        }\r\n        document.addEventListener(\"mousedown\", handleClickOutside);\r\n        return () => document.removeEventListener(\"mousedown\", handleClickOutside);\r\n    }, [onClose]);\r\n\r\n    // 1. Yerel GIF'leri API'den çek\r\n    useEffect(() => {\r\n        const fetchLocalGifs = async () => {\r\n            setIsLoading(true);\r\n            setError(null);\r\n            try {\r\n                const response = await fetchWithAuth(localGifListUrl);\r\n                if (!response.ok) {\r\n                    throw new Error(`Yerel API Hatası: ${response.status}`);\r\n                }\r\n                const data = await response.json();\r\n\r\n                if (Array.isArray(data)) {\r\n                    setAllGifs(data);\r\n                    setFilteredGifs(data);\r\n                } else {\r\n                    setAllGifs([]);\r\n                    setFilteredGifs([]);\r\n                }\r\n\r\n            } catch (err) {\r\n                console.error(\"Yerel GIF yükleme hatası:\", err);\r\n                setError(\"GIF koleksiyonu yüklenemedi. Django sunucusunu ve 'gifs' klasörünü kontrol edin.\");\r\n            } finally {\r\n                setIsLoading(false);\r\n            }\r\n        };\r\n\r\n        if (localGifListUrl) {\r\n            fetchLocalGifs();\r\n        }\r\n    }, [localGifListUrl, fetchWithAuth]);\r\n\r\n    // 2. Arama terimi değiştiğinde GIF'leri filtrele\r\n    useEffect(() => {\r\n        if (!allGifs.length) return;\r\n\r\n        if (!searchTerm) {\r\n            setFilteredGifs(allGifs);\r\n            return;\r\n        }\r\n\r\n        const lowerCaseSearch = searchTerm.toLowerCase();\r\n\r\n        const results = allGifs.filter(url => {\r\n            const filenameWithExtension = url.substring(url.lastIndexOf('/') + 1);\r\n            const filename = filenameWithExtension.substring(0, filenameWithExtension.lastIndexOf('.'));\r\n\r\n            return filename.toLowerCase().includes(lowerCaseSearch);\r\n        });\r\n\r\n        setFilteredGifs(results);\r\n    }, [searchTerm, allGifs]);\r\n\r\n\r\n    const handleGifClick = (gifUrl) => {\r\n        onSelect(gifUrl);\r\n    };\r\n\r\n    // Mutlak URL oluşturma fonksiyonu\r\n    const getAbsoluteGifUrl = (relativeUrl) => {\r\n        // Eğer URL zaten http ile başlıyorsa dokunma, aksi takdirde absoluteHostUrl'i ekle\r\n        return relativeUrl.startsWith('http') ? relativeUrl : `${absoluteHostUrl}${relativeUrl}`;\r\n    };\r\n\r\n    return (\r\n        <div style={styles.pickerOverlay}>\r\n            <div style={styles.pickerContainer} ref={pickerRef}>\r\n                <input\r\n                    type=\"text\"\r\n                    placeholder=\"Koleksiyonda ara (dosya adına göre)...\"\r\n                    value={searchTerm}\r\n                    onChange={(e) => setSearchTerm(e.target.value)}\r\n                    style={styles.searchInput}\r\n                    disabled={isLoading || error}\r\n                />\r\n                <div style={styles.gifGrid}>\r\n                    {error && <p style={styles.errorText}>{error}</p>}\r\n                    {isLoading ? (\r\n                        <p style={styles.loadingText}>Yerel koleksiyon yükleniyor...</p>\r\n                    ) : filteredGifs.length > 0 ? (\r\n                        filteredGifs.map((url) => (\r\n                            <div\r\n                                key={url}\r\n                                style={styles.gifWrapper}\r\n                                onClick={() => handleGifClick(url)}\r\n                                title={url.substring(url.lastIndexOf('/') + 1)}\r\n                            >\r\n                                <img\r\n                                    // KRİTİK DÜZELTME: Mutlak URL kullanarak resmi çek\r\n                                    src={getAbsoluteGifUrl(url)}\r\n                                    alt={url.substring(url.lastIndexOf('/') + 1)}\r\n                                    style={styles.gifImage}\r\n                                    onError={(e) => { e.target.style.display = 'none'; e.target.parentNode.style.backgroundColor = '#444'; }}\r\n                                />\r\n                            </div>\r\n                        ))\r\n                    ) : (\r\n                        !error && <p style={styles.noResultsText}>'{searchTerm}' için sonuç bulunamadı.</p>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst styles = {\r\n    pickerOverlay: {\r\n        position: 'fixed',\r\n        top: 0,\r\n        left: 0,\r\n        right: 0,\r\n        bottom: 0,\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        zIndex: 1500,\r\n        pointerEvents: 'none',\r\n    },\r\n    pickerContainer: {\r\n        position: 'absolute',\r\n        bottom: '100px',\r\n        width: '400px',\r\n        height: '350px',\r\n        backgroundColor: '#2f3136',\r\n        borderRadius: '8px',\r\n        boxShadow: '0 5px 15px rgba(0,0,0,0.5)',\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        padding: '10px',\r\n        pointerEvents: 'auto',\r\n    },\r\n    searchInput: {\r\n        width: 'calc(100% - 20px)',\r\n        padding: '10px',\r\n        marginBottom: '10px',\r\n        borderRadius: '4px',\r\n        border: '1px solid #5865f2',\r\n        backgroundColor: '#444',\r\n        color: 'white',\r\n        outline: 'none',\r\n        fontSize: '1em',\r\n    },\r\n    gifGrid: {\r\n        flexGrow: 1,\r\n        overflowY: 'auto',\r\n        display: 'grid',\r\n        gridTemplateColumns: 'repeat(2, 1fr)',\r\n        gap: '10px',\r\n        paddingRight: '5px',\r\n    },\r\n    gifWrapper: {\r\n        width: '100%',\r\n        paddingTop: '75%',\r\n        position: 'relative',\r\n        borderRadius: '4px',\r\n        overflow: 'hidden',\r\n        cursor: 'pointer',\r\n        backgroundColor: '#3a3d43',\r\n        transition: 'transform 0.1s',\r\n    },\r\n    gifImage: {\r\n        position: 'absolute',\r\n        top: 0,\r\n        left: 0,\r\n        width: '100%',\r\n        height: '100%',\r\n        objectFit: 'cover',\r\n    },\r\n    loadingText: {\r\n        color: '#b9bbbe',\r\n        gridColumn: '1 / -1',\r\n        textAlign: 'center',\r\n        marginTop: '50px',\r\n    },\r\n    errorText: {\r\n        color: '#f04747',\r\n        gridColumn: '1 / -1',\r\n        textAlign: 'center',\r\n        marginTop: '50px',\r\n        fontWeight: 'bold',\r\n    },\r\n    noResultsText: {\r\n        color: '#b9bbbe',\r\n        gridColumn: '1 / -1',\r\n        textAlign: 'center',\r\n        marginTop: '50px',\r\n    }\r\n};\r\n\r\nexport default React.memo(GifPicker);\r\n\r\n"],"names":["useState","useRef","useEffect","jsx","jsxs"],"mappings":"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"}