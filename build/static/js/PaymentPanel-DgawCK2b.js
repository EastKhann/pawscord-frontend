import{r as l,d as e,a9 as W,i as j,aL as c,cn as b,bG as L,J as F}from"./react-core-DMT_QkRe.js";import{t as r}from"./index-grPt_ios.js";const V=({fetchWithAuth:d,apiBaseUrl:m,onClose:h,username:_})=>{const[s,p]=l.useState("balance"),[y,B]=l.useState(0),[v,P]=l.useState([]),[I,R]=l.useState(!0),[i,D]=l.useState(100),[o,g]=l.useState("stripe"),[f,C]=l.useState(""),[E,S]=l.useState(""),[T,k]=l.useState("");l.useEffect(()=>{w(),z()},[]);const w=async()=>{try{const a=await(await d(`${m}/api/users/balance/`)).json();B(a.balance||0)}catch(n){console.error("Failed to load balance:",n),r.error("Failed to load balance")}finally{R(!1)}},z=async()=>{try{const a=await(await d(`${m}/api/payments/history/`)).json();P(a.transactions||[])}catch(n){console.error("Failed to load transactions:",n)}},A=async()=>{if(i<100){r.error("Minimum purchase is 100 coins");return}if(!o){r.error("Please select a payment method");return}try{const n=await d(`${m}/api/payments/coins/purchase/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({coin_amount:parseInt(i),payment_method:o})});if(!n.ok){const x=await n.json();throw new Error(x.error||"Payment failed")}const a=await n.json();a.success?a.redirect_url?(r.info("Redirecting to payment page..."),window.location.href=a.redirect_url):a.payment_page_url?(r.info("Redirecting to payment page..."),window.location.href=a.payment_page_url):r.success("Payment initiated!"):r.error(a.error||"Payment failed")}catch(n){console.error("Payment error:",n),r.error(n.message||"Payment processing failed")}},M=async()=>{if(!f||!E){r.error("Please fill in all fields");return}const n=parseInt(E);if(n<=0||n>y){r.error("Invalid transfer amount");return}try{const x=await(await d(`${m}/api/coins/transfer/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({recipient:f,amount:n,note:T})})).json();x.success?(r.success(`Transferred ${n} coins to ${f}`),w(),z(),C(""),S(""),k(""),p("balance")):r.error(x.error||"Transfer failed")}catch(a){console.error("Transfer error:",a),r.error("Transfer failed")}},u=[{amount:100,price:.99,bonus:0},{amount:500,price:4.99,bonus:50},{amount:1e3,price:9.99,bonus:150},{amount:2500,price:19.99,bonus:500},{amount:5e3,price:39.99,bonus:1e3}];return e.createElement("div",{style:t.overlay,onClick:h},e.createElement("div",{style:t.modal,onClick:n=>n.stopPropagation()},e.createElement("div",{style:t.header},e.createElement("div",{style:t.headerLeft},e.createElement(W,{style:{fontSize:"24px",color:"#faa61a"}}),e.createElement("h2",{style:{margin:0,fontSize:"20px"}},"Payment Center")),e.createElement("button",{onClick:h,style:t.closeBtn},e.createElement(j,null))),e.createElement("div",{style:t.tabs},e.createElement("button",{onClick:()=>p("balance"),style:{...t.tab,...s==="balance"&&t.activeTab}},e.createElement(c,null)," Balance"),e.createElement("button",{onClick:()=>p("buy"),style:{...t.tab,...s==="buy"&&t.activeTab}},e.createElement(b,null)," Buy Coins"),e.createElement("button",{onClick:()=>p("transfer"),style:{...t.tab,...s==="transfer"&&t.activeTab}},e.createElement(c,null)," Transfer"),e.createElement("button",{onClick:()=>p("history"),style:{...t.tab,...s==="history"&&t.activeTab}},e.createElement(L,null)," History")),e.createElement("div",{style:t.content},I?e.createElement("div",{style:t.loading},"Loading..."):s==="balance"?e.createElement("div",{style:t.balanceView},e.createElement("div",{style:t.balanceCard},e.createElement(c,{style:{fontSize:"48px",color:"#faa61a"}}),e.createElement("div",{style:t.balanceAmount},y.toLocaleString()),e.createElement("div",{style:t.balanceLabel},"Current Balance")),e.createElement("div",{style:t.quickActions},e.createElement("button",{onClick:()=>p("buy"),style:t.actionBtn},e.createElement(b,null)," Buy Coins"),e.createElement("button",{onClick:()=>p("transfer"),style:t.actionBtn},e.createElement(c,null)," Transfer Coins"))):s==="buy"?e.createElement("div",{style:t.buyView},e.createElement("h3",{style:t.sectionTitle},"Choose Payment Method"),e.createElement("div",{style:t.paymentMethods},e.createElement("div",{onClick:()=>g("crypto"),style:{...t.paymentMethodCard,...o==="crypto"&&t.selectedPaymentMethod}},e.createElement("div",{style:t.pmIcon},"ðŸª™"),e.createElement("div",{style:t.pmTitle},"Cryptocurrency"),e.createElement("div",{style:t.pmDesc},"Bitcoin, Ethereum, USDC"),e.createElement("div",{style:t.pmBadge},"Global â€¢ Fast")),e.createElement("div",{onClick:()=>g("stripe"),style:{...t.paymentMethodCard,...o==="stripe"&&t.selectedPaymentMethod}},e.createElement("div",{style:t.pmIcon},"ðŸ’³"),e.createElement("div",{style:t.pmTitle},"Credit/Debit Card"),e.createElement("div",{style:t.pmDesc},"Stripe - Visa, Mastercard"),e.createElement("div",{style:t.pmBadge},"Global â€¢ Secure")),e.createElement("div",{onClick:()=>g("iyzico"),style:{...t.paymentMethodCard,...o==="iyzico"&&t.selectedPaymentMethod}},e.createElement("div",{style:t.pmIcon},"ðŸ‡¹ðŸ‡·"),e.createElement("div",{style:t.pmTitle},"Turkish Payment"),e.createElement("div",{style:t.pmDesc},"Ä°yzico - TL payments"),e.createElement("div",{style:t.pmBadge},"Turkey â€¢ TRY"))),e.createElement("h3",{style:t.sectionTitle},"Select Coin Package"),e.createElement("div",{style:t.packages},u.map((n,a)=>e.createElement("div",{key:a,onClick:()=>D(n.amount),style:{...t.package,...i===n.amount&&t.selectedPackage}},e.createElement(c,{style:{fontSize:"32px",color:"#faa61a"}}),e.createElement("div",{style:t.pkgAmount},n.amount.toLocaleString()),n.bonus>0&&e.createElement("div",{style:t.bonus},"+",n.bonus," BONUS"),e.createElement("div",{style:t.price},"$",n.price),i===n.amount&&e.createElement(F,{style:{position:"absolute",top:"10px",right:"10px",color:"#43b581"}})))),e.createElement("div",{style:t.purchaseSection},e.createElement("div",{style:t.paymentInfo},e.createElement("div",{style:t.paymentInfoRow},e.createElement("span",null,"Selected Package:"),e.createElement("strong",null,i.toLocaleString()," coins")),e.createElement("div",{style:t.paymentInfoRow},e.createElement("span",null,"Payment Method:"),e.createElement("strong",null,o==="crypto"&&"ðŸª™ Crypto",o==="stripe"&&"ðŸ’³ Card (Stripe)",o==="iyzico"&&"ðŸ‡¹ðŸ‡· Ä°yzico (TRY)")),e.createElement("div",{style:t.paymentInfoRow},e.createElement("span",null,"Total Price:"),e.createElement("strong",{style:{color:"#faa61a",fontSize:"18px"}},u.find(n=>n.amount===i)?.price&&(o==="iyzico"?`â‚º${(u.find(n=>n.amount===i).price*35).toFixed(0)}`:`$${u.find(n=>n.amount===i).price}`)))),e.createElement("button",{onClick:A,style:t.purchaseBtn},e.createElement(b,null),o==="crypto"&&" Pay with Crypto",o==="stripe"&&" Pay with Card",o==="iyzico"&&" Ä°yzico ile Ã–de"),e.createElement("div",{style:t.paymentNote},o==="crypto"&&"ðŸ”’ Secure cryptocurrency payment via Coinbase Commerce",o==="stripe"&&"ðŸ”’ Secure card payment via Stripe",o==="iyzico"&&"ðŸ”’ GÃ¼venli Ã¶deme - Ä°yzico ile korunur"))):s==="transfer"?e.createElement("div",{style:t.transferView},e.createElement("h3",{style:t.sectionTitle},"Transfer Coins"),e.createElement("div",{style:t.form},e.createElement("div",{style:t.formGroup},e.createElement("label",{style:t.label},"Recipient Username"),e.createElement("input",{type:"text",value:f,onChange:n=>C(n.target.value),placeholder:"@username",style:t.input})),e.createElement("div",{style:t.formGroup},e.createElement("label",{style:t.label},"Amount"),e.createElement("input",{type:"number",value:E,onChange:n=>S(n.target.value),placeholder:"0",min:"1",max:y,style:t.input}),e.createElement("div",{style:t.hint},"Available: ",y," coins")),e.createElement("div",{style:t.formGroup},e.createElement("label",{style:t.label},"Note (Optional)"),e.createElement("input",{type:"text",value:T,onChange:n=>k(n.target.value),placeholder:"Add a message...",style:t.input})),e.createElement("button",{onClick:M,style:t.transferBtn},e.createElement(c,null)," Transfer Coins"))):e.createElement("div",{style:t.historyView},e.createElement("h3",{style:t.sectionTitle},"Transaction History"),v.length===0?e.createElement("div",{style:t.empty},"No transactions yet"):e.createElement("div",{style:t.transactions},v.map((n,a)=>e.createElement("div",{key:a,style:t.transaction},e.createElement("div",{style:t.txIcon},n.type==="purchase"?e.createElement(b,{style:{color:"#5865f2"}}):n.type==="transfer_sent"?e.createElement(c,{style:{color:"#f04747"}}):e.createElement(c,{style:{color:"#43b581"}})),e.createElement("div",{style:t.txDetails},e.createElement("div",{style:t.txTitle},n.description),e.createElement("div",{style:t.txDate},new Date(n.created_at).toLocaleString())),e.createElement("div",{style:{...t.txAmount,color:n.amount>0?"#43b581":"#f04747"}},n.amount>0?"+":"",n.amount))))))))},t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999},modal:{backgroundColor:"#1e1e1e",borderRadius:"8px",width:"90%",maxWidth:"800px",maxHeight:"80vh",display:"flex",flexDirection:"column",color:"#fff"},header:{padding:"20px",borderBottom:"1px solid #444",display:"flex",justifyContent:"space-between",alignItems:"center"},headerLeft:{display:"flex",alignItems:"center",gap:"12px"},closeBtn:{background:"none",border:"none",color:"#fff",fontSize:"24px",cursor:"pointer",padding:"8px"},tabs:{display:"flex",borderBottom:"1px solid #444",padding:"0 20px"},tab:{background:"none",border:"none",color:"#99aab5",padding:"12px 20px",cursor:"pointer",fontSize:"14px",display:"flex",alignItems:"center",gap:"8px",borderBottom:"2px solid transparent",transition:"all 0.2s"},activeTab:{color:"#5865f2",borderBottomColor:"#5865f2"},content:{padding:"20px",overflowY:"auto",flex:1},loading:{textAlign:"center",padding:"40px",color:"#99aab5"},balanceView:{display:"flex",flexDirection:"column",alignItems:"center",gap:"30px"},balanceCard:{backgroundColor:"#2c2f33",borderRadius:"12px",padding:"40px",textAlign:"center",width:"100%",maxWidth:"400px",display:"flex",flexDirection:"column",alignItems:"center",gap:"16px"},balanceAmount:{fontSize:"48px",fontWeight:"bold",color:"#faa61a"},balanceLabel:{fontSize:"14px",color:"#99aab5"},quickActions:{display:"flex",gap:"12px",width:"100%",maxWidth:"400px"},actionBtn:{flex:1,padding:"12px 20px",backgroundColor:"#5865f2",border:"none",borderRadius:"6px",color:"#fff",cursor:"pointer",fontSize:"14px",fontWeight:"600",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",transition:"background 0.2s"},buyView:{display:"flex",flexDirection:"column",gap:"20px"},sectionTitle:{fontSize:"16px",fontWeight:"600",margin:0,marginBottom:"12px"},packages:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(140px, 1fr))",gap:"12px"},package:{backgroundColor:"#2c2f33",borderRadius:"8px",padding:"20px",textAlign:"center",cursor:"pointer",border:"2px solid transparent",transition:"all 0.2s",position:"relative",display:"flex",flexDirection:"column",alignItems:"center",gap:"8px"},selectedPackage:{borderColor:"#5865f2",backgroundColor:"#2c3136"},pkgAmount:{fontSize:"24px",fontWeight:"bold",color:"#faa61a"},bonus:{fontSize:"10px",color:"#43b581",fontWeight:"bold",padding:"2px 8px",backgroundColor:"rgba(67, 181, 129, 0.1)",borderRadius:"4px"},purchaseSection:{marginTop:"24px"},paymentMethods:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px",marginBottom:"32px"},paymentMethodCard:{padding:"20px",background:"#2b2d31",border:"2px solid #40444b",borderRadius:"12px",textAlign:"center",cursor:"pointer",transition:"all 0.3s ease"},selectedPaymentMethod:{background:"#5865f2",borderColor:"#5865f2",transform:"scale(1.05)",boxShadow:"0 4px 16px rgba(88, 101, 242, 0.3)"},pmIcon:{fontSize:"48px",marginBottom:"12px"},pmTitle:{fontSize:"16px",fontWeight:"600",color:"white",marginBottom:"6px"},pmDesc:{fontSize:"13px",color:"#b9bbbe",marginBottom:"8px"},pmBadge:{display:"inline-block",padding:"4px 12px",background:"#40444b",borderRadius:"12px",fontSize:"11px",color:"#43b581",fontWeight:"600"},paymentInfo:{background:"#2b2d31",borderRadius:"12px",padding:"16px",marginBottom:"16px"},paymentInfoRow:{display:"flex",justifyContent:"space-between",padding:"8px 0",fontSize:"14px",color:"#b9bbbe",borderBottom:"1px solid #40444b"},paymentNote:{textAlign:"center",fontSize:"12px",color:"#43b581",marginTop:"12px"},price:{fontSize:"18px",fontWeight:"600",color:"#fff"},label:{display:"block",fontSize:"14px",fontWeight:"600",marginBottom:"8px",color:"#dcddde"},purchaseBtn:{width:"100%",padding:"14px",backgroundColor:"#43b581",border:"none",borderRadius:"6px",color:"#fff",fontSize:"16px",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",marginTop:"12px"},transferView:{maxWidth:"500px",margin:"0 auto"},form:{display:"flex",flexDirection:"column",gap:"16px"},formGroup:{display:"flex",flexDirection:"column",gap:"8px"},input:{padding:"10px",backgroundColor:"#2c2f33",border:"1px solid #444",borderRadius:"4px",color:"#fff",fontSize:"14px"},hint:{fontSize:"12px",color:"#99aab5"},transferBtn:{width:"100%",padding:"14px",backgroundColor:"#5865f2",border:"none",borderRadius:"6px",color:"#fff",fontSize:"16px",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",marginTop:"12px"},historyView:{display:"flex",flexDirection:"column",gap:"16px"},transactions:{display:"flex",flexDirection:"column",gap:"8px"},transaction:{backgroundColor:"#2c2f33",borderRadius:"6px",padding:"16px",display:"flex",alignItems:"center",gap:"12px"},txIcon:{fontSize:"24px",display:"flex",alignItems:"center",justifyContent:"center"},txDetails:{flex:1},txTitle:{fontSize:"14px",fontWeight:"600"},txDate:{fontSize:"12px",color:"#99aab5",marginTop:"4px"},txAmount:{fontSize:"18px",fontWeight:"bold"},empty:{textAlign:"center",padding:"40px",color:"#99aab5"}};export{V as default};
