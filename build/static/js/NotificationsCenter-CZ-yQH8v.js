import{r as a,x as f,bV as W,l as M,dB as X,av as Y,aq as G,B as K,aX as Q}from"./react-core-B6hadH-M.js";import{g as l,h as Z}from"./index-D_6pZib5.js";const ae=({userId:n,onClose:F})=>{const[r,i]=a.useState([]),[d,u]=a.useState(0),[o,E]=a.useState("all"),[I,P]=a.useState(null),[h,g]=a.useState(!1),[x,D]=a.useState(!0),[N,p]=a.useState(!0),[v,b]=a.useState(!0),[y,k]=a.useState(!1),[S,w]=a.useState(!1),[C,$]=a.useState(!0);a.useEffect(()=>{O(),B()},[n,o]);const c=async(e,t={})=>{const _=localStorage.getItem("access_token"),s=await fetch(e,{...t,headers:{Authorization:`Bearer ${_}`,"Content-Type":"application/json",...t.headers}});if(!s.ok)throw new Error(`HTTP ${s.status}`);return await s.json()},O=async()=>{try{const e=await c(`${l()}/notifications/${n}/list/?filter=${o}`);i(e.notifications||[]),u(e.unread_count||0)}catch(e){console.error("Notifications fetch error:",e)}finally{D(!1)}},B=async()=>{try{const e=await c(`${l()}/notifications/${n}/settings/`);P(e),p(e.push_enabled),b(e.email_enabled),k(e.mentions_only),w(e.dnd_enabled),$(e.sound_enabled)}catch(e){console.error("Settings fetch error:",e)}},L=async e=>{try{await c(`${l()}/notifications/${n}/${e}/read/`,{method:"POST"}),i(r.map(t=>t.id===e?{...t,read:!0}:t)),u(Math.max(0,d-1))}catch(t){console.error("Mark as read error:",t)}},U=async()=>{try{await c(`${l()}/notifications/${n}/read-all/`,{method:"POST"}),i(r.map(e=>({...e,read:!0}))),u(0),m("All notifications marked as read!")}catch(e){console.error("Mark all as read error:",e)}},j=async e=>{try{await c(`${l()}/notifications/${n}/${e}/delete/`,{method:"DELETE"}),i(r.filter(t=>t.id!==e)),m("Notification deleted!")}catch(t){console.error("Delete notification error:",t)}},z=async()=>{if(await Z("Are you sure you want to clear all notifications?"))try{await c(`${l()}/notifications/${n}/clear/`,{method:"POST"}),i([]),u(0),m("All notifications cleared!")}catch(e){console.error("Clear all error:",e)}},J=async()=>{try{await c(`${l()}/notifications/${n}/settings/update/`,{method:"PUT",body:JSON.stringify({push_enabled:N,email_enabled:v,mentions_only:y,dnd_enabled:S,sound_enabled:C})}),m("Settings updated!"),g(!1)}catch(e){console.error("Settings update error:",e)}},q=async()=>{try{await c(`${l()}/notifications/${n}/test/`,{method:"POST"}),m("Test notification sent!")}catch(e){console.error("Test notification error:",e)}},H=e=>{switch(e){case"mention":return"ðŸ’¬";case"reply":return"â†©ï¸";case"like":return"â¤ï¸";case"follow":return"ðŸ‘¤";case"server_invite":return"ðŸ“§";case"role_update":return"ðŸ·ï¸";case"announcement":return"ðŸ“¢";default:return"ðŸ””"}},V=e=>{const t=new Date(e),s=new Date-t,R=Math.floor(s/6e4),T=Math.floor(s/36e5),A=Math.floor(s/864e5);return R<1?"Just now":R<60?`${R}m ago`:T<24?`${T}h ago`:A<7?`${A}d ago`:t.toLocaleDateString()},m=(e,t="success")=>{};return x?React.createElement("div",{className:"notifications-overlay"},React.createElement("div",{className:"notifications-panel loading"},React.createElement("div",{className:"spinner"}),React.createElement("p",null,"Loading Notifications..."))):React.createElement("div",{className:"notifications-overlay"},React.createElement("div",{className:"notifications-panel"},React.createElement("div",{className:"panel-header"},React.createElement("div",null,React.createElement("h2",null,React.createElement(f,null)," Notifications"),d>0&&React.createElement("span",{className:"unread-badge"},d," new")),React.createElement("div",{className:"header-actions"},React.createElement("button",{onClick:()=>g(!h),className:"btn-settings"},React.createElement(W,null)),React.createElement("button",{onClick:F,className:"btn-close"},React.createElement(M,null)))),React.createElement("div",{className:"filter-bar"},React.createElement("button",{className:o==="all"?"active":"",onClick:()=>E("all")},"All"),React.createElement("button",{className:o==="unread"?"active":"",onClick:()=>E("unread")},"Unread"),React.createElement("button",{className:o==="mentions"?"active":"",onClick:()=>E("mentions")},"Mentions"),React.createElement("button",{className:o==="servers"?"active":"",onClick:()=>E("servers")},"Servers")),h&&React.createElement("div",{className:"settings-panel"},React.createElement("h3",null,"Notification Settings"),React.createElement("div",{className:"setting-item"},React.createElement("div",{className:"setting-info"},React.createElement(X,null),React.createElement("div",null,React.createElement("h4",null,"Push Notifications"),React.createElement("p",null,"Receive notifications on your device"))),React.createElement("label",{className:"toggle"},React.createElement("input",{type:"checkbox",checked:N,onChange:e=>p(e.target.checked)}),React.createElement("span",{className:"toggle-slider"}))),React.createElement("div",{className:"setting-item"},React.createElement("div",{className:"setting-info"},React.createElement(Y,null),React.createElement("div",null,React.createElement("h4",null,"Email Notifications"),React.createElement("p",null,"Receive notifications via email"))),React.createElement("label",{className:"toggle"},React.createElement("input",{type:"checkbox",checked:v,onChange:e=>b(e.target.checked)}),React.createElement("span",{className:"toggle-slider"}))),React.createElement("div",{className:"setting-item"},React.createElement("div",{className:"setting-info"},React.createElement(f,null),React.createElement("div",null,React.createElement("h4",null,"Sound Effects"),React.createElement("p",null,"Play sound when you receive notifications"))),React.createElement("label",{className:"toggle"},React.createElement("input",{type:"checkbox",checked:C,onChange:e=>$(e.target.checked)}),React.createElement("span",{className:"toggle-slider"}))),React.createElement("div",{className:"setting-item"},React.createElement("div",{className:"setting-info"},React.createElement(G,null),React.createElement("div",null,React.createElement("h4",null,"Mentions Only"),React.createElement("p",null,"Only notify when you're mentioned"))),React.createElement("label",{className:"toggle"},React.createElement("input",{type:"checkbox",checked:y,onChange:e=>k(e.target.checked)}),React.createElement("span",{className:"toggle-slider"}))),React.createElement("div",{className:"setting-item"},React.createElement("div",{className:"setting-info"},React.createElement(K,null),React.createElement("div",null,React.createElement("h4",null,"Do Not Disturb"),React.createElement("p",null,"Mute all notifications temporarily"))),React.createElement("label",{className:"toggle"},React.createElement("input",{type:"checkbox",checked:S,onChange:e=>w(e.target.checked)}),React.createElement("span",{className:"toggle-slider"}))),React.createElement("div",{className:"settings-actions"},React.createElement("button",{onClick:q,className:"btn-test"},"Test Notification"),React.createElement("button",{onClick:J,className:"btn-save"},"Save Settings"))),React.createElement("div",{className:"panel-actions"},d>0&&React.createElement("button",{onClick:U,className:"btn-mark-read"},React.createElement(Q,null)," Mark All as Read"),r.length>0&&React.createElement("button",{onClick:z,className:"btn-clear"},"Clear All")),React.createElement("div",{className:"notifications-content"},r.length===0?React.createElement("div",{className:"empty-state"},React.createElement(f,{size:64}),React.createElement("h3",null,"No Notifications"),React.createElement("p",null,"You're all caught up!")):React.createElement("div",{className:"notifications-list"},r.map(e=>React.createElement("div",{key:e.id,className:`notification-item ${e.read?"":"unread"}`,onClick:()=>!e.read&&L(e.id)},React.createElement("div",{className:"notification-icon"},H(e.type)),React.createElement("div",{className:"notification-body"},React.createElement("div",{className:"notification-header"},React.createElement("h4",null,e.title),React.createElement("span",{className:"notification-time"},V(e.created_at))),React.createElement("p",{className:"notification-message"},e.message),e.server_name&&React.createElement("span",{className:"notification-server"},"in ",e.server_name)),React.createElement("button",{onClick:t=>{t.stopPropagation(),j(e.id)},className:"btn-delete-notification"},React.createElement(M,null)),!e.read&&React.createElement("div",{className:"unread-dot"})))))))};export{ae as default};
