import{r as n,d as e,c9 as m}from"./react-core-DrOm_csO.js";import{g as x}from"./index-DmEhdEtw.js";const B=({serverId:o,onClose:i})=>{const[t,l]=n.useState({welcome_enabled:!1,welcome_channel_id:"",welcome_message:"HoÅŸ geldin {user}! {server} sunucusuna katÄ±ldÄ±n!",welcome_embed:!1,welcome_embed_color:"#5865f2",welcome_embed_title:"HoÅŸ Geldin!",welcome_embed_description:"{user} sunucuya katÄ±ldÄ±!",welcome_dm:!1,welcome_dm_message:"Merhaba {user}! {server} sunucusuna hoÅŸ geldin!",goodbye_enabled:!1,goodbye_channel_id:"",goodbye_message:"{user} sunucudan ayrÄ±ldÄ±. HoÅŸÃ§a kal!",goodbye_embed:!1,goodbye_embed_color:"#ed4245",auto_role_enabled:!1,auto_role_ids:[]}),[b,_]=n.useState([]),[h,p]=n.useState([]),[d,w]=n.useState(null),[f,y]=n.useState(!0),[K,j]=n.useState(null),r=x();n.useEffect(()=>{o&&(v(),k(),N(),g())},[o]);const v=async()=>{try{const a=localStorage.getItem("access_token"),s=await fetch(`${r}/welcome-messages/server/${o}/`,{headers:{Authorization:`Bearer ${a}`}});if(s.ok){const c=await s.json();c.config&&l(c.config)}}catch(a){console.error("Error fetching config:",a)}finally{y(!1)}},k=async()=>{try{const a=localStorage.getItem("access_token"),s=await fetch(`${r}/servers/${o}/channels/`,{headers:{Authorization:`Bearer ${a}`}});if(s.ok){const c=await s.json();_(c.channels||[])}}catch(a){console.error("Error fetching channels:",a)}},N=async()=>{try{const a=localStorage.getItem("access_token"),s=await fetch(`${r}/servers/${o}/roles/`,{headers:{Authorization:`Bearer ${a}`}});if(s.ok){const c=await s.json();p(c.roles||[])}}catch(a){console.error("Error fetching roles:",a)}},g=async()=>{try{const a=localStorage.getItem("access_token"),s=await fetch(`${r}/welcome-messages/server/${o}/stats/`,{headers:{Authorization:`Bearer ${a}`}});if(s.ok){const c=await s.json();w(c)}}catch(a){console.error("Error fetching stats:",a)}},C=async()=>{try{const a=localStorage.getItem("access_token");(await fetch(`${r}/welcome-messages/server/${o}/update/`,{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify(t)})).ok?(m.success("âœ… KarÅŸÄ±lama ayarlarÄ± kaydedildi"),g()):m.error("âŒ Kaydetme baÅŸarÄ±sÄ±z")}catch(a){console.error("Error saving config:",a),m.error("âŒ Kaydetme baÅŸarÄ±sÄ±z")}},S=async()=>{try{const a=localStorage.getItem("access_token");(await fetch(`${r}/welcome-messages/server/${o}/test/`,{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify({type:"welcome"})})).ok?m.success("âœ… Test mesajÄ± gÃ¶nderildi"):m.error("âŒ Test mesajÄ± gÃ¶nderilemedi")}catch(a){console.error("Error testing message:",a),m.error("âŒ Test baÅŸarÄ±sÄ±z")}},u=(a,s)=>{l({...t,[a]:t[a]+` ${s}`})},E=[{code:"{user}",desc:"KullanÄ±cÄ± adÄ±"},{code:"{user_mention}",desc:"KullanÄ±cÄ± mention"},{code:"{server}",desc:"Sunucu adÄ±"},{code:"{member_count}",desc:"Ãœye sayÄ±sÄ±"},{code:"{user_id}",desc:"KullanÄ±cÄ± ID"}];return f?e.createElement("div",{className:"welcome-messages-overlay"},e.createElement("div",{className:"welcome-messages-panel"},e.createElement("div",{className:"loading-state"},e.createElement("div",{className:"spinner"}),e.createElement("p",null,"KarÅŸÄ±lama mesajlarÄ± yÃ¼kleniyor...")))):e.createElement("div",{className:"welcome-messages-overlay",onClick:i},e.createElement("div",{className:"welcome-messages-panel",onClick:a=>a.stopPropagation()},e.createElement("div",{className:"welcome-header"},e.createElement("h2",null,"ğŸ‘‹ KarÅŸÄ±lama & Veda MesajlarÄ±"),e.createElement("button",{className:"close-btn",onClick:i},"Ã—")),d&&e.createElement("div",{className:"stats-overview"},e.createElement("div",{className:"stat-card"},e.createElement("span",{className:"stat-icon"},"ğŸ‘‹"),e.createElement("span",{className:"stat-value"},d.total_welcomes||0),e.createElement("span",{className:"stat-label"},"Toplam KarÅŸÄ±lama")),e.createElement("div",{className:"stat-card"},e.createElement("span",{className:"stat-icon"},"ğŸ˜¢"),e.createElement("span",{className:"stat-value"},d.total_goodbyes||0),e.createElement("span",{className:"stat-label"},"Toplam Veda")),e.createElement("div",{className:"stat-card"},e.createElement("span",{className:"stat-icon"},"ğŸ“…"),e.createElement("span",{className:"stat-value"},d.welcomes_today||0),e.createElement("span",{className:"stat-label"},"BugÃ¼n KatÄ±lan"))),e.createElement("div",{className:"config-content"},e.createElement("div",{className:"config-section"},e.createElement("div",{className:"section-header"},e.createElement("h3",null,"ğŸ‘‹ HoÅŸ Geldin MesajlarÄ±"),e.createElement("label",{className:"toggle-switch"},e.createElement("input",{type:"checkbox",checked:t.welcome_enabled,onChange:a=>l({...t,welcome_enabled:a.target.checked})}),e.createElement("span",{className:"slider"}),e.createElement("span",{className:"toggle-label"},t.welcome_enabled?"Aktif":"Pasif"))),e.createElement("div",{className:"form-grid"},e.createElement("div",{className:"form-group full-width"},e.createElement("label",null,"KarÅŸÄ±lama KanalÄ±"),e.createElement("select",{value:t.welcome_channel_id,onChange:a=>l({...t,welcome_channel_id:a.target.value}),disabled:!t.welcome_enabled},e.createElement("option",{value:""},"Kanal seÃ§in"),b.map(a=>e.createElement("option",{key:a.id,value:a.id},"#",a.name)))),e.createElement("div",{className:"form-group full-width"},e.createElement("label",null,"HoÅŸ Geldin MesajÄ±"),e.createElement("textarea",{value:t.welcome_message,onChange:a=>l({...t,welcome_message:a.target.value}),disabled:!t.welcome_enabled,rows:"3"}),e.createElement("div",{className:"variables-bar"},E.map(a=>e.createElement("button",{key:a.code,className:"variable-btn",onClick:()=>u("welcome_message",a.code),disabled:!t.welcome_enabled,title:a.desc},a.code)))),e.createElement("div",{className:"form-group"},e.createElement("label",{className:"checkbox-label"},e.createElement("input",{type:"checkbox",checked:t.welcome_embed,onChange:a=>l({...t,welcome_embed:a.target.checked}),disabled:!t.welcome_enabled}),e.createElement("span",null,"Embed olarak gÃ¶nder"))),t.welcome_embed&&e.createElement(e.Fragment,null,e.createElement("div",{className:"form-group"},e.createElement("label",null,"Embed Rengi"),e.createElement("input",{type:"color",value:t.welcome_embed_color,onChange:a=>l({...t,welcome_embed_color:a.target.value}),disabled:!t.welcome_enabled})),e.createElement("div",{className:"form-group full-width"},e.createElement("label",null,"Embed BaÅŸlÄ±k"),e.createElement("input",{type:"text",value:t.welcome_embed_title,onChange:a=>l({...t,welcome_embed_title:a.target.value}),disabled:!t.welcome_enabled})),e.createElement("div",{className:"form-group full-width"},e.createElement("label",null,"Embed AÃ§Ä±klama"),e.createElement("textarea",{value:t.welcome_embed_description,onChange:a=>l({...t,welcome_embed_description:a.target.value}),disabled:!t.welcome_enabled,rows:"3"}))),e.createElement("div",{className:"form-group full-width"},e.createElement("label",{className:"checkbox-label"},e.createElement("input",{type:"checkbox",checked:t.welcome_dm,onChange:a=>l({...t,welcome_dm:a.target.checked}),disabled:!t.welcome_enabled}),e.createElement("span",null,"KullanÄ±cÄ±ya DM gÃ¶nder"))),t.welcome_dm&&e.createElement("div",{className:"form-group full-width"},e.createElement("label",null,"DM MesajÄ±"),e.createElement("textarea",{value:t.welcome_dm_message,onChange:a=>l({...t,welcome_dm_message:a.target.value}),disabled:!t.welcome_enabled,rows:"3"}))),e.createElement("button",{className:"test-btn",onClick:S,disabled:!t.welcome_enabled},"ğŸ§ª Test Et")),e.createElement("div",{className:"config-section"},e.createElement("div",{className:"section-header"},e.createElement("h3",null,"ğŸ˜¢ Veda MesajlarÄ±"),e.createElement("label",{className:"toggle-switch"},e.createElement("input",{type:"checkbox",checked:t.goodbye_enabled,onChange:a=>l({...t,goodbye_enabled:a.target.checked})}),e.createElement("span",{className:"slider"}),e.createElement("span",{className:"toggle-label"},t.goodbye_enabled?"Aktif":"Pasif"))),e.createElement("div",{className:"form-grid"},e.createElement("div",{className:"form-group full-width"},e.createElement("label",null,"Veda KanalÄ±"),e.createElement("select",{value:t.goodbye_channel_id,onChange:a=>l({...t,goodbye_channel_id:a.target.value}),disabled:!t.goodbye_enabled},e.createElement("option",{value:""},"Kanal seÃ§in"),b.map(a=>e.createElement("option",{key:a.id,value:a.id},"#",a.name)))),e.createElement("div",{className:"form-group full-width"},e.createElement("label",null,"Veda MesajÄ±"),e.createElement("textarea",{value:t.goodbye_message,onChange:a=>l({...t,goodbye_message:a.target.value}),disabled:!t.goodbye_enabled,rows:"3"}),e.createElement("div",{className:"variables-bar"},E.map(a=>e.createElement("button",{key:a.code,className:"variable-btn",onClick:()=>u("goodbye_message",a.code),disabled:!t.goodbye_enabled,title:a.desc},a.code)))),e.createElement("div",{className:"form-group"},e.createElement("label",{className:"checkbox-label"},e.createElement("input",{type:"checkbox",checked:t.goodbye_embed,onChange:a=>l({...t,goodbye_embed:a.target.checked}),disabled:!t.goodbye_enabled}),e.createElement("span",null,"Embed olarak gÃ¶nder"))),t.goodbye_embed&&e.createElement("div",{className:"form-group"},e.createElement("label",null,"Embed Rengi"),e.createElement("input",{type:"color",value:t.goodbye_embed_color,onChange:a=>l({...t,goodbye_embed_color:a.target.value}),disabled:!t.goodbye_enabled})))),e.createElement("div",{className:"config-section"},e.createElement("div",{className:"section-header"},e.createElement("h3",null,"â­ Otomatik Rol"),e.createElement("label",{className:"toggle-switch"},e.createElement("input",{type:"checkbox",checked:t.auto_role_enabled,onChange:a=>l({...t,auto_role_enabled:a.target.checked})}),e.createElement("span",{className:"slider"}),e.createElement("span",{className:"toggle-label"},t.auto_role_enabled?"Aktif":"Pasif"))),e.createElement("div",{className:"form-group"},e.createElement("label",null,"Otomatik verilecek roller"),e.createElement("div",{className:"roles-selector"},h.map(a=>e.createElement("label",{key:a.id,className:"role-checkbox"},e.createElement("input",{type:"checkbox",checked:t.auto_role_ids.includes(a.id),onChange:s=>{const c=s.target.checked?[...t.auto_role_ids,a.id]:t.auto_role_ids.filter($=>$!==a.id);l({...t,auto_role_ids:c})},disabled:!t.auto_role_enabled}),e.createElement("span",null,a.name)))))),e.createElement("button",{className:"save-btn",onClick:C},"ğŸ’¾ AyarlarÄ± Kaydet"))))};export{B as default};
