import{r as i,aW as C,l as S,d3 as T,ak as G,K as B,a$ as I,bT as j}from"./react-core-B6hadH-M.js";import{t as b}from"./index-D_6pZib5.js";const F=({fetchWithAuth:d,apiBaseUrl:o,onClose:c,serverId:a})=>{const[f,n]=i.useState([]),[r,s]=i.useState(null),[x,E]=i.useState([]),[h,y]=i.useState(!1),[m,g]=i.useState("games");i.useEffect(()=>{v(),R()},[]);const v=async()=>{try{const l=await(await d(`${o}/games/?server_id=${a}`)).json();n(l.games||[])}catch(t){console.error("Failed to fetch games:",t)}},R=async()=>{try{const l=await(await d(`${o}/games/leaderboard/?server_id=${a}`)).json();E(l.leaderboard||[])}catch(t){console.error("Failed to fetch leaderboard:",t)}},k=async t=>{y(!0);try{const u=await(await d(`${o}/games/create/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({game_type:t,server_id:a})})).json();u.game&&(s(u.game),g("playing"),b.success(`${u.game.game_type} started!`))}catch{b.error("Failed to create game")}finally{y(!1)}},w=async(t,l={})=>{if(r)try{const p=await(await d(`${o}/games/${r.id}/action/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:t,data:l})})).json();return p.game&&s(p.game),p.status==="finished"&&(b.success(`Game over! ${p.winners?.join(", ")} won ${p.reward} coins!`),setTimeout(()=>{s(null),g("games"),R()},3e3)),p}catch{b.error("Action failed")}},_={trivia:"ðŸ§ ",word_chain:"ðŸ“",tic_tac_toe:"â­•",rock_paper_scissors:"âœŠ",number_guess:"ðŸ”¢",emoji_quiz:"ðŸ˜€",hangman:"ðŸŽ¯",memory_match:"ðŸƒ"};return React.createElement("div",{style:e.overlay},React.createElement("div",{style:e.modal},React.createElement("div",{style:e.header},React.createElement("div",{style:e.headerLeft},React.createElement(C,{style:{marginRight:"10px",color:"#5865f2"}}),React.createElement("h2",{style:e.title},"Mini Games")),React.createElement("button",{onClick:c,style:e.closeButton},React.createElement(S,null))),React.createElement("div",{style:e.tabs},React.createElement("button",{onClick:()=>g("games"),style:m==="games"?e.activeTab:e.tab},React.createElement(T,null)," Games"),React.createElement("button",{onClick:()=>g("leaderboard"),style:m==="leaderboard"?e.activeTab:e.tab},React.createElement(G,null)," Leaderboard")),React.createElement("div",{style:e.content},m==="games"&&React.createElement("div",{style:e.gamesGrid},f.map(t=>React.createElement("div",{key:t.id,style:e.gameCard},React.createElement("span",{style:e.gameIcon},_[t.id]||"ðŸŽ®"),React.createElement("h3",{style:e.gameName},t.name),React.createElement("p",{style:e.gameDesc},t.description),React.createElement("div",{style:e.gameInfo},React.createElement("span",null,React.createElement(B,null)," ",t.min_players,"-",t.max_players),React.createElement("span",null,React.createElement(I,null)," ",t.reward_coins)),React.createElement("button",{onClick:()=>k(t.id),style:e.playButton,disabled:h},React.createElement(j,null)," Play")))),m==="playing"&&r&&React.createElement(z,{game:r,onAction:w}),m==="leaderboard"&&React.createElement("div",{style:e.leaderboard},x.map((t,l)=>React.createElement("div",{key:t.username,style:e.leaderboardRow},React.createElement("span",{style:e.rank},"#",l+1),React.createElement("span",{style:e.playerName},t.username),React.createElement("span",{style:e.wins},t.wins," wins"),React.createElement("span",{style:e.totalScore},t.total_score," pts"))),x.length===0&&React.createElement("p",{style:e.emptyText},"No games played yet!")))))},z=({game:d,onAction:o})=>{const{game_type:c,state:a,players:f}=d;if(c==="trivia"){const n=a.questions?.[a.current_question];return React.createElement("div",{style:e.gameArea},React.createElement("h3",null,"Question ",a.current_question+1,"/",a.questions?.length),React.createElement("p",{style:e.question},n?.question),React.createElement("div",{style:e.options},n?.options.map((r,s)=>React.createElement("button",{key:s,onClick:()=>o("answer",{answer:s}),style:e.optionButton},r))))}if(c==="tic_tac_toe")return React.createElement("div",{style:e.gameArea},React.createElement("h3",null,"Tic Tac Toe"),React.createElement("div",{style:e.ticTacToeBoard},a.board?.map((n,r)=>React.createElement("button",{key:r,onClick:()=>o("move",{position:r}),style:e.ticTacToeCell,disabled:n!==null},n===0?"âŒ":n===1?"â­•":""))));if(c==="number_guess"){const[n,r]=i.useState("");return React.createElement("div",{style:e.gameArea},React.createElement("h3",null,"Guess the Number (1-100)"),React.createElement("p",null,"Guesses left: ",a.max_guesses-(a.guesses?.length||0)),a.hints?.length>0&&React.createElement("p",null,"Last hint: Go ",a.hints[a.hints.length-1]),React.createElement("input",{type:"number",value:n,onChange:s=>r(s.target.value),style:e.guessInput,min:"1",max:"100"}),React.createElement("button",{onClick:()=>{o("guess",{number:parseInt(n)}),r("")},style:e.guessButton},"Guess!"))}if(c==="rock_paper_scissors")return React.createElement("div",{style:e.gameArea},React.createElement("h3",null,"Rock Paper Scissors - Round ",a.current_round,"/",a.max_rounds),React.createElement("div",{style:e.rpsButtons},["rock","paper","scissors"].map(n=>React.createElement("button",{key:n,onClick:()=>o("choose",{choice:n}),style:e.rpsButton},n==="rock"?"ðŸª¨":n==="paper"?"ðŸ“„":"âœ‚ï¸",React.createElement("span",null,n)))));if(c==="hangman"){const[n,r]=i.useState("");return React.createElement("div",{style:e.gameArea},React.createElement("h3",null,"Hangman"),React.createElement("p",{style:e.hangmanWord},a.display?.join(" ")),React.createElement("p",null,"Wrong guesses: ",a.wrong_guesses,"/",a.max_wrong),React.createElement("p",null,"Used: ",a.guessed_letters?.join(", ")),React.createElement("input",{type:"text",value:n,onChange:s=>r(s.target.value.slice(-1).toUpperCase()),style:e.letterInput,maxLength:1}),React.createElement("button",{onClick:()=>{o("guess_letter",{letter:n}),r("")},style:e.guessButton},"Guess Letter"))}return React.createElement("div",{style:e.gameArea},React.createElement("h3",null,"Game: ",c),React.createElement("p",null,"Game is in progress..."))},e={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e4},modal:{backgroundColor:"#2f3136",borderRadius:"12px",width:"700px",maxHeight:"85vh",overflow:"hidden",display:"flex",flexDirection:"column"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #40444b"},headerLeft:{display:"flex",alignItems:"center"},title:{margin:0,color:"#fff",fontSize:"20px"},closeButton:{background:"none",border:"none",color:"#b9bbbe",cursor:"pointer",fontSize:"20px"},tabs:{display:"flex",padding:"10px 20px",gap:"10px"},tab:{background:"#40444b",border:"none",color:"#b9bbbe",padding:"8px 16px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},activeTab:{background:"#5865f2",border:"none",color:"#fff",padding:"8px 16px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},content:{padding:"20px",overflowY:"auto",flex:1},gamesGrid:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"15px"},gameCard:{background:"#40444b",borderRadius:"10px",padding:"15px",textAlign:"center"},gameIcon:{fontSize:"40px"},gameName:{color:"#fff",margin:"10px 0 5px"},gameDesc:{color:"#b9bbbe",fontSize:"12px",marginBottom:"10px"},gameInfo:{display:"flex",justifyContent:"center",gap:"15px",color:"#b9bbbe",fontSize:"12px",marginBottom:"10px"},playButton:{background:"#5865f2",border:"none",color:"#fff",padding:"8px 20px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",margin:"0 auto"},gameArea:{textAlign:"center",color:"#fff"},question:{fontSize:"18px",marginBottom:"20px"},options:{display:"flex",flexDirection:"column",gap:"10px"},optionButton:{background:"#40444b",border:"none",color:"#fff",padding:"12px",borderRadius:"8px",cursor:"pointer",fontSize:"14px",transition:"background 0.2s"},ticTacToeBoard:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"5px",width:"200px",margin:"20px auto"},ticTacToeCell:{width:"60px",height:"60px",background:"#40444b",border:"none",borderRadius:"8px",fontSize:"30px",cursor:"pointer"},guessInput:{background:"#40444b",border:"none",color:"#fff",padding:"10px",borderRadius:"6px",width:"100px",textAlign:"center",fontSize:"18px"},guessButton:{background:"#5865f2",border:"none",color:"#fff",padding:"10px 20px",borderRadius:"6px",cursor:"pointer",marginLeft:"10px"},letterInput:{background:"#40444b",border:"none",color:"#fff",padding:"10px",borderRadius:"6px",width:"50px",textAlign:"center",fontSize:"24px",textTransform:"uppercase"},rpsButtons:{display:"flex",justifyContent:"center",gap:"20px"},rpsButton:{background:"#40444b",border:"none",color:"#fff",padding:"20px",borderRadius:"12px",cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",gap:"5px",fontSize:"40px"},hangmanWord:{fontSize:"32px",letterSpacing:"8px",marginBottom:"20px"},leaderboard:{display:"flex",flexDirection:"column",gap:"10px"},leaderboardRow:{display:"flex",alignItems:"center",gap:"15px",background:"#40444b",padding:"12px 15px",borderRadius:"8px"},rank:{color:"#faa61a",fontWeight:"bold",width:"40px"},playerName:{color:"#fff",flex:1},wins:{color:"#57f287"},totalScore:{color:"#b9bbbe"},emptyText:{color:"#72767d",textAlign:"center",padding:"40px"}};export{F as default};
