var R=Object.defineProperty;var r=(s,n)=>R(s,"name",{value:n,configurable:!0});import{r as d,j as e}from"./react-core-Djgtqrmb.js";import{bF as g,a as z,a5 as E,z as D,aL as L,w as k}from"./icons-vendor-BW7dxHkX.js";import{t as l}from"./index-B9TNnJpS.js";import"./media-vendor-CxFPycob.js";import"./router-vendor-ClgLnMjk.js";import"./state-vendor-BRqaXHJQ.js";import"./crypto-vendor-D1XRGppi.js";import"./ui-vendor-IhB9Znpc.js";const O=r(({fetchWithAuth:s,apiBaseUrl:n,onClose:m})=>{const[c,h]=d.useState([]),[b,x]=d.useState(!1),[p,f]=d.useState(!1);d.useEffect(()=>{u()},[]);const u=r(async()=>{x(!0);try{const i=await(await s(`${n}/gdpr/exports/`)).json();h(i.exports||[])}catch{l.error("Failed to load exports")}finally{x(!1)}},"fetchExports"),j=r(async()=>{f(!0);try{await s(`${n}/gdpr/request-export/`,{method:"POST"}),l.success("Export requested. You will be notified when it's ready (usually within 24 hours)"),u()}catch{l.error("Failed to request export")}finally{f(!1)}},"requestExport"),w=r(async o=>{try{const C=await(await s(`${n}/gdpr/exports/${o}/download/`)).blob(),y=window.URL.createObjectURL(C),a=document.createElement("a");a.href=y,a.download=`pawscord_data_export_${o}.zip`,document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(y),document.body.removeChild(a),l.success("Export downloaded")}catch{l.error("Failed to download export")}},"downloadExport"),v=r(o=>{switch(o){case"completed":return e.jsx(k,{style:{color:"#43b581"}});case"failed":return e.jsx(L,{style:{color:"#f04747"}});default:return e.jsx(D,{style:{color:"#faa61a"}})}},"getStatusIcon"),S=r(o=>{switch(o){case"pending":return"Processing...";case"completed":return"Ready to Download";case"failed":return"Failed";default:return o}},"getStatusText");return e.jsx("div",{style:t.overlay,children:e.jsxs("div",{style:t.modal,children:[e.jsxs("div",{style:t.header,children:[e.jsxs("div",{style:t.headerLeft,children:[e.jsx(g,{style:{marginRight:"10px",color:"#5865f2"}}),e.jsx("h2",{style:t.title,children:"GDPR Data Export"})]}),e.jsx("button",{onClick:m,style:t.closeButton,children:e.jsx(z,{})})]}),e.jsxs("div",{style:t.info,children:[e.jsx("p",{style:t.infoText,children:"Request a complete archive of your data. This includes messages, media, profile information, and activity logs. Exports are usually ready within 24 hours."}),e.jsx("button",{onClick:j,disabled:p,style:t.requestButton,children:p?"Requesting...":"Request New Export"})]}),e.jsx("div",{style:t.content,children:b?e.jsx("div",{style:t.loading,children:"Loading exports..."}):c.length===0?e.jsxs("div",{style:t.empty,children:[e.jsx(g,{style:{fontSize:"48px",color:"#2c2f33",marginBottom:"16px"}}),e.jsx("div",{children:"No exports yet"}),e.jsx("div",{style:t.emptySubtext,children:"Request your first data export above"})]}):e.jsx("div",{style:t.exportsList,children:c.map((o,i)=>e.jsxs("div",{style:t.exportCard,children:[e.jsx("div",{style:t.exportIcon,children:v(o.status)}),e.jsxs("div",{style:t.exportInfo,children:[e.jsx("div",{style:t.exportStatus,children:S(o.status)}),e.jsxs("div",{style:t.exportMeta,children:["Requested: ",new Date(o.created_at).toLocaleString()]}),o.completed_at&&e.jsxs("div",{style:t.exportMeta,children:["Completed: ",new Date(o.completed_at).toLocaleString()]}),o.file_size&&e.jsxs("div",{style:t.exportMeta,children:["Size: ",(o.file_size/1024/1024).toFixed(2)," MB"]}),o.expires_at&&e.jsxs("div",{style:t.exportMeta,children:["Expires: ",new Date(o.expires_at).toLocaleDateString()]})]}),o.status==="completed"&&e.jsxs("button",{onClick:r(()=>w(o.id),"onClick"),style:t.downloadButton,title:"Download",children:[e.jsx(E,{style:{marginRight:"6px"}}),"Download"]})]},i))})})]})})},"GDPRExportPanel"),t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999},modal:{backgroundColor:"#1e1e1e",borderRadius:"8px",width:"90%",maxWidth:"700px",maxHeight:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #2c2f33"},headerLeft:{display:"flex",alignItems:"center"},title:{margin:0,fontSize:"20px",color:"#ffffff"},closeButton:{background:"none",border:"none",color:"#99aab5",cursor:"pointer",fontSize:"20px",padding:"5px"},info:{padding:"20px",borderBottom:"1px solid #2c2f33"},infoText:{fontSize:"14px",color:"#dcddde",lineHeight:"1.6",margin:"0 0 16px 0"},requestButton:{padding:"10px 20px",backgroundColor:"#5865f2",border:"none",borderRadius:"4px",color:"#ffffff",cursor:"pointer",fontSize:"14px",fontWeight:"600",width:"100%"},content:{padding:"20px",overflowY:"auto",flex:1},loading:{textAlign:"center",color:"#99aab5",padding:"40px"},empty:{textAlign:"center",color:"#99aab5",padding:"60px 20px",display:"flex",flexDirection:"column",alignItems:"center"},emptySubtext:{fontSize:"13px",marginTop:"8px"},exportsList:{display:"flex",flexDirection:"column",gap:"12px"},exportCard:{backgroundColor:"#2c2f33",borderRadius:"8px",padding:"16px",display:"flex",gap:"16px",alignItems:"flex-start"},exportIcon:{fontSize:"24px",minWidth:"30px",display:"flex",alignItems:"center",justifyContent:"center"},exportInfo:{flex:1},exportStatus:{fontSize:"16px",fontWeight:"600",color:"#ffffff",marginBottom:"6px"},exportMeta:{fontSize:"13px",color:"#99aab5",marginTop:"4px"},downloadButton:{padding:"8px 16px",backgroundColor:"#43b581",border:"none",borderRadius:"4px",color:"#ffffff",cursor:"pointer",fontSize:"13px",fontWeight:"500",display:"flex",alignItems:"center"}};export{O as default};
