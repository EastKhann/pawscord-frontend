import{r,d as e,ad as D,i as z,ag as F,ci as B,ae as $,cl as j}from"./react-core-DrOm_csO.js";import{t as y}from"./index-DmEhdEtw.js";const M=({fetchWithAuth:s,apiBaseUrl:d,onClose:E,roomSlug:c})=>{const[i,v]=r.useState(null),[p,C]=r.useState([]),[f,S]=r.useState([]),[k,x]=r.useState(!1),[o,m]=r.useState("heatmap");r.useEffect(()=>{w(),L(),R()},[c]);const w=async()=>{x(!0);try{const l=await(await s(`${d}/rooms/${c}/reaction_heatmap/`)).json();v(l)}catch{y.error("Failed to load reaction heatmap")}finally{x(!1)}},L=async()=>{try{const l=await(await s(`${d}/rooms/${c}/reactions/daily/`)).json();C(l.stats||[])}catch{y.error("Failed to load daily stats")}},R=async()=>{try{const l=await(await s(`${d}/leaderboards/reactions/`)).json();S(l.leaderboard||[])}catch{y.error("Failed to load leaderboard")}},g=(a,l)=>{const n=a/l*100;return n>75?"#f04747":n>50?"#faa61a":n>25?"#5865f2":"#2c2f33"},b=Array.from({length:24},(a,l)=>l),h=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];return e.createElement("div",{style:t.overlay},e.createElement("div",{style:t.modal},e.createElement("div",{style:t.header},e.createElement("div",{style:t.headerLeft},e.createElement(D,{style:{marginRight:"10px",color:"#5865f2"}}),e.createElement("h2",{style:t.title},"Reaction Analytics")),e.createElement("button",{onClick:E,style:t.closeButton},e.createElement(z,null))),e.createElement("div",{style:t.tabs},e.createElement("button",{onClick:()=>m("heatmap"),style:{...t.tab,...o==="heatmap"&&t.tabActive}},e.createElement(F,{style:{marginRight:"5px"}}),"Heatmap"),e.createElement("button",{onClick:()=>m("daily"),style:{...t.tab,...o==="daily"&&t.tabActive}},e.createElement(B,{style:{marginRight:"5px"}}),"Daily Stats"),e.createElement("button",{onClick:()=>m("leaderboard"),style:{...t.tab,...o==="leaderboard"&&t.tabActive}},e.createElement($,{style:{marginRight:"5px"}}),"Leaderboard")),e.createElement("div",{style:t.content},k?e.createElement("div",{style:t.loading},"Loading analytics..."):o==="heatmap"?e.createElement("div",{style:t.heatmapContainer},e.createElement("div",{style:t.heatmapGrid},e.createElement("div",{style:t.heatmapYAxis},h.map(a=>e.createElement("div",{key:a,style:t.dayLabel},a))),e.createElement("div",{style:t.heatmapCells},i&&i.data&&h.map((a,l)=>e.createElement("div",{key:a,style:t.heatmapRow},b.map(n=>{const u=i.data[l]?.[n]||0,A=Math.max(...i.data.flat().filter(I=>I)||[1]);return e.createElement("div",{key:n,style:{...t.heatmapCell,backgroundColor:g(u,A)},title:`${a} ${n}:00 - ${u} reactions`})}))),e.createElement("div",{style:t.heatmapXAxis},b.filter(a=>a%3===0).map(a=>e.createElement("div",{key:a,style:t.hourLabel},a,"h"))))),e.createElement("div",{style:t.legend},e.createElement("span",{style:t.legendLabel},"Less"),[0,25,50,75,100].map(a=>e.createElement("div",{key:a,style:{...t.legendBox,backgroundColor:g(a,100)}})),e.createElement("span",{style:t.legendLabel},"More"))):o==="daily"?e.createElement("div",{style:t.dailyStats},p.length===0?e.createElement("div",{style:t.empty},"No daily stats available"):e.createElement("div",{style:t.chartContainer},p.map((a,l)=>e.createElement("div",{key:l,style:t.statBar},e.createElement("div",{style:t.statDate},new Date(a.date).toLocaleDateString()),e.createElement("div",{style:t.barContainer},e.createElement("div",{style:{...t.bar,width:`${a.count/Math.max(...p.map(n=>n.count))*100}%`}})),e.createElement("div",{style:t.statCount},a.count))))):e.createElement("div",{style:t.leaderboard},f.length===0?e.createElement("div",{style:t.empty},"No leaderboard data available"):f.map((a,l)=>e.createElement("div",{key:l,style:t.leaderboardItem},e.createElement("div",{style:t.rank},l===0?"ðŸ¥‡":l===1?"ðŸ¥ˆ":l===2?"ðŸ¥‰":`#${l+1}`),e.createElement("div",{style:t.userInfo},e.createElement("div",{style:t.username},a.username),e.createElement("div",{style:t.userReactions},e.createElement(j,{style:{color:"#f04747",marginRight:"5px"}}),a.reaction_count," reactions"))))))))},t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999},modal:{backgroundColor:"#1e1e1e",borderRadius:"8px",width:"90%",maxWidth:"1000px",maxHeight:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #2c2f33"},headerLeft:{display:"flex",alignItems:"center"},title:{margin:0,fontSize:"20px",color:"#ffffff"},closeButton:{background:"none",border:"none",color:"#99aab5",cursor:"pointer",fontSize:"20px",padding:"5px"},tabs:{display:"flex",borderBottom:"1px solid #2c2f33",padding:"0 20px"},tab:{padding:"12px 20px",backgroundColor:"transparent",border:"none",color:"#99aab5",cursor:"pointer",fontSize:"14px",display:"flex",alignItems:"center",borderBottom:"2px solid transparent"},tabActive:{color:"#5865f2",borderBottom:"2px solid #5865f2"},content:{padding:"20px",overflowY:"auto",flex:1},loading:{textAlign:"center",color:"#99aab5",padding:"40px"},empty:{textAlign:"center",color:"#99aab5",padding:"40px"},heatmapContainer:{display:"flex",flexDirection:"column",gap:"20px"},heatmapGrid:{display:"flex",gap:"10px"},heatmapYAxis:{display:"flex",flexDirection:"column",justifyContent:"space-around"},dayLabel:{fontSize:"12px",color:"#99aab5",height:"20px",display:"flex",alignItems:"center"},heatmapCells:{flex:1},heatmapRow:{display:"flex",gap:"2px",marginBottom:"2px"},heatmapCell:{width:"20px",height:"20px",borderRadius:"2px",cursor:"pointer"},heatmapXAxis:{display:"flex",justifyContent:"space-around",marginTop:"5px"},hourLabel:{fontSize:"11px",color:"#99aab5"},legend:{display:"flex",alignItems:"center",gap:"5px",justifyContent:"center"},legendLabel:{fontSize:"12px",color:"#99aab5"},legendBox:{width:"15px",height:"15px",borderRadius:"2px"},dailyStats:{display:"flex",flexDirection:"column"},chartContainer:{display:"flex",flexDirection:"column",gap:"12px"},statBar:{display:"grid",gridTemplateColumns:"100px 1fr 60px",alignItems:"center",gap:"12px"},statDate:{fontSize:"13px",color:"#dcddde"},barContainer:{height:"24px",backgroundColor:"#2c2f33",borderRadius:"4px",overflow:"hidden"},bar:{height:"100%",backgroundColor:"#5865f2",transition:"width 0.3s"},statCount:{fontSize:"14px",fontWeight:"600",color:"#ffffff",textAlign:"right"},leaderboard:{display:"flex",flexDirection:"column",gap:"12px"},leaderboardItem:{backgroundColor:"#2c2f33",borderRadius:"6px",padding:"16px",display:"flex",alignItems:"center",gap:"16px"},rank:{fontSize:"24px",fontWeight:"600",minWidth:"60px",textAlign:"center"},userInfo:{flex:1},username:{fontSize:"16px",fontWeight:"600",color:"#ffffff",marginBottom:"4px"},userReactions:{fontSize:"14px",color:"#99aab5",display:"flex",alignItems:"center"}};export{M as default};
