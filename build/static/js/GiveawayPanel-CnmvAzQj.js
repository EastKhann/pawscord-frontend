var S=Object.defineProperty;var i=(s,l)=>S(s,"name",{value:l,configurable:!0});import{r as j,j as e}from"./react-core-Djgtqrmb.js";import{y as t}from"./ui-vendor-IhB9Znpc.js";import{d as b,g as z}from"./index-D0nbcjO7.js";import"./media-vendor-CxFPycob.js";import"./router-vendor-gmJ9Mn-1.js";import"./state-vendor-CbW2fAN9.js";import"./crypto-vendor-D1XRGppi.js";import"./icons-vendor-BMXAt4pj.js";const w={title:"",description:"",prize:"",channel_id:"",winners_count:1,duration:3600,required_role_id:"",required_messages:0,required_invites:0,allow_multiple_entries:!1},$=[{value:1800,label:"30 dakika"},{value:3600,label:"1 saat"},{value:10800,label:"3 saat"},{value:21600,label:"6 saat"},{value:43200,label:"12 saat"},{value:86400,label:"1 gÃ¼n"},{value:172800,label:"2 gÃ¼n"},{value:259200,label:"3 gÃ¼n"},{value:604800,label:"1 hafta"}],q=i(s=>{const l={active:{text:"Aktif",color:"#10b981"},ended:{text:"SonlandÄ±",color:"#6b7280"},cancelled:{text:"Ä°ptal",color:"#ef4444"}};return l[s]||l.active},"getStatusBadge"),G=i(s=>{const l=Math.floor((new Date(s)-new Date)/1e3);if(l<=0)return"Sona erdi";const o=Math.floor(l/86400),d=Math.floor(l%86400/3600),h=Math.floor(l%3600/60);return o>0?`${o}g ${d}s kaldÄ±`:d>0?`${d}s ${h}dk kaldÄ±`:`${h} dakika kaldÄ±`},"formatTimeRemaining"),M=i(s=>{const l=z(),[o,d]=j.useState([]),[h,u]=j.useState(!0),[r,a]=j.useState(!1),[v,N]=j.useState([]),[g,y]=j.useState([]),[x,k]=j.useState(w),c={Authorization:`Bearer ${localStorage.getItem("access_token")}`},p=i(async()=>{try{const n=await fetch(`${l}/giveaways/server/${s}/`,{headers:c});n.ok&&d(await n.json())}catch{}finally{u(!1)}},"fetchGiveaways"),_=i(async()=>{try{const n=await fetch(`${l}/channels/server/${s}/`,{headers:c});if(n.ok){const m=await n.json();N(m.filter(f=>f.type==="text"))}}catch{}},"fetchChannels"),C=i(async()=>{try{const n=await fetch(`${l}/roles/server/${s}/`,{headers:c});n.ok&&y(await n.json())}catch{}},"fetchRoles");return j.useEffect(()=>{p(),_(),C()},[s]),{giveaways:o,loading:h,showCreateModal:r,setShowCreateModal:a,channels:v,roles:g,newGiveaway:x,setNewGiveaway:k,createGiveaway:i(async()=>{if(!x.title||!x.prize||!x.channel_id){t.error("âŒ LÃ¼tfen tÃ¼m gerekli alanlarÄ± doldurun");return}try{(await fetch(`${l}/giveaways/create/`,{method:"POST",headers:{...c,"Content-Type":"application/json"},body:JSON.stringify({server_id:s,...x})})).ok?(t.success("âœ… Ã‡ekiliÅŸ oluÅŸturuldu!"),a(!1),p(),k(w)):t.error("âŒ Ã‡ekiliÅŸ oluÅŸturulamadÄ±")}catch{t.error("âŒ BaÄŸlantÄ± hatasÄ±")}},"createGiveaway"),endGiveaway:i(async n=>{if(await b("Ã‡ekiliÅŸi sonlandÄ±rmak istediÄŸinize emin misiniz?"))try{const m=await fetch(`${l}/giveaways/${n}/end/`,{method:"POST",headers:c});if(m.ok){const f=await m.json();t.success(`âœ… Ã‡ekiliÅŸ sonlandÄ±! Kazananlar: ${f.winners.join(", ")}`),p()}else t.error("âŒ Ã‡ekiliÅŸ sonlandÄ±rÄ±lamadÄ±")}catch{t.error("âŒ BaÄŸlantÄ± hatasÄ±")}},"endGiveaway"),rerollGiveaway:i(async n=>{try{const m=await fetch(`${l}/giveaways/${n}/reroll/`,{method:"POST",headers:c});if(m.ok){const f=await m.json();t.success(`âœ… Yeni kazanan: ${f.new_winner}`),p()}else t.error("âŒ Reroll yapÄ±lamadÄ±")}catch{t.error("âŒ BaÄŸlantÄ± hatasÄ±")}},"rerollGiveaway"),deleteGiveaway:i(async n=>{if(await b("Ã‡ekiliÅŸi silmek istediÄŸinize emin misiniz?"))try{(await fetch(`${l}/giveaways/${n}/delete/`,{method:"DELETE",headers:c})).ok?(t.success("âœ… Ã‡ekiliÅŸ silindi"),p()):t.error("âŒ Ã‡ekiliÅŸ silinemedi")}catch{t.error("âŒ BaÄŸlantÄ± hatasÄ±")}},"deleteGiveaway")}},"useGiveaways"),O=i(({giveaway:s,onEnd:l,onReroll:o,onDelete:d})=>{const h=q(s.status);return e.jsxs("div",{className:"giveaway-card",children:[e.jsxs("div",{className:"giveaway-card-header",children:[e.jsx("h3",{children:s.title}),e.jsx("span",{className:"status-badge",style:{background:h.color},children:h.text})]}),e.jsxs("div",{className:"giveaway-card-body",children:[e.jsxs("div",{className:"giveaway-prize",children:[e.jsx("span",{className:"prize-icon",children:"ðŸŽ"}),e.jsx("span",{className:"prize-text",children:s.prize})]}),s.description&&e.jsx("p",{className:"giveaway-description",children:s.description}),e.jsxs("div",{className:"giveaway-info",children:[e.jsxs("div",{className:"info-item",children:[e.jsxs("span",{className:"info-label",children:["Kazanan Say","Ä±","s","Ä±",":"]}),e.jsxs("span",{className:"info-value",children:[s.winners_count," ki","ÅŸ","i"]})]}),e.jsxs("div",{className:"info-item",children:[e.jsxs("span",{className:"info-label",children:["Kat","Ä±","l","Ä±","mc","Ä±","lar:"]}),e.jsxs("span",{className:"info-value",children:[s.entries_count||0," ki","ÅŸ","i"]})]}),s.status==="active"&&e.jsxs("div",{className:"info-item",children:[e.jsxs("span",{className:"info-label",children:["Kalan S","Ã¼","re:"]}),e.jsx("span",{className:"info-value time-remaining",children:G(s.end_time)})]})]}),s.required_role_id&&e.jsxs("div",{className:"requirement-badge",children:["â­"," Rol gereksinimi var"]}),s.required_messages>0&&e.jsxs("div",{className:"requirement-badge",children:["ðŸ’¬"," ",s.required_messages," mesaj gerekli"]}),s.required_invites>0&&e.jsxs("div",{className:"requirement-badge",children:["ðŸ‘¥"," ",s.required_invites," davet gerekli"]}),s.winners&&s.winners.length>0&&e.jsxs("div",{className:"winners-section",children:[e.jsxs("h4",{children:["ðŸŽ‰"," Kazananlar:"]}),e.jsx("ul",{className:"winners-list",children:s.winners.map((u,r)=>e.jsx("li",{children:u},r))})]})]}),e.jsxs("div",{className:"giveaway-card-footer",children:[s.status==="active"&&e.jsxs("button",{className:"end-btn",onClick:i(()=>l(s.id),"onClick"),children:["ðŸ"," Sonland","Ä±","r"]}),s.status==="ended"&&e.jsxs("button",{className:"reroll-btn",onClick:i(()=>o(s.id),"onClick"),children:["ðŸ”„"," Reroll"]}),e.jsxs("button",{className:"delete-btn",onClick:i(()=>d(s.id),"onClick"),children:["ðŸ—‘ï¸"," Sil"]})]})]})},"GiveawayCard"),R=i(({newGiveaway:s,setNewGiveaway:l,channels:o,roles:d,onCreate:h,onClose:u})=>{const r=i((a,v)=>l({...s,[a]:v}),"update");return e.jsx("div",{className:"create-modal-overlay",onClick:u,children:e.jsxs("div",{className:"create-modal",onClick:i(a=>a.stopPropagation(),"onClick"),children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("h3",{children:["Yeni ","Ã‡","ekili","ÅŸ"," Olu","ÅŸ","tur"]}),e.jsx("button",{className:"close-btn",onClick:u,children:"Ã—"})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["Ba","ÅŸ","l","Ä±","k *"]}),e.jsx("input",{type:"text",placeholder:"Discord Nitro Ã‡ekiliÅŸi",value:s.title,onChange:i(a=>r("title",a.target.value),"onChange")})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["A","Ã§Ä±","klama"]}),e.jsx("textarea",{placeholder:"Ã‡ekiliÅŸ hakkÄ±nda detaylar...",value:s.description,onChange:i(a=>r("description",a.target.value),"onChange"),rows:"3"})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["Ã–","d","Ã¼","l *"]}),e.jsx("input",{type:"text",placeholder:"1 AylÄ±k Discord Nitro",value:s.prize,onChange:i(a=>r("prize",a.target.value),"onChange")})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kanal *"}),e.jsxs("select",{value:s.channel_id,onChange:i(a=>r("channel_id",a.target.value),"onChange"),children:[e.jsxs("option",{value:"",children:["Kanal Se","Ã§","in"]}),o.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["Kazanan Say","Ä±","s","Ä±"]}),e.jsx("input",{type:"number",min:"1",max:"100",value:s.winners_count,onChange:i(a=>r("winners_count",parseInt(a.target.value)),"onChange")})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["S","Ã¼","re"]}),e.jsx("select",{value:s.duration,onChange:i(a=>r("duration",parseInt(a.target.value)),"onChange"),children:$.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})]}),e.jsxs("div",{className:"requirements-section",children:[e.jsxs("h4",{children:["Kat","Ä±","l","Ä±","m Gereksinimleri (Opsiyonel)"]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Gerekli Rol"}),e.jsxs("select",{value:s.required_role_id,onChange:i(a=>r("required_role_id",a.target.value),"onChange"),children:[e.jsx("option",{value:"",children:"Rol yok"}),d.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["Minimum Mesaj Say","Ä±","s","Ä±"]}),e.jsx("input",{type:"number",min:"0",value:s.required_messages,onChange:i(a=>r("required_messages",parseInt(a.target.value)),"onChange")})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["Minimum Davet Say","Ä±","s","Ä±"]}),e.jsx("input",{type:"number",min:"0",value:s.required_invites,onChange:i(a=>r("required_invites",parseInt(a.target.value)),"onChange")})]})]}),e.jsx("div",{className:"form-group",children:e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:s.allow_multiple_entries,onChange:i(a=>r("allow_multiple_entries",a.target.checked),"onChange")}),e.jsxs("span",{children:["Birden fazla kat","Ä±","l","Ä±","ma izin ver"]})]})})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsxs("button",{className:"cancel-btn",onClick:u,children:["Ä°","ptal"]}),e.jsxs("button",{className:"submit-btn",onClick:h,children:["ðŸŽ‰"," ","Ã‡","ekili","ÅŸ"," Olu","ÅŸ","tur"]})]})]})})},"CreateGiveawayModal"),V=i(({serverId:s,onClose:l})=>{const{giveaways:o,loading:d,showCreateModal:h,setShowCreateModal:u,channels:r,roles:a,newGiveaway:v,setNewGiveaway:N,createGiveaway:g,endGiveaway:y,rerollGiveaway:x,deleteGiveaway:k}=M(s);return e.jsx("div",{className:"giveaway-panel-overlay",onClick:l,children:e.jsxs("div",{className:"giveaway-panel",onClick:i(c=>c.stopPropagation(),"onClick"),children:[e.jsxs("div",{className:"giveaway-header",children:[e.jsxs("h2",{children:["ðŸŽ‰"," ","Ã‡","ekili","ÅŸ","ler"]}),e.jsx("button",{className:"close-btn",onClick:l,children:"Ã—"})]}),e.jsxs("div",{className:"giveaway-content",children:[e.jsx("div",{className:"giveaway-actions",children:e.jsxs("button",{className:"create-giveaway-btn",onClick:i(()=>u(!0),"onClick"),children:["+ Yeni ","Ã‡","ekili","ÅŸ"," Olu","ÅŸ","tur"]})}),d?e.jsxs("div",{className:"loading-state",children:[e.jsx("div",{className:"spinner"}),e.jsxs("p",{children:["Ã‡","ekili","ÅŸ","ler y","Ã¼","kleniyor..."]})]}):o.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("span",{className:"empty-icon",children:"ðŸŽ"}),e.jsxs("p",{children:["Hen","Ã¼","z ","Ã§","ekili","ÅŸ"," yok"]}),e.jsxs("span",{className:"empty-hint",children:["Yeni bir ","Ã§","ekili","ÅŸ"," olu","ÅŸ","turun!"]})]}):e.jsx("div",{className:"giveaways-list",children:o.map(c=>e.jsx(O,{giveaway:c,onEnd:y,onReroll:x,onDelete:k},c.id))})]}),h&&e.jsx(R,{newGiveaway:v,setNewGiveaway:N,channels:r,roles:a,onCreate:g,onClose:i(()=>u(!1),"onClose")})]})})},"GiveawayPanel");export{V as default};
