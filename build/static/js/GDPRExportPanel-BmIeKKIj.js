import{r as i,n as e}from"./react-core-Cj7FUMmY.js";import{bG as y,a as C,ao as R,E,aZ as z,B as D}from"./icons-vendor-DnRG7SaF.js";import{t as n}from"./index-DYGEX0PV.js";import"./editor-vendor-D9c4a6XZ.js";import"./media-vendor-BsD1gqUZ.js";import"./router-vendor-QeioVw-9.js";import"./state-vendor-MN-5i-Jz.js";import"./crypto-vendor-DK-7ILyQ.js";const M=({fetchWithAuth:a,apiBaseUrl:l,onClose:g})=>{const[d,m]=i.useState([]),[h,c]=i.useState(!1),[x,p]=i.useState(!1);i.useEffect(()=>{f()},[]);const f=async()=>{c(!0);try{const r=await(await a(`${l}/gdpr/exports/`)).json();m(r.exports||[])}catch{n.error("Failed to load exports")}finally{c(!1)}},b=async()=>{p(!0);try{await a(`${l}/gdpr/request-export/`,{method:"POST"}),n.success("Export requested. You will be notified when it's ready (usually within 24 hours)"),f()}catch{n.error("Failed to request export")}finally{p(!1)}},j=async o=>{try{const S=await(await a(`${l}/gdpr/exports/${o}/download/`)).blob(),u=window.URL.createObjectURL(S),s=document.createElement("a");s.href=u,s.download=`pawscord_data_export_${o}.zip`,document.body.appendChild(s),s.click(),window.URL.revokeObjectURL(u),document.body.removeChild(s),n.success("Export downloaded")}catch{n.error("Failed to download export")}},w=o=>{switch(o){case"completed":return e.jsx(D,{style:{color:"#43b581"}});case"failed":return e.jsx(z,{style:{color:"#f04747"}});default:return e.jsx(E,{style:{color:"#faa61a"}})}},v=o=>{switch(o){case"pending":return"Processing...";case"completed":return"Ready to Download";case"failed":return"Failed";default:return o}};return e.jsx("div",{style:t.overlay,children:e.jsxs("div",{style:t.modal,children:[e.jsxs("div",{style:t.header,children:[e.jsxs("div",{style:t.headerLeft,children:[e.jsx(y,{style:{marginRight:"10px",color:"#5865f2"}}),e.jsx("h2",{style:t.title,children:"GDPR Data Export"})]}),e.jsx("button",{onClick:g,style:t.closeButton,children:e.jsx(C,{})})]}),e.jsxs("div",{style:t.info,children:[e.jsx("p",{style:t.infoText,children:"Request a complete archive of your data. This includes messages, media, profile information, and activity logs. Exports are usually ready within 24 hours."}),e.jsx("button",{onClick:b,disabled:x,style:t.requestButton,children:x?"Requesting...":"Request New Export"})]}),e.jsx("div",{style:t.content,children:h?e.jsx("div",{style:t.loading,children:"Loading exports..."}):d.length===0?e.jsxs("div",{style:t.empty,children:[e.jsx(y,{style:{fontSize:"48px",color:"#2c2f33",marginBottom:"16px"}}),e.jsx("div",{children:"No exports yet"}),e.jsx("div",{style:t.emptySubtext,children:"Request your first data export above"})]}):e.jsx("div",{style:t.exportsList,children:d.map((o,r)=>e.jsxs("div",{style:t.exportCard,children:[e.jsx("div",{style:t.exportIcon,children:w(o.status)}),e.jsxs("div",{style:t.exportInfo,children:[e.jsx("div",{style:t.exportStatus,children:v(o.status)}),e.jsxs("div",{style:t.exportMeta,children:["Requested: ",new Date(o.created_at).toLocaleString()]}),o.completed_at&&e.jsxs("div",{style:t.exportMeta,children:["Completed: ",new Date(o.completed_at).toLocaleString()]}),o.file_size&&e.jsxs("div",{style:t.exportMeta,children:["Size: ",(o.file_size/1024/1024).toFixed(2)," MB"]}),o.expires_at&&e.jsxs("div",{style:t.exportMeta,children:["Expires: ",new Date(o.expires_at).toLocaleDateString()]})]}),o.status==="completed"&&e.jsxs("button",{onClick:()=>j(o.id),style:t.downloadButton,title:"Download",children:[e.jsx(R,{style:{marginRight:"6px"}}),"Download"]})]},r))})})]})})},t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999},modal:{backgroundColor:"#1e1e1e",borderRadius:"8px",width:"90%",maxWidth:"700px",maxHeight:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #2c2f33"},headerLeft:{display:"flex",alignItems:"center"},title:{margin:0,fontSize:"20px",color:"#ffffff"},closeButton:{background:"none",border:"none",color:"#99aab5",cursor:"pointer",fontSize:"20px",padding:"5px"},info:{padding:"20px",borderBottom:"1px solid #2c2f33"},infoText:{fontSize:"14px",color:"#dcddde",lineHeight:"1.6",margin:"0 0 16px 0"},requestButton:{padding:"10px 20px",backgroundColor:"#5865f2",border:"none",borderRadius:"4px",color:"#ffffff",cursor:"pointer",fontSize:"14px",fontWeight:"600",width:"100%"},content:{padding:"20px",overflowY:"auto",flex:1},loading:{textAlign:"center",color:"#99aab5",padding:"40px"},empty:{textAlign:"center",color:"#99aab5",padding:"60px 20px",display:"flex",flexDirection:"column",alignItems:"center"},emptySubtext:{fontSize:"13px",marginTop:"8px"},exportsList:{display:"flex",flexDirection:"column",gap:"12px"},exportCard:{backgroundColor:"#2c2f33",borderRadius:"8px",padding:"16px",display:"flex",gap:"16px",alignItems:"flex-start"},exportIcon:{fontSize:"24px",minWidth:"30px",display:"flex",alignItems:"center",justifyContent:"center"},exportInfo:{flex:1},exportStatus:{fontSize:"16px",fontWeight:"600",color:"#ffffff",marginBottom:"6px"},exportMeta:{fontSize:"13px",color:"#99aab5",marginTop:"4px"},downloadButton:{padding:"8px 16px",backgroundColor:"#43b581",border:"none",borderRadius:"4px",color:"#ffffff",cursor:"pointer",fontSize:"13px",fontWeight:"500",display:"flex",alignItems:"center"}};export{M as default};
