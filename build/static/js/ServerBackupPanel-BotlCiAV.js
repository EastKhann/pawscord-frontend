import{r as s,ch as c}from"./react-core-B6hadH-M.js";import{g as v,h as k}from"./index-D_6pZib5.js";const z=({serverId:r,onClose:u})=>{const n=v(),[o,h]=s.useState([]),[E,g]=s.useState(!0),[d,p]=s.useState(!1),[t,l]=s.useState({include_channels:!0,include_roles:!0,include_messages:!1,include_settings:!0,include_emojis:!0});s.useEffect(()=>{i()},[r]);const i=async()=>{try{const e=await fetch(`${n}/backups/server/${r}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(e.ok){const a=await e.json();h(a)}}catch(e){console.error("Error:",e)}finally{g(!1)}},R=async()=>{p(!0);try{(await fetch(`${n}/backups/create/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`,"Content-Type":"application/json"},body:JSON.stringify({server_id:r,...t})})).ok?(c.success("âœ… Yedek oluÅŸturuluyor..."),i()):c.error("âŒ Yedek oluÅŸturulamadÄ±")}catch{c.error("âŒ BaÄŸlantÄ± hatasÄ±")}finally{p(!1)}},b=async e=>{if(await k("Sunucuyu bu yedeÄŸe geri yÃ¼klemek istediÄŸinize emin misiniz? Bu iÅŸlem geri alÄ±namaz!"))try{(await fetch(`${n}/backups/${e}/restore/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}})).ok?c.success("âœ… Sunucu geri yÃ¼kleniyor..."):c.error("âŒ Geri yÃ¼kleme hatasÄ±")}catch{c.error("âŒ BaÄŸlantÄ± hatasÄ±")}},y=async e=>{try{const a=await fetch(`${n}/backups/${e}/download/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(a.ok){const B=await a.blob(),S=window.URL.createObjectURL(B),m=document.createElement("a");m.href=S,m.download=`backup_${e}.json`,m.click(),c.success("âœ… Yedek indiriliyor")}}catch{c.error("âŒ Ä°ndirme hatasÄ±")}},f=async e=>{if(await k("YedeÄŸi silmek istediÄŸinize emin misiniz?"))try{(await fetch(`${n}/backups/${e}/delete/`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}})).ok&&(c.success("âœ… Yedek silindi"),i())}catch{c.error("âŒ Silme hatasÄ±")}},N=e=>e<1024?e+" B":e<1024*1024?(e/1024).toFixed(2)+" KB":(e/(1024*1024)).toFixed(2)+" MB",_=e=>{const a={completed:{text:"TamamlandÄ±",color:"#22c55e",icon:"âœ…"},processing:{text:"Ä°ÅŸleniyor",color:"#f59e0b",icon:"â³"},failed:{text:"BaÅŸarÄ±sÄ±z",color:"#ef4444",icon:"âŒ"}};return a[e]||a.processing};return React.createElement("div",{className:"backup-overlay",onClick:u},React.createElement("div",{className:"backup-panel",onClick:e=>e.stopPropagation()},React.createElement("div",{className:"backup-header"},React.createElement("h2",null,"ğŸ’¾ Sunucu Yedekleme"),React.createElement("button",{className:"close-btn",onClick:u},"Ã—")),React.createElement("div",{className:"backup-content"},React.createElement("div",{className:"create-backup-section"},React.createElement("h3",null,"Yeni Yedek OluÅŸtur"),React.createElement("div",{className:"backup-options"},React.createElement("label",{className:"option-label"},React.createElement("input",{type:"checkbox",checked:t.include_channels,onChange:e=>l({...t,include_channels:e.target.checked})}),React.createElement("span",null,"ğŸ“ KanallarÄ± dahil et")),React.createElement("label",{className:"option-label"},React.createElement("input",{type:"checkbox",checked:t.include_roles,onChange:e=>l({...t,include_roles:e.target.checked})}),React.createElement("span",null,"ğŸ­ Rolleri dahil et")),React.createElement("label",{className:"option-label"},React.createElement("input",{type:"checkbox",checked:t.include_messages,onChange:e=>l({...t,include_messages:e.target.checked})}),React.createElement("span",null,"ğŸ’¬ MesajlarÄ± dahil et (son 100)")),React.createElement("label",{className:"option-label"},React.createElement("input",{type:"checkbox",checked:t.include_settings,onChange:e=>l({...t,include_settings:e.target.checked})}),React.createElement("span",null,"âš™ï¸ AyarlarÄ± dahil et")),React.createElement("label",{className:"option-label"},React.createElement("input",{type:"checkbox",checked:t.include_emojis,onChange:e=>l({...t,include_emojis:e.target.checked})}),React.createElement("span",null,"ğŸ˜€ Emojileri dahil et"))),React.createElement("button",{className:"create-backup-btn",onClick:R,disabled:d},d?"â³ OluÅŸturuluyor...":"ğŸ’¾ Yedek OluÅŸtur")),E?React.createElement("div",{className:"loading-state"},React.createElement("div",{className:"spinner"}),React.createElement("p",null,"YÃ¼kleniyor...")):o.length===0?React.createElement("div",{className:"empty-state"},React.createElement("span",{className:"empty-icon"},"ğŸ’¾"),React.createElement("p",null,"HenÃ¼z yedek yok")):React.createElement("div",{className:"backups-list"},React.createElement("h3",null,"Mevcut Yedekler (",o.length,")"),o.map(e=>{const a=_(e.status);return React.createElement("div",{key:e.id,className:"backup-card"},React.createElement("div",{className:"backup-info"},React.createElement("div",{className:"backup-main"},React.createElement("h4",null,"Yedek #",e.id),React.createElement("div",{className:"backup-meta"},React.createElement("span",null,"ğŸ“… ",new Date(e.created_at).toLocaleString("tr-TR")),React.createElement("span",null,"ğŸ“¦ ",N(e.file_size)),React.createElement("span",{className:"status-badge",style:{background:a.color}},a.icon," ",a.text)),React.createElement("div",{className:"backup-includes"},e.includes_channels&&React.createElement("span",{className:"include-badge"},"ğŸ“ Kanallar"),e.includes_roles&&React.createElement("span",{className:"include-badge"},"ğŸ­ Roller"),e.includes_messages&&React.createElement("span",{className:"include-badge"},"ğŸ’¬ Mesajlar"),e.includes_settings&&React.createElement("span",{className:"include-badge"},"âš™ï¸ Ayarlar"),e.includes_emojis&&React.createElement("span",{className:"include-badge"},"ğŸ˜€ Emojiler")))),e.status==="completed"&&React.createElement("div",{className:"backup-actions"},React.createElement("button",{className:"restore-btn",onClick:()=>b(e.id)},"ğŸ”„ Geri YÃ¼kle"),React.createElement("button",{className:"download-btn",onClick:()=>y(e.id)},"ğŸ“¥ Ä°ndir"),React.createElement("button",{className:"delete-btn",onClick:()=>f(e.id)},"ğŸ—‘ï¸ Sil")))})))))};export{z as default};
