var I=Object.defineProperty;var a=(s,f)=>I(s,"name",{value:f,configurable:!0});import{a as B,r as i,j as e}from"./react-core-Djgtqrmb.js";import{m as _,c as M,a as H,aF as W,i as $,a_ as A}from"./icons-vendor-BW7dxHkX.js";import{A as L}from"./index-B9TNnJpS.js";import"./media-vendor-CxFPycob.js";import"./router-vendor-ClgLnMjk.js";import"./state-vendor-BRqaXHJQ.js";import"./crypto-vendor-D1XRGppi.js";import"./ui-vendor-IhB9Znpc.js";const D=a(({isOpen:s,onClose:f,onNavigateToMessage:j,currentUsername:g})=>{const[h,S]=i.useState([]),[l,b]=i.useState(!1),[k,z]=i.useState(1),[u,C]=i.useState(!1),[y,R]=i.useState(0),[m,E]=i.useState(""),d=i.useCallback(async(n=1,r=!1)=>{b(!0);try{const p=localStorage.getItem("access_token");let o=`${L}/api/mentions/inbox/?page=${n}&page_size=25`;m&&(o+=`&room_id=${m}`);const x=await fetch(o,{headers:{Authorization:`Bearer ${p}`}});if(x.ok){const c=await x.json();S(F=>r?[...F,...c.results]:c.results),C(c.has_next),R(c.total),z(n)}}catch{}finally{b(!1)}},[m]);i.useEffect(()=>{s&&d(1)},[s,d]);const T=a(()=>{u&&d(k+1,!0)},"handleLoadMore"),v=a(n=>{const r=new Date(n),o=new Date-r;return o<6e4?"Az √∂nce":o<36e5?`${Math.floor(o/6e4)} dk √∂nce`:o<864e5?`${Math.floor(o/36e5)} sa √∂nce`:o<6048e5?`${Math.floor(o/864e5)} g√ºn √∂nce`:r.toLocaleDateString("tr-TR")},"formatTime"),w=a(n=>{if(!n||!g)return n;const r=new RegExp(`(@${g})`,"gi");return n.split(r).map((o,x)=>r.test(o)?e.jsx("span",{style:t.mentionHighlight,children:o},x):o)},"highlightMention");return s?e.jsx("div",{style:t.overlay,children:e.jsxs("div",{style:t.panel,children:[e.jsxs("div",{style:t.header,children:[e.jsxs("div",{style:t.headerLeft,children:[e.jsx(_,{style:{color:"#5865F2",fontSize:18}}),e.jsx("h3",{style:t.title,children:"Bahsedilmeler"}),y>0&&e.jsx("span",{style:t.badge,children:y})]}),e.jsxs("div",{style:t.headerRight,children:[e.jsx("button",{onClick:a(()=>d(1),"onClick"),style:t.refreshBtn,title:"Yenile",children:e.jsx(M,{style:l?{animation:"spin 1s linear infinite"}:{}})}),e.jsx("button",{onClick:f,style:t.closeBtn,children:e.jsx(H,{})})]})]}),e.jsx("div",{style:t.content,children:l&&h.length===0?e.jsxs("div",{style:t.emptyState,children:[e.jsx("div",{style:t.spinner}),e.jsx("p",{children:"Y√ºkleniyor..."})]}):h.length===0?e.jsxs("div",{style:t.emptyState,children:[e.jsx("span",{style:{fontSize:48},children:"üì≠"}),e.jsx("p",{style:t.emptyTitle,children:"Bahsedilme yok"}),e.jsxs("p",{style:t.emptySubtitle,children:["Birisi seni @",g," ile etiketlediƒüinde burada g√∂r√ºn√ºr"]})]}):e.jsxs(e.Fragment,{children:[h.map(n=>e.jsxs("div",{style:t.mentionItem,onClick:a(()=>j?.(n),"onClick"),children:[e.jsxs("div",{style:t.mentionHeader,children:[e.jsx("span",{style:t.mentionUser,children:n.username}),e.jsx("span",{style:t.mentionTime,children:v(n.timestamp)})]}),e.jsxs("div",{style:t.mentionContent,children:[w(n.content?.slice(0,200)),n.content?.length>200&&"..."]}),e.jsxs("div",{style:t.mentionFooter,children:[n.room_name&&e.jsxs("span",{style:t.roomTag,children:[e.jsx(W,{style:{fontSize:10}}),n.room_name]}),n.is_pinned&&e.jsxs("span",{style:t.pinnedTag,children:[e.jsx($,{style:{fontSize:10}})," Sabitlenmi≈ü"]}),n.has_thread&&e.jsxs("span",{style:t.threadTag,children:[e.jsx(A,{style:{fontSize:10}})," Thread"]})]})]},n.id)),u&&e.jsx("button",{onClick:T,style:t.loadMoreBtn,disabled:l,children:l?"Y√ºkleniyor...":"Daha Fazla G√∂ster"})]})})]})}):null},"MentionsInboxPanel"),t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.6)",display:"flex",justifyContent:"center",alignItems:"flex-start",paddingTop:"60px",zIndex:1e3},panel:{width:"500px",maxWidth:"90vw",maxHeight:"80vh",backgroundColor:"#2f3136",borderRadius:"12px",overflow:"hidden",display:"flex",flexDirection:"column",boxShadow:"0 8px 32px rgba(0,0,0,0.4)"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 20px",borderBottom:"1px solid #202225",backgroundColor:"#292b2f"},headerLeft:{display:"flex",alignItems:"center",gap:"10px"},headerRight:{display:"flex",alignItems:"center",gap:"8px"},title:{margin:0,fontSize:"16px",fontWeight:600,color:"#fff"},badge:{backgroundColor:"#ed4245",color:"#fff",fontSize:"11px",fontWeight:700,padding:"2px 6px",borderRadius:"10px",minWidth:"18px",textAlign:"center"},refreshBtn:{background:"none",border:"none",color:"#b9bbbe",cursor:"pointer",padding:"6px",borderRadius:"4px",fontSize:"14px"},closeBtn:{background:"none",border:"none",color:"#b9bbbe",cursor:"pointer",padding:"6px",borderRadius:"4px",fontSize:"16px"},content:{flex:1,overflowY:"auto",padding:"8px"},emptyState:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"48px 24px",color:"#72767d"},emptyTitle:{fontSize:"16px",fontWeight:600,color:"#dcddde",margin:"12px 0 4px"},emptySubtitle:{fontSize:"13px",textAlign:"center"},mentionItem:{padding:"12px 16px",borderRadius:"8px",cursor:"pointer",transition:"background 0.15s",marginBottom:"4px",borderLeft:"3px solid #5865F2",backgroundColor:"rgba(88, 101, 242, 0.06)"},mentionHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"6px"},mentionUser:{fontWeight:600,color:"#fff",fontSize:"14px"},mentionTime:{color:"#72767d",fontSize:"12px"},mentionContent:{color:"#dcddde",fontSize:"14px",lineHeight:1.5,wordBreak:"break-word"},mentionHighlight:{backgroundColor:"rgba(88, 101, 242, 0.3)",color:"#dee0fc",padding:"1px 3px",borderRadius:"3px",fontWeight:600},mentionFooter:{display:"flex",gap:"8px",marginTop:"8px"},roomTag:{display:"flex",alignItems:"center",gap:"4px",backgroundColor:"rgba(255,255,255,0.06)",color:"#b9bbbe",padding:"2px 8px",borderRadius:"4px",fontSize:"12px"},pinnedTag:{display:"flex",alignItems:"center",gap:"4px",backgroundColor:"rgba(250, 166, 26, 0.1)",color:"#faa61a",padding:"2px 8px",borderRadius:"4px",fontSize:"12px"},threadTag:{display:"flex",alignItems:"center",gap:"4px",backgroundColor:"rgba(88, 101, 242, 0.1)",color:"#5865F2",padding:"2px 8px",borderRadius:"4px",fontSize:"12px"},loadMoreBtn:{width:"100%",padding:"10px",backgroundColor:"#5865F2",color:"#fff",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:500,marginTop:"8px"},spinner:{width:32,height:32,border:"3px solid #5865F2",borderTopColor:"transparent",borderRadius:"50%",animation:"spin 0.8s linear infinite",marginBottom:12}},V=B.memo(D);export{V as default};
