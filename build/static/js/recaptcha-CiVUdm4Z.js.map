{"version":3,"file":"recaptcha-CiVUdm4Z.js","sources":["../../../src/utils/recaptcha.js"],"sourcesContent":["import { useEffect, useCallback } from 'react';\r\n\r\n// reCAPTCHA v3 Site Key (.env'den alınıyor)\r\nconst RECAPTCHA_SITE_KEY = import.meta.env.VITE_RECAPTCHA_SITE_KEY || '6LfhUU0sAAAAALQKKgbT5xKopHIlv2isjdzEKIo4';\r\n\r\n// Load reCAPTCHA script\r\nexport const loadRecaptcha = () => {\r\n    return new Promise((resolve, reject) => {\r\n        if (window.grecaptcha) {\r\n            resolve(window.grecaptcha);\r\n            return;\r\n        }\r\n\r\n        const script = document.createElement('script');\r\n        script.src = `https://www.google.com/recaptcha/api.js?render=${RECAPTCHA_SITE_KEY}`;\r\n        script.async = true;\r\n        script.defer = true;\r\n\r\n        script.onload = () => {\r\n            window.grecaptcha.ready(() => {\r\n                resolve(window.grecaptcha);\r\n            });\r\n        };\r\n\r\n        script.onerror = () => {\r\n            reject(new Error('Failed to load reCAPTCHA'));\r\n        };\r\n\r\n        document.head.appendChild(script);\r\n    });\r\n};\r\n\r\n// Execute reCAPTCHA and get token\r\nexport const executeRecaptcha = async (action = 'submit') => {\r\n    try {\r\n        await loadRecaptcha();\r\n\r\n        const token = await window.grecaptcha.execute(RECAPTCHA_SITE_KEY, { action });\r\n        return token;\r\n    } catch (error) {\r\n        console.error('reCAPTCHA error:', error);\r\n        return null;\r\n    }\r\n};\r\n\r\n// React Hook for reCAPTCHA\r\nexport const useRecaptcha = () => {\r\n    useEffect(() => {\r\n        loadRecaptcha().catch(err => {\r\n            console.warn('reCAPTCHA load failed:', err);\r\n        });\r\n    }, []);\r\n\r\n    const getToken = useCallback(async (action) => {\r\n        return await executeRecaptcha(action);\r\n    }, []);\r\n\r\n    return { getToken };\r\n};\r\n\r\n// Verify token on backend\r\nexport const verifyRecaptchaToken = async (token, apiBaseUrl) => {\r\n    try {\r\n        const response = await fetch(`${apiBaseUrl}/auth/recaptcha/verify/`, {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json'\r\n            },\r\n            body: JSON.stringify({ token })\r\n        });\r\n\r\n        const data = await response.json();\r\n        return data.success && data.score >= 0.5; // Minimum score threshold\r\n    } catch (error) {\r\n        console.error('reCAPTCHA verification error:', error);\r\n        return false;\r\n    }\r\n};\r\n\r\nexport default {\r\n    loadRecaptcha,\r\n    executeRecaptcha,\r\n    useRecaptcha,\r\n    verifyRecaptchaToken,\r\n    RECAPTCHA_SITE_KEY\r\n};\r\n\r\n\r\n"],"names":["useEffect","useCallback"],"mappings":";;;AAGA,MAAM,qBAAqB;AAGpB,MAAM,gBAAgB,6BAAM;AAC/B,SAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACpC,QAAI,OAAO,YAAY;AACnB,cAAQ,OAAO,UAAU;AACzB;AAAA,IACJ;AAEA,UAAM,SAAS,SAAS,cAAc,QAAQ;AAC9C,WAAO,MAAM,kDAAkD,kBAAkB;AACjF,WAAO,QAAQ;AACf,WAAO,QAAQ;AAEf,WAAO,SAAS,MAAM;AAClB,aAAO,WAAW,MAAM,MAAM;AAC1B,gBAAQ,OAAO,UAAU;AAAA,MAC7B,CAAC;AAAA,IACL;AAEA,WAAO,UAAU,MAAM;AACnB,aAAO,IAAI,MAAM,0BAA0B,CAAC;AAAA,IAChD;AAEA,aAAS,KAAK,YAAY,MAAM;AAAA,EACpC,CAAC;AACL,GAxB6B;AA2BtB,MAAM,mBAAmB,8BAAO,SAAS,aAAa;AACzD,MAAI;AACA,UAAM,cAAA;AAEN,UAAM,QAAQ,MAAM,OAAO,WAAW,QAAQ,oBAAoB,EAAE,QAAQ;AAC5E,WAAO;AAAA,EACX,SAAS,OAAO;AACZ,YAAQ,MAAM,oBAAoB,KAAK;AACvC,WAAO;AAAA,EACX;AACJ,GAVgC;AAazB,MAAM,eAAe,6BAAM;AAC9BA,eAAAA,UAAU,MAAM;AACZ,kBAAA,EAAgB,MAAM,CAAA,QAAO;AACzB,cAAQ,KAAK,0BAA0B,GAAG;AAAA,IAC9C,CAAC;AAAA,EACL,GAAG,CAAA,CAAE;AAEL,QAAM,WAAWC,yBAAY,OAAO,WAAW;AAC3C,WAAO,MAAM,iBAAiB,MAAM;AAAA,EACxC,GAAG,CAAA,CAAE;AAEL,SAAO,EAAE,SAAA;AACb,GAZ4B;"}