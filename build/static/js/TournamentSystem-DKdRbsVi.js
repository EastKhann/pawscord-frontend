var S=Object.defineProperty;var r=(n,d)=>S(n,"name",{value:d,configurable:!0});import{r as h,j as e}from"./react-core-Djgtqrmb.js";import{u as w,z,a as C,P as v,an as B}from"./icons-vendor-BW7dxHkX.js";import{t as D,c as T}from"./index-D_luy7FO.js";import"./media-vendor-CxFPycob.js";import"./router-vendor-gmJ9Mn-1.js";import"./state-vendor-BRqaXHJQ.js";import"./crypto-vendor-D1XRGppi.js";import"./ui-vendor-IhB9Znpc.js";const R=r(({fetchWithAuth:n,apiBaseUrl:d})=>{const[x,f]=h.useState([]),[s,p]=h.useState(null),[c,a]=h.useState(!1),[y,g]=h.useState("all"),l=r(async m=>{try{const b=await n(`${d}/tournaments/?filter=${m||y}`);if(b.ok){const k=await b.json();f(k.tournaments||[])}}catch{}},"loadTournaments");return{tournaments:x,activeTournament:s,setActiveTournament:p,showCreateModal:c,setShowCreateModal:a,filter:y,setFilter:g,loadTournaments:l,createTournament:r(async m=>{try{const i=await n(`${d}/tournaments/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)});if(i.ok){const b=await i.json();f([b.tournament,...x]),a(!1)}}catch{}},"createTournament"),joinTournament:r(async m=>{try{(await n(`${d}/tournaments/${m}/join/`,{method:"POST"})).ok&&(D.success("✅ Turnuvaya katıldınız!"),l())}catch{}},"joinTournament"),leaveTournament:r(async m=>{if(confirm("Turnuvadan ayrılmak istediğinize emin misiniz?"))try{await n(`${d}/tournaments/${m}/leave/`,{method:"POST"}),l()}catch{}},"leaveTournament")}},"useTournament"),t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,padding:"20px"},panel:{backgroundColor:"#2f3136",borderRadius:"8px",width:"100%",maxWidth:"1200px",maxHeight:"90vh",display:"flex",flexDirection:"column"},header:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"20px",borderBottom:"1px solid #202225"},headerLeft:{display:"flex",alignItems:"center",gap:"12px"},headerActions:{display:"flex",gap:"12px"},title:{margin:0,fontSize:"20px",color:"#ffffff"},createButton:{display:"flex",alignItems:"center",gap:"8px",backgroundColor:"#5865f2",color:"#ffffff",border:"none",padding:"8px 16px",borderRadius:"4px",cursor:"pointer",fontSize:"14px"},closeButton:{background:"none",border:"none",color:"#b9bbbe",cursor:"pointer",padding:"8px"},filters:{display:"flex",gap:"8px",padding:"16px 20px",borderBottom:"1px solid #202225"},filterButton:{padding:"8px 16px",borderRadius:"4px",border:"none",color:"#ffffff",cursor:"pointer",fontSize:"13px"},content:{flex:1,overflowY:"auto",padding:"20px"},empty:{textAlign:"center",padding:"60px 20px",color:"#b9bbbe"},tournamentGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"16px"},tournamentCard:{backgroundColor:"#36393f",borderRadius:"8px",padding:"16px",display:"flex",flexDirection:"column",gap:"12px"},cardHeader:{display:"flex",justifyContent:"space-between",alignItems:"start"},tournamentName:{color:"#ffffff",fontSize:"16px",fontWeight:"bold",flex:1},statusBadge:{padding:"4px 8px",borderRadius:"12px",fontSize:"11px",color:"#ffffff",textTransform:"uppercase",fontWeight:"bold"},cardBody:{display:"flex",flexDirection:"column",gap:"8px"},cardInfo:{display:"flex",alignItems:"center",gap:"8px",color:"#b9bbbe",fontSize:"13px"},cardFooter:{display:"flex",gap:"8px",marginTop:"auto"},viewButton:{flex:1,backgroundColor:"#202225",color:"#ffffff",border:"none",padding:"8px",borderRadius:"4px",cursor:"pointer",fontSize:"13px"},joinButton:{flex:1,backgroundColor:"#3ba55d",color:"#ffffff",border:"none",padding:"8px",borderRadius:"4px",cursor:"pointer",fontSize:"13px",fontWeight:"bold"},leaveButton:{flex:1,backgroundColor:"#ed4245",color:"#ffffff",border:"none",padding:"8px",borderRadius:"4px",cursor:"pointer",fontSize:"13px"},modalOverlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10001},modal:{backgroundColor:"#36393f",borderRadius:"8px",padding:"24px",width:"90%",maxWidth:"500px",maxHeight:"80vh",overflowY:"auto"},modalTitle:{color:"#ffffff",marginBottom:"16px"},form:{display:"flex",flexDirection:"column",gap:"12px"},input:{width:"100%",backgroundColor:"#202225",border:"none",color:"#dcddde",padding:"10px",borderRadius:"4px",fontSize:"14px",outline:"none"},modalButtons:{display:"flex",gap:"8px",justifyContent:"flex-end",marginTop:"16px"},cancelButton:{backgroundColor:"transparent",color:"#ffffff",border:"none",padding:"8px 16px",borderRadius:"4px",cursor:"pointer"},submitButton:{backgroundColor:"#5865f2",color:"#ffffff",border:"none",padding:"8px 16px",borderRadius:"4px",cursor:"pointer",fontWeight:"500"},modalHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},modalClose:{background:"none",border:"none",color:"#b9bbbe",cursor:"pointer",padding:"4px"},modalContent:{display:"flex",flexDirection:"column",gap:"16px"},detailSection:{backgroundColor:"#2f3136",padding:"16px",borderRadius:"8px"},participantList:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(150px, 1fr))",gap:"8px"},participant:{backgroundColor:"#36393f",padding:"8px 12px",borderRadius:"4px",color:"#dcddde",fontSize:"13px",display:"flex",justifyContent:"space-between"},seed:{color:"#faa61a",fontWeight:"bold"}},I=r(({tournament:n,currentUser:d,onJoin:x,onLeave:f,onView:s})=>{const p=n.participants?.some(g=>g.username===d),c=n.participants?.length>=n.max_participants,a=n.status==="completed",y=n.status==="active";return e.jsxs("div",{style:t.tournamentCard,children:[e.jsxs("div",{style:t.cardHeader,children:[e.jsx("div",{style:t.tournamentName,children:n.name}),e.jsx("div",{style:{...t.statusBadge,backgroundColor:y?"#3ba55d":a?"#72767d":"#faa61a"},children:n.status})]}),e.jsxs("div",{style:t.cardBody,children:[e.jsxs("div",{style:t.cardInfo,children:[e.jsx(w,{size:14}),e.jsxs("span",{children:[n.participants?.length||0,"/",n.max_participants]})]}),e.jsxs("div",{style:t.cardInfo,children:[e.jsx(z,{size:14}),e.jsx("span",{children:new Date(n.start_date).toLocaleDateString("tr-TR")})]})]}),e.jsxs("div",{style:t.cardFooter,children:[e.jsx("button",{onClick:s,style:t.viewButton,children:"Detaylar"}),!a&&(p?e.jsxs("button",{onClick:f,style:t.leaveButton,children:["Ayr","ı","l"]}):e.jsx("button",{onClick:x,disabled:c,style:{...t.joinButton,opacity:c?.5:1,cursor:c?"not-allowed":"pointer"},children:c?"Dolu":"Katıl"}))]})]})},"TournamentCard"),_=r(({onClose:n,onCreate:d})=>{const{overlayProps:x,dialogProps:f}=T({onClose:n,label:"Turnuva Oluştur"}),[s,p]=h.useState({name:"",game:"",max_participants:8,start_date:"",prize:"",rules:""}),c=r(a=>{a.preventDefault(),d(s)},"handleSubmit");return e.jsx("div",{style:t.modalOverlay,...x,children:e.jsxs("div",{style:t.modal,...f,children:[e.jsxs("h3",{style:t.modalTitle,children:["Yeni Turnuva Olu","ş","tur"]}),e.jsxs("form",{onSubmit:c,style:t.form,children:[e.jsx("input",{type:"text",placeholder:"Turnuva Ad{'ı'}",value:s.name,onChange:r(a=>p({...s,name:a.target.value}),"onChange"),style:t.input,required:!0}),e.jsx("input",{type:"text",placeholder:"Oyun",value:s.game,onChange:r(a=>p({...s,game:a.target.value}),"onChange"),style:t.input,required:!0}),e.jsxs("select",{value:s.max_participants,onChange:r(a=>p({...s,max_participants:parseInt(a.target.value)}),"onChange"),style:t.input,children:[e.jsxs("option",{value:4,children:["4 Ki","ş","i"]}),e.jsxs("option",{value:8,children:["8 Ki","ş","i"]}),e.jsxs("option",{value:16,children:["16 Ki","ş","i"]}),e.jsxs("option",{value:32,children:["32 Ki","ş","i"]})]}),e.jsx("input",{type:"datetime-local",value:s.start_date,onChange:r(a=>p({...s,start_date:a.target.value}),"onChange"),style:t.input,required:!0}),e.jsx("input",{type:"text",placeholder:"Ödül (opsiyonel)",value:s.prize,onChange:r(a=>p({...s,prize:a.target.value}),"onChange"),style:t.input}),e.jsx("textarea",{placeholder:"Kurallar",value:s.rules,onChange:r(a=>p({...s,rules:a.target.value}),"onChange"),style:{...t.input,minHeight:"100px"}}),e.jsxs("div",{style:t.modalButtons,children:[e.jsxs("button",{type:"button",onClick:n,style:t.cancelButton,children:["İ","ptal"]}),e.jsxs("button",{type:"submit",style:t.submitButton,children:["Olu","ş","tur"]})]})]})]})})},"CreateTournamentModal"),O=r(({tournament:n,onClose:d,fetchWithAuth:x,apiBaseUrl:f})=>{const{overlayProps:s,dialogProps:p}=T({onClose:d,label:"Turnuva Detay"}),[c,a]=h.useState(null);h.useEffect(()=>{y()},[n.id]);const y=r(async()=>{try{const l=await x(`${f}/tournaments/${n.id}/bracket/`);if(l.ok){const j=await l.json();a(j.bracket)}}catch{}},"loadBracket"),g=r(()=>{const l={};(Array.isArray(c)?c:[]).forEach(u=>{const o=u.round||1;l[o]||(l[o]=[]),l[o].push(u)});const j=Object.keys(l).sort((u,o)=>u-o);return e.jsx("div",{style:{display:"flex",gap:"20px",overflowX:"auto",padding:"12px 0"},children:j.map(u=>e.jsxs("div",{style:{minWidth:"200px",flex:"0 0 auto"},children:[e.jsx("div",{style:{color:"#5865f2",fontWeight:600,fontSize:"0.85em",marginBottom:"10px",textAlign:"center"},children:j.length===1?"Final":`Tur ${u}`}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:l[u].map(o=>e.jsxs("div",{style:{backgroundColor:"#1e1f22",borderRadius:"8px",overflow:"hidden",border:o.status==="completed"?"1px solid #23a559":"1px solid #3f4147"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 12px",backgroundColor:o.winner&&o.winner===o.participant1?.user_id?"rgba(35,165,89,0.1)":"transparent",borderBottom:"1px solid #2b2d31"},children:[e.jsx("span",{style:{color:"#dbdee1",fontSize:"0.85em",fontWeight:o.winner===o.participant1?.user_id?700:400},children:o.participant1?.username||"TBD"}),e.jsx("span",{style:{color:"#949ba4",fontSize:"0.8em",fontWeight:600},children:o.score1??"-"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 12px",backgroundColor:o.winner&&o.winner===o.participant2?.user_id?"rgba(35,165,89,0.1)":"transparent"},children:[e.jsx("span",{style:{color:"#dbdee1",fontSize:"0.85em",fontWeight:o.winner===o.participant2?.user_id?700:400},children:o.participant2?.username||"TBD"}),e.jsx("span",{style:{color:"#949ba4",fontSize:"0.8em",fontWeight:600},children:o.score2??"-"})]})]},o.id))})]},u))})},"renderBracket");return e.jsx("div",{style:t.modalOverlay,...s,children:e.jsxs("div",{style:{...t.modal,maxWidth:"800px"},...p,children:[e.jsxs("div",{style:t.modalHeader,children:[e.jsx("h3",{style:t.modalTitle,children:n.name}),e.jsx("button",{onClick:d,style:t.modalClose,children:e.jsx(C,{size:18})})]}),e.jsxs("div",{style:t.modalContent,children:[e.jsxs("div",{style:t.detailSection,children:[e.jsx("h4",{children:"Bilgiler"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Oyun:"})," ",n.game]}),e.jsxs("p",{children:[e.jsxs("strong",{children:["Kat","ı","l","ı","mc","ı",":"]})," ",n.participants?.length,"/",n.max_participants]}),e.jsxs("p",{children:[e.jsxs("strong",{children:["Ba","ş","lang","ıç",":"]})," ",new Date(n.start_date).toLocaleString("tr-TR")]}),n.prize&&e.jsxs("p",{children:[e.jsxs("strong",{children:["Ö","d","ü","l:"]})," ",n.prize]})]}),n.rules&&e.jsxs("div",{style:t.detailSection,children:[e.jsx("h4",{children:"Kurallar"}),e.jsx("p",{children:n.rules})]}),c&&e.jsxs("div",{style:t.detailSection,children:[e.jsxs("h4",{children:["E","ş","le","ş","meler"]}),g()]}),e.jsxs("div",{style:t.detailSection,children:[e.jsxs("h4",{children:["Kat","ı","l","ı","mc","ı","lar"]}),e.jsx("div",{style:t.participantList,children:n.participants?.map(l=>e.jsxs("div",{style:t.participant,children:[e.jsx("span",{children:l.username}),l.seed&&e.jsx("span",{style:t.seed,children:l.seed})]},l.id))})]})]})]})})},"TournamentDetailModal"),E=r(({onClose:n,fetchWithAuth:d,apiBaseUrl:x,currentUser:f})=>{const{tournaments:s,activeTournament:p,setActiveTournament:c,showCreateModal:a,setShowCreateModal:y,filter:g,setFilter:l,loadTournaments:j,createTournament:u,joinTournament:o,leaveTournament:m}=R({fetchWithAuth:d,apiBaseUrl:x});return h.useEffect(()=>{j()},[g]),e.jsx("div",{style:t.overlay,children:e.jsxs("div",{style:t.panel,children:[e.jsxs("div",{style:t.header,children:[e.jsxs("div",{style:t.headerLeft,children:[e.jsx(v,{size:24,color:"#faa61a"}),e.jsx("h2",{style:t.title,children:"Turnuvalar"})]}),e.jsxs("div",{style:t.headerActions,children:[e.jsxs("button",{onClick:r(()=>y(!0),"onClick"),style:t.createButton,children:[e.jsx(B,{size:14}),e.jsx("span",{children:"Yeni Turnuva"})]}),e.jsx("button",{onClick:n,style:t.closeButton,children:e.jsx(C,{size:20})})]})]}),e.jsx("div",{style:t.filters,children:["all","active","upcoming","completed"].map(i=>e.jsx("button",{onClick:r(()=>l(i),"onClick"),style:{...t.filterButton,backgroundColor:g===i?"#5865f2":"#2f3136"},children:i==="all"?"Tümü":i==="active"?"Aktif":i==="upcoming"?"Yaklaşan":"Tamamlanan"},i))}),e.jsx("div",{style:t.content,children:s.length===0?e.jsxs("div",{style:t.empty,children:[e.jsx(v,{size:48,color:"#4e5058"}),e.jsx("p",{children:"Henüz turnuva yok"})]}):e.jsx("div",{style:t.tournamentGrid,children:s.map(i=>e.jsx(I,{tournament:i,currentUser:f,onJoin:r(()=>o(i.id),"onJoin"),onLeave:r(()=>m(i.id),"onLeave"),onView:r(()=>c(i),"onView")},i.id))})}),a&&e.jsx(_,{onClose:r(()=>y(!1),"onClose"),onCreate:u}),p&&e.jsx(O,{tournament:p,onClose:r(()=>c(null),"onClose"),fetchWithAuth:d,apiBaseUrl:x})]})})},"TournamentSystem");export{E as default};
