var Y=Object.defineProperty;var a=(u,l)=>Y(u,"name",{value:l,configurable:!0});import{r as t,j as e}from"./react-core-Djgtqrmb.js";import{q as o,cq as Q,b2 as U,a as K,aB as P,aY as g,f as E,b6 as X,z as A,aV as Z,aN as ee,D as se,bs as ae,w as ne,d as te,cJ as ie}from"./icons-vendor-BW7dxHkX.js";import{y as r}from"./ui-vendor-IhB9Znpc.js";const he=a(({serverId:u,channelId:l,onClose:x})=>{const[i,m]=t.useState(""),[c,p]=t.useState("python"),[j,d]=t.useState(""),[B,N]=t.useState(!1),[k,C]=t.useState(null),[w,O]=t.useState([]),[F,b]=t.useState(!1),[T,D]=t.useState([]),[R,f]=t.useState(!1),[v,W]=t.useState(!1),h=localStorage.getItem("access_token"),$=[{id:"python",name:"Python",icon:e.jsx(ie,{}),template:`# Python Code
print("Hello, World!")`},{id:"cpp",name:"C++",icon:e.jsx(o,{}),template:`#include <iostream>
using namespace std;

int main() {
    cout << "Hello, World!" << endl;
    return 0;
}`},{id:"c",name:"C",icon:e.jsx(o,{}),template:`#include <stdio.h>

int main() {
    printf("Hello, World!\\n");
    return 0;
}`},{id:"ruby",name:"Ruby",icon:e.jsx(o,{}),template:`# Ruby Code
puts "Hello, World!"`},{id:"go",name:"Go",icon:e.jsx(o,{}),template:`package main

import "fmt"

func main() {
    fmt.Println("Hello, World!")
}`},{id:"rust",name:"Rust",icon:e.jsx(o,{}),template:`fn main() {
    println!("Hello, World!");
}`}];t.useEffect(()=>{z(),S()},[]),t.useEffect(()=>{const s=$.find(n=>n.id===c);s&&!i&&m(s.template)},[c]);const z=a(async()=>{try{const s=await fetch("/api/code-runner/history/",{headers:{Authorization:`Bearer ${h}`}});if(s.ok){const n=await s.json();O(n.history||[])}}catch{}},"fetchHistory"),S=a(async()=>{try{const s=await fetch("/api/code-runner/snippets/",{headers:{Authorization:`Bearer ${h}`}});if(s.ok){const n=await s.json();D(n.snippets||[])}}catch{}},"fetchSavedSnippets"),G=a(async()=>{if(!i.trim()){r.warning("Kod boş olamaz");return}N(!0),d("Çalıştırılıyor...");const s=Date.now();try{const n=await fetch("/api/code-runner/execute/",{method:"POST",headers:{Authorization:`Bearer ${h}`,"Content-Type":"application/json"},body:JSON.stringify({code:i,language:c,channel_id:l})}),y=await n.json(),V=Date.now();C(V-s),n.ok?(d(y.output||"Çıktı yok"),y.error&&d(`Hata:
${y.error}`)):d(`Hata: ${y.message||"Kod çalıştırılamadı"}`),z()}catch{d("Bağlantı hatası")}N(!1)},"handleRunCode"),J=a(async()=>{try{await fetch("/api/code-runner/stop/",{method:"POST",headers:{Authorization:`Bearer ${h}`}}),N(!1),d("Çalıştırma durduruldu")}catch{r.error("Durdurma başarısız")}},"handleStopExecution"),L=a(async s=>{try{(await fetch("/api/code-runner/snippets/",{method:"POST",headers:{Authorization:`Bearer ${h}`,"Content-Type":"application/json"},body:JSON.stringify({name:s,code:i,language:c})})).ok&&(r.success("Snippet kaydedildi"),S(),f(!1))}catch{r.error("Kaydetme başarısız")}},"handleSaveSnippet"),H=a(s=>{m(s.code),p(s.language),b(!1)},"handleLoadSnippet"),M=a(async s=>{try{await fetch(`/api/code-runner/snippets/${s}/`,{method:"DELETE",headers:{Authorization:`Bearer ${h}`}}),r.success("Snippet silindi"),S()}catch{r.error("Silme başarısız")}},"handleDeleteSnippet"),_=a(()=>{navigator.clipboard.writeText(j),r.success("Çıktı kopyalandı")},"handleCopyOutput"),q=a(()=>{m(""),d(""),C(null)},"handleClearAll"),I=a(async()=>{if(!l){r.warning("Paylaşım için kanal gerekli");return}try{(await fetch(`/api/channels/${l}/messages/`,{method:"POST",headers:{Authorization:`Bearer ${h}`,"Content-Type":"application/json"},body:JSON.stringify({content:`\`\`\`${c}
${i}
\`\`\`
**Çıktı:**
\`\`\`
${j}
\`\`\``})})).ok&&r.success("Kanala paylaşıldı")}catch{r.error("Paylaşım başarısız")}},"handleShareToChannel");return e.jsx("div",{className:`code-runner-overlay ${v?"fullscreen":""}`,onClick:a(s=>s.target.className.includes("code-runner-overlay")&&x(),"onClick"),children:e.jsxs("div",{className:"code-runner-panel",children:[e.jsxs("div",{className:"panel-header",children:[e.jsxs("h2",{children:[e.jsx(o,{})," Kod Çalıştırıcı"]}),e.jsxs("div",{className:"header-actions",children:[e.jsx("button",{className:"fullscreen-btn",onClick:a(()=>W(!v),"onClick"),children:v?e.jsx(Q,{}):e.jsx(U,{})}),e.jsx("button",{className:"close-btn",onClick:x,children:e.jsx(K,{})})]})]}),e.jsxs("div",{className:"toolbar",children:[e.jsx("div",{className:"language-selector",children:$.map(s=>e.jsxs("button",{className:`lang-btn ${c===s.id?"active":""}`,onClick:a(()=>p(s.id),"onClick"),title:s.name,children:[s.icon,e.jsx("span",{children:s.name})]},s.id))}),e.jsxs("div",{className:"toolbar-actions",children:[e.jsxs("button",{className:"action-btn",onClick:a(()=>b(!F),"onClick"),children:[e.jsx(P,{})," Geçmiş"]}),e.jsxs("button",{className:"action-btn",onClick:a(()=>f(!0),"onClick"),children:[e.jsx(g,{})," Kaydet"]}),e.jsxs("button",{className:"action-btn clear",onClick:q,children:[e.jsx(E,{})," Temizle"]})]})]}),e.jsxs("div",{className:"editor-container",children:[e.jsxs("div",{className:"code-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsxs("span",{children:[e.jsx(o,{})," Kod"]}),e.jsxs("span",{className:"line-count",children:[i.split(`
`).length," satır"]})]}),e.jsx("textarea",{className:"code-editor",value:i,onChange:a(s=>m(s.target.value),"onChange"),placeholder:"Kodunuzu buraya yazın...",spellCheck:"false"})]}),e.jsxs("div",{className:"output-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsxs("span",{children:[e.jsx(X,{})," Çıktı"]}),e.jsxs("div",{className:"output-actions",children:[k&&e.jsxs("span",{className:"exec-time",children:[e.jsx(A,{})," ",k,"ms"]}),e.jsx("button",{onClick:_,title:"Kopyala",children:e.jsx(Z,{})})]})]}),e.jsx("pre",{className:`output-display ${j.includes("Hata")?"error":""}`,children:j||"Çıktı burada görünecek..."})]})]}),e.jsxs("div",{className:"run-bar",children:[B?e.jsxs("button",{className:"stop-btn",onClick:J,children:[e.jsx(se,{})," Durdur"]}):e.jsxs("button",{className:"run-btn",onClick:G,children:[e.jsx(ee,{})," Çalıştır"]}),l&&e.jsxs("button",{className:"share-btn",onClick:I,children:[e.jsx(o,{})," Kanala Paylaş"]})]}),F&&e.jsxs("div",{className:"history-sidebar",children:[e.jsxs("div",{className:"sidebar-header",children:[e.jsxs("h3",{children:[e.jsx(P,{})," Geçmiş & Snippets"]}),e.jsx("button",{onClick:a(()=>b(!1),"onClick"),children:e.jsx(K,{})})]}),e.jsxs("div",{className:"sidebar-section",children:[e.jsxs("h4",{children:[e.jsx(ae,{})," Kaydedilen Snippets"]}),T.length===0?e.jsx("p",{className:"empty-msg",children:"Henüz snippet yok"}):e.jsx("div",{className:"snippets-list",children:T.map(s=>e.jsxs("div",{className:"snippet-item",children:[e.jsxs("div",{className:"snippet-info",onClick:a(()=>H(s),"onClick"),children:[e.jsx("span",{className:"snippet-name",children:s.name}),e.jsx("span",{className:"snippet-lang",children:s.language})]}),e.jsx("button",{className:"delete-snippet",onClick:a(()=>M(s.id),"onClick"),children:e.jsx(E,{})})]},s.id))})]}),e.jsxs("div",{className:"sidebar-section",children:[e.jsxs("h4",{children:[e.jsx(A,{})," Son Çalıştırmalar"]}),w.length===0?e.jsx("p",{className:"empty-msg",children:"Geçmiş yok"}):e.jsx("div",{className:"history-list",children:w.slice(0,10).map((s,n)=>e.jsxs("div",{className:"history-item",onClick:a(()=>H(s),"onClick"),children:[e.jsxs("div",{className:"history-info",children:[e.jsx("span",{className:"history-lang",children:s.language}),e.jsx("span",{className:`history-status ${s.success?"success":"error"}`,children:s.success?e.jsx(ne,{}):e.jsx(te,{})})]}),e.jsxs("code",{className:"history-preview",children:[s.code?.substring(0,50),"..."]}),e.jsxs("span",{className:"history-time",children:[s.exec_time,"ms"]})]},n))})]})]}),R&&e.jsx(re,{onClose:a(()=>f(!1),"onClose"),onSave:L,language:c})]})})},"CodeRunnerPanel"),re=a(({onClose:u,onSave:l,language:x})=>{const[i,m]=t.useState(""),c=a(()=>{if(!i.trim()){r.warning("Snippet adı gerekli");return}l(i)},"handleSubmit");return e.jsx("div",{className:"modal-overlay",onClick:a(p=>p.target.className==="modal-overlay"&&u(),"onClick"),children:e.jsxs("div",{className:"save-modal",children:[e.jsxs("h3",{children:[e.jsx(g,{})," Snippet Kaydet"]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Snippet Adı"}),e.jsx("input",{type:"text",value:i,onChange:a(p=>m(p.target.value),"onChange"),placeholder:"örn: Fibonacci Hesaplama"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Dil"}),e.jsx("input",{type:"text",value:x,disabled:!0})]}),e.jsxs("div",{className:"modal-actions",children:[e.jsx("button",{className:"cancel-btn",onClick:u,children:"İptal"}),e.jsxs("button",{className:"save-submit-btn",onClick:c,children:[e.jsx(g,{})," Kaydet"]})]})]})})},"SaveSnippetModal");export{he as default};
