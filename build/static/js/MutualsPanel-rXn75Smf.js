var $=Object.defineProperty;var a=(m,l)=>$(m,"name",{value:l,configurable:!0});import{r as t,j as s}from"./react-core-Djgtqrmb.js";import{a6 as o,a as E,y as h,t as _,C as B,ba as P,ah as k,u as Q,a1 as U}from"./icons-vendor-BW7dxHkX.js";import{y as z}from"./ui-vendor-IhB9Znpc.js";const T=a(({userId:m,username:l,onClose:j,onNavigateToUser:p,onNavigateToServer:v})=>{const[c,N]=t.useState("friends"),[i,u]=t.useState([]),[d,x]=t.useState([]),[y,f]=t.useState(!0),[r,F]=t.useState(""),S=localStorage.getItem("access_token");t.useEffect(()=>{C()},[m]);const C=a(async()=>{f(!0);try{const e=await fetch(`/api/users/${l}/mutuals/`,{headers:{Authorization:`Bearer ${S}`}});if(e.ok){const n=await e.json();u(n.friends||[]),x(n.servers||[])}else u([]),x([])}catch{u([]),x([])}f(!1)},"fetchMutuals"),w=a(()=>r?i.filter(e=>e.username.toLowerCase().includes(r.toLowerCase())):i,"getFilteredFriends"),M=a(()=>r?d.filter(e=>e.name.toLowerCase().includes(r.toLowerCase())):d,"getFilteredServers"),A=a(e=>({online:"#4caf50",idle:"#ffc107",dnd:"#f44336",offline:"#666"})[e]||"#666","getStatusColor"),L=a(e=>e>=1e6?(e/1e6).toFixed(1)+"M":e>=1e3?(e/1e3).toFixed(1)+"K":e.toString(),"formatMemberCount"),O=a(e=>{z.info(`${e.username} ile sohbet başlatılıyor...`)},"handleSendMessage"),g=w(),b=M();return s.jsx("div",{className:"mutuals-overlay",onClick:a(e=>e.target.className==="mutuals-overlay"&&j(),"onClick"),children:s.jsxs("div",{className:"mutuals-panel",children:[s.jsxs("div",{className:"panel-header",children:[s.jsxs("h2",{children:[s.jsx(o,{})," Ortak Bağlantılar"]}),s.jsxs("span",{className:"target-user",children:["@",l]}),s.jsx("button",{className:"close-btn",onClick:j,children:s.jsx(E,{})})]}),s.jsxs("div",{className:"tabs",children:[s.jsxs("button",{className:`tab ${c==="friends"?"active":""}`,onClick:a(()=>N("friends"),"onClick"),children:[s.jsx(o,{}),s.jsx("span",{children:"Ortak Arkadaşlar"}),s.jsx("span",{className:"count",children:i.length})]}),s.jsxs("button",{className:`tab ${c==="servers"?"active":""}`,onClick:a(()=>N("servers"),"onClick"),children:[s.jsx(h,{}),s.jsx("span",{children:"Ortak Sunucular"}),s.jsx("span",{className:"count",children:d.length})]})]}),s.jsxs("div",{className:"search-bar",children:[s.jsx(_,{}),s.jsx("input",{type:"text",placeholder:c==="friends"?"Arkadaş ara...":"Sunucu ara...",value:r,onChange:a(e=>F(e.target.value),"onChange")})]}),s.jsx("div",{className:"content",children:y?s.jsx("div",{className:"loading",children:"Yükleniyor..."}):c==="friends"?s.jsx("div",{className:"friends-list",children:g.length===0?s.jsxs("div",{className:"empty-state",children:[s.jsx(o,{}),s.jsx("p",{children:"Ortak arkadaş bulunamadı"})]}):g.map(e=>s.jsxs("div",{className:"friend-item",onClick:a(()=>p&&p(e.id),"onClick"),children:[s.jsxs("div",{className:"friend-avatar",children:[e.avatar?s.jsx("img",{src:e.avatar,alt:""}):s.jsx(B,{}),s.jsx("span",{className:"status-dot",style:{background:A(e.status)}})]}),s.jsxs("div",{className:"friend-info",children:[s.jsx("span",{className:"friend-name",children:e.username}),e.activity&&s.jsx("span",{className:"friend-activity",children:e.activity})]}),s.jsx("div",{className:"friend-actions",children:s.jsx("button",{className:"action-btn message",onClick:a(n=>{n.stopPropagation(),O(e)},"onClick"),title:"Mesaj Gönder",children:s.jsx(P,{})})})]},e.id))}):s.jsx("div",{className:"servers-list",children:b.length===0?s.jsxs("div",{className:"empty-state",children:[s.jsx(h,{}),s.jsx("p",{children:"Ortak sunucu bulunamadı"})]}):b.map(e=>s.jsxs("div",{className:"server-item",onClick:a(()=>v&&v(e.id),"onClick"),children:[s.jsx("div",{className:"server-icon",children:e.icon?s.jsx("img",{src:e.icon,alt:""}):s.jsx("span",{children:e.name.charAt(0)})}),s.jsxs("div",{className:"server-info",children:[s.jsxs("div",{className:"server-name-row",children:[s.jsx("span",{className:"server-name",children:e.name}),e.is_owner&&s.jsx(k,{className:"owner-badge"})]}),s.jsxs("div",{className:"server-meta",children:[s.jsxs("span",{className:"member-count",children:[s.jsx(Q,{})," ",L(e.member_count)]}),e.role&&s.jsxs("span",{className:`role-badge ${e.role.toLowerCase()}`,children:[e.role==="Owner"&&s.jsx(k,{}),e.role==="Moderator"&&s.jsx(U,{}),e.role]})]})]})]},e.id))})}),s.jsxs("div",{className:"summary",children:[s.jsxs("span",{children:[s.jsx(o,{})," ",i.length," ortak arkadaş"]}),s.jsxs("span",{children:[s.jsx(h,{})," ",d.length," ortak sunucu"]})]})]})})},"MutualsPanel");export{T as default};
