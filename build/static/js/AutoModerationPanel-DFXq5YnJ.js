import{r as o,b as e}from"./react-core-9vc7GIjk.js";import{z as $,Z as T,V as k,bb as B,bc as F,az as O,m as P,ay as j,aR as x}from"./icons-vendor-BHKL7tCa.js";import{t as n}from"./index-BgtTyGBp.js";import"./editor-vendor-DiU449Dh.js";import"./media-vendor-B-uSUaIv.js";import"./router-vendor-u6fxj6P4.js";import"./crypto-vendor-C1qXRpJv.js";import"./state-vendor-0vlBuk0v.js";const V=({serverId:c,onClose:d})=>{const[i,m]=o.useState([]),[h,E]=o.useState(!0),[f,u]=o.useState(!1),[Y,p]=o.useState(null),[a,r]=o.useState({name:"",type:"spam",action:"warn",enabled:!0,keywords:[],threshold:5,duration:60});o.useEffect(()=>{v()},[c]);const v=async()=>{E(!0);try{const t=await fetch(`/api/moderation/auto-mod/rules/${c}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(t.ok){const l=await t.json();m(l.rules||[])}}catch{n.error("âŒ Kurallar yÃ¼klenemedi")}finally{E(!1)}},g=async()=>{if(!a.name.trim()){n.error("âŒ Kural adÄ± girin");return}try{const t=await fetch(`/api/moderation/auto-mod/rules/${c}/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"},body:JSON.stringify(a)});if(t.ok){const l=await t.json();m([...i,l.rule]),u(!1),C(),n.success("âœ… Kural oluÅŸturuldu")}else n.error("âŒ Kural oluÅŸturulamadÄ±")}catch{n.error("âŒ BaÄŸlantÄ± hatasÄ±")}},N=async(t,l)=>{try{const s=await fetch(`/api/moderation/auto-mod/rules/${c}/${t}/`,{method:"PUT",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"},body:JSON.stringify(l)});if(s.ok){const z=await s.json();m(i.map(y=>y.id===t?z.rule:y)),p(null),n.success("âœ… Kural gÃ¼ncellendi")}}catch{n.error("âŒ GÃ¼ncelleme baÅŸarÄ±sÄ±z")}},b=async t=>{if(confirm("Bu kuralÄ± silmek istediÄŸinizden emin misiniz?"))try{(await fetch(`/api/moderation/auto-mod/rules/${c}/${t}/`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).ok&&(m(i.filter(s=>s.id!==t)),n.success("âœ… Kural silindi"))}catch{n.error("âŒ Silme baÅŸarÄ±sÄ±z")}},w=async(t,l)=>{await N(t,{enabled:l})},C=()=>{r({name:"",type:"spam",action:"warn",enabled:!0,keywords:[],threshold:5,duration:60})},S=t=>{t.trim()&&!a.keywords.includes(t.trim())&&r({...a,keywords:[...a.keywords,t.trim()]})},K=t=>{r({...a,keywords:a.keywords.filter(l=>l!==t)})},R=t=>{switch(t){case"spam":return e.createElement(x,null);case"profanity":return e.createElement(j,null);case"caps":return"ğŸ”¤";case"links":return"ğŸ”—";case"mentions":return"@";default:return e.createElement(k,null)}},A=t=>{switch(t){case"warn":return"#faa61a";case"mute":return"#ff9500";case"kick":return"#ff3b30";case"ban":return"#ff0000";default:return"#8b5cf6"}};return e.createElement("div",{className:"auto-mod-panel-overlay",onClick:d},e.createElement("div",{className:"auto-mod-panel",onClick:t=>t.stopPropagation()},e.createElement("div",{className:"panel-header"},e.createElement($,{className:"header-icon"}),e.createElement("h2",null,"Otomatik Moderasyon"),e.createElement("button",{className:"close-btn",onClick:d},"Ã—")),e.createElement("div",{className:"panel-actions"},e.createElement("button",{className:"btn-create",onClick:()=>u(!0)},e.createElement(T,null)," Yeni Kural")),h?e.createElement("div",{className:"loading-state"},e.createElement("div",{className:"spinner"}),e.createElement("p",null,"YÃ¼kleniyor...")):e.createElement("div",{className:"rules-list"},i.length===0?e.createElement("div",{className:"empty-state"},e.createElement(k,{size:48}),e.createElement("h3",null,"Kural Yok"),e.createElement("p",null,"Otomatik moderasyon kurallarÄ± oluÅŸturun")):i.map(t=>e.createElement("div",{key:t.id,className:`rule-card ${t.enabled?"":"disabled"}`},e.createElement("div",{className:"rule-header"},e.createElement("div",{className:"rule-icon"},R(t.type)),e.createElement("div",{className:"rule-info"},e.createElement("h3",null,t.name),e.createElement("span",{className:"rule-type"},t.type)),e.createElement("div",{className:"rule-actions"},e.createElement("button",{className:"action-btn toggle",onClick:()=>w(t.id,!t.enabled),title:t.enabled?"Devre DÄ±ÅŸÄ± BÄ±rak":"EtkinleÅŸtir"},t.enabled?e.createElement(B,null):e.createElement(F,null)),e.createElement("button",{className:"action-btn edit",onClick:()=>p(t),title:"DÃ¼zenle"},e.createElement(O,null)),e.createElement("button",{className:"action-btn delete",onClick:()=>b(t.id),title:"Sil"},e.createElement(P,null)))),e.createElement("div",{className:"rule-details"},e.createElement("div",{className:"detail-item"},e.createElement("span",{className:"label"},"Aksiyon:"),e.createElement("span",{className:"value action-badge",style:{backgroundColor:A(t.action)}},t.action)),t.keywords&&t.keywords.length>0&&e.createElement("div",{className:"detail-item"},e.createElement("span",{className:"label"},"Anahtar Kelimeler:"),e.createElement("div",{className:"keywords"},t.keywords.map((l,s)=>e.createElement("span",{key:s,className:"keyword"},l)))),t.threshold&&e.createElement("div",{className:"detail-item"},e.createElement("span",{className:"label"},"EÅŸik:"),e.createElement("span",{className:"value"},t.threshold)))))),f&&e.createElement("div",{className:"rule-editor-modal"},e.createElement("div",{className:"rule-editor"},e.createElement("h3",null,"Yeni Kural OluÅŸtur"),e.createElement("div",{className:"form-group"},e.createElement("label",null,"Kural AdÄ±"),e.createElement("input",{type:"text",value:a.name,onChange:t=>r({...a,name:t.target.value}),placeholder:"Ã–rn: Spam Engelleme"})),e.createElement("div",{className:"form-row"},e.createElement("div",{className:"form-group"},e.createElement("label",null,"Kural Tipi"),e.createElement("select",{value:a.type,onChange:t=>r({...a,type:t.target.value})},e.createElement("option",{value:"spam"},"Spam"),e.createElement("option",{value:"profanity"},"KÃ¼fÃ¼r"),e.createElement("option",{value:"caps"},"BÃ¼yÃ¼k Harf"),e.createElement("option",{value:"links"},"Link"),e.createElement("option",{value:"mentions"},"Mention"))),e.createElement("div",{className:"form-group"},e.createElement("label",null,"Aksiyon"),e.createElement("select",{value:a.action,onChange:t=>r({...a,action:t.target.value})},e.createElement("option",{value:"warn"},"Uyar"),e.createElement("option",{value:"mute"},"Sustur"),e.createElement("option",{value:"kick"},"At"),e.createElement("option",{value:"ban"},"Yasakla")))),e.createElement("div",{className:"form-group"},e.createElement("label",null,"Anahtar Kelimeler (Enter ile ekle)"),e.createElement("input",{type:"text",placeholder:"Kelime girin ve Enter'a basÄ±n",onKeyPress:t=>{t.key==="Enter"&&(S(t.target.value),t.target.value="")}}),e.createElement("div",{className:"keywords-list"},a.keywords.map((t,l)=>e.createElement("span",{key:l,className:"keyword-chip"},t,e.createElement("button",{onClick:()=>K(t)},"Ã—"))))),e.createElement("div",{className:"form-row"},e.createElement("div",{className:"form-group"},e.createElement("label",null,"EÅŸik"),e.createElement("input",{type:"number",value:a.threshold,onChange:t=>r({...a,threshold:parseInt(t.target.value)}),min:"1"})),e.createElement("div",{className:"form-group"},e.createElement("label",null,"SÃ¼re (saniye)"),e.createElement("input",{type:"number",value:a.duration,onChange:t=>r({...a,duration:parseInt(t.target.value)}),min:"1"}))),e.createElement("div",{className:"modal-actions"},e.createElement("button",{className:"btn-cancel",onClick:()=>u(!1)},"Ä°ptal"),e.createElement("button",{className:"btn-save",onClick:g},"OluÅŸtur"))))))};export{V as default};
