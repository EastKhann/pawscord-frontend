import{r,n as e}from"./react-core-zXIKm1Jm.js";import{o as B}from"./index-CiRJFVVz.js";import"./editor-vendor-DiU449Dh.js";import"./media-vendor-BSOZ7IB3.js";import"./router-vendor-ltdGXAv4.js";import"./crypto-vendor-D_AcF0lD.js";import"./icons-vendor-BBdoVeJd.js";import"./state-vendor-8NbFPBhQ.js";const R=({username:m,onEdit:x,compact:v=!1})=>{const[n,k]=r.useState(null),[N,y]=r.useState(!0),j=B;if(r.useEffect(()=>{(async()=>{try{const l=localStorage.getItem("access_token"),b=m?`${j}/profile/card/${m}/`:`${j}/profile/card/`,o=await fetch(b,{headers:{Authorization:`Bearer ${l}`}});o.ok&&k(await o.json())}catch(l){console.error("Failed to load profile:",l)}y(!1)})()},[m,j]),N)return e.jsx("div",{className:"profile-card loading",children:e.jsx("div",{className:"loading-spinner"})});if(!n)return e.jsx("div",{className:"profile-card error",children:"Profil yÃ¼klenemedi"});const u=n.custom_colors||n.theme_colors;return e.jsxs("div",{className:`profile-card ${v?"compact":""}`,style:{"--primary":u.primary,"--secondary":u.secondary,"--accent":u.accent,"--bg":u.background},children:[e.jsx("div",{className:"card-banner",style:{backgroundImage:n.banner?`url(${n.banner})`:void 0,backgroundColor:n.banner_color},children:x&&e.jsx("button",{className:"edit-btn",onClick:x,children:"âœï¸"})}),e.jsxs("div",{className:"card-avatar",children:[e.jsx("img",{src:n.avatar||"/default-avatar.png",alt:""}),n.status_text&&e.jsx("div",{className:"status-indicator",title:n.status_text,children:n.status_text.slice(0,1)})]}),e.jsxs("div",{className:"card-content",children:[n.badges&&n.badges.length>0&&e.jsx("div",{className:"card-badges",children:n.badges.map(i=>{const l=T[i];return l?e.jsx("span",{className:"badge",style:{backgroundColor:l.color},title:l.name,children:l.icon},i):null})}),e.jsx("h2",{className:"card-name",children:n.display_name||n.username}),e.jsxs("p",{className:"card-username",children:["@",n.username]}),n.bio&&e.jsx("p",{className:"card-bio",children:n.bio}),e.jsxs("div",{className:"card-stats",children:[e.jsxs("div",{className:"stat",children:[e.jsxs("span",{className:"stat-value",children:["Lv.",n.level]}),e.jsx("span",{className:"stat-label",children:"Seviye"})]}),e.jsxs("div",{className:"stat",children:[e.jsx("span",{className:"stat-value",children:n.xp?.toLocaleString()}),e.jsx("span",{className:"stat-label",children:"XP"})]}),e.jsxs("div",{className:"stat",children:[e.jsx("span",{className:"stat-value",children:new Date(n.created_at).toLocaleDateString("tr-TR",{month:"short",year:"numeric"})}),e.jsx("span",{className:"stat-label",children:"KatÄ±lÄ±m"})]})]}),n.links&&n.links.length>0&&e.jsx("div",{className:"card-links",children:n.links.map((i,l)=>e.jsx("a",{href:i.url,target:"_blank",rel:"noopener noreferrer",className:"link-item",title:i.name,children:i.icon},l))}),n.spotify_connected&&e.jsx("div",{className:"spotify-badge",children:"ðŸŽµ Spotify BaÄŸlÄ±"}),n.is_premium&&e.jsx("div",{className:"premium-badge",children:"ðŸ’Ž Premium"})]})]})},T={early_supporter:{name:"Early Supporter",icon:"ðŸŒŸ",color:"#FFD700"},premium:{name:"Premium",icon:"ðŸ’Ž",color:"#a855f7"},verified:{name:"Verified",icon:"âœ“",color:"#5865F2"},developer:{name:"Developer",icon:"ðŸ› ï¸",color:"#3b82f6"},bug_hunter:{name:"Bug Hunter",icon:"ðŸ›",color:"#22c55e"},top_contributor:{name:"Top Contributor",icon:"ðŸ†",color:"#f59e0b"},server_owner:{name:"Server Owner",icon:"ðŸ‘‘",color:"#ef4444"},moderator:{name:"Moderator",icon:"ðŸ›¡ï¸",color:"#10b981"},artist:{name:"Artist",icon:"ðŸŽ¨",color:"#ec4899"},streamer:{name:"Streamer",icon:"ðŸ“º",color:"#8b5cf6"}},G=({onClose:m,onSave:x})=>{const[v,n]=r.useState(null),[k,N]=r.useState([]),[y,j]=r.useState([]),[u,i]=r.useState(!0),[l,b]=r.useState(!1),[o,S]=r.useState("appearance"),[c,p]=r.useState({banner:"",banner_color:"#5865F2",theme:"default",bio:"",links:[]}),[$,C]=r.useState([]),[g,_]=r.useState({name:"",url:""}),h=B,w=r.useCallback(async()=>{try{const a=localStorage.getItem("access_token"),[s,d,f]=await Promise.all([fetch(`${h}/profile/card/`,{headers:{Authorization:`Bearer ${a}`}}),fetch(`${h}/profile/themes/`,{headers:{Authorization:`Bearer ${a}`}}),fetch(`${h}/profile/badges/`,{headers:{Authorization:`Bearer ${a}`}})]);if(s.ok){const t=await s.json();n(t),p({banner:t.banner||"",banner_color:t.banner_color||"#5865F2",theme:t.theme||"default",bio:t.bio||"",links:t.links||[]}),C(t.badges||[])}if(d.ok){const t=await d.json();N(t.themes||[])}if(f.ok){const t=await f.json();j(t.badges||[])}}catch(a){console.error("Failed to load data:",a)}i(!1)},[h]),A=async()=>{b(!0);try{const a=localStorage.getItem("access_token"),s=await fetch(`${h}/profile/card/update/`,{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify(c)});await fetch(`${h}/profile/badges/set/`,{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify({badges:$})}),s.ok&&(x?.(),m())}catch(a){console.error("Save failed:",a)}b(!1)},P=async()=>{if(g.url)try{const a=localStorage.getItem("access_token"),s=await fetch(`${h}/profile/links/add/`,{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify(g)});if(s.ok){const d=await s.json();p(f=>({...f,links:d.links})),_({name:"",url:""})}}catch(a){console.error("Add link failed:",a)}},z=async a=>{try{const s=localStorage.getItem("access_token"),d=await fetch(`${h}/profile/links/${a}/remove/`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}});if(d.ok){const f=await d.json();p(t=>({...t,links:f.links}))}}catch(s){console.error("Remove link failed:",s)}},L=a=>{C(s=>s.includes(a)?s.filter(d=>d!==a):s.length>=3?s:[...s,a])};return r.useEffect(()=>{w()},[w]),u?e.jsx("div",{className:"profile-editor-modal",children:e.jsx("div",{className:"editor-loading",children:e.jsx("div",{className:"loading-spinner"})})}):e.jsx("div",{className:"profile-editor-overlay",onClick:a=>a.target===a.currentTarget&&m(),children:e.jsxs("div",{className:"profile-editor-modal",children:[e.jsxs("div",{className:"editor-header",children:[e.jsx("h2",{children:"ðŸŽ¨ Profil KartÄ± DÃ¼zenle"}),e.jsx("button",{className:"close-btn",onClick:m,children:"Ã—"})]}),e.jsxs("div",{className:"editor-tabs",children:[e.jsx("button",{className:o==="appearance"?"active":"",onClick:()=>S("appearance"),children:"ðŸŽ¨ GÃ¶rÃ¼nÃ¼m"}),e.jsx("button",{className:o==="badges"?"active":"",onClick:()=>S("badges"),children:"ðŸ… Rozetler"}),e.jsx("button",{className:o==="links"?"active":"",onClick:()=>S("links"),children:"ðŸ”— BaÄŸlantÄ±lar"})]}),e.jsxs("div",{className:"editor-content",children:[o==="appearance"&&e.jsxs("div",{className:"appearance-tab",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Banner URL"}),e.jsx("input",{type:"url",placeholder:"https://...",value:c.banner,onChange:a=>p(s=>({...s,banner:a.target.value}))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Banner Rengi (resim yoksa)"}),e.jsxs("div",{className:"color-picker",children:[e.jsx("input",{type:"color",value:c.banner_color,onChange:a=>p(s=>({...s,banner_color:a.target.value}))}),e.jsx("span",{children:c.banner_color})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Tema"}),e.jsx("div",{className:"theme-grid",children:k.map(a=>e.jsxs("div",{className:`theme-option ${c.theme===a.id?"selected":""}`,onClick:()=>p(s=>({...s,theme:a.id})),style:{background:`linear-gradient(135deg, ${a.primary}, ${a.secondary})`},children:[e.jsx("span",{className:"theme-name",children:a.id}),e.jsx("div",{className:"theme-colors",children:e.jsx("span",{style:{backgroundColor:a.accent}})})]},a.id))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Biyografi"}),e.jsx("textarea",{placeholder:"Kendiniz hakkÄ±nda bir ÅŸeyler yazÄ±n...",value:c.bio,onChange:a=>p(s=>({...s,bio:a.target.value.slice(0,500)})),rows:4,maxLength:500}),e.jsxs("span",{className:"char-count",children:[c.bio.length,"/500"]})]})]}),o==="badges"&&e.jsxs("div",{className:"badges-tab",children:[e.jsx("p",{className:"badges-hint",children:"Profilinizde gÃ¶rÃ¼ntÃ¼lenecek en fazla 3 rozet seÃ§in"}),e.jsx("div",{className:"badges-grid",children:y.map(a=>e.jsxs("div",{className:`badge-option ${a.owned?"":"locked"} ${$.includes(a.id)?"selected":""}`,onClick:()=>a.owned&&L(a.id),children:[e.jsx("span",{className:"badge-icon",style:{backgroundColor:a.color},children:a.icon}),e.jsx("span",{className:"badge-name",children:a.name}),!a.owned&&e.jsx("span",{className:"lock-icon",children:"ðŸ”’"})]},a.id))})]}),o==="links"&&e.jsxs("div",{className:"links-tab",children:[e.jsx("p",{className:"links-hint",children:"En fazla 5 baÄŸlantÄ± ekleyebilirsiniz"}),e.jsx("div",{className:"current-links",children:c.links.map((a,s)=>e.jsxs("div",{className:"link-row",children:[e.jsx("span",{className:"link-icon",children:a.icon}),e.jsx("span",{className:"link-name",children:a.name}),e.jsxs("a",{href:a.url,target:"_blank",rel:"noopener noreferrer",className:"link-url",children:[a.url.slice(0,40),"..."]}),e.jsx("button",{className:"remove-link",onClick:()=>z(s),children:"Ã—"})]},s))}),c.links.length<5&&e.jsxs("div",{className:"add-link-form",children:[e.jsx("input",{type:"text",placeholder:"Ä°sim (opsiyonel)",value:g.name,onChange:a=>_(s=>({...s,name:a.target.value}))}),e.jsx("input",{type:"url",placeholder:"URL",value:g.url,onChange:a=>_(s=>({...s,url:a.target.value}))}),e.jsx("button",{onClick:P,children:"Ekle"})]})]})]}),e.jsxs("div",{className:"editor-preview",children:[e.jsx("h4",{children:"Ã–nizleme"}),e.jsx(R,{username:v?.username,compact:!0})]}),e.jsxs("div",{className:"editor-footer",children:[e.jsx("button",{className:"cancel-btn",onClick:m,children:"Ä°ptal"}),e.jsx("button",{className:"save-btn",onClick:A,disabled:l,children:l?"Kaydediliyor...":"Kaydet"})]})]})})};export{R as ProfileCard,G as ProfileCardEditor,R as default};
