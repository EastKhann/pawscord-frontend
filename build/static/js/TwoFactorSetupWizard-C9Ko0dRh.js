import{r as n,ay as v,l as S,bo as k}from"./react-core-B6hadH-M.js";import{t as o}from"./index-D_6pZib5.js";const B=({fetchWithAuth:p,apiBaseUrl:d,onClose:u})=>{const[r,s]=n.useState(1),[m,y]=n.useState(""),[x,g]=n.useState(""),[f,b]=n.useState([]),[c,R]=n.useState(""),[i,l]=n.useState(!1),h=async()=>{l(!0);try{const a=await(await p(`${d}/auth/2fa/enable/`,{method:"POST"})).json();y(a.qr_code),g(a.secret),s(2),o.success("2FA setup initiated")}catch{o.error("Failed to start 2FA setup")}finally{l(!1)}},C=async()=>{if(!c||c.length!==6){o.error("Please enter a 6-digit code");return}l(!0);try{const a=await(await p(`${d}/auth/2fa/verify-setup/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:c})})).json();a.success?(b(a.backup_codes||[]),s(4),o.success("2FA enabled successfully!")):o.error("Invalid verification code")}catch{o.error("Failed to verify code")}finally{l(!1)}},E=()=>{navigator.clipboard.writeText(f.join(`
`)),o.success("Backup codes copied to clipboard")};return React.createElement("div",{style:e.overlay},React.createElement("div",{style:e.modal},React.createElement("div",{style:e.header},React.createElement("div",{style:e.headerLeft},React.createElement(v,{style:{marginRight:"10px",color:"#43b581"}}),React.createElement("h2",{style:e.title},"Two-Factor Authentication Setup")),React.createElement("button",{onClick:u,style:e.closeButton},React.createElement(S,null))),React.createElement("div",{style:e.content},r===1&&React.createElement("div",{style:e.stepContainer},React.createElement("div",{style:e.stepIcon},"ðŸ”’"),React.createElement("h3",{style:e.stepTitle},"Enhance Your Account Security"),React.createElement("p",{style:e.stepDescription},"Two-factor authentication adds an extra layer of security to your account. You'll need your phone's authentication app to complete setup."),React.createElement("div",{style:e.requirements},React.createElement("div",{style:e.requirementItem},"âœ“ Install an authenticator app (Google Authenticator, Authy, etc.)"),React.createElement("div",{style:e.requirementItem},"âœ“ Have your phone ready to scan a QR code"),React.createElement("div",{style:e.requirementItem},"âœ“ Save backup codes in a secure location")),React.createElement("button",{onClick:h,style:e.primaryButton,disabled:i},i?"Starting...":"Begin Setup")),r===2&&React.createElement("div",{style:e.stepContainer},React.createElement("div",{style:e.stepIcon},"ðŸ“±"),React.createElement("h3",{style:e.stepTitle},"Scan QR Code"),React.createElement("p",{style:e.stepDescription},"Open your authenticator app and scan this QR code."),m&&React.createElement("div",{style:e.qrContainer},React.createElement("img",{src:m,alt:"QR Code",style:e.qrCode})),React.createElement("div",{style:e.manualEntry},React.createElement("div",{style:e.manualLabel},"Or enter this code manually:"),React.createElement("div",{style:e.secretCode},x)),React.createElement("button",{onClick:()=>s(3),style:e.primaryButton},"Next Step")),r===3&&React.createElement("div",{style:e.stepContainer},React.createElement("div",{style:e.stepIcon},"ðŸ”‘"),React.createElement("h3",{style:e.stepTitle},"Verify Setup"),React.createElement("p",{style:e.stepDescription},"Enter the 6-digit code from your authenticator app to complete setup."),React.createElement("input",{type:"text",value:c,onChange:t=>R(t.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",style:e.codeInput,maxLength:6}),React.createElement("button",{onClick:C,style:e.primaryButton,disabled:i},i?"Verifying...":"Verify & Enable 2FA")),r===4&&React.createElement("div",{style:e.stepContainer},React.createElement("div",{style:e.stepIcon},"âœ…"),React.createElement("h3",{style:e.stepTitle},"Setup Complete!"),React.createElement("p",{style:e.stepDescription},"Save these backup codes in a secure location. You can use them if you lose access to your authenticator app."),React.createElement("div",{style:e.backupCodesContainer},f.map((t,a)=>React.createElement("div",{key:a,style:e.backupCode},t))),React.createElement("button",{onClick:E,style:e.copyButton},React.createElement(k,{style:{marginRight:"8px"}}),"Copy Backup Codes"),React.createElement("button",{onClick:u,style:e.primaryButton},"Done")))))},e={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.9)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999},modal:{backgroundColor:"#1e1e1e",borderRadius:"8px",width:"90%",maxWidth:"550px",maxHeight:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.6)"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #2c2f33"},headerLeft:{display:"flex",alignItems:"center"},title:{margin:0,fontSize:"18px",color:"#ffffff"},closeButton:{background:"none",border:"none",color:"#99aab5",cursor:"pointer",fontSize:"20px",padding:"5px"},content:{padding:"32px",overflowY:"auto",flex:1},stepContainer:{display:"flex",flexDirection:"column",alignItems:"center",gap:"20px"},stepIcon:{fontSize:"64px"},stepTitle:{margin:0,fontSize:"22px",color:"#ffffff",textAlign:"center"},stepDescription:{margin:0,fontSize:"14px",color:"#dcddde",textAlign:"center",lineHeight:"1.5"},requirements:{width:"100%",backgroundColor:"#2c2f33",borderRadius:"8px",padding:"16px",display:"flex",flexDirection:"column",gap:"8px"},requirementItem:{fontSize:"14px",color:"#dcddde"},qrContainer:{backgroundColor:"#ffffff",borderRadius:"8px",padding:"16px"},qrCode:{width:"200px",height:"200px"},manualEntry:{width:"100%",backgroundColor:"#2c2f33",borderRadius:"8px",padding:"16px",textAlign:"center"},manualLabel:{fontSize:"12px",color:"#99aab5",marginBottom:"8px"},secretCode:{fontSize:"16px",fontFamily:"monospace",color:"#5865f2",fontWeight:"600",letterSpacing:"2px"},codeInput:{width:"200px",padding:"16px",fontSize:"24px",textAlign:"center",backgroundColor:"#2c2f33",border:"2px solid #5865f2",borderRadius:"8px",color:"#ffffff",fontFamily:"monospace",letterSpacing:"8px"},backupCodesContainer:{width:"100%",backgroundColor:"#2c2f33",borderRadius:"8px",padding:"16px",display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"12px"},backupCode:{fontSize:"14px",fontFamily:"monospace",color:"#dcddde",backgroundColor:"#1e1e1e",padding:"8px",borderRadius:"4px",textAlign:"center"},primaryButton:{padding:"12px 32px",backgroundColor:"#43b581",border:"none",borderRadius:"4px",color:"#ffffff",cursor:"pointer",fontSize:"16px",fontWeight:"600"},copyButton:{padding:"10px 24px",backgroundColor:"#5865f2",border:"none",borderRadius:"4px",color:"#ffffff",cursor:"pointer",fontSize:"14px",display:"flex",alignItems:"center"}};export{B as default};
