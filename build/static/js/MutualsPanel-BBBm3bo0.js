import{r as a,n as s}from"./react-core-Cj7FUMmY.js";import{ap as i,a as O,D as m,h as $,I as E,bf as _,at as g,u as B,a5 as I}from"./icons-vendor-DnRG7SaF.js";import{y as P}from"./ui-vendor-EA4dxvko.js";import"./editor-vendor-D9c4a6XZ.js";const G=({userId:b,username:u,onClose:x,onNavigateToUser:h,onNavigateToServer:j})=>{const[n,p]=a.useState("friends"),[l,d]=a.useState([]),[c,o]=a.useState([]),[k,v]=a.useState(!0),[t,F]=a.useState(""),S=localStorage.getItem("access_token");a.useEffect(()=>{y()},[b]);const y=async()=>{v(!0);try{const e=await fetch(`/api/users/${u}/mutuals/`,{headers:{Authorization:`Bearer ${S}`}});if(e.ok){const r=await e.json();d(r.friends||[]),o(r.servers||[])}else d([]),o([])}catch{d([]),o([])}v(!1)},C=()=>t?l.filter(e=>e.username.toLowerCase().includes(t.toLowerCase())):l,w=()=>t?c.filter(e=>e.name.toLowerCase().includes(t.toLowerCase())):c,M=e=>({online:"#4caf50",idle:"#ffc107",dnd:"#f44336",offline:"#666"})[e]||"#666",A=e=>e>=1e6?(e/1e6).toFixed(1)+"M":e>=1e3?(e/1e3).toFixed(1)+"K":e.toString(),L=e=>{P.info(`${e.username} ile sohbet başlatılıyor...`)},f=C(),N=w();return s.jsx("div",{className:"mutuals-overlay",onClick:e=>e.target.className==="mutuals-overlay"&&x(),children:s.jsxs("div",{className:"mutuals-panel",children:[s.jsxs("div",{className:"panel-header",children:[s.jsxs("h2",{children:[s.jsx(i,{})," Ortak Bağlantılar"]}),s.jsxs("span",{className:"target-user",children:["@",u]}),s.jsx("button",{className:"close-btn",onClick:x,children:s.jsx(O,{})})]}),s.jsxs("div",{className:"tabs",children:[s.jsxs("button",{className:`tab ${n==="friends"?"active":""}`,onClick:()=>p("friends"),children:[s.jsx(i,{}),s.jsx("span",{children:"Ortak Arkadaşlar"}),s.jsx("span",{className:"count",children:l.length})]}),s.jsxs("button",{className:`tab ${n==="servers"?"active":""}`,onClick:()=>p("servers"),children:[s.jsx(m,{}),s.jsx("span",{children:"Ortak Sunucular"}),s.jsx("span",{className:"count",children:c.length})]})]}),s.jsxs("div",{className:"search-bar",children:[s.jsx($,{}),s.jsx("input",{type:"text",placeholder:n==="friends"?"Arkadaş ara...":"Sunucu ara...",value:t,onChange:e=>F(e.target.value)})]}),s.jsx("div",{className:"content",children:k?s.jsx("div",{className:"loading",children:"Yükleniyor..."}):n==="friends"?s.jsx("div",{className:"friends-list",children:f.length===0?s.jsxs("div",{className:"empty-state",children:[s.jsx(i,{}),s.jsx("p",{children:"Ortak arkadaş bulunamadı"})]}):f.map(e=>s.jsxs("div",{className:"friend-item",onClick:()=>h&&h(e.id),children:[s.jsxs("div",{className:"friend-avatar",children:[e.avatar?s.jsx("img",{src:e.avatar,alt:""}):s.jsx(E,{}),s.jsx("span",{className:"status-dot",style:{background:M(e.status)}})]}),s.jsxs("div",{className:"friend-info",children:[s.jsx("span",{className:"friend-name",children:e.username}),e.activity&&s.jsx("span",{className:"friend-activity",children:e.activity})]}),s.jsx("div",{className:"friend-actions",children:s.jsx("button",{className:"action-btn message",onClick:r=>{r.stopPropagation(),L(e)},title:"Mesaj Gönder",children:s.jsx(_,{})})})]},e.id))}):s.jsx("div",{className:"servers-list",children:N.length===0?s.jsxs("div",{className:"empty-state",children:[s.jsx(m,{}),s.jsx("p",{children:"Ortak sunucu bulunamadı"})]}):N.map(e=>s.jsxs("div",{className:"server-item",onClick:()=>j&&j(e.id),children:[s.jsx("div",{className:"server-icon",children:e.icon?s.jsx("img",{src:e.icon,alt:""}):s.jsx("span",{children:e.name.charAt(0)})}),s.jsxs("div",{className:"server-info",children:[s.jsxs("div",{className:"server-name-row",children:[s.jsx("span",{className:"server-name",children:e.name}),e.is_owner&&s.jsx(g,{className:"owner-badge"})]}),s.jsxs("div",{className:"server-meta",children:[s.jsxs("span",{className:"member-count",children:[s.jsx(B,{})," ",A(e.member_count)]}),e.role&&s.jsxs("span",{className:`role-badge ${e.role.toLowerCase()}`,children:[e.role==="Owner"&&s.jsx(g,{}),e.role==="Moderator"&&s.jsx(I,{}),e.role]})]})]})]},e.id))})}),s.jsxs("div",{className:"summary",children:[s.jsxs("span",{children:[s.jsx(i,{})," ",l.length," ortak arkadaş"]}),s.jsxs("span",{children:[s.jsx(m,{})," ",c.length," ortak sunucu"]})]})]})})};export{G as default};
