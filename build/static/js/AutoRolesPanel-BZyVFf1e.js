var A=Object.defineProperty;var a=(o,m)=>A(o,"name",{value:m,configurable:!0});import{r as d,j as e}from"./react-core-Djgtqrmb.js";import{y as t}from"./ui-vendor-IhB9Znpc.js";import{g as O,d as C}from"./index-D0nbcjO7.js";import"./media-vendor-CxFPycob.js";import"./router-vendor-gmJ9Mn-1.js";import"./state-vendor-CbW2fAN9.js";import"./crypto-vendor-D1XRGppi.js";import"./icons-vendor-BMXAt4pj.js";const M=a(({serverId:o,onClose:m})=>{const c=O(),[h,g]=d.useState([]),[p,j]=d.useState([]),[x,_]=d.useState(!0),[r,n]=d.useState({role_id:"",trigger_type:"on_join",delay:0,required_level:0,required_invites:0,required_messages:0,remove_after:0,enabled:!0}),v=[{value:"on_join",label:"Sunucuya KatÄ±lÄ±nca",icon:"ğŸ‘‹"},{value:"on_verify",label:"DoÄŸrulama SonrasÄ±",icon:"âœ…"},{value:"on_level",label:"Seviyeye UlaÅŸÄ±nca",icon:"â­"},{value:"on_invites",label:"Davet SayÄ±sÄ±",icon:"ğŸ‘¥"},{value:"on_messages",label:"Mesaj SayÄ±sÄ±",icon:"ğŸ’¬"},{value:"on_reaction",label:"Reaksiyon Verince",icon:"ğŸ˜€"},{value:"on_boost",label:"Sunucu Boost",icon:"ğŸš€"}];d.useEffect(()=>{u(),y()},[o]);const u=a(async()=>{try{const s=await fetch(`${c}/auto-roles/server/${o}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(s.ok){const i=await s.json();g(i)}}catch{}finally{_(!1)}},"fetchAutoRoles"),y=a(async()=>{try{const s=await fetch(`${c}/roles/server/${o}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(s.ok){const i=await s.json();j(i)}}catch{}},"fetchRoles"),f=a(async()=>{if(!r.role_id){t.error("âŒ LÃ¼tfen rol seÃ§in");return}try{(await fetch(`${c}/auto-roles/create/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`,"Content-Type":"application/json"},body:JSON.stringify({server_id:o,...r})})).ok?(t.success("âœ… Otomatik rol oluÅŸturuldu"),u(),n({role_id:"",trigger_type:"on_join",delay:0,required_level:0,required_invites:0,required_messages:0,remove_after:0,enabled:!0})):t.error("âŒ Otomatik rol oluÅŸturulamadÄ±")}catch{t.error("âŒ BaÄŸlantÄ± hatasÄ±")}},"createAutoRole"),k=a(async(s,i)=>{try{(await fetch(`${c}/auto-roles/${s}/toggle/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}})).ok?(t.success(i?"âœ… Otomatik rol devre dÄ±ÅŸÄ±":"âœ… Otomatik rol aktif"),u()):t.error("âŒ Durum gÃ¼ncellenemedi")}catch{t.error("âŒ BaÄŸlantÄ± hatasÄ±")}},"toggleAutoRole"),N=a(async s=>{if(await C("Otomatik rolÃ¼ silmek istediÄŸinize emin misiniz?"))try{(await fetch(`${c}/auto-roles/${s}/delete/`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}})).ok?(t.success("âœ… Otomatik rol silindi"),u()):t.error("âŒ Otomatik rol silinemedi")}catch{t.error("âŒ BaÄŸlantÄ± hatasÄ±")}},"deleteAutoRole"),b=a(s=>{const i=p.find(l=>l.id===s);return i?i.name:"Bilinmeyen Rol"},"getRoleName"),S=a(s=>{const i=v.find(l=>l.value===s);return i?i.label:s},"getTriggerLabel"),q=a(s=>{const i=v.find(l=>l.value===s);return i?i.icon:"âš™ï¸"},"getTriggerIcon"),$=a(s=>{if(s===0)return"AnÄ±nda";const i=Math.floor(s/60),l=Math.floor(i/60);return l>0?`${l} saat`:`${i} dakika`},"formatDelay");return e.jsx("div",{className:"autoroles-panel-overlay",onClick:m,children:e.jsxs("div",{className:"autoroles-panel",onClick:a(s=>s.stopPropagation(),"onClick"),children:[e.jsxs("div",{className:"autoroles-header",children:[e.jsx("h2",{children:"âš¡ Otomatik Roller"}),e.jsx("button",{className:"close-btn",onClick:m,children:"Ã—"})]}),e.jsxs("div",{className:"autoroles-content",children:[e.jsxs("div",{className:"create-autorole-section",children:[e.jsx("h3",{children:"Yeni Otomatik Rol Ekle"}),e.jsxs("div",{className:"create-form",children:[e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Rol *"}),e.jsxs("select",{value:r.role_id,onChange:a(s=>n({...r,role_id:s.target.value}),"onChange"),children:[e.jsx("option",{value:"",children:"Rol SeÃ§in"}),p.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Tetikleyici"}),e.jsx("select",{value:r.trigger_type,onChange:a(s=>n({...r,trigger_type:s.target.value}),"onChange"),children:v.map(s=>e.jsxs("option",{value:s.value,children:[s.icon," ",s.label]},s.value))})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Gecikme (Saniye)"}),e.jsx("input",{type:"number",min:"0",placeholder:"0 = AnÄ±nda",value:r.delay,onChange:a(s=>n({...r,delay:parseInt(s.target.value)||0}),"onChange")})]}),r.trigger_type==="on_level"&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Gerekli Seviye"}),e.jsx("input",{type:"number",min:"1",value:r.required_level,onChange:a(s=>n({...r,required_level:parseInt(s.target.value)||0}),"onChange")})]}),r.trigger_type==="on_invites"&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Gerekli Davet"}),e.jsx("input",{type:"number",min:"1",value:r.required_invites,onChange:a(s=>n({...r,required_invites:parseInt(s.target.value)||0}),"onChange")})]}),r.trigger_type==="on_messages"&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Gerekli Mesaj"}),e.jsx("input",{type:"number",min:"1",value:r.required_messages,onChange:a(s=>n({...r,required_messages:parseInt(s.target.value)||0}),"onChange")})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Otomatik KaldÄ±r (Saat)"}),e.jsx("input",{type:"number",min:"0",placeholder:"0 = HiÃ§bir zaman",value:r.remove_after,onChange:a(s=>n({...r,remove_after:parseInt(s.target.value)||0}),"onChange")})]})]}),e.jsx("button",{className:"create-btn",onClick:f,children:"âš¡ Otomatik Rol OluÅŸtur"})]})]}),e.jsxs("div",{className:"autoroles-list-section",children:[e.jsxs("h3",{children:["Aktif Otomatik Roller (",h.length,")"]}),x?e.jsxs("div",{className:"loading-state",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{children:"Otomatik roller yÃ¼kleniyor..."})]}):h.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("span",{className:"empty-icon",children:"âš¡"}),e.jsx("p",{children:"HenÃ¼z otomatik rol yok"}),e.jsx("span",{className:"empty-hint",children:"KullanÄ±cÄ±lara otomatik rol atamalarÄ± yapabilirsiniz"})]}):e.jsx("div",{className:"autoroles-list",children:h.map(s=>e.jsxs("div",{className:`autorole-card ${s.enabled?"":"disabled"}`,children:[e.jsxs("div",{className:"autorole-card-header",children:[e.jsxs("div",{className:"role-info",children:[e.jsx("span",{className:"trigger-icon",children:q(s.trigger_type)}),e.jsxs("div",{children:[e.jsx("h4",{children:b(s.role_id)}),e.jsx("span",{className:"trigger-label",children:S(s.trigger_type)})]})]}),e.jsxs("div",{className:"autorole-actions",children:[e.jsx("button",{className:`toggle-btn ${s.enabled?"active":""}`,onClick:a(()=>k(s.id,s.enabled),"onClick"),children:s.enabled?"âœ“":"â—‹"}),e.jsx("button",{className:"delete-btn",onClick:a(()=>N(s.id),"onClick"),children:"ğŸ—‘ï¸"})]})]}),e.jsxs("div",{className:"autorole-details",children:[s.delay>0&&e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-icon",children:"â±ï¸"}),e.jsxs("span",{children:["Gecikme: ",$(s.delay)]})]}),s.required_level>0&&e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-icon",children:"â­"}),e.jsxs("span",{children:["Seviye ",s.required_level," gerekli"]})]}),s.required_invites>0&&e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-icon",children:"ğŸ‘¥"}),e.jsxs("span",{children:[s.required_invites," davet gerekli"]})]}),s.required_messages>0&&e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-icon",children:"ğŸ’¬"}),e.jsxs("span",{children:[s.required_messages," mesaj gerekli"]})]}),s.remove_after>0&&e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-icon",children:"ğŸ”„"}),e.jsxs("span",{children:[s.remove_after," saat sonra kaldÄ±rÄ±lÄ±r"]})]}),s.uses_count>0&&e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-icon",children:"ğŸ“Š"}),e.jsxs("span",{children:[s.uses_count," kere kullanÄ±ldÄ±"]})]})]})]},s.id))})]})]})]})})},"AutoRolesPanel");export{M as default};
