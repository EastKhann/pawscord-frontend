import{r as l,j as e,a as Q}from"./react-core-D6cE4lil.js";import{n as tt,a as nt,P as De,o as at,t as J}from"./index-DHLSv4f5.js";import it from"./UserContextMenu-B0FahpaM.js";import rt from"./VoiceSettingsPanel-1kDSsB9Z.js";import{S as ot}from"./crypto-vendor-Drccqhv1.js";import{D as st}from"./cjs-BZ354i3C.js";import"./media-vendor-Du00QUHb.js";import"./router-vendor-wrB4dqw3.js";import"./state-vendor-DnurjGY_.js";import"./icons-vendor-fClA8qVL.js";import"./ui-vendor-CZOhtEfS.js";const lt=(t,i)=>{const o=l.useRef(null),s=l.useRef(null);return l.useEffect(()=>{o.current&&t&&(o.current.srcObject=t)},[t]),l.useEffect(()=>{if(s.current&&t&&!i.isLocal){const d=t.getAudioTracks();if(d.length>0){s.current.srcObject=new MediaStream(d);const u=i.volume||100;if(u<=100)s.current.volume=Math.max(0,u/100);else{s.current.volume=1;try{const a=s.current;a._audioContext||(a._audioContext=new(window.AudioContext||window.webkitAudioContext),a._sourceNode=a._audioContext.createMediaElementSource(a),a._gainNode=a._audioContext.createGain(),a._sourceNode.connect(a._gainNode),a._gainNode.connect(a._audioContext.destination)),a._gainNode.gain.value=u/100}catch{}}}}},[t,i.isLocal,i.username,i.volume]),{videoRef:o,audioRef:s}},pe=(t,i=256)=>{if(!t)return`https://ui-avatars.com/api/?name=User&background=5865f2&color=fff&bold=true&size=${i}`;const o=ot.hash(t),s=parseInt(o.substring(0,8),16)%360;return`https://ui-avatars.com/api/?name=${encodeURIComponent(t)}&background=${s.toString(16).padStart(2,"0")}${((s+60)%360).toString(16).padStart(2,"0")}${((s+120)%360).toString(16).padStart(2,"0")}&color=fff&bold=true&size=${i}`},ct=({user:t,stream:i,videoRef:o,getUserAvatar:s,badge:d})=>{const u=i&&i.active&&i.getVideoTracks().length>0;return e.jsxs("div",{style:{width:"100%",height:"100%",background:"#1a1a1a",display:"flex",alignItems:"center",justifyContent:"center"},children:[d,u?e.jsx("video",{ref:o,autoPlay:!0,playsInline:!0,muted:t.isLocal===!0,style:{width:"100%",height:"100%",objectFit:t.streamType==="screen"?"contain":"cover",backgroundColor:t.streamType==="screen"?"#000":"#1a1a1a"}}):e.jsxs("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"16px",background:"linear-gradient(135deg, #36393f 0%, #2f3136 50%, #202225 100%)",position:"relative"},children:[e.jsx("div",{style:{position:"relative",padding:"8px",borderRadius:"50%",background:t.isTalking?"linear-gradient(135deg, #43b581, #3ca374)":"transparent",boxShadow:t.isTalking?"0 0 20px rgba(67, 181, 129, 0.6), 0 0 40px rgba(67, 181, 129, 0.3)":"none",transition:"all 0.3s ease",animation:t.isTalking?"talkingPulse 1s ease-in-out infinite":"none"},children:e.jsx("img",{src:s(t.username),alt:t.username,onError:a=>{a.target.onerror=null,a.target.src=pe(t.username,256)},style:{width:"140px",height:"140px",borderRadius:"50%",objectFit:"cover",border:"5px solid #40444b",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.5)",display:"block"},loading:"lazy"})}),e.jsx("div",{style:{color:"#fff",fontSize:"18px",fontWeight:700,textShadow:"0 2px 8px rgba(0, 0, 0, 0.7)",letterSpacing:"0.5px"},children:t.username}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"6px 14px",background:t.isMuted?"rgba(240, 71, 71, 0.2)":"rgba(67, 181, 129, 0.2)",borderRadius:"16px",border:t.isMuted?"1px solid rgba(240, 71, 71, 0.4)":"1px solid rgba(67, 181, 129, 0.4)"},children:[e.jsx("span",{style:{fontSize:"16px"},children:t.isMuted?"ðŸ”‡":"ðŸŽ¤"}),e.jsx("span",{style:{color:t.isMuted?"#f04747":"#43b581",fontSize:"13px",fontWeight:600},children:t.isMuted?"Sessiz":t.isTalking?"KonuÅŸuyor...":"Dinliyor"})]})]})]})},dt=({user:t,isActive:i,connectionQuality:o})=>e.jsxs("div",{style:{position:"absolute",bottom:0,left:0,right:0,background:"linear-gradient(to top, rgba(0, 0, 0, 0.8), transparent)",padding:"12px 16px",display:"flex",alignItems:"center",gap:"8px",zIndex:10},children:[t.isTalking&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"3px"},children:[e.jsx("div",{style:{width:"3px",height:"12px",background:"#43b581",borderRadius:"2px",animation:"wave1 0.6s ease-in-out infinite"}}),e.jsx("div",{style:{width:"3px",height:"16px",background:"#43b581",borderRadius:"2px",animation:"wave2 0.6s ease-in-out infinite 0.1s"}}),e.jsx("div",{style:{width:"3px",height:"12px",background:"#43b581",borderRadius:"2px",animation:"wave3 0.6s ease-in-out infinite 0.2s"}})]}),!t.isLocal&&o&&e.jsx("div",{title:`RTT: ${o.rtt}ms, Packet Loss: ${o.packetLoss}%`,style:{fontSize:"16px",filter:o.quality==="excellent"?"none":o.quality==="good"?"hue-rotate(30deg)":"hue-rotate(90deg) saturate(2)",opacity:.9},children:o.quality==="excellent"||o.quality==="good"?"ðŸ“¶":"âš ï¸"}),e.jsxs("span",{onClick:s=>{s.stopPropagation(),t.isLocal||(window.openUserProfile?window.openUserProfile(t.username):window.location.hash=`#/profile/${t.username}`)},style:{color:"#fff",fontSize:"14px",fontWeight:600,flex:1,cursor:t.isLocal?"default":"pointer",textDecoration:t.isLocal?"none":"underline",textDecorationColor:"rgba(255, 255, 255, 0.3)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[t.username," ",t.streamType==="screen"&&"ðŸ–¥ï¸ Ekran"]}),e.jsxs("div",{style:{display:"flex",gap:"6px"},children:[t.isMuted&&e.jsx("span",{style:{fontSize:"16px"},children:"ðŸ”‡"}),t.streamType==="camera"&&t.isCameraOn&&e.jsx("span",{style:{fontSize:"16px"},children:"ðŸ“¹"}),i&&e.jsx("span",{style:{fontSize:"16px"},children:"ðŸ”Š"})]})]}),be=({icon:t,onClick:i,title:o,bgColor:s="rgba(0, 0, 0, 0.7)"})=>e.jsx("button",{onClick:i,title:o,style:{background:s,border:"1px solid rgba(255, 255, 255, 0.3)",borderRadius:"8px",width:"36px",height:"36px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",fontSize:"14px",color:"#fff",fontWeight:"bold",transition:"all 0.2s ease",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.3)"},onMouseEnter:d=>{d.currentTarget.style.transform="scale(1.1)",d.currentTarget.style.boxShadow="0 4px 16px rgba(255, 255, 255, 0.3)"},onMouseLeave:d=>{d.currentTarget.style.transform="scale(1)",d.currentTarget.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.3)"},children:t}),pt=({user:t,isPinned:i,onPin:o,onExpand:s,showFullControls:d,videoRef:u})=>e.jsxs("div",{style:{position:"absolute",top:"12px",right:"12px",display:"flex",gap:"6px",opacity:d?1:0,transition:"opacity 0.25s ease, transform 0.25s ease",transform:d?"translateY(0)":"translateY(-6px)",zIndex:20,pointerEvents:d?"auto":"none"},children:[e.jsx(be,{icon:i?"ðŸ“Œ":"ðŸ“",onClick:a=>{a.stopPropagation(),o()},title:i?"Sabitlemeyi KaldÄ±r":"Sabitle",bgColor:"rgba(88, 101, 242, 0.9)"}),e.jsx(be,{icon:"â›¶",onClick:a=>{a.stopPropagation(),s()},title:"Panelde GeniÅŸlet",bgColor:"rgba(67, 181, 129, 0.9)"}),e.jsx(be,{icon:"ðŸ–¥ï¸",onClick:a=>{a.stopPropagation();const S=u.current;if(S){const b=S.parentElement?.parentElement||S;b.requestFullscreen?b.requestFullscreen():b.webkitRequestFullscreen?b.webkitRequestFullscreen():b.mozRequestFullScreen?b.mozRequestFullScreen():b.msRequestFullscreen&&b.msRequestFullscreen()}},title:"Tam Ekran Ä°zle",bgColor:"rgba(250, 166, 26, 0.9)"}),!t.isLocal&&d&&e.jsxs("div",{style:{background:"rgba(0, 0, 0, 0.9)",borderRadius:"10px",padding:"6px 10px",display:"flex",alignItems:"center",gap:"6px",minWidth:"100px",backdropFilter:"blur(8px)",border:"1px solid rgba(255, 255, 255, 0.1)",animation:"fadeIn 0.2s ease"},children:[e.jsx("span",{style:{fontSize:"12px"},children:(t.volume||100)===0?"ðŸ”‡":(t.volume||100)>100?"ðŸ”Š":"ðŸ”‰"}),e.jsx("input",{type:"range",min:"0",max:"200",value:t.volume||100,onChange:a=>{a.stopPropagation(),t.onVolumeChange&&t.onVolumeChange(parseInt(a.target.value))},style:{flex:1,cursor:"pointer",height:"4px"},onClick:a=>a.stopPropagation()}),e.jsxs("span",{style:{fontSize:"10px",color:"#fff",minWidth:"30px",fontWeight:600},children:[t.volume||100,"%"]})]})]}),ye=Q.memo(({user:t,stream:i,isActive:o,isPinned:s,onExpand:d,onPin:u,onContextMenu:a,compact:S=!1,badge:v,connectionQuality:b,getUserAvatar:A})=>{const{videoRef:w,audioRef:j}=lt(i,t),[D,_]=l.useState(!1),c=l.useCallback(R=>{R.preventDefault(),a&&t.username!==t.isLocal&&a({user:t,position:{x:R.clientX,y:R.clientY}})},[a,t]),y=l.useCallback(R=>{!t.isLocal&&a&&a({user:t,position:{x:R.clientX,y:R.clientY}})},[t,a]);return e.jsxs("div",{onContextMenu:c,onClick:y,onMouseEnter:()=>_(!0),onMouseLeave:()=>_(!1),style:{background:"linear-gradient(135deg, #2c2f33 0%, #23272a 100%)",borderRadius:"16px",overflow:"hidden",position:"relative",border:o?"3px solid #43b581":s?"3px solid #5865f2":"1px solid rgba(255, 255, 255, 0.1)",boxShadow:o?"0 0 20px rgba(67, 181, 129, 0.5)":"0 4px 16px rgba(0, 0, 0, 0.3)",transition:"all 0.3s ease",cursor:t.isLocal?"default":"pointer",width:"100%",height:"100%",display:"flex",flexDirection:"column"},children:[!t.isLocal&&i&&e.jsx("audio",{ref:j,autoPlay:!0,playsInline:!0,"data-username":t.username,style:{display:"none"}}),e.jsx(ct,{user:t,stream:i,videoRef:w,getUserAvatar:A,badge:v}),e.jsx(dt,{user:t,isActive:o,connectionQuality:b}),e.jsx(pt,{user:t,isPinned:s,onPin:u,onExpand:d,showFullControls:D,videoRef:w}),e.jsx("style",{children:`
                div:hover .hover-actions {
                    opacity: 1;
                }
            `})]})},(t,i)=>t.user.username===i.user.username&&t.stream===i.stream&&t.user.isCameraOn===i.user.isCameraOn&&t.user.isScreenSharing===i.user.isScreenSharing&&t.user.isMuted===i.user.isMuted&&t.isActive===i.isActive&&t.isPinned===i.isPinned&&t.compact===i.compact),B=({icon:t,active:i,danger:o,special:s,subtle:d,small:u,isLeave:a,onClick:S,title:v,label:b})=>{const A=()=>a?"linear-gradient(135deg, #ed4245 0%, #c03537 100%)":o&&i?"rgba(240, 71, 71, 0.4)":o?"rgba(240, 71, 71, 0.15)":s?"linear-gradient(135deg, #5865f2 0%, #4752c4 100%)":i?"rgba(67, 181, 129, 0.25)":d?"rgba(255, 255, 255, 0.05)":"rgba(255, 255, 255, 0.1)",w=()=>a?"none":o&&i?"2px solid rgba(240, 71, 71, 0.6)":i?"2px solid rgba(67, 181, 129, 0.5)":s?"2px solid rgba(88, 101, 242, 0.5)":"2px solid transparent";return e.jsxs("button",{onClick:S,title:v,style:{background:A(),border:w(),borderRadius:a?"50%":"12px",width:a?"48px":u?"40px":"48px",height:a?"48px":u?"40px":"48px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",cursor:"pointer",fontSize:u?"16px":"20px",color:"#fff",transition:"all 0.2s ease",boxShadow:a?"0 4px 15px rgba(237, 66, 69, 0.4)":i?"0 2px 10px rgba(67, 181, 129, 0.3)":"none",transform:"scale(1)"},onMouseEnter:j=>{j.currentTarget.style.transform="scale(1.1)",j.currentTarget.style.boxShadow=a?"0 6px 20px rgba(237, 66, 69, 0.6)":"0 4px 15px rgba(255, 255, 255, 0.2)"},onMouseLeave:j=>{j.currentTarget.style.transform="scale(1)",j.currentTarget.style.boxShadow=a?"0 4px 15px rgba(237, 66, 69, 0.4)":i?"0 2px 10px rgba(67, 181, 129, 0.3)":"none"},children:[e.jsx("span",{children:t}),b&&e.jsx("span",{style:{fontSize:"9px",marginTop:"2px",fontWeight:600},children:b})]})},xt=({isMuted:t,isDeafened:i,isCameraOn:o,isScreenSharing:s,isSpatialAudio:d,isRecording:u,recordingDuration:a,onToggleMute:S,onToggleDeafened:v,onToggleCamera:b,onToggleScreenShare:A,onToggleSpatialAudio:w,onStartRecording:j,onStopRecording:D,onDownloadRecording:_,onLeave:c,onSettings:y})=>{const R=F=>{const V=Math.floor(F/60).toString().padStart(2,"0"),X=Math.floor(F%60).toString().padStart(2,"0");return`${V}:${X}`};return e.jsxs("div",{style:{background:"linear-gradient(180deg, rgba(32, 34, 37, 0.98) 0%, rgba(24, 25, 28, 1) 100%)",padding:"12px 20px",display:"flex",justifyContent:"center",alignItems:"center",gap:"10px",borderTop:"1px solid rgba(255, 255, 255, 0.08)",boxShadow:"0 -4px 20px rgba(0, 0, 0, 0.4)",flexShrink:0,minHeight:"70px",position:"relative",zIndex:100},children:[e.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[e.jsx(B,{icon:t?"ðŸ”‡":"ðŸŽ¤",active:!t,danger:t,onClick:S,title:t?"Mikrofonu AÃ§":"Mikrofonu Kapat"}),e.jsx(B,{icon:i?"ðŸ”ˆ":"ðŸŽ§",active:!i,danger:i,onClick:v,title:i?"KulaklÄ±ÄŸÄ± AÃ§":"KulaklÄ±ÄŸÄ± Kapat"})]}),e.jsxs("div",{style:{display:"flex",gap:"8px",padding:"0 16px",borderLeft:"1px solid rgba(255, 255, 255, 0.1)",borderRight:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx(B,{icon:o?"ðŸ“¹":"ðŸ“·",active:o,onClick:b,title:o?"KamerayÄ± Kapat":"KamerayÄ± AÃ§"}),e.jsx(B,{icon:"ðŸ–¥ï¸",active:s,special:s,onClick:A,title:s?"PaylaÅŸÄ±mÄ± Durdur":"Ekran PaylaÅŸ"}),w&&e.jsx(B,{icon:"ðŸ”Š",active:d,onClick:w,title:d?"3D Ses (AÃ§Ä±k)":"3D Ses (KapalÄ±)",small:!0})]}),e.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[j&&D&&e.jsx(B,{icon:u?"â¹ï¸":"âºï¸",active:u,danger:u,onClick:u?D:j,title:u?`KaydÄ± Durdur (${R(a)})`:"KayÄ±t BaÅŸlat",label:u?R(a):null}),y&&e.jsx(B,{icon:"âš™ï¸",onClick:y,title:"Ayarlar",subtle:!0})]}),e.jsx(B,{icon:"ðŸ“ž",danger:!0,onClick:c,title:"AyrÄ±l",isLeave:!0})]})},ut=({stream:t,fullscreen:i})=>{const o=l.useRef(null);return l.useEffect(()=>{o.current&&t&&(o.current.srcObject=t)},[t]),e.jsx("video",{ref:o,autoPlay:!0,playsInline:!0,muted:!1,style:{width:"100%",height:"100%",objectFit:i?"contain":"cover",background:"#000"}})},de=({icon:t,active:i,danger:o,onClick:s,title:d})=>e.jsx("button",{onClick:s,title:d,style:{background:i?"rgba(88, 101, 242, 0.8)":o?"rgba(237, 66, 69, 0.8)":"rgba(255, 255, 255, 0.15)",border:"none",borderRadius:"8px",width:"36px",height:"36px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",fontSize:"16px",transition:"all 0.2s ease"},children:t}),Ke=Q.memo(({roomName:t,userCount:i,combinedUsers:o,currentUser:s,onToggleMinimize:d,onContextMenu:u,getUserAvatar:a,isMuted:S,isCameraOn:v,isScreenSharing:b,toggleMute:A,toggleCamera:w,toggleScreenShare:j,leaveVoice:D})=>{const _=l.useRef(null);return e.jsx(st,{nodeRef:_,handle:".mini-drag-handle",defaultPosition:{x:20,y:window.innerHeight-180},bounds:"parent",children:e.jsxs("div",{ref:_,style:{position:"fixed",zIndex:9999,background:"linear-gradient(135deg, #1e2124 0%, #2c2f33 50%, #23272a 100%)",borderRadius:"16px",padding:"16px",boxShadow:"0 12px 48px rgba(0, 0, 0, 0.7), 0 0 0 1px rgba(88, 101, 242, 0.15)",border:"1px solid rgba(88, 101, 242, 0.1)",minWidth:"320px",maxWidth:"400px",backdropFilter:"blur(12px)",animation:"slideIn 0.3s ease"},children:[e.jsxs("div",{className:"mini-drag-handle",style:{display:"flex",alignItems:"center",gap:"12px",cursor:"move",marginBottom:"12px",paddingBottom:"12px",borderBottom:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx("div",{style:{width:"10px",height:"10px",borderRadius:"50%",background:"#43b581",boxShadow:"0 0 12px #43b581",animation:"pulse 2s infinite"}}),e.jsxs("span",{style:{color:"#fff",fontSize:"14px",fontWeight:600,flex:1},children:["ðŸŽ¤ ",t]}),e.jsxs("div",{style:{background:"rgba(67, 181, 129, 0.2)",borderRadius:"12px",padding:"4px 10px",fontSize:"11px",color:"#43b581",fontWeight:600},children:["ðŸ‘¥ ",i]}),e.jsx("button",{onClick:d,style:{background:"rgba(255, 255, 255, 0.1)",border:"none",borderRadius:"8px",padding:"6px 10px",color:"#fff",cursor:"pointer",fontSize:"12px",transition:"all 0.2s"},onMouseEnter:c=>c.target.style.background="rgba(255, 255, 255, 0.2)",onMouseLeave:c=>c.target.style.background="rgba(255, 255, 255, 0.1)",children:"â¬†ï¸ AÃ§"})]}),e.jsxs("div",{style:{marginBottom:"12px",maxHeight:"120px",overflowY:"auto",display:"flex",flexDirection:"column",gap:"6px"},children:[o.slice(0,3).map(c=>e.jsxs("div",{onContextMenu:y=>{y.preventDefault(),c.username!==s?.username&&u({user:c,position:{x:y.clientX,y:y.clientY}})},onClick:y=>{c.username!==s?.username&&u({user:c,position:{x:y.clientX,y:y.clientY}})},style:{display:"flex",alignItems:"center",gap:"10px",padding:"8px",background:c.isTalking?"rgba(67, 181, 129, 0.15)":"rgba(255, 255, 255, 0.05)",borderRadius:"8px",border:c.isTalking?"1px solid rgba(67, 181, 129, 0.4)":"1px solid transparent",transition:"all 0.2s",cursor:c.username!==s?.username?"pointer":"default"},onMouseEnter:y=>{c.username!==s?.username&&(y.currentTarget.style.background="rgba(67, 181, 129, 0.2)")},onMouseLeave:y=>{y.currentTarget.style.background=c.isTalking?"rgba(67, 181, 129, 0.15)":"rgba(255, 255, 255, 0.05)"},children:[e.jsx("img",{src:a(c.username),alt:c.username,onError:y=>{y.target.onerror=null,y.target.src=pe(c.username,64)},style:{width:"32px",height:"32px",borderRadius:"50%",objectFit:"cover",border:c.isTalking?"2px solid #43b581":"2px solid rgba(255, 255, 255, 0.15)",boxShadow:c.isTalking?"0 0 10px rgba(67, 181, 129, 0.5)":"none",transition:"all 0.3s ease"}}),e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{color:"#fff",fontSize:"13px",fontWeight:600},children:[c.username," ",c.isLocal&&"(Siz)"]}),e.jsx("div",{style:{color:"rgba(255, 255, 255, 0.5)",fontSize:"11px"},children:c.isMuted?"ðŸ”‡ Sessiz":c.isTalking?"ðŸ”Š KonuÅŸuyor":"ðŸŽ¤ Aktif"})]}),c.isCameraOn&&e.jsx("span",{style:{fontSize:"14px"},children:"ðŸ“¹"}),c.isScreenSharing&&e.jsx("span",{style:{fontSize:"14px"},children:"ðŸ–¥ï¸"})]},c.username)),i>3&&e.jsxs("div",{style:{textAlign:"center",color:"rgba(255, 255, 255, 0.5)",fontSize:"11px",padding:"6px"},children:["+",i-3," daha..."]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"8px"},children:[e.jsx(de,{icon:S?"ðŸ”‡":"ðŸŽ¤",active:!S,onClick:A,title:S?"Mikrofonu AÃ§":"Mikrofonu Kapat"}),e.jsx(de,{icon:v?"ðŸ“¹":"ðŸ“·",active:v,onClick:w,title:v?"KamerayÄ± Kapat":"KamerayÄ± AÃ§"}),e.jsx(de,{icon:"ðŸ–¥ï¸",active:b,onClick:j,title:b?"PaylaÅŸÄ±mÄ± Durdur":"Ekran PaylaÅŸ"}),e.jsx(de,{icon:"âŒ",danger:!0,onClick:D,title:"AyrÄ±l"})]})]})})});Ke.displayName="MinimizedView";function gt({isInVoice:t,localAudioStream:i,isMuted:o,startStatsMonitoring:s,stopStatsMonitoring:d,screenShareQuality:u,updateScreenQuality:a}){const[S,v]=l.useState({}),[b,A]=l.useState(!1),[w,j]=l.useState("good"),[D,_]=l.useState("unknown"),[c,y]=l.useState(!0),[R,F]=l.useState(!0),[V,X]=l.useState({}),[Z,ie]=l.useState({}),[re,oe]=l.useState({}),[ve,ee]=l.useState(null);return l.useEffect(()=>{if(!t)return;const C=async()=>{const E=window.__pawscord_peer_connections__||{};for(const[k,m]of Object.entries(E))if(m&&m.getStats)try{(await m.getStats()).forEach(g=>{g.type==="candidate-pair"&&g.state==="succeeded"&&v(W=>({...W,[k]:{rtt:Math.round((g.currentRoundTripTime||0)*1e3),packetLoss:g.packetsLost&&g.packetsSent?Math.round(g.packetsLost/g.packetsSent*100*10)/10:0,quality:(g.currentRoundTripTime||0)<.1?"excellent":(g.currentRoundTripTime||0)<.2?"good":"poor"}}))})}catch{}},z=setInterval(C,3e3);return C(),()=>clearInterval(z)},[t]),l.useEffect(()=>(t&&s&&s(),()=>{d&&d()}),[t,s,d]),l.useEffect(()=>{if(!i||o||!t){A(!1);return}try{const C=window.AudioContext||window.webkitAudioContext,z=new C,E=z.createAnalyser();E.fftSize=2048,E.smoothingTimeConstant=.8;const k=z.createMediaStreamSource(i);k.connect(E);const m=new Uint8Array(E.frequencyBinCount);let T=0;const W=setInterval(()=>{E.getByteFrequencyData(m);const O=m.slice(80,160),K=Math.max(...O),Y=O.reduce((G,te)=>G+te,0)/O.length,q=m.slice(10,40),se=q.reduce((G,te)=>G+te,0)/q.length;K>180&&Y>100&&Y>se*1.5?(T++,T>3&&A(!0)):(T=0,K<120&&A(!1))},1e3);return()=>{clearInterval(W),k.disconnect(),z.close()}}catch{}},[i,o,t]),l.useEffect(()=>{if(!t)return;const C=navigator.connection||navigator.mozConnection||navigator.webkitConnection,z=()=>{if(!C){j("good"),_("unknown");return}const k=C.effectiveType||"unknown";_(k);const m=C.downlink||10,T=C.rtt||50;let g="good";k==="4g"&&m>=5&&T<100?g="excellent":k==="slow-2g"||m<1||T>300?g="poor":k==="2g"||k==="3g"||m<3||T>150?g="good":g="excellent",j(g),c&&a&&(g==="poor"&&u!=="720p"?a("720p"):g==="excellent"&&u==="720p"&&a("1080p"))};z(),C&&C.addEventListener("change",z);const E=setInterval(z,1e4);return()=>{clearInterval(E),C&&C.removeEventListener("change",z)}},[t,c,u,a]),l.useEffect(()=>{if(!R||!t)return;const z=setInterval(()=>{const E=document.querySelectorAll("audio[data-username]"),k={},m={...Z};E.forEach(T=>{const g=T.getAttribute("data-username");if(g)try{const W=new(window.AudioContext||window.webkitAudioContext),O=W.createMediaElementSource(T),K=W.createAnalyser();K.fftSize=256,O.connect(K),K.connect(W.destination);const Y=new Uint8Array(K.frequencyBinCount);K.getByteFrequencyData(Y);const q=Y.reduce((se,G)=>se+G,0)/Y.length;k[g]=q,q>0&&(q<50?m[g]=Math.min(1.5,(m[g]||1)*1.05):q>120&&(m[g]=Math.max(.7,(m[g]||1)*.95))),W.close()}catch{}}),X(k),ie(m)},2e3);return()=>clearInterval(z)},[R,t,Z]),l.useEffect(()=>{if(!t)return;const z=setInterval(()=>{const E={};let k=null,m=0;Object.entries(V).forEach(([T,g])=>{g>30?(E[T]=!0,g>m&&(m=g,k=T)):E[T]=!1}),oe(E),k&&m>50?ee(k):m===0&&ee(null)},100);return()=>clearInterval(z)},[t,V]),{connectionQuality:S,setConnectionQuality:v,hasEchoRisk:b,setHasEchoRisk:A,networkQuality:w,setNetworkQuality:j,networkType:D,setNetworkType:_,autoQualityEnabled:c,setAutoQualityEnabled:y,volumeNormalization:R,setVolumeNormalization:F,userAudioLevels:V,setUserAudioLevels:X,normalizedGains:Z,setNormalizedGains:ie,talkingIndicators:re,setTalkingIndicators:oe,activeSpeaker:ve,setActiveSpeaker:ee}}function ft(){if(typeof document>"u"||document.head.querySelector("style#voice-fullscreen-styles"))return;const t=document.createElement("style");t.id="voice-fullscreen-styles",t.textContent=`
            /* Tam Ekran Video Stilleri */
            div:fullscreen video,
            div:-webkit-full-screen video,
            div:-moz-full-screen video,
            div:-ms-fullscreen video {
                width: 100% !important;
                height: 100% !important;
                object-fit: contain !important;
                background: #000 !important;
            }

            /* Tam Ekran Container */
            div:fullscreen,
            div:-webkit-full-screen,
            div:-moz-full-screen,
            div:-ms-fullscreen {
                background: #000 !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
            }

            /* Tam Ekran Kontrolleri */
            div:fullscreen .hover-actions,
            div:-webkit-full-screen .hover-actions,
            div:-moz-full-screen .hover-actions,
            div:-ms-fullscreen .hover-actions {
                opacity: 1 !important;
                z-index: 9999 !important;
            }

            /* ðŸ”¥ YENÄ°: Badge AnimasyonlarÄ± */
            @keyframes badgePulse {
                0%, 100% {
                    transform: scale(1);
                    box-shadow: 0 4px 16px rgba(88, 101, 242, 0.6), 0 0 0 2px rgba(255, 255, 255, 0.2);
                }
                50% {
                    transform: scale(1.05);
                    box-shadow: 0 6px 20px rgba(88, 101, 242, 0.9), 0 0 0 3px rgba(255, 255, 255, 0.4);
                }
            }

            @keyframes pulse {
                0%, 100% {
                    opacity: 1;
                    transform: scale(1);
                }
                50% {
                    opacity: 0.7;
                    transform: scale(1.2);
                }
            }

            /* ðŸ”¥ YENÄ°: Talking Indicator Wave Animations */
            @keyframes wave1 {
                0%, 100% { height: 12px; }
                50% { height: 20px; }
            }
            @keyframes wave2 {
                0%, 100% { height: 16px; }
                50% { height: 24px; }
            }
            @keyframes wave3 {
                0%, 100% { height: 12px; }
                50% { height: 20px; }
            }

            /* ðŸ”¥ YENÄ°: Avatar Talking Pulse Animation */
            @keyframes talkingPulse {
                0%, 100% {
                    box-shadow: 0 0 0 0 rgba(67, 181, 129, 0.7);
                    transform: scale(1);
                }
                50% {
                    box-shadow: 0 0 0 15px rgba(67, 181, 129, 0);
                    transform: scale(1.02);
                }
            }

            @keyframes slideIn {
                from { opacity: 0; transform: translateY(10px) scale(0.95); }
                to { opacity: 1; transform: translateY(0) scale(1); }
            }
            @keyframes fadeIn {
                from { opacity: 0; }
                to { opacity: 1; }
            }
            @keyframes connectionGlow {
                0%, 100% { box-shadow: 0 0 12px rgba(67, 181, 129, 0.3); }
                50% { box-shadow: 0 0 20px rgba(67, 181, 129, 0.6); }
            }
            @keyframes screenShareGlow {
                0%, 100% { border-color: rgba(88, 101, 242, 0.5); }
                50% { border-color: rgba(88, 101, 242, 0.9); }
            }

            /* Smooth grid transitions */
            .voice-grid-item {
                animation: slideIn 0.3s ease forwards;
            }
            /* Video card hover effects */
            .voice-video-card:hover {
                transform: scale(1.01);
                z-index: 10;
            }
            /* Active speaker highlight */
            .voice-active-speaker {
                animation: connectionGlow 2s ease-in-out infinite;
            }
            /* Screen share border animation */
            .voice-screen-share {
                animation: screenShareGlow 2s ease-in-out infinite;
            }
    `,document.head.appendChild(t)}ft();const mt=t=>t?t.replace(/_100x100\./gi,".").replace(/_150x150\./gi,".").replace(/_50x50\./gi,".").replace(/\?.*$/,""):null,ht=({roomName:t,onClose:i,isMinimized:o,onToggleMinimize:s,getRealUserAvatar:d,allUsers:u=[],currentUserProfile:a})=>{const{isInVoice:S,isMuted:v,isDeafened:b,isVideoEnabled:A,isScreenSharing:w,isSpatialAudioEnabled:j,vadSensitivity:D,isNoiseSuppressionEnabled:_,screenShareQuality:c,screenShareFPS:y,isRecording:R,recordingDuration:F,isPTTMode:V,isPTTActive:X,pttKey:Z,includeSystemAudio:ie,connectedUsers:re=[],isReconnecting:oe=!1,connectionStats:ve={},startStatsMonitoring:ee,stopStatsMonitoring:C,toggleMute:z,toggleDeafened:E,toggleCamera:k,toggleScreenShare:m,toggleSpatialAudio:T,updateVadSensitivity:g,toggleNoiseSuppression:W,updateScreenQuality:O,updateScreenFPS:K,toggleSystemAudio:Y,togglePTTMode:q,updatePTTKey:se,startRecording:G,stopRecording:te,downloadRecording:bt,leaveVoiceRoom:ke,localAudioStream:Ne,remoteStreams:Se={},remoteVolumes:we={},setRemoteVolume:je,localCameraStream:xe,localScreenStream:ue,isTalking:Ce=!1}=tt(),ne=A,{user:I}=nt(),P=Q.useMemo(()=>{const n=[...re];if(I&&!n.some(x=>x.username===I.username))n.push({username:I.username,isMuted:v,isCameraOn:ne,isScreenSharing:w,isTalking:Ce,isLocal:!0});else if(I){const x=n.findIndex(h=>h.username===I.username);x>=0&&(n[x]={...n[x],isMuted:v,isCameraOn:ne,isScreenSharing:w,isTalking:Ce,isLocal:!0})}return n},[re,I,v,ne,w]),ae=l.useCallback(n=>{let x=null;if(a&&n===I?.username&&a.avatar&&typeof a.avatar=="string"&&(a.avatar.startsWith("http")||a.avatar.startsWith("blob:")?x=a.avatar:x=`${De}${a.avatar.startsWith("/")?"":"/"}${a.avatar}`),!x&&d&&(x=d(n)),!x){const h=u.find(r=>r.username===n);h?.avatar&&typeof h.avatar=="string"&&(h.avatar.startsWith("http")||h.avatar.startsWith("blob:")?x=h.avatar:x=`${De}${h.avatar.startsWith("/")?"":"/"}${h.avatar}`)}return x?mt(x):pe(n,256)},[a,I,d,u]),M=Q.useMemo(()=>{const n={...Se};return I?.username&&(xe&&(n[`${I.username}_camera`]=xe),ue&&(n[`${I.username}_screen`]=ue)),n},[Se,I,xe,ue]),[N,le]=l.useState(null),[ce,Te]=l.useState(null),[Fe,ze]=l.useState(!1),[ge,H]=l.useState(null),[Ee,Re]=l.useState(()=>{try{const n=localStorage.getItem("pawscord_voice_volumes");return n?JSON.parse(n):{}}catch{return{}}}),[qe,Be]=l.useState(!0),{connectionQuality:fe,hasEchoRisk:Ve,networkQuality:Ae,networkType:Ie,talkingIndicators:Oe,activeSpeaker:$}=gt({isInVoice:S,localAudioStream:Ne,isMuted:v,startStatsMonitoring:ee,stopStatsMonitoring:C,screenShareQuality:c,updateScreenQuality:O});l.useEffect(()=>{const n=()=>{ze(!0)};return window.addEventListener("openVoiceSettings",n),()=>window.removeEventListener("openVoiceSettings",n)},[]),l.useEffect(()=>{try{localStorage.setItem("pawscord_voice_volumes",JSON.stringify(Ee))}catch{}},[Ee]);const{isMobile:Me}=at(),_e=N?"fullscreen":o?"minimized":Me?"mobile":"grid";l.useEffect(()=>{S||i()},[S,i]);const Ye=n=>Me?{cols:1,rows:n}:n<=1?{cols:1,rows:1}:n<=4?{cols:2,rows:2}:n<=6?{cols:3,rows:2}:n<=9?{cols:3,rows:3}:{cols:4,rows:Math.ceil(n/4)},Ge=Q.useMemo(()=>{let n=P.length;return P.forEach(x=>{const h=x.username;M[`${h}_screen`]&&x.isScreenSharing&&n++}),n},[P,M]),$e=P.length,{cols:Le,rows:We}=Ye(Ge),He=l.useCallback(async n=>{window.location.hash=`#/dm/${n.username}`},[]),Ue=l.useCallback(async n=>{try{(await fetch("/api/friends/send_request/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("access_token")}`},body:JSON.stringify({username:n.username})})).ok?J.success(`Ã¢Å“â€¦ ${n.username} kullanÃ„Â±cÃ„Â±sÃ„Â±na arkadaÃ…Å¸lÃ„Â±k isteÃ„Å¸i gÃƒÂ¶nderildi!`):J.error("Ã¢ÂÅ’ ArkadaÃ…Å¸lÃ„Â±k isteÃ„Å¸i gÃƒÂ¶nderilemedi")}catch{J.error("Ã¢ÂÅ’ Bir hata oluÃ…Å¸tu")}},[]),Xe=l.useCallback(async n=>{try{(await fetch("/api/users/block/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("access_token")}`},body:JSON.stringify({username:n.username})})).ok?J.success(`Ã¢Å“â€¦ ${n.username} engellendi!`):J.error("Ã¢ÂÅ’ Engelleme iÃ…Å¸lemi baÃ…Å¸arÃ„Â±sÃ„Â±z")}catch{J.error("Ã¢ÂÅ’ Bir hata oluÃ…Å¸tu")}},[]),Je=l.useCallback(n=>{H(null),window.openUserProfile?window.openUserProfile(n.username):window.location.hash=`#/profile/${n.username}`},[]),Qe=l.useCallback(n=>{Re(x=>({...x,[n.username]:{...x[n.username],isMuted:!x[n.username]?.isMuted}}))},[]),Ze=l.useCallback((n,x)=>{const h=Math.max(0,Math.min(200,x));Re(p=>({...p,[n.username]:{...p[n.username],volume:h}})),document.querySelectorAll(`audio[data-username="${n.username}"]`).forEach(p=>{if(h<=100){if(p.volume=h/100,p._gainNode)try{p._gainNode.gain.value=1}catch{}}else{p.volume=1;try{p._audioContext||(p._audioContext=new(window.AudioContext||window.webkitAudioContext),p._sourceNode=p._audioContext.createMediaElementSource(p),p._gainNode=p._audioContext.createGain(),p._sourceNode.connect(p._gainNode),p._gainNode.connect(p._audioContext.destination)),p._gainNode.gain.value=h/100}catch{}}})},[]),et=()=>{const n=[];return R&&n.push(e.jsxs("span",{style:{background:"rgba(237,66,69,0.2)",color:"#ed4245",border:"1px solid rgba(237,66,69,0.4)",padding:"4px 8px",borderRadius:"10px",fontSize:"12px",display:"inline-flex",alignItems:"center",gap:"6px"},children:["Ã¢ÂÂºÃ¯Â¸Â KayÃ„Â±tta (",Math.floor(F/60).toString().padStart(2,"0"),":",Math.floor(F%60).toString().padStart(2,"0"),")"]},"rec")),w&&n.push(e.jsxs("span",{style:{background:"rgba(88,101,242,0.15)",color:"#8893ff",border:"1px solid rgba(88,101,242,0.35)",padding:"4px 8px",borderRadius:"10px",fontSize:"12px",display:"inline-flex",alignItems:"center",gap:"6px"},children:["Ã°Å¸â€“Â¥Ã¯Â¸Â PaylaÃ…Å¸Ã„Â±lÃ„Â±yor ",c," Ã¢â‚¬Â¢ ",y,"fps",ie?" Ã¢â‚¬Â¢ Ã°Å¸â€Å  Sistem":""]},"ss")),V&&n.push(e.jsxs("span",{style:{background:"rgba(250,166,26,0.18)",color:"#faa61a",border:"1px solid rgba(250,166,26,0.35)",padding:"4px 8px",borderRadius:"10px",fontSize:"12px",display:"inline-flex",alignItems:"center",gap:"6px"},children:["Ã°Å¸Å½â„¢Ã¯Â¸Â PTT (",Z,") ",X?"Ã¢â‚¬Â¢ Aktif":""]},"ptt")),oe&&n.push(e.jsx("span",{style:{background:"rgba(255,255,255,0.08)",color:"#fff",border:"1px solid rgba(255,255,255,0.2)",padding:"4px 8px",borderRadius:"10px",fontSize:"12px",display:"inline-flex",alignItems:"center",gap:"6px"},children:"Ã°Å¸â€â€ž Yeniden baÃ„Å¸lanÃ„Â±yor"},"reconnect")),n.length?e.jsx("div",{style:{display:"flex",gap:"8px",alignItems:"center",flexWrap:"wrap"},children:n}):null},me=n=>n.streamType==="screen"?e.jsxs("div",{style:{position:"absolute",top:"12px",left:"12px",background:"linear-gradient(135deg, #5865f2 0%, #7289da 100%)",color:"#fff",padding:"8px 16px",borderRadius:"12px",fontSize:"13px",fontWeight:700,boxShadow:"0 4px 16px rgba(88, 101, 242, 0.6), 0 0 0 2px rgba(255, 255, 255, 0.2)",zIndex:100,display:"flex",alignItems:"center",gap:"8px",animation:"badgePulse 2s infinite"},children:["Ã°Å¸â€“Â¥Ã¯Â¸Â ",e.jsxs("span",{style:{textShadow:"0 2px 4px rgba(0, 0, 0, 0.5)"},children:[n.username," - Ekran PaylaÃ…Å¸Ã„Â±yor"]})]}):n.streamType==="camera"?e.jsx("div",{style:{position:"absolute",top:"12px",left:"12px",background:"rgba(67, 181, 129, 0.85)",color:"#fff",padding:"6px 12px",borderRadius:"8px",fontSize:"11px",fontWeight:600,boxShadow:"0 2px 8px rgba(0, 0, 0, 0.3)",zIndex:100,display:"flex",alignItems:"center",gap:"6px"},children:"Ã°Å¸â€œÂ¹ Kamera"}):null;if(_e==="minimized")return e.jsx(Ke,{roomName:t,userCount:$e,combinedUsers:P,currentUser:I,onToggleMinimize:s,onContextMenu:n=>H(n),getUserAvatar:ae,isMuted:v,isCameraOn:ne,isScreenSharing:w,toggleMute:z,toggleCamera:k,toggleScreenShare:m,leaveVoice:ke});if(_e==="fullscreen"&&N){const n=N.streamType==="screen"?`${N.username}_screen`:`${N.username}_camera`,x=M[n]||M[N.username];return e.jsxs("div",{style:{width:"100%",height:"100%",background:"#000",display:"flex",flexDirection:"column",overflow:"hidden"},children:[e.jsxs("div",{style:{background:"rgba(0, 0, 0, 0.8)",padding:"16px 24px",display:"flex",alignItems:"center",gap:"16px"},children:[e.jsx("button",{onClick:()=>le(null),style:{background:"rgba(255, 255, 255, 0.1)",border:"none",borderRadius:"8px",padding:"8px 16px",color:"#fff",cursor:"pointer",fontSize:"14px"},children:"Ã¢Â¬â€¦Ã¯Â¸Â Geri"}),e.jsxs("h3",{style:{color:"#fff",margin:0,flex:1},children:["Ã°Å¸â€˜Â¤ ",N.username," ",N.streamType==="screen"&&"Ã°Å¸â€“Â¥Ã¯Â¸Â Ekran PaylaÃ…Å¸Ã„Â±mÃ„Â±"]})]}),e.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",background:"#1a1a1a"},children:e.jsx(ut,{user:N,stream:x,fullscreen:!0})}),e.jsx(xt,{isMuted:v,isDeafened:b,isCameraOn:ne,isScreenSharing:w,isSpatialAudio:j,isRecording:R,recordingDuration:F,onToggleMute:z,onToggleDeafened:E,onToggleCamera:k,onToggleScreenShare:m,onToggleSpatialAudio:T,onStartRecording:G,onStopRecording:te,onLeave:ke})]})}return e.jsxs("div",{style:{width:"100%",height:"100%",background:"linear-gradient(135deg, #1e1e1e 0%, #2c2c2c 100%)",display:"flex",flexDirection:"column",overflow:"hidden"},children:[e.jsxs("div",{style:{background:"rgba(0, 0, 0, 0.3)",padding:"16px 24px",display:"flex",alignItems:"center",gap:"16px",borderBottom:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx("div",{style:{width:"10px",height:"10px",borderRadius:"50%",background:"#43b581",boxShadow:"0 0 12px #43b581",animation:"pulse 2s infinite"}}),e.jsxs("h2",{style:{color:"#fff",margin:0,fontSize:"17px",fontWeight:700,flex:1,display:"flex",alignItems:"center",gap:"12px",letterSpacing:"0.3px"},children:["Ã°Å¸Å½â„¢Ã¯Â¸Â ",t,et(),Ae==="poor"&&e.jsx("div",{style:{background:"rgba(240, 71, 71, 0.2)",border:"1px solid #f04747",borderRadius:"6px",padding:"4px 8px",fontSize:"12px",color:"#f04747",fontWeight:"600",display:"flex",alignItems:"center",gap:"4px"},children:"Ã¢Å¡Â Ã¯Â¸Â ZayÃ„Â±f BaÃ„Å¸lantÃ„Â±"}),Ae==="excellent"&&Ie!=="unknown"&&e.jsxs("div",{style:{background:"rgba(67, 181, 129, 0.2)",border:"1px solid #43b581",borderRadius:"6px",padding:"4px 8px",fontSize:"12px",color:"#43b581",fontWeight:"600",display:"flex",alignItems:"center",gap:"4px"},children:["Ã°Å¸â€œÂ¶ ",Ie.toUpperCase()]})]}),e.jsxs("div",{style:{color:"rgba(255, 255, 255, 0.7)",fontSize:"14px"},children:["Ã°Å¸â€˜Â¥ ",$e," kiÃ…Å¸i"]}),e.jsx("button",{onClick:s,style:{background:"rgba(255, 255, 255, 0.1)",border:"none",borderRadius:"8px",padding:"8px 16px",color:"#fff",cursor:"pointer",fontSize:"13px"},children:"Ã¢Â¬â€¡Ã¯Â¸Â KÃƒÂ¼ÃƒÂ§ÃƒÂ¼lt"})]}),e.jsx("div",{style:{flex:1,padding:"20px",display:"flex",flexDirection:"column",overflow:"auto",position:"relative",minHeight:0},children:(()=>{const n=P.filter(h=>h.isScreenSharing&&M[`${h.username}_screen`]);if(n.length>0){const h=[];n.forEach(f=>{const U=M[`${f.username}_screen`];U&&h.push({key:`${f.username}_screen`,username:f.username,type:"screen",component:e.jsx(ye,{user:{...f,streamType:"screen"},stream:U,isActive:!1,isPinned:!1,onExpand:()=>le({...f,streamType:"screen"}),onPin:()=>{},onContextMenu:Pe=>H(Pe),badge:me({...f,streamType:"screen"}),connectionQuality:fe[f.username],getUserAvatar:ae},`${f.username}_screen`)})}),P.forEach(f=>{const U=M[`${f.username}_camera`]||M[f.username];(U&&U.active||f.isLocal)&&h.push({key:`${f.username}_camera`,username:f.username,type:"camera",component:e.jsx(ye,{user:{...f,streamType:"camera",volume:we[f.username]||100,onVolumeChange:he=>je(f.username,he),isTalking:Oe[f.username]||!1},stream:U,isActive:$===f.username,isPinned:ce===f.username,onExpand:()=>le({...f,streamType:"camera"}),onPin:()=>Te(ce===f.username?null:f.username),onContextMenu:he=>H(he),badge:me(f),connectionQuality:fe[f.username],getUserAvatar:ae},`${f.username}_camera`)})});const r=h.length;let p,L;return r<=2?(p=r,L=1):r<=4?(p=2,L=2):r<=6?(p=3,L=2):(p=3,L=Math.ceil(r/3)),e.jsx("div",{style:{width:"100%",height:"100%",display:"grid",gridTemplateColumns:`repeat(${p}, 1fr)`,gridTemplateRows:`repeat(${L}, 1fr)`,gap:"16px",padding:"0",position:"relative"},children:h.map((f,U)=>e.jsx("div",{style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",zIndex:1,isolation:"isolate"},children:f.component},f.key))})}else return P.some(r=>{const p=M[`${r.username}_camera`]||M[r.username];return p&&p.active})?e.jsx("div",{style:{flex:1,display:"grid",gridTemplateColumns:`repeat(${Le}, 1fr)`,gridTemplateRows:`repeat(${We}, 1fr)`,gap:"16px",minHeight:"400px",height:"100%"},children:P.map(r=>{const p=M[`${r.username}_camera`]||(r.isLocal?null:M[r.username]);return e.jsx(ye,{user:{...r,streamType:"camera",volume:we[r.username]||100,onVolumeChange:L=>je(r.username,L)},stream:p,isActive:$===r.username,isPinned:ce===r.username,onExpand:()=>le({...r,streamType:"camera"}),onPin:()=>Te(ce===r.username?null:r.username),onContextMenu:L=>H(L),badge:me({...r,streamType:"camera"}),connectionQuality:fe[r.username],getUserAvatar:ae},`${r.username}_camera`)})}):e.jsx("div",{style:{flex:1,display:"grid",gridTemplateColumns:`repeat(${Math.min(Le,3)}, 1fr)`,gridTemplateRows:`repeat(${We}, 1fr)`,gap:"24px",padding:"40px",alignItems:"center",justifyContent:"center"},children:P.map(r=>e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"12px",padding:"32px",borderRadius:"16px",background:$===r.username?"linear-gradient(135deg, rgba(88, 101, 242, 0.25) 0%, rgba(114, 137, 218, 0.15) 100%)":"rgba(47, 49, 54, 0.5)",border:$===r.username?"2px solid rgba(88, 101, 242, 0.9)":"2px solid rgba(79, 84, 92, 0.3)",boxShadow:$===r.username?"0 8px 32px rgba(88, 101, 242, 0.4), 0 0 20px rgba(88, 101, 242, 0.3)":"0 4px 12px rgba(0, 0, 0, 0.2)",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",cursor:"pointer",position:"relative",transform:$===r.username?"scale(1.05)":"scale(1)",animation:"slideIn 0.4s ease forwards"},onClick:()=>H({user:r,position:{x:window.innerWidth/2,y:window.innerHeight/2}}),children:[e.jsx("div",{style:{width:"140px",height:"140px",borderRadius:"50%",overflow:"hidden",border:`5px solid ${$===r.username?"#5865f2":"#40444b"}`,boxShadow:$===r.username?"0 8px 24px rgba(88, 101, 242, 0.6), inset 0 0 20px rgba(88, 101, 242, 0.2)":"0 4px 12px rgba(0, 0, 0, 0.4)",animation:$===r.username?"pulse 1.5s infinite":"none",position:"relative"},children:e.jsx("img",{src:ae(r.username),alt:r.username,onError:p=>{p.target.onerror=null,p.target.src=pe(r.username,256)},style:{width:"100%",height:"100%",objectFit:"cover",filter:$===r.username?"brightness(1.1)":"brightness(0.95)"}})}),e.jsx("div",{style:{fontSize:"20px",fontWeight:"700",color:$===r.username?"#dee0fc":"#fff",textAlign:"center",textShadow:"0 2px 8px rgba(0, 0, 0, 0.7)",letterSpacing:"0.3px"},children:r.username}),e.jsxs("div",{style:{display:"flex",gap:"12px",fontSize:"22px",marginTop:"4px"},children:[r.isMuted&&e.jsx("span",{title:"Mikrofon KapalÃ„Â±",style:{filter:"drop-shadow(0 2px 4px rgba(0, 0, 0, 0.5))"},children:"Ã°Å¸â€â€¡"}),r.isDeafened&&e.jsx("span",{title:"KulaklÃ„Â±k KapalÃ„Â±",style:{filter:"drop-shadow(0 2px 4px rgba(0, 0, 0, 0.5))"},children:"Ã°Å¸â€Ë†"})]})]},r.username))})})()}),Ve&&qe&&e.jsxs("div",{style:{position:"absolute",bottom:"100px",left:"50%",transform:"translateX(-50%)",background:"linear-gradient(135deg, rgba(250, 166, 26, 0.95) 0%, rgba(237, 66, 69, 0.95) 100%)",color:"#fff",padding:"16px 24px",borderRadius:"12px",zIndex:1e3,display:"flex",alignItems:"center",gap:"12px",boxShadow:"0 8px 32px rgba(250, 166, 26, 0.6)",animation:"pulse 2s infinite",maxWidth:"90%"},children:[e.jsx("div",{style:{fontSize:"24px",animation:"pulse 1.5s infinite"},children:"Ã¢Å¡Â Ã¯Â¸Â"}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:"4px",fontSize:"15px"},children:"Echo Tespit Edildi!"}),e.jsx("div",{style:{fontSize:"13px",opacity:.9},children:"KulaklÃ„Â±k kullanmanÃ„Â±z ÃƒÂ¶nerilir. HoparlÃƒÂ¶r kullanÃ„Â±mÃ„Â± echo'ya neden olur."})]}),e.jsx("button",{onClick:()=>Be(!1),style:{background:"rgba(255, 255, 255, 0.2)",border:"none",borderRadius:"6px",color:"#fff",padding:"6px 12px",cursor:"pointer",fontSize:"12px",fontWeight:"bold"},children:"Kapat"})]}),Fe&&e.jsx(rt,{onClose:()=>ze(!1),channelId:t}),ge&&e.jsx(it,{user:ge.user,position:ge.position,onClose:()=>H(null),onSendMessage:He,onAddFriend:Ue,onBlock:Xe,onViewProfile:Je,onMuteUser:Qe,onAdjustVolume:Ze,currentUser:I,isInVoiceChat:!0})]})},At=Q.memo(ht);export{At as default};
