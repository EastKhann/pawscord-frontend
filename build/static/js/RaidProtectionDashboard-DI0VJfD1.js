import{r as d,j as e}from"./react-core-D6cE4lil.js";import{a5 as $,bh as B,j as H,b2 as L,as as T,d as K,a4 as O,E as R,b3 as P,a as V,S as E,ak as S,b5 as C,u as I}from"./icons-vendor-DT2gd7vx.js";import{t as y}from"./index-ClHcoIda.js";import"./media-vendor-Du00QUHb.js";import"./router-vendor-wrB4dqw3.js";import"./state-vendor-DnurjGY_.js";import"./crypto-vendor-BYnay7oC.js";import"./ui-vendor-CZOhtEfS.js";const M=s=>{switch(s){case"join":return"ğŸ‘‹";case"leave":return"ğŸšª";case"kick":return"ğŸ‘¢";case"ban":return"ğŸ”¨";case"suspicious":return"âš ï¸";case"raid_detected":return"ğŸš¨";case"verified":return"âœ…";default:return"ğŸ“‹"}},J=s=>{switch(s){case"join":return"#23a559";case"leave":return"#f0b132";case"kick":case"ban":return"#da373c";case"suspicious":case"raid_detected":return"#f0b132";case"verified":return"#5865f2";default:return"#72767d"}},Y=s=>new Date(s).toLocaleTimeString("tr-TR",{hour:"2-digit",minute:"2-digit"}),q=(s,i)=>{const[m,a]=d.useState("overview"),[l,r]=d.useState({enabled:!1,lockdown_active:!1}),[h,j]=d.useState([]),[x,p]=d.useState([]),[N,_]=d.useState([]),[g,k]=d.useState({join_rate_limit:10,join_time_window:60,mention_limit:10,message_rate_limit:15,new_account_threshold:7,auto_ban_suspicious:!1,captcha_on_join:!1,dm_on_join_warning:!0}),[f,u]=d.useState(!0),[b,t]=d.useState({blocked_today:0,verified_today:0,raids_detected:0,suspicious_accounts:0}),v=d.useRef(null),w=async()=>{try{const n=localStorage.getItem("access_token"),c=await fetch(`${i}/moderation/raid-protection/status/?server_id=${s}`,{headers:{Authorization:`Bearer ${n}`}});if(c.ok){const o=await c.json();r(o.status||o),o.settings&&k(o.settings),o.stats&&t(o.stats)}}catch{}},A=async()=>{try{const n=localStorage.getItem("access_token"),c=await fetch(`${i}/moderation/raid-protection/activity/?server_id=${s}`,{headers:{Authorization:`Bearer ${n}`}});if(c.ok){const o=await c.json();j(o.activities||[])}}catch{}},F=async()=>{try{const n=localStorage.getItem("access_token"),c=await fetch(`${i}/moderation/raid-protection/pending/?server_id=${s}`,{headers:{Authorization:`Bearer ${n}`}});if(c.ok){const o=await c.json();p(o.pending||[])}}catch{}},D=async()=>{try{const n=localStorage.getItem("access_token"),c=await fetch(`${i}/moderation/raid-protection/logs/?server_id=${s}`,{headers:{Authorization:`Bearer ${n}`}});if(c.ok){const o=await c.json();_(o.logs||[])}}catch{}};return d.useEffect(()=>{(async()=>(u(!0),await Promise.all([w(),A(),F(),D()]),u(!1)))();const c=setInterval(A,5e3);return()=>clearInterval(c)},[s]),{view:m,setView:a,protectionStatus:l,recentActivity:h,pendingVerifications:x,raidLogs:N,settings:g,setSettings:k,loading:f,stats:b,activityRef:v,handleToggleProtection:async()=>{try{const n=localStorage.getItem("access_token");(await fetch(`${i}/moderation/raid-protection/toggle/`,{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify({server_id:s,enabled:!l.enabled})})).ok&&(r({...l,enabled:!l.enabled}),y.success(l.enabled?"âš ï¸ Koruma kapatÄ±ldÄ±":"ğŸ›¡ï¸ Koruma aktif!"))}catch{}},handleLockdown:async()=>{try{const n=localStorage.getItem("access_token"),c=l.lockdown_active?"unlock":"lockdown";(await fetch(`${i}/moderation/raid-protection/${c}/`,{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify({server_id:s})})).ok&&(r({...l,lockdown_active:!l.lockdown_active}),y.success(l.lockdown_active?"ğŸ”“ Sunucu kilidi aÃ§Ä±ldÄ±":"ğŸ”’ Sunucu kilitlendi!"))}catch{}},handleVerifyUser:async(n,c)=>{try{const o=localStorage.getItem("access_token");(await fetch(`${i}/moderation/raid-protection/verify/`,{method:"POST",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"},body:JSON.stringify({server_id:s,user_id:n,action:c})})).ok&&(p(x.filter(z=>z.id!==n)),y.success(c==="approve"?"âœ… KullanÄ±cÄ± onaylandÄ±":"âŒ KullanÄ±cÄ± reddedildi"))}catch{}},handleSaveSettings:async()=>{try{const n=localStorage.getItem("access_token");(await fetch(`${i}/moderation/raid-protection/settings/`,{method:"PUT",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify({server_id:s,...g})})).ok&&y.success("âœ… Ayarlar kaydedildi!")}catch{}}}},G=({protectionStatus:s,stats:i,recentActivity:m,activityRef:a,handleToggleProtection:l,handleLockdown:r})=>e.jsxs("div",{className:"overview-view",children:[e.jsxs("div",{className:"quick-actions",children:[e.jsxs("button",{className:`action-btn ${s.enabled?"enabled":""}`,onClick:l,children:[e.jsx($,{}),s.enabled?"KorumayÄ± Kapat":"KorumayÄ± AÃ§"]}),e.jsxs("button",{className:`action-btn lockdown ${s.lockdown_active?"active":""}`,onClick:r,children:[s.lockdown_active?e.jsx(B,{}):e.jsx(H,{}),s.lockdown_active?"Kilidi AÃ§":"Sunucuyu Kilitle"]})]}),e.jsxs("div",{className:"stats-grid",children:[e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon blocked",children:e.jsx(L,{})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("span",{className:"stat-value",children:i.blocked_today}),e.jsx("span",{className:"stat-label",children:"BugÃ¼n Engellenen"})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon verified",children:e.jsx(T,{})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("span",{className:"stat-value",children:i.verified_today}),e.jsx("span",{className:"stat-label",children:"BugÃ¼n DoÄŸrulanan"})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon raids",children:e.jsx(K,{})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("span",{className:"stat-value",children:i.raids_detected}),e.jsx("span",{className:"stat-label",children:"Tespit Edilen Raid"})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon suspicious",children:e.jsx(O,{})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("span",{className:"stat-value",children:i.suspicious_accounts}),e.jsx("span",{className:"stat-label",children:"ÅÃ¼pheli Hesap"})]})]})]}),e.jsxs("div",{className:"activity-section",children:[e.jsxs("h3",{children:[e.jsx(R,{})," CanlÄ± Aktivite"]}),e.jsx("div",{className:"activity-feed",ref:a,children:m.length>0?m.map((h,j)=>e.jsxs("div",{className:"activity-item",style:{borderLeftColor:J(h.type)},children:[e.jsx("span",{className:"activity-icon",children:M(h.type)}),e.jsxs("div",{className:"activity-info",children:[e.jsx("span",{className:"activity-user",children:h.username}),e.jsx("span",{className:"activity-action",children:h.description})]}),e.jsx("span",{className:"activity-time",children:Y(h.timestamp)})]},j)):e.jsx("div",{className:"no-activity",children:e.jsx("p",{children:"HenÃ¼z aktivite yok"})})})]})]}),U=({settings:s,setSettings:i,handleSaveSettings:m})=>e.jsxs("div",{className:"settings-view",children:[e.jsxs("h3",{children:[e.jsx(P,{})," Koruma AyarlarÄ±"]}),e.jsxs("div",{className:"settings-section",children:[e.jsx("h4",{children:"KatÄ±lÄ±m Limitleri"}),e.jsxs("div",{className:"setting-item",children:[e.jsxs("div",{className:"setting-info",children:[e.jsx("label",{children:"KatÄ±lÄ±m HÄ±z Limiti"}),e.jsx("p",{children:"Belirli sÃ¼re iÃ§inde maksimum katÄ±lÄ±m sayÄ±sÄ±"})]}),e.jsxs("div",{className:"setting-control",children:[e.jsx("input",{type:"number",value:s.join_rate_limit,onChange:a=>i({...s,join_rate_limit:parseInt(a.target.value)}),min:"1",max:"100"}),e.jsx("span",{children:"kiÅŸi /"}),e.jsx("input",{type:"number",value:s.join_time_window,onChange:a=>i({...s,join_time_window:parseInt(a.target.value)}),min:"10",max:"300"}),e.jsx("span",{children:"saniye"})]})]}),e.jsxs("div",{className:"setting-item",children:[e.jsxs("div",{className:"setting-info",children:[e.jsx("label",{children:"Yeni Hesap EÅŸiÄŸi"}),e.jsx("p",{children:"Bu gÃ¼nden eski hesaplar ÅŸÃ¼pheli sayÄ±lÄ±r"})]}),e.jsxs("div",{className:"setting-control",children:[e.jsx("input",{type:"number",value:s.new_account_threshold,onChange:a=>i({...s,new_account_threshold:parseInt(a.target.value)}),min:"1",max:"30"}),e.jsx("span",{children:"gÃ¼n"})]})]})]}),e.jsxs("div",{className:"settings-section",children:[e.jsx("h4",{children:"Mesaj Limitleri"}),e.jsxs("div",{className:"setting-item",children:[e.jsxs("div",{className:"setting-info",children:[e.jsx("label",{children:"Mention Limiti"}),e.jsx("p",{children:"Bir mesajdaki maksimum mention sayÄ±sÄ±"})]}),e.jsx("div",{className:"setting-control",children:e.jsx("input",{type:"number",value:s.mention_limit,onChange:a=>i({...s,mention_limit:parseInt(a.target.value)}),min:"1",max:"50"})})]}),e.jsxs("div",{className:"setting-item",children:[e.jsxs("div",{className:"setting-info",children:[e.jsx("label",{children:"Mesaj HÄ±z Limiti"}),e.jsx("p",{children:"10 saniyede maksimum mesaj sayÄ±sÄ±"})]}),e.jsx("div",{className:"setting-control",children:e.jsx("input",{type:"number",value:s.message_rate_limit,onChange:a=>i({...s,message_rate_limit:parseInt(a.target.value)}),min:"1",max:"50"})})]})]}),e.jsxs("div",{className:"settings-section",children:[e.jsx("h4",{children:"Otomatik Aksiyonlar"}),e.jsxs("div",{className:"setting-item toggle",children:[e.jsxs("div",{className:"setting-info",children:[e.jsx("label",{children:"ÅÃ¼pheli HesaplarÄ± Otomatik Banla"}),e.jsx("p",{children:"Raid tespit edildiÄŸinde ÅŸÃ¼pheli hesaplarÄ± otomatik banla"})]}),e.jsxs("label",{className:"toggle-switch",children:[e.jsx("input",{type:"checkbox",checked:s.auto_ban_suspicious,onChange:a=>i({...s,auto_ban_suspicious:a.target.checked})}),e.jsx("span",{className:"slider"})]})]}),e.jsxs("div",{className:"setting-item toggle",children:[e.jsxs("div",{className:"setting-info",children:[e.jsx("label",{children:"KatÄ±lÄ±mda CAPTCHA"}),e.jsx("p",{children:"Yeni Ã¼yeler katÄ±lÄ±rken CAPTCHA doÄŸrulamasÄ± iste"})]}),e.jsxs("label",{className:"toggle-switch",children:[e.jsx("input",{type:"checkbox",checked:s.captcha_on_join,onChange:a=>i({...s,captcha_on_join:a.target.checked})}),e.jsx("span",{className:"slider"})]})]}),e.jsxs("div",{className:"setting-item toggle",children:[e.jsxs("div",{className:"setting-info",children:[e.jsx("label",{children:"KatÄ±lÄ±m UyarÄ± DM"}),e.jsx("p",{children:"ÅÃ¼pheli hesap katÄ±ldÄ±ÄŸÄ±nda yÃ¶neticilere DM gÃ¶nder"})]}),e.jsxs("label",{className:"toggle-switch",children:[e.jsx("input",{type:"checkbox",checked:s.dm_on_join_warning,onChange:a=>i({...s,dm_on_join_warning:a.target.checked})}),e.jsx("span",{className:"slider"})]})]})]}),e.jsx("div",{className:"settings-actions",children:e.jsx("button",{className:"save-btn",onClick:m,children:"AyarlarÄ± Kaydet"})})]}),re=({serverId:s,onClose:i,apiBaseUrl:m})=>{const{view:a,setView:l,protectionStatus:r,recentActivity:h,pendingVerifications:j,raidLogs:x,settings:p,setSettings:N,stats:_,activityRef:g,handleToggleProtection:k,handleLockdown:f,handleVerifyUser:u,handleSaveSettings:b}=q(s,m);return e.jsx("div",{className:"raid-dashboard-overlay",onClick:i,children:e.jsxs("div",{className:"raid-dashboard",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"dashboard-header",children:[e.jsxs("h2",{children:[e.jsx($,{})," Raid Koruma Paneli"]}),e.jsxs("div",{className:"header-status",children:[e.jsx("span",{className:`status-badge ${r.enabled?"active":"inactive"}`,children:r.enabled?"ğŸ›¡ï¸ Koruma Aktif":"âš ï¸ Koruma KapalÄ±"}),r.lockdown_active&&e.jsx("span",{className:"status-badge lockdown",children:"ğŸ”’ Lockdown"})]}),e.jsx("button",{className:"close-btn",onClick:i,children:e.jsx(V,{})})]}),e.jsxs("div",{className:"dashboard-nav",children:[e.jsxs("button",{className:`nav-btn ${a==="overview"?"active":""}`,onClick:()=>l("overview"),children:[e.jsx(E,{})," Genel BakÄ±ÅŸ"]}),e.jsxs("button",{className:`nav-btn ${a==="verify"?"active":""}`,onClick:()=>l("verify"),children:[e.jsx(S,{})," DoÄŸrulama",j.length>0&&e.jsx("span",{className:"badge",children:j.length})]}),e.jsxs("button",{className:`nav-btn ${a==="logs"?"active":""}`,onClick:()=>l("logs"),children:[e.jsx(C,{})," Loglar"]}),e.jsxs("button",{className:`nav-btn ${a==="settings"?"active":""}`,onClick:()=>l("settings"),children:[e.jsx(P,{})," Ayarlar"]})]}),e.jsxs("div",{className:"dashboard-content",children:[a==="overview"&&e.jsx(G,{protectionStatus:r,stats:_,recentActivity:h,activityRef:g,handleToggleProtection:k,handleLockdown:f}),a==="verify"&&e.jsxs("div",{className:"verify-view",children:[e.jsxs("h3",{children:[e.jsx(S,{})," Bekleyen DoÄŸrulamalar"]}),j.length>0?e.jsx("div",{className:"verifications-list",children:j.map(t=>e.jsxs("div",{className:"verification-card",children:[e.jsx("img",{src:t.avatar||"/default-avatar.png",alt:t.username,className:"user-avatar"}),e.jsxs("div",{className:"user-info",children:[e.jsx("h4",{children:t.username}),e.jsxs("div",{className:"user-meta",children:[e.jsxs("span",{children:[e.jsx(R,{})," KatÄ±lÄ±m: ",new Date(t.joined_at).toLocaleDateString("tr-TR")]}),e.jsxs("span",{children:[e.jsx(I,{})," Hesap: ",t.account_age_days," gÃ¼n"]})]}),t.suspicious_reasons&&e.jsxs("div",{className:"suspicious-reasons",children:[e.jsx(K,{}),t.suspicious_reasons.map((v,w)=>e.jsx("span",{className:"reason-tag",children:v},w))]})]}),e.jsxs("div",{className:"verification-actions",children:[e.jsxs("button",{className:"approve-btn",onClick:()=>u(t.id,"approve"),children:[e.jsx(T,{})," Onayla"]}),e.jsxs("button",{className:"reject-btn",onClick:()=>u(t.id,"reject"),children:[e.jsx(L,{})," Reddet"]})]})]},t.id))}):e.jsxs("div",{className:"no-verifications",children:[e.jsx(S,{className:"empty-icon"}),e.jsx("p",{children:"Bekleyen doÄŸrulama yok"})]})]}),a==="logs"&&e.jsxs("div",{className:"logs-view",children:[e.jsxs("h3",{children:[e.jsx(C,{})," Raid LoglarÄ±"]}),x.length>0?e.jsx("div",{className:"logs-list",children:x.map((t,v)=>e.jsxs("div",{className:`log-item ${t.severity}`,children:[e.jsxs("div",{className:"log-header",children:[e.jsxs("span",{className:"log-type",children:[t.type==="raid_detected"&&"ğŸš¨ Raid Tespit Edildi",t.type==="mass_ban"&&"ğŸ”¨ Toplu Ban",t.type==="lockdown"&&"ğŸ”’ Lockdown",t.type==="unlock"&&"ğŸ”“ Kilit AÃ§Ä±ldÄ±",t.type==="suspicious_activity"&&"âš ï¸ ÅÃ¼pheli Aktivite"]}),e.jsx("span",{className:"log-time",children:new Date(t.timestamp).toLocaleString("tr-TR")})]}),e.jsx("p",{className:"log-description",children:t.description}),t.affected_users&&e.jsxs("span",{className:"affected-count",children:[t.affected_users," kullanÄ±cÄ± etkilendi"]})]},v))}):e.jsxs("div",{className:"no-logs",children:[e.jsx(C,{className:"empty-icon"}),e.jsx("p",{children:"HenÃ¼z log kaydÄ± yok"})]})]}),a==="settings"&&e.jsx(U,{settings:p,setSettings:N,handleSaveSettings:b})]})]})})};export{re as default};
