var $=Object.defineProperty;var a=(i,d)=>$(i,"name",{value:d,configurable:!0});import{r as o,j as e}from"./react-core-Djgtqrmb.js";import{y as t}from"./ui-vendor-IhB9Znpc.js";import{g as z,e as x}from"./index-D_luy7FO.js";import"./media-vendor-CxFPycob.js";import"./router-vendor-gmJ9Mn-1.js";import"./state-vendor-BRqaXHJQ.js";import"./crypto-vendor-D1XRGppi.js";import"./icons-vendor-BW7dxHkX.js";const P=a(({serverId:i,onClose:d})=>{const l=z(),[u,j]=o.useState([]),[g,b]=o.useState(!0),[p,k]=o.useState(!1),[n,r]=o.useState({include_channels:!0,include_roles:!0,include_messages:!1,include_settings:!0,include_emojis:!0});o.useEffect(()=>{h()},[i]);const h=a(async()=>{try{const s=await fetch(`${l}/backups/server/${i}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(s.ok){const c=await s.json();j(c)}}catch{}finally{b(!1)}},"fetchBackups"),f=a(async()=>{k(!0);try{(await fetch(`${l}/backups/create/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`,"Content-Type":"application/json"},body:JSON.stringify({server_id:i,...n})})).ok?(t.success("âœ… Yedek oluÅŸturuluyor..."),h()):t.error("âŒ Yedek oluÅŸturulamadÄ±")}catch{t.error("âŒ BaÄŸlantÄ± hatasÄ±")}finally{k(!1)}},"createBackup"),y=a(async s=>{if(await x("Sunucuyu bu yedeÄŸe geri yÃ¼klemek istediÄŸinize emin misiniz? Bu iÅŸlem geri alÄ±namaz!"))try{(await fetch(`${l}/backups/${s}/restore/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}})).ok?t.success("âœ… Sunucu geri yÃ¼kleniyor..."):t.error("âŒ Geri yÃ¼kleme hatasÄ±")}catch{t.error("âŒ BaÄŸlantÄ± hatasÄ±")}},"restoreBackup"),N=a(async s=>{try{const c=await fetch(`${l}/backups/${s}/download/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(c.ok){const v=await c.blob(),w=window.URL.createObjectURL(v),m=document.createElement("a");m.href=w,m.download=`backup_${s}.json`,m.click(),t.success("âœ… Yedek indiriliyor")}}catch{t.error("âŒ Ä°ndirme hatasÄ±")}},"downloadBackup"),_=a(async s=>{if(await x("YedeÄŸi silmek istediÄŸinize emin misiniz?"))try{(await fetch(`${l}/backups/${s}/delete/`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}})).ok&&(t.success("âœ… Yedek silindi"),h())}catch{t.error("âŒ Silme hatasÄ±")}},"deleteBackup"),B=a(s=>s<1024?s+" B":s<1024*1024?(s/1024).toFixed(2)+" KB":(s/(1024*1024)).toFixed(2)+" MB","formatFileSize"),S=a(s=>{const c={completed:{text:"TamamlandÄ±",color:"#22c55e",icon:"âœ…"},processing:{text:"Ä°ÅŸleniyor",color:"#f59e0b",icon:"â³"},failed:{text:"BaÅŸarÄ±sÄ±z",color:"#ef4444",icon:"âŒ"}};return c[s]||c.processing},"getStatusBadge");return e.jsx("div",{className:"backup-overlay",onClick:d,children:e.jsxs("div",{className:"backup-panel",onClick:a(s=>s.stopPropagation(),"onClick"),children:[e.jsxs("div",{className:"backup-header",children:[e.jsx("h2",{children:"ğŸ’¾ Sunucu Yedekleme"}),e.jsx("button",{className:"close-btn",onClick:d,children:"Ã—"})]}),e.jsxs("div",{className:"backup-content",children:[e.jsxs("div",{className:"create-backup-section",children:[e.jsx("h3",{children:"Yeni Yedek OluÅŸtur"}),e.jsxs("div",{className:"backup-options",children:[e.jsxs("label",{className:"option-label",children:[e.jsx("input",{type:"checkbox",checked:n.include_channels,onChange:a(s=>r({...n,include_channels:s.target.checked}),"onChange")}),e.jsx("span",{children:"ğŸ“ KanallarÄ± dahil et"})]}),e.jsxs("label",{className:"option-label",children:[e.jsx("input",{type:"checkbox",checked:n.include_roles,onChange:a(s=>r({...n,include_roles:s.target.checked}),"onChange")}),e.jsx("span",{children:"ğŸ­ Rolleri dahil et"})]}),e.jsxs("label",{className:"option-label",children:[e.jsx("input",{type:"checkbox",checked:n.include_messages,onChange:a(s=>r({...n,include_messages:s.target.checked}),"onChange")}),e.jsx("span",{children:"ğŸ’¬ MesajlarÄ± dahil et (son 100)"})]}),e.jsxs("label",{className:"option-label",children:[e.jsx("input",{type:"checkbox",checked:n.include_settings,onChange:a(s=>r({...n,include_settings:s.target.checked}),"onChange")}),e.jsx("span",{children:"âš™ï¸ AyarlarÄ± dahil et"})]}),e.jsxs("label",{className:"option-label",children:[e.jsx("input",{type:"checkbox",checked:n.include_emojis,onChange:a(s=>r({...n,include_emojis:s.target.checked}),"onChange")}),e.jsx("span",{children:"ğŸ˜€ Emojileri dahil et"})]})]}),e.jsx("button",{className:"create-backup-btn",onClick:f,disabled:p,children:p?"â³ OluÅŸturuluyor...":"ğŸ’¾ Yedek OluÅŸtur"})]}),g?e.jsxs("div",{className:"loading-state",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{children:"YÃ¼kleniyor..."})]}):u.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("span",{className:"empty-icon",children:"ğŸ’¾"}),e.jsx("p",{children:"HenÃ¼z yedek yok"})]}):e.jsxs("div",{className:"backups-list",children:[e.jsxs("h3",{children:["Mevcut Yedekler (",u.length,")"]}),u.map(s=>{const c=S(s.status);return e.jsxs("div",{className:"backup-card",children:[e.jsx("div",{className:"backup-info",children:e.jsxs("div",{className:"backup-main",children:[e.jsxs("h4",{children:["Yedek #",s.id]}),e.jsxs("div",{className:"backup-meta",children:[e.jsxs("span",{children:["ğŸ“… ",new Date(s.created_at).toLocaleString("tr-TR")]}),e.jsxs("span",{children:["ğŸ“¦ ",B(s.file_size)]}),e.jsxs("span",{className:"status-badge",style:{background:c.color},children:[c.icon," ",c.text]})]}),e.jsxs("div",{className:"backup-includes",children:[s.includes_channels&&e.jsx("span",{className:"include-badge",children:"ğŸ“ Kanallar"}),s.includes_roles&&e.jsx("span",{className:"include-badge",children:"ğŸ­ Roller"}),s.includes_messages&&e.jsx("span",{className:"include-badge",children:"ğŸ’¬ Mesajlar"}),s.includes_settings&&e.jsx("span",{className:"include-badge",children:"âš™ï¸ Ayarlar"}),s.includes_emojis&&e.jsx("span",{className:"include-badge",children:"ğŸ˜€ Emojiler"})]})]})}),s.status==="completed"&&e.jsxs("div",{className:"backup-actions",children:[e.jsx("button",{className:"restore-btn",onClick:a(()=>y(s.id),"onClick"),children:"ğŸ”„ Geri YÃ¼kle"}),e.jsx("button",{className:"download-btn",onClick:a(()=>N(s.id),"onClick"),children:"ğŸ“¥ Ä°ndir"}),e.jsx("button",{className:"delete-btn",onClick:a(()=>_(s.id),"onClick"),children:"ğŸ—‘ï¸ Sil"})]})]},s.id)})]})]})]})})},"ServerBackupPanel");export{P as default};
