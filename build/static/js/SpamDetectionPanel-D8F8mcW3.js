import{j as e,r as x}from"./react-core-D6cE4lil.js";import{a5 as y,b2 as B,d as C,l as A,a7 as D,b5 as I,cA as E,b6 as P,H as z,as as f,a as j,b7 as F,b3 as M}from"./icons-vendor-DT2gd7vx.js";import{g as S,t as b}from"./index-ClHcoIda.js";import"./media-vendor-Du00QUHb.js";import"./router-vendor-wrB4dqw3.js";import"./state-vendor-DnurjGY_.js";import"./crypto-vendor-BYnay7oC.js";import"./ui-vendor-CZOhtEfS.js";const T={low:{messagesPerMinute:15,duplicateThreshold:5,mentionLimit:10,linkLimit:5,capsPercentage:80},medium:{messagesPerMinute:10,duplicateThreshold:3,mentionLimit:5,linkLimit:3,capsPercentage:70},high:{messagesPerMinute:7,duplicateThreshold:2,mentionLimit:3,linkLimit:2,capsPercentage:60},aggressive:{messagesPerMinute:5,duplicateThreshold:2,mentionLimit:2,linkLimit:1,capsPercentage:50}},O={rapidMessages:"HÄ±zlÄ± Mesaj",duplicateContent:"Tekrarlanan Ä°Ã§erik",mentionSpam:"Etiket Spam",linkSpam:"Link Spam",capsLock:"BÃœYÃœK HARF",zalgoText:"Zalgo Metin"},G={warn:"Uyar",mute:"Sustur",kick:"At",ban:"Yasakla"},w=i=>({rapidMessages:e.jsx(E,{}),duplicateContent:e.jsx(I,{}),mentionSpam:e.jsx(D,{}),linkSpam:e.jsx(A,{}),capsLock:e.jsx(C,{}),zalgoText:e.jsx(B,{})})[i]||e.jsx(y,{}),h=i=>({warn:"#faa61a",mute:"#5865f2",kick:"#f04747",ban:"#ed4245"})[i]||"#72767d",v={totalDetected:0,todayDetected:0,actionsTaken:{warn:0,mute:0,kick:0,ban:0},topOffenders:[],recentDetections:[]},K=({serverId:i,fetchWithAuth:a,apiBaseUrl:n})=>{const[c,s]=x.useState({enabled:!0,sensitivity:"medium",actions:{warn:!0,mute:!0,kick:!1,ban:!1},patterns:{rapidMessages:!0,duplicateContent:!0,mentionSpam:!0,linkSpam:!0,capsLock:!0,zalgoText:!0},thresholds:T.medium,whitelist:[],customPatterns:[]}),[d,g]=x.useState(v),[o,p]=x.useState(!0),[L,R]=x.useState("overview"),k=x.useCallback(async()=>{p(!0);const r=n||S();try{const l=await a(`${r}/api/servers/${i}/spam-settings/`);if(l.ok){const m=await l.json();s(u=>({...u,...m}))}}catch{}try{const l=await a(`${r}/api/servers/${i}/spam-stats/`);if(l.ok){const m=await l.json();g(u=>({...u,...m}))}else g(v)}catch{g(v)}p(!1)},[i,a,n]);return x.useEffect(()=>{k()},[k]),{settings:c,stats:d,loading:o,activeTab:L,setActiveTab:R,handleSensitivityChange:r=>{s(l=>({...l,sensitivity:r,thresholds:T[r]}))},handlePatternToggle:r=>{s(l=>({...l,patterns:{...l.patterns,[r]:!l.patterns[r]}}))},handleActionToggle:r=>{s(l=>({...l,actions:{...l.actions,[r]:!l.actions[r]}}))},toggleEnabled:()=>{s(r=>({...r,enabled:!r.enabled}))},saveSettings:async()=>{try{const r=n||S();(await a(`${r}/api/servers/${i}/spam-settings/`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)})).ok?b.success("Spam koruma ayarlarÄ± kaydedildi! âœ…"):b.error("Ayarlar kaydedilemedi")}catch{b.error("Bir hata oluÅŸtu")}}}},t={container:{backgroundColor:"#2f3136",borderRadius:"8px",overflow:"hidden"},loading:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"16px",padding:"60px",color:"#b9bbbe"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #202225"},headerLeft:{display:"flex",alignItems:"center",gap:"16px"},headerRight:{display:"flex",alignItems:"center"},title:{margin:0,fontSize:"18px",fontWeight:"600",color:"#fff"},subtitle:{margin:"4px 0 0",fontSize:"13px",color:"#72767d"},statusBadge:{padding:"6px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},tabs:{display:"flex",padding:"0 20px",borderBottom:"1px solid #202225",gap:"8px"},tab:{display:"flex",alignItems:"center",gap:"8px",padding:"12px 16px",border:"none",borderRadius:"4px 4px 0 0",cursor:"pointer",fontSize:"13px",fontWeight:"500",transition:"all 0.15s"},content:{padding:"20px"},statsGrid:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"12px",marginBottom:"24px"},statCard:{display:"flex",alignItems:"center",gap:"12px",padding:"16px",backgroundColor:"#202225",borderRadius:"8px"},statIcon:{display:"flex",alignItems:"center",justifyContent:"center",width:"40px",height:"40px",backgroundColor:"#36393f",borderRadius:"8px"},statInfo:{flex:1},statValue:{fontSize:"20px",fontWeight:"700",color:"#fff"},statLabel:{fontSize:"12px",color:"#72767d"},section:{marginBottom:"24px"},sectionTitle:{margin:"0 0 16px",fontSize:"14px",fontWeight:"600",color:"#fff",textTransform:"uppercase",letterSpacing:"0.5px"},detectionsList:{display:"flex",flexDirection:"column",gap:"8px"},detectionItem:{display:"flex",alignItems:"center",gap:"12px",padding:"12px 16px",backgroundColor:"#202225",borderRadius:"6px"},detectionIcon:{color:"#faa61a"},detectionInfo:{flex:1},detectionUser:{display:"flex",alignItems:"center",gap:"8px",color:"#fff",fontSize:"14px"},detectionType:{fontSize:"11px",color:"#72767d",backgroundColor:"#40444b",padding:"2px 6px",borderRadius:"3px"},detectionMessage:{fontSize:"12px",color:"#72767d",marginTop:"4px"},actionBadge:{padding:"4px 10px",borderRadius:"4px",color:"#fff",fontSize:"11px",fontWeight:"600",textTransform:"uppercase"},offendersList:{display:"flex",flexDirection:"column",gap:"8px"},offenderItem:{display:"flex",alignItems:"center",gap:"12px",padding:"12px 16px",backgroundColor:"#202225",borderRadius:"6px"},offenderRank:{width:"28px",height:"28px",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#40444b",borderRadius:"50%",fontSize:"12px",fontWeight:"600",color:"#fff"},offenderInfo:{flex:1,display:"flex",flexDirection:"column"},offenderName:{color:"#fff",fontSize:"14px",fontWeight:"500"},offenderCount:{color:"#72767d",fontSize:"12px"},settingRow:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px",backgroundColor:"#202225",borderRadius:"8px",marginBottom:"16px"},settingInfo:{display:"flex",alignItems:"center",gap:"12px"},settingTitle:{color:"#fff",fontSize:"14px",fontWeight:"500"},settingDesc:{color:"#72767d",fontSize:"12px"},toggleButton:{width:"44px",height:"24px",border:"none",borderRadius:"12px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",transition:"background-color 0.2s"},sensitivityGrid:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"8px"},sensitivityButton:{padding:"12px",border:"2px solid transparent",borderRadius:"8px",cursor:"pointer",color:"#fff",fontSize:"13px",fontWeight:"500",transition:"all 0.15s"},patternsGrid:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"8px"},patternItem:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 16px",backgroundColor:"#202225",borderRadius:"6px"},patternInfo:{display:"flex",alignItems:"center",gap:"10px",color:"#dcddde",fontSize:"13px"},miniToggle:{width:"28px",height:"18px",border:"none",borderRadius:"9px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",transition:"background-color 0.2s"},actionsGrid:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"8px"},actionItem:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 16px",backgroundColor:"#202225",borderRadius:"6px"},actionInfo:{display:"flex",alignItems:"center",gap:"8px",color:"#dcddde",fontSize:"13px"},actionDot:{width:"8px",height:"8px",borderRadius:"50%"},saveButton:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",width:"100%",padding:"12px",backgroundColor:"#43b581",border:"none",borderRadius:"4px",color:"#fff",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"background-color 0.15s"},logsHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},filterSelect:{padding:"8px 12px",backgroundColor:"#202225",border:"1px solid #40444b",borderRadius:"4px",color:"#dcddde",fontSize:"13px"},logsList:{display:"flex",flexDirection:"column",gap:"8px"},logItem:{display:"flex",alignItems:"flex-start",gap:"12px",padding:"12px 16px",backgroundColor:"#202225",borderRadius:"6px"},logTime:{fontSize:"11px",color:"#72767d",whiteSpace:"nowrap"},logContent:{flex:1,fontSize:"13px",color:"#dcddde"},logMessage:{fontSize:"12px",color:"#72767d",marginTop:"4px",fontStyle:"italic"}},W=({stats:i,settings:a})=>e.jsxs("div",{style:t.content,children:[e.jsxs("div",{style:t.statsGrid,children:[e.jsxs("div",{style:t.statCard,children:[e.jsx("div",{style:t.statIcon,children:e.jsx(y,{size:20,color:"#43b581"})}),e.jsxs("div",{style:t.statInfo,children:[e.jsx("div",{style:t.statValue,children:i.totalDetected}),e.jsx("div",{style:t.statLabel,children:"Toplam Tespit"})]})]}),e.jsxs("div",{style:t.statCard,children:[e.jsx("div",{style:t.statIcon,children:e.jsx(C,{size:20,color:"#faa61a"})}),e.jsxs("div",{style:t.statInfo,children:[e.jsx("div",{style:t.statValue,children:i.todayDetected}),e.jsx("div",{style:t.statLabel,children:"BugÃ¼n"})]})]}),e.jsxs("div",{style:t.statCard,children:[e.jsx("div",{style:t.statIcon,children:e.jsx(P,{size:20,color:"#f04747"})}),e.jsxs("div",{style:t.statInfo,children:[e.jsx("div",{style:t.statValue,children:i.actionsTaken?.ban||0}),e.jsx("div",{style:t.statLabel,children:"Ban"})]})]}),e.jsxs("div",{style:t.statCard,children:[e.jsx("div",{style:t.statIcon,children:e.jsx(z,{size:20,color:"#5865f2"})}),e.jsxs("div",{style:t.statInfo,children:[e.jsx("div",{style:t.statValue,children:Object.values(a.patterns).filter(Boolean).length}),e.jsx("div",{style:t.statLabel,children:"Aktif Kural"})]})]})]}),e.jsxs("div",{style:t.section,children:[e.jsx("h3",{style:t.sectionTitle,children:"Son Tespitler"}),e.jsx("div",{style:t.detectionsList,children:i.recentDetections.map((n,c)=>e.jsxs("div",{style:t.detectionItem,children:[e.jsx("div",{style:t.detectionIcon,children:w(n.type)}),e.jsxs("div",{style:t.detectionInfo,children:[e.jsxs("div",{style:t.detectionUser,children:[e.jsx("strong",{children:n.username}),e.jsx("span",{style:t.detectionType,children:n.type})]}),e.jsxs("div",{style:t.detectionMessage,children:[n.message.substring(0,50),"..."]})]}),e.jsx("div",{style:{...t.actionBadge,backgroundColor:h(n.action)},children:n.action})]},c))})]}),e.jsxs("div",{style:t.section,children:[e.jsx("h3",{style:t.sectionTitle,children:"En Ã‡ok Ä°hlal Edenler"}),e.jsx("div",{style:t.offendersList,children:i.topOffenders.map((n,c)=>e.jsxs("div",{style:t.offenderItem,children:[e.jsxs("div",{style:t.offenderRank,children:["#",c+1]}),e.jsxs("div",{style:t.offenderInfo,children:[e.jsx("span",{style:t.offenderName,children:n.username}),e.jsxs("span",{style:t.offenderCount,children:[n.count," ihlal"]})]}),e.jsx("div",{style:{...t.actionBadge,backgroundColor:h(n.lastAction)},children:n.lastAction})]},c))})]})]}),H=({settings:i,isAdmin:a,onSensitivityChange:n,onPatternToggle:c,onActionToggle:s,onToggleEnabled:d,onSave:g})=>e.jsxs("div",{style:t.content,children:[e.jsxs("div",{style:t.settingRow,children:[e.jsxs("div",{style:t.settingInfo,children:[e.jsx(y,{size:18,color:"#43b581"}),e.jsxs("div",{children:[e.jsx("div",{style:t.settingTitle,children:"Spam KorumasÄ±"}),e.jsx("div",{style:t.settingDesc,children:"Otomatik spam algÄ±lama ve Ã¶nleme"})]})]}),e.jsx("button",{style:{...t.toggleButton,backgroundColor:i.enabled?"#43b581":"#72767d"},onClick:d,children:i.enabled?e.jsx(f,{}):e.jsx(j,{})})]}),e.jsxs("div",{style:t.section,children:[e.jsx("h3",{style:t.sectionTitle,children:"Hassasiyet Seviyesi"}),e.jsx("div",{style:t.sensitivityGrid,children:[{key:"low",label:"ðŸ¢ DÃ¼ÅŸÃ¼k"},{key:"medium",label:"âš–ï¸ Orta"},{key:"high",label:"ðŸ”¥ YÃ¼ksek"},{key:"aggressive",label:"âš¡ Agresif"}].map(({key:o,label:p})=>e.jsx("button",{style:{...t.sensitivityButton,backgroundColor:i.sensitivity===o?"#5865f2":"#40444b",borderColor:i.sensitivity===o?"#5865f2":"transparent"},onClick:()=>n(o),children:p},o))})]}),e.jsxs("div",{style:t.section,children:[e.jsx("h3",{style:t.sectionTitle,children:"AlgÄ±lama KalÄ±plarÄ±"}),e.jsx("div",{style:t.patternsGrid,children:Object.entries(i.patterns).map(([o,p])=>e.jsxs("div",{style:t.patternItem,children:[e.jsxs("div",{style:t.patternInfo,children:[w(o),e.jsx("span",{children:O[o]||o})]}),e.jsx("button",{style:{...t.miniToggle,backgroundColor:p?"#43b581":"#72767d"},onClick:()=>c(o),children:p?e.jsx(f,{size:10}):e.jsx(j,{size:10})})]},o))})]}),e.jsxs("div",{style:t.section,children:[e.jsx("h3",{style:t.sectionTitle,children:"Otomatik Eylemler"}),e.jsx("div",{style:t.actionsGrid,children:Object.entries(i.actions).map(([o,p])=>e.jsxs("div",{style:t.actionItem,children:[e.jsxs("div",{style:t.actionInfo,children:[e.jsx("div",{style:{...t.actionDot,backgroundColor:h(o)}}),e.jsx("span",{children:G[o]||o})]}),e.jsx("button",{style:{...t.miniToggle,backgroundColor:p?"#43b581":"#72767d"},onClick:()=>s(o),children:p?e.jsx(f,{size:10}):e.jsx(j,{size:10})})]},o))})]}),a&&e.jsxs("button",{style:t.saveButton,onClick:g,children:[e.jsx(f,{})," AyarlarÄ± Kaydet"]})]}),N=({stats:i})=>e.jsxs("div",{style:t.content,children:[e.jsxs("div",{style:t.logsHeader,children:[e.jsx("h3",{style:t.sectionTitle,children:"Spam KayÄ±tlarÄ±"}),e.jsxs("select",{style:t.filterSelect,children:[e.jsx("option",{value:"all",children:"TÃ¼m Eylemler"}),e.jsx("option",{value:"warn",children:"UyarÄ±lar"}),e.jsx("option",{value:"mute",children:"Susturmalar"}),e.jsx("option",{value:"kick",children:"Atmalar"}),e.jsx("option",{value:"ban",children:"Yasaklamalar"})]})]}),e.jsx("div",{style:t.logsList,children:i.recentDetections.map((a,n)=>e.jsxs("div",{style:t.logItem,children:[e.jsx("div",{style:t.logTime,children:new Date(a.timestamp).toLocaleString("tr-TR")}),e.jsxs("div",{style:t.logContent,children:[e.jsx("strong",{children:a.username})," - ",a.type,e.jsxs("div",{style:t.logMessage,children:['"',a.message,'"']})]}),e.jsx("div",{style:{...t.actionBadge,backgroundColor:h(a.action)},children:a.action})]},n))})]}),ie=({serverId:i,fetchWithAuth:a,apiBaseUrl:n,isAdmin:c=!1})=>{const s=K({serverId:i,fetchWithAuth:a,apiBaseUrl:n});return s.loading?e.jsx("div",{style:t.container,children:e.jsxs("div",{style:t.loading,children:[e.jsx(z,{className:"pulse",size:32,color:"#5865f2"}),e.jsx("span",{children:"Spam koruma sistemi yÃ¼kleniyor..."})]})}):e.jsxs("div",{style:t.container,children:[e.jsxs("div",{style:t.header,children:[e.jsxs("div",{style:t.headerLeft,children:[e.jsx(y,{size:24,color:"#43b581"}),e.jsxs("div",{children:[e.jsx("h2",{style:t.title,children:"Spam Koruma Sistemi"}),e.jsx("p",{style:t.subtitle,children:"ML tabanlÄ± akÄ±llÄ± spam algÄ±lama"})]})]}),e.jsx("div",{style:t.headerRight,children:e.jsx("div",{style:{...t.statusBadge,backgroundColor:s.settings.enabled?"rgba(67, 181, 129, 0.2)":"rgba(240, 71, 71, 0.2)",color:s.settings.enabled?"#43b581":"#f04747"},children:s.settings.enabled?"âœ“ Aktif":"âœ— KapalÄ±"})})]}),e.jsx("div",{style:t.tabs,children:["overview","settings","logs"].map(d=>e.jsxs("button",{style:{...t.tab,backgroundColor:s.activeTab===d?"#5865f2":"transparent",color:s.activeTab===d?"#fff":"#b9bbbe"},onClick:()=>s.setActiveTab(d),children:[d==="overview"&&e.jsx(F,{}),d==="settings"&&e.jsx(M,{}),d==="logs"&&e.jsx(I,{}),d==="overview"?"Genel BakÄ±ÅŸ":d==="settings"?"Ayarlar":"KayÄ±tlar"]},d))}),s.activeTab==="overview"&&e.jsx(W,{stats:s.stats,settings:s.settings}),s.activeTab==="settings"&&e.jsx(H,{settings:s.settings,isAdmin:c,onSensitivityChange:s.handleSensitivityChange,onPatternToggle:s.handlePatternToggle,onActionToggle:s.handleActionToggle,onToggleEnabled:s.toggleEnabled,onSave:s.saveSettings}),s.activeTab==="logs"&&e.jsx(N,{stats:s.stats})]})};export{ie as default};
