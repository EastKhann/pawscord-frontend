import{r as i,d as e,c9 as n}from"./react-core-DrOm_csO.js";import{g as A}from"./index-BYhWpPLp.js";const C=({serverId:c,onClose:g})=>{const o=A(),[u,E]=i.useState([]),[v,p]=i.useState([]),[y,_]=i.useState(!0),[r,s]=i.useState({role_id:"",trigger_type:"on_join",delay:0,required_level:0,required_invites:0,required_messages:0,remove_after:0,enabled:!0}),d=[{value:"on_join",label:"Sunucuya KatÄ±lÄ±nca",icon:"ğŸ‘‹"},{value:"on_verify",label:"DoÄŸrulama SonrasÄ±",icon:"âœ…"},{value:"on_level",label:"Seviyeye UlaÅŸÄ±nca",icon:"â­"},{value:"on_invites",label:"Davet SayÄ±sÄ±",icon:"ğŸ‘¥"},{value:"on_messages",label:"Mesaj SayÄ±sÄ±",icon:"ğŸ’¬"},{value:"on_reaction",label:"Reaksiyon Verince",icon:"ğŸ˜€"},{value:"on_boost",label:"Sunucu Boost",icon:"ğŸš€"}];i.useEffect(()=>{m(),k()},[c]);const m=async()=>{try{const t=await fetch(`${o}/auto-roles/server/${c}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(t.ok){const a=await t.json();E(a)}}catch(t){console.error("Error fetching auto roles:",t)}finally{_(!1)}},k=async()=>{try{const t=await fetch(`${o}/roles/server/${c}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(t.ok){const a=await t.json();p(a)}}catch(t){console.error("Error fetching roles:",t)}},f=async()=>{if(!r.role_id){n.error("âŒ LÃ¼tfen rol seÃ§in");return}try{(await fetch(`${o}/auto-roles/create/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`,"Content-Type":"application/json"},body:JSON.stringify({server_id:c,...r})})).ok?(n.success("âœ… Otomatik rol oluÅŸturuldu"),m(),s({role_id:"",trigger_type:"on_join",delay:0,required_level:0,required_invites:0,required_messages:0,remove_after:0,enabled:!0})):n.error("âŒ Otomatik rol oluÅŸturulamadÄ±")}catch(t){console.error("Error creating auto role:",t),n.error("âŒ BaÄŸlantÄ± hatasÄ±")}},h=async(t,a)=>{try{(await fetch(`${o}/auto-roles/${t}/toggle/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}})).ok?(n.success(a?"âœ… Otomatik rol devre dÄ±ÅŸÄ±":"âœ… Otomatik rol aktif"),m()):n.error("âŒ Durum gÃ¼ncellenemedi")}catch(l){console.error("Error toggling auto role:",l),n.error("âŒ BaÄŸlantÄ± hatasÄ±")}},N=async t=>{if(window.confirm("Otomatik rolÃ¼ silmek istediÄŸinize emin misiniz?"))try{(await fetch(`${o}/auto-roles/${t}/delete/`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}})).ok?(n.success("âœ… Otomatik rol silindi"),m()):n.error("âŒ Otomatik rol silinemedi")}catch(a){console.error("Error deleting auto role:",a),n.error("âŒ BaÄŸlantÄ± hatasÄ±")}},b=t=>{const a=v.find(l=>l.id===t);return a?a.name:"Bilinmeyen Rol"},S=t=>{const a=d.find(l=>l.value===t);return a?a.label:t},q=t=>{const a=d.find(l=>l.value===t);return a?a.icon:"âš™ï¸"},$=t=>{if(t===0)return"AnÄ±nda";const a=Math.floor(t/60),l=Math.floor(a/60);return l>0?`${l} saat`:`${a} dakika`};return e.createElement("div",{className:"autoroles-panel-overlay",onClick:g},e.createElement("div",{className:"autoroles-panel",onClick:t=>t.stopPropagation()},e.createElement("div",{className:"autoroles-header"},e.createElement("h2",null,"âš¡ Otomatik Roller"),e.createElement("button",{className:"close-btn",onClick:g},"Ã—")),e.createElement("div",{className:"autoroles-content"},e.createElement("div",{className:"create-autorole-section"},e.createElement("h3",null,"Yeni Otomatik Rol Ekle"),e.createElement("div",{className:"create-form"},e.createElement("div",{className:"form-row"},e.createElement("div",{className:"form-group"},e.createElement("label",null,"Rol *"),e.createElement("select",{value:r.role_id,onChange:t=>s({...r,role_id:t.target.value})},e.createElement("option",{value:""},"Rol SeÃ§in"),v.map(t=>e.createElement("option",{key:t.id,value:t.id},t.name)))),e.createElement("div",{className:"form-group"},e.createElement("label",null,"Tetikleyici"),e.createElement("select",{value:r.trigger_type,onChange:t=>s({...r,trigger_type:t.target.value})},d.map(t=>e.createElement("option",{key:t.value,value:t.value},t.icon," ",t.label))))),e.createElement("div",{className:"form-row"},e.createElement("div",{className:"form-group"},e.createElement("label",null,"Gecikme (Saniye)"),e.createElement("input",{type:"number",min:"0",placeholder:"0 = AnÄ±nda",value:r.delay,onChange:t=>s({...r,delay:parseInt(t.target.value)||0})})),r.trigger_type==="on_level"&&e.createElement("div",{className:"form-group"},e.createElement("label",null,"Gerekli Seviye"),e.createElement("input",{type:"number",min:"1",value:r.required_level,onChange:t=>s({...r,required_level:parseInt(t.target.value)||0})})),r.trigger_type==="on_invites"&&e.createElement("div",{className:"form-group"},e.createElement("label",null,"Gerekli Davet"),e.createElement("input",{type:"number",min:"1",value:r.required_invites,onChange:t=>s({...r,required_invites:parseInt(t.target.value)||0})})),r.trigger_type==="on_messages"&&e.createElement("div",{className:"form-group"},e.createElement("label",null,"Gerekli Mesaj"),e.createElement("input",{type:"number",min:"1",value:r.required_messages,onChange:t=>s({...r,required_messages:parseInt(t.target.value)||0})})),e.createElement("div",{className:"form-group"},e.createElement("label",null,"Otomatik KaldÄ±r (Saat)"),e.createElement("input",{type:"number",min:"0",placeholder:"0 = HiÃ§bir zaman",value:r.remove_after,onChange:t=>s({...r,remove_after:parseInt(t.target.value)||0})}))),e.createElement("button",{className:"create-btn",onClick:f},"âš¡ Otomatik Rol OluÅŸtur"))),e.createElement("div",{className:"autoroles-list-section"},e.createElement("h3",null,"Aktif Otomatik Roller (",u.length,")"),y?e.createElement("div",{className:"loading-state"},e.createElement("div",{className:"spinner"}),e.createElement("p",null,"Otomatik roller yÃ¼kleniyor...")):u.length===0?e.createElement("div",{className:"empty-state"},e.createElement("span",{className:"empty-icon"},"âš¡"),e.createElement("p",null,"HenÃ¼z otomatik rol yok"),e.createElement("span",{className:"empty-hint"},"KullanÄ±cÄ±lara otomatik rol atamalarÄ± yapabilirsiniz")):e.createElement("div",{className:"autoroles-list"},u.map(t=>e.createElement("div",{key:t.id,className:`autorole-card ${t.enabled?"":"disabled"}`},e.createElement("div",{className:"autorole-card-header"},e.createElement("div",{className:"role-info"},e.createElement("span",{className:"trigger-icon"},q(t.trigger_type)),e.createElement("div",null,e.createElement("h4",null,b(t.role_id)),e.createElement("span",{className:"trigger-label"},S(t.trigger_type)))),e.createElement("div",{className:"autorole-actions"},e.createElement("button",{className:`toggle-btn ${t.enabled?"active":""}`,onClick:()=>h(t.id,t.enabled)},t.enabled?"âœ“":"â—‹"),e.createElement("button",{className:"delete-btn",onClick:()=>N(t.id)},"ğŸ—‘ï¸"))),e.createElement("div",{className:"autorole-details"},t.delay>0&&e.createElement("div",{className:"detail-item"},e.createElement("span",{className:"detail-icon"},"â±ï¸"),e.createElement("span",null,"Gecikme: ",$(t.delay))),t.required_level>0&&e.createElement("div",{className:"detail-item"},e.createElement("span",{className:"detail-icon"},"â­"),e.createElement("span",null,"Seviye ",t.required_level," gerekli")),t.required_invites>0&&e.createElement("div",{className:"detail-item"},e.createElement("span",{className:"detail-icon"},"ğŸ‘¥"),e.createElement("span",null,t.required_invites," davet gerekli")),t.required_messages>0&&e.createElement("div",{className:"detail-item"},e.createElement("span",{className:"detail-icon"},"ğŸ’¬"),e.createElement("span",null,t.required_messages," mesaj gerekli")),t.remove_after>0&&e.createElement("div",{className:"detail-item"},e.createElement("span",{className:"detail-icon"},"ğŸ”„"),e.createElement("span",null,t.remove_after," saat sonra kaldÄ±rÄ±lÄ±r")),t.uses_count>0&&e.createElement("div",{className:"detail-item"},e.createElement("span",{className:"detail-icon"},"ğŸ“Š"),e.createElement("span",null,t.uses_count," kere kullanÄ±ldÄ±"))))))))))};export{C as default};
