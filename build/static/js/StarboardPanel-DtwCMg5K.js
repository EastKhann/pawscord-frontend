import{r as c,d as e,c9 as o}from"./react-core-DrOm_csO.js";import{g as N}from"./index-DmEhdEtw.js";const w=({serverId:s,onClose:d})=>{const l=N(),[t,n]=c.useState({enabled:!1,channel_id:"",emoji:"â­",threshold:3,self_star:!1,allow_nsfw:!1}),[m,E]=c.useState([]),[g,u]=c.useState([]),[p,f]=c.useState(!0);c.useEffect(()=>{v(),h(),b()},[s]);const v=async()=>{try{const a=await fetch(`${l}/starboard/server/${s}/config/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(a.ok){const r=await a.json();n(r)}}catch(a){console.error("Error:",a)}finally{f(!1)}},h=async()=>{try{const a=await fetch(`${l}/starboard/server/${s}/messages/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(a.ok){const r=await a.json();E(r)}}catch(a){console.error("Error:",a)}},b=async()=>{try{const a=await fetch(`${l}/channels/server/${s}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(a.ok){const r=await a.json();u(r.filter(i=>i.type==="text"))}}catch(a){console.error("Error:",a)}},k=async()=>{try{(await fetch(`${l}/starboard/server/${s}/config/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`,"Content-Type":"application/json"},body:JSON.stringify(t)})).ok?o.success("âœ… Starboard ayarlarÄ± kaydedildi"):o.error("âŒ Kaydetme hatasÄ±")}catch{o.error("âŒ BaÄŸlantÄ± hatasÄ±")}},y=async a=>{try{(await fetch(`${l}/starboard/message/${a}/remove/`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}})).ok&&(o.success("âœ… Mesaj kaldÄ±rÄ±ldÄ±"),h())}catch{o.error("âŒ Silme hatasÄ±")}};return e.createElement("div",{className:"starboard-overlay",onClick:d},e.createElement("div",{className:"starboard-panel",onClick:a=>a.stopPropagation()},e.createElement("div",{className:"starboard-header"},e.createElement("h2",null,"â­ Starboard"),e.createElement("button",{className:"close-btn",onClick:d},"Ã—")),e.createElement("div",{className:"starboard-content"},p?e.createElement("div",{className:"loading-state"},e.createElement("div",{className:"spinner"}),e.createElement("p",null,"YÃ¼kleniyor...")):e.createElement(e.Fragment,null,e.createElement("div",{className:"config-section"},e.createElement("div",{className:"section-header"},e.createElement("h3",null,"âš™ï¸ Ayarlar"),e.createElement("label",{className:"toggle-switch"},e.createElement("input",{type:"checkbox",checked:t.enabled,onChange:a=>n({...t,enabled:a.target.checked})}),e.createElement("span",{className:"toggle-slider"}))),e.createElement("div",{className:"config-grid"},e.createElement("div",{className:"form-group"},e.createElement("label",null,"ğŸ“¢ Starboard KanalÄ±"),e.createElement("select",{value:t.channel_id,onChange:a=>n({...t,channel_id:a.target.value})},e.createElement("option",{value:""},"SeÃ§in"),g.map(a=>e.createElement("option",{key:a.id,value:a.id},"# ",a.name)))),e.createElement("div",{className:"form-group"},e.createElement("label",null,"â­ Emoji"),e.createElement("input",{type:"text",value:t.emoji,onChange:a=>n({...t,emoji:a.target.value}),placeholder:"â­"})),e.createElement("div",{className:"form-group"},e.createElement("label",null,"ğŸ¯ EÅŸik DeÄŸeri"),e.createElement("input",{type:"number",min:"1",max:"50",value:t.threshold,onChange:a=>n({...t,threshold:parseInt(a.target.value)})}),e.createElement("small",null,"MesajÄ±n starboard'a eklenebilmesi iÃ§in gereken minimum yÄ±ldÄ±z sayÄ±sÄ±")),e.createElement("div",{className:"form-group"},e.createElement("label",{className:"checkbox-label"},e.createElement("input",{type:"checkbox",checked:t.self_star,onChange:a=>n({...t,self_star:a.target.checked})}),e.createElement("span",null,"Kendi mesajÄ±na yÄ±ldÄ±z verebilir"))),e.createElement("div",{className:"form-group"},e.createElement("label",{className:"checkbox-label"},e.createElement("input",{type:"checkbox",checked:t.allow_nsfw,onChange:a=>n({...t,allow_nsfw:a.target.checked})}),e.createElement("span",null,"NSFW kanallardan izin ver")))),e.createElement("button",{className:"save-btn",onClick:k},"ğŸ’¾ Kaydet")),e.createElement("div",{className:"stars-section"},e.createElement("h3",null,"â­ Starboard MesajlarÄ± (",m.length,")"),m.length===0?e.createElement("div",{className:"empty-state"},e.createElement("span",{className:"empty-icon"},"â­"),e.createElement("p",null,"HenÃ¼z starboard mesajÄ± yok")):e.createElement("div",{className:"stars-list"},m.map(a=>e.createElement("div",{key:a.message_id,className:"star-card"},e.createElement("div",{className:"star-header"},e.createElement("div",{className:"star-author"},a.author_avatar?e.createElement("img",{src:a.author_avatar,alt:""}):e.createElement("div",{className:"default-avatar"},"ğŸ‘¤"),e.createElement("span",null,a.author_name)),e.createElement("div",{className:"star-count"},e.createElement("span",null,t.emoji," ",a.star_count))),e.createElement("div",{className:"star-content"},e.createElement("p",null,a.content),a.attachments&&a.attachments.length>0&&e.createElement("div",{className:"star-attachments"},a.attachments.map((r,i)=>e.createElement("img",{key:i,src:r,alt:""})))),e.createElement("div",{className:"star-footer"},e.createElement("span",{className:"star-channel"},"# ",a.channel_name),e.createElement("span",{className:"star-time"},new Date(a.created_at).toLocaleString("tr-TR")),e.createElement("button",{className:"remove-btn",onClick:()=>y(a.message_id)},"ğŸ—‘ï¸"))))))))))};export{w as default};
