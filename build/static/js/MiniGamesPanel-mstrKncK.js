import{r as c,n as e}from"./react-core-BMiyQWF6.js";import{aq as T,a as G,c6 as R,S as B,t as I,av as z,a_ as L}from"./icons-vendor-T72gfvdf.js";import{t as f}from"./index-DzAtxNGe.js";import"./editor-vendor-D9c4a6XZ.js";import"./media-vendor-BuSyE8vR.js";import"./router-vendor-B86Z1mIL.js";import"./state-vendor-CAyNnPM4.js";import"./crypto-vendor-1Q6e4ZD-.js";const H=({fetchWithAuth:p,apiBaseUrl:o,onClose:l,serverId:r})=>{const[b,n]=c.useState([]),[a,i]=c.useState(null),[y,v]=c.useState([]),[w,h]=c.useState(!1),[g,m]=c.useState("games");c.useEffect(()=>{_(),j()},[]);const _=async()=>{try{const d=await(await p(`${o}/games/?server_id=${r}`)).json();n(d.games||[])}catch{}},j=async()=>{try{const d=await(await p(`${o}/games/leaderboard/?server_id=${r}`)).json();v(d.leaderboard||[])}catch{}},k=async t=>{h(!0);try{const u=await(await p(`${o}/games/create/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({game_type:t,server_id:r})})).json();u.game&&(i(u.game),m("playing"),f.success(`${u.game.game_type} started!`))}catch{f.error("Failed to create game")}finally{h(!1)}},S=async(t,d={})=>{if(a)try{const x=await(await p(`${o}/games/${a.id}/action/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:t,data:d})})).json();return x.game&&i(x.game),x.status==="finished"&&(f.success(`Game over! ${x.winners?.join(", ")} won ${x.reward} coins!`),setTimeout(()=>{i(null),m("games"),j()},3e3)),x}catch{f.error("Action failed")}},C={trivia:"ðŸ§ ",word_chain:"ðŸ“",tic_tac_toe:"â­•",rock_paper_scissors:"âœŠ",number_guess:"ðŸ”¢",emoji_quiz:"ðŸ˜€",hangman:"ðŸŽ¯",memory_match:"ðŸƒ"};return e.jsx("div",{style:s.overlay,children:e.jsxs("div",{style:s.modal,children:[e.jsxs("div",{style:s.header,children:[e.jsxs("div",{style:s.headerLeft,children:[e.jsx(T,{style:{marginRight:"10px",color:"#5865f2"}}),e.jsx("h2",{style:s.title,children:"Mini Games"})]}),e.jsx("button",{onClick:l,style:s.closeButton,children:e.jsx(G,{})})]}),e.jsxs("div",{style:s.tabs,children:[e.jsxs("button",{onClick:()=>m("games"),style:g==="games"?s.activeTab:s.tab,children:[e.jsx(R,{})," Games"]}),e.jsxs("button",{onClick:()=>m("leaderboard"),style:g==="leaderboard"?s.activeTab:s.tab,children:[e.jsx(B,{})," Leaderboard"]})]}),e.jsxs("div",{style:s.content,children:[g==="games"&&e.jsx("div",{style:s.gamesGrid,children:b.map(t=>e.jsxs("div",{style:s.gameCard,children:[e.jsx("span",{style:s.gameIcon,children:C[t.id]||"ðŸŽ®"}),e.jsx("h3",{style:s.gameName,children:t.name}),e.jsx("p",{style:s.gameDesc,children:t.description}),e.jsxs("div",{style:s.gameInfo,children:[e.jsxs("span",{children:[e.jsx(I,{})," ",t.min_players,"-",t.max_players]}),e.jsxs("span",{children:[e.jsx(z,{})," ",t.reward_coins]})]}),e.jsxs("button",{onClick:()=>k(t.id),style:s.playButton,disabled:w,children:[e.jsx(L,{})," Play"]})]},t.id))}),g==="playing"&&a&&e.jsx(q,{game:a,onAction:S}),g==="leaderboard"&&e.jsxs("div",{style:s.leaderboard,children:[y.map((t,d)=>e.jsxs("div",{style:s.leaderboardRow,children:[e.jsxs("span",{style:s.rank,children:["#",d+1]}),e.jsx("span",{style:s.playerName,children:t.username}),e.jsxs("span",{style:s.wins,children:[t.wins," wins"]}),e.jsxs("span",{style:s.totalScore,children:[t.total_score," pts"]})]},t.username)),y.length===0&&e.jsx("p",{style:s.emptyText,children:"No games played yet!"})]})]})]})})},q=({game:p,onAction:o})=>{const{game_type:l,state:r,players:b}=p;if(l==="trivia"){const n=r.questions?.[r.current_question];return e.jsxs("div",{style:s.gameArea,children:[e.jsxs("h3",{children:["Question ",r.current_question+1,"/",r.questions?.length]}),e.jsx("p",{style:s.question,children:n?.question}),e.jsx("div",{style:s.options,children:n?.options.map((a,i)=>e.jsx("button",{onClick:()=>o("answer",{answer:i}),style:s.optionButton,children:a},i))})]})}if(l==="tic_tac_toe")return e.jsxs("div",{style:s.gameArea,children:[e.jsx("h3",{children:"Tic Tac Toe"}),e.jsx("div",{style:s.ticTacToeBoard,children:r.board?.map((n,a)=>e.jsx("button",{onClick:()=>o("move",{position:a}),style:s.ticTacToeCell,disabled:n!==null,children:n===0?"âŒ":n===1?"â­•":""},a))})]});if(l==="number_guess"){const[n,a]=c.useState("");return e.jsxs("div",{style:s.gameArea,children:[e.jsx("h3",{children:"Guess the Number (1-100)"}),e.jsxs("p",{children:["Guesses left: ",r.max_guesses-(r.guesses?.length||0)]}),r.hints?.length>0&&e.jsxs("p",{children:["Last hint: Go ",r.hints[r.hints.length-1]]}),e.jsx("input",{type:"number",value:n,onChange:i=>a(i.target.value),style:s.guessInput,min:"1",max:"100"}),e.jsx("button",{onClick:()=>{o("guess",{number:parseInt(n)}),a("")},style:s.guessButton,children:"Guess!"})]})}if(l==="rock_paper_scissors")return e.jsxs("div",{style:s.gameArea,children:[e.jsxs("h3",{children:["Rock Paper Scissors - Round ",r.current_round,"/",r.max_rounds]}),e.jsx("div",{style:s.rpsButtons,children:["rock","paper","scissors"].map(n=>e.jsxs("button",{onClick:()=>o("choose",{choice:n}),style:s.rpsButton,children:[n==="rock"?"ðŸª¨":n==="paper"?"ðŸ“„":"âœ‚ï¸",e.jsx("span",{children:n})]},n))})]});if(l==="hangman"){const[n,a]=c.useState("");return e.jsxs("div",{style:s.gameArea,children:[e.jsx("h3",{children:"Hangman"}),e.jsx("p",{style:s.hangmanWord,children:r.display?.join(" ")}),e.jsxs("p",{children:["Wrong guesses: ",r.wrong_guesses,"/",r.max_wrong]}),e.jsxs("p",{children:["Used: ",r.guessed_letters?.join(", ")]}),e.jsx("input",{type:"text",value:n,onChange:i=>a(i.target.value.slice(-1).toUpperCase()),style:s.letterInput,maxLength:1}),e.jsx("button",{onClick:()=>{o("guess_letter",{letter:n}),a("")},style:s.guessButton,children:"Guess Letter"})]})}return e.jsxs("div",{style:s.gameArea,children:[e.jsxs("h3",{children:["Game: ",l]}),e.jsx("p",{children:"Game is in progress..."})]})},s={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e4},modal:{backgroundColor:"#2f3136",borderRadius:"12px",width:"700px",maxHeight:"85vh",overflow:"hidden",display:"flex",flexDirection:"column"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #40444b"},headerLeft:{display:"flex",alignItems:"center"},title:{margin:0,color:"#fff",fontSize:"20px"},closeButton:{background:"none",border:"none",color:"#b9bbbe",cursor:"pointer",fontSize:"20px"},tabs:{display:"flex",padding:"10px 20px",gap:"10px"},tab:{background:"#40444b",border:"none",color:"#b9bbbe",padding:"8px 16px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},activeTab:{background:"#5865f2",border:"none",color:"#fff",padding:"8px 16px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},content:{padding:"20px",overflowY:"auto",flex:1},gamesGrid:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"15px"},gameCard:{background:"#40444b",borderRadius:"10px",padding:"15px",textAlign:"center"},gameIcon:{fontSize:"40px"},gameName:{color:"#fff",margin:"10px 0 5px"},gameDesc:{color:"#b9bbbe",fontSize:"12px",marginBottom:"10px"},gameInfo:{display:"flex",justifyContent:"center",gap:"15px",color:"#b9bbbe",fontSize:"12px",marginBottom:"10px"},playButton:{background:"#5865f2",border:"none",color:"#fff",padding:"8px 20px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",margin:"0 auto"},gameArea:{textAlign:"center",color:"#fff"},question:{fontSize:"18px",marginBottom:"20px"},options:{display:"flex",flexDirection:"column",gap:"10px"},optionButton:{background:"#40444b",border:"none",color:"#fff",padding:"12px",borderRadius:"8px",cursor:"pointer",fontSize:"14px",transition:"background 0.2s"},ticTacToeBoard:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"5px",width:"200px",margin:"20px auto"},ticTacToeCell:{width:"60px",height:"60px",background:"#40444b",border:"none",borderRadius:"8px",fontSize:"30px",cursor:"pointer"},guessInput:{background:"#40444b",border:"none",color:"#fff",padding:"10px",borderRadius:"6px",width:"100px",textAlign:"center",fontSize:"18px"},guessButton:{background:"#5865f2",border:"none",color:"#fff",padding:"10px 20px",borderRadius:"6px",cursor:"pointer",marginLeft:"10px"},letterInput:{background:"#40444b",border:"none",color:"#fff",padding:"10px",borderRadius:"6px",width:"50px",textAlign:"center",fontSize:"24px",textTransform:"uppercase"},rpsButtons:{display:"flex",justifyContent:"center",gap:"20px"},rpsButton:{background:"#40444b",border:"none",color:"#fff",padding:"20px",borderRadius:"12px",cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",gap:"5px",fontSize:"40px"},hangmanWord:{fontSize:"32px",letterSpacing:"8px",marginBottom:"20px"},leaderboard:{display:"flex",flexDirection:"column",gap:"10px"},leaderboardRow:{display:"flex",alignItems:"center",gap:"15px",background:"#40444b",padding:"12px 15px",borderRadius:"8px"},rank:{color:"#faa61a",fontWeight:"bold",width:"40px"},playerName:{color:"#fff",flex:1},wins:{color:"#57f287"},totalScore:{color:"#b9bbbe"},emptyText:{color:"#72767d",textAlign:"center",padding:"40px"}};export{H as default};
