import{r,cb as w,l as B,aT as b,cq as _}from"./react-core-B6hadH-M.js";import{t as o}from"./index-D_6pZib5.js";const j=({fetchWithAuth:m,apiBaseUrl:u,roomSlug:y,onClose:i})=>{const[x,R]=r.useState("json"),[a,f]=r.useState({start_date:"",end_date:""}),[g,E]=r.useState(!1),[d,l]=r.useState(!1),[z,h]=r.useState(null),[c,k]=r.useState(null),v=[{value:"json",label:"JSON",icon:"ðŸ“‹"},{value:"csv",label:"CSV (Excel)",icon:"ðŸ“Š"},{value:"txt",label:"Text",icon:"ðŸ“„"},{value:"html",label:"HTML",icon:"ðŸŒ"}],S=async()=>{try{l(!0);const t=await m(`${u}/exports/create/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({room_slug:y,format:x,start_date:a.start_date||null,end_date:a.end_date||null,include_attachments:g})});if(t.ok){const n=await t.json();h(n.job_id),o.success("DÄ±ÅŸa aktarma baÅŸlatÄ±ldÄ±"),C(n.job_id)}else o.error("DÄ±ÅŸa aktarma baÅŸlatÄ±lamadÄ±"),l(!1)}catch(t){console.error("Export baÅŸlatma hatasÄ±:",t),o.error("Bir hata oluÅŸtu"),l(!1)}},C=async t=>{const n=setInterval(async()=>{try{const s=await m(`${u}/exports/${t}/status/`);if(s.ok){const p=await s.json();p.status==="completed"?(clearInterval(n),l(!1),k(p.download_url),o.success("DÄ±ÅŸa aktarma tamamlandÄ±!")):p.status==="failed"&&(clearInterval(n),l(!1),o.error("DÄ±ÅŸa aktarma baÅŸarÄ±sÄ±z oldu"))}}catch(s){clearInterval(n),l(!1),console.error("Status kontrol hatasÄ±:",s)}},2e3)},I=()=>{c&&(window.open(c,"_blank"),o.success("Ä°ndirme baÅŸlatÄ±ldÄ±"))};return React.createElement("div",{style:e.overlay,onClick:i},React.createElement("div",{style:e.modal,onClick:t=>t.stopPropagation()},React.createElement("div",{style:e.header},React.createElement("div",{style:{display:"flex",alignItems:"center",gap:"10px"}},React.createElement(w,{style:{color:"#43b581"}}),React.createElement("h2",{style:{margin:0}},"Sohbet GeÃ§miÅŸini DÄ±ÅŸa Aktar")),React.createElement(B,{onClick:i,style:e.closeBtn})),React.createElement("div",{style:e.content},c?React.createElement("div",{style:e.success},React.createElement("div",{style:e.successIcon},"âœ…"),React.createElement("h3",null,"DÄ±ÅŸa Aktarma TamamlandÄ±!"),React.createElement("p",null,"DosyanÄ±z hazÄ±r ve indirilebilir durumda."),React.createElement("button",{onClick:I,style:e.downloadBtn},React.createElement(b,null)," DosyayÄ± Ä°ndir")):React.createElement(React.Fragment,null,React.createElement("div",{style:e.field},React.createElement("label",{style:e.label},React.createElement(b,{style:{marginRight:"8px"}}),"Dosya FormatÄ±"),React.createElement("div",{style:e.formatGrid},v.map(t=>React.createElement("button",{key:t.value,onClick:()=>R(t.value),style:{...e.formatBtn,backgroundColor:x===t.value?"#5865f2":"#2c2f33"}},React.createElement("span",{style:{fontSize:"24px"}},t.icon),React.createElement("span",null,t.label))))),React.createElement("div",{style:e.field},React.createElement("label",{style:e.label},React.createElement(_,{style:{marginRight:"8px"}}),"Tarih AralÄ±ÄŸÄ± (opsiyonel)"),React.createElement("div",{style:e.dateRange},React.createElement("input",{type:"date",value:a.start_date,onChange:t=>f({...a,start_date:t.target.value}),style:e.dateInput,placeholder:"BaÅŸlangÄ±Ã§"}),React.createElement("span",{style:{color:"#888"}},"â†’"),React.createElement("input",{type:"date",value:a.end_date,onChange:t=>f({...a,end_date:t.target.value}),style:e.dateInput,placeholder:"BitiÅŸ"}))),React.createElement("div",{style:e.field},React.createElement("label",{style:e.checkboxLabel},React.createElement("input",{type:"checkbox",checked:g,onChange:t=>E(t.target.checked)}),React.createElement("span",null,"Ekleri de dahil et (dosya boyutu artabilir)"))),d&&React.createElement("div",{style:e.progress},React.createElement("div",{style:e.progressSpinner}),React.createElement("p",null,"Mesajlar iÅŸleniyor..."),React.createElement("p",{style:{fontSize:"12px",color:"#888"}},"Bu iÅŸlem birkaÃ§ dakika sÃ¼rebilir")))),!c&&React.createElement("div",{style:e.footer},React.createElement("button",{onClick:i,style:e.cancelBtn},"Ä°ptal"),React.createElement("button",{onClick:S,disabled:d,style:e.exportBtn},d?"Ä°ÅŸleniyor...":"DÄ±ÅŸa Aktar"))))},e={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999},modal:{backgroundColor:"#1e1e1e",borderRadius:"8px",width:"90%",maxWidth:"600px",maxHeight:"90vh",display:"flex",flexDirection:"column",color:"#fff"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #333"},closeBtn:{cursor:"pointer",fontSize:"24px",color:"#888"},content:{flex:1,overflowY:"auto",padding:"20px"},field:{marginBottom:"25px"},label:{display:"flex",alignItems:"center",marginBottom:"12px",color:"#dcddde",fontSize:"15px",fontWeight:"600"},formatGrid:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"12px"},formatBtn:{display:"flex",flexDirection:"column",alignItems:"center",gap:"8px",padding:"20px",border:"none",borderRadius:"8px",color:"#fff",cursor:"pointer",fontSize:"14px",fontWeight:"500",transition:"background-color 0.2s"},dateRange:{display:"flex",alignItems:"center",gap:"12px"},dateInput:{flex:1,padding:"10px",backgroundColor:"#2c2f33",border:"1px solid #444",borderRadius:"4px",color:"#fff",fontSize:"14px"},checkboxLabel:{display:"flex",alignItems:"center",gap:"10px",cursor:"pointer",fontSize:"14px"},progress:{textAlign:"center",padding:"30px",backgroundColor:"#2c2f33",borderRadius:"8px"},progressSpinner:{width:"50px",height:"50px",border:"4px solid #333",borderTop:"4px solid #5865f2",borderRadius:"50%",animation:"spin 1s linear infinite",margin:"0 auto 15px"},success:{textAlign:"center",padding:"40px"},successIcon:{fontSize:"64px",marginBottom:"20px"},downloadBtn:{backgroundColor:"#43b581",color:"#fff",border:"none",padding:"15px 30px",borderRadius:"4px",cursor:"pointer",fontSize:"16px",fontWeight:"600",display:"inline-flex",alignItems:"center",gap:"10px",marginTop:"20px"},footer:{display:"flex",gap:"10px",padding:"20px",borderTop:"1px solid #333"},cancelBtn:{flex:1,backgroundColor:"#2c2f33",color:"#fff",border:"none",padding:"12px",borderRadius:"4px",cursor:"pointer",fontSize:"16px",fontWeight:"600"},exportBtn:{flex:1,backgroundColor:"#43b581",color:"#fff",border:"none",padding:"12px",borderRadius:"4px",cursor:"pointer",fontSize:"16px",fontWeight:"600"}};export{j as default};
