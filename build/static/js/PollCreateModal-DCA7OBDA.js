var R=Object.defineProperty;var r=(s,p)=>R(s,"name",{value:p,configurable:!0});import{r as i,j as e}from"./react-core-Djgtqrmb.js";import{a as E,f as P,an as T}from"./icons-vendor-BW7dxHkX.js";import{c as A}from"./index-D_luy7FO.js";import"./media-vendor-CxFPycob.js";import"./router-vendor-gmJ9Mn-1.js";import"./state-vendor-BRqaXHJQ.js";import"./crypto-vendor-D1XRGppi.js";import"./ui-vendor-IhB9Znpc.js";const J=r(({onClose:s,fetchWithAuth:p,apiBaseUrl:y,activeRoomSlug:m})=>{const[d,j]=i.useState(""),[l,c]=i.useState(["",""]),[h,k]=i.useState(!1),[u,v]=i.useState("3600"),[x,b]=i.useState(!1),[f,a]=i.useState(null),{overlayProps:C,dialogProps:S}=A({onClose:s,isOpen:!0,label:"Create Poll"}),w=r((t,n)=>{const o=[...l];o[t]=n,c(o)},"handleOptionChange"),O=r(()=>{l.length<10&&c([...l,""])},"addOption"),I=r(t=>{if(l.length>2){const n=l.filter((o,g)=>g!==t);c(n)}},"removeOption"),z=r(async t=>{if(t.preventDefault(),a(null),!d.trim()){a("Soru boş olamaz.");return}const n=l.filter(o=>o.trim()!=="");if(n.length<2){a("En az 2 seçenek girmelisiniz.");return}b(!0);try{const o=await p(`${y}/polls/create/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({room_slug:m,question:d,options:n,allow_multiple:h,expires_in:u?parseInt(u):null})});if(o.ok)s();else{const g=await o.json();a(g.error||"Anket oluşturulamadı.")}}catch(o){a("Bir hata oluştu: "+o.message)}finally{b(!1)}},"handleSubmit");return e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},...C,children:e.jsxs("div",{style:{backgroundColor:"#36393f",padding:"20px",borderRadius:"8px",width:"400px",maxWidth:"90%",color:"white",display:"flex",flexDirection:"column",gap:"15px"},...S,children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h3",{style:{margin:0},children:"Anket Oluştur"}),e.jsx("button",{onClick:s,style:{background:"none",border:"none",color:"#b9bbbe",cursor:"pointer"},children:e.jsx(E,{})})]}),f&&e.jsx("div",{style:{color:"#ed4245",fontSize:"14px"},children:f}),e.jsx("input",{type:"text",placeholder:"Soru ne?",value:d,onChange:r(t=>j(t.target.value),"onChange"),style:{padding:"10px",borderRadius:"4px",border:"none",backgroundColor:"#202225",color:"white"}}),e.jsx("div",{style:{maxHeight:"200px",overflowY:"auto",display:"flex",flexDirection:"column",gap:"8px"},children:l.map((t,n)=>e.jsxs("div",{style:{display:"flex",gap:"5px"},children:[e.jsx("input",{type:"text",placeholder:`Seçenek ${n+1}`,value:t,onChange:r(o=>w(n,o.target.value),"onChange"),style:{flex:1,padding:"8px",borderRadius:"4px",border:"none",backgroundColor:"#202225",color:"white"}}),l.length>2&&e.jsx("button",{onClick:r(()=>I(n),"onClick"),style:{background:"none",border:"none",color:"#ed4245",cursor:"pointer"},children:e.jsx(P,{})})]},n))}),l.length<10&&e.jsxs("button",{onClick:O,style:{display:"flex",alignItems:"center",gap:"5px",background:"none",border:"none",color:"#3ba55d",cursor:"pointer",alignSelf:"flex-start"},children:[e.jsx(T,{})," Seçenek Ekle"]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"10px",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:h,onChange:r(t=>k(t.target.checked),"onChange")}),"Birden çok seçime izin ver"]}),e.jsxs("select",{value:u,onChange:r(t=>v(t.target.value),"onChange"),style:{padding:"8px",borderRadius:"4px",backgroundColor:"#202225",color:"white",border:"none"},children:[e.jsx("option",{value:"3600",children:"1 Saat"}),e.jsx("option",{value:"86400",children:"24 Saat"}),e.jsx("option",{value:"604800",children:"1 Hafta"}),e.jsx("option",{value:"",children:"Süresiz"})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"10px"},children:[e.jsx("button",{onClick:s,style:{padding:"10px 20px",borderRadius:"4px",border:"none",backgroundColor:"transparent",color:"white",cursor:"pointer"},children:"İptal"}),e.jsx("button",{onClick:z,disabled:x,style:{padding:"10px 20px",borderRadius:"4px",border:"none",backgroundColor:"#5865f2",color:"white",cursor:"pointer",opacity:x?.7:1},children:x?"Oluşturuluyor...":"Oluştur"})]})]})})},"PollCreateModal");export{J as default};
