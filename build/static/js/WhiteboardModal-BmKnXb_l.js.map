{"version":3,"file":"WhiteboardModal-BmKnXb_l.js","sources":["../../../src/components/WhiteboardModal.js"],"sourcesContent":["// frontend/src/components/WhiteboardModal.js\r\n\r\nimport { useRef, useState, useEffect } from 'react';\r\nimport { FaTimes, FaEraser, FaPen, FaTrash } from 'react-icons/fa';\r\n\r\nconst WhiteboardModal = ({ roomSlug, onClose, wsProtocol, apiHost }) => {\r\n    const canvasRef = useRef(null);\r\n    const ws = useRef(null);\r\n    const [isDrawing, setIsDrawing] = useState(false);\r\n    const [color, setColor] = useState('#000000');\r\n    const [lineWidth, setLineWidth] = useState(3);\r\n\r\n    // WebSocket BaÄŸlantÄ±sÄ±\r\n    useEffect(() => {\r\n        const url = `${wsProtocol}://${apiHost}/ws/whiteboard/${roomSlug}/`;\r\n        ws.current = new WebSocket(url);\r\n\r\n        ws.current.onmessage = (event) => {\r\n            const { x, y, type, color: remoteColor, width: remoteWidth, prevX, prevY } = JSON.parse(event.data);\r\n            const ctx = canvasRef.current.getContext('2d');\r\n\r\n            if (type === 'draw') {\r\n                ctx.beginPath();\r\n                ctx.moveTo(prevX, prevY);\r\n                ctx.lineTo(x, y);\r\n                ctx.strokeStyle = remoteColor;\r\n                ctx.lineWidth = remoteWidth;\r\n                ctx.lineCap = 'round';\r\n                ctx.stroke();\r\n            } else if (type === 'clear') {\r\n                ctx.clearRect(0, 0, canvasRef.current.width, canvasRef.current.height);\r\n            }\r\n        };\r\n\r\n        return () => ws.current.close();\r\n    }, [roomSlug, wsProtocol, apiHost]);\r\n\r\n    useEffect(() => {\r\n        const handleEsc = (e) => { if (e.key === 'Escape') onClose(); };\r\n        window.addEventListener('keydown', handleEsc);\r\n        return () => window.removeEventListener('keydown', handleEsc);\r\n    }, [onClose]);\r\n\r\n    // Canvas BoyutlandÄ±rma\r\n    useEffect(() => {\r\n        const canvas = canvasRef.current;\r\n        canvas.width = 800;\r\n        canvas.height = 600;\r\n        // Arka planÄ± beyaz yap (kaydederken ÅŸeffaf olmasÄ±n diye)\r\n        const ctx = canvas.getContext('2d');\r\n        ctx.fillStyle = \"white\";\r\n        ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n    }, []);\r\n\r\n    const startDrawing = ({ nativeEvent }) => {\r\n        const { offsetX, offsetY } = nativeEvent;\r\n        setIsDrawing(true);\r\n        canvasRef.current.lastX = offsetX;\r\n        canvasRef.current.lastY = offsetY;\r\n    };\r\n\r\n    const draw = ({ nativeEvent }) => {\r\n        if (!isDrawing) return;\r\n        const { offsetX, offsetY } = nativeEvent;\r\n        const ctx = canvasRef.current.getContext('2d');\r\n\r\n        // Ã‡iz\r\n        ctx.beginPath();\r\n        ctx.moveTo(canvasRef.current.lastX, canvasRef.current.lastY);\r\n        ctx.lineTo(offsetX, offsetY);\r\n        ctx.strokeStyle = color;\r\n        ctx.lineWidth = lineWidth;\r\n        ctx.lineCap = 'round';\r\n        ctx.stroke();\r\n\r\n        // GÃ¶nder\r\n        if (ws.current.readyState === WebSocket.OPEN) {\r\n            ws.current.send(JSON.stringify({\r\n                type: 'draw',\r\n                x: offsetX,\r\n                y: offsetY,\r\n                prevX: canvasRef.current.lastX,\r\n                prevY: canvasRef.current.lastY,\r\n                color,\r\n                width: lineWidth\r\n            }));\r\n        }\r\n\r\n        canvasRef.current.lastX = offsetX;\r\n        canvasRef.current.lastY = offsetY;\r\n    };\r\n\r\n    const stopDrawing = () => {\r\n        setIsDrawing(false);\r\n    };\r\n\r\n    const clearBoard = () => {\r\n        const ctx = canvasRef.current.getContext('2d');\r\n        ctx.fillStyle = \"white\";\r\n        ctx.fillRect(0, 0, canvasRef.current.width, canvasRef.current.height);\r\n        ws.current.send(JSON.stringify({ type: 'clear' }));\r\n    };\r\n\r\n    return (\r\n        <div style={styles.overlay} onClick={onClose}>\r\n            <div style={styles.modal} onClick={e => e.stopPropagation()}>\r\n                <div style={styles.header}>\r\n                    <h3>ðŸŽ¨ Ortak Ã‡izim TahtasÄ±</h3>\r\n                    <button onClick={onClose} style={styles.closeBtn}><FaTimes /></button>\r\n                </div>\r\n\r\n                <div style={styles.toolbar}>\r\n                    <input type=\"color\" value={color} onChange={e => setColor(e.target.value)} style={styles.colorPicker} />\r\n                    <input type=\"range\" min=\"1\" max=\"20\" value={lineWidth} onChange={e => setLineWidth(e.target.value)} />\r\n                    <button onClick={() => setColor('#ffffff')} style={styles.toolBtn}><FaEraser /></button>\r\n                    <button onClick={() => setColor('#000000')} style={styles.toolBtn}><FaPen /></button>\r\n                    <button onClick={clearBoard} style={{ ...styles.toolBtn, color: 'red' }}><FaTrash /></button>\r\n                </div>\r\n\r\n                <div style={styles.canvasContainer}>\r\n                    <canvas\r\n                        ref={canvasRef}\r\n                        onMouseDown={startDrawing}\r\n                        onMouseMove={draw}\r\n                        onMouseUp={stopDrawing}\r\n                        onMouseLeave={stopDrawing}\r\n                        style={styles.canvas}\r\n                    />\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst styles = {\r\n    overlay: { position: 'fixed', top: 0, left: 0, width: '100%', height: '100%', backgroundColor: 'rgba(0,0,0,0.85)', zIndex: 3000, display: 'flex', justifyContent: 'center', alignItems: 'center' },\r\n    modal: { backgroundColor: '#2b2d31', borderRadius: '12px', padding: '10px', display: 'flex', flexDirection: 'column', gap: '10px' },\r\n    header: { display: 'flex', justifyContent: 'space-between', color: 'white', padding: '0 10px' },\r\n    closeBtn: { background: 'none', border: 'none', color: 'white', fontSize: '1.5em', cursor: 'pointer' },\r\n    toolbar: { display: 'flex', gap: '10px', alignItems: 'center', backgroundColor: '#1e1f22', padding: '10px', borderRadius: '8px' },\r\n    canvasContainer: { border: '1px solid #1e1f22', borderRadius: '4px', overflow: 'hidden', backgroundColor: 'white' },\r\n    canvas: { cursor: 'crosshair', touchAction: 'none' },\r\n    toolBtn: { background: 'none', border: 'none', color: '#ccc', fontSize: '1.2em', cursor: 'pointer' },\r\n    colorPicker: { border: 'none', width: '30px', height: '30px', cursor: 'pointer', padding: 0 }\r\n};\r\n\r\nexport default WhiteboardModal;\r\n\r\n"],"names":["useRef","useState","useEffect","jsxs","jsx"],"mappings":"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"}