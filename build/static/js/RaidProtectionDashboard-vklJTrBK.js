var O=Object.defineProperty;var a=(s,i)=>O(s,"name",{value:i,configurable:!0});import{r as h,j as e}from"./react-core-Djgtqrmb.js";import{a1 as L,bf as H,h as V,ay as T,a9 as K,d as R,a0 as E,z as P,az as z,a as I,O as M,b9 as S,aB as A,u as J}from"./icons-vendor-BW7dxHkX.js";import{t as N}from"./index-m2zCEI_Z.js";import"./media-vendor-CxFPycob.js";import"./router-vendor-gmJ9Mn-1.js";import"./state-vendor-BRqaXHJQ.js";import"./crypto-vendor-D1XRGppi.js";import"./ui-vendor-IhB9Znpc.js";const Y=a(s=>{switch(s){case"join":return"ğŸ‘‹";case"leave":return"ğŸšª";case"kick":return"ğŸ‘¢";case"ban":return"ğŸ”¨";case"suspicious":return"âš ï¸";case"raid_detected":return"ğŸš¨";case"verified":return"âœ…";default:return"ğŸ“‹"}},"getActivityIcon"),q=a(s=>{switch(s){case"join":return"#23a559";case"leave":return"#f0b132";case"kick":case"ban":return"#da373c";case"suspicious":case"raid_detected":return"#f0b132";case"verified":return"#5865f2";default:return"#72767d"}},"getActivityColor"),G=a(s=>new Date(s).toLocaleTimeString("tr-TR",{hour:"2-digit",minute:"2-digit"}),"formatTime"),U=a((s,i)=>{const[j,t]=h.useState("overview"),[o,d]=h.useState({enabled:!1,lockdown_active:!1}),[m,x]=h.useState([]),[u,g]=h.useState([]),[f,_]=h.useState([]),[k,y]=h.useState({join_rate_limit:10,join_time_window:60,mention_limit:10,message_rate_limit:15,new_account_threshold:7,auto_ban_suspicious:!1,captcha_on_join:!1,dm_on_join_warning:!0}),[b,v]=h.useState(!0),[w,n]=h.useState({blocked_today:0,verified_today:0,raids_detected:0,suspicious_accounts:0}),p=h.useRef(null),C=a(async()=>{try{const c=localStorage.getItem("access_token"),l=await fetch(`${i}/moderation/raid-protection/status/?server_id=${s}`,{headers:{Authorization:`Bearer ${c}`}});if(l.ok){const r=await l.json();d(r.status||r),r.settings&&y(r.settings),r.stats&&n(r.stats)}}catch{}},"fetchProtectionStatus"),$=a(async()=>{try{const c=localStorage.getItem("access_token"),l=await fetch(`${i}/moderation/raid-protection/activity/?server_id=${s}`,{headers:{Authorization:`Bearer ${c}`}});if(l.ok){const r=await l.json();x(r.activities||[])}}catch{}},"fetchRecentActivity"),F=a(async()=>{try{const c=localStorage.getItem("access_token"),l=await fetch(`${i}/moderation/raid-protection/pending/?server_id=${s}`,{headers:{Authorization:`Bearer ${c}`}});if(l.ok){const r=await l.json();g(r.pending||[])}}catch{}},"fetchPendingVerifications"),B=a(async()=>{try{const c=localStorage.getItem("access_token"),l=await fetch(`${i}/moderation/raid-protection/logs/?server_id=${s}`,{headers:{Authorization:`Bearer ${c}`}});if(l.ok){const r=await l.json();_(r.logs||[])}}catch{}},"fetchRaidLogs");return h.useEffect(()=>{a(async()=>{v(!0),await Promise.all([C(),$(),F(),B()]),v(!1)},"loadData")();const l=setInterval($,5e3);return()=>clearInterval(l)},[s]),{view:j,setView:t,protectionStatus:o,recentActivity:m,pendingVerifications:u,raidLogs:f,settings:k,setSettings:y,loading:b,stats:w,activityRef:p,handleToggleProtection:a(async()=>{try{const c=localStorage.getItem("access_token");(await fetch(`${i}/moderation/raid-protection/toggle/`,{method:"POST",headers:{Authorization:`Bearer ${c}`,"Content-Type":"application/json"},body:JSON.stringify({server_id:s,enabled:!o.enabled})})).ok&&(d({...o,enabled:!o.enabled}),N.success(o.enabled?"âš ï¸ Koruma kapatÄ±ldÄ±":"ğŸ›¡ï¸ Koruma aktif!"))}catch{}},"handleToggleProtection"),handleLockdown:a(async()=>{try{const c=localStorage.getItem("access_token"),l=o.lockdown_active?"unlock":"lockdown";(await fetch(`${i}/moderation/raid-protection/${l}/`,{method:"POST",headers:{Authorization:`Bearer ${c}`,"Content-Type":"application/json"},body:JSON.stringify({server_id:s})})).ok&&(d({...o,lockdown_active:!o.lockdown_active}),N.success(o.lockdown_active?"ğŸ”“ Sunucu kilidi aÃ§Ä±ldÄ±":"ğŸ”’ Sunucu kilitlendi!"))}catch{}},"handleLockdown"),handleVerifyUser:a(async(c,l)=>{try{const r=localStorage.getItem("access_token");(await fetch(`${i}/moderation/raid-protection/verify/`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"},body:JSON.stringify({server_id:s,user_id:c,action:l})})).ok&&(g(u.filter(D=>D.id!==c)),N.success(l==="approve"?"âœ… KullanÄ±cÄ± onaylandÄ±":"âŒ KullanÄ±cÄ± reddedildi"))}catch{}},"handleVerifyUser"),handleSaveSettings:a(async()=>{try{const c=localStorage.getItem("access_token");(await fetch(`${i}/moderation/raid-protection/settings/`,{method:"PUT",headers:{Authorization:`Bearer ${c}`,"Content-Type":"application/json"},body:JSON.stringify({server_id:s,...k})})).ok&&N.success("âœ… Ayarlar kaydedildi!")}catch{}},"handleSaveSettings")}},"useRaidProtectionDashboard"),Q=a(({protectionStatus:s,stats:i,recentActivity:j,activityRef:t,handleToggleProtection:o,handleLockdown:d})=>e.jsxs("div",{className:"overview-view",children:[e.jsxs("div",{className:"quick-actions",children:[e.jsxs("button",{className:`action-btn ${s.enabled?"enabled":""}`,onClick:o,children:[e.jsx(L,{}),s.enabled?"KorumayÄ± Kapat":"KorumayÄ± AÃ§"]}),e.jsxs("button",{className:`action-btn lockdown ${s.lockdown_active?"active":""}`,onClick:d,children:[s.lockdown_active?e.jsx(H,{}):e.jsx(V,{}),s.lockdown_active?"Kilidi AÃ§":"Sunucuyu Kilitle"]})]}),e.jsxs("div",{className:"stats-grid",children:[e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon blocked",children:e.jsx(T,{})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("span",{className:"stat-value",children:i.blocked_today}),e.jsx("span",{className:"stat-label",children:"BugÃ¼n Engellenen"})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon verified",children:e.jsx(K,{})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("span",{className:"stat-value",children:i.verified_today}),e.jsx("span",{className:"stat-label",children:"BugÃ¼n DoÄŸrulanan"})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon raids",children:e.jsx(R,{})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("span",{className:"stat-value",children:i.raids_detected}),e.jsx("span",{className:"stat-label",children:"Tespit Edilen Raid"})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon suspicious",children:e.jsx(E,{})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("span",{className:"stat-value",children:i.suspicious_accounts}),e.jsx("span",{className:"stat-label",children:"ÅÃ¼pheli Hesap"})]})]})]}),e.jsxs("div",{className:"activity-section",children:[e.jsxs("h3",{children:[e.jsx(P,{})," CanlÄ± Aktivite"]}),e.jsx("div",{className:"activity-feed",ref:t,children:j.length>0?j.map((m,x)=>e.jsxs("div",{className:"activity-item",style:{borderLeftColor:q(m.type)},children:[e.jsx("span",{className:"activity-icon",children:Y(m.type)}),e.jsxs("div",{className:"activity-info",children:[e.jsx("span",{className:"activity-user",children:m.username}),e.jsx("span",{className:"activity-action",children:m.description})]}),e.jsx("span",{className:"activity-time",children:G(m.timestamp)})]},x)):e.jsx("div",{className:"no-activity",children:e.jsx("p",{children:"HenÃ¼z aktivite yok"})})})]})]}),"OverviewView"),W=a(({settings:s,setSettings:i,handleSaveSettings:j})=>e.jsxs("div",{className:"settings-view",children:[e.jsxs("h3",{children:[e.jsx(z,{})," Koruma AyarlarÄ±"]}),e.jsxs("div",{className:"settings-section",children:[e.jsx("h4",{children:"KatÄ±lÄ±m Limitleri"}),e.jsxs("div",{className:"setting-item",children:[e.jsxs("div",{className:"setting-info",children:[e.jsx("label",{children:"KatÄ±lÄ±m HÄ±z Limiti"}),e.jsx("p",{children:"Belirli sÃ¼re iÃ§inde maksimum katÄ±lÄ±m sayÄ±sÄ±"})]}),e.jsxs("div",{className:"setting-control",children:[e.jsx("input",{type:"number",value:s.join_rate_limit,onChange:a(t=>i({...s,join_rate_limit:parseInt(t.target.value)}),"onChange"),min:"1",max:"100"}),e.jsx("span",{children:"kiÅŸi /"}),e.jsx("input",{type:"number",value:s.join_time_window,onChange:a(t=>i({...s,join_time_window:parseInt(t.target.value)}),"onChange"),min:"10",max:"300"}),e.jsx("span",{children:"saniye"})]})]}),e.jsxs("div",{className:"setting-item",children:[e.jsxs("div",{className:"setting-info",children:[e.jsx("label",{children:"Yeni Hesap EÅŸiÄŸi"}),e.jsx("p",{children:"Bu gÃ¼nden eski hesaplar ÅŸÃ¼pheli sayÄ±lÄ±r"})]}),e.jsxs("div",{className:"setting-control",children:[e.jsx("input",{type:"number",value:s.new_account_threshold,onChange:a(t=>i({...s,new_account_threshold:parseInt(t.target.value)}),"onChange"),min:"1",max:"30"}),e.jsx("span",{children:"gÃ¼n"})]})]})]}),e.jsxs("div",{className:"settings-section",children:[e.jsx("h4",{children:"Mesaj Limitleri"}),e.jsxs("div",{className:"setting-item",children:[e.jsxs("div",{className:"setting-info",children:[e.jsx("label",{children:"Mention Limiti"}),e.jsx("p",{children:"Bir mesajdaki maksimum mention sayÄ±sÄ±"})]}),e.jsx("div",{className:"setting-control",children:e.jsx("input",{type:"number",value:s.mention_limit,onChange:a(t=>i({...s,mention_limit:parseInt(t.target.value)}),"onChange"),min:"1",max:"50"})})]}),e.jsxs("div",{className:"setting-item",children:[e.jsxs("div",{className:"setting-info",children:[e.jsx("label",{children:"Mesaj HÄ±z Limiti"}),e.jsx("p",{children:"10 saniyede maksimum mesaj sayÄ±sÄ±"})]}),e.jsx("div",{className:"setting-control",children:e.jsx("input",{type:"number",value:s.message_rate_limit,onChange:a(t=>i({...s,message_rate_limit:parseInt(t.target.value)}),"onChange"),min:"1",max:"50"})})]})]}),e.jsxs("div",{className:"settings-section",children:[e.jsx("h4",{children:"Otomatik Aksiyonlar"}),e.jsxs("div",{className:"setting-item toggle",children:[e.jsxs("div",{className:"setting-info",children:[e.jsx("label",{children:"ÅÃ¼pheli HesaplarÄ± Otomatik Banla"}),e.jsx("p",{children:"Raid tespit edildiÄŸinde ÅŸÃ¼pheli hesaplarÄ± otomatik banla"})]}),e.jsxs("label",{className:"toggle-switch",children:[e.jsx("input",{type:"checkbox",checked:s.auto_ban_suspicious,onChange:a(t=>i({...s,auto_ban_suspicious:t.target.checked}),"onChange")}),e.jsx("span",{className:"slider"})]})]}),e.jsxs("div",{className:"setting-item toggle",children:[e.jsxs("div",{className:"setting-info",children:[e.jsx("label",{children:"KatÄ±lÄ±mda CAPTCHA"}),e.jsx("p",{children:"Yeni Ã¼yeler katÄ±lÄ±rken CAPTCHA doÄŸrulamasÄ± iste"})]}),e.jsxs("label",{className:"toggle-switch",children:[e.jsx("input",{type:"checkbox",checked:s.captcha_on_join,onChange:a(t=>i({...s,captcha_on_join:t.target.checked}),"onChange")}),e.jsx("span",{className:"slider"})]})]}),e.jsxs("div",{className:"setting-item toggle",children:[e.jsxs("div",{className:"setting-info",children:[e.jsx("label",{children:"KatÄ±lÄ±m UyarÄ± DM"}),e.jsx("p",{children:"ÅÃ¼pheli hesap katÄ±ldÄ±ÄŸÄ±nda yÃ¶neticilere DM gÃ¶nder"})]}),e.jsxs("label",{className:"toggle-switch",children:[e.jsx("input",{type:"checkbox",checked:s.dm_on_join_warning,onChange:a(t=>i({...s,dm_on_join_warning:t.target.checked}),"onChange")}),e.jsx("span",{className:"slider"})]})]})]}),e.jsx("div",{className:"settings-actions",children:e.jsx("button",{className:"save-btn",onClick:j,children:"AyarlarÄ± Kaydet"})})]}),"SettingsView"),me=a(({serverId:s,onClose:i,apiBaseUrl:j})=>{const{view:t,setView:o,protectionStatus:d,recentActivity:m,pendingVerifications:x,raidLogs:u,settings:g,setSettings:f,stats:_,activityRef:k,handleToggleProtection:y,handleLockdown:b,handleVerifyUser:v,handleSaveSettings:w}=U(s,j);return e.jsx("div",{className:"raid-dashboard-overlay",onClick:i,children:e.jsxs("div",{className:"raid-dashboard",onClick:a(n=>n.stopPropagation(),"onClick"),children:[e.jsxs("div",{className:"dashboard-header",children:[e.jsxs("h2",{children:[e.jsx(L,{})," Raid Koruma Paneli"]}),e.jsxs("div",{className:"header-status",children:[e.jsx("span",{className:`status-badge ${d.enabled?"active":"inactive"}`,children:d.enabled?"ğŸ›¡ï¸ Koruma Aktif":"âš ï¸ Koruma KapalÄ±"}),d.lockdown_active&&e.jsx("span",{className:"status-badge lockdown",children:"ğŸ”’ Lockdown"})]}),e.jsx("button",{className:"close-btn",onClick:i,children:e.jsx(I,{})})]}),e.jsxs("div",{className:"dashboard-nav",children:[e.jsxs("button",{className:`nav-btn ${t==="overview"?"active":""}`,onClick:a(()=>o("overview"),"onClick"),children:[e.jsx(M,{})," Genel BakÄ±ÅŸ"]}),e.jsxs("button",{className:`nav-btn ${t==="verify"?"active":""}`,onClick:a(()=>o("verify"),"onClick"),children:[e.jsx(S,{})," DoÄŸrulama",x.length>0&&e.jsx("span",{className:"badge",children:x.length})]}),e.jsxs("button",{className:`nav-btn ${t==="logs"?"active":""}`,onClick:a(()=>o("logs"),"onClick"),children:[e.jsx(A,{})," Loglar"]}),e.jsxs("button",{className:`nav-btn ${t==="settings"?"active":""}`,onClick:a(()=>o("settings"),"onClick"),children:[e.jsx(z,{})," Ayarlar"]})]}),e.jsxs("div",{className:"dashboard-content",children:[t==="overview"&&e.jsx(Q,{protectionStatus:d,stats:_,recentActivity:m,activityRef:k,handleToggleProtection:y,handleLockdown:b}),t==="verify"&&e.jsxs("div",{className:"verify-view",children:[e.jsxs("h3",{children:[e.jsx(S,{})," Bekleyen DoÄŸrulamalar"]}),x.length>0?e.jsx("div",{className:"verifications-list",children:x.map(n=>e.jsxs("div",{className:"verification-card",children:[e.jsx("img",{src:n.avatar||"/default-avatar.png",alt:n.username,className:"user-avatar"}),e.jsxs("div",{className:"user-info",children:[e.jsx("h4",{children:n.username}),e.jsxs("div",{className:"user-meta",children:[e.jsxs("span",{children:[e.jsx(P,{})," KatÄ±lÄ±m: ",new Date(n.joined_at).toLocaleDateString("tr-TR")]}),e.jsxs("span",{children:[e.jsx(J,{})," Hesap: ",n.account_age_days," gÃ¼n"]})]}),n.suspicious_reasons&&e.jsxs("div",{className:"suspicious-reasons",children:[e.jsx(R,{}),n.suspicious_reasons.map((p,C)=>e.jsx("span",{className:"reason-tag",children:p},C))]})]}),e.jsxs("div",{className:"verification-actions",children:[e.jsxs("button",{className:"approve-btn",onClick:a(()=>v(n.id,"approve"),"onClick"),children:[e.jsx(K,{})," Onayla"]}),e.jsxs("button",{className:"reject-btn",onClick:a(()=>v(n.id,"reject"),"onClick"),children:[e.jsx(T,{})," Reddet"]})]})]},n.id))}):e.jsxs("div",{className:"no-verifications",children:[e.jsx(S,{className:"empty-icon"}),e.jsx("p",{children:"Bekleyen doÄŸrulama yok"})]})]}),t==="logs"&&e.jsxs("div",{className:"logs-view",children:[e.jsxs("h3",{children:[e.jsx(A,{})," Raid LoglarÄ±"]}),u.length>0?e.jsx("div",{className:"logs-list",children:u.map((n,p)=>e.jsxs("div",{className:`log-item ${n.severity}`,children:[e.jsxs("div",{className:"log-header",children:[e.jsxs("span",{className:"log-type",children:[n.type==="raid_detected"&&"ğŸš¨ Raid Tespit Edildi",n.type==="mass_ban"&&"ğŸ”¨ Toplu Ban",n.type==="lockdown"&&"ğŸ”’ Lockdown",n.type==="unlock"&&"ğŸ”“ Kilit AÃ§Ä±ldÄ±",n.type==="suspicious_activity"&&"âš ï¸ ÅÃ¼pheli Aktivite"]}),e.jsx("span",{className:"log-time",children:new Date(n.timestamp).toLocaleString("tr-TR")})]}),e.jsx("p",{className:"log-description",children:n.description}),n.affected_users&&e.jsxs("span",{className:"affected-count",children:[n.affected_users," kullanÄ±cÄ± etkilendi"]})]},p))}):e.jsxs("div",{className:"no-logs",children:[e.jsx(A,{className:"empty-icon"}),e.jsx("p",{children:"HenÃ¼z log kaydÄ± yok"})]})]}),t==="settings"&&e.jsx(W,{settings:g,setSettings:f,handleSaveSettings:w})]})]})})},"RaidProtectionDashboard");export{me as default};
