import{r as n,n as e}from"./react-core-zXIKm1Jm.js";import{c5 as A,a as E,aa as B,bp as O,bc as z,t as J,D as M,b1 as q}from"./icons-vendor-BBdoVeJd.js";import{t as s}from"./index-BcyeUaJO.js";import"./editor-vendor-DiU449Dh.js";import"./media-vendor-BSOZ7IB3.js";import"./router-vendor-PJALNo1v.js";import"./crypto-vendor-D_AcF0lD.js";import"./state-vendor-8NbFPBhQ.js";const U=({fetchWithAuth:d,apiBaseUrl:l,onClose:I,serverId:y})=>{const[g,R]=n.useState([]),[i,h]=n.useState(null),[v,N]=n.useState([]),[o,j]=n.useState(null),[p,c]=n.useState("projects"),[x,m]=n.useState(!1),[f,C]=n.useState(""),[S,D]=n.useState(""),[b,k]=n.useState(""),[w,T]=n.useState("");n.useEffect(()=>{P()},[]);const P=async()=>{try{const a=await(await d(`${l}/projects/?server_id=${y}`)).json();R(a.projects||[])}catch(r){console.error("Failed to fetch projects:",r)}},F=async r=>{try{const u=await(await d(`${l}/projects/${r}/`)).json();h(u.project),N(u.documents||[]),c("project-detail")}catch{s.error("Failed to load project")}},H=async()=>{if(!f.trim()){s.error("Project name required");return}m(!0);try{(await(await d(`${l}/projects/create/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:f,description:S,server_id:y})})).json()).project&&(s.success("Project created!"),C(""),D(""),c("projects"),P())}catch{s.error("Failed to create project")}finally{m(!1)}},$=async()=>{if(!b.trim()){s.error("Document title required");return}m(!0);try{(await(await d(`${l}/documents/create/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:b,content:w,project_id:i?.id})})).json()).document&&(s.success("Document created!"),k(""),T(""),F(i.id))}catch{s.error("Failed to create document")}finally{m(!1)}},L=async r=>{try{const u=await(await d(`${l}/documents/${r}/`)).json();j(u.document),c("document")}catch{s.error("Failed to load document")}},_=async()=>{if(o)try{await d(`${l}/documents/${o.id}/`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:o.content})}),s.success("Document saved!")}catch{s.error("Failed to save document")}};return e.jsx("div",{style:t.overlay,children:e.jsxs("div",{style:t.modal,children:[e.jsxs("div",{style:t.header,children:[e.jsxs("div",{style:t.headerLeft,children:[e.jsx(A,{style:{marginRight:"10px",color:"#5865f2"}}),e.jsx("h2",{style:t.title,children:"Project Collaboration"})]}),e.jsx("button",{onClick:I,style:t.closeButton,children:e.jsx(E,{})})]}),e.jsxs("div",{style:t.breadcrumbs,children:[e.jsx("button",{onClick:()=>{c("projects"),h(null)},style:t.breadcrumb,children:"Projects"}),i&&e.jsxs(e.Fragment,{children:[e.jsx("span",{style:t.breadcrumbSep,children:"/"}),e.jsx("button",{onClick:()=>c("project-detail"),style:t.breadcrumb,children:i.name})]}),o&&e.jsxs(e.Fragment,{children:[e.jsx("span",{style:t.breadcrumbSep,children:"/"}),e.jsx("span",{style:t.breadcrumbActive,children:o.title})]})]}),e.jsxs("div",{style:t.content,children:[p==="projects"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>c("create"),style:t.createProjectBtn,children:[e.jsx(B,{})," New Project"]}),e.jsxs("div",{style:t.projectsGrid,children:[g.map(r=>e.jsxs("div",{style:t.projectCard,onClick:()=>F(r.id),children:[e.jsx(O,{style:t.projectIcon}),e.jsx("h3",{style:t.projectName,children:r.name}),e.jsx("p",{style:t.projectDesc,children:r.description}),e.jsxs("div",{style:t.projectStats,children:[e.jsxs("span",{children:[e.jsx(z,{})," ",r.stats?.documents||0]}),e.jsxs("span",{children:[e.jsx(J,{})," ",r.member_count]})]})]},r.id)),g.length===0&&e.jsx("p",{style:t.emptyText,children:"No projects yet. Create one!"})]})]}),p==="create"&&e.jsxs("div",{style:t.createForm,children:[e.jsx("h3",{style:t.formTitle,children:"Create New Project"}),e.jsx("input",{type:"text",placeholder:"Project Name",value:f,onChange:r=>C(r.target.value),style:t.input}),e.jsx("textarea",{placeholder:"Description (optional)",value:S,onChange:r=>D(r.target.value),style:t.textarea}),e.jsxs("div",{style:t.formActions,children:[e.jsx("button",{onClick:()=>c("projects"),style:t.cancelBtn,children:"Cancel"}),e.jsx("button",{onClick:H,style:t.submitBtn,disabled:x,children:x?"Creating...":"Create Project"})]})]}),p==="project-detail"&&i&&e.jsxs("div",{style:t.projectDetail,children:[e.jsxs("div",{style:t.projectHeader,children:[e.jsxs("div",{children:[e.jsx("h3",{style:t.projectTitle,children:i.name}),e.jsx("p",{style:t.projectDescription,children:i.description})]}),e.jsxs("button",{onClick:()=>c("create-doc"),style:t.newDocBtn,children:[e.jsx(B,{})," New Document"]})]}),e.jsxs("div",{style:t.documentsSection,children:[e.jsx("h4",{style:t.sectionTitle,children:"Documents"}),e.jsxs("div",{style:t.documentsList,children:[v.map(r=>e.jsxs("div",{style:t.documentCard,onClick:()=>L(r.id),children:[e.jsx(z,{style:t.docIcon}),e.jsxs("div",{style:t.docInfo,children:[e.jsx("h4",{style:t.docTitle,children:r.title}),e.jsxs("span",{style:t.docMeta,children:[e.jsx(M,{})," ",new Date(r.updated_at).toLocaleDateString()," Â· ",r.last_edited_by]})]})]},r.id)),v.length===0&&e.jsx("p",{style:t.emptyText,children:"No documents yet"})]})]}),e.jsxs("div",{style:t.membersSection,children:[e.jsx("h4",{style:t.sectionTitle,children:"Team Members"}),e.jsx("div",{style:t.membersList,children:i.members?.map(r=>e.jsxs("div",{style:t.memberBadge,children:[e.jsx("span",{style:t.memberAvatar,children:r.username.charAt(0).toUpperCase()}),e.jsx("span",{children:r.username}),e.jsx("span",{style:t.memberRole,children:r.role})]},r.id))})]})]}),p==="create-doc"&&e.jsxs("div",{style:t.createForm,children:[e.jsx("h3",{style:t.formTitle,children:"Create New Document"}),e.jsx("input",{type:"text",placeholder:"Document Title",value:b,onChange:r=>k(r.target.value),style:t.input}),e.jsx("textarea",{placeholder:"Start writing...",value:w,onChange:r=>T(r.target.value),style:{...t.textarea,minHeight:"200px"}}),e.jsxs("div",{style:t.formActions,children:[e.jsx("button",{onClick:()=>c("project-detail"),style:t.cancelBtn,children:"Cancel"}),e.jsx("button",{onClick:$,style:t.submitBtn,disabled:x,children:x?"Creating...":"Create Document"})]})]}),p==="document"&&o&&e.jsxs("div",{style:t.documentEditor,children:[e.jsxs("div",{style:t.editorHeader,children:[e.jsx("input",{type:"text",value:o.title,onChange:r=>j({...o,title:r.target.value}),style:t.docTitleInput}),e.jsxs("div",{style:t.editorActions,children:[e.jsx("button",{onClick:_,style:t.saveBtn,children:"Save"}),e.jsxs("button",{style:t.historyBtn,children:[e.jsx(q,{})," History"]})]})]}),e.jsx("textarea",{value:o.content,onChange:r=>j({...o,content:r.target.value}),style:t.editor,placeholder:"Start writing your document..."}),e.jsxs("div",{style:t.editorFooter,children:[e.jsxs("span",{children:["Version ",o.version]}),e.jsxs("span",{children:["Last edited by ",o.last_edited_by]})]})]})]})]})})},t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e4},modal:{backgroundColor:"#2f3136",borderRadius:"12px",width:"800px",maxHeight:"85vh",overflow:"hidden",display:"flex",flexDirection:"column"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #40444b"},headerLeft:{display:"flex",alignItems:"center"},title:{margin:0,color:"#fff",fontSize:"20px"},closeButton:{background:"none",border:"none",color:"#b9bbbe",cursor:"pointer",fontSize:"20px"},breadcrumbs:{display:"flex",alignItems:"center",padding:"10px 20px",gap:"8px",background:"#36393f"},breadcrumb:{background:"none",border:"none",color:"#5865f2",cursor:"pointer",fontSize:"14px"},breadcrumbSep:{color:"#72767d"},breadcrumbActive:{color:"#dcddde",fontSize:"14px"},content:{padding:"20px",overflowY:"auto",flex:1},createProjectBtn:{background:"#5865f2",border:"none",color:"#fff",padding:"10px 20px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",marginBottom:"20px"},projectsGrid:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"15px"},projectCard:{background:"#40444b",borderRadius:"10px",padding:"20px",cursor:"pointer",transition:"transform 0.2s",":hover":{transform:"translateY(-2px)"}},projectIcon:{color:"#faa61a",fontSize:"30px",marginBottom:"10px"},projectName:{color:"#fff",margin:"0 0 8px",fontSize:"16px"},projectDesc:{color:"#b9bbbe",fontSize:"13px",marginBottom:"15px"},projectStats:{display:"flex",gap:"15px",color:"#72767d",fontSize:"12px"},emptyText:{color:"#72767d",textAlign:"center",padding:"40px",gridColumn:"1 / -1"},createForm:{maxWidth:"500px",margin:"0 auto"},formTitle:{color:"#fff",marginBottom:"20px"},input:{width:"100%",background:"#40444b",border:"none",color:"#fff",padding:"12px",borderRadius:"6px",marginBottom:"15px"},textarea:{width:"100%",background:"#40444b",border:"none",color:"#fff",padding:"12px",borderRadius:"6px",marginBottom:"15px",minHeight:"100px",resize:"vertical"},formActions:{display:"flex",justifyContent:"flex-end",gap:"10px"},cancelBtn:{background:"#40444b",border:"none",color:"#fff",padding:"10px 20px",borderRadius:"6px",cursor:"pointer"},submitBtn:{background:"#5865f2",border:"none",color:"#fff",padding:"10px 20px",borderRadius:"6px",cursor:"pointer"},projectDetail:{display:"flex",flexDirection:"column",gap:"25px"},projectHeader:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},projectTitle:{color:"#fff",margin:"0 0 5px",fontSize:"24px"},projectDescription:{color:"#b9bbbe",margin:0},newDocBtn:{background:"#57f287",border:"none",color:"#000",padding:"10px 16px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},documentsSection:{},sectionTitle:{color:"#b9bbbe",fontSize:"12px",fontWeight:"600",textTransform:"uppercase",marginBottom:"10px"},documentsList:{display:"flex",flexDirection:"column",gap:"8px"},documentCard:{display:"flex",alignItems:"center",gap:"12px",background:"#40444b",padding:"12px 15px",borderRadius:"8px",cursor:"pointer"},docIcon:{color:"#5865f2",fontSize:"20px"},docInfo:{flex:1},docTitle:{color:"#fff",margin:0,fontSize:"14px"},docMeta:{color:"#72767d",fontSize:"12px",display:"flex",alignItems:"center",gap:"5px"},membersSection:{},membersList:{display:"flex",flexWrap:"wrap",gap:"10px"},memberBadge:{display:"flex",alignItems:"center",gap:"8px",background:"#40444b",padding:"8px 12px",borderRadius:"20px"},memberAvatar:{width:"24px",height:"24px",borderRadius:"50%",background:"#5865f2",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontSize:"12px"},memberRole:{color:"#72767d",fontSize:"11px",background:"#36393f",padding:"2px 6px",borderRadius:"4px"},documentEditor:{display:"flex",flexDirection:"column",height:"calc(85vh - 180px)"},editorHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},docTitleInput:{background:"transparent",border:"none",color:"#fff",fontSize:"24px",fontWeight:"bold",flex:1},editorActions:{display:"flex",gap:"10px"},saveBtn:{background:"#57f287",border:"none",color:"#000",padding:"8px 16px",borderRadius:"6px",cursor:"pointer"},historyBtn:{background:"#40444b",border:"none",color:"#fff",padding:"8px 16px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},editor:{flex:1,background:"#40444b",border:"none",color:"#dcddde",padding:"20px",borderRadius:"8px",fontSize:"14px",lineHeight:"1.6",resize:"none"},editorFooter:{display:"flex",justifyContent:"space-between",padding:"10px 0",color:"#72767d",fontSize:"12px"}};export{U as default};
