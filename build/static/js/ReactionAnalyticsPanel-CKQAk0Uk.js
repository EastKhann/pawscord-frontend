var z=Object.defineProperty;var o=(n,l)=>z(n,"name",{value:l,configurable:!0});import{r as i,j as e}from"./react-core-Djgtqrmb.js";import{O as F,a as B,R as $,bv as T,P as H,by as M}from"./icons-vendor-BW7dxHkX.js";import{t as f}from"./index-B9TNnJpS.js";import"./media-vendor-CxFPycob.js";import"./router-vendor-ClgLnMjk.js";import"./state-vendor-BRqaXHJQ.js";import"./crypto-vendor-D1XRGppi.js";import"./ui-vendor-IhB9Znpc.js";const V=o(({fetchWithAuth:n,apiBaseUrl:l,onClose:v,roomSlug:p})=>{const[c,C]=i.useState(null),[x,S]=i.useState([]),[y,w]=i.useState([]),[L,m]=i.useState(!1),[d,h]=i.useState("heatmap");i.useEffect(()=>{R(),k(),A()},[p]);const R=o(async()=>{m(!0);try{const s=await(await n(`${l}/rooms/${p}/reaction_heatmap/`)).json();C(s)}catch{f.error("Failed to load reaction heatmap")}finally{m(!1)}},"fetchHeatmap"),k=o(async()=>{try{const s=await(await n(`${l}/rooms/${p}/reactions/daily/`)).json();S(s.stats||[])}catch{f.error("Failed to load daily stats")}},"fetchDailyStats"),A=o(async()=>{try{const s=await(await n(`${l}/leaderboards/reactions/`)).json();w(s.leaderboard||[])}catch{f.error("Failed to load leaderboard")}},"fetchLeaderboard"),g=o((a,s)=>{const r=a/s*100;return r>75?"#f04747":r>50?"#faa61a":r>25?"#5865f2":"#2c2f33"},"getHeatLevel"),b=Array.from({length:24},(a,s)=>s),u=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];return e.jsx("div",{style:t.overlay,children:e.jsxs("div",{style:t.modal,children:[e.jsxs("div",{style:t.header,children:[e.jsxs("div",{style:t.headerLeft,children:[e.jsx(F,{style:{marginRight:"10px",color:"#5865f2"}}),e.jsx("h2",{style:t.title,children:"Reaction Analytics"})]}),e.jsx("button",{onClick:v,style:t.closeButton,children:e.jsx(B,{})})]}),e.jsxs("div",{style:t.tabs,children:[e.jsxs("button",{onClick:o(()=>h("heatmap"),"onClick"),style:{...t.tab,...d==="heatmap"&&t.tabActive},children:[e.jsx($,{style:{marginRight:"5px"}}),"Heatmap"]}),e.jsxs("button",{onClick:o(()=>h("daily"),"onClick"),style:{...t.tab,...d==="daily"&&t.tabActive},children:[e.jsx(T,{style:{marginRight:"5px"}}),"Daily Stats"]}),e.jsxs("button",{onClick:o(()=>h("leaderboard"),"onClick"),style:{...t.tab,...d==="leaderboard"&&t.tabActive},children:[e.jsx(H,{style:{marginRight:"5px"}}),"Leaderboard"]})]}),e.jsx("div",{style:t.content,children:L?e.jsx("div",{style:t.loading,children:"Loading analytics..."}):d==="heatmap"?e.jsxs("div",{style:t.heatmapContainer,children:[e.jsxs("div",{style:t.heatmapGrid,children:[e.jsx("div",{style:t.heatmapYAxis,children:u.map(a=>e.jsx("div",{style:t.dayLabel,children:a},a))}),e.jsxs("div",{style:t.heatmapCells,children:[c&&c.data&&u.map((a,s)=>e.jsx("div",{style:t.heatmapRow,children:b.map(r=>{const j=c.data[s]?.[r]||0,I=Math.max(...c.data.flat().filter(D=>D)||[1]);return e.jsx("div",{style:{...t.heatmapCell,backgroundColor:g(j,I)},title:`${a} ${r}:00 - ${j} reactions`},r)})},a)),e.jsx("div",{style:t.heatmapXAxis,children:b.filter(a=>a%3===0).map(a=>e.jsxs("div",{style:t.hourLabel,children:[a,"h"]},a))})]})]}),e.jsxs("div",{style:t.legend,children:[e.jsx("span",{style:t.legendLabel,children:"Less"}),[0,25,50,75,100].map(a=>e.jsx("div",{style:{...t.legendBox,backgroundColor:g(a,100)}},a)),e.jsx("span",{style:t.legendLabel,children:"More"})]})]}):d==="daily"?e.jsx("div",{style:t.dailyStats,children:x.length===0?e.jsx("div",{style:t.empty,children:"No daily stats available"}):e.jsx("div",{style:t.chartContainer,children:x.map((a,s)=>e.jsxs("div",{style:t.statBar,children:[e.jsx("div",{style:t.statDate,children:new Date(a.date).toLocaleDateString()}),e.jsx("div",{style:t.barContainer,children:e.jsx("div",{style:{...t.bar,width:`${a.count/Math.max(...x.map(r=>r.count))*100}%`}})}),e.jsx("div",{style:t.statCount,children:a.count})]},s))})}):e.jsx("div",{style:t.leaderboard,children:y.length===0?e.jsx("div",{style:t.empty,children:"No leaderboard data available"}):y.map((a,s)=>e.jsxs("div",{style:t.leaderboardItem,children:[e.jsx("div",{style:t.rank,children:s===0?"ðŸ¥‡":s===1?"ðŸ¥ˆ":s===2?"ðŸ¥‰":`${s+1}`}),e.jsxs("div",{style:t.userInfo,children:[e.jsx("div",{style:t.username,children:a.username}),e.jsxs("div",{style:t.userReactions,children:[e.jsx(M,{style:{color:"#f04747",marginRight:"5px"}}),a.reaction_count," reactions"]})]})]},s))})})]})})},"ReactionAnalyticsPanel"),t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999},modal:{backgroundColor:"#1e1e1e",borderRadius:"8px",width:"90%",maxWidth:"1000px",maxHeight:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #2c2f33"},headerLeft:{display:"flex",alignItems:"center"},title:{margin:0,fontSize:"20px",color:"#ffffff"},closeButton:{background:"none",border:"none",color:"#99aab5",cursor:"pointer",fontSize:"20px",padding:"5px"},tabs:{display:"flex",borderBottom:"1px solid #2c2f33",padding:"0 20px"},tab:{padding:"12px 20px",backgroundColor:"transparent",border:"none",color:"#99aab5",cursor:"pointer",fontSize:"14px",display:"flex",alignItems:"center",borderBottom:"2px solid transparent"},tabActive:{color:"#5865f2",borderBottom:"2px solid #5865f2"},content:{padding:"20px",overflowY:"auto",flex:1},loading:{textAlign:"center",color:"#99aab5",padding:"40px"},empty:{textAlign:"center",color:"#99aab5",padding:"40px"},heatmapContainer:{display:"flex",flexDirection:"column",gap:"20px"},heatmapGrid:{display:"flex",gap:"10px"},heatmapYAxis:{display:"flex",flexDirection:"column",justifyContent:"space-around"},dayLabel:{fontSize:"12px",color:"#99aab5",height:"20px",display:"flex",alignItems:"center"},heatmapCells:{flex:1},heatmapRow:{display:"flex",gap:"2px",marginBottom:"2px"},heatmapCell:{width:"20px",height:"20px",borderRadius:"2px",cursor:"pointer"},heatmapXAxis:{display:"flex",justifyContent:"space-around",marginTop:"5px"},hourLabel:{fontSize:"11px",color:"#99aab5"},legend:{display:"flex",alignItems:"center",gap:"5px",justifyContent:"center"},legendLabel:{fontSize:"12px",color:"#99aab5"},legendBox:{width:"15px",height:"15px",borderRadius:"2px"},dailyStats:{display:"flex",flexDirection:"column"},chartContainer:{display:"flex",flexDirection:"column",gap:"12px"},statBar:{display:"grid",gridTemplateColumns:"100px 1fr 60px",alignItems:"center",gap:"12px"},statDate:{fontSize:"13px",color:"#dcddde"},barContainer:{height:"24px",backgroundColor:"#2c2f33",borderRadius:"4px",overflow:"hidden"},bar:{height:"100%",backgroundColor:"#5865f2",transition:"width 0.3s"},statCount:{fontSize:"14px",fontWeight:"600",color:"#ffffff",textAlign:"right"},leaderboard:{display:"flex",flexDirection:"column",gap:"12px"},leaderboardItem:{backgroundColor:"#2c2f33",borderRadius:"6px",padding:"16px",display:"flex",alignItems:"center",gap:"16px"},rank:{fontSize:"24px",fontWeight:"600",minWidth:"60px",textAlign:"center"},userInfo:{flex:1},username:{fontSize:"16px",fontWeight:"600",color:"#ffffff",marginBottom:"4px"},userReactions:{fontSize:"14px",color:"#99aab5",display:"flex",alignItems:"center"}};export{V as default};
