var W=Object.defineProperty;var a=(l,d)=>W(l,"name",{value:d,configurable:!0});import{r,j as e}from"./react-core-Djgtqrmb.js";import{c9 as U,a as ee,an as z,bs as te,bc as I,u as oe,z as re,aB as ne}from"./icons-vendor-BW7dxHkX.js";import{t as c}from"./index-BRQzOq3v.js";import"./media-vendor-CxFPycob.js";import"./router-vendor-gmJ9Mn-1.js";import"./state-vendor-BRqaXHJQ.js";import"./crypto-vendor-D1XRGppi.js";import"./ui-vendor-IhB9Znpc.js";const se=a(({fetchWithAuth:l,apiBaseUrl:d,onClose:R,serverId:g})=>{const[h,N]=r.useState([]),[p,C]=r.useState(null),[v,H]=r.useState([]),[s,b]=r.useState(null),[x,i]=r.useState("projects"),[u,m]=r.useState(!1),[f,S]=r.useState(""),[k,D]=r.useState(""),[y,T]=r.useState(""),[w,P]=r.useState(""),_=r.useCallback(()=>{i("projects"),C(null)},[]),$=r.useCallback(()=>i("project-detail"),[]),L=r.useCallback(()=>i("create"),[]),E=r.useCallback(()=>i("create-doc"),[]),A=r.useCallback(()=>i("projects"),[]),G=r.useCallback(()=>i("project-detail"),[]),O=r.useCallback(o=>S(o.target.value),[]),J=r.useCallback(o=>D(o.target.value),[]),M=r.useCallback(o=>T(o.target.value),[]),q=r.useCallback(o=>P(o.target.value),[]),V=r.useCallback(o=>b(n=>({...n,title:o.target.value})),[]),Y=r.useCallback(o=>b(n=>({...n,content:o.target.value})),[]);r.useEffect(()=>{B()},[]);const B=a(async()=>{try{const n=await(await l(`${d}/projects/?server_id=${g}`)).json();N(n.projects||[])}catch{}},"fetchProjects"),F=a(async o=>{try{const j=await(await l(`${d}/projects/${o}/`)).json();C(j.project),H(j.documents||[]),i("project-detail")}catch{c.error("Failed to load project")}},"fetchProject"),K=a(async()=>{if(!f.trim()){c.error("Project name required");return}m(!0);try{(await(await l(`${d}/projects/create/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:f,description:k,server_id:g})})).json()).project&&(c.success("Project created!"),S(""),D(""),i("projects"),B())}catch{c.error("Failed to create project")}finally{m(!1)}},"createProject"),Q=a(async()=>{if(!y.trim()){c.error("Document title required");return}m(!0);try{(await(await l(`${d}/documents/create/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:y,content:w,project_id:p?.id})})).json()).document&&(c.success("Document created!"),T(""),P(""),F(p.id))}catch{c.error("Failed to create document")}finally{m(!1)}},"createDocument"),X=a(async o=>{try{const j=await(await l(`${d}/documents/${o}/`)).json();b(j.document),i("document")}catch{c.error("Failed to load document")}},"fetchDocument"),Z=a(async()=>{if(s)try{await l(`${d}/documents/${s.id}/`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:s.content})}),c.success("Document saved!")}catch{c.error("Failed to save document")}},"saveDocument");return e.jsx("div",{style:t.overlay,children:e.jsxs("div",{style:t.modal,children:[e.jsxs("div",{style:t.header,children:[e.jsxs("div",{style:t.headerLeft,children:[e.jsx(U,{style:{marginRight:"10px",color:"#5865f2"}}),e.jsx("h2",{style:t.title,children:"Project Collaboration"})]}),e.jsx("button",{onClick:R,style:t.closeButton,children:e.jsx(ee,{})})]}),e.jsxs("div",{style:t.breadcrumbs,children:[e.jsx("button",{onClick:_,style:t.breadcrumb,children:"Projects"}),p&&e.jsxs(e.Fragment,{children:[e.jsx("span",{style:t.breadcrumbSep,children:"/"}),e.jsx("button",{onClick:$,style:t.breadcrumb,children:p.name})]}),s&&e.jsxs(e.Fragment,{children:[e.jsx("span",{style:t.breadcrumbSep,children:"/"}),e.jsx("span",{style:t.breadcrumbActive,children:s.title})]})]}),e.jsxs("div",{style:t.content,children:[x==="projects"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:L,style:t.createProjectBtn,children:[e.jsx(z,{})," New Project"]}),e.jsxs("div",{style:t.projectsGrid,children:[h.map(o=>e.jsxs("div",{style:t.projectCard,onClick:a(()=>F(o.id),"onClick"),children:[e.jsx(te,{style:t.projectIcon}),e.jsx("h3",{style:t.projectName,children:o.name}),e.jsx("p",{style:t.projectDesc,children:o.description}),e.jsxs("div",{style:t.projectStats,children:[e.jsxs("span",{children:[e.jsx(I,{})," ",o.stats?.documents||0]}),e.jsxs("span",{children:[e.jsx(oe,{})," ",o.member_count]})]})]},o.id)),h.length===0&&e.jsx("p",{style:t.emptyText,children:"No projects yet. Create one!"})]})]}),x==="create"&&e.jsxs("div",{style:t.createForm,children:[e.jsx("h3",{style:t.formTitle,children:"Create New Project"}),e.jsx("input",{type:"text",placeholder:"Project Name",value:f,onChange:O,style:t.input}),e.jsx("textarea",{placeholder:"Description (optional)",value:k,onChange:J,style:t.textarea}),e.jsxs("div",{style:t.formActions,children:[e.jsx("button",{onClick:A,style:t.cancelBtn,children:"Cancel"}),e.jsx("button",{onClick:K,style:t.submitBtn,disabled:u,children:u?"Creating...":"Create Project"})]})]}),x==="project-detail"&&p&&e.jsxs("div",{style:t.projectDetail,children:[e.jsxs("div",{style:t.projectHeader,children:[e.jsxs("div",{children:[e.jsx("h3",{style:t.projectTitle,children:p.name}),e.jsx("p",{style:t.projectDescription,children:p.description})]}),e.jsxs("button",{onClick:E,style:t.newDocBtn,children:[e.jsx(z,{})," New Document"]})]}),e.jsxs("div",{style:t.documentsSection,children:[e.jsx("h4",{style:t.sectionTitle,children:"Documents"}),e.jsxs("div",{style:t.documentsList,children:[v.map(o=>e.jsxs("div",{style:t.documentCard,onClick:a(()=>X(o.id),"onClick"),children:[e.jsx(I,{style:t.docIcon}),e.jsxs("div",{style:t.docInfo,children:[e.jsx("h4",{style:t.docTitle,children:o.title}),e.jsxs("span",{style:t.docMeta,children:[e.jsx(re,{})," ",new Date(o.updated_at).toLocaleDateString()," Â· ",o.last_edited_by]})]})]},o.id)),v.length===0&&e.jsx("p",{style:t.emptyText,children:"No documents yet"})]})]}),e.jsxs("div",{style:t.membersSection,children:[e.jsx("h4",{style:t.sectionTitle,children:"Team Members"}),e.jsx("div",{style:t.membersList,children:p.members?.map(o=>e.jsxs("div",{style:t.memberBadge,children:[e.jsx("span",{style:t.memberAvatar,children:o.username.charAt(0).toUpperCase()}),e.jsx("span",{children:o.username}),e.jsx("span",{style:t.memberRole,children:o.role})]},o.id))})]})]}),x==="create-doc"&&e.jsxs("div",{style:t.createForm,children:[e.jsx("h3",{style:t.formTitle,children:"Create New Document"}),e.jsx("input",{type:"text",placeholder:"Document Title",value:y,onChange:M,style:t.input}),e.jsx("textarea",{placeholder:"Start writing...",value:w,onChange:q,style:{...t.textarea,minHeight:"200px"}}),e.jsxs("div",{style:t.formActions,children:[e.jsx("button",{onClick:G,style:t.cancelBtn,children:"Cancel"}),e.jsx("button",{onClick:Q,style:t.submitBtn,disabled:u,children:u?"Creating...":"Create Document"})]})]}),x==="document"&&s&&e.jsxs("div",{style:t.documentEditor,children:[e.jsxs("div",{style:t.editorHeader,children:[e.jsx("input",{type:"text",value:s.title,onChange:V,style:t.docTitleInput}),e.jsxs("div",{style:t.editorActions,children:[e.jsx("button",{onClick:Z,style:t.saveBtn,children:"Save"}),e.jsxs("button",{style:t.historyBtn,children:[e.jsx(ne,{})," History"]})]})]}),e.jsx("textarea",{value:s.content,onChange:Y,style:t.editor,placeholder:"Start writing your document..."}),e.jsxs("div",{style:t.editorFooter,children:[e.jsxs("span",{children:["Version ",s.version]}),e.jsxs("span",{children:["Last edited by ",s.last_edited_by]})]})]})]})]})})},"ProjectCollaborationPanel"),t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e4},modal:{backgroundColor:"#2f3136",borderRadius:"12px",width:"800px",maxHeight:"85vh",overflow:"hidden",display:"flex",flexDirection:"column"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #40444b"},headerLeft:{display:"flex",alignItems:"center"},title:{margin:0,color:"#fff",fontSize:"20px"},closeButton:{background:"none",border:"none",color:"#b9bbbe",cursor:"pointer",fontSize:"20px"},breadcrumbs:{display:"flex",alignItems:"center",padding:"10px 20px",gap:"8px",background:"#36393f"},breadcrumb:{background:"none",border:"none",color:"#5865f2",cursor:"pointer",fontSize:"14px"},breadcrumbSep:{color:"#72767d"},breadcrumbActive:{color:"#dcddde",fontSize:"14px"},content:{padding:"20px",overflowY:"auto",flex:1},createProjectBtn:{background:"#5865f2",border:"none",color:"#fff",padding:"10px 20px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",marginBottom:"20px"},projectsGrid:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"15px"},projectCard:{background:"#40444b",borderRadius:"10px",padding:"20px",cursor:"pointer",transition:"transform 0.2s",":hover":{transform:"translateY(-2px)"}},projectIcon:{color:"#faa61a",fontSize:"30px",marginBottom:"10px"},projectName:{color:"#fff",margin:"0 0 8px",fontSize:"16px"},projectDesc:{color:"#b9bbbe",fontSize:"13px",marginBottom:"15px"},projectStats:{display:"flex",gap:"15px",color:"#72767d",fontSize:"12px"},emptyText:{color:"#72767d",textAlign:"center",padding:"40px",gridColumn:"1 / -1"},createForm:{maxWidth:"500px",margin:"0 auto"},formTitle:{color:"#fff",marginBottom:"20px"},input:{width:"100%",background:"#40444b",border:"none",color:"#fff",padding:"12px",borderRadius:"6px",marginBottom:"15px"},textarea:{width:"100%",background:"#40444b",border:"none",color:"#fff",padding:"12px",borderRadius:"6px",marginBottom:"15px",minHeight:"100px",resize:"vertical"},formActions:{display:"flex",justifyContent:"flex-end",gap:"10px"},cancelBtn:{background:"#40444b",border:"none",color:"#fff",padding:"10px 20px",borderRadius:"6px",cursor:"pointer"},submitBtn:{background:"#5865f2",border:"none",color:"#fff",padding:"10px 20px",borderRadius:"6px",cursor:"pointer"},projectDetail:{display:"flex",flexDirection:"column",gap:"25px"},projectHeader:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},projectTitle:{color:"#fff",margin:"0 0 5px",fontSize:"24px"},projectDescription:{color:"#b9bbbe",margin:0},newDocBtn:{background:"#57f287",border:"none",color:"#000",padding:"10px 16px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},documentsSection:{},sectionTitle:{color:"#b9bbbe",fontSize:"12px",fontWeight:"600",textTransform:"uppercase",marginBottom:"10px"},documentsList:{display:"flex",flexDirection:"column",gap:"8px"},documentCard:{display:"flex",alignItems:"center",gap:"12px",background:"#40444b",padding:"12px 15px",borderRadius:"8px",cursor:"pointer"},docIcon:{color:"#5865f2",fontSize:"20px"},docInfo:{flex:1},docTitle:{color:"#fff",margin:0,fontSize:"14px"},docMeta:{color:"#72767d",fontSize:"12px",display:"flex",alignItems:"center",gap:"5px"},membersSection:{},membersList:{display:"flex",flexWrap:"wrap",gap:"10px"},memberBadge:{display:"flex",alignItems:"center",gap:"8px",background:"#40444b",padding:"8px 12px",borderRadius:"20px"},memberAvatar:{width:"24px",height:"24px",borderRadius:"50%",background:"#5865f2",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontSize:"12px"},memberRole:{color:"#72767d",fontSize:"11px",background:"#36393f",padding:"2px 6px",borderRadius:"4px"},documentEditor:{display:"flex",flexDirection:"column",height:"calc(85vh - 180px)"},editorHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},docTitleInput:{background:"transparent",border:"none",color:"#fff",fontSize:"24px",fontWeight:"bold",flex:1},editorActions:{display:"flex",gap:"10px"},saveBtn:{background:"#57f287",border:"none",color:"#000",padding:"8px 16px",borderRadius:"6px",cursor:"pointer"},historyBtn:{background:"#40444b",border:"none",color:"#fff",padding:"8px 16px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},editor:{flex:1,background:"#40444b",border:"none",color:"#dcddde",padding:"20px",borderRadius:"8px",fontSize:"14px",lineHeight:"1.6",resize:"none"},editorFooter:{display:"flex",justifyContent:"space-between",padding:"10px 0",color:"#72767d",fontSize:"12px"}},je=r.memo(se);export{je as default};
