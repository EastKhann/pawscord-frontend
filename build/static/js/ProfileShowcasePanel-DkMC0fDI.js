var M=Object.defineProperty;var n=(c,m)=>M(c,"name",{value:m,configurable:!0});import{r as t,j as e}from"./react-core-Djgtqrmb.js";import{Q as F,a as R,a0 as G,an as _,aa as Y,ab as I,X as J,at as U,f as H,aY as q,a8 as K,P as Q,ap as X,aK as Z,bb as W,q as ee,j as se}from"./icons-vendor-BW7dxHkX.js";import{y as k}from"./ui-vendor-IhB9Znpc.js";import{e as ae}from"./index-Dy0QUtja.js";import"./media-vendor-CxFPycob.js";import"./router-vendor-ClgLnMjk.js";import"./state-vendor-BRqaXHJQ.js";import"./crypto-vendor-D1XRGppi.js";const ne=n(({userId:c,onClose:m,onUpdate:le,fetchWithAuth:f,apiBaseUrl:b})=>{const[l,d]=t.useState([]),[E,v]=t.useState(!0),[P,y]=t.useState(!1),[h,w]=t.useState(null),[r,u]=t.useState({type:"game",title:"",description:"",image_url:"",link_url:""}),[ie,te]=t.useState(null),$=t.useCallback(s=>s.target.className==="showcase-overlay"&&m(),[m]),N=t.useCallback(()=>y(!0),[]),T=t.useCallback(s=>s.stopPropagation(),[]),x=t.useCallback(s=>{const{name:a,value:i}=s.target;u(o=>({...o,[a]:i}))},[]),g=[{key:"game",label:"Oyun",icon:e.jsx(K,{}),color:"#9c27b0"},{key:"achievement",label:"Başarı",icon:e.jsx(Q,{}),color:"#ffc107"},{key:"art",label:"Sanat",icon:e.jsx(X,{}),color:"#e91e63"},{key:"music",label:"Müzik",icon:e.jsx(Z,{}),color:"#00bcd4"},{key:"video",label:"Video",icon:e.jsx(W,{}),color:"#f44336"},{key:"code",label:"Proje",icon:e.jsx(ee,{}),color:"#4caf50"},{key:"link",label:"Link",icon:e.jsx(se,{}),color:"#2196f3"}];t.useEffect(()=>{z()},[c]);const z=n(async()=>{v(!0);try{const s=await f(`${b}/users/${c}/showcase/`);if(s.ok){const a=await s.json();d(a.items||[])}else d([])}catch{d([])}v(!1)},"fetchShowcases"),A=n(async()=>{if(!r.title.trim()){k.error("Başlık gerekli");return}const s={id:Date.now(),...r,order:l.length};try{await f(`${b}/users/${c}/showcase/`,{method:"POST",headers:{Authorization:`Bearer ${token}`,"Content-Type":"application/json"},body:JSON.stringify(s)})}catch{}d([...l,s]),j(),k.success("Vitrin öğesi eklendi")},"handleAdd"),D=n(async()=>{if(!(!r.title.trim()||!h)){try{await fetch(`/api/users/${c}/showcase/${h.id}/`,{method:"PATCH",headers:{Authorization:`Bearer ${token}`,"Content-Type":"application/json"},body:JSON.stringify(r)})}catch{}d(l.map(s=>s.id===h.id?{...s,...r}:s)),j(),k.success("Vitrin öğesi güncellendi")}},"handleEdit"),L=n(async s=>{if(await ae("Bu öğeyi silmek istediğinizden emin misiniz?")){try{await fetch(`/api/users/${c}/showcase/${s}/`,{method:"DELETE",headers:{Authorization:`Bearer ${token}`}})}catch{}d(l.filter(a=>a.id!==s)),k.success("Vitrin öğesi silindi")}},"handleDelete"),C=n(async(s,a)=>{const i=l.findIndex(p=>p.id===s);if(a==="up"&&i===0||a==="down"&&i===l.length-1)return;const o=[...l],S=a==="up"?i-1:i+1;[o[i],o[S]]=[o[S],o[i]],o.forEach((p,B)=>p.order=B),d(o);try{await fetch(`/api/users/${c}/showcase/reorder/`,{method:"POST",headers:{Authorization:`Bearer ${token}`,"Content-Type":"application/json"},body:JSON.stringify({order:o.map(p=>p.id)})})}catch{}},"handleReorder"),j=n(()=>{u({type:"game",title:"",description:"",image_url:"",link_url:""}),y(!1),w(null)},"resetForm"),O=n(s=>{w(s),u({type:s.type,title:s.title,description:s.description||"",image_url:s.image_url||"",link_url:s.link_url||""}),y(!0)},"openEditModal"),V=n(s=>g.find(a=>a.key===s)||g[0],"getTypeInfo");return e.jsx("div",{className:"showcase-overlay",onClick:$,children:e.jsxs("div",{className:"showcase-panel",children:[e.jsxs("div",{className:"panel-header",children:[e.jsxs("h2",{children:[e.jsx(F,{})," Profil Vitrini"]}),e.jsx("button",{className:"close-btn",onClick:m,children:e.jsx(R,{})})]}),e.jsxs("div",{className:"panel-info",children:[e.jsx(G,{}),e.jsx("p",{children:"Profilinizde gösterilecek en fazla 6 öğe seçebilirsiniz"})]}),e.jsx("div",{className:"showcase-list",children:E?e.jsx("div",{className:"loading",children:"Yükleniyor..."}):l.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx(F,{}),e.jsx("p",{children:"Henüz vitrin öğesi yok"}),e.jsxs("button",{onClick:N,children:[e.jsx(_,{})," İlk Öğeyi Ekle"]})]}):l.map((s,a)=>{const i=V(s.type);return e.jsxs("div",{className:"showcase-item",children:[e.jsxs("div",{className:"item-drag",children:[e.jsx("button",{onClick:n(()=>C(s.id,"up"),"onClick"),disabled:a===0,children:e.jsx(Y,{})}),e.jsx("button",{onClick:n(()=>C(s.id,"down"),"onClick"),disabled:a===l.length-1,children:e.jsx(I,{})})]}),e.jsx("div",{className:"item-icon",style:{background:i.color},children:i.icon}),s.image_url&&e.jsx("div",{className:"item-image",children:e.jsx("img",{src:s.image_url,alt:s.title})}),e.jsxs("div",{className:"item-info",children:[e.jsx("span",{className:"item-type",children:i.label}),e.jsx("h4",{children:s.title}),s.description&&e.jsx("p",{children:s.description}),s.link_url&&e.jsxs("a",{href:s.link_url,target:"_blank",rel:"noopener noreferrer",children:[e.jsx(J,{})," Linke Git"]})]}),e.jsxs("div",{className:"item-actions",children:[e.jsx("button",{onClick:n(()=>O(s),"onClick"),children:e.jsx(U,{})}),e.jsx("button",{onClick:n(()=>L(s.id),"onClick"),children:e.jsx(H,{})})]})]},s.id)})}),l.length<6&&l.length>0&&e.jsxs("div",{className:"add-section",children:[e.jsxs("button",{className:"add-btn",onClick:N,children:[e.jsx(_,{})," Yeni Öğe Ekle"]}),e.jsxs("span",{className:"remaining",children:[6-l.length," slot kaldı"]})]}),P&&e.jsx("div",{className:"modal-overlay",onClick:j,children:e.jsxs("div",{className:"modal-content",onClick:T,children:[e.jsx("h3",{children:h?"Öğeyi Düzenle":"Yeni Vitrin Öğesi"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Tür"}),e.jsx("div",{className:"type-selector",children:g.map(s=>e.jsxs("button",{className:`type-btn ${r.type===s.key?"selected":""}`,style:{"--color":s.color},onClick:n(()=>u({...r,type:s.key}),"onClick"),children:[s.icon,e.jsx("span",{children:s.label})]},s.key))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Başlık *"}),e.jsx("input",{type:"text",name:"title",placeholder:"Örn: Valorant",value:r.title,onChange:x})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Açıklama"}),e.jsx("input",{type:"text",name:"description",placeholder:"Örn: Diamond 3 Rank",value:r.description,onChange:x})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Görsel URL"}),e.jsx("input",{type:"text",name:"image_url",placeholder:"https://...",value:r.image_url,onChange:x})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Link URL"}),e.jsx("input",{type:"text",name:"link_url",placeholder:"https://...",value:r.link_url,onChange:x})]}),e.jsxs("div",{className:"modal-actions",children:[e.jsx("button",{className:"cancel-btn",onClick:j,children:"İptal"}),e.jsxs("button",{className:"save-btn",onClick:h?D:A,children:[e.jsx(q,{})," ",h?"Güncelle":"Ekle"]})]})]})})]})})},"ProfileShowcasePanel"),je=t.memo(ne);export{je as default};
