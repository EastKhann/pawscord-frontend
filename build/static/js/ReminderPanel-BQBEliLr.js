import{r,ch as c}from"./react-core-B6hadH-M.js";import{g as C,h as w}from"./index-D_6pZib5.js";const B=({serverId:o,onClose:m})=>{const l=C(),[d,p]=r.useState([]),[E,s]=r.useState(!1),[t,n]=r.useState({title:"",description:"",remind_at:"",repeat:"once",channel_id:"",mention_user_id:""}),[u,h]=r.useState([]),[g,k]=r.useState(!0);r.useEffect(()=>{i(),f()},[o]);const i=async()=>{try{const e=await fetch(`${l}/reminders/server/${o}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(e.ok){const a=await e.json();p(a)}}catch(e){console.error("Error:",e)}finally{k(!1)}},f=async()=>{try{const e=await fetch(`${l}/channels/server/${o}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(e.ok){const a=await e.json();h(a.filter(_=>_.type==="text"))}}catch(e){console.error("Error:",e)}},v=async()=>{if(!t.title||!t.remind_at||!t.channel_id){c.error("âŒ LÃ¼tfen gerekli alanlarÄ± doldurun");return}try{(await fetch(`${l}/reminders/create/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`,"Content-Type":"application/json"},body:JSON.stringify({server_id:o,...t})})).ok?(c.success("âœ… HatÄ±rlatÄ±cÄ± oluÅŸturuldu"),s(!1),i(),n({title:"",description:"",remind_at:"",repeat:"once",channel_id:"",mention_user_id:""})):c.error("âŒ OluÅŸturma hatasÄ±")}catch{c.error("âŒ BaÄŸlantÄ± hatasÄ±")}},y=async e=>{if(await w("HatÄ±rlatÄ±cÄ±yÄ± silmek istediÄŸinize emin misiniz?"))try{(await fetch(`${l}/reminders/${e}/delete/`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}})).ok&&(c.success("âœ… HatÄ±rlatÄ±cÄ± silindi"),i())}catch{c.error("âŒ Silme hatasÄ±")}},N=async e=>{try{(await fetch(`${l}/reminders/${e}/trigger/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}})).ok&&c.success("âœ… HatÄ±rlatÄ±cÄ± tetiklendi")}catch{c.error("âŒ Tetikleme hatasÄ±")}},b=e=>new Date(e).toLocaleString("tr-TR"),R=e=>{const a={once:{text:"Bir kez",color:"#6b7280"},daily:{text:"GÃ¼nlÃ¼k",color:"#3b82f6"},weekly:{text:"HaftalÄ±k",color:"#8b5cf6"},monthly:{text:"AylÄ±k",color:"#ec4899"}};return a[e]||a.once};return React.createElement("div",{className:"reminder-overlay",onClick:m},React.createElement("div",{className:"reminder-panel",onClick:e=>e.stopPropagation()},React.createElement("div",{className:"reminder-header"},React.createElement("h2",null,"â° HatÄ±rlatÄ±cÄ±lar"),React.createElement("button",{className:"close-btn",onClick:m},"Ã—")),React.createElement("div",{className:"reminder-content"},React.createElement("button",{className:"create-reminder-btn",onClick:()=>s(!0)},"+ Yeni HatÄ±rlatÄ±cÄ±"),g?React.createElement("div",{className:"loading-state"},React.createElement("div",{className:"spinner"}),React.createElement("p",null,"YÃ¼kleniyor...")):d.length===0?React.createElement("div",{className:"empty-state"},React.createElement("span",{className:"empty-icon"},"â°"),React.createElement("p",null,"HenÃ¼z hatÄ±rlatÄ±cÄ± yok")):React.createElement("div",{className:"reminders-list"},d.map(e=>React.createElement("div",{key:e.id,className:"reminder-card"},React.createElement("div",{className:"reminder-main"},React.createElement("h3",null,e.title),e.description&&React.createElement("p",null,e.description),React.createElement("div",{className:"reminder-meta"},React.createElement("span",null,"â° ",b(e.remind_at)),React.createElement("span",null,"ğŸ“ # ",u.find(a=>a.id===e.channel_id)?.name),React.createElement("span",{className:"repeat-badge",style:{background:R(e.repeat).color}},"ğŸ”„ ",R(e.repeat).text))),React.createElement("div",{className:"reminder-actions"},React.createElement("button",{className:"trigger-btn",onClick:()=>N(e.id)},"â–¶ï¸ Tetikle"),React.createElement("button",{className:"delete-btn",onClick:()=>y(e.id)},"ğŸ—‘ï¸")))))),E&&React.createElement("div",{className:"create-modal-overlay",onClick:()=>s(!1)},React.createElement("div",{className:"create-modal",onClick:e=>e.stopPropagation()},React.createElement("div",{className:"modal-header"},React.createElement("h3",null,"Yeni HatÄ±rlatÄ±cÄ±"),React.createElement("button",{className:"close-btn",onClick:()=>s(!1)},"Ã—")),React.createElement("div",{className:"modal-body"},React.createElement("div",{className:"form-group"},React.createElement("label",null,"BaÅŸlÄ±k *"),React.createElement("input",{value:t.title,onChange:e=>n({...t,title:e.target.value})})),React.createElement("div",{className:"form-group"},React.createElement("label",null,"AÃ§Ä±klama"),React.createElement("textarea",{value:t.description,onChange:e=>n({...t,description:e.target.value}),rows:"3"})),React.createElement("div",{className:"form-row"},React.createElement("div",{className:"form-group"},React.createElement("label",null,"Tarih/Saat *"),React.createElement("input",{type:"datetime-local",value:t.remind_at,onChange:e=>n({...t,remind_at:e.target.value})})),React.createElement("div",{className:"form-group"},React.createElement("label",null,"Tekrar"),React.createElement("select",{value:t.repeat,onChange:e=>n({...t,repeat:e.target.value})},React.createElement("option",{value:"once"},"Bir kez"),React.createElement("option",{value:"daily"},"GÃ¼nlÃ¼k"),React.createElement("option",{value:"weekly"},"HaftalÄ±k"),React.createElement("option",{value:"monthly"},"AylÄ±k")))),React.createElement("div",{className:"form-group"},React.createElement("label",null,"Kanal *"),React.createElement("select",{value:t.channel_id,onChange:e=>n({...t,channel_id:e.target.value})},React.createElement("option",{value:""},"SeÃ§in"),u.map(e=>React.createElement("option",{key:e.id,value:e.id},"# ",e.name))))),React.createElement("div",{className:"modal-footer"},React.createElement("button",{className:"cancel-btn",onClick:()=>s(!1)},"Ä°ptal"),React.createElement("button",{className:"submit-btn",onClick:v},"â° OluÅŸtur"))))))};export{B as default};
