import{r as l,n as s}from"./react-core-zXIKm1Jm.js";import{H as L,au as I,a as G,aX as H,bo as R,c6 as J,aJ as M}from"./icons-vendor-BBdoVeJd.js";import{t as d}from"./index-BQhmOVgm.js";import"./editor-vendor-DiU449Dh.js";import"./media-vendor-BSOZ7IB3.js";import"./router-vendor-ltdGXAv4.js";import"./crypto-vendor-D_AcF0lD.js";import"./state-vendor-8NbFPBhQ.js";const ee=({fetchWithAuth:a,apiBaseUrl:n,onClose:h})=>{const[t,S]=l.useState({}),[p,f]=l.useState({}),[v,j]=l.useState([]),[b,k]=l.useState(0),[u,c]=l.useState([]),[w,m]=l.useState(!1),[y,P]=l.useState("face_shapes"),[g,C]=l.useState("customize"),T=[{id:"face_shapes",name:"Face",icon:"üë§"},{id:"skin_tones",name:"Skin",icon:"üé®"},{id:"eyes",name:"Eyes",icon:"üëÅÔ∏è"},{id:"eye_colors",name:"Eye Color",icon:"üîµ"},{id:"hairstyles",name:"Hair",icon:"üíá"},{id:"hair_colors",name:"Hair Color",icon:"üåà"},{id:"mouths",name:"Mouth",icon:"üëÑ"},{id:"accessories",name:"Accessories",icon:"üëì"},{id:"backgrounds",name:"Background",icon:"üñºÔ∏è"},{id:"expressions",name:"Expression",icon:"üòä"}];l.useEffect(()=>{A(),B(),_()},[]);const A=async()=>{try{const r=await(await a(`${n}/avatar-studio/parts/`)).json();S(r.parts||{}),k(r.user_coins||0)}catch(e){console.error("Failed to fetch parts:",e)}},B=async()=>{try{const r=await(await a(`${n}/avatar-studio/my-avatar/`)).json();f(r.avatar||F()),j(r.owned_items||[])}catch(e){console.error("Failed to fetch avatar:",e)}},_=async()=>{try{const r=await(await a(`${n}/avatar-studio/presets/`)).json();c(r.presets||[])}catch(e){console.error("Failed to fetch presets:",e)}},F=()=>({face_shape:"round",skin_tone:"medium",eyes:"normal",eye_color:"brown",hairstyle:"short",hair_color:"black",mouth:"smile",accessory:"none",background:"solid_gray",expression:"default"}),N=(e,r)=>{e.replace("s","").replace("_color","_color").replace("_tone","_tone");let i=e;e==="face_shapes"?i="face_shape":e==="skin_tones"?i="skin_tone":e==="hairstyles"?i="hairstyle":e==="mouths"?i="mouth":e==="accessories"?i="accessory":e==="backgrounds"?i="background":e==="expressions"?i="expression":e==="eyes"?i="eyes":e==="eye_colors"?i="eye_color":e==="hair_colors"&&(i="hair_color"),f({...p,[i]:r})},O=async(e,r)=>{m(!0);try{const x=await(await a(`${n}/avatar-studio/purchase/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({category:e,item_id:r})})).json();x.message?(d.success(x.message),k(x.new_balance),j(x.owned_items)):d.error(x.error||"Purchase failed")}catch{d.error("Purchase failed")}finally{m(!1)}},D=async()=>{m(!0);try{const r=await(await a(`${n}/avatar-studio/save/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({config:p})})).json();r.message?d.success("Avatar saved!"):d.error(r.error||"Save failed")}catch{d.error("Save failed")}finally{m(!1)}},E=async()=>{try{const r=await(await a(`${n}/avatar-studio/randomize/`,{method:"POST"})).json();r.avatar&&(f(r.avatar),d.success("Randomized!"))}catch{d.error("Failed to randomize")}},X=async()=>{const e=prompt("Enter preset name:");if(e)try{(await(await a(`${n}/avatar-studio/presets/save/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,config:p})})).json()).preset_id&&(d.success("Preset saved!"),_())}catch{d.error("Failed to save preset")}},$=e=>{f(e.config),C("customize")};return s.jsx("div",{style:o.overlay,children:s.jsxs("div",{style:o.modal,children:[s.jsxs("div",{style:o.header,children:[s.jsxs("div",{style:o.headerLeft,children:[s.jsx(L,{style:{marginRight:"10px",color:"#5865f2"}}),s.jsx("h2",{style:o.title,children:"Avatar Studio"})]}),s.jsxs("div",{style:o.coinsDisplay,children:[s.jsx(I,{style:{color:"#faa61a"}}),s.jsx("span",{children:b})]}),s.jsx("button",{onClick:h,style:o.closeButton,children:s.jsx(G,{})})]}),s.jsxs("div",{style:o.tabs,children:[s.jsxs("button",{onClick:()=>C("customize"),style:g==="customize"?o.activeTab:o.tab,children:[s.jsx(H,{})," Customize"]}),s.jsxs("button",{onClick:()=>C("presets"),style:g==="presets"?o.activeTab:o.tab,children:[s.jsx(R,{})," Presets"]})]}),s.jsxs("div",{style:o.mainContent,children:[g==="customize"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{style:o.previewSection,children:[s.jsx(z,{avatar:p,parts:t}),s.jsxs("div",{style:o.previewActions,children:[s.jsxs("button",{onClick:E,style:o.actionBtn,children:[s.jsx(J,{})," Random"]}),s.jsxs("button",{onClick:X,style:o.actionBtn,children:[s.jsx(R,{})," Save Preset"]}),s.jsxs("button",{onClick:D,style:o.saveBtn,disabled:w,children:[s.jsx(M,{})," ",w?"Saving...":"Save Avatar"]})]})]}),s.jsxs("div",{style:o.customizeSection,children:[s.jsx("div",{style:o.categoryTabs,children:T.map(e=>s.jsxs("button",{onClick:()=>P(e.id),style:y===e.id?o.catActive:o.catBtn,children:[s.jsx("span",{children:e.icon}),s.jsx("span",{style:o.catName,children:e.name})]},e.id))}),s.jsx("div",{style:o.itemsGrid,children:(t[y]||[]).map(e=>{const r=e.free||v.includes(e.id),i=Object.values(p).includes(e.id);return s.jsxs("div",{style:{...o.itemCard,...i?o.itemSelected:{},...r?{}:o.itemLocked},onClick:()=>r&&N(y,e.id),children:[e.color&&e.color!=="gradient"&&e.color!=="galaxy"&&e.color!=="rainbow"?s.jsx("div",{style:{...o.colorSwatch,background:e.color}}):s.jsx("span",{style:o.itemPreview,children:e.name?.charAt(0)||e.id.charAt(0).toUpperCase()}),s.jsx("span",{style:o.itemName,children:e.name||e.id}),!r&&s.jsxs("button",{onClick:x=>{x.stopPropagation(),O(y,e.id)},style:o.buyBtn,disabled:w||b<(e.coins||0),children:[s.jsx(I,{})," ",e.coins]})]},e.id)})})]})]}),g==="presets"&&s.jsxs("div",{style:o.presetsGrid,children:[u.map(e=>s.jsxs("div",{style:o.presetCard,children:[s.jsx(z,{avatar:e.config,parts:t,mini:!0}),s.jsx("span",{style:o.presetName,children:e.name}),s.jsx("button",{onClick:()=>$(e),style:o.loadBtn,children:"Load"})]},e.id)),u.length===0&&s.jsx("p",{style:o.emptyText,children:"No presets saved yet"})]})]})]})})},z=({avatar:a,parts:n,mini:h=!1})=>{const t=h?80:200,p=n.backgrounds?.find(c=>c.id===a.background)?.color||"#36393f",v=n.skin_tones?.find(c=>c.id===a.skin_tone)?.color||"#D2B48C",b=n.hair_colors?.find(c=>c.id===a.hair_color)?.color||"#1C1C1C",u=n.eye_colors?.find(c=>c.id===a.eye_color)?.color||"#8B4513";return s.jsxs("div",{style:{width:t,height:t,borderRadius:"50%",background:p,display:"flex",alignItems:"center",justifyContent:"center",position:"relative",overflow:"hidden",border:"4px solid #40444b"},children:[s.jsxs("div",{style:{width:t*.7,height:t*.8,borderRadius:a.face_shape==="round"?"50%":a.face_shape==="oval"?"50% 50% 45% 45%":a.face_shape==="square"?"10%":"50%",background:v,position:"relative"},children:[s.jsx("div",{style:{position:"absolute",top:-t*.1,left:"50%",transform:"translateX(-50%)",width:t*.7,height:t*.3,background:b,borderRadius:"50% 50% 0 0"}}),s.jsxs("div",{style:{position:"absolute",top:"35%",left:"50%",transform:"translateX(-50%)",display:"flex",gap:t*.15},children:[s.jsx("div",{style:{width:t*.1,height:t*.1,borderRadius:"50%",background:u}}),s.jsx("div",{style:{width:t*.1,height:t*.1,borderRadius:"50%",background:u}})]}),s.jsx("div",{style:{position:"absolute",bottom:"20%",left:"50%",transform:"translateX(-50%)",width:t*.2,height:t*.05,background:a.mouth==="smile"?"#e8a0a0":"#d4a0a0",borderRadius:a.mouth==="smile"?"0 0 50% 50%":"4px"}})]}),a.accessory==="glasses"&&s.jsx("div",{style:{position:"absolute",top:"32%",left:"50%",transform:"translateX(-50%)",width:t*.5,height:t*.12,border:"2px solid #333",borderRadius:"4px",background:"transparent"}}),a.accessory==="crown"&&s.jsx("div",{style:{position:"absolute",top:0,left:"50%",transform:"translateX(-50%)",fontSize:t*.2},children:"üëë"}),a.accessory==="cat_ears"&&s.jsx("div",{style:{position:"absolute",top:t*.05,left:"50%",transform:"translateX(-50%)",fontSize:t*.15},children:"üê±"})]})},o={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e4},modal:{backgroundColor:"#2f3136",borderRadius:"12px",width:"900px",maxHeight:"90vh",overflow:"hidden",display:"flex",flexDirection:"column"},header:{display:"flex",alignItems:"center",padding:"20px",borderBottom:"1px solid #40444b"},headerLeft:{display:"flex",alignItems:"center",flex:1},title:{margin:0,color:"#fff",fontSize:"20px"},coinsDisplay:{display:"flex",alignItems:"center",gap:"6px",color:"#fff",marginRight:"20px",background:"#40444b",padding:"6px 12px",borderRadius:"20px"},closeButton:{background:"none",border:"none",color:"#b9bbbe",cursor:"pointer",fontSize:"20px"},tabs:{display:"flex",padding:"10px 20px",gap:"10px",borderBottom:"1px solid #40444b"},tab:{background:"#40444b",border:"none",color:"#b9bbbe",padding:"8px 16px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},activeTab:{background:"#5865f2",border:"none",color:"#fff",padding:"8px 16px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},mainContent:{display:"flex",padding:"20px",gap:"20px",overflowY:"auto",flex:1},previewSection:{width:"250px",display:"flex",flexDirection:"column",alignItems:"center",gap:"20px"},previewActions:{display:"flex",flexDirection:"column",gap:"10px",width:"100%"},actionBtn:{background:"#40444b",border:"none",color:"#fff",padding:"10px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},saveBtn:{background:"#57f287",border:"none",color:"#000",padding:"12px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",fontWeight:"bold"},customizeSection:{flex:1},categoryTabs:{display:"flex",flexWrap:"wrap",gap:"8px",marginBottom:"15px"},catBtn:{background:"#40444b",border:"none",color:"#b9bbbe",padding:"8px 12px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",fontSize:"12px"},catActive:{background:"#5865f2",border:"none",color:"#fff",padding:"8px 12px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",fontSize:"12px"},catName:{display:"none"},itemsGrid:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"10px"},itemCard:{background:"#40444b",borderRadius:"8px",padding:"12px",display:"flex",flexDirection:"column",alignItems:"center",gap:"8px",cursor:"pointer",position:"relative"},itemSelected:{border:"2px solid #5865f2",background:"#36393f"},itemLocked:{opacity:.7,cursor:"default"},colorSwatch:{width:"40px",height:"40px",borderRadius:"50%",border:"2px solid #fff"},itemPreview:{width:"40px",height:"40px",borderRadius:"50%",background:"#5865f2",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontWeight:"bold"},itemName:{color:"#dcddde",fontSize:"11px",textAlign:"center"},buyBtn:{position:"absolute",bottom:"8px",right:"8px",background:"#faa61a",border:"none",color:"#000",padding:"4px 8px",borderRadius:"4px",cursor:"pointer",fontSize:"10px",display:"flex",alignItems:"center",gap:"4px"},presetsGrid:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"15px",width:"100%"},presetCard:{background:"#40444b",borderRadius:"10px",padding:"15px",display:"flex",flexDirection:"column",alignItems:"center",gap:"10px"},presetName:{color:"#fff",fontSize:"14px"},loadBtn:{background:"#5865f2",border:"none",color:"#fff",padding:"6px 16px",borderRadius:"4px",cursor:"pointer"},emptyText:{color:"#72767d",textAlign:"center",gridColumn:"1 / -1",padding:"40px"}};export{ee as default};
