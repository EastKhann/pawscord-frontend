import{r as s,ch as l}from"./react-core-B6hadH-M.js";import{g as k}from"./index-D_6pZib5.js";const S=({serverId:r,onClose:i})=>{const n=k(),[a,c]=s.useState({enabled:!1,channel_id:"",emoji:"â­",threshold:3,self_star:!1,allow_nsfw:!1}),[o,h]=s.useState([]),[E,R]=s.useState([]),[g,u]=s.useState(!0);s.useEffect(()=>{p(),d(),f()},[r]);const p=async()=>{try{const e=await fetch(`${n}/starboard/server/${r}/config/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(e.ok){const t=await e.json();c(t)}}catch(e){console.error("Error:",e)}finally{u(!1)}},d=async()=>{try{const e=await fetch(`${n}/starboard/server/${r}/messages/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(e.ok){const t=await e.json();h(t)}}catch(e){console.error("Error:",e)}},f=async()=>{try{const e=await fetch(`${n}/channels/server/${r}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(e.ok){const t=await e.json();R(t.filter(m=>m.type==="text"))}}catch(e){console.error("Error:",e)}},v=async()=>{try{(await fetch(`${n}/starboard/server/${r}/config/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`,"Content-Type":"application/json"},body:JSON.stringify(a)})).ok?l.success("âœ… Starboard ayarlarÄ± kaydedildi"):l.error("âŒ Kaydetme hatasÄ±")}catch{l.error("âŒ BaÄŸlantÄ± hatasÄ±")}},b=async e=>{try{(await fetch(`${n}/starboard/message/${e}/remove/`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}})).ok&&(l.success("âœ… Mesaj kaldÄ±rÄ±ldÄ±"),d())}catch{l.error("âŒ Silme hatasÄ±")}};return React.createElement("div",{className:"starboard-overlay",onClick:i},React.createElement("div",{className:"starboard-panel",onClick:e=>e.stopPropagation()},React.createElement("div",{className:"starboard-header"},React.createElement("h2",null,"â­ Starboard"),React.createElement("button",{className:"close-btn",onClick:i},"Ã—")),React.createElement("div",{className:"starboard-content"},g?React.createElement("div",{className:"loading-state"},React.createElement("div",{className:"spinner"}),React.createElement("p",null,"YÃ¼kleniyor...")):React.createElement(React.Fragment,null,React.createElement("div",{className:"config-section"},React.createElement("div",{className:"section-header"},React.createElement("h3",null,"âš™ï¸ Ayarlar"),React.createElement("label",{className:"toggle-switch"},React.createElement("input",{type:"checkbox",checked:a.enabled,onChange:e=>c({...a,enabled:e.target.checked})}),React.createElement("span",{className:"toggle-slider"}))),React.createElement("div",{className:"config-grid"},React.createElement("div",{className:"form-group"},React.createElement("label",null,"ğŸ“¢ Starboard KanalÄ±"),React.createElement("select",{value:a.channel_id,onChange:e=>c({...a,channel_id:e.target.value})},React.createElement("option",{value:""},"SeÃ§in"),E.map(e=>React.createElement("option",{key:e.id,value:e.id},"# ",e.name)))),React.createElement("div",{className:"form-group"},React.createElement("label",null,"â­ Emoji"),React.createElement("input",{type:"text",value:a.emoji,onChange:e=>c({...a,emoji:e.target.value}),placeholder:"â­"})),React.createElement("div",{className:"form-group"},React.createElement("label",null,"ğŸ¯ EÅŸik DeÄŸeri"),React.createElement("input",{type:"number",min:"1",max:"50",value:a.threshold,onChange:e=>c({...a,threshold:parseInt(e.target.value)})}),React.createElement("small",null,"MesajÄ±n starboard'a eklenebilmesi iÃ§in gereken minimum yÄ±ldÄ±z sayÄ±sÄ±")),React.createElement("div",{className:"form-group"},React.createElement("label",{className:"checkbox-label"},React.createElement("input",{type:"checkbox",checked:a.self_star,onChange:e=>c({...a,self_star:e.target.checked})}),React.createElement("span",null,"Kendi mesajÄ±na yÄ±ldÄ±z verebilir"))),React.createElement("div",{className:"form-group"},React.createElement("label",{className:"checkbox-label"},React.createElement("input",{type:"checkbox",checked:a.allow_nsfw,onChange:e=>c({...a,allow_nsfw:e.target.checked})}),React.createElement("span",null,"NSFW kanallardan izin ver")))),React.createElement("button",{className:"save-btn",onClick:v},"ğŸ’¾ Kaydet")),React.createElement("div",{className:"stars-section"},React.createElement("h3",null,"â­ Starboard MesajlarÄ± (",o.length,")"),o.length===0?React.createElement("div",{className:"empty-state"},React.createElement("span",{className:"empty-icon"},"â­"),React.createElement("p",null,"HenÃ¼z starboard mesajÄ± yok")):React.createElement("div",{className:"stars-list"},o.map(e=>React.createElement("div",{key:e.message_id,className:"star-card"},React.createElement("div",{className:"star-header"},React.createElement("div",{className:"star-author"},e.author_avatar?React.createElement("img",{src:e.author_avatar,alt:""}):React.createElement("div",{className:"default-avatar"},"ğŸ‘¤"),React.createElement("span",null,e.author_name)),React.createElement("div",{className:"star-count"},React.createElement("span",null,a.emoji," ",e.star_count))),React.createElement("div",{className:"star-content"},React.createElement("p",null,e.content),e.attachments&&e.attachments.length>0&&React.createElement("div",{className:"star-attachments"},e.attachments.map((t,m)=>React.createElement("img",{key:m,src:t,alt:""})))),React.createElement("div",{className:"star-footer"},React.createElement("span",{className:"star-channel"},"# ",e.channel_name),React.createElement("span",{className:"star-time"},new Date(e.created_at).toLocaleString("tr-TR")),React.createElement("button",{className:"remove-btn",onClick:()=>b(e.message_id)},"ğŸ—‘ï¸"))))))))))};export{S as default};
