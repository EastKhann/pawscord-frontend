var E=Object.defineProperty;var t=(a,d)=>E(a,"name",{value:d,configurable:!0});import{r as p,j as e}from"./react-core-Djgtqrmb.js";import{b9 as C,a as F,an as N,ap as O,bu as T,g as $}from"./icons-vendor-BMXAt4pj.js";import{t as l}from"./index-DjBRFZUD.js";import"./media-vendor-CxFPycob.js";import"./router-vendor-gmJ9Mn-1.js";import"./state-vendor-BRqaXHJQ.js";import"./crypto-vendor-D1XRGppi.js";import"./ui-vendor-IhB9Znpc.js";const q=t(({fetchWithAuth:a,apiBaseUrl:d,serverId:h,onClose:b})=>{const[x,j]=p.useState([]),[S,R]=p.useState(!0),[v,g]=p.useState(!1),[i,u]=p.useState({name:"",color:"#5865f2",permissions:[]}),[c,k]=p.useState(null);p.useEffect(()=>{f()},[]);const f=t(async()=>{try{R(!0);const o=await a(`${d}/servers/${h}/roles/list/`);if(o.ok){const s=await o.json();j(s.sort((n,y)=>(y.position||0)-(n.position||0)))}}catch{l.error("Roller yÃ¼klenemedi")}finally{R(!1)}},"loadRoles"),w=t(async()=>{if(!i.name.trim()){l.error("Rol adÄ± gerekli");return}try{(await a(`${d}/servers/${h}/roles/create/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).ok?(l.success("Rol oluÅŸturuldu"),u({name:"",color:"#5865f2",permissions:[]}),g(!1),f()):l.error("Rol oluÅŸturulamadÄ±")}catch{l.error("Bir hata oluÅŸtu")}},"createRole"),B=t(async o=>{if(confirm("Bu rolÃ¼ silmek istediÄŸinize emin misiniz?"))try{(await a(`${d}/roles/${o}/delete/`,{method:"DELETE"})).ok?(l.success("Rol silindi"),f()):l.error("Rol silinemedi")}catch{l.error("Bir hata oluÅŸtu")}},"deleteRole"),z=t(o=>{k(o)},"handleDragStart"),I=t((o,s)=>{if(o.preventDefault(),!c||c.id===s.id)return;const n=[...x],y=n.findIndex(m=>m.id===c.id),P=n.findIndex(m=>m.id===s.id);n.splice(y,1),n.splice(P,0,c),j(n)},"handleDragOver"),D=t(async()=>{if(c){try{(await a(`${d}/roles/reorder/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({roles:x.map((s,n)=>({id:s.id,position:x.length-n}))})})).ok&&l.success("Rol sÄ±ralamasÄ± gÃ¼ncellendi")}catch{l.error("Bir hata oluÅŸtu")}k(null)}},"handleDragEnd");return e.jsx("div",{style:r.overlay,onClick:b,children:e.jsxs("div",{style:r.modal,onClick:t(o=>o.stopPropagation(),"onClick"),children:[e.jsxs("div",{style:r.header,children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(C,{style:{color:"#5865f2"}}),e.jsx("h2",{style:{margin:0},children:"Sunucu Rolleri"})]}),e.jsx(F,{onClick:b,style:r.closeBtn})]}),e.jsxs("div",{style:r.toolbar,children:[e.jsxs("button",{onClick:t(()=>g(!v),"onClick"),style:r.newRoleBtn,children:[e.jsx(N,{})," Yeni Rol"]}),e.jsx("p",{style:{fontSize:"12px",color:"#888",margin:"10px 0 0 0"},children:"ðŸ’¡ Rolleri sÃ¼rÃ¼kleyerek hiyerarÅŸiyi deÄŸiÅŸtirebilirsiniz"})]}),v&&e.jsxs("div",{style:r.newRoleForm,children:[e.jsx("input",{type:"text",placeholder:"Rol adÄ±...",value:i.name,onChange:t(o=>u({...i,name:o.target.value}),"onChange"),style:r.input}),e.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center",marginBottom:"15px"},children:[e.jsx(O,{style:{color:"#888"}}),e.jsx("input",{type:"color",value:i.color,onChange:t(o=>u({...i,color:o.target.value}),"onChange"),style:r.colorPicker}),e.jsx("span",{style:{color:"#dcddde",fontSize:"14px"},children:i.color})]}),e.jsxs("div",{style:{display:"flex",gap:"10px"},children:[e.jsx("button",{onClick:w,style:r.saveBtn,children:"OluÅŸtur"}),e.jsx("button",{onClick:t(()=>g(!1),"onClick"),style:r.cancelBtn,children:"Ä°ptal"})]})]}),e.jsx("div",{style:r.rolesList,children:S?e.jsx("div",{style:r.loading,children:"YÃ¼kleniyor..."}):x.length===0?e.jsxs("div",{style:r.empty,children:[e.jsx(C,{style:{fontSize:"48px",color:"#555"}}),e.jsx("p",{children:"HenÃ¼z rol yok"})]}):x.map((o,s)=>e.jsxs("div",{draggable:!0,onDragStart:t(()=>z(o),"onDragStart"),onDragOver:t(n=>I(n,o),"onDragOver"),onDragEnd:D,style:{...r.roleItem,opacity:c?.id===o.id?.5:1},children:[e.jsx("div",{style:r.dragHandle,children:e.jsx(T,{style:{color:"#888"}})}),e.jsx("div",{style:{...r.roleColor,backgroundColor:o.color||"#5865f2"}}),e.jsxs("div",{style:r.roleContent,children:[e.jsx("div",{style:r.roleName,children:o.name}),e.jsxs("div",{style:r.roleMeta,children:["Pozisyon: ",s+1," â€¢ ",o.member_count||0," Ã¼ye"]})]}),!o.is_default&&e.jsx("button",{onClick:t(()=>B(o.id),"onClick"),style:r.deleteBtn,title:"Sil",children:e.jsx($,{})})]},o.id))})]})})},"ServerRolesPanel"),r={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999},modal:{backgroundColor:"#1e1e1e",borderRadius:"8px",width:"90%",maxWidth:"600px",maxHeight:"90vh",display:"flex",flexDirection:"column",color:"#fff"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #333"},closeBtn:{cursor:"pointer",fontSize:"24px",color:"#888"},toolbar:{padding:"15px 20px",borderBottom:"1px solid #333"},newRoleBtn:{backgroundColor:"#5865f2",color:"#fff",border:"none",padding:"10px 20px",borderRadius:"4px",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",fontSize:"14px",fontWeight:"500"},newRoleForm:{padding:"20px",backgroundColor:"#2c2f33",borderBottom:"1px solid #333"},input:{width:"100%",padding:"10px",backgroundColor:"#1e1e1e",border:"1px solid #444",borderRadius:"4px",color:"#fff",fontSize:"14px",marginBottom:"15px"},colorPicker:{width:"60px",height:"40px",border:"none",borderRadius:"4px",cursor:"pointer"},saveBtn:{flex:1,backgroundColor:"#43b581",color:"#fff",border:"none",padding:"10px",borderRadius:"4px",cursor:"pointer",fontSize:"14px",fontWeight:"500"},cancelBtn:{flex:1,backgroundColor:"#4e5058",color:"#fff",border:"none",padding:"10px",borderRadius:"4px",cursor:"pointer",fontSize:"14px",fontWeight:"500"},rolesList:{flex:1,overflowY:"auto",padding:"20px"},roleItem:{display:"flex",gap:"15px",padding:"12px",backgroundColor:"#2c2f33",borderRadius:"8px",marginBottom:"8px",alignItems:"center",cursor:"move",transition:"opacity 0.2s"},dragHandle:{cursor:"grab",padding:"5px"},roleColor:{width:"4px",height:"40px",borderRadius:"2px"},roleContent:{flex:1},roleName:{fontWeight:"600",marginBottom:"4px"},roleMeta:{fontSize:"12px",color:"#888"},deleteBtn:{backgroundColor:"transparent",border:"none",color:"#ed4245",cursor:"pointer",fontSize:"18px",padding:"8px"},loading:{textAlign:"center",padding:"40px",color:"#888"},empty:{textAlign:"center",padding:"60px 20px",color:"#888"}};export{q as default};
