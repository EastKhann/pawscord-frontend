var N=Object.defineProperty;var l=(n,d)=>N(n,"name",{value:d,configurable:!0});import{r as p,j as e}from"./react-core-Djgtqrmb.js";import{y as w}from"./ui-vendor-IhB9Znpc.js";import{g as f}from"./index-GGLPABCW.js";import"./media-vendor-CxFPycob.js";import"./router-vendor-ClgLnMjk.js";import"./state-vendor-BRqaXHJQ.js";import"./crypto-vendor-D1XRGppi.js";import"./icons-vendor-BW7dxHkX.js";const C={welcome_enabled:!1,welcome_channel_id:"",welcome_message:"HoÅŸ geldin {user}! {server} sunucusuna katÄ±ldÄ±n!",welcome_embed:!1,welcome_embed_color:"#5865f2",welcome_embed_title:"HoÅŸ Geldin!",welcome_embed_description:"{user} sunucuya katÄ±ldÄ±!",welcome_dm:!1,welcome_dm_message:"Merhaba {user}! {server} sunucusuna hoÅŸ geldin!",goodbye_enabled:!1,goodbye_channel_id:"",goodbye_message:"{user} sunucudan ayrÄ±ldÄ±. HoÅŸÃ§a kal!",goodbye_embed:!1,goodbye_embed_color:"#ed4245",auto_role_enabled:!1,auto_role_ids:[]},S=[{code:"{user}",desc:"KullanÄ±cÄ± adÄ±"},{code:"{user_mention}",desc:"KullanÄ±cÄ± mention"},{code:"{server}",desc:"Sunucu adÄ±"},{code:"{member_count}",desc:"Ãœye sayÄ±sÄ±"},{code:"{user_id}",desc:"KullanÄ±cÄ± ID"}],M=l(n=>{const[d,s]=p.useState(C),[o,h]=p.useState([]),[j,b]=p.useState([]),[x,g]=p.useState(null),[_,u]=p.useState(!0),c=f(),i=l(()=>({Authorization:`Bearer ${localStorage.getItem("access_token")}`}),"headers"),r=l(async()=>{try{const t=await fetch(`${c}/welcome-messages/server/${n}/`,{headers:i()});if(t.ok){const m=await t.json();m.config&&s(m.config)}}catch{}finally{u(!1)}},"fetchConfig"),v=l(async()=>{try{const t=await fetch(`${c}/servers/${n}/channels/`,{headers:i()});if(t.ok){const m=await t.json();h(m.channels||[])}}catch{}},"fetchChannels"),k=l(async()=>{try{const t=await fetch(`${c}/servers/${n}/roles/`,{headers:i()});if(t.ok){const m=await t.json();b(m.roles||[])}}catch{}},"fetchRoles"),a=l(async()=>{try{const t=await fetch(`${c}/welcome-messages/server/${n}/stats/`,{headers:i()});t.ok&&g(await t.json())}catch{}},"fetchStats");return p.useEffect(()=>{n&&(r(),v(),k(),a())},[n]),{welcomeConfig:d,updateConfig:l((t,m)=>s({...d,[t]:m}),"updateConfig"),insertVariable:l((t,m)=>s({...d,[t]:d[t]+` ${m}`}),"insertVariable"),channels:o,roles:j,stats:x,loading:_,saveConfig:l(async()=>{try{(await fetch(`${c}/welcome-messages/server/${n}/update/`,{method:"POST",headers:{...i(),"Content-Type":"application/json"},body:JSON.stringify(d)})).ok?(w.success("âœ… KarÅŸÄ±lama ayarlarÄ± kaydedildi"),a()):w.error("âŒ Kaydetme baÅŸarÄ±sÄ±z")}catch{w.error("âŒ Kaydetme baÅŸarÄ±sÄ±z")}},"saveConfig"),testWelcomeMessage:l(async()=>{try{(await fetch(`${c}/welcome-messages/server/${n}/test/`,{method:"POST",headers:{...i(),"Content-Type":"application/json"},body:JSON.stringify({type:"welcome"})})).ok?w.success("âœ… Test mesajÄ± gÃ¶nderildi"):w.error("âŒ Test mesajÄ± gÃ¶nderilemedi")}catch{w.error("âŒ Test baÅŸarÄ±sÄ±z")}},"testWelcomeMessage")}},"useWelcomeMessages"),y=l(({title:n,icon:d,config:s,enabledKey:o,channelKey:h,messageKey:j,embedKey:b,embedColorKey:x,embedTitleKey:g,embedDescKey:_,dmKey:u,dmMessageKey:c,channels:i,updateConfig:r,insertVariable:v,onTest:k})=>e.jsxs("div",{className:"config-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsxs("h3",{children:[d," ",n]}),e.jsxs("label",{className:"toggle-switch",children:[e.jsx("input",{type:"checkbox",checked:s[o],onChange:l(a=>r(o,a.target.checked),"onChange")}),e.jsx("span",{className:"slider"}),e.jsx("span",{className:"toggle-label",children:s[o]?"âœ“ Aktif":"âœ— Pasif"})]})]}),e.jsxs("div",{className:"form-grid",children:[e.jsxs("div",{className:"form-group full-width",children:[e.jsx("label",{children:h.includes("goodbye")?"Veda KanalÄ±":"KarÅŸÄ±lama KanalÄ±"}),e.jsxs("select",{value:s[h],onChange:l(a=>r(h,a.target.value),"onChange"),disabled:!s[o],children:[e.jsxs("option",{value:"",children:["Kanal se","Ã§","in"]}),i.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]})]}),e.jsxs("div",{className:"form-group full-width",children:[e.jsx("label",{children:h.includes("goodbye")?"Veda MesajÄ±":"HoÅŸ Geldin MesajÄ±"}),e.jsx("textarea",{value:s[j],onChange:l(a=>r(j,a.target.value),"onChange"),disabled:!s[o],rows:"3"}),e.jsx("div",{className:"variables-bar",children:S.map(a=>e.jsx("button",{className:"variable-btn",onClick:l(()=>v(j,a.code),"onClick"),disabled:!s[o],title:a.desc,children:a.code},a.code))})]}),e.jsx("div",{className:"form-group",children:e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:s[b],onChange:l(a=>r(b,a.target.checked),"onChange"),disabled:!s[o]}),e.jsxs("span",{children:["Embed olarak g","Ã¶","nder"]})]})}),s[b]&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Embed Rengi"}),e.jsx("input",{type:"color",value:s[x],onChange:l(a=>r(x,a.target.value),"onChange"),disabled:!s[o]})]}),g&&e.jsxs("div",{className:"form-group full-width",children:[e.jsxs("label",{children:["Embed Ba","ÅŸ","l","Ä±","k"]}),e.jsx("input",{type:"text",value:s[g],onChange:l(a=>r(g,a.target.value),"onChange"),disabled:!s[o]})]}),_&&e.jsxs("div",{className:"form-group full-width",children:[e.jsxs("label",{children:["Embed A","Ã§Ä±","klama"]}),e.jsx("textarea",{value:s[_],onChange:l(a=>r(_,a.target.value),"onChange"),disabled:!s[o],rows:"3"})]})]}),u&&e.jsx("div",{className:"form-group full-width",children:e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:s[u],onChange:l(a=>r(u,a.target.checked),"onChange"),disabled:!s[o]}),e.jsxs("span",{children:["Kullan","Ä±","c","Ä±","ya DM g","Ã¶","nder"]})]})}),u&&s[u]&&c&&e.jsxs("div",{className:"form-group full-width",children:[e.jsxs("label",{children:["DM Mesaj","Ä±"]}),e.jsx("textarea",{value:s[c],onChange:l(a=>r(c,a.target.value),"onChange"),disabled:!s[o],rows:"3"})]})]}),k&&e.jsxs("button",{className:"test-btn",onClick:k,disabled:!s[o],children:["ðŸ§ª"," Test Et"]})]}),"MessageSection"),$=[{icon:"ðŸ‘‹",key:"total_welcomes",label:"Toplam KarÅŸÄ±lama"},{icon:"ðŸ˜¢",key:"total_goodbyes",label:"Toplam Veda"},{icon:"ðŸ“…",key:"welcomes_today",label:"BugÃ¼n KatÄ±lan"}],F=l(({serverId:n,onClose:d})=>{const{welcomeConfig:s,updateConfig:o,insertVariable:h,channels:j,roles:b,stats:x,loading:g,saveConfig:_,testWelcomeMessage:u}=M(n);return g?e.jsx("div",{className:"welcome-messages-overlay",children:e.jsx("div",{className:"welcome-messages-panel",children:e.jsxs("div",{className:"loading-state",children:[e.jsx("div",{className:"spinner"}),e.jsxs("p",{children:["Kar","ÅŸÄ±","lama mesajlar","Ä±"," y","Ã¼","kleniyor..."]})]})})}):e.jsx("div",{className:"welcome-messages-overlay",onClick:d,children:e.jsxs("div",{className:"welcome-messages-panel",onClick:l(c=>c.stopPropagation(),"onClick"),children:[e.jsxs("div",{className:"welcome-header",children:[e.jsxs("h2",{children:["ðŸ‘‹"," Kar","ÅŸÄ±","lama & Veda Mesajlar","Ä±"]}),e.jsx("button",{className:"close-btn",onClick:d,children:"Ã—"})]}),x&&e.jsx("div",{className:"stats-overview",children:$.map(c=>e.jsxs("div",{className:"stat-card",children:[e.jsx("span",{className:"stat-icon",children:c.icon}),e.jsx("span",{className:"stat-value",children:x[c.key]||0}),e.jsx("span",{className:"stat-label",children:c.label})]},c.key))}),e.jsxs("div",{className:"config-content",children:[e.jsx(y,{title:"HoÅŸ Geldin MesajlarÄ±",icon:"ðŸ‘‹",config:s,enabledKey:"welcome_enabled",channelKey:"welcome_channel_id",messageKey:"welcome_message",embedKey:"welcome_embed",embedColorKey:"welcome_embed_color",embedTitleKey:"welcome_embed_title",embedDescKey:"welcome_embed_description",dmKey:"welcome_dm",dmMessageKey:"welcome_dm_message",channels:j,updateConfig:o,insertVariable:h,onTest:u}),e.jsx(y,{title:"Veda MesajlarÄ±",icon:"ðŸ˜¢",config:s,enabledKey:"goodbye_enabled",channelKey:"goodbye_channel_id",messageKey:"goodbye_message",embedKey:"goodbye_embed",embedColorKey:"goodbye_embed_color",channels:j,updateConfig:o,insertVariable:h}),e.jsxs("div",{className:"config-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsxs("h3",{children:["â­"," Otomatik Rol"]}),e.jsxs("label",{className:"toggle-switch",children:[e.jsx("input",{type:"checkbox",checked:s.auto_role_enabled,onChange:l(c=>o("auto_role_enabled",c.target.checked),"onChange")}),e.jsx("span",{className:"slider"}),e.jsx("span",{className:"toggle-label",children:s.auto_role_enabled?"âœ“ Aktif":"âœ— Pasif"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Otomatik verilecek roller"}),e.jsx("div",{className:"roles-selector",children:b.map(c=>e.jsxs("label",{className:"role-checkbox",children:[e.jsx("input",{type:"checkbox",checked:s.auto_role_ids.includes(c.id),onChange:l(i=>{const r=i.target.checked?[...s.auto_role_ids,c.id]:s.auto_role_ids.filter(v=>v!==c.id);o("auto_role_ids",r)},"onChange"),disabled:!s.auto_role_enabled}),e.jsx("span",{children:c.name})]},c.id))})]})]}),e.jsxs("button",{className:"save-btn",onClick:_,children:["ðŸ’¾"," Ayarlar","Ä±"," Kaydet"]})]})]})})},"WelcomeMessagesPanel");export{F as default};
