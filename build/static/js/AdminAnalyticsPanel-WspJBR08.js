import{r as v,n as e,p as b,A as G,C as p,X as f,Y as h,T as j,y as A,L as K,s as R,B as P,t as M}from"./react-core-zXIKm1Jm.js";import{R as z,an as W,a as V,t as u,as as I,C as k,aB as w,au as T,a3 as m,a8 as $,aI as E,x as U,b5 as Y,aL as Z,b6 as N,b7 as q}from"./icons-vendor-DZdpmN99.js";import"./editor-vendor-DiU449Dh.js";const se=({onClose:l,fetchWithAuth:s,apiBaseUrl:t})=>{const[o,c]=v.useState(null),[B,D]=v.useState(!0),[n,y]=v.useState("overview");v.useEffect(()=>{L();const a=setInterval(L,3e4);return()=>clearInterval(a)},[]);const L=async()=>{try{const a=await s(`${t}/admin/analytics/`);if(a.ok){const _=await a.json();c(_)}}catch(a){console.error("Analytics fetch error:",a)}finally{D(!1)}},F=()=>{if(!o)return;const a=JSON.stringify(o,null,2),_=new Blob([a],{type:"application/json"}),O=URL.createObjectURL(_),S=document.createElement("a");S.href=O,S.download=`analytics_${new Date().toISOString().split("T")[0]}.json`,S.click()};return B?e.jsx("div",{style:i.overlay,children:e.jsx("div",{style:i.modal,children:e.jsx("div",{style:i.loading,children:"YÃ¼kleniyor..."})})}):o?e.jsx("div",{style:i.overlay,onClick:l,children:e.jsxs("div",{style:i.modal,onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{style:i.header,children:[e.jsxs("div",{style:i.headerLeft,children:[e.jsx(z,{size:24}),e.jsx("h2",{style:i.title,children:"Admin Analytics"})]}),e.jsxs("div",{style:i.headerRight,children:[e.jsx("button",{onClick:F,style:i.exportButton,title:"Export JSON",children:e.jsx(W,{})}),e.jsx("button",{onClick:l,style:i.closeButton,children:e.jsx(V,{})})]})]}),e.jsxs("div",{style:i.tabs,children:[e.jsxs("button",{onClick:()=>y("overview"),style:{...i.tab,...n==="overview"&&i.activeTab},children:[e.jsx(z,{})," Genel"]}),e.jsxs("button",{onClick:()=>y("users"),style:{...i.tab,...n==="users"&&i.activeTab},children:[e.jsx(u,{})," KullanÄ±cÄ±lar"]}),e.jsxs("button",{onClick:()=>y("premium"),style:{...i.tab,...n==="premium"&&i.activeTab},children:[e.jsx(I,{})," Premium"]}),e.jsxs("button",{onClick:()=>y("servers"),style:{...i.tab,...n==="servers"&&i.activeTab},children:[e.jsx(k,{})," Sunucular"]})]}),e.jsxs("div",{style:i.content,children:[n==="overview"&&e.jsx(J,{stats:o}),n==="users"&&e.jsx(X,{stats:o}),n==="premium"&&e.jsx(H,{stats:o}),n==="servers"&&e.jsx(Q,{stats:o})]})]})}):e.jsx("div",{style:i.overlay,children:e.jsx("div",{style:i.modal,children:e.jsx("div",{style:i.error,children:"Analytics verisi yÃ¼klenemedi"})})})},J=({stats:l})=>(l.mobile_views,l.desktop_views,e.jsxs("div",{style:i.tabContent,children:[e.jsxs("div",{style:i.growthSection,children:[e.jsx(g,{label:"Mesaj ArtÄ±ÅŸÄ± (24h)",value:l.message_growth_24h||0,isPositive:(l.message_growth_24h||0)>=0}),e.jsx(g,{label:"KayÄ±t ArtÄ±ÅŸÄ± (24h)",value:l.signup_growth_24h||0,isPositive:(l.signup_growth_24h||0)>=0}),e.jsx(g,{label:"GÃ¼nlÃ¼k Ort. Mesaj",value:l.avg_messages_per_day||0,isPositive:!0,suffix:"",icon:e.jsx(w,{})}),e.jsx(g,{label:"GÃ¼nlÃ¼k Ort. KayÄ±t",value:l.avg_signups_per_day||0,isPositive:!0,suffix:"",icon:e.jsx(T,{})})]}),e.jsxs("div",{style:i.statsGrid,children:[e.jsx(r,{icon:e.jsx(u,{}),label:"Toplam KullanÄ±cÄ±",value:l.total_users||0,color:"#5865f2",subtitle:`Online: ${l.online_users||0} | Aktif: ${l.active_users||0}`}),e.jsx(r,{icon:e.jsx(k,{}),label:"Toplam Sunucu",value:l.total_servers||0,color:"#23a559",subtitle:`Son 24h: +${l.new_servers_24h||0}`}),e.jsx(r,{icon:e.jsx(w,{}),label:"Toplam Mesaj",value:d(l.total_messages||0),color:"#f0b132",subtitle:`Son 24h: ${d(l.messages_24h||0)}`}),e.jsx(r,{icon:e.jsx(m,{}),label:"Toplam Ziyaret",value:d(l.total_page_views||0),color:"#e91e63",subtitle:`Son 24h: ${d(l.page_views_24h||0)}`}),e.jsx(r,{icon:e.jsx(I,{}),label:"Premium KullanÄ±cÄ±",value:l.premium_users||0,color:"#9b59b6",subtitle:`Gelir: ${l.monthly_revenue||0} TL/ay`}),e.jsx(r,{icon:e.jsx($,{}),label:"Benzersiz ZiyaretÃ§i",value:d(l.unique_visitors_30d||0),color:"#00bcd4",subtitle:`Son 24h: ${d(l.unique_visitors_24h||0)}`})]}),(l.mobile_views>0||l.desktop_views>0)&&e.jsxs("div",{style:i.section,children:[e.jsx("h3",{style:i.sectionTitle,children:"ðŸ“± Cihaz DaÄŸÄ±lÄ±mÄ± (Son 7 GÃ¼n)"}),e.jsxs("div",{style:i.deviceStats,children:[e.jsxs("div",{style:i.deviceCard,children:[e.jsx(E,{size:32,color:"#5865f2"}),e.jsxs("div",{style:i.deviceInfo,children:[e.jsx("span",{style:i.deviceLabel,children:"Mobil"}),e.jsx("span",{style:i.deviceValue,children:d(l.mobile_views||0)}),e.jsxs("span",{style:i.devicePercent,children:[Math.round((l.mobile_views||0)/((l.mobile_views||0)+(l.desktop_views||1))*100),"%"]})]})]}),e.jsxs("div",{style:i.deviceCard,children:[e.jsx(U,{size:32,color:"#23a559"}),e.jsxs("div",{style:i.deviceInfo,children:[e.jsx("span",{style:i.deviceLabel,children:"MasaÃ¼stÃ¼"}),e.jsx("span",{style:i.deviceValue,children:d(l.desktop_views||0)}),e.jsxs("span",{style:i.devicePercent,children:[Math.round((l.desktop_views||0)/((l.mobile_views||0)+(l.desktop_views||1))*100),"%"]})]})]})]})]}),l.daily_stats&&l.daily_stats.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:i.section,children:[e.jsx("h3",{style:i.sectionTitle,children:"ðŸ“¨ GÃ¼nlÃ¼k Mesaj SayÄ±sÄ± (Son 30 GÃ¼n)"}),e.jsx(b,{width:"100%",height:250,children:e.jsxs(G,{data:l.daily_stats,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorMessages",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#5865f2",stopOpacity:.8}),e.jsx("stop",{offset:"95%",stopColor:"#5865f2",stopOpacity:0})]})}),e.jsx(p,{strokeDasharray:"3 3",stroke:"#1e1f22"}),e.jsx(f,{dataKey:"label",stroke:"#b9bbbe",tick:{fill:"#b9bbbe",fontSize:12},interval:4}),e.jsx(h,{stroke:"#b9bbbe",tick:{fill:"#b9bbbe",fontSize:12}}),e.jsx(j,{contentStyle:{backgroundColor:"#1e1f22",border:"1px solid #5865f2",borderRadius:"6px",color:"#fff"}}),e.jsx(A,{type:"monotone",dataKey:"messages",stroke:"#5865f2",strokeWidth:2,fillOpacity:1,fill:"url(#colorMessages)"})]})})]}),e.jsxs("div",{style:i.section,children:[e.jsx("h3",{style:i.sectionTitle,children:"ðŸ‘¥ GÃ¼nlÃ¼k Aktif KullanÄ±cÄ± (Son 30 GÃ¼n)"}),e.jsx(b,{width:"100%",height:250,children:e.jsxs(K,{data:l.daily_stats,children:[e.jsx(p,{strokeDasharray:"3 3",stroke:"#1e1f22"}),e.jsx(f,{dataKey:"label",stroke:"#b9bbbe",tick:{fill:"#b9bbbe",fontSize:12},interval:4}),e.jsx(h,{stroke:"#b9bbbe",tick:{fill:"#b9bbbe",fontSize:12}}),e.jsx(j,{contentStyle:{backgroundColor:"#1e1f22",border:"1px solid #23a559",borderRadius:"6px",color:"#fff"}}),e.jsx(R,{type:"monotone",dataKey:"active_users",stroke:"#23a559",strokeWidth:3,dot:{fill:"#23a559",r:4},activeDot:{r:6}})]})})]}),e.jsxs("div",{style:i.section,children:[e.jsx("h3",{style:i.sectionTitle,children:"ðŸ†• GÃ¼nlÃ¼k Yeni KayÄ±tlar (Son 30 GÃ¼n)"}),e.jsx(b,{width:"100%",height:250,children:e.jsxs(P,{data:l.daily_stats,children:[e.jsx(p,{strokeDasharray:"3 3",stroke:"#1e1f22"}),e.jsx(f,{dataKey:"label",stroke:"#b9bbbe",tick:{fill:"#b9bbbe",fontSize:12},interval:4}),e.jsx(h,{stroke:"#b9bbbe",tick:{fill:"#b9bbbe",fontSize:12}}),e.jsx(j,{contentStyle:{backgroundColor:"#1e1f22",border:"1px solid #f0b132",borderRadius:"6px",color:"#fff"}}),e.jsx(M,{dataKey:"signups",fill:"#f0b132",radius:[8,8,0,0]})]})})]}),e.jsxs("div",{style:i.section,children:[e.jsx("h3",{style:i.sectionTitle,children:"ðŸ‘ï¸ GÃ¼nlÃ¼k Ziyaret SayÄ±sÄ± (Son 30 GÃ¼n)"}),e.jsx(b,{width:"100%",height:250,children:e.jsxs(G,{data:l.daily_stats,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorPageViews",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#e91e63",stopOpacity:.8}),e.jsx("stop",{offset:"95%",stopColor:"#e91e63",stopOpacity:0})]})}),e.jsx(p,{strokeDasharray:"3 3",stroke:"#1e1f22"}),e.jsx(f,{dataKey:"label",stroke:"#b9bbbe",tick:{fill:"#b9bbbe",fontSize:12},interval:4}),e.jsx(h,{stroke:"#b9bbbe",tick:{fill:"#b9bbbe",fontSize:12}}),e.jsx(j,{contentStyle:{backgroundColor:"#1e1f22",border:"1px solid #e91e63",borderRadius:"6px",color:"#fff"}}),e.jsx(A,{type:"monotone",dataKey:"page_views",stroke:"#e91e63",strokeWidth:2,fillOpacity:1,fill:"url(#colorPageViews)"})]})})]}),e.jsxs("div",{style:i.section,children:[e.jsx("h3",{style:i.sectionTitle,children:"ðŸ‘¥ GÃ¼nlÃ¼k Benzersiz ZiyaretÃ§i (Son 30 GÃ¼n)"}),e.jsx(b,{width:"100%",height:250,children:e.jsxs(K,{data:l.daily_stats,children:[e.jsx(p,{strokeDasharray:"3 3",stroke:"#1e1f22"}),e.jsx(f,{dataKey:"label",stroke:"#b9bbbe",tick:{fill:"#b9bbbe",fontSize:12},interval:4}),e.jsx(h,{stroke:"#b9bbbe",tick:{fill:"#b9bbbe",fontSize:12}}),e.jsx(j,{contentStyle:{backgroundColor:"#1e1f22",border:"1px solid #00bcd4",borderRadius:"6px",color:"#fff"}}),e.jsx(R,{type:"monotone",dataKey:"unique_visitors",stroke:"#00bcd4",strokeWidth:3,dot:{fill:"#00bcd4",r:4},activeDot:{r:6}})]})})]})]}),e.jsxs("div",{style:i.section,children:[e.jsx("h3",{style:i.sectionTitle,children:"Son Aktiviteler (24 Saat)"}),e.jsxs("div",{style:i.activityList,children:[e.jsx(x,{icon:e.jsx(T,{}),label:"Yeni KayÄ±tlar",value:l.new_signups_24h||0}),e.jsx(x,{icon:e.jsx(k,{}),label:"Yeni Sunucular",value:l.new_servers_24h||0}),e.jsx(x,{icon:e.jsx(w,{}),label:"Mesajlar",value:l.messages_24h||0}),e.jsx(x,{icon:e.jsx(m,{}),label:"Aktif KullanÄ±cÄ±",value:l.active_users_24h||0}),e.jsx(x,{icon:e.jsx(m,{}),label:"Sayfa Ziyareti",value:l.page_views_24h||0,color:"#e91e63"}),e.jsx(x,{icon:e.jsx(u,{}),label:"Benzersiz ZiyaretÃ§i",value:l.unique_visitors_24h||0,color:"#00bcd4"})]})]}),l.top_pages&&l.top_pages.length>0&&e.jsxs("div",{style:i.section,children:[e.jsx("h3",{style:i.sectionTitle,children:"ðŸ“Š En Ã‡ok Ziyaret Edilen Sayfalar (Son 30 GÃ¼n)"}),e.jsx("div",{style:i.list,children:l.top_pages.slice(0,10).map((s,t)=>e.jsxs("div",{style:i.listItem,children:[e.jsxs("span",{children:["#",t+1," ",s?.path||"Unknown"]}),e.jsxs("span",{style:{color:"#e91e63",fontWeight:"bold"},children:[(s?.views||0).toLocaleString()," ziyaret"]})]},t))})]})]})),d=l=>l==null?"0":l>=1e6?(l/1e6).toFixed(1)+"M":l>=1e3?(l/1e3).toFixed(1)+"K":l.toLocaleString(),g=({label:l,value:s,isPositive:t,suffix:o="%",icon:c})=>e.jsxs("div",{style:{...i.growthCard,borderLeft:`4px solid ${t?"#23a559":"#ed4245"}`},children:[e.jsx("div",{style:i.growthLabel,children:l}),e.jsxs("div",{style:{...i.growthValue,color:t?"#23a559":"#ed4245"},children:[c||(t?e.jsx(N,{}):e.jsx(q,{})),e.jsxs("span",{children:[typeof s=="number"?s.toFixed(1):s,o]})]})]}),X=({stats:l})=>e.jsxs("div",{style:i.tabContent,children:[e.jsxs("div",{style:i.statsGrid,children:[e.jsx(r,{icon:e.jsx(u,{}),label:"Toplam KullanÄ±cÄ±",value:l.total_users||0,color:"#5865f2"}),e.jsx(r,{icon:e.jsx(T,{}),label:"Online",value:l.online_users||0,color:"#23a559"}),e.jsx(r,{icon:e.jsx(Y,{}),label:"Offline",value:l.total_users-l.online_users||0,color:"#747f8d"})]}),l.top_users&&l.top_users.length>0&&e.jsxs("div",{style:i.section,children:[e.jsx("h3",{style:i.sectionTitle,children:"En Aktif KullanÄ±cÄ±lar"}),e.jsx("div",{style:i.list,children:l.top_users.map((s,t)=>e.jsxs("div",{style:i.listItem,children:[e.jsxs("span",{children:["#",t+1," ",s.username]}),e.jsxs("span",{children:[s.message_count," mesaj"]})]},t))})]})]}),H=({stats:l})=>e.jsxs("div",{style:i.tabContent,children:[e.jsxs("div",{style:i.statsGrid,children:[e.jsx(r,{icon:e.jsx(I,{}),label:"Premium KullanÄ±cÄ±",value:l.premium_users||0,color:"#9b59b6"}),e.jsx(r,{icon:e.jsx(Z,{}),label:"AylÄ±k Gelir",value:`${l.monthly_revenue||0} TL`,color:"#f0b132"}),e.jsx(r,{icon:e.jsx(z,{}),label:"YÄ±llÄ±k Tahmin",value:`${(l.monthly_revenue||0)*12} TL`,color:"#23a559"})]}),e.jsxs("div",{style:i.section,children:[e.jsx("h3",{style:i.sectionTitle,children:"Premium DaÄŸÄ±lÄ±mÄ±"}),e.jsxs("div",{style:i.pieChart,children:[e.jsx(C,{label:"Ãœcretsiz",value:l.free_users||0,color:"#747f8d"}),e.jsx(C,{label:"Nitro Basic",value:l.basic_users||0,color:"#5865f2"}),e.jsx(C,{label:"Nitro Premium",value:l.premium_tier_users||0,color:"#9b59b6"})]})]})]}),Q=({stats:l})=>e.jsxs("div",{style:i.tabContent,children:[e.jsxs("div",{style:i.statsGrid,children:[e.jsx(r,{icon:e.jsx(k,{}),label:"Toplam Sunucu",value:l.total_servers||0,color:"#5865f2"}),e.jsx(r,{icon:e.jsx(m,{}),label:"Genel Sunucu",value:l.public_servers||0,color:"#23a559"}),e.jsx(r,{icon:e.jsx(u,{}),label:"Ortalama Ãœye",value:l.avg_server_members||0,color:"#f0b132"})]}),l.top_servers&&l.top_servers.length>0&&e.jsxs("div",{style:i.section,children:[e.jsx("h3",{style:i.sectionTitle,children:"En BÃ¼yÃ¼k Sunucular"}),e.jsx("div",{style:i.list,children:l.top_servers.map((s,t)=>e.jsxs("div",{style:i.listItem,children:[e.jsxs("span",{children:["#",t+1," ",s.name]}),e.jsxs("span",{children:[s.member_count," Ã¼ye"]})]},t))})]})]}),r=({icon:l,label:s,value:t,color:o,subtitle:c})=>e.jsxs("div",{style:{...i.statCard,borderTop:`3px solid ${o}`},children:[e.jsx("div",{style:{...i.statIcon,color:o},children:l}),e.jsxs("div",{style:i.statContent,children:[e.jsx("div",{style:i.statLabel,children:s}),e.jsx("div",{style:i.statValue,children:t}),c&&e.jsx("div",{style:i.statSubtitle,children:c})]})]}),x=({icon:l,label:s,value:t,color:o="#5865f2"})=>e.jsxs("div",{style:i.activityItem,children:[e.jsx("div",{style:{...i.activityIcon,color:o},children:l}),e.jsx("div",{style:i.activityLabel,children:s}),e.jsx("div",{style:{...i.activityValue,color:o},children:t})]}),C=({label:l,value:s,color:t})=>e.jsxs("div",{style:i.pieItem,children:[e.jsx("div",{style:{...i.pieColor,backgroundColor:t}}),e.jsx("div",{style:i.pieLabel,children:l}),e.jsx("div",{style:i.pieValue,children:s})]}),i={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,backdropFilter:"blur(5px)"},modal:{backgroundColor:"#2b2d31",borderRadius:"12px",width:"90%",maxWidth:"1200px",maxHeight:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.5)"},header:{padding:"20px",borderBottom:"1px solid #1e1f22",display:"flex",justifyContent:"space-between",alignItems:"center"},headerLeft:{display:"flex",alignItems:"center",gap:"12px",color:"#fff"},headerRight:{display:"flex",gap:"10px"},title:{margin:0,fontSize:"24px",color:"#fff"},exportButton:{background:"#23a559",border:"none",color:"#fff",padding:"10px 15px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px"},closeButton:{background:"#da373c",border:"none",color:"#fff",padding:"10px 15px",borderRadius:"6px",cursor:"pointer",fontSize:"16px"},tabs:{display:"flex",padding:"0 20px",borderBottom:"1px solid #1e1f22",gap:"5px"},tab:{background:"none",border:"none",color:"#b9bbbe",padding:"12px 20px",cursor:"pointer",fontSize:"14px",fontWeight:"500",borderBottom:"2px solid transparent",display:"flex",alignItems:"center",gap:"8px",transition:"all 0.2s"},activeTab:{color:"#fff",borderBottomColor:"#5865f2"},content:{flex:1,overflow:"auto",padding:"20px"},tabContent:{display:"flex",flexDirection:"column",gap:"20px"},statsGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"15px"},statCard:{backgroundColor:"#1e1f22",borderRadius:"8px",padding:"20px",display:"flex",alignItems:"center",gap:"15px"},statIcon:{fontSize:"32px"},statContent:{flex:1},statLabel:{color:"#b9bbbe",fontSize:"12px",marginBottom:"5px"},statValue:{color:"#fff",fontSize:"24px",fontWeight:"bold"},statSubtitle:{color:"#747f8d",fontSize:"11px",marginTop:"3px"},section:{backgroundColor:"#1e1f22",borderRadius:"8px",padding:"20px"},sectionTitle:{color:"#fff",fontSize:"16px",marginBottom:"15px",margin:"0 0 15px 0"},activityList:{display:"flex",flexDirection:"column",gap:"10px"},activityItem:{display:"flex",alignItems:"center",padding:"10px",backgroundColor:"#2b2d31",borderRadius:"6px"},activityIcon:{color:"#5865f2",marginRight:"12px",fontSize:"18px"},activityLabel:{flex:1,color:"#b9bbbe",fontSize:"14px"},activityValue:{color:"#fff",fontSize:"16px",fontWeight:"bold"},list:{display:"flex",flexDirection:"column",gap:"8px"},listItem:{display:"flex",justifyContent:"space-between",padding:"10px",backgroundColor:"#2b2d31",borderRadius:"6px",color:"#b9bbbe",fontSize:"14px"},pieChart:{display:"flex",flexDirection:"column",gap:"12px"},pieItem:{display:"flex",alignItems:"center",gap:"12px"},pieColor:{width:"20px",height:"20px",borderRadius:"4px"},pieLabel:{flex:1,color:"#b9bbbe",fontSize:"14px"},pieValue:{color:"#fff",fontSize:"16px",fontWeight:"bold"},loading:{color:"#fff",textAlign:"center",padding:"40px"},error:{color:"#da373c",textAlign:"center",padding:"40px"},growthSection:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:"12px",marginBottom:"20px"},growthCard:{backgroundColor:"#1e1f22",borderRadius:"8px",padding:"15px",display:"flex",flexDirection:"column",gap:"8px"},growthLabel:{color:"#b9bbbe",fontSize:"12px"},growthValue:{display:"flex",alignItems:"center",gap:"8px",fontSize:"20px",fontWeight:"bold"},deviceStats:{display:"flex",gap:"20px",flexWrap:"wrap"},deviceCard:{flex:"1 1 200px",display:"flex",alignItems:"center",gap:"15px",backgroundColor:"#2b2d31",padding:"20px",borderRadius:"8px"},deviceInfo:{display:"flex",flexDirection:"column",gap:"4px"},deviceLabel:{color:"#b9bbbe",fontSize:"12px"},deviceValue:{color:"#fff",fontSize:"24px",fontWeight:"bold"},devicePercent:{color:"#5865f2",fontSize:"14px",fontWeight:"bold"}};export{se as default};
