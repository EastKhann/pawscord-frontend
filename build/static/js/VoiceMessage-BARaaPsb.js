import{r as n,n as e}from"./react-core-Cj7FUMmY.js";import{t as N}from"./index-g9l3nMnA.js";import"./editor-vendor-D9c4a6XZ.js";import"./media-vendor-BsD1gqUZ.js";import"./router-vendor-QeioVw-9.js";import"./icons-vendor-TGltgKsJ.js";import"./state-vendor-MN-5i-Jz.js";import"./crypto-vendor-DK-7ILyQ.js";const q=({onSend:w,onCancel:k})=>{const[a,m]=n.useState(!1),[o,i]=n.useState(!1),[h,l]=n.useState(0),[r,p]=n.useState(null),[d,D]=n.useState(null),[Y,f]=n.useState([]),[y,T]=n.useState(0),[W,g]=n.useState(0),[S,u]=n.useState(0),E=n.useRef(null),L=-80;n.useEffect(()=>{let s;return a&&(s=setInterval(()=>{l(t=>t+1)},1e3)),()=>clearInterval(s)},[a]);const C=async()=>{try{const s=await navigator.mediaDevices.getUserMedia({audio:!0}),t=new MediaRecorder(s),c=[];t.ondataavailable=j=>{c.push(j.data),U()},t.onstop=()=>{const j=new Blob(c,{type:"audio/webm"});p(j),s.getTracks().forEach(K=>K.stop())},t.start(100),D(t),m(!0),i(!1),l(0)}catch{N.error("âŒ Mikrofon eriÅŸimi reddedildi")}},B=()=>{d&&a&&(d.stop(),m(!1),i(!1))},v=()=>{d&&a&&d.stop(),m(!1),i(!1),p(null),l(0),f([]),u(0),k?.()},b=s=>{s.preventDefault();const t=s.touches?s.touches[0].clientY:s.clientY;T(t),g(t),u(0),C()},M=s=>{if(!a||o)return;const t=s.touches?s.touches[0].clientY:s.clientY;g(t);const c=t-y;u(c),c<L&&(i(!0),N.success("ðŸ”’ KayÄ±t kilitlendi"))},x=s=>{s.preventDefault(),!o&&a&&(v(),N.info("KayÄ±t iptal edildi")),u(0)},I=()=>{r&&(w?.(r,h),p(null),l(0),f([]))},U=()=>{f(s=>[...s,Math.random()*100].slice(-50))},R=s=>{const t=Math.floor(s/60),c=s%60;return`${t}:${c.toString().padStart(2,"0")}`};return e.jsxs("div",{className:"voice-message-container",children:[!a&&!r&&e.jsxs("button",{ref:E,className:"btn-start-recording",onMouseDown:b,onMouseMove:M,onMouseUp:x,onMouseLeave:x,onTouchStart:b,onTouchMove:M,onTouchEnd:x,style:{cursor:"pointer",userSelect:"none",WebkitUserSelect:"none",touchAction:"none"},children:[e.jsx("span",{className:"mic-icon",children:"ðŸŽ¤"}),e.jsx("span",{children:"BasÄ±lÄ± Tut"})]}),a&&e.jsxs("div",{className:"recording-ui",children:[!o&&e.jsxs("div",{className:"swipe-indicator",style:{opacity:Math.max(0,Math.min(1,-S/80)),transform:`translateY(${Math.max(S,-100)}px)`},children:[e.jsx("div",{className:"lock-icon",children:"ðŸ”’"}),e.jsx("div",{className:"swipe-text",children:"YukarÄ± kaydÄ±r"})]}),o&&e.jsxs("div",{className:"locked-indicator",children:[e.jsx("span",{className:"lock-icon",children:"ðŸ”’"}),e.jsx("span",{children:"Kilitli"})]}),e.jsx("div",{className:"waveform",children:Y.map((s,t)=>e.jsx("div",{className:"waveform-bar",style:{height:`${s}%`}},t))}),e.jsxs("div",{className:"recording-info",children:[e.jsx("span",{className:"recording-indicator",children:"ðŸ”´"}),e.jsx("span",{className:"recording-time",children:R(h)})]}),e.jsxs("div",{className:"recording-controls",children:[e.jsx("button",{className:"btn-cancel",onClick:v,children:"Ä°ptal"}),o&&e.jsx("button",{className:"btn-stop",onClick:B,children:"Durdur"})]})]}),r&&!a&&e.jsxs("div",{className:"preview-ui",children:[e.jsx("audio",{controls:!0,src:URL.createObjectURL(r)}),e.jsx("div",{className:"preview-info",children:e.jsxs("span",{children:["Sesli mesaj â€¢ ",R(h)]})}),e.jsxs("div",{className:"preview-controls",children:[e.jsx("button",{className:"btn-cancel",onClick:v,children:"Sil"}),e.jsx("button",{className:"btn-send",onClick:I,children:"GÃ¶nder ðŸ“¤"})]})]})]})};export{q as default};
