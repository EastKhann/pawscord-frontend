import{r as t,n as e}from"./react-core-CvG1duuD.js";import{bY as L,bT as Q,c9 as D,cr as K,a_ as V,a$ as Y,cs as J,M as G,ct as H,ad as W,b4 as X,K as Z,a as F}from"./icons-vendor-DhG1XKwU.js";import{t as r}from"./index-CzRXpBw8.js";import"./editor-vendor-D9c4a6XZ.js";import"./media-vendor-DQG9xQkU.js";import"./router-vendor-DXeerrpf.js";import"./state-vendor-BJ77FbUv.js";import"./crypto-vendor-BHxPXfg-.js";const oe=({channelId:n})=>{const[o,f]=t.useState(!1),[c,d]=t.useState(null),[i,m]=t.useState([]),[h,y]=t.useState(70),[u,q]=t.useState(!1),[N,_]=t.useState(!1),[v,z]=t.useState(!1),[S,b]=t.useState(!1),[g,p]=t.useState(!1),[x,T]=t.useState(""),[$,C]=t.useState(0),[j,A]=t.useState(0),l=t.useRef(null);t.useEffect(()=>{B();const s=setInterval(()=>{o&&l.current&&(C(l.current.currentTime),A(l.current.duration))},1e3);return()=>clearInterval(s)},[o]);const B=async()=>{try{const s=await fetch(`/api/music/status/${n}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(s.ok){const a=await s.json();d(a.current_track),m(a.queue||[]),f(a.is_playing),y(a.volume||70)}}catch{}},E=async()=>{try{(await fetch(`/api/music/${o?"pause":"play"}/${n}/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}})).ok&&(f(!o),r.success(o?"⏸️ Durakladı":"▶️ Çalıyor"))}catch{r.error("❌ İşlem başarısız")}},R=async()=>{try{const s=await fetch(`/api/music/skip/${n}/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(s.ok){const a=await s.json();d(a.current_track),r.success("⏭️ Sonraki şarkı")}}catch{r.error("❌ Atlama başarısız")}},M=async()=>{try{const s=await fetch(`/api/music/previous/${n}/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(s.ok){const a=await s.json();d(a.current_track),r.success("⏮️ Önceki şarkı")}}catch{r.error("❌ Geri alma başarısız")}},O=async s=>{y(s);try{await fetch(`/api/music/volume/${n}/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`,"Content-Type":"application/json"},body:JSON.stringify({volume:s})})}catch{}},P=async()=>{if(!x.trim()){r.error("❌ URL girin");return}try{const s=await fetch(`/api/music/add/${n}/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`,"Content-Type":"application/json"},body:JSON.stringify({url:x})});if(s.ok){const a=await s.json();m([...i,a.track]),T(""),p(!1),r.success("✅ Sıraya eklendi")}else r.error("❌ Eklenemedi")}catch{r.error("❌ Bağlantı hatası")}},U=async s=>{try{(await fetch(`/api/music/remove/${n}/${s}/`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}})).ok&&(m(i.filter(k=>k.id!==s)),r.success("✅ Sıradan çıkarıldı"))}catch{r.error("❌ İşlem başarısız")}},w=s=>{if(!s||isNaN(s))return"0:00";const a=Math.floor(s/60),k=Math.floor(s%60);return`${a}:${k.toString().padStart(2,"0")}`},I=s=>{const a=s.target.value/100*j;C(a),l.current&&(l.current.currentTime=a)};return e.jsxs("div",{className:"music-player",children:[e.jsx("audio",{ref:l,src:c?.audio_url}),e.jsxs("div",{className:"player-main",children:[e.jsx("div",{className:"track-info",children:c?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:c.thumbnail||"/default-music.png",alt:c.title,className:"track-thumbnail"}),e.jsxs("div",{className:"track-details",children:[e.jsx("div",{className:"track-title",children:c.title}),e.jsx("div",{className:"track-artist",children:c.artist||"Bilinmeyen Sanatçı"})]}),e.jsxs("div",{className:"track-source",children:[c.source==="youtube"&&e.jsx(L,{className:"source-icon youtube"}),c.source==="spotify"&&e.jsx(Q,{className:"source-icon spotify"})]})]}):e.jsx("div",{className:"no-track",children:e.jsx("span",{children:"Şarkı seçilmedi"})})}),e.jsxs("div",{className:"player-controls",children:[e.jsxs("div",{className:"control-buttons",children:[e.jsx("button",{className:`control-btn ${N?"active":""}`,onClick:()=>_(!N),title:"Karıştır",children:e.jsx(D,{})}),e.jsx("button",{className:"control-btn",onClick:M,title:"Önceki",children:e.jsx(K,{})}),e.jsx("button",{className:"control-btn play-btn",onClick:E,children:o?e.jsx(V,{}):e.jsx(Y,{})}),e.jsx("button",{className:"control-btn",onClick:R,title:"Sonraki",children:e.jsx(J,{})}),e.jsx("button",{className:`control-btn ${v?"active":""}`,onClick:()=>z(!v),title:"Tekrarla",children:e.jsx(G,{})})]}),e.jsxs("div",{className:"progress-container",children:[e.jsx("span",{className:"time-display",children:w($)}),e.jsx("input",{type:"range",className:"progress-bar",min:"0",max:"100",value:$/j*100||0,onChange:I}),e.jsx("span",{className:"time-display",children:w(j)})]})]}),e.jsxs("div",{className:"player-extras",children:[e.jsxs("button",{className:"extra-btn",onClick:()=>b(!S),title:"Sıra",children:[e.jsx(H,{}),i.length>0&&e.jsx("span",{className:"queue-count",children:i.length})]}),e.jsx("button",{className:"extra-btn",onClick:()=>p(!g),title:"Şarkı Ekle",children:e.jsx(W,{})}),e.jsxs("div",{className:"volume-control",children:[e.jsx("button",{className:"extra-btn",onClick:()=>q(!u),children:u||h===0?e.jsx(X,{}):e.jsx(Z,{})}),e.jsx("input",{type:"range",className:"volume-slider",min:"0",max:"100",value:u?0:h,onChange:s=>O(parseInt(s.target.value))}),e.jsxs("span",{className:"volume-display",children:[u?0:h,"%"]})]})]})]}),S&&e.jsxs("div",{className:"queue-panel",children:[e.jsxs("div",{className:"queue-header",children:[e.jsxs("h3",{children:["Sıra (",i.length,")"]}),e.jsx("button",{className:"close-btn",onClick:()=>b(!1),children:e.jsx(F,{})})]}),e.jsx("div",{className:"queue-list",children:i.length===0?e.jsx("div",{className:"queue-empty",children:"Sıra boş"}):i.map((s,a)=>e.jsxs("div",{className:"queue-item",children:[e.jsx("span",{className:"queue-index",children:a+1}),e.jsx("img",{src:s.thumbnail,alt:s.title,className:"queue-thumbnail"}),e.jsxs("div",{className:"queue-track-info",children:[e.jsx("div",{className:"queue-track-title",children:s.title}),e.jsx("div",{className:"queue-track-artist",children:s.artist||"Bilinmeyen"})]}),e.jsx("button",{className:"remove-btn",onClick:()=>U(s.id),title:"Sıradan Çıkar",children:e.jsx(F,{})})]},s.id))})]}),g&&e.jsx("div",{className:"add-track-modal",children:e.jsxs("div",{className:"add-track-content",children:[e.jsx("h3",{children:"Şarkı Ekle"}),e.jsx("input",{type:"text",className:"track-url-input",placeholder:"YouTube veya Spotify URL'si girin...",value:x,onChange:s=>T(s.target.value),onKeyPress:s=>s.key==="Enter"&&P()}),e.jsxs("div",{className:"modal-actions",children:[e.jsx("button",{className:"btn-cancel",onClick:()=>p(!1),children:"İptal"}),e.jsx("button",{className:"btn-add",onClick:P,children:"Ekle"})]})]})})]})};export{oe as default};
