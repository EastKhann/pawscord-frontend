import{r as n,d as e,B as c,de as Q,d0 as Z,i as x,bS as K,bu as g,E as P,aF as q,U as A,bU as V,bK as X,Z as Y,cf as ee,Q as ae,m as te,dz as ne,dA as le,dB as se,c9 as s}from"./react-core-DrOm_csO.js";const oe=({serverId:y,channelId:m,onClose:p})=>{const[l,u]=n.useState(""),[r,d]=n.useState("python"),[E,o]=n.useState(""),[B,v]=n.useState(!1),[k,C]=n.useState(null),[F,O]=n.useState([]),[w,b]=n.useState(!1),[T,j]=n.useState([]),[J,N]=n.useState(!1),[f,R]=n.useState(!1),i=localStorage.getItem("access_token"),H=[{id:"python",name:"Python",icon:e.createElement(ne,null),template:`# Python Code
print("Hello, World!")`},{id:"javascript",name:"JavaScript",icon:e.createElement(le,null),template:`// JavaScript Code
console.log("Hello, World!");`},{id:"java",name:"Java",icon:e.createElement(se,null),template:`public class Main {
    public static void main(String[] args) {
        System.out.println("Hello, World!");
    }
}`},{id:"cpp",name:"C++",icon:e.createElement(c,null),template:`#include <iostream>
using namespace std;

int main() {
    cout << "Hello, World!" << endl;
    return 0;
}`},{id:"c",name:"C",icon:e.createElement(c,null),template:`#include <stdio.h>

int main() {
    printf("Hello, World!\\n");
    return 0;
}`},{id:"ruby",name:"Ruby",icon:e.createElement(c,null),template:`# Ruby Code
puts "Hello, World!"`},{id:"go",name:"Go",icon:e.createElement(c,null),template:`package main

import "fmt"

func main() {
    fmt.Println("Hello, World!")
}`},{id:"rust",name:"Rust",icon:e.createElement(c,null),template:`fn main() {
    println!("Hello, World!");
}`}];n.useEffect(()=>{$(),S()},[]),n.useEffect(()=>{const a=H.find(t=>t.id===r);a&&!l&&u(a.template)},[r]);const $=async()=>{try{const a=await fetch("/api/code-runner/history/",{headers:{Authorization:`Bearer ${i}`}});if(a.ok){const t=await a.json();O(t.history||[])}}catch(a){console.error("Error fetching history:",a)}},S=async()=>{try{const a=await fetch("/api/code-runner/snippets/",{headers:{Authorization:`Bearer ${i}`}});if(a.ok){const t=await a.json();j(t.snippets||[])}}catch(a){console.error("Error fetching snippets:",a)}},W=async()=>{if(!l.trim()){s.warning("Kod boş olamaz");return}v(!0),o("Çalıştırılıyor...");const a=Date.now();try{const t=await fetch("/api/code-runner/execute/",{method:"POST",headers:{Authorization:`Bearer ${i}`,"Content-Type":"application/json"},body:JSON.stringify({code:l,language:r,channel_id:m})}),h=await t.json(),I=Date.now();C(I-a),t.ok?(o(h.output||"Çıktı yok"),h.error&&o(`Hata:
${h.error}`)):o(`Hata: ${h.message||"Kod çalıştırılamadı"}`),$()}catch{o("Bağlantı hatası")}v(!1)},D=async()=>{try{await fetch("/api/code-runner/stop/",{method:"POST",headers:{Authorization:`Bearer ${i}`}}),v(!1),o("Çalıştırma durduruldu")}catch{s.error("Durdurma başarısız")}},G=async a=>{try{(await fetch("/api/code-runner/snippets/",{method:"POST",headers:{Authorization:`Bearer ${i}`,"Content-Type":"application/json"},body:JSON.stringify({name:a,code:l,language:r})})).ok&&(s.success("Snippet kaydedildi"),S(),N(!1))}catch{s.error("Kaydetme başarısız")}},z=a=>{u(a.code),d(a.language),b(!1)},M=async a=>{try{await fetch(`/api/code-runner/snippets/${a}/`,{method:"DELETE",headers:{Authorization:`Bearer ${i}`}}),s.success("Snippet silindi"),S()}catch{s.error("Silme başarısız")}},L=()=>{navigator.clipboard.writeText(E),s.success("Çıktı kopyalandı")},_=()=>{u(""),o(""),C(null)},U=async()=>{if(!m){s.warning("Paylaşım için kanal gerekli");return}try{(await fetch(`/api/channels/${m}/messages/`,{method:"POST",headers:{Authorization:`Bearer ${i}`,"Content-Type":"application/json"},body:JSON.stringify({content:`\`\`\`${r}
${l}
\`\`\`
**Çıktı:**
\`\`\`
${E}
\`\`\``})})).ok&&s.success("Kanala paylaşıldı")}catch{s.error("Paylaşım başarısız")}};return e.createElement("div",{className:`code-runner-overlay ${f?"fullscreen":""}`,onClick:a=>a.target.className.includes("code-runner-overlay")&&p()},e.createElement("div",{className:"code-runner-panel"},e.createElement("div",{className:"panel-header"},e.createElement("h2",null,e.createElement(c,null)," Kod Çalıştırıcı"),e.createElement("div",{className:"header-actions"},e.createElement("button",{className:"fullscreen-btn",onClick:()=>R(!f)},f?e.createElement(Q,null):e.createElement(Z,null)),e.createElement("button",{className:"close-btn",onClick:p},e.createElement(x,null)))),e.createElement("div",{className:"toolbar"},e.createElement("div",{className:"language-selector"},H.map(a=>e.createElement("button",{key:a.id,className:`lang-btn ${r===a.id?"active":""}`,onClick:()=>d(a.id),title:a.name},a.icon,e.createElement("span",null,a.name)))),e.createElement("div",{className:"toolbar-actions"},e.createElement("button",{className:"action-btn",onClick:()=>b(!w)},e.createElement(K,null)," Geçmiş"),e.createElement("button",{className:"action-btn",onClick:()=>N(!0)},e.createElement(g,null)," Kaydet"),e.createElement("button",{className:"action-btn clear",onClick:_},e.createElement(P,null)," Temizle"))),e.createElement("div",{className:"editor-container"},e.createElement("div",{className:"code-section"},e.createElement("div",{className:"section-header"},e.createElement("span",null,e.createElement(c,null)," Kod"),e.createElement("span",{className:"line-count"},l.split(`
`).length," satır")),e.createElement("textarea",{className:"code-editor",value:l,onChange:a=>u(a.target.value),placeholder:"Kodunuzu buraya yazın...",spellCheck:"false"})),e.createElement("div",{className:"output-section"},e.createElement("div",{className:"section-header"},e.createElement("span",null,e.createElement(q,null)," Çıktı"),e.createElement("div",{className:"output-actions"},k&&e.createElement("span",{className:"exec-time"},e.createElement(A,null)," ",k,"ms"),e.createElement("button",{onClick:L,title:"Kopyala"},e.createElement(V,null)))),e.createElement("pre",{className:`output-display ${E.includes("Hata")?"error":""}`},E||"Çıktı burada görünecek..."))),e.createElement("div",{className:"run-bar"},B?e.createElement("button",{className:"stop-btn",onClick:D},e.createElement(Y,null)," Durdur"):e.createElement("button",{className:"run-btn",onClick:W},e.createElement(X,null)," Çalıştır"),m&&e.createElement("button",{className:"share-btn",onClick:U},e.createElement(c,null)," Kanala Paylaş")),w&&e.createElement("div",{className:"history-sidebar"},e.createElement("div",{className:"sidebar-header"},e.createElement("h3",null,e.createElement(K,null)," Geçmiş & Snippets"),e.createElement("button",{onClick:()=>b(!1)},e.createElement(x,null))),e.createElement("div",{className:"sidebar-section"},e.createElement("h4",null,e.createElement(ee,null)," Kaydedilen Snippets"),T.length===0?e.createElement("p",{className:"empty-msg"},"Henüz snippet yok"):e.createElement("div",{className:"snippets-list"},T.map(a=>e.createElement("div",{key:a.id,className:"snippet-item"},e.createElement("div",{className:"snippet-info",onClick:()=>z(a)},e.createElement("span",{className:"snippet-name"},a.name),e.createElement("span",{className:"snippet-lang"},a.language)),e.createElement("button",{className:"delete-snippet",onClick:()=>M(a.id)},e.createElement(P,null)))))),e.createElement("div",{className:"sidebar-section"},e.createElement("h4",null,e.createElement(A,null)," Son Çalıştırmalar"),F.length===0?e.createElement("p",{className:"empty-msg"},"Geçmiş yok"):e.createElement("div",{className:"history-list"},F.slice(0,10).map((a,t)=>e.createElement("div",{key:t,className:"history-item",onClick:()=>z(a)},e.createElement("div",{className:"history-info"},e.createElement("span",{className:"history-lang"},a.language),e.createElement("span",{className:`history-status ${a.success?"success":"error"}`},a.success?e.createElement(ae,null):e.createElement(te,null))),e.createElement("code",{className:"history-preview"},a.code?.substring(0,50),"..."),e.createElement("span",{className:"history-time"},a.exec_time,"ms")))))),J&&e.createElement(re,{onClose:()=>N(!1),onSave:G,language:r})))},re=({onClose:y,onSave:m,language:p})=>{const[l,u]=n.useState(""),r=()=>{if(!l.trim()){s.warning("Snippet adı gerekli");return}m(l)};return e.createElement("div",{className:"modal-overlay",onClick:d=>d.target.className==="modal-overlay"&&y()},e.createElement("div",{className:"save-modal"},e.createElement("h3",null,e.createElement(g,null)," Snippet Kaydet"),e.createElement("div",{className:"form-group"},e.createElement("label",null,"Snippet Adı"),e.createElement("input",{type:"text",value:l,onChange:d=>u(d.target.value),placeholder:"örn: Fibonacci Hesaplama"})),e.createElement("div",{className:"form-group"},e.createElement("label",null,"Dil"),e.createElement("input",{type:"text",value:p,disabled:!0})),e.createElement("div",{className:"modal-actions"},e.createElement("button",{className:"cancel-btn",onClick:y},"İptal"),e.createElement("button",{className:"save-submit-btn",onClick:r},e.createElement(g,null)," Kaydet"))))};export{oe as default};
