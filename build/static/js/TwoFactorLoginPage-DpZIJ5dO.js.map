{"version":3,"file":"TwoFactorLoginPage-DpZIJ5dO.js","sources":["../../../src/pages/TwoFactorLoginPage.js"],"sourcesContent":["// frontend/src/pages/TwoFactorLoginPage.js\nimport { useState, useEffect } from 'react';\nimport { useNavigate, useSearchParams } from 'react-router-dom';\nimport { FaShieldAlt, FaArrowLeft, FaKey } from 'react-icons/fa';\nimport { API_BASE_URL } from '../utils/constants';\nimport { useAuth } from '../AuthContext';\n\nconst TwoFactorLoginPage = () => {\n    const { login } = useAuth();\n    const navigate = useNavigate();\n    const [searchParams] = useSearchParams();\n    const [code, setCode] = useState('');\n    const [useBackupCode, setUseBackupCode] = useState(false);\n    const [backupCode, setBackupCode] = useState('');\n    const [error, setError] = useState('');\n    const [loading, setLoading] = useState(false);\n\n    // Get temp_token from URL query params\n    const tempToken = searchParams.get('temp_token');\n\n    useEffect(() => {\n        if (!tempToken) {\n            // Redirect to login if no temp_token\n            console.warn('üîê [2FA] No temp_token found, redirecting to login');\n            navigate('/login');\n        }\n    }, [tempToken, navigate]);\n\n    if (!tempToken) {\n        return null;\n    }\n\n    const handleSubmit = async (e) => {\n        e.preventDefault();\n        setError('');\n        setLoading(true);\n\n        const codeToSend = useBackupCode ? backupCode : code;\n\n        if (!codeToSend) {\n            setError('Kod gerekli');\n            setLoading(false);\n            return;\n        }\n\n        try {\n            const response = await fetch(`${API_BASE_URL}/security/2fa/verify-login/`, {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify({\n                    temp_token: tempToken,\n                    code: codeToSend\n                })\n            });\n\n            const data = await response.json();\n\n            if (response.ok && data.verified) {\n                // Use AuthContext login ‚Äî sets tokens, user state, schedules refresh\n                login(data.access, data.refresh);\n                navigate('/');\n            } else {\n                console.error('‚ùå [2FA] Verification failed:', data);\n                setError(data.error || 'Ge√ßersiz kod');\n            }\n        } catch (error) {\n            console.error('‚ùå [2FA] Network error:', error);\n            setError('Baƒülantƒ± hatasƒ± olu≈ütu');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    return (\n        <div style={styles.container}>\n            <div style={styles.card}>\n                <button onClick={() => navigate('/login')} style={styles.backButton}>\n                    <FaArrowLeft /> Geri\n                </button>\n\n                <FaShieldAlt style={styles.icon} />\n                <h2 style={styles.title}>ƒ∞ki Fakt√∂rl√º Doƒürulama</h2>\n                <p style={styles.subtitle}>\n                    {useBackupCode ? 'Yedek kodunuzu girin' : 'Authenticator uygulamanƒ±zdaki 6 haneli kodu girin'}\n                </p>\n\n                <form onSubmit={handleSubmit} style={styles.form}>\n                    {!useBackupCode ? (\n                        <>\n                            <input\n                                type=\"text\"\n                                maxLength={6}\n                                placeholder=\"000000\"\n                                value={code}\n                                onChange={(e) => {\n                                    const value = e.target.value.replace(/\\D/g, '');\n                                    setCode(value);\n                                }}\n                                style={styles.codeInput}\n                                autoFocus\n                                disabled={loading}\n                            />\n\n                            <button\n                                type=\"button\"\n                                onClick={() => setUseBackupCode(true)}\n                                style={styles.backupLink}\n                            >\n                                <FaKey /> Yedek kod kullan\n                            </button>\n                        </>\n                    ) : (\n                        <>\n                            <input\n                                type=\"text\"\n                                placeholder=\"Yedek kod\"\n                                value={backupCode}\n                                onChange={(e) => setBackupCode(e.target.value)}\n                                style={styles.backupInput}\n                                autoFocus\n                                disabled={loading}\n                            />\n\n                            <button\n                                type=\"button\"\n                                onClick={() => setUseBackupCode(false)}\n                                style={styles.backupLink}\n                            >\n                                ‚Üê Authenticator kodu kullan\n                            </button>\n                        </>\n                    )}\n\n                    {error && (\n                        <div style={styles.error}>\n                            ‚ùå {error}\n                        </div>\n                    )}\n\n                    <button\n                        type=\"submit\"\n                        style={styles.submitButton}\n                        disabled={loading || (!useBackupCode && code.length !== 6) || (useBackupCode && !backupCode)}\n                    >\n                        {loading ? 'Doƒürulanƒ±yor...' : 'Giri≈ü Yap'}\n                    </button>\n                </form>\n\n                <div style={styles.info}>\n                    <p style={styles.infoTitle}>üí° ƒ∞pu√ßlarƒ±:</p>\n                    <ul style={styles.infoList}>\n                        <li>Kod s√ºrekli deƒüi≈üir (30 saniyede bir)</li>\n                        <li>Telefonunuzu kaybettiyseniz yedek kod kullanƒ±n</li>\n                        <li>Her yedek kod sadece bir kere kullanƒ±labilir</li>\n                    </ul>\n                </div>\n            </div>\n        </div>\n    );\n};\n\nconst styles = {\n    container: {\n        minHeight: '100vh',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        backgroundColor: '#1e1f22',\n        padding: '20px'\n    },\n    card: {\n        backgroundColor: '#2b2d31',\n        borderRadius: '12px',\n        padding: '40px',\n        maxWidth: '500px',\n        width: '100%',\n        boxShadow: '0 8px 32px rgba(0, 0, 0, 0.5)',\n        position: 'relative'\n    },\n    backButton: {\n        position: 'absolute',\n        top: '20px',\n        left: '20px',\n        background: 'none',\n        border: 'none',\n        color: '#b9bbbe',\n        cursor: 'pointer',\n        fontSize: '16px',\n        display: 'flex',\n        alignItems: 'center',\n        gap: '8px',\n        transition: 'color 0.2s'\n    },\n    icon: {\n        fontSize: '64px',\n        color: '#5865f2',\n        display: 'block',\n        margin: '0 auto 20px'\n    },\n    title: {\n        color: '#fff',\n        fontSize: '28px',\n        textAlign: 'center',\n        margin: '0 0 10px 0'\n    },\n    subtitle: {\n        color: '#b9bbbe',\n        fontSize: '16px',\n        textAlign: 'center',\n        marginBottom: '30px'\n    },\n    form: {\n        display: 'flex',\n        flexDirection: 'column',\n        gap: '15px'\n    },\n    codeInput: {\n        backgroundColor: '#1e1f22',\n        border: '2px solid #5865f2',\n        borderRadius: '6px',\n        padding: '16px',\n        color: '#fff',\n        fontSize: '32px',\n        textAlign: 'center',\n        letterSpacing: '8px',\n        fontFamily: 'monospace',\n        outline: 'none'\n    },\n    backupInput: {\n        backgroundColor: '#1e1f22',\n        border: '1px solid #1e1f22',\n        borderRadius: '6px',\n        padding: '12px',\n        color: '#fff',\n        fontSize: '16px',\n        textAlign: 'center',\n        fontFamily: 'monospace',\n        outline: 'none'\n    },\n    backupLink: {\n        background: 'none',\n        border: 'none',\n        color: '#5865f2',\n        cursor: 'pointer',\n        fontSize: '14px',\n        textAlign: 'center',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        gap: '6px'\n    },\n    error: {\n        backgroundColor: '#da373c',\n        color: '#fff',\n        padding: '12px',\n        borderRadius: '6px',\n        fontSize: '14px',\n        textAlign: 'center'\n    },\n    submitButton: {\n        backgroundColor: '#5865f2',\n        color: '#fff',\n        border: 'none',\n        borderRadius: '6px',\n        padding: '12px',\n        fontSize: '16px',\n        fontWeight: 'bold',\n        cursor: 'pointer',\n        transition: 'background-color 0.2s'\n    },\n    info: {\n        backgroundColor: '#1e1f22',\n        borderRadius: '8px',\n        padding: '15px',\n        marginTop: '20px'\n    },\n    infoTitle: {\n        color: '#fff',\n        fontSize: '14px',\n        fontWeight: 'bold',\n        margin: '0 0 10px 0'\n    },\n    infoList: {\n        color: '#b9bbbe',\n        fontSize: '14px',\n        margin: 0,\n        paddingLeft: '20px'\n    }\n};\n\nexport default TwoFactorLoginPage;\n\n\n\n"],"names":["useState","useEffect","error","jsx","jsxs","Fragment"],"mappings":"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"}