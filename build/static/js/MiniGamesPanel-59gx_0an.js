var z=Object.defineProperty;var d=(c,i)=>z(c,"name",{value:i,configurable:!0});import{r as o,j as e}from"./react-core-Djgtqrmb.js";import{a8 as L,a as N,c8 as q,P as $,u as A,aq as F,aN as P}from"./icons-vendor-BW7dxHkX.js";import{t as f}from"./index-CjRzheBN.js";import"./media-vendor-CxFPycob.js";import"./router-vendor-ClgLnMjk.js";import"./state-vendor-BRqaXHJQ.js";import"./crypto-vendor-D1XRGppi.js";import"./ui-vendor-IhB9Znpc.js";const D=o.memo(({fetchWithAuth:c,apiBaseUrl:i,onClose:x,serverId:r})=>{const[y,a]=o.useState([]),[n,l]=o.useState(null),[h,C]=o.useState([]),[_,j]=o.useState(!1),[g,b]=o.useState("games");o.useEffect(()=>{S(),v()},[]);const S=d(async()=>{try{const p=await(await c(`${i}/games/?server_id=${r}`)).json();a(p.games||[])}catch{}},"fetchGames"),v=d(async()=>{try{const p=await(await c(`${i}/games/leaderboard/?server_id=${r}`)).json();C(p.leaderboard||[])}catch{}},"fetchLeaderboard"),w=o.useCallback(async t=>{j(!0);try{const m=await(await c(`${i}/games/create/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({game_type:t,server_id:r})})).json();m.game&&(l(m.game),b("playing"),f.success(`${m.game.game_type} started!`))}catch{f.error("Failed to create game")}finally{j(!1)}},[c,i,r]),T=d(async(t,p={})=>{if(n)try{const u=await(await c(`${i}/games/${n.id}/action/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:t,data:p})})).json();return u.game&&l(u.game),u.status==="finished"&&(f.success(`Game over! ${u.winners?.join(", ")} won ${u.reward} coins!`),setTimeout(()=>{l(null),b("games"),v()},3e3)),u}catch{f.error("Action failed")}},"performAction"),G={trivia:"ðŸ§ ",word_chain:"ðŸ“",tic_tac_toe:"â­•",rock_paper_scissors:"âœŠ",number_guess:"ðŸ”¢",emoji_quiz:"ðŸ˜€",hangman:"ðŸŽ¯",memory_match:"ðŸƒ"},R=o.useCallback(()=>b("games"),[]),B=o.useCallback(()=>b("leaderboard"),[]),I=o.useCallback(t=>w(t),[w]);return e.jsx("div",{style:s.overlay,children:e.jsxs("div",{style:s.modal,children:[e.jsxs("div",{style:s.header,children:[e.jsxs("div",{style:s.headerLeft,children:[e.jsx(L,{style:{marginRight:"10px",color:"#5865f2"}}),e.jsx("h2",{style:s.title,children:"Mini Games"})]}),e.jsx("button",{onClick:x,style:s.closeButton,children:e.jsx(N,{})})]}),e.jsxs("div",{style:s.tabs,children:[e.jsxs("button",{onClick:R,style:g==="games"?s.activeTab:s.tab,children:[e.jsx(q,{})," Games"]}),e.jsxs("button",{onClick:B,style:g==="leaderboard"?s.activeTab:s.tab,children:[e.jsx($,{})," Leaderboard"]})]}),e.jsxs("div",{style:s.content,children:[g==="games"&&e.jsx("div",{style:s.gamesGrid,children:y.map(t=>e.jsxs("div",{style:s.gameCard,children:[e.jsx("span",{style:s.gameIcon,children:G[t.id]||"ðŸŽ®"}),e.jsx("h3",{style:s.gameName,children:t.name}),e.jsx("p",{style:s.gameDesc,children:t.description}),e.jsxs("div",{style:s.gameInfo,children:[e.jsxs("span",{children:[e.jsx(A,{})," ",t.min_players,"-",t.max_players]}),e.jsxs("span",{children:[e.jsx(F,{})," ",t.reward_coins]})]}),e.jsxs("button",{onClick:d(()=>I(t.id),"onClick"),style:s.playButton,disabled:_,children:[e.jsx(P,{})," Play"]})]},t.id))}),g==="playing"&&n&&e.jsx(k,{game:n,onAction:T}),g==="leaderboard"&&e.jsxs("div",{style:s.leaderboard,children:[h.map((t,p)=>e.jsxs("div",{style:s.leaderboardRow,children:[e.jsx("span",{style:s.rank,children:p+1}),e.jsx("span",{style:s.playerName,children:t.username}),e.jsxs("span",{style:s.wins,children:[t.wins," wins"]}),e.jsxs("span",{style:s.totalScore,children:[t.total_score," pts"]})]},t.username)),h.length===0&&e.jsx("p",{style:s.emptyText,children:"No games played yet!"})]})]})]})})});D.displayName="MiniGamesPanel";const k=o.memo(({game:c,onAction:i})=>{const{game_type:x,state:r,players:y}=c;if(x==="trivia"){const a=r.questions?.[r.current_question];return e.jsxs("div",{style:s.gameArea,children:[e.jsxs("h3",{children:["Question ",r.current_question+1,"/",r.questions?.length]}),e.jsx("p",{style:s.question,children:a?.question}),e.jsx("div",{style:s.options,children:a?.options.map((n,l)=>e.jsx("button",{onClick:d(()=>i("answer",{answer:l}),"onClick"),style:s.optionButton,children:n},l))})]})}if(x==="tic_tac_toe")return e.jsxs("div",{style:s.gameArea,children:[e.jsx("h3",{children:"Tic Tac Toe"}),e.jsx("div",{style:s.ticTacToeBoard,children:r.board?.map((a,n)=>e.jsx("button",{onClick:d(()=>i("move",{position:n}),"onClick"),style:s.ticTacToeCell,disabled:a!==null,children:a===0?"âŒ":a===1?"â­•":""},n))})]});if(x==="number_guess"){const[a,n]=o.useState("");return e.jsxs("div",{style:s.gameArea,children:[e.jsx("h3",{children:"Guess the Number (1-100)"}),e.jsxs("p",{children:["Guesses left: ",r.max_guesses-(r.guesses?.length||0)]}),r.hints?.length>0&&e.jsxs("p",{children:["Last hint: Go ",r.hints[r.hints.length-1]]}),e.jsx("input",{type:"number",value:a,onChange:d(l=>n(l.target.value),"onChange"),style:s.guessInput,min:"1",max:"100"}),e.jsx("button",{onClick:d(()=>{i("guess",{number:parseInt(a)}),n("")},"onClick"),style:s.guessButton,children:"Guess!"})]})}if(x==="rock_paper_scissors")return e.jsxs("div",{style:s.gameArea,children:[e.jsxs("h3",{children:["Rock Paper Scissors - Round ",r.current_round,"/",r.max_rounds]}),e.jsx("div",{style:s.rpsButtons,children:["rock","paper","scissors"].map(a=>e.jsxs("button",{onClick:d(()=>i("choose",{choice:a}),"onClick"),style:s.rpsButton,children:[a==="rock"?"ðŸª¨":a==="paper"?"ðŸ“„":"âœ‚ï¸",e.jsx("span",{children:a})]},a))})]});if(x==="hangman"){const[a,n]=o.useState("");return e.jsxs("div",{style:s.gameArea,children:[e.jsx("h3",{children:"Hangman"}),e.jsx("p",{style:s.hangmanWord,children:r.display?.join(" ")}),e.jsxs("p",{children:["Wrong guesses: ",r.wrong_guesses,"/",r.max_wrong]}),e.jsxs("p",{children:["Used: ",r.guessed_letters?.join(", ")]}),e.jsx("input",{type:"text",value:a,onChange:d(l=>n(l.target.value.slice(-1).toUpperCase()),"onChange"),style:s.letterInput,maxLength:1}),e.jsx("button",{onClick:d(()=>{i("guess_letter",{letter:a}),n("")},"onClick"),style:s.guessButton,children:"Guess Letter"})]})}return e.jsxs("div",{style:s.gameArea,children:[e.jsxs("h3",{children:["Game: ",x]}),e.jsx("p",{children:"Game is in progress..."})]})});k.displayName="GameRenderer";const s={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e4},modal:{backgroundColor:"#2f3136",borderRadius:"12px",width:"700px",maxHeight:"85vh",overflow:"hidden",display:"flex",flexDirection:"column"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #40444b"},headerLeft:{display:"flex",alignItems:"center"},title:{margin:0,color:"#fff",fontSize:"20px"},closeButton:{background:"none",border:"none",color:"#b9bbbe",cursor:"pointer",fontSize:"20px"},tabs:{display:"flex",padding:"10px 20px",gap:"10px"},tab:{background:"#40444b",border:"none",color:"#b9bbbe",padding:"8px 16px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},activeTab:{background:"#5865f2",border:"none",color:"#fff",padding:"8px 16px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},content:{padding:"20px",overflowY:"auto",flex:1},gamesGrid:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"15px"},gameCard:{background:"#40444b",borderRadius:"10px",padding:"15px",textAlign:"center"},gameIcon:{fontSize:"40px"},gameName:{color:"#fff",margin:"10px 0 5px"},gameDesc:{color:"#b9bbbe",fontSize:"12px",marginBottom:"10px"},gameInfo:{display:"flex",justifyContent:"center",gap:"15px",color:"#b9bbbe",fontSize:"12px",marginBottom:"10px"},playButton:{background:"#5865f2",border:"none",color:"#fff",padding:"8px 20px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",margin:"0 auto"},gameArea:{textAlign:"center",color:"#fff"},question:{fontSize:"18px",marginBottom:"20px"},options:{display:"flex",flexDirection:"column",gap:"10px"},optionButton:{background:"#40444b",border:"none",color:"#fff",padding:"12px",borderRadius:"8px",cursor:"pointer",fontSize:"14px",transition:"background 0.2s"},ticTacToeBoard:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"5px",width:"200px",margin:"20px auto"},ticTacToeCell:{width:"60px",height:"60px",background:"#40444b",border:"none",borderRadius:"8px",fontSize:"30px",cursor:"pointer"},guessInput:{background:"#40444b",border:"none",color:"#fff",padding:"10px",borderRadius:"6px",width:"100px",textAlign:"center",fontSize:"18px"},guessButton:{background:"#5865f2",border:"none",color:"#fff",padding:"10px 20px",borderRadius:"6px",cursor:"pointer",marginLeft:"10px"},letterInput:{background:"#40444b",border:"none",color:"#fff",padding:"10px",borderRadius:"6px",width:"50px",textAlign:"center",fontSize:"24px",textTransform:"uppercase"},rpsButtons:{display:"flex",justifyContent:"center",gap:"20px"},rpsButton:{background:"#40444b",border:"none",color:"#fff",padding:"20px",borderRadius:"12px",cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",gap:"5px",fontSize:"40px"},hangmanWord:{fontSize:"32px",letterSpacing:"8px",marginBottom:"20px"},leaderboard:{display:"flex",flexDirection:"column",gap:"10px"},leaderboardRow:{display:"flex",alignItems:"center",gap:"15px",background:"#40444b",padding:"12px 15px",borderRadius:"8px"},rank:{color:"#faa61a",fontWeight:"bold",width:"40px"},playerName:{color:"#fff",flex:1},wins:{color:"#57f287"},totalScore:{color:"#b9bbbe"},emptyText:{color:"#72767d",textAlign:"center",padding:"40px"}};export{D as default};
