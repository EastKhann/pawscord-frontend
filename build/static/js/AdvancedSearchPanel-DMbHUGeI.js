var C=Object.defineProperty;var r=(n,d)=>C(n,"name",{value:d,configurable:!0});import{r as i,j as e}from"./react-core-Djgtqrmb.js";import{t as m,a as I,V as _,C as L,bv as y}from"./icons-vendor-BMXAt4pj.js";import{t as p}from"./index-D09YXCFH.js";import"./media-vendor-CxFPycob.js";import"./router-vendor-gmJ9Mn-1.js";import"./state-vendor-CbW2fAN9.js";import"./crypto-vendor-D1XRGppi.js";import"./ui-vendor-IhB9Znpc.js";const G=r(({fetchWithAuth:n,apiBaseUrl:d,onClose:b,serverId:j,roomSlug:v})=>{const[l,k]=i.useState(""),[x,S]=i.useState([]),[c,h]=i.useState(!1),[s,o]=i.useState({author:"",dateFrom:"",dateTo:"",hasImage:!1,hasVideo:!1,hasLink:!1,hasEmbed:!1}),f=r(async()=>{if(!l.trim()){p.error("Please enter a search query");return}h(!0);try{const a=new URLSearchParams({q:l,server_id:j||"",room_slug:v||"",author:s.author||"",date_from:s.dateFrom||"",date_to:s.dateTo||"",has_image:s.hasImage||"",has_video:s.hasVideo||"",has_link:s.hasLink||"",has_embed:s.hasEmbed||""}),u=await(await n(`${d}/search/advanced/?${a}`)).json();S(u.results||[]),p.success(`Found ${u.results?.length||0} results`)}catch{p.error("Search failed")}finally{h(!1)}},"search");return e.jsx("div",{style:t.overlay,children:e.jsxs("div",{style:t.modal,children:[e.jsxs("div",{style:t.header,children:[e.jsxs("div",{style:t.headerLeft,children:[e.jsx(m,{style:{marginRight:"10px",color:"#5865f2"}}),e.jsx("h2",{style:t.title,children:"Advanced Search"})]}),e.jsx("button",{onClick:b,style:t.closeButton,children:e.jsx(I,{})})]}),e.jsxs("div",{style:t.searchBar,children:[e.jsx("input",{type:"text",value:l,onChange:r(a=>k(a.target.value),"onChange"),onKeyDown:r(a=>a.key==="Enter"&&f(),"onKeyDown"),placeholder:"Search messages...",style:t.searchInput}),e.jsxs("button",{onClick:f,style:t.searchButton,disabled:c,children:[e.jsx(m,{})," ",c?"Searching...":"Search"]})]}),e.jsxs("div",{style:t.filtersSection,children:[e.jsxs("div",{style:t.filterHeader,children:[e.jsx(_,{style:{marginRight:"8px"}}),"Filters"]}),e.jsxs("div",{style:t.filtersGrid,children:[e.jsxs("div",{style:t.filterGroup,children:[e.jsxs("label",{style:t.filterLabel,children:[e.jsx(L,{style:{marginRight:"6px"}}),"Author"]}),e.jsx("input",{type:"text",value:s.author,onChange:r(a=>o({...s,author:a.target.value}),"onChange"),placeholder:"Username",style:t.filterInput})]}),e.jsxs("div",{style:t.filterGroup,children:[e.jsxs("label",{style:t.filterLabel,children:[e.jsx(y,{style:{marginRight:"6px"}}),"Date From"]}),e.jsx("input",{type:"date",value:s.dateFrom,onChange:r(a=>o({...s,dateFrom:a.target.value}),"onChange"),style:t.filterInput})]}),e.jsxs("div",{style:t.filterGroup,children:[e.jsxs("label",{style:t.filterLabel,children:[e.jsx(y,{style:{marginRight:"6px"}}),"Date To"]}),e.jsx("input",{type:"date",value:s.dateTo,onChange:r(a=>o({...s,dateTo:a.target.value}),"onChange"),style:t.filterInput})]})]}),e.jsxs("div",{style:t.checkboxGrid,children:[e.jsxs("label",{style:t.checkbox,children:[e.jsx("input",{type:"checkbox",checked:s.hasImage,onChange:r(a=>o({...s,hasImage:a.target.checked}),"onChange")}),"Has Image"]}),e.jsxs("label",{style:t.checkbox,children:[e.jsx("input",{type:"checkbox",checked:s.hasVideo,onChange:r(a=>o({...s,hasVideo:a.target.checked}),"onChange")}),"Has Video"]}),e.jsxs("label",{style:t.checkbox,children:[e.jsx("input",{type:"checkbox",checked:s.hasLink,onChange:r(a=>o({...s,hasLink:a.target.checked}),"onChange")}),"Has Link"]}),e.jsxs("label",{style:t.checkbox,children:[e.jsx("input",{type:"checkbox",checked:s.hasEmbed,onChange:r(a=>o({...s,hasEmbed:a.target.checked}),"onChange")}),"Has Embed"]})]})]}),e.jsx("div",{style:t.content,children:c?e.jsx("div",{style:t.loading,children:"Searching..."}):x.length===0?e.jsx("div",{style:t.empty,children:l?"No results found":"Enter a query and press search"}):e.jsx("div",{style:t.resultsList,children:x.map((a,g)=>e.jsxs("div",{style:t.resultCard,children:[e.jsxs("div",{style:t.resultHeader,children:[e.jsx("span",{style:t.resultAuthor,children:a.author_username}),e.jsx("span",{style:t.resultDate,children:new Date(a.created_at).toLocaleString()})]}),e.jsx("div",{style:t.resultContent,children:a.content}),a.room_name&&e.jsxs("div",{style:t.resultMeta,children:["#",a.room_name]}),(a.has_image||a.has_video||a.has_link)&&e.jsxs("div",{style:t.resultAttachments,children:[a.has_image&&e.jsx("span",{style:t.badge,children:"ðŸ“· Image"}),a.has_video&&e.jsx("span",{style:t.badge,children:"ðŸŽ¥ Video"}),a.has_link&&e.jsx("span",{style:t.badge,children:"ðŸ”— Link"})]})]},g))})})]})})},"AdvancedSearchPanel"),t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999},modal:{backgroundColor:"#1e1e1e",borderRadius:"8px",width:"90%",maxWidth:"1000px",maxHeight:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #2c2f33"},headerLeft:{display:"flex",alignItems:"center"},title:{margin:0,fontSize:"20px",color:"#ffffff"},closeButton:{background:"none",border:"none",color:"#99aab5",cursor:"pointer",fontSize:"20px",padding:"5px"},searchBar:{padding:"20px",borderBottom:"1px solid #2c2f33",display:"flex",gap:"12px"},searchInput:{flex:1,padding:"12px",backgroundColor:"#2c2f33",border:"1px solid #2c2f33",borderRadius:"4px",color:"#ffffff",fontSize:"14px"},searchButton:{padding:"12px 24px",backgroundColor:"#5865f2",border:"none",borderRadius:"4px",color:"#ffffff",cursor:"pointer",fontSize:"14px",display:"flex",alignItems:"center",gap:"8px"},filtersSection:{padding:"20px",borderBottom:"1px solid #2c2f33",backgroundColor:"#2c2f33"},filterHeader:{fontSize:"14px",fontWeight:"600",color:"#ffffff",marginBottom:"16px",display:"flex",alignItems:"center"},filtersGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"12px",marginBottom:"16px"},filterGroup:{display:"flex",flexDirection:"column",gap:"6px"},filterLabel:{fontSize:"13px",color:"#dcddde",display:"flex",alignItems:"center"},filterInput:{padding:"8px",backgroundColor:"#1e1e1e",border:"1px solid #1e1e1e",borderRadius:"4px",color:"#ffffff",fontSize:"13px"},checkboxGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"12px"},checkbox:{fontSize:"13px",color:"#dcddde",display:"flex",alignItems:"center",gap:"8px",cursor:"pointer"},content:{padding:"20px",overflowY:"auto",flex:1},loading:{textAlign:"center",color:"#99aab5",padding:"40px"},empty:{textAlign:"center",color:"#99aab5",padding:"40px"},resultsList:{display:"flex",flexDirection:"column",gap:"12px"},resultCard:{backgroundColor:"#2c2f33",borderRadius:"8px",padding:"16px"},resultHeader:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},resultAuthor:{fontSize:"14px",fontWeight:"600",color:"#5865f2"},resultDate:{fontSize:"12px",color:"#99aab5"},resultContent:{fontSize:"14px",color:"#dcddde",marginBottom:"8px",lineHeight:"1.5"},resultMeta:{fontSize:"12px",color:"#99aab5",marginBottom:"8px"},resultAttachments:{display:"flex",gap:"8px"},badge:{fontSize:"11px",padding:"4px 8px",backgroundColor:"#5865f2",borderRadius:"4px",color:"#ffffff"}};export{G as default};
