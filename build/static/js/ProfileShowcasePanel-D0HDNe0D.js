import{r as c,n as e}from"./react-core-Cj7FUMmY.js";import{U as N,a as D,a4 as L,ad as C,bb as V,bc as B,$ as O,aG as G,g as M,aO as R,ar as U,T as J,b0 as Y,aU as H,x as I,r as q,l as K}from"./icons-vendor-TGltgKsJ.js";import{y as u}from"./ui-vendor-EA4dxvko.js";import{h as Q}from"./index-CzTkJwMP.js";import"./editor-vendor-D9c4a6XZ.js";import"./media-vendor-By68PLJG.js";import"./router-vendor-QeioVw-9.js";import"./state-vendor-DGcbxrkI.js";import"./crypto-vendor-DK-7ILyQ.js";const ce=({userId:d,onClose:k,onUpdate:X,fetchWithAuth:g,apiBaseUrl:y})=>{const[n,t]=c.useState([]),[F,f]=c.useState(!0),[S,x]=c.useState(!1),[h,b]=c.useState(null),[a,r]=c.useState({type:"game",title:"",description:"",image_url:"",link_url:""}),[Z,W]=c.useState(null),j=[{key:"game",label:"Oyun",icon:e.jsx(U,{}),color:"#9c27b0"},{key:"achievement",label:"Başarı",icon:e.jsx(J,{}),color:"#ffc107"},{key:"art",label:"Sanat",icon:e.jsx(Y,{}),color:"#e91e63"},{key:"music",label:"Müzik",icon:e.jsx(H,{}),color:"#00bcd4"},{key:"video",label:"Video",icon:e.jsx(I,{}),color:"#f44336"},{key:"code",label:"Proje",icon:e.jsx(q,{}),color:"#4caf50"},{key:"link",label:"Link",icon:e.jsx(K,{}),color:"#2196f3"}];c.useEffect(()=>{_()},[d]);const _=async()=>{f(!0);try{const s=await g(`${y}/users/${d}/showcase/`);if(s.ok){const i=await s.json();t(i.items||[])}else t([])}catch{t([])}f(!1)},E=async()=>{if(!a.title.trim()){u.error("Başlık gerekli");return}const s={id:Date.now(),...a,order:n.length};try{await g(`${y}/users/${d}/showcase/`,{method:"POST",headers:{Authorization:`Bearer ${token}`,"Content-Type":"application/json"},body:JSON.stringify(s)})}catch{}t([...n,s]),m(),u.success("Vitrin öğesi eklendi")},$=async()=>{if(!(!a.title.trim()||!h)){try{await fetch(`/api/users/${d}/showcase/${h.id}/`,{method:"PATCH",headers:{Authorization:`Bearer ${token}`,"Content-Type":"application/json"},body:JSON.stringify(a)})}catch{}t(n.map(s=>s.id===h.id?{...s,...a}:s)),m(),u.success("Vitrin öğesi güncellendi")}},T=async s=>{if(await Q("Bu öğeyi silmek istediğinizden emin misiniz?")){try{await fetch(`/api/users/${d}/showcase/${s}/`,{method:"DELETE",headers:{Authorization:`Bearer ${token}`}})}catch{}t(n.filter(i=>i.id!==s)),u.success("Vitrin öğesi silindi")}},v=async(s,i)=>{const l=n.findIndex(p=>p.id===s);if(i==="up"&&l===0||i==="down"&&l===n.length-1)return;const o=[...n],w=i==="up"?l-1:l+1;[o[l],o[w]]=[o[w],o[l]],o.forEach((p,P)=>p.order=P),t(o);try{await fetch(`/api/users/${d}/showcase/reorder/`,{method:"POST",headers:{Authorization:`Bearer ${token}`,"Content-Type":"application/json"},body:JSON.stringify({order:o.map(p=>p.id)})})}catch{}},m=()=>{r({type:"game",title:"",description:"",image_url:"",link_url:""}),x(!1),b(null)},z=s=>{b(s),r({type:s.type,title:s.title,description:s.description||"",image_url:s.image_url||"",link_url:s.link_url||""}),x(!0)},A=s=>j.find(i=>i.key===s)||j[0];return e.jsx("div",{className:"showcase-overlay",onClick:s=>s.target.className==="showcase-overlay"&&k(),children:e.jsxs("div",{className:"showcase-panel",children:[e.jsxs("div",{className:"panel-header",children:[e.jsxs("h2",{children:[e.jsx(N,{})," Profil Vitrini"]}),e.jsx("button",{className:"close-btn",onClick:k,children:e.jsx(D,{})})]}),e.jsxs("div",{className:"panel-info",children:[e.jsx(L,{}),e.jsx("p",{children:"Profilinizde gösterilecek en fazla 6 öğe seçebilirsiniz"})]}),e.jsx("div",{className:"showcase-list",children:F?e.jsx("div",{className:"loading",children:"Yükleniyor..."}):n.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx(N,{}),e.jsx("p",{children:"Henüz vitrin öğesi yok"}),e.jsxs("button",{onClick:()=>x(!0),children:[e.jsx(C,{})," İlk Öğeyi Ekle"]})]}):n.map((s,i)=>{const l=A(s.type);return e.jsxs("div",{className:"showcase-item",children:[e.jsxs("div",{className:"item-drag",children:[e.jsx("button",{onClick:()=>v(s.id,"up"),disabled:i===0,children:e.jsx(V,{})}),e.jsx("button",{onClick:()=>v(s.id,"down"),disabled:i===n.length-1,children:e.jsx(B,{})})]}),e.jsx("div",{className:"item-icon",style:{background:l.color},children:l.icon}),s.image_url&&e.jsx("div",{className:"item-image",children:e.jsx("img",{src:s.image_url,alt:s.title})}),e.jsxs("div",{className:"item-info",children:[e.jsx("span",{className:"item-type",children:l.label}),e.jsx("h4",{children:s.title}),s.description&&e.jsx("p",{children:s.description}),s.link_url&&e.jsxs("a",{href:s.link_url,target:"_blank",rel:"noopener noreferrer",children:[e.jsx(O,{})," Linke Git"]})]}),e.jsxs("div",{className:"item-actions",children:[e.jsx("button",{onClick:()=>z(s),children:e.jsx(G,{})}),e.jsx("button",{onClick:()=>T(s.id),children:e.jsx(M,{})})]})]},s.id)})}),n.length<6&&n.length>0&&e.jsxs("div",{className:"add-section",children:[e.jsxs("button",{className:"add-btn",onClick:()=>x(!0),children:[e.jsx(C,{})," Yeni Öğe Ekle"]}),e.jsxs("span",{className:"remaining",children:[6-n.length," slot kaldı"]})]}),S&&e.jsx("div",{className:"modal-overlay",onClick:()=>m(),children:e.jsxs("div",{className:"modal-content",onClick:s=>s.stopPropagation(),children:[e.jsx("h3",{children:h?"Öğeyi Düzenle":"Yeni Vitrin Öğesi"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Tür"}),e.jsx("div",{className:"type-selector",children:j.map(s=>e.jsxs("button",{className:`type-btn ${a.type===s.key?"selected":""}`,style:{"--color":s.color},onClick:()=>r({...a,type:s.key}),children:[s.icon,e.jsx("span",{children:s.label})]},s.key))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Başlık *"}),e.jsx("input",{type:"text",placeholder:"Örn: Valorant",value:a.title,onChange:s=>r({...a,title:s.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Açıklama"}),e.jsx("input",{type:"text",placeholder:"Örn: Diamond 3 Rank",value:a.description,onChange:s=>r({...a,description:s.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Görsel URL"}),e.jsx("input",{type:"text",placeholder:"https://...",value:a.image_url,onChange:s=>r({...a,image_url:s.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Link URL"}),e.jsx("input",{type:"text",placeholder:"https://...",value:a.link_url,onChange:s=>r({...a,link_url:s.target.value})})]}),e.jsxs("div",{className:"modal-actions",children:[e.jsx("button",{className:"cancel-btn",onClick:m,children:"İptal"}),e.jsxs("button",{className:"save-btn",onClick:h?$:E,children:[e.jsx(R,{})," ",h?"Güncelle":"Ekle"]})]})]})})]})})};export{ce as default};
