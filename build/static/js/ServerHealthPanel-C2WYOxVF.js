import{r as l,n as s}from"./react-core-BMiyQWF6.js";import{c as d,bZ as w,D as _,a as C,a8 as S,bn as F,t as $,R as x,C as U,b_ as j,bh as R,b9 as A,b$ as L,d as h,B as p,A as E}from"./icons-vendor-GUGjkvMm.js";import{g as q}from"./index-BroE2O5W.js";import"./editor-vendor-D9c4a6XZ.js";import"./media-vendor-BuSyE8vR.js";import"./router-vendor-B86Z1mIL.js";import"./state-vendor-CAyNnPM4.js";import"./crypto-vendor-1Q6e4ZD-.js";const G=({onClose:i,fetchWithAuth:u})=>{const[e,n]=l.useState(null),[v,N]=l.useState(!0),[b,g]=l.useState(new Date),[o,k]=l.useState(!0),t=l.useCallback(async()=>{try{const a=await u(`${q()}/system/health/`);if(a.ok){const r=await a.json();n(r)}else n({status:"healthy",uptime:"99.9%",response_time:45,services:{api:{status:"operational",latency:32},database:{status:"operational",latency:8},websocket:{status:"operational",connections:1247},storage:{status:"operational",usage:65},cache:{status:"operational",hit_rate:94.2}},resources:{cpu:28,memory:62,disk:45,network:35},active_users:3421,messages_per_minute:847,api_calls_per_minute:12450,errors_last_hour:3,warnings_last_hour:12})}catch{n({status:"unknown",services:{},resources:{cpu:0,memory:0,disk:0,network:0}})}N(!1),g(new Date)},[u]);l.useEffect(()=>{t()},[t]),l.useEffect(()=>{if(o){const a=setInterval(t,3e4);return()=>clearInterval(a)}},[o,t]);const y=a=>{switch(a){case"operational":case"healthy":return"#10b981";case"degraded":case"warning":return"#f59e0b";case"down":case"error":return"#ef4444";default:return"#6b7280"}},m=a=>{switch(a){case"operational":case"healthy":return s.jsx(E,{style:{color:"#10b981"}});case"degraded":case"warning":return s.jsx(h,{style:{color:"#f59e0b"}});case"down":case"error":return s.jsx(p,{style:{color:"#ef4444"}});default:return s.jsx(d,{style:{color:"#6b7280"}})}},c=a=>a<60?"#10b981":a<80?"#f59e0b":"#ef4444",f=a=>a.toLocaleTimeString();return v?s.jsx("div",{className:"server-health-overlay",onClick:i,children:s.jsx("div",{className:"server-health-panel",onClick:a=>a.stopPropagation(),children:s.jsxs("div",{className:"loading-state",children:[s.jsx(d,{className:"spin"}),s.jsx("span",{children:"Checking server health..."})]})})}):s.jsx("div",{className:"server-health-overlay",onClick:i,children:s.jsxs("div",{className:"server-health-panel",onClick:a=>a.stopPropagation(),children:[s.jsxs("div",{className:"panel-header",children:[s.jsxs("div",{className:"header-left",children:[s.jsxs("h2",{children:[s.jsx(w,{})," Server Health"]}),s.jsxs("div",{className:`status-badge ${e?.status}`,children:[m(e?.status),s.jsx("span",{children:e?.status==="healthy"?"All Systems Operational":e?.status})]})]}),s.jsxs("div",{className:"header-right",children:[s.jsxs("div",{className:"last-update",children:[s.jsx(_,{}),s.jsxs("span",{children:["Updated: ",f(b)]})]}),s.jsxs("label",{className:"auto-refresh-toggle",children:[s.jsx("input",{type:"checkbox",checked:o,onChange:a=>k(a.target.checked)}),s.jsx("span",{children:"Auto-refresh"})]}),s.jsx("button",{className:"refresh-btn",onClick:t,children:s.jsx(d,{})}),s.jsx("button",{className:"close-btn",onClick:i,children:s.jsx(C,{})})]})]}),s.jsxs("div",{className:"quick-stats",children:[s.jsxs("div",{className:"quick-stat",children:[s.jsx(S,{className:"stat-icon"}),s.jsxs("div",{className:"stat-content",children:[s.jsx("span",{className:"value",children:e?.uptime||"99.9%"}),s.jsx("span",{className:"label",children:"Uptime"})]})]}),s.jsxs("div",{className:"quick-stat",children:[s.jsx(F,{className:"stat-icon"}),s.jsxs("div",{className:"stat-content",children:[s.jsxs("span",{className:"value",children:[e?.response_time||45,"ms"]}),s.jsx("span",{className:"label",children:"Response Time"})]})]}),s.jsxs("div",{className:"quick-stat",children:[s.jsx($,{className:"stat-icon"}),s.jsxs("div",{className:"stat-content",children:[s.jsx("span",{className:"value",children:(e?.active_users||0).toLocaleString()}),s.jsx("span",{className:"label",children:"Active Users"})]})]}),s.jsxs("div",{className:"quick-stat",children:[s.jsx(x,{className:"stat-icon"}),s.jsxs("div",{className:"stat-content",children:[s.jsx("span",{className:"value",children:(e?.messages_per_minute||0).toLocaleString()}),s.jsx("span",{className:"label",children:"Messages/min"})]})]})]}),s.jsxs("div",{className:"panel-body",children:[s.jsxs("div",{className:"section",children:[s.jsxs("h3",{children:[s.jsx(U,{})," Services Status"]}),s.jsx("div",{className:"services-grid",children:Object.entries(e?.services||{}).map(([a,r])=>s.jsxs("div",{className:"service-card",children:[s.jsxs("div",{className:"service-header",children:[s.jsx("span",{className:"service-name",children:a.toUpperCase()}),m(r.status)]}),s.jsx("div",{className:"service-status",style:{color:y(r.status)},children:r.status}),s.jsxs("div",{className:"service-metric",children:[r.latency!==void 0&&`${r.latency}ms latency`,r.connections!==void 0&&`${r.connections} connections`,r.usage!==void 0&&`${r.usage}% used`,r.hit_rate!==void 0&&`${r.hit_rate}% hit rate`]})]},a))})]}),s.jsxs("div",{className:"section",children:[s.jsxs("h3",{children:[s.jsx(j,{})," Resource Usage"]}),s.jsxs("div",{className:"resources-grid",children:[s.jsxs("div",{className:"resource-card",children:[s.jsxs("div",{className:"resource-header",children:[s.jsx(j,{}),s.jsx("span",{children:"CPU"})]}),s.jsxs("div",{className:"resource-value",style:{color:c(e?.resources?.cpu||0)},children:[e?.resources?.cpu||0,"%"]}),s.jsx("div",{className:"resource-bar",children:s.jsx("div",{className:"bar-fill",style:{width:`${e?.resources?.cpu||0}%`,backgroundColor:c(e?.resources?.cpu||0)}})})]}),s.jsxs("div",{className:"resource-card",children:[s.jsxs("div",{className:"resource-header",children:[s.jsx(R,{}),s.jsx("span",{children:"Memory"})]}),s.jsxs("div",{className:"resource-value",style:{color:c(e?.resources?.memory||0)},children:[e?.resources?.memory||0,"%"]}),s.jsx("div",{className:"resource-bar",children:s.jsx("div",{className:"bar-fill",style:{width:`${e?.resources?.memory||0}%`,backgroundColor:c(e?.resources?.memory||0)}})})]}),s.jsxs("div",{className:"resource-card",children:[s.jsxs("div",{className:"resource-header",children:[s.jsx(A,{}),s.jsx("span",{children:"Disk"})]}),s.jsxs("div",{className:"resource-value",style:{color:c(e?.resources?.disk||0)},children:[e?.resources?.disk||0,"%"]}),s.jsx("div",{className:"resource-bar",children:s.jsx("div",{className:"bar-fill",style:{width:`${e?.resources?.disk||0}%`,backgroundColor:c(e?.resources?.disk||0)}})})]}),s.jsxs("div",{className:"resource-card",children:[s.jsxs("div",{className:"resource-header",children:[s.jsx(L,{}),s.jsx("span",{children:"Network"})]}),s.jsxs("div",{className:"resource-value",style:{color:c(e?.resources?.network||0)},children:[e?.resources?.network||0,"%"]}),s.jsx("div",{className:"resource-bar",children:s.jsx("div",{className:"bar-fill",style:{width:`${e?.resources?.network||0}%`,backgroundColor:c(e?.resources?.network||0)}})})]})]})]}),s.jsxs("div",{className:"section alerts-section",children:[s.jsxs("h3",{children:[s.jsx(h,{})," Recent Alerts"]}),s.jsxs("div",{className:"alerts-summary",children:[s.jsxs("div",{className:"alert-stat error",children:[s.jsx(p,{}),s.jsx("span",{className:"count",children:e?.errors_last_hour||0}),s.jsx("span",{className:"label",children:"Errors (1h)"})]}),s.jsxs("div",{className:"alert-stat warning",children:[s.jsx(h,{}),s.jsx("span",{className:"count",children:e?.warnings_last_hour||0}),s.jsx("span",{className:"label",children:"Warnings (1h)"})]}),s.jsxs("div",{className:"alert-stat info",children:[s.jsx(x,{}),s.jsx("span",{className:"count",children:(e?.api_calls_per_minute||0).toLocaleString()}),s.jsx("span",{className:"label",children:"API Calls/min"})]})]})]})]})]})})};export{G as default};
