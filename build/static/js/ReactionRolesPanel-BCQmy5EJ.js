import{r as l,n as e}from"./react-core-zXIKm1Jm.js";import{y as r}from"./ui-vendor-BGw4w3Ed.js";import{g as z}from"./index-BQhmOVgm.js";import"./editor-vendor-DiU449Dh.js";import"./media-vendor-BSOZ7IB3.js";import"./router-vendor-ltdGXAv4.js";import"./crypto-vendor-D_AcF0lD.js";import"./icons-vendor-BBdoVeJd.js";import"./state-vendor-8NbFPBhQ.js";const I=({serverId:i,onClose:h})=>{const[d,m]=l.useState([]),[x,g]=l.useState([]),[v,f]=l.useState([]),[o,t]=l.useState({message_id:"",channel_id:"",emoji:"",role_id:"",description:""}),[N,k]=l.useState(!0),[j,p]=l.useState(!1),c=z();l.useEffect(()=>{i&&(u(),y(),R())},[i]);const u=async()=>{try{const s=localStorage.getItem("access_token"),a=await fetch(`${c}/reaction-roles/server/${i}/`,{headers:{Authorization:`Bearer ${s}`}});if(a.ok){const n=await a.json();m(n.reaction_roles||[])}}catch(s){console.error("Error fetching reaction roles:",s)}finally{k(!1)}},y=async()=>{try{const s=localStorage.getItem("access_token"),a=await fetch(`${c}/servers/${i}/roles/`,{headers:{Authorization:`Bearer ${s}`}});if(a.ok){const n=await a.json();g(n.roles||[])}}catch(s){console.error("Error fetching roles:",s)}},R=async()=>{try{const s=localStorage.getItem("access_token"),a=await fetch(`${c}/servers/${i}/channels/`,{headers:{Authorization:`Bearer ${s}`}});if(a.ok){const n=await a.json();f(n.channels||[])}}catch(s){console.error("Error fetching channels:",s)}},_=async()=>{if(!o.message_id||!o.emoji||!o.role_id){r.error("âŒ Mesaj ID, emoji ve rol zorunludur");return}try{const s=localStorage.getItem("access_token"),a=await fetch(`${c}/reaction-roles/create/`,{method:"POST",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},body:JSON.stringify({server_id:i,...o})});if(a.ok){const n=await a.json();m([...d,n.reaction_role]),t({message_id:"",channel_id:"",emoji:"",role_id:"",description:""}),r.success("âœ… Reaction role oluÅŸturuldu")}else{const n=await a.json();r.error(`âŒ ${n.error||"OluÅŸturma baÅŸarÄ±sÄ±z"}`)}}catch(s){console.error("Error creating reaction role:",s),r.error("âŒ OluÅŸturma baÅŸarÄ±sÄ±z")}},b=async s=>{if(window.confirm("Bu reaction role'Ã¼ silmek istediÄŸinizden emin misiniz?"))try{const a=localStorage.getItem("access_token");(await fetch(`${c}/reaction-roles/${s}/delete/`,{method:"DELETE",headers:{Authorization:`Bearer ${a}`}})).ok&&(m(d.filter(S=>S.id!==s)),r.success("âœ… Reaction role silindi"))}catch(a){console.error("Error deleting reaction role:",a),r.error("âŒ Silme baÅŸarÄ±sÄ±z")}},w=async()=>{try{const s=localStorage.getItem("access_token");(await fetch(`${c}/reaction-roles/server/${i}/sync/`,{method:"POST",headers:{Authorization:`Bearer ${s}`}})).ok&&(r.success("âœ… Reaction roller senkronize edildi"),u())}catch(s){console.error("Error syncing reaction roles:",s),r.error("âŒ Senkronizasyon baÅŸarÄ±sÄ±z")}},$=["â¤ï¸","ğŸ’™","ğŸ’š","ğŸ’›","ğŸ§¡","ğŸ’œ","ğŸ–¤","ğŸ¤","ğŸ”´","ğŸŸ ","ğŸŸ¡","ğŸŸ¢","ğŸ”µ","ğŸŸ£","âšª","âš«","âœ…","âŒ","â­","ğŸ‰","ğŸ®","ğŸµ","ğŸ“š","ğŸ†"];return N?e.jsx("div",{className:"reaction-roles-overlay",children:e.jsx("div",{className:"reaction-roles-panel",children:e.jsxs("div",{className:"loading-state",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{children:"Reaction roller yÃ¼kleniyor..."})]})})}):e.jsx("div",{className:"reaction-roles-overlay",onClick:h,children:e.jsxs("div",{className:"reaction-roles-panel",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"reaction-header",children:[e.jsx("h2",{children:"â­ Reaction Roles"}),e.jsx("button",{className:"close-btn",onClick:h,children:"Ã—"})]}),e.jsxs("div",{className:"create-section",children:[e.jsx("h3",{children:"ğŸ†• Yeni Reaction Role"}),e.jsxs("div",{className:"form-grid",children:[e.jsxs("div",{className:"form-group full-width",children:[e.jsx("label",{children:"Kanal"}),e.jsxs("select",{value:o.channel_id,onChange:s=>t({...o,channel_id:s.target.value}),children:[e.jsx("option",{value:"",children:"Kanal seÃ§in (opsiyonel)"}),v.map(s=>e.jsxs("option",{value:s.id,children:["#",s.name]},s.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Mesaj ID *"}),e.jsx("input",{type:"text",placeholder:"Mesaj ID'sini girin",value:o.message_id,onChange:s=>t({...o,message_id:s.target.value})}),e.jsx("span",{className:"input-hint",children:"Mesaja saÄŸ tÄ±k â†’ Mesaj ID'sini Kopyala"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Rol *"}),e.jsxs("select",{value:o.role_id,onChange:s=>t({...o,role_id:s.target.value}),children:[e.jsx("option",{value:"",children:"Rol seÃ§in"}),x.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{className:"form-group full-width",children:[e.jsx("label",{children:"Emoji *"}),e.jsxs("div",{className:"emoji-input-group",children:[e.jsx("input",{type:"text",placeholder:"Emoji seÃ§ veya gir",value:o.emoji,onChange:s=>t({...o,emoji:s.target.value}),readOnly:!0}),e.jsx("button",{className:"emoji-picker-btn",onClick:()=>p(!j),children:"ğŸ˜€"})]}),j&&e.jsx("div",{className:"emoji-picker",children:$.map(s=>e.jsx("button",{className:"emoji-option",onClick:()=>{t({...o,emoji:s}),p(!1)},children:s},s))})]}),e.jsxs("div",{className:"form-group full-width",children:[e.jsx("label",{children:"AÃ§Ä±klama"}),e.jsx("input",{type:"text",placeholder:"Bu rol iÃ§in aÃ§Ä±klama (opsiyonel)",value:o.description,onChange:s=>t({...o,description:s.target.value})})]})]}),e.jsx("button",{className:"create-btn",onClick:_,children:"â• Reaction Role OluÅŸtur"})]}),e.jsxs("div",{className:"actions-bar",children:[e.jsxs("div",{className:"info-text",children:[e.jsx("span",{className:"count-badge",children:d.length})," adet reaction role"]}),e.jsx("button",{className:"sync-btn",onClick:w,children:"ğŸ”„ Senkronize Et"})]}),e.jsx("div",{className:"reaction-roles-list",children:d.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("span",{className:"empty-icon",children:"â­"}),e.jsx("p",{children:"HenÃ¼z reaction role yok"}),e.jsx("span",{children:"KullanÄ±cÄ±larÄ±n emoji ile rol almasÄ±nÄ± saÄŸlayÄ±n"})]}):d.map(s=>e.jsxs("div",{className:"reaction-role-card",children:[e.jsxs("div",{className:"rr-header",children:[e.jsx("div",{className:"rr-emoji",children:s.emoji}),e.jsxs("div",{className:"rr-info",children:[e.jsx("h4",{children:s.role_name||`Role #${s.role_id}`}),s.description&&e.jsx("p",{className:"rr-description",children:s.description})]}),e.jsx("button",{className:"delete-btn",onClick:()=>b(s.id),children:"ğŸ—‘ï¸"})]}),e.jsxs("div",{className:"rr-meta",children:[e.jsxs("div",{className:"meta-item",children:[e.jsx("span",{className:"meta-label",children:"ğŸ“¢ Kanal:"}),e.jsx("span",{className:"meta-value",children:s.channel_name?`#${s.channel_name}`:"Belirtilmedi"})]}),e.jsxs("div",{className:"meta-item",children:[e.jsx("span",{className:"meta-label",children:"ğŸ’¬ Mesaj ID:"}),e.jsx("span",{className:"meta-value mono",children:s.message_id})]}),e.jsxs("div",{className:"meta-item",children:[e.jsx("span",{className:"meta-label",children:"ğŸ‘¥ KullanÄ±mlar:"}),e.jsxs("span",{className:"meta-value",children:[s.usage_count||0," kez kullanÄ±ldÄ±"]})]})]})]},s.id))})]})})};export{I as default};
