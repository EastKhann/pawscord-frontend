import{r,a0 as $,aI as z,ay as p,ci as T,cj as B,bu as F,v as O,o as j,b_ as P}from"./react-core-B6hadH-M.js";import{t as l}from"./index-D_6pZib5.js";const D=({serverId:s,onClose:u})=>{const[o,i]=r.useState([]),[y,d]=r.useState(!0),[k,m]=r.useState(!1),[x,E]=r.useState(null),[a,n]=r.useState({name:"",type:"spam",action:"warn",enabled:!0,keywords:[],threshold:5,duration:60});r.useEffect(()=>{h()},[s]);const h=async()=>{d(!0);try{const e=await fetch(`/api/moderation/auto-mod/rules/${s}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(e.ok){const t=await e.json();i(t.rules||[])}}catch{l.error("âŒ Kurallar yÃ¼klenemedi")}finally{d(!1)}},v=async()=>{if(!a.name.trim()){l.error("âŒ Kural adÄ± girin");return}try{const e=await fetch(`/api/moderation/auto-mod/rules/${s}/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`,"Content-Type":"application/json"},body:JSON.stringify(a)});if(e.ok){const t=await e.json();i([...o,t.rule]),m(!1),b(),l.success("âœ… Kural oluÅŸturuldu")}else l.error("âŒ Kural oluÅŸturulamadÄ±")}catch{l.error("âŒ BaÄŸlantÄ± hatasÄ±")}},f=async(e,t)=>{try{const c=await fetch(`/api/moderation/auto-mod/rules/${s}/${e}/`,{method:"PUT",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`,"Content-Type":"application/json"},body:JSON.stringify(t)});if(c.ok){const A=await c.json();i(o.map(R=>R.id===e?A.rule:R)),E(null),l.success("âœ… Kural gÃ¼ncellendi")}}catch{l.error("âŒ GÃ¼ncelleme baÅŸarÄ±sÄ±z")}},g=async e=>{if(confirm("Bu kuralÄ± silmek istediÄŸinizden emin misiniz?"))try{(await fetch(`/api/moderation/auto-mod/rules/${s}/${e}/`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}})).ok&&(i(o.filter(c=>c.id!==e)),l.success("âœ… Kural silindi"))}catch{l.error("âŒ Silme baÅŸarÄ±sÄ±z")}},N=async(e,t)=>{await f(e,{enabled:t})},b=()=>{n({name:"",type:"spam",action:"warn",enabled:!0,keywords:[],threshold:5,duration:60})},w=e=>{e.trim()&&!a.keywords.includes(e.trim())&&n({...a,keywords:[...a.keywords,e.trim()]})},C=e=>{n({...a,keywords:a.keywords.filter(t=>t!==e)})},S=e=>{switch(e){case"spam":return React.createElement(P,null);case"profanity":return React.createElement(j,null);case"caps":return"ðŸ”¤";case"links":return"ðŸ”—";case"mentions":return"@";default:return React.createElement(p,null)}},K=e=>{switch(e){case"warn":return"#faa61a";case"mute":return"#ff9500";case"kick":return"#ff3b30";case"ban":return"#ff0000";default:return"#8b5cf6"}};return React.createElement("div",{className:"auto-mod-panel-overlay",onClick:u},React.createElement("div",{className:"auto-mod-panel",onClick:e=>e.stopPropagation()},React.createElement("div",{className:"panel-header"},React.createElement($,{className:"header-icon"}),React.createElement("h2",null,"Otomatik Moderasyon"),React.createElement("button",{className:"close-btn",onClick:u},"Ã—")),React.createElement("div",{className:"panel-actions"},React.createElement("button",{className:"btn-create",onClick:()=>m(!0)},React.createElement(z,null)," Yeni Kural")),y?React.createElement("div",{className:"loading-state"},React.createElement("div",{className:"spinner"}),React.createElement("p",null,"YÃ¼kleniyor...")):React.createElement("div",{className:"rules-list"},o.length===0?React.createElement("div",{className:"empty-state"},React.createElement(p,{size:48}),React.createElement("h3",null,"Kural Yok"),React.createElement("p",null,"Otomatik moderasyon kurallarÄ± oluÅŸturun")):o.map(e=>React.createElement("div",{key:e.id,className:`rule-card ${e.enabled?"":"disabled"}`},React.createElement("div",{className:"rule-header"},React.createElement("div",{className:"rule-icon"},S(e.type)),React.createElement("div",{className:"rule-info"},React.createElement("h3",null,e.name),React.createElement("span",{className:"rule-type"},e.type)),React.createElement("div",{className:"rule-actions"},React.createElement("button",{className:"action-btn toggle",onClick:()=>N(e.id,!e.enabled),title:e.enabled?"Devre DÄ±ÅŸÄ± BÄ±rak":"EtkinleÅŸtir"},e.enabled?React.createElement(T,null):React.createElement(B,null)),React.createElement("button",{className:"action-btn edit",onClick:()=>E(e),title:"DÃ¼zenle"},React.createElement(F,null)),React.createElement("button",{className:"action-btn delete",onClick:()=>g(e.id),title:"Sil"},React.createElement(O,null)))),React.createElement("div",{className:"rule-details"},React.createElement("div",{className:"detail-item"},React.createElement("span",{className:"label"},"Aksiyon:"),React.createElement("span",{className:"value action-badge",style:{backgroundColor:K(e.action)}},e.action)),e.keywords&&e.keywords.length>0&&React.createElement("div",{className:"detail-item"},React.createElement("span",{className:"label"},"Anahtar Kelimeler:"),React.createElement("div",{className:"keywords"},e.keywords.map((t,c)=>React.createElement("span",{key:c,className:"keyword"},t)))),e.threshold&&React.createElement("div",{className:"detail-item"},React.createElement("span",{className:"label"},"EÅŸik:"),React.createElement("span",{className:"value"},e.threshold)))))),k&&React.createElement("div",{className:"rule-editor-modal"},React.createElement("div",{className:"rule-editor"},React.createElement("h3",null,"Yeni Kural OluÅŸtur"),React.createElement("div",{className:"form-group"},React.createElement("label",null,"Kural AdÄ±"),React.createElement("input",{type:"text",value:a.name,onChange:e=>n({...a,name:e.target.value}),placeholder:"Ã–rn: Spam Engelleme"})),React.createElement("div",{className:"form-row"},React.createElement("div",{className:"form-group"},React.createElement("label",null,"Kural Tipi"),React.createElement("select",{value:a.type,onChange:e=>n({...a,type:e.target.value})},React.createElement("option",{value:"spam"},"Spam"),React.createElement("option",{value:"profanity"},"KÃ¼fÃ¼r"),React.createElement("option",{value:"caps"},"BÃ¼yÃ¼k Harf"),React.createElement("option",{value:"links"},"Link"),React.createElement("option",{value:"mentions"},"Mention"))),React.createElement("div",{className:"form-group"},React.createElement("label",null,"Aksiyon"),React.createElement("select",{value:a.action,onChange:e=>n({...a,action:e.target.value})},React.createElement("option",{value:"warn"},"Uyar"),React.createElement("option",{value:"mute"},"Sustur"),React.createElement("option",{value:"kick"},"At"),React.createElement("option",{value:"ban"},"Yasakla")))),React.createElement("div",{className:"form-group"},React.createElement("label",null,"Anahtar Kelimeler (Enter ile ekle)"),React.createElement("input",{type:"text",placeholder:"Kelime girin ve Enter'a basÄ±n",onKeyPress:e=>{e.key==="Enter"&&(w(e.target.value),e.target.value="")}}),React.createElement("div",{className:"keywords-list"},a.keywords.map((e,t)=>React.createElement("span",{key:t,className:"keyword-chip"},e,React.createElement("button",{onClick:()=>C(e)},"Ã—"))))),React.createElement("div",{className:"form-row"},React.createElement("div",{className:"form-group"},React.createElement("label",null,"EÅŸik"),React.createElement("input",{type:"number",value:a.threshold,onChange:e=>n({...a,threshold:parseInt(e.target.value)}),min:"1"})),React.createElement("div",{className:"form-group"},React.createElement("label",null,"SÃ¼re (saniye)"),React.createElement("input",{type:"number",value:a.duration,onChange:e=>n({...a,duration:parseInt(e.target.value)}),min:"1"}))),React.createElement("div",{className:"modal-actions"},React.createElement("button",{className:"btn-cancel",onClick:()=>m(!1)},"Ä°ptal"),React.createElement("button",{className:"btn-save",onClick:v},"OluÅŸtur"))))))};export{D as default};
