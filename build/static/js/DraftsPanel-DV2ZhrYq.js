import{r as c,bu as p,l as b,Y as E,v as R}from"./react-core-B6hadH-M.js";import{t as o}from"./index-D_6pZib5.js";const D=({fetchWithAuth:n,apiBaseUrl:l,onClose:s,roomSlug:i})=>{const[a,m]=c.useState([]),[x,f]=c.useState(!1);c.useEffect(()=>{d()},[]);const d=async()=>{f(!0);try{const r=await(await n(`${l}/api/drafts/?room_slug=${i}`)).json();m(r.drafts||[])}catch{o.error("Failed to load drafts")}finally{f(!1)}},g=t=>{window.dispatchEvent(new CustomEvent("loadDraft",{detail:t})),o.success("Draft loaded into message box"),s()},y=async t=>{if(confirm("Delete this draft?"))try{await n(`${l}/api/drafts/${t}/delete/`,{method:"DELETE"}),o.success("Draft deleted"),d()}catch{o.error("Failed to delete draft")}},u=async()=>{if(confirm(`Delete all ${a.length} drafts?`))try{await n(`${l}/api/drafts/delete-all/`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({room_slug:i})}),o.success("All drafts deleted"),d()}catch{o.error("Failed to delete drafts")}};return React.createElement("div",{style:e.overlay},React.createElement("div",{style:e.modal},React.createElement("div",{style:e.header},React.createElement("div",{style:e.headerLeft},React.createElement(p,{style:{marginRight:"10px",color:"#5865f2"}}),React.createElement("h2",{style:e.title},"Message Drafts")),React.createElement("button",{onClick:s,style:e.closeButton},React.createElement(b,null))),a.length>0&&React.createElement("div",{style:e.toolbar},React.createElement("div",{style:e.draftCount},a.length," ",a.length===1?"draft":"drafts"),React.createElement("button",{onClick:u,style:e.deleteAllButton},"Delete All")),React.createElement("div",{style:e.content},x?React.createElement("div",{style:e.loading},"Loading drafts..."):a.length===0?React.createElement("div",{style:e.empty},React.createElement(p,{style:{fontSize:"48px",color:"#2c2f33",marginBottom:"16px"}}),React.createElement("div",null,"No drafts saved"),React.createElement("div",{style:e.emptySubtext},"Start typing a message and it will be automatically saved as a draft")):React.createElement("div",{style:e.draftsList},a.map((t,r)=>React.createElement("div",{key:r,style:e.draftCard},React.createElement("div",{style:e.draftContent,onClick:()=>g(t)},React.createElement("div",{style:e.draftText},t.content.substring(0,200),t.content.length>200&&"..."),React.createElement("div",{style:e.draftMeta},React.createElement(E,{style:{marginRight:"6px",fontSize:"11px"}}),new Date(t.updated_at).toLocaleString()),t.room_name&&React.createElement("div",{style:e.draftRoom},"#",t.room_name)),React.createElement("button",{onClick:()=>y(t.id),style:e.deleteButton,title:"Delete Draft"},React.createElement(R,null))))))))},e={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999},modal:{backgroundColor:"#1e1e1e",borderRadius:"8px",width:"90%",maxWidth:"700px",maxHeight:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #2c2f33"},headerLeft:{display:"flex",alignItems:"center"},title:{margin:0,fontSize:"20px",color:"#ffffff"},closeButton:{background:"none",border:"none",color:"#99aab5",cursor:"pointer",fontSize:"20px",padding:"5px"},toolbar:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 20px",borderBottom:"1px solid #2c2f33",backgroundColor:"#2c2f33"},draftCount:{fontSize:"13px",color:"#dcddde"},deleteAllButton:{padding:"6px 12px",backgroundColor:"#f04747",border:"none",borderRadius:"4px",color:"#ffffff",cursor:"pointer",fontSize:"12px",fontWeight:"500"},content:{padding:"20px",overflowY:"auto",flex:1},loading:{textAlign:"center",color:"#99aab5",padding:"40px"},empty:{textAlign:"center",color:"#99aab5",padding:"60px 20px",display:"flex",flexDirection:"column",alignItems:"center"},emptySubtext:{fontSize:"13px",marginTop:"8px",maxWidth:"300px"},draftsList:{display:"flex",flexDirection:"column",gap:"12px"},draftCard:{backgroundColor:"#2c2f33",borderRadius:"8px",padding:"16px",display:"flex",gap:"12px",alignItems:"flex-start"},draftContent:{flex:1,cursor:"pointer"},draftText:{fontSize:"14px",color:"#dcddde",lineHeight:"1.5",marginBottom:"8px",whiteSpace:"pre-wrap"},draftMeta:{fontSize:"12px",color:"#99aab5",display:"flex",alignItems:"center",marginBottom:"4px"},draftRoom:{fontSize:"12px",color:"#5865f2",fontWeight:"500"},deleteButton:{background:"none",border:"none",color:"#f04747",cursor:"pointer",fontSize:"16px",padding:"8px"}};export{D as default};
