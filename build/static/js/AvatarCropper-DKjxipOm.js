import{r as f,b as c}from"./react-core-9vc7GIjk.js";import"./editor-vendor-DiU449Dh.js";var $=Object.defineProperty,K=(d,t,e)=>t in d?$(d,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):d[t]=e,u=(d,t,e)=>K(d,typeof t!="symbol"?t+"":t,e);const N={x:0,y:0,width:0,height:0,unit:"px"},k=(d,t,e)=>Math.min(Math.max(d,t),e),I=(...d)=>d.filter(t=>t&&typeof t=="string").join(" "),P=(d,t)=>d===t||d.width===t.width&&d.height===t.height&&d.x===t.x&&d.y===t.y&&d.unit===t.unit;function S(d,t,e){return d.unit==="%"?{...N,...d,unit:"%"}:{unit:"%",x:d.x?d.x/t*100:0,y:d.y?d.y/e*100:0,width:d.width?d.width/t*100:0,height:d.height?d.height/e*100:0}}function E(d,t,e){return d.unit?d.unit==="px"?{...N,...d,unit:"px"}:{unit:"px",x:d.x?d.x*t/100:0,y:d.y?d.y*e/100:0,width:d.width?d.width*t/100:0,height:d.height?d.height*e/100:0}:{...N,...d,unit:"px"}}function X(d,t,e,a,n,r=0,h=0,p=a,s=n){const i={...d};let l=Math.min(r,a),w=Math.min(h,n),g=Math.min(p,a),o=Math.min(s,n);t&&(t>1?(l=h?h*t:l,w=l/t,g=p*t):(w=r?r/t:w,l=w*t,o=s/t)),i.y<0&&(i.height=Math.max(i.height+i.y,w),i.y=0),i.x<0&&(i.width=Math.max(i.width+i.x,l),i.x=0);const m=a-(i.x+i.width);m<0&&(i.x=Math.min(i.x,a-l),i.width+=m);const y=n-(i.y+i.height);if(y<0&&(i.y=Math.min(i.y,n-w),i.height+=y),i.width<l&&((e==="sw"||e=="nw")&&(i.x-=l-i.width),i.width=l),i.height<w&&((e==="nw"||e=="ne")&&(i.y-=w-i.height),i.height=w),i.width>g&&((e==="sw"||e=="nw")&&(i.x-=g-i.width),i.width=g),i.height>o&&((e==="nw"||e=="ne")&&(i.y-=o-i.height),i.height=o),t){const x=i.width/i.height;if(x<t){const v=Math.max(i.width/t,w);(e==="nw"||e=="ne")&&(i.y-=v-i.height),i.height=v}else if(x>t){const v=Math.max(i.height*t,l);(e==="sw"||e=="nw")&&(i.x-=v-i.width),i.width=v}}return i}function A(d,t,e,a){const n={...d};return t==="ArrowLeft"?a==="nw"?(n.x-=e,n.y-=e,n.width+=e,n.height+=e):a==="w"?(n.x-=e,n.width+=e):a==="sw"?(n.x-=e,n.width+=e,n.height+=e):a==="ne"?(n.y+=e,n.width-=e,n.height-=e):a==="e"?n.width-=e:a==="se"&&(n.width-=e,n.height-=e):t==="ArrowRight"&&(a==="nw"?(n.x+=e,n.y+=e,n.width-=e,n.height-=e):a==="w"?(n.x+=e,n.width-=e):a==="sw"?(n.x+=e,n.width-=e,n.height-=e):a==="ne"?(n.y-=e,n.width+=e,n.height+=e):a==="e"?n.width+=e:a==="se"&&(n.width+=e,n.height+=e)),t==="ArrowUp"?a==="nw"?(n.x-=e,n.y-=e,n.width+=e,n.height+=e):a==="n"?(n.y-=e,n.height+=e):a==="ne"?(n.y-=e,n.width+=e,n.height+=e):a==="sw"?(n.x+=e,n.width-=e,n.height-=e):a==="s"?n.height-=e:a==="se"&&(n.width-=e,n.height-=e):t==="ArrowDown"&&(a==="nw"?(n.x+=e,n.y+=e,n.width-=e,n.height-=e):a==="n"?(n.y+=e,n.height-=e):a==="ne"?(n.y+=e,n.width-=e,n.height-=e):a==="sw"?(n.x-=e,n.width+=e,n.height+=e):a==="s"?n.height+=e:a==="se"&&(n.width+=e,n.height+=e)),n}const H={capture:!0,passive:!1};let B=0;const M=class D extends f.PureComponent{constructor(){super(...arguments),u(this,"docMoveBound",!1),u(this,"mouseDownOnCrop",!1),u(this,"dragStarted",!1),u(this,"evData",{startClientX:0,startClientY:0,startCropX:0,startCropY:0,clientX:0,clientY:0,isResize:!0}),u(this,"componentRef",f.createRef()),u(this,"mediaRef",f.createRef()),u(this,"resizeObserver"),u(this,"initChangeCalled",!1),u(this,"instanceId",`rc-${B++}`),u(this,"state",{cropIsActive:!1,newCropIsBeingDrawn:!1}),u(this,"onCropPointerDown",t=>{const{crop:e,disabled:a}=this.props,n=this.getBox();if(!e)return;const r=E(e,n.width,n.height);if(a)return;t.cancelable&&t.preventDefault(),this.bindDocMove(),this.componentRef.current.focus({preventScroll:!0});const h=t.target.dataset.ord,p=!!h;let s=t.clientX,i=t.clientY,l=r.x,w=r.y;if(h){const g=t.clientX-n.x,o=t.clientY-n.y;let m=0,y=0;h==="ne"||h=="e"?(m=g-(r.x+r.width),y=o-r.y,l=r.x,w=r.y+r.height):h==="se"||h==="s"?(m=g-(r.x+r.width),y=o-(r.y+r.height),l=r.x,w=r.y):h==="sw"||h=="w"?(m=g-r.x,y=o-(r.y+r.height),l=r.x+r.width,w=r.y):(h==="nw"||h=="n")&&(m=g-r.x,y=o-r.y,l=r.x+r.width,w=r.y+r.height),s=l+n.x+m,i=w+n.y+y}this.evData={startClientX:s,startClientY:i,startCropX:l,startCropY:w,clientX:t.clientX,clientY:t.clientY,isResize:p,ord:h},this.mouseDownOnCrop=!0,this.setState({cropIsActive:!0})}),u(this,"onComponentPointerDown",t=>{const{crop:e,disabled:a,locked:n,keepSelection:r,onChange:h}=this.props,p=this.getBox();if(a||n||r&&e)return;t.cancelable&&t.preventDefault(),this.bindDocMove(),this.componentRef.current.focus({preventScroll:!0});const s=t.clientX-p.x,i=t.clientY-p.y,l={unit:"px",x:s,y:i,width:0,height:0};this.evData={startClientX:t.clientX,startClientY:t.clientY,startCropX:s,startCropY:i,clientX:t.clientX,clientY:t.clientY,isResize:!0},this.mouseDownOnCrop=!0,h(E(l,p.width,p.height),S(l,p.width,p.height)),this.setState({cropIsActive:!0,newCropIsBeingDrawn:!0})}),u(this,"onDocPointerMove",t=>{const{crop:e,disabled:a,onChange:n,onDragStart:r}=this.props,h=this.getBox();if(a||!e||!this.mouseDownOnCrop)return;t.cancelable&&t.preventDefault(),this.dragStarted||(this.dragStarted=!0,r&&r(t));const{evData:p}=this;p.clientX=t.clientX,p.clientY=t.clientY;let s;p.isResize?s=this.resizeCrop():s=this.dragCrop(),P(e,s)||n(E(s,h.width,h.height),S(s,h.width,h.height))}),u(this,"onComponentKeyDown",t=>{const{crop:e,disabled:a,onChange:n,onComplete:r}=this.props;if(a)return;const h=t.key;let p=!1;if(!e)return;const s=this.getBox(),i=this.makePixelCrop(s),l=(navigator.platform.match("Mac")?t.metaKey:t.ctrlKey)?D.nudgeStepLarge:t.shiftKey?D.nudgeStepMedium:D.nudgeStep;if(h==="ArrowLeft"?(i.x-=l,p=!0):h==="ArrowRight"?(i.x+=l,p=!0):h==="ArrowUp"?(i.y-=l,p=!0):h==="ArrowDown"&&(i.y+=l,p=!0),p){t.cancelable&&t.preventDefault(),i.x=k(i.x,0,s.width-i.width),i.y=k(i.y,0,s.height-i.height);const w=E(i,s.width,s.height),g=S(i,s.width,s.height);n(w,g),r&&r(w,g)}}),u(this,"onHandlerKeyDown",(t,e)=>{const{aspect:a=0,crop:n,disabled:r,minWidth:h=0,minHeight:p=0,maxWidth:s,maxHeight:i,onChange:l,onComplete:w}=this.props,g=this.getBox();if(r||!n)return;if(t.key==="ArrowUp"||t.key==="ArrowDown"||t.key==="ArrowLeft"||t.key==="ArrowRight")t.stopPropagation(),t.preventDefault();else return;const o=(navigator.platform.match("Mac")?t.metaKey:t.ctrlKey)?D.nudgeStepLarge:t.shiftKey?D.nudgeStepMedium:D.nudgeStep,m=E(n,g.width,g.height),y=A(m,t.key,o,e),x=X(y,a,e,g.width,g.height,h,p,s,i);if(!P(n,x)){const v=S(x,g.width,g.height);l(x,v),w&&w(x,v)}}),u(this,"onDocPointerDone",t=>{const{crop:e,disabled:a,onComplete:n,onDragEnd:r}=this.props,h=this.getBox();this.unbindDocMove(),!(a||!e)&&this.mouseDownOnCrop&&(this.mouseDownOnCrop=!1,this.dragStarted=!1,r&&r(t),n&&n(E(e,h.width,h.height),S(e,h.width,h.height)),this.setState({cropIsActive:!1,newCropIsBeingDrawn:!1}))}),u(this,"onDragFocus",()=>{var t;(t=this.componentRef.current)==null||t.scrollTo(0,0)})}get document(){return document}getBox(){const t=this.mediaRef.current;if(!t)return{x:0,y:0,width:0,height:0};const{x:e,y:a,width:n,height:r}=t.getBoundingClientRect();return{x:e,y:a,width:n,height:r}}componentDidUpdate(t){const{crop:e,onComplete:a}=this.props;if(a&&!t.crop&&e){const{width:n,height:r}=this.getBox();n&&r&&a(E(e,n,r),S(e,n,r))}}componentWillUnmount(){this.resizeObserver&&this.resizeObserver.disconnect(),this.unbindDocMove()}bindDocMove(){this.docMoveBound||(this.document.addEventListener("pointermove",this.onDocPointerMove,H),this.document.addEventListener("pointerup",this.onDocPointerDone,H),this.document.addEventListener("pointercancel",this.onDocPointerDone,H),this.docMoveBound=!0)}unbindDocMove(){this.docMoveBound&&(this.document.removeEventListener("pointermove",this.onDocPointerMove,H),this.document.removeEventListener("pointerup",this.onDocPointerDone,H),this.document.removeEventListener("pointercancel",this.onDocPointerDone,H),this.docMoveBound=!1)}getCropStyle(){const{crop:t}=this.props;if(t)return{top:`${t.y}${t.unit}`,left:`${t.x}${t.unit}`,width:`${t.width}${t.unit}`,height:`${t.height}${t.unit}`}}dragCrop(){const{evData:t}=this,e=this.getBox(),a=this.makePixelCrop(e),n=t.clientX-t.startClientX,r=t.clientY-t.startClientY;return a.x=k(t.startCropX+n,0,e.width-a.width),a.y=k(t.startCropY+r,0,e.height-a.height),a}getPointRegion(t,e,a,n){const{evData:r}=this,h=r.clientX-t.x,p=r.clientY-t.y;let s;n&&e?s=e==="nw"||e==="n"||e==="ne":s=p<r.startCropY;let i;return a&&e?i=e==="nw"||e==="w"||e==="sw":i=h<r.startCropX,i?s?"nw":"sw":s?"ne":"se"}resolveMinDimensions(t,e,a=0,n=0){const r=Math.min(a,t.width),h=Math.min(n,t.height);return!e||!r&&!h?[r,h]:e>1?r?[r,r/e]:[h*e,h]:h?[h*e,h]:[r,r/e]}resizeCrop(){const{evData:t}=this,{aspect:e=0,maxWidth:a,maxHeight:n}=this.props,r=this.getBox(),[h,p]=this.resolveMinDimensions(r,e,this.props.minWidth,this.props.minHeight);let s=this.makePixelCrop(r);const i=this.getPointRegion(r,t.ord,h,p),l=t.ord||i;let w=t.clientX-t.startClientX,g=t.clientY-t.startClientY;(h&&l==="nw"||l==="w"||l==="sw")&&(w=Math.min(w,-h)),(p&&l==="nw"||l==="n"||l==="ne")&&(g=Math.min(g,-p));const o={unit:"px",x:0,y:0,width:0,height:0};i==="ne"?(o.x=t.startCropX,o.width=w,e?(o.height=o.width/e,o.y=t.startCropY-o.height):(o.height=Math.abs(g),o.y=t.startCropY-o.height)):i==="se"?(o.x=t.startCropX,o.y=t.startCropY,o.width=w,e?o.height=o.width/e:o.height=g):i==="sw"?(o.x=t.startCropX+w,o.y=t.startCropY,o.width=Math.abs(w),e?o.height=o.width/e:o.height=g):i==="nw"&&(o.x=t.startCropX+w,o.width=Math.abs(w),e?(o.height=o.width/e,o.y=t.startCropY-o.height):(o.height=Math.abs(g),o.y=t.startCropY+g));const m=X(o,e,i,r.width,r.height,h,p,a,n);return e||D.xyOrds.indexOf(l)>-1?s=m:D.xOrds.indexOf(l)>-1?(s.x=m.x,s.width=m.width):D.yOrds.indexOf(l)>-1&&(s.y=m.y,s.height=m.height),s.x=k(s.x,0,r.width-s.width),s.y=k(s.y,0,r.height-s.height),s}renderCropSelection(){const{ariaLabels:t=D.defaultProps.ariaLabels,disabled:e,locked:a,renderSelectionAddon:n,ruleOfThirds:r,crop:h}=this.props,p=this.getCropStyle();if(h)return c.createElement("div",{style:p,className:"ReactCrop__crop-selection",onPointerDown:this.onCropPointerDown,"aria-label":t.cropArea,tabIndex:0,onKeyDown:this.onComponentKeyDown,role:"group"},!e&&!a&&c.createElement("div",{className:"ReactCrop__drag-elements",onFocus:this.onDragFocus},c.createElement("div",{className:"ReactCrop__drag-bar ord-n","data-ord":"n"}),c.createElement("div",{className:"ReactCrop__drag-bar ord-e","data-ord":"e"}),c.createElement("div",{className:"ReactCrop__drag-bar ord-s","data-ord":"s"}),c.createElement("div",{className:"ReactCrop__drag-bar ord-w","data-ord":"w"}),c.createElement("div",{className:"ReactCrop__drag-handle ord-nw","data-ord":"nw",tabIndex:0,"aria-label":t.nwDragHandle,onKeyDown:s=>this.onHandlerKeyDown(s,"nw"),role:"button"}),c.createElement("div",{className:"ReactCrop__drag-handle ord-n","data-ord":"n",tabIndex:0,"aria-label":t.nDragHandle,onKeyDown:s=>this.onHandlerKeyDown(s,"n"),role:"button"}),c.createElement("div",{className:"ReactCrop__drag-handle ord-ne","data-ord":"ne",tabIndex:0,"aria-label":t.neDragHandle,onKeyDown:s=>this.onHandlerKeyDown(s,"ne"),role:"button"}),c.createElement("div",{className:"ReactCrop__drag-handle ord-e","data-ord":"e",tabIndex:0,"aria-label":t.eDragHandle,onKeyDown:s=>this.onHandlerKeyDown(s,"e"),role:"button"}),c.createElement("div",{className:"ReactCrop__drag-handle ord-se","data-ord":"se",tabIndex:0,"aria-label":t.seDragHandle,onKeyDown:s=>this.onHandlerKeyDown(s,"se"),role:"button"}),c.createElement("div",{className:"ReactCrop__drag-handle ord-s","data-ord":"s",tabIndex:0,"aria-label":t.sDragHandle,onKeyDown:s=>this.onHandlerKeyDown(s,"s"),role:"button"}),c.createElement("div",{className:"ReactCrop__drag-handle ord-sw","data-ord":"sw",tabIndex:0,"aria-label":t.swDragHandle,onKeyDown:s=>this.onHandlerKeyDown(s,"sw"),role:"button"}),c.createElement("div",{className:"ReactCrop__drag-handle ord-w","data-ord":"w",tabIndex:0,"aria-label":t.wDragHandle,onKeyDown:s=>this.onHandlerKeyDown(s,"w"),role:"button"})),n&&c.createElement("div",{className:"ReactCrop__selection-addon",onPointerDown:s=>s.stopPropagation()},n(this.state)),r&&c.createElement(c.Fragment,null,c.createElement("div",{className:"ReactCrop__rule-of-thirds-hz"}),c.createElement("div",{className:"ReactCrop__rule-of-thirds-vt"})))}makePixelCrop(t){const e={...N,...this.props.crop||{}};return E(e,t.width,t.height)}render(){const{aspect:t,children:e,circularCrop:a,className:n,crop:r,disabled:h,locked:p,style:s,ruleOfThirds:i}=this.props,{cropIsActive:l,newCropIsBeingDrawn:w}=this.state,g=r?this.renderCropSelection():null,o=I("ReactCrop",n,l&&"ReactCrop--active",h&&"ReactCrop--disabled",p&&"ReactCrop--locked",w&&"ReactCrop--new-crop",r&&t&&"ReactCrop--fixed-aspect",r&&a&&"ReactCrop--circular-crop",r&&i&&"ReactCrop--rule-of-thirds",!this.dragStarted&&r&&!r.width&&!r.height&&"ReactCrop--invisible-crop",a&&"ReactCrop--no-animate");return c.createElement("div",{ref:this.componentRef,className:o,style:s},c.createElement("div",{ref:this.mediaRef,className:"ReactCrop__child-wrapper",onPointerDown:this.onComponentPointerDown},e),r?c.createElement("svg",{className:"ReactCrop__crop-mask",width:"100%",height:"100%"},c.createElement("defs",null,c.createElement("mask",{id:`hole-${this.instanceId}`},c.createElement("rect",{width:"100%",height:"100%",fill:"white"}),a?c.createElement("ellipse",{cx:`${r.x+r.width/2}${r.unit}`,cy:`${r.y+r.height/2}${r.unit}`,rx:`${r.width/2}${r.unit}`,ry:`${r.height/2}${r.unit}`,fill:"black"}):c.createElement("rect",{x:`${r.x}${r.unit}`,y:`${r.y}${r.unit}`,width:`${r.width}${r.unit}`,height:`${r.height}${r.unit}`,fill:"black"}))),c.createElement("rect",{fill:"black",fillOpacity:.5,width:"100%",height:"100%",mask:`url(#hole-${this.instanceId})`})):void 0,g)}};u(M,"xOrds",["e","w"]),u(M,"yOrds",["n","s"]),u(M,"xyOrds",["nw","ne","se","sw"]),u(M,"nudgeStep",1),u(M,"nudgeStepMedium",10),u(M,"nudgeStepLarge",100),u(M,"defaultProps",{ariaLabels:{cropArea:"Use the arrow keys to move the crop selection area",nwDragHandle:"Use the arrow keys to move the north west drag handle to change the crop selection area",nDragHandle:"Use the up and down arrow keys to move the north drag handle to change the crop selection area",neDragHandle:"Use the arrow keys to move the north east drag handle to change the crop selection area",eDragHandle:"Use the up and down arrow keys to move the east drag handle to change the crop selection area",seDragHandle:"Use the arrow keys to move the south east drag handle to change the crop selection area",sDragHandle:"Use the up and down arrow keys to move the south drag handle to change the crop selection area",swDragHandle:"Use the arrow keys to move the south west drag handle to change the crop selection area",wDragHandle:"Use the up and down arrow keys to move the west drag handle to change the crop selection area"}});let O=M;const U=({onCropComplete:d,onCancel:t,imageFile:e})=>{const[a,n]=f.useState(null),[r,h]=f.useState({unit:"%",width:50,aspect:1}),[p,s]=f.useState(null),i=f.useRef(null),l=f.useRef(null);f.useEffect(()=>{if(e){const o=new FileReader;o.addEventListener("load",()=>{n(o.result)}),o.readAsDataURL(e)}},[e]);const w=f.useCallback(o=>{i.current=o;const m=o.width,y=o.height,x=Math.min(m,y),v=(m-x)/2,b=(y-x)/2,C={unit:"px",width:x,height:x,x:v,y:b,aspect:1};h(C),s(C)},[]);f.useEffect(()=>{if(!p||!i.current||!l.current)return;const o=i.current,m=l.current,y=p,x=o.naturalWidth/o.width,v=o.naturalHeight/o.height,b=m.getContext("2d"),C=window.devicePixelRatio||1,R=180;m.width=R*C,m.height=R*C,b.setTransform(C,0,0,C,0,0),b.imageSmoothingQuality="high",b.drawImage(o,y.x*x,y.y*v,y.width*x,y.height*v,0,0,R,R)},[p]);const g=f.useCallback(async()=>{if(!p||!i.current||!l.current)return;const o=i.current,m=l.current,y=p,x=o.naturalWidth/o.width,v=o.naturalHeight/o.height,b=m.getContext("2d"),C=window.devicePixelRatio,R=512;return m.width=R*C,m.height=R*C,b.setTransform(C,0,0,C,0,0),b.imageSmoothingQuality="high",b.drawImage(o,y.x*x,y.y*v,y.width*x,y.height*v,0,0,R,R),new Promise(_=>{m.toBlob(Y=>{if(!Y){console.error("Canvas is empty");return}Y.name="avatar.png",d(Y),_()},"image/png",1)})},[p,d]);return c.createElement("div",{className:"avatar-cropper-modal",onClick:t},c.createElement("div",{className:"avatar-cropper-content",onClick:o=>o.stopPropagation()},c.createElement("div",{className:"avatar-cropper-header"},c.createElement("h2",null,"üì∏ Profil Fotoƒürafƒ±nƒ± D√ºzenle"),c.createElement("button",{className:"close-btn",onClick:t},"√ó")),c.createElement("div",{className:"avatar-cropper-body"},!a&&c.createElement("div",{style:{padding:"40px",textAlign:"center",color:"#dcddde"}},c.createElement("div",{style:{fontSize:"48px",marginBottom:"16px"}},"‚è≥"),c.createElement("p",null,"Fotoƒüraf y√ºkleniyor..."),!e&&c.createElement("p",{style:{color:"#f04747",marginTop:"8px"}},"‚ö†Ô∏è Dosya bulunamadƒ±!")),a&&c.createElement(c.Fragment,null,c.createElement("div",{className:"crop-container"},c.createElement(O,{crop:r,onChange:o=>h(o),onComplete:o=>s(o),aspect:1,circularCrop:!1,keepSelection:!0,minWidth:100,minHeight:100},c.createElement("img",{ref:i,src:a,alt:"Crop",onLoad:o=>w(o.currentTarget),style:{maxWidth:"100%",maxHeight:"55vh",display:"block",objectFit:"contain"}}))),c.createElement("div",{className:"preview-section"},c.createElement("h3",null,"√ñnizleme:"),c.createElement("div",{className:"preview-container"},c.createElement("canvas",{ref:l,style:{width:180,height:180,borderRadius:"50%",objectFit:"cover"}})),c.createElement("p",{className:"preview-note"},"‚ÑπÔ∏è Tam kare (1:1)")))),a&&c.createElement("div",{className:"avatar-cropper-footer"},c.createElement("button",{className:"btn-secondary",onClick:t},"ƒ∞ptal"),c.createElement("button",{className:"btn-primary",onClick:g},"‚úì Kaydet"))))};export{U as default};
