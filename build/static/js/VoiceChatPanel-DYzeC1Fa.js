import{n as e,a as Q,r}from"./react-core-DA61mcWm.js";import{o as tt,a as nt,P as We,p as at,t as J}from"./index-wBOWb2zj.js";import it from"./UserContextMenu-B1GhK0GZ.js";import rt from"./VoiceSettingsPanel-CsQKaopb.js";import{S as ot}from"./crypto-vendor-DiGIAuUm.js";import{D as st}from"./cjs-B3hvhaeZ.js";import"./ui-vendor-BrUQ4r0A.js";import"./editor-vendor-D9c4a6XZ.js";import"./media-vendor-tDmQW26m.js";import"./router-vendor-2etVlp2q.js";import"./icons-vendor-l2qVv93x.js";import"./state-vendor-CjqIs3K2.js";const he=({icon:t,onClick:a,title:g,bgColor:p="rgba(0, 0, 0, 0.7)"})=>e.jsx("button",{onClick:a,title:g,style:{background:p,border:"1px solid rgba(255, 255, 255, 0.3)",borderRadius:"8px",width:"36px",height:"36px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",fontSize:"14px",color:"#fff",fontWeight:"bold",transition:"all 0.2s ease",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.3)"},onMouseEnter:h=>{h.currentTarget.style.transform="scale(1.1)",h.currentTarget.style.boxShadow="0 4px 16px rgba(255, 255, 255, 0.3)"},onMouseLeave:h=>{h.currentTarget.style.transform="scale(1)",h.currentTarget.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.3)"},children:t}),be=Q.memo(({user:t,stream:a,isActive:g,isPinned:p,onExpand:h,onPin:y,onContextMenu:s,compact:M=!1,badge:j,connectionQuality:C,getUserAvatar:_})=>{const S=r.useRef(null),b=r.useRef(null),[L,W]=r.useState(!1);r.useEffect(()=>{S.current&&a&&(S.current.srcObject=a)},[a]),r.useEffect(()=>{if(b.current&&a&&!t.isLocal){const l=a.getAudioTracks();if(l.length>0){b.current.srcObject=new MediaStream(l);const R=t.volume||100;if(R<=100)b.current.volume=Math.max(0,R/100);else{b.current.volume=1;try{const k=b.current;k._audioContext||(k._audioContext=new(window.AudioContext||window.webkitAudioContext),k._sourceNode=k._audioContext.createMediaElementSource(k),k._gainNode=k._audioContext.createGain(),k._sourceNode.connect(k._gainNode),k._gainNode.connect(k._audioContext.destination)),k._gainNode.gain.value=R/100}catch{}}}}},[a,t.isLocal,t.username,t.volume]);const o=r.useCallback(l=>{l.preventDefault(),s&&t.username!==t.isLocal&&s({user:t,position:{x:l.clientX,y:l.clientY}})},[s,t]),v=r.useCallback(l=>{!t.isLocal&&s&&s({user:t,position:{x:l.clientX,y:l.clientY}})},[t,s]);return e.jsxs("div",{onContextMenu:o,onClick:v,onMouseEnter:()=>W(!0),onMouseLeave:()=>W(!1),style:{background:"linear-gradient(135deg, #2c2f33 0%, #23272a 100%)",borderRadius:"16px",overflow:"hidden",position:"relative",border:g?"3px solid #43b581":p?"3px solid #5865f2":"1px solid rgba(255, 255, 255, 0.1)",boxShadow:g?"0 0 20px rgba(67, 181, 129, 0.5)":"0 4px 16px rgba(0, 0, 0, 0.3)",transition:"all 0.3s ease",cursor:t.isLocal?"default":"pointer",width:"100%",height:"100%",display:"flex",flexDirection:"column"},children:[!t.isLocal&&a&&e.jsx("audio",{ref:b,autoPlay:!0,playsInline:!0,"data-username":t.username,style:{display:"none"}}),e.jsxs("div",{style:{width:"100%",height:"100%",background:"#1a1a1a",display:"flex",alignItems:"center",justifyContent:"center"},children:[j,a&&a.active&&a.getVideoTracks().length>0?e.jsx("video",{ref:S,autoPlay:!0,playsInline:!0,muted:t.isLocal===!0,style:{width:"100%",height:"100%",objectFit:t.streamType==="screen"?"contain":"cover",backgroundColor:t.streamType==="screen"?"#000":"#1a1a1a"}}):e.jsxs("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"16px",background:"linear-gradient(135deg, #36393f 0%, #2f3136 50%, #202225 100%)",position:"relative"},children:[e.jsx("div",{style:{position:"relative",padding:"8px",borderRadius:"50%",background:t.isTalking?"linear-gradient(135deg, #43b581, #3ca374)":"transparent",boxShadow:t.isTalking?"0 0 20px rgba(67, 181, 129, 0.6), 0 0 40px rgba(67, 181, 129, 0.3)":"none",transition:"all 0.3s ease",animation:t.isTalking?"talkingPulse 1s ease-in-out infinite":"none"},children:e.jsx("img",{src:_(t.username),alt:t.username,onError:l=>{l.target.onerror=null,l.target.src=getDeterministicAvatarFallback(t.username,256)},style:{width:"140px",height:"140px",borderRadius:"50%",objectFit:"cover",border:"5px solid #40444b",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.5)",display:"block"},loading:"lazy"})}),e.jsx("div",{style:{color:"#fff",fontSize:"18px",fontWeight:700,textShadow:"0 2px 8px rgba(0, 0, 0, 0.7)",letterSpacing:"0.5px"},children:t.username}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"6px 14px",background:t.isMuted?"rgba(240, 71, 71, 0.2)":"rgba(67, 181, 129, 0.2)",borderRadius:"16px",border:t.isMuted?"1px solid rgba(240, 71, 71, 0.4)":"1px solid rgba(67, 181, 129, 0.4)"},children:[e.jsx("span",{style:{fontSize:"16px"},children:t.isMuted?"ðŸ”‡":"ðŸŽ¤"}),e.jsx("span",{style:{color:t.isMuted?"#f04747":"#43b581",fontSize:"13px",fontWeight:600},children:t.isMuted?"Sessiz":t.isTalking?"KonuÅŸuyor...":"Dinliyor"})]})]})]}),e.jsxs("div",{style:{position:"absolute",bottom:0,left:0,right:0,background:"linear-gradient(to top, rgba(0, 0, 0, 0.8), transparent)",padding:"12px 16px",display:"flex",alignItems:"center",gap:"8px",zIndex:10},children:[t.isTalking&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"3px"},children:[e.jsx("div",{style:{width:"3px",height:"12px",background:"#43b581",borderRadius:"2px",animation:"wave1 0.6s ease-in-out infinite"}}),e.jsx("div",{style:{width:"3px",height:"16px",background:"#43b581",borderRadius:"2px",animation:"wave2 0.6s ease-in-out infinite 0.1s"}}),e.jsx("div",{style:{width:"3px",height:"12px",background:"#43b581",borderRadius:"2px",animation:"wave3 0.6s ease-in-out infinite 0.2s"}})]}),!t.isLocal&&C&&e.jsx("div",{title:`RTT: ${C.rtt}ms, Packet Loss: ${C.packetLoss}%`,style:{fontSize:"16px",filter:C.quality==="excellent"?"none":C.quality==="good"?"hue-rotate(30deg)":"hue-rotate(90deg) saturate(2)",opacity:.9},children:C.quality==="excellent"||C.quality==="good"?"ðŸ“¶":"âš ï¸"}),e.jsxs("span",{onClick:l=>{l.stopPropagation(),t.isLocal||(window.openUserProfile?window.openUserProfile(t.username):window.location.hash=`#/profile/${t.username}`)},style:{color:"#fff",fontSize:"14px",fontWeight:600,flex:1,cursor:t.isLocal?"default":"pointer",textDecoration:t.isLocal?"none":"underline",textDecorationColor:"rgba(255, 255, 255, 0.3)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[t.username," ",t.streamType==="screen"&&"ðŸ–¥ï¸ Ekran"]}),e.jsxs("div",{style:{display:"flex",gap:"6px"},children:[t.isMuted&&e.jsx("span",{style:{fontSize:"16px"},children:"ðŸ”‡"}),t.streamType==="camera"&&t.isCameraOn&&e.jsx("span",{style:{fontSize:"16px"},children:"ðŸ“¹"}),g&&e.jsx("span",{style:{fontSize:"16px"},children:"ðŸ”Š"})]})]}),e.jsxs("div",{style:{position:"absolute",top:"12px",right:"12px",display:"flex",gap:"6px",opacity:L?1:0,transition:"opacity 0.25s ease, transform 0.25s ease",transform:L?"translateY(0)":"translateY(-6px)",zIndex:20,pointerEvents:L?"auto":"none"},children:[e.jsx(he,{icon:p?"ðŸ“Œ":"ðŸ“",onClick:l=>{l.stopPropagation(),y()},title:p?"Sabitlemeyi KaldÄ±r":"Sabitle",bgColor:"rgba(88, 101, 242, 0.9)"}),e.jsx(he,{icon:"â›¶",onClick:l=>{l.stopPropagation(),h()},title:"Panelde GeniÅŸlet",bgColor:"rgba(67, 181, 129, 0.9)"}),e.jsx(he,{icon:"ðŸ–¥ï¸",onClick:l=>{l.stopPropagation();const R=S.current;if(R){const I=R.parentElement?.parentElement||R;I.requestFullscreen?I.requestFullscreen():I.webkitRequestFullscreen?I.webkitRequestFullscreen():I.mozRequestFullScreen?I.mozRequestFullScreen():I.msRequestFullscreen&&I.msRequestFullscreen()}},title:"Tam Ekran Ä°zle",bgColor:"rgba(250, 166, 26, 0.9)"}),!t.isLocal&&L&&e.jsxs("div",{style:{background:"rgba(0, 0, 0, 0.9)",borderRadius:"10px",padding:"6px 10px",display:"flex",alignItems:"center",gap:"6px",minWidth:"100px",backdropFilter:"blur(8px)",border:"1px solid rgba(255, 255, 255, 0.1)",animation:"fadeIn 0.2s ease"},children:[e.jsx("span",{style:{fontSize:"12px"},children:(t.volume||100)===0?"ðŸ”‡":(t.volume||100)>100?"ðŸ”Š":"ðŸ”‰"}),e.jsx("input",{type:"range",min:"0",max:"200",value:t.volume||100,onChange:l=>{l.stopPropagation(),t.onVolumeChange&&t.onVolumeChange(parseInt(l.target.value))},style:{flex:1,cursor:"pointer",height:"4px"},onClick:l=>l.stopPropagation()}),e.jsxs("span",{style:{fontSize:"10px",color:"#fff",minWidth:"30px",fontWeight:600},children:[t.volume||100,"%"]})]})]}),e.jsx("style",{children:`
                div:hover .hover-actions {
                    opacity: 1;
                }
            `})]})},(t,a)=>t.user.username===a.user.username&&t.stream===a.stream&&t.user.isCameraOn===a.user.isCameraOn&&t.user.isScreenSharing===a.user.isScreenSharing&&t.user.isMuted===a.user.isMuted&&t.isActive===a.isActive&&t.isPinned===a.isPinned&&t.compact===a.compact),O=({icon:t,active:a,danger:g,special:p,subtle:h,small:y,isLeave:s,onClick:M,title:j,label:C})=>{const _=()=>s?"linear-gradient(135deg, #ed4245 0%, #c03537 100%)":g&&a?"rgba(240, 71, 71, 0.4)":g?"rgba(240, 71, 71, 0.15)":p?"linear-gradient(135deg, #5865f2 0%, #4752c4 100%)":a?"rgba(67, 181, 129, 0.25)":h?"rgba(255, 255, 255, 0.05)":"rgba(255, 255, 255, 0.1)",S=()=>s?"none":g&&a?"2px solid rgba(240, 71, 71, 0.6)":a?"2px solid rgba(67, 181, 129, 0.5)":p?"2px solid rgba(88, 101, 242, 0.5)":"2px solid transparent";return e.jsxs("button",{onClick:M,title:j,style:{background:_(),border:S(),borderRadius:s?"50%":"12px",width:s?"48px":y?"40px":"48px",height:s?"48px":y?"40px":"48px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",cursor:"pointer",fontSize:y?"16px":"20px",color:"#fff",transition:"all 0.2s ease",boxShadow:s?"0 4px 15px rgba(237, 66, 69, 0.4)":a?"0 2px 10px rgba(67, 181, 129, 0.3)":"none",transform:"scale(1)"},onMouseEnter:b=>{b.currentTarget.style.transform="scale(1.1)",b.currentTarget.style.boxShadow=s?"0 6px 20px rgba(237, 66, 69, 0.6)":"0 4px 15px rgba(255, 255, 255, 0.2)"},onMouseLeave:b=>{b.currentTarget.style.transform="scale(1)",b.currentTarget.style.boxShadow=s?"0 4px 15px rgba(237, 66, 69, 0.4)":a?"0 2px 10px rgba(67, 181, 129, 0.3)":"none"},children:[e.jsx("span",{children:t}),C&&e.jsx("span",{style:{fontSize:"9px",marginTop:"2px",fontWeight:600},children:C})]})},lt=({isMuted:t,isDeafened:a,isCameraOn:g,isScreenSharing:p,isSpatialAudio:h,isRecording:y,recordingDuration:s,onToggleMute:M,onToggleDeafened:j,onToggleCamera:C,onToggleScreenShare:_,onToggleSpatialAudio:S,onStartRecording:b,onStopRecording:L,onDownloadRecording:W,onLeave:o,onSettings:v})=>{const l=R=>{const k=Math.floor(R/60).toString().padStart(2,"0"),I=Math.floor(R%60).toString().padStart(2,"0");return`${k}:${I}`};return e.jsxs("div",{style:{background:"linear-gradient(180deg, rgba(32, 34, 37, 0.98) 0%, rgba(24, 25, 28, 1) 100%)",padding:"12px 20px",display:"flex",justifyContent:"center",alignItems:"center",gap:"10px",borderTop:"1px solid rgba(255, 255, 255, 0.08)",boxShadow:"0 -4px 20px rgba(0, 0, 0, 0.4)",flexShrink:0,minHeight:"70px",position:"relative",zIndex:100},children:[e.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[e.jsx(O,{icon:t?"ðŸ”‡":"ðŸŽ¤",active:!t,danger:t,onClick:M,title:t?"Mikrofonu AÃ§":"Mikrofonu Kapat"}),e.jsx(O,{icon:a?"ðŸ”ˆ":"ðŸŽ§",active:!a,danger:a,onClick:j,title:a?"KulaklÄ±ÄŸÄ± AÃ§":"KulaklÄ±ÄŸÄ± Kapat"})]}),e.jsxs("div",{style:{display:"flex",gap:"8px",padding:"0 16px",borderLeft:"1px solid rgba(255, 255, 255, 0.1)",borderRight:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx(O,{icon:g?"ðŸ“¹":"ðŸ“·",active:g,onClick:C,title:g?"KamerayÄ± Kapat":"KamerayÄ± AÃ§"}),e.jsx(O,{icon:"ðŸ–¥ï¸",active:p,special:p,onClick:_,title:p?"PaylaÅŸÄ±mÄ± Durdur":"Ekran PaylaÅŸ"}),S&&e.jsx(O,{icon:"ðŸ”Š",active:h,onClick:S,title:h?"3D Ses (AÃ§Ä±k)":"3D Ses (KapalÄ±)",small:!0})]}),e.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[b&&L&&e.jsx(O,{icon:y?"â¹ï¸":"âºï¸",active:y,danger:y,onClick:y?L:b,title:y?`KaydÄ± Durdur (${l(s)})`:"KayÄ±t BaÅŸlat",label:y?l(s):null}),v&&e.jsx(O,{icon:"âš™ï¸",onClick:v,title:"Ayarlar",subtle:!0})]}),e.jsx(O,{icon:"ðŸ“ž",danger:!0,onClick:o,title:"AyrÄ±l",isLeave:!0})]})},ct=({stream:t,fullscreen:a})=>{const g=r.useRef(null);return r.useEffect(()=>{g.current&&t&&(g.current.srcObject=t)},[t]),e.jsx("video",{ref:g,autoPlay:!0,playsInline:!0,muted:!1,style:{width:"100%",height:"100%",objectFit:a?"contain":"cover",background:"#000"}})},de=({icon:t,active:a,danger:g,onClick:p,title:h})=>e.jsx("button",{onClick:p,title:h,style:{background:a?"rgba(88, 101, 242, 0.8)":g?"rgba(237, 66, 69, 0.8)":"rgba(255, 255, 255, 0.15)",border:"none",borderRadius:"8px",width:"36px",height:"36px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",fontSize:"16px",transition:"all 0.2s ease"},children:t}),dt=(t,a=256)=>t?`https://ui-avatars.com/api/?name=${encodeURIComponent(t)}&background=5865f2&color=fff&bold=true&size=${a}`:`https://ui-avatars.com/api/?name=User&background=5865f2&color=fff&bold=true&size=${a}`,Pe=Q.memo(({roomName:t,userCount:a,combinedUsers:g,currentUser:p,onToggleMinimize:h,onContextMenu:y,getUserAvatar:s,isMuted:M,isCameraOn:j,isScreenSharing:C,toggleMute:_,toggleCamera:S,toggleScreenShare:b,leaveVoice:L})=>{const W=r.useRef(null);return e.jsx(st,{nodeRef:W,handle:".mini-drag-handle",defaultPosition:{x:20,y:window.innerHeight-180},bounds:"parent",children:e.jsxs("div",{ref:W,style:{position:"fixed",zIndex:9999,background:"linear-gradient(135deg, #1e2124 0%, #2c2f33 50%, #23272a 100%)",borderRadius:"16px",padding:"16px",boxShadow:"0 12px 48px rgba(0, 0, 0, 0.7), 0 0 0 1px rgba(88, 101, 242, 0.15)",border:"1px solid rgba(88, 101, 242, 0.1)",minWidth:"320px",maxWidth:"400px",backdropFilter:"blur(12px)",animation:"slideIn 0.3s ease"},children:[e.jsxs("div",{className:"mini-drag-handle",style:{display:"flex",alignItems:"center",gap:"12px",cursor:"move",marginBottom:"12px",paddingBottom:"12px",borderBottom:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx("div",{style:{width:"10px",height:"10px",borderRadius:"50%",background:"#43b581",boxShadow:"0 0 12px #43b581",animation:"pulse 2s infinite"}}),e.jsxs("span",{style:{color:"#fff",fontSize:"14px",fontWeight:600,flex:1},children:["ðŸŽ¤ ",t]}),e.jsxs("div",{style:{background:"rgba(67, 181, 129, 0.2)",borderRadius:"12px",padding:"4px 10px",fontSize:"11px",color:"#43b581",fontWeight:600},children:["ðŸ‘¥ ",a]}),e.jsx("button",{onClick:h,style:{background:"rgba(255, 255, 255, 0.1)",border:"none",borderRadius:"8px",padding:"6px 10px",color:"#fff",cursor:"pointer",fontSize:"12px",transition:"all 0.2s"},onMouseEnter:o=>o.target.style.background="rgba(255, 255, 255, 0.2)",onMouseLeave:o=>o.target.style.background="rgba(255, 255, 255, 0.1)",children:"â¬†ï¸ AÃ§"})]}),e.jsxs("div",{style:{marginBottom:"12px",maxHeight:"120px",overflowY:"auto",display:"flex",flexDirection:"column",gap:"6px"},children:[g.slice(0,3).map(o=>e.jsxs("div",{onContextMenu:v=>{v.preventDefault(),o.username!==p?.username&&y({user:o,position:{x:v.clientX,y:v.clientY}})},onClick:v=>{o.username!==p?.username&&y({user:o,position:{x:v.clientX,y:v.clientY}})},style:{display:"flex",alignItems:"center",gap:"10px",padding:"8px",background:o.isTalking?"rgba(67, 181, 129, 0.15)":"rgba(255, 255, 255, 0.05)",borderRadius:"8px",border:o.isTalking?"1px solid rgba(67, 181, 129, 0.4)":"1px solid transparent",transition:"all 0.2s",cursor:o.username!==p?.username?"pointer":"default"},onMouseEnter:v=>{o.username!==p?.username&&(v.currentTarget.style.background="rgba(67, 181, 129, 0.2)")},onMouseLeave:v=>{v.currentTarget.style.background=o.isTalking?"rgba(67, 181, 129, 0.15)":"rgba(255, 255, 255, 0.05)"},children:[e.jsx("img",{src:s(o.username),alt:o.username,onError:v=>{v.target.onerror=null,v.target.src=dt(o.username,64)},style:{width:"32px",height:"32px",borderRadius:"50%",objectFit:"cover",border:o.isTalking?"2px solid #43b581":"2px solid rgba(255, 255, 255, 0.15)",boxShadow:o.isTalking?"0 0 10px rgba(67, 181, 129, 0.5)":"none",transition:"all 0.3s ease"}}),e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{color:"#fff",fontSize:"13px",fontWeight:600},children:[o.username," ",o.isLocal&&"(Siz)"]}),e.jsx("div",{style:{color:"rgba(255, 255, 255, 0.5)",fontSize:"11px"},children:o.isMuted?"ðŸ”‡ Sessiz":o.isTalking?"ðŸ”Š KonuÅŸuyor":"ðŸŽ¤ Aktif"})]}),o.isCameraOn&&e.jsx("span",{style:{fontSize:"14px"},children:"ðŸ“¹"}),o.isScreenSharing&&e.jsx("span",{style:{fontSize:"14px"},children:"ðŸ–¥ï¸"})]},o.username)),a>3&&e.jsxs("div",{style:{textAlign:"center",color:"rgba(255, 255, 255, 0.5)",fontSize:"11px",padding:"6px"},children:["+",a-3," daha..."]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"8px"},children:[e.jsx(de,{icon:M?"ðŸ”‡":"ðŸŽ¤",active:!M,onClick:_,title:M?"Mikrofonu AÃ§":"Mikrofonu Kapat"}),e.jsx(de,{icon:j?"ðŸ“¹":"ðŸ“·",active:j,onClick:S,title:j?"KamerayÄ± Kapat":"KamerayÄ± AÃ§"}),e.jsx(de,{icon:"ðŸ–¥ï¸",active:C,onClick:b,title:C?"PaylaÅŸÄ±mÄ± Durdur":"Ekran PaylaÅŸ"}),e.jsx(de,{icon:"âŒ",danger:!0,onClick:L,title:"AyrÄ±l"})]})]})})});Pe.displayName="MinimizedView";function pt({isInVoice:t,localAudioStream:a,isMuted:g,startStatsMonitoring:p,stopStatsMonitoring:h,screenShareQuality:y,updateScreenQuality:s}){const[M,j]=r.useState({}),[C,_]=r.useState(!1),[S,b]=r.useState("good"),[L,W]=r.useState("unknown"),[o,v]=r.useState(!0),[l,R]=r.useState(!0),[k,I]=r.useState({}),[Z,ie]=r.useState({}),[re,oe]=r.useState({}),[ye,ee]=r.useState(null);return r.useEffect(()=>{if(!t)return;const T=async()=>{const A=window.__pawscord_peer_connections__||{};for(const[w,f]of Object.entries(A))if(f&&f.getStats)try{(await f.getStats()).forEach(x=>{x.type==="candidate-pair"&&x.state==="succeeded"&&j(K=>({...K,[w]:{rtt:Math.round((x.currentRoundTripTime||0)*1e3),packetLoss:x.packetsLost&&x.packetsSent?Math.round(x.packetsLost/x.packetsSent*100*10)/10:0,quality:(x.currentRoundTripTime||0)<.1?"excellent":(x.currentRoundTripTime||0)<.2?"good":"poor"}}))})}catch{}},E=setInterval(T,3e3);return T(),()=>clearInterval(E)},[t]),r.useEffect(()=>(t&&p&&p(),()=>{h&&h()}),[t,p,h]),r.useEffect(()=>{if(!a||g||!t){_(!1);return}try{const T=window.AudioContext||window.webkitAudioContext,E=new T,A=E.createAnalyser();A.fftSize=2048,A.smoothingTimeConstant=.8;const w=E.createMediaStreamSource(a);w.connect(A);const f=new Uint8Array(A.frequencyBinCount);let z=0;const K=setInterval(()=>{A.getByteFrequencyData(f);const Y=f.slice(80,160),q=Math.max(...Y),G=Y.reduce((H,te)=>H+te,0)/Y.length,V=f.slice(10,40),se=V.reduce((H,te)=>H+te,0)/V.length;q>180&&G>100&&G>se*1.5?(z++,z>3&&_(!0)):(z=0,q<120&&_(!1))},1e3);return()=>{clearInterval(K),w.disconnect(),E.close()}}catch{}},[a,g,t]),r.useEffect(()=>{if(!t)return;const T=navigator.connection||navigator.mozConnection||navigator.webkitConnection,E=()=>{if(!T){b("good"),W("unknown");return}const w=T.effectiveType||"unknown";W(w);const f=T.downlink||10,z=T.rtt||50;let x="good";w==="4g"&&f>=5&&z<100?x="excellent":w==="slow-2g"||f<1||z>300?x="poor":w==="2g"||w==="3g"||f<3||z>150?x="good":x="excellent",b(x),o&&s&&(x==="poor"&&y!=="720p"?s("720p"):x==="excellent"&&y==="720p"&&s("1080p"))};E(),T&&T.addEventListener("change",E);const A=setInterval(E,1e4);return()=>{clearInterval(A),T&&T.removeEventListener("change",E)}},[t,o,y,s]),r.useEffect(()=>{if(!l||!t)return;const E=setInterval(()=>{const A=document.querySelectorAll("audio[data-username]"),w={},f={...Z};A.forEach(z=>{const x=z.getAttribute("data-username");if(x)try{const K=new(window.AudioContext||window.webkitAudioContext),Y=K.createMediaElementSource(z),q=K.createAnalyser();q.fftSize=256,Y.connect(q),q.connect(K.destination);const G=new Uint8Array(q.frequencyBinCount);q.getByteFrequencyData(G);const V=G.reduce((se,H)=>se+H,0)/G.length;w[x]=V,V>0&&(V<50?f[x]=Math.min(1.5,(f[x]||1)*1.05):V>120&&(f[x]=Math.max(.7,(f[x]||1)*.95))),K.close()}catch{}}),I(w),ie(f)},2e3);return()=>clearInterval(E)},[l,t,Z]),r.useEffect(()=>{if(!t)return;const E=setInterval(()=>{const A={};let w=null,f=0;Object.entries(k).forEach(([z,x])=>{x>30?(A[z]=!0,x>f&&(f=x,w=z)):A[z]=!1}),oe(A),w&&f>50?ee(w):f===0&&ee(null)},100);return()=>clearInterval(E)},[t,k]),{connectionQuality:M,setConnectionQuality:j,hasEchoRisk:C,setHasEchoRisk:_,networkQuality:S,setNetworkQuality:b,networkType:L,setNetworkType:W,autoQualityEnabled:o,setAutoQualityEnabled:v,volumeNormalization:l,setVolumeNormalization:R,userAudioLevels:k,setUserAudioLevels:I,normalizedGains:Z,setNormalizedGains:ie,talkingIndicators:re,setTalkingIndicators:oe,activeSpeaker:ye,setActiveSpeaker:ee}}function xt(){if(typeof document>"u"||document.head.querySelector("style#voice-fullscreen-styles"))return;const t=document.createElement("style");t.id="voice-fullscreen-styles",t.textContent=`
            /* Tam Ekran Video Stilleri */
            div:fullscreen video,
            div:-webkit-full-screen video,
            div:-moz-full-screen video,
            div:-ms-fullscreen video {
                width: 100% !important;
                height: 100% !important;
                object-fit: contain !important;
                background: #000 !important;
            }

            /* Tam Ekran Container */
            div:fullscreen,
            div:-webkit-full-screen,
            div:-moz-full-screen,
            div:-ms-fullscreen {
                background: #000 !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
            }

            /* Tam Ekran Kontrolleri */
            div:fullscreen .hover-actions,
            div:-webkit-full-screen .hover-actions,
            div:-moz-full-screen .hover-actions,
            div:-ms-fullscreen .hover-actions {
                opacity: 1 !important;
                z-index: 9999 !important;
            }

            /* ðŸ”¥ YENÄ°: Badge AnimasyonlarÄ± */
            @keyframes badgePulse {
                0%, 100% {
                    transform: scale(1);
                    box-shadow: 0 4px 16px rgba(88, 101, 242, 0.6), 0 0 0 2px rgba(255, 255, 255, 0.2);
                }
                50% {
                    transform: scale(1.05);
                    box-shadow: 0 6px 20px rgba(88, 101, 242, 0.9), 0 0 0 3px rgba(255, 255, 255, 0.4);
                }
            }

            @keyframes pulse {
                0%, 100% {
                    opacity: 1;
                    transform: scale(1);
                }
                50% {
                    opacity: 0.7;
                    transform: scale(1.2);
                }
            }

            /* ðŸ”¥ YENÄ°: Talking Indicator Wave Animations */
            @keyframes wave1 {
                0%, 100% { height: 12px; }
                50% { height: 20px; }
            }
            @keyframes wave2 {
                0%, 100% { height: 16px; }
                50% { height: 24px; }
            }
            @keyframes wave3 {
                0%, 100% { height: 12px; }
                50% { height: 20px; }
            }

            /* ðŸ”¥ YENÄ°: Avatar Talking Pulse Animation */
            @keyframes talkingPulse {
                0%, 100% {
                    box-shadow: 0 0 0 0 rgba(67, 181, 129, 0.7);
                    transform: scale(1);
                }
                50% {
                    box-shadow: 0 0 0 15px rgba(67, 181, 129, 0);
                    transform: scale(1.02);
                }
            }

            @keyframes slideIn {
                from { opacity: 0; transform: translateY(10px) scale(0.95); }
                to { opacity: 1; transform: translateY(0) scale(1); }
            }
            @keyframes fadeIn {
                from { opacity: 0; }
                to { opacity: 1; }
            }
            @keyframes connectionGlow {
                0%, 100% { box-shadow: 0 0 12px rgba(67, 181, 129, 0.3); }
                50% { box-shadow: 0 0 20px rgba(67, 181, 129, 0.6); }
            }
            @keyframes screenShareGlow {
                0%, 100% { border-color: rgba(88, 101, 242, 0.5); }
                50% { border-color: rgba(88, 101, 242, 0.9); }
            }

            /* Smooth grid transitions */
            .voice-grid-item {
                animation: slideIn 0.3s ease forwards;
            }
            /* Video card hover effects */
            .voice-video-card:hover {
                transform: scale(1.01);
                z-index: 10;
            }
            /* Active speaker highlight */
            .voice-active-speaker {
                animation: connectionGlow 2s ease-in-out infinite;
            }
            /* Screen share border animation */
            .voice-screen-share {
                animation: screenShareGlow 2s ease-in-out infinite;
            }
    `,document.head.appendChild(t)}xt();const De=(t,a=256)=>{if(!t)return`https://ui-avatars.com/api/?name=User&background=5865f2&color=fff&bold=true&size=${a}`;const g=ot.hash(t),p=parseInt(g.substring(0,8),16)%360;return`https://ui-avatars.com/api/?name=${encodeURIComponent(t)}&background=${p.toString(16).padStart(2,"0")}${((p+60)%360).toString(16).padStart(2,"0")}${((p+120)%360).toString(16).padStart(2,"0")}&color=fff&bold=true&size=${a}`},ut=t=>t?t.replace(/_100x100\./gi,".").replace(/_150x150\./gi,".").replace(/_50x50\./gi,".").replace(/\?.*$/,""):null,gt=({roomName:t,onClose:a,isMinimized:g,onToggleMinimize:p,getRealUserAvatar:h,allUsers:y=[],currentUserProfile:s})=>{const{isInVoice:M,isMuted:j,isDeafened:C,isVideoEnabled:_,isScreenSharing:S,isSpatialAudioEnabled:b,vadSensitivity:L,isNoiseSuppressionEnabled:W,screenShareQuality:o,screenShareFPS:v,isRecording:l,recordingDuration:R,isPTTMode:k,isPTTActive:I,pttKey:Z,includeSystemAudio:ie,connectedUsers:re=[],isReconnecting:oe=!1,connectionStats:ye={},startStatsMonitoring:ee,stopStatsMonitoring:T,toggleMute:E,toggleDeafened:A,toggleCamera:w,toggleScreenShare:f,toggleSpatialAudio:z,updateVadSensitivity:x,toggleNoiseSuppression:K,updateScreenQuality:Y,updateScreenFPS:q,toggleSystemAudio:G,togglePTTMode:V,updatePTTKey:se,startRecording:H,stopRecording:te,downloadRecording:ft,leaveVoiceRoom:ve,localAudioStream:Ke,remoteStreams:ke={},remoteVolumes:Se={},setRemoteVolume:we,localCameraStream:pe,localScreenStream:xe,isTalking:je=!1}=tt(),ne=_,{user:$}=nt(),N=Q.useMemo(()=>{const n=[...re];if($&&!n.some(d=>d.username===$.username))n.push({username:$.username,isMuted:j,isCameraOn:ne,isScreenSharing:S,isTalking:je,isLocal:!0});else if($){const d=n.findIndex(m=>m.username===$.username);d>=0&&(n[d]={...n[d],isMuted:j,isCameraOn:ne,isScreenSharing:S,isTalking:je,isLocal:!0})}return n},[re,$,j,ne,S]),ae=r.useCallback(n=>{let d=null;if(s&&n===$?.username&&s.avatar&&typeof s.avatar=="string"&&(s.avatar.startsWith("http")||s.avatar.startsWith("blob:")?d=s.avatar:d=`${We}${s.avatar.startsWith("/")?"":"/"}${s.avatar}`),!d&&h&&(d=h(n)),!d){const m=y.find(i=>i.username===n);m?.avatar&&typeof m.avatar=="string"&&(m.avatar.startsWith("http")||m.avatar.startsWith("blob:")?d=m.avatar:d=`${We}${m.avatar.startsWith("/")?"":"/"}${m.avatar}`)}return d?ut(d):De(n,256)},[s,$,h,y]),F=Q.useMemo(()=>{const n={...ke};return $?.username&&(pe&&(n[`${$.username}_camera`]=pe),xe&&(n[`${$.username}_screen`]=xe)),n},[ke,$,pe,xe]),[B,le]=r.useState(null),[ce,Ce]=r.useState(null),[Ne,Te]=r.useState(!1),[ue,U]=r.useState(null),[ze,Ee]=r.useState(()=>{try{const n=localStorage.getItem("pawscord_voice_volumes");return n?JSON.parse(n):{}}catch{return{}}}),[qe,Be]=r.useState(!0),{connectionQuality:ge,hasEchoRisk:Ve,networkQuality:Ae,networkType:Re,talkingIndicators:Oe,activeSpeaker:D}=pt({isInVoice:M,localAudioStream:Ke,isMuted:j,startStatsMonitoring:ee,stopStatsMonitoring:T,screenShareQuality:o,updateScreenQuality:Y});r.useEffect(()=>{const n=()=>{Te(!0)};return window.addEventListener("openVoiceSettings",n),()=>window.removeEventListener("openVoiceSettings",n)},[]),r.useEffect(()=>{try{localStorage.setItem("pawscord_voice_volumes",JSON.stringify(ze))}catch{}},[ze]);const{isMobile:Ie}=at(),Me=B?"fullscreen":g?"minimized":Ie?"mobile":"grid";r.useEffect(()=>{M||a()},[M,a]);const Ye=n=>Ie?{cols:1,rows:n}:n<=1?{cols:1,rows:1}:n<=4?{cols:2,rows:2}:n<=6?{cols:3,rows:2}:n<=9?{cols:3,rows:3}:{cols:4,rows:Math.ceil(n/4)},Ge=Q.useMemo(()=>{let n=N.length;return N.forEach(d=>{const m=d.username;F[`${m}_screen`]&&d.isScreenSharing&&n++}),n},[N,F]),_e=N.length,{cols:$e,rows:Le}=Ye(Ge),He=r.useCallback(async n=>{window.location.hash=`#/dm/${n.username}`},[]),Ue=r.useCallback(async n=>{try{(await fetch("/api/friends/send_request/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("access_token")}`},body:JSON.stringify({username:n.username})})).ok?J.success(`Ã¢Å“â€¦ ${n.username} kullanÃ„Â±cÃ„Â±sÃ„Â±na arkadaÃ…Å¸lÃ„Â±k isteÃ„Å¸i gÃƒÂ¶nderildi!`):J.error("Ã¢ÂÅ’ ArkadaÃ…Å¸lÃ„Â±k isteÃ„Å¸i gÃƒÂ¶nderilemedi")}catch{J.error("Ã¢ÂÅ’ Bir hata oluÃ…Å¸tu")}},[]),Xe=r.useCallback(async n=>{try{(await fetch("/api/users/block/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("access_token")}`},body:JSON.stringify({username:n.username})})).ok?J.success(`Ã¢Å“â€¦ ${n.username} engellendi!`):J.error("Ã¢ÂÅ’ Engelleme iÃ…Å¸lemi baÃ…Å¸arÃ„Â±sÃ„Â±z")}catch{J.error("Ã¢ÂÅ’ Bir hata oluÃ…Å¸tu")}},[]),Je=r.useCallback(n=>{U(null),window.openUserProfile?window.openUserProfile(n.username):window.location.hash=`#/profile/${n.username}`},[]),Qe=r.useCallback(n=>{Ee(d=>({...d,[n.username]:{...d[n.username],isMuted:!d[n.username]?.isMuted}}))},[]),Ze=r.useCallback((n,d)=>{const m=Math.max(0,Math.min(200,d));Ee(c=>({...c,[n.username]:{...c[n.username],volume:m}})),document.querySelectorAll(`audio[data-username="${n.username}"]`).forEach(c=>{if(m<=100){if(c.volume=m/100,c._gainNode)try{c._gainNode.gain.value=1}catch{}}else{c.volume=1;try{c._audioContext||(c._audioContext=new(window.AudioContext||window.webkitAudioContext),c._sourceNode=c._audioContext.createMediaElementSource(c),c._gainNode=c._audioContext.createGain(),c._sourceNode.connect(c._gainNode),c._gainNode.connect(c._audioContext.destination)),c._gainNode.gain.value=m/100}catch{}}})},[]),et=()=>{const n=[];return l&&n.push(e.jsxs("span",{style:{background:"rgba(237,66,69,0.2)",color:"#ed4245",border:"1px solid rgba(237,66,69,0.4)",padding:"4px 8px",borderRadius:"10px",fontSize:"12px",display:"inline-flex",alignItems:"center",gap:"6px"},children:["Ã¢ÂÂºÃ¯Â¸Â KayÃ„Â±tta (",Math.floor(R/60).toString().padStart(2,"0"),":",Math.floor(R%60).toString().padStart(2,"0"),")"]},"rec")),S&&n.push(e.jsxs("span",{style:{background:"rgba(88,101,242,0.15)",color:"#8893ff",border:"1px solid rgba(88,101,242,0.35)",padding:"4px 8px",borderRadius:"10px",fontSize:"12px",display:"inline-flex",alignItems:"center",gap:"6px"},children:["Ã°Å¸â€“Â¥Ã¯Â¸Â PaylaÃ…Å¸Ã„Â±lÃ„Â±yor ",o," Ã¢â‚¬Â¢ ",v,"fps",ie?" Ã¢â‚¬Â¢ Ã°Å¸â€Å  Sistem":""]},"ss")),k&&n.push(e.jsxs("span",{style:{background:"rgba(250,166,26,0.18)",color:"#faa61a",border:"1px solid rgba(250,166,26,0.35)",padding:"4px 8px",borderRadius:"10px",fontSize:"12px",display:"inline-flex",alignItems:"center",gap:"6px"},children:["Ã°Å¸Å½â„¢Ã¯Â¸Â PTT (",Z,") ",I?"Ã¢â‚¬Â¢ Aktif":""]},"ptt")),oe&&n.push(e.jsx("span",{style:{background:"rgba(255,255,255,0.08)",color:"#fff",border:"1px solid rgba(255,255,255,0.2)",padding:"4px 8px",borderRadius:"10px",fontSize:"12px",display:"inline-flex",alignItems:"center",gap:"6px"},children:"Ã°Å¸â€â€ž Yeniden baÃ„Å¸lanÃ„Â±yor"},"reconnect")),n.length?e.jsx("div",{style:{display:"flex",gap:"8px",alignItems:"center",flexWrap:"wrap"},children:n}):null},fe=n=>n.streamType==="screen"?e.jsxs("div",{style:{position:"absolute",top:"12px",left:"12px",background:"linear-gradient(135deg, #5865f2 0%, #7289da 100%)",color:"#fff",padding:"8px 16px",borderRadius:"12px",fontSize:"13px",fontWeight:700,boxShadow:"0 4px 16px rgba(88, 101, 242, 0.6), 0 0 0 2px rgba(255, 255, 255, 0.2)",zIndex:100,display:"flex",alignItems:"center",gap:"8px",animation:"badgePulse 2s infinite"},children:["Ã°Å¸â€“Â¥Ã¯Â¸Â ",e.jsxs("span",{style:{textShadow:"0 2px 4px rgba(0, 0, 0, 0.5)"},children:[n.username," - Ekran PaylaÃ…Å¸Ã„Â±yor"]})]}):n.streamType==="camera"?e.jsx("div",{style:{position:"absolute",top:"12px",left:"12px",background:"rgba(67, 181, 129, 0.85)",color:"#fff",padding:"6px 12px",borderRadius:"8px",fontSize:"11px",fontWeight:600,boxShadow:"0 2px 8px rgba(0, 0, 0, 0.3)",zIndex:100,display:"flex",alignItems:"center",gap:"6px"},children:"Ã°Å¸â€œÂ¹ Kamera"}):null;if(Me==="minimized")return e.jsx(Pe,{roomName:t,userCount:_e,combinedUsers:N,currentUser:$,onToggleMinimize:p,onContextMenu:n=>U(n),getUserAvatar:ae,isMuted:j,isCameraOn:ne,isScreenSharing:S,toggleMute:E,toggleCamera:w,toggleScreenShare:f,leaveVoice:ve});if(Me==="fullscreen"&&B){const n=B.streamType==="screen"?`${B.username}_screen`:`${B.username}_camera`,d=F[n]||F[B.username];return e.jsxs("div",{style:{width:"100%",height:"100%",background:"#000",display:"flex",flexDirection:"column",overflow:"hidden"},children:[e.jsxs("div",{style:{background:"rgba(0, 0, 0, 0.8)",padding:"16px 24px",display:"flex",alignItems:"center",gap:"16px"},children:[e.jsx("button",{onClick:()=>le(null),style:{background:"rgba(255, 255, 255, 0.1)",border:"none",borderRadius:"8px",padding:"8px 16px",color:"#fff",cursor:"pointer",fontSize:"14px"},children:"Ã¢Â¬â€¦Ã¯Â¸Â Geri"}),e.jsxs("h3",{style:{color:"#fff",margin:0,flex:1},children:["Ã°Å¸â€˜Â¤ ",B.username," ",B.streamType==="screen"&&"Ã°Å¸â€“Â¥Ã¯Â¸Â Ekran PaylaÃ…Å¸Ã„Â±mÃ„Â±"]})]}),e.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",background:"#1a1a1a"},children:e.jsx(ct,{user:B,stream:d,fullscreen:!0})}),e.jsx(lt,{isMuted:j,isDeafened:C,isCameraOn:ne,isScreenSharing:S,isSpatialAudio:b,isRecording:l,recordingDuration:R,onToggleMute:E,onToggleDeafened:A,onToggleCamera:w,onToggleScreenShare:f,onToggleSpatialAudio:z,onStartRecording:H,onStopRecording:te,onLeave:ve})]})}return e.jsxs("div",{style:{width:"100%",height:"100%",background:"linear-gradient(135deg, #1e1e1e 0%, #2c2c2c 100%)",display:"flex",flexDirection:"column",overflow:"hidden"},children:[e.jsxs("div",{style:{background:"rgba(0, 0, 0, 0.3)",padding:"16px 24px",display:"flex",alignItems:"center",gap:"16px",borderBottom:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx("div",{style:{width:"10px",height:"10px",borderRadius:"50%",background:"#43b581",boxShadow:"0 0 12px #43b581",animation:"pulse 2s infinite"}}),e.jsxs("h2",{style:{color:"#fff",margin:0,fontSize:"17px",fontWeight:700,flex:1,display:"flex",alignItems:"center",gap:"12px",letterSpacing:"0.3px"},children:["Ã°Å¸Å½â„¢Ã¯Â¸Â ",t,et(),Ae==="poor"&&e.jsx("div",{style:{background:"rgba(240, 71, 71, 0.2)",border:"1px solid #f04747",borderRadius:"6px",padding:"4px 8px",fontSize:"12px",color:"#f04747",fontWeight:"600",display:"flex",alignItems:"center",gap:"4px"},children:"Ã¢Å¡Â Ã¯Â¸Â ZayÃ„Â±f BaÃ„Å¸lantÃ„Â±"}),Ae==="excellent"&&Re!=="unknown"&&e.jsxs("div",{style:{background:"rgba(67, 181, 129, 0.2)",border:"1px solid #43b581",borderRadius:"6px",padding:"4px 8px",fontSize:"12px",color:"#43b581",fontWeight:"600",display:"flex",alignItems:"center",gap:"4px"},children:["Ã°Å¸â€œÂ¶ ",Re.toUpperCase()]})]}),e.jsxs("div",{style:{color:"rgba(255, 255, 255, 0.7)",fontSize:"14px"},children:["Ã°Å¸â€˜Â¥ ",_e," kiÃ…Å¸i"]}),e.jsx("button",{onClick:p,style:{background:"rgba(255, 255, 255, 0.1)",border:"none",borderRadius:"8px",padding:"8px 16px",color:"#fff",cursor:"pointer",fontSize:"13px"},children:"Ã¢Â¬â€¡Ã¯Â¸Â KÃƒÂ¼ÃƒÂ§ÃƒÂ¼lt"})]}),e.jsx("div",{style:{flex:1,padding:"20px",display:"flex",flexDirection:"column",overflow:"auto",position:"relative",minHeight:0},children:(()=>{const n=N.filter(m=>m.isScreenSharing&&F[`${m.username}_screen`]);if(n.length>0){const m=[];n.forEach(u=>{const X=F[`${u.username}_screen`];X&&m.push({key:`${u.username}_screen`,username:u.username,type:"screen",component:e.jsx(be,{user:{...u,streamType:"screen"},stream:X,isActive:!1,isPinned:!1,onExpand:()=>le({...u,streamType:"screen"}),onPin:()=>{},onContextMenu:Fe=>U(Fe),badge:fe({...u,streamType:"screen"}),connectionQuality:ge[u.username],getUserAvatar:ae},`${u.username}_screen`)})}),N.forEach(u=>{const X=F[`${u.username}_camera`]||F[u.username];(X&&X.active||u.isLocal)&&m.push({key:`${u.username}_camera`,username:u.username,type:"camera",component:e.jsx(be,{user:{...u,streamType:"camera",volume:Se[u.username]||100,onVolumeChange:me=>we(u.username,me),isTalking:Oe[u.username]||!1},stream:X,isActive:D===u.username,isPinned:ce===u.username,onExpand:()=>le({...u,streamType:"camera"}),onPin:()=>Ce(ce===u.username?null:u.username),onContextMenu:me=>U(me),badge:fe(u),connectionQuality:ge[u.username],getUserAvatar:ae},`${u.username}_camera`)})});const i=m.length;let c,P;return i<=2?(c=i,P=1):i<=4?(c=2,P=2):i<=6?(c=3,P=2):(c=3,P=Math.ceil(i/3)),e.jsx("div",{style:{width:"100%",height:"100%",display:"grid",gridTemplateColumns:`repeat(${c}, 1fr)`,gridTemplateRows:`repeat(${P}, 1fr)`,gap:"16px",padding:"0",position:"relative"},children:m.map((u,X)=>e.jsx("div",{style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",zIndex:1,isolation:"isolate"},children:u.component},u.key))})}else return N.some(i=>{const c=F[`${i.username}_camera`]||F[i.username];return c&&c.active})?e.jsx("div",{style:{flex:1,display:"grid",gridTemplateColumns:`repeat(${$e}, 1fr)`,gridTemplateRows:`repeat(${Le}, 1fr)`,gap:"16px",minHeight:"400px",height:"100%"},children:N.map(i=>{const c=F[`${i.username}_camera`]||(i.isLocal?null:F[i.username]);return e.jsx(be,{user:{...i,streamType:"camera",volume:Se[i.username]||100,onVolumeChange:P=>we(i.username,P)},stream:c,isActive:D===i.username,isPinned:ce===i.username,onExpand:()=>le({...i,streamType:"camera"}),onPin:()=>Ce(ce===i.username?null:i.username),onContextMenu:P=>U(P),badge:fe({...i,streamType:"camera"}),connectionQuality:ge[i.username],getUserAvatar:ae},`${i.username}_camera`)})}):e.jsx("div",{style:{flex:1,display:"grid",gridTemplateColumns:`repeat(${Math.min($e,3)}, 1fr)`,gridTemplateRows:`repeat(${Le}, 1fr)`,gap:"24px",padding:"40px",alignItems:"center",justifyContent:"center"},children:N.map(i=>e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"12px",padding:"32px",borderRadius:"16px",background:D===i.username?"linear-gradient(135deg, rgba(88, 101, 242, 0.25) 0%, rgba(114, 137, 218, 0.15) 100%)":"rgba(47, 49, 54, 0.5)",border:D===i.username?"2px solid rgba(88, 101, 242, 0.9)":"2px solid rgba(79, 84, 92, 0.3)",boxShadow:D===i.username?"0 8px 32px rgba(88, 101, 242, 0.4), 0 0 20px rgba(88, 101, 242, 0.3)":"0 4px 12px rgba(0, 0, 0, 0.2)",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",cursor:"pointer",position:"relative",transform:D===i.username?"scale(1.05)":"scale(1)",animation:"slideIn 0.4s ease forwards"},onClick:()=>U({user:i,position:{x:window.innerWidth/2,y:window.innerHeight/2}}),children:[e.jsx("div",{style:{width:"140px",height:"140px",borderRadius:"50%",overflow:"hidden",border:`5px solid ${D===i.username?"#5865f2":"#40444b"}`,boxShadow:D===i.username?"0 8px 24px rgba(88, 101, 242, 0.6), inset 0 0 20px rgba(88, 101, 242, 0.2)":"0 4px 12px rgba(0, 0, 0, 0.4)",animation:D===i.username?"pulse 1.5s infinite":"none",position:"relative"},children:e.jsx("img",{src:ae(i.username),alt:i.username,onError:c=>{c.target.onerror=null,c.target.src=De(i.username,256)},style:{width:"100%",height:"100%",objectFit:"cover",filter:D===i.username?"brightness(1.1)":"brightness(0.95)"}})}),e.jsx("div",{style:{fontSize:"20px",fontWeight:"700",color:D===i.username?"#dee0fc":"#fff",textAlign:"center",textShadow:"0 2px 8px rgba(0, 0, 0, 0.7)",letterSpacing:"0.3px"},children:i.username}),e.jsxs("div",{style:{display:"flex",gap:"12px",fontSize:"22px",marginTop:"4px"},children:[i.isMuted&&e.jsx("span",{title:"Mikrofon KapalÃ„Â±",style:{filter:"drop-shadow(0 2px 4px rgba(0, 0, 0, 0.5))"},children:"Ã°Å¸â€â€¡"}),i.isDeafened&&e.jsx("span",{title:"KulaklÃ„Â±k KapalÃ„Â±",style:{filter:"drop-shadow(0 2px 4px rgba(0, 0, 0, 0.5))"},children:"Ã°Å¸â€Ë†"})]})]},i.username))})})()}),Ve&&qe&&e.jsxs("div",{style:{position:"absolute",bottom:"100px",left:"50%",transform:"translateX(-50%)",background:"linear-gradient(135deg, rgba(250, 166, 26, 0.95) 0%, rgba(237, 66, 69, 0.95) 100%)",color:"#fff",padding:"16px 24px",borderRadius:"12px",zIndex:1e3,display:"flex",alignItems:"center",gap:"12px",boxShadow:"0 8px 32px rgba(250, 166, 26, 0.6)",animation:"pulse 2s infinite",maxWidth:"90%"},children:[e.jsx("div",{style:{fontSize:"24px",animation:"pulse 1.5s infinite"},children:"Ã¢Å¡Â Ã¯Â¸Â"}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:"4px",fontSize:"15px"},children:"Echo Tespit Edildi!"}),e.jsx("div",{style:{fontSize:"13px",opacity:.9},children:"KulaklÃ„Â±k kullanmanÃ„Â±z ÃƒÂ¶nerilir. HoparlÃƒÂ¶r kullanÃ„Â±mÃ„Â± echo'ya neden olur."})]}),e.jsx("button",{onClick:()=>Be(!1),style:{background:"rgba(255, 255, 255, 0.2)",border:"none",borderRadius:"6px",color:"#fff",padding:"6px 12px",cursor:"pointer",fontSize:"12px",fontWeight:"bold"},children:"Kapat"})]}),Ne&&e.jsx(rt,{onClose:()=>Te(!1),channelId:t}),ue&&e.jsx(it,{user:ue.user,position:ue.position,onClose:()=>U(null),onSendMessage:He,onAddFriend:Ue,onBlock:Xe,onViewProfile:Je,onMuteUser:Qe,onAdjustVolume:Ze,currentUser:$,isInVoiceChat:!0})]})},Et=Q.memo(gt);export{Et as default};
