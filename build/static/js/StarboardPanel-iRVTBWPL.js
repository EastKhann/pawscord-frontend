var y=Object.defineProperty;var s=(n,d)=>y(n,"name",{value:d,configurable:!0});import{r as o,j as e}from"./react-core-Djgtqrmb.js";import{y as i}from"./ui-vendor-IhB9Znpc.js";import{g as S}from"./index-Bohqi95c.js";import"./media-vendor-CxFPycob.js";import"./router-vendor-gmJ9Mn-1.js";import"./state-vendor-CbW2fAN9.js";import"./crypto-vendor-D1XRGppi.js";import"./icons-vendor-BMXAt4pj.js";const M=s(({serverId:n,onClose:d})=>{const l=S(),[t,c]=o.useState({enabled:!1,channel_id:"",emoji:"â­",threshold:3,self_star:!1,allow_nsfw:!1}),[h,x]=o.useState([]),[p,g]=o.useState([]),[f,u]=o.useState(!0);o.useEffect(()=>{v(),j(),b()},[n]);const v=s(async()=>{try{const a=await fetch(`${l}/starboard/server/${n}/config/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(a.ok){const r=await a.json();c(r)}}catch{}finally{u(!1)}},"fetchConfig"),j=s(async()=>{try{const a=await fetch(`${l}/starboard/server/${n}/messages/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(a.ok){const r=await a.json();x(r)}}catch{}},"fetchStars"),b=s(async()=>{try{const a=await fetch(`${l}/channels/server/${n}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(a.ok){const r=await a.json();g(r.filter(m=>m.type==="text"))}}catch{}},"fetchChannels"),N=s(async()=>{try{(await fetch(`${l}/starboard/server/${n}/config/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`,"Content-Type":"application/json"},body:JSON.stringify(t)})).ok?i.success("âœ… Starboard ayarlarÄ± kaydedildi"):i.error("âŒ Kaydetme hatasÄ±")}catch{i.error("âŒ BaÄŸlantÄ± hatasÄ±")}},"saveConfig"),k=s(async a=>{try{(await fetch(`${l}/starboard/message/${a}/remove/`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}})).ok&&(i.success("âœ… Mesaj kaldÄ±rÄ±ldÄ±"),j())}catch{i.error("âŒ Silme hatasÄ±")}},"removeMessage");return e.jsx("div",{className:"starboard-overlay",onClick:d,children:e.jsxs("div",{className:"starboard-panel",onClick:s(a=>a.stopPropagation(),"onClick"),children:[e.jsxs("div",{className:"starboard-header",children:[e.jsx("h2",{children:"â­ Starboard"}),e.jsx("button",{className:"close-btn",onClick:d,children:"Ã—"})]}),e.jsx("div",{className:"starboard-content",children:f?e.jsxs("div",{className:"loading-state",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{children:"YÃ¼kleniyor..."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"config-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h3",{children:"âš™ï¸ Ayarlar"}),e.jsxs("label",{className:"toggle-switch",children:[e.jsx("input",{type:"checkbox",checked:t.enabled,onChange:s(a=>c({...t,enabled:a.target.checked}),"onChange")}),e.jsx("span",{className:"toggle-slider"})]})]}),e.jsxs("div",{className:"config-grid",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"ğŸ“¢ Starboard KanalÄ±"}),e.jsxs("select",{value:t.channel_id,onChange:s(a=>c({...t,channel_id:a.target.value}),"onChange"),children:[e.jsx("option",{value:"",children:"SeÃ§in"}),p.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"â­ Emoji"}),e.jsx("input",{type:"text",value:t.emoji,onChange:s(a=>c({...t,emoji:a.target.value}),"onChange"),placeholder:"â­"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"ğŸ¯ EÅŸik DeÄŸeri"}),e.jsx("input",{type:"number",min:"1",max:"50",value:t.threshold,onChange:s(a=>c({...t,threshold:parseInt(a.target.value)}),"onChange")}),e.jsx("small",{children:"MesajÄ±n starboard'a eklenebilmesi iÃ§in gereken minimum yÄ±ldÄ±z sayÄ±sÄ±"})]}),e.jsx("div",{className:"form-group",children:e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:t.self_star,onChange:s(a=>c({...t,self_star:a.target.checked}),"onChange")}),e.jsx("span",{children:"Kendi mesajÄ±na yÄ±ldÄ±z verebilir"})]})}),e.jsx("div",{className:"form-group",children:e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:t.allow_nsfw,onChange:s(a=>c({...t,allow_nsfw:a.target.checked}),"onChange")}),e.jsx("span",{children:"NSFW kanallardan izin ver"})]})})]}),e.jsx("button",{className:"save-btn",onClick:N,children:"ğŸ’¾ Kaydet"})]}),e.jsxs("div",{className:"stars-section",children:[e.jsxs("h3",{children:["â­ Starboard MesajlarÄ± (",h.length,")"]}),h.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("span",{className:"empty-icon",children:"â­"}),e.jsx("p",{children:"HenÃ¼z starboard mesajÄ± yok"})]}):e.jsx("div",{className:"stars-list",children:h.map(a=>e.jsxs("div",{className:"star-card",children:[e.jsxs("div",{className:"star-header",children:[e.jsxs("div",{className:"star-author",children:[a.author_avatar?e.jsx("img",{src:a.author_avatar,alt:""}):e.jsx("div",{className:"default-avatar",children:"ğŸ‘¤"}),e.jsx("span",{children:a.author_name})]}),e.jsx("div",{className:"star-count",children:e.jsxs("span",{children:[t.emoji," ",a.star_count]})})]}),e.jsxs("div",{className:"star-content",children:[e.jsx("p",{children:a.content}),a.attachments&&a.attachments.length>0&&e.jsx("div",{className:"star-attachments",children:a.attachments.map((r,m)=>e.jsx("img",{src:r,alt:""},m))})]}),e.jsxs("div",{className:"star-footer",children:[e.jsx("span",{className:"star-channel",children:a.channel_name}),e.jsx("span",{className:"star-time",children:new Date(a.created_at).toLocaleString("tr-TR")}),e.jsx("button",{className:"remove-btn",onClick:s(()=>k(a.message_id),"onClick"),children:"ğŸ—‘ï¸"})]})]},a.message_id))})]})]})})]})})},"StarboardPanel");export{M as default};
