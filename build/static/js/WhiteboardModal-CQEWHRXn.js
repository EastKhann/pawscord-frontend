import{r as c,b as n}from"./react-core-9vc7GIjk.js";import{a as Y,aI as B,aJ as T,o as D}from"./icons-vendor-NoxEirJf.js";import"./editor-vendor-DiU449Dh.js";const O=({roomSlug:h,onClose:d,wsProtocol:g,apiHost:m})=>{const t=c.useRef(null),i=c.useRef(null),[v,y]=c.useState(!1),[u,f]=c.useState("#000000"),[p,b]=c.useState(3);c.useEffect(()=>{const e=`${g}://${m}/ws/whiteboard/${h}/`;return i.current=new WebSocket(e),i.current.onmessage=r=>{const{x:s,y:a,type:x,color:S,width:R,prevX:W,prevY:X}=JSON.parse(r.data),l=t.current.getContext("2d");x==="draw"?(l.beginPath(),l.moveTo(W,X),l.lineTo(s,a),l.strokeStyle=S,l.lineWidth=R,l.lineCap="round",l.stroke()):x==="clear"&&l.clearRect(0,0,t.current.width,t.current.height)},()=>i.current.close()},[h,g,m]),c.useEffect(()=>{const e=r=>{r.key==="Escape"&&d()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[d]),c.useEffect(()=>{const e=t.current;e.width=800,e.height=600;const r=e.getContext("2d");r.fillStyle="white",r.fillRect(0,0,e.width,e.height)},[]);const E=({nativeEvent:e})=>{const{offsetX:r,offsetY:s}=e;y(!0),t.current.lastX=r,t.current.lastY=s},k=({nativeEvent:e})=>{if(!v)return;const{offsetX:r,offsetY:s}=e,a=t.current.getContext("2d");a.beginPath(),a.moveTo(t.current.lastX,t.current.lastY),a.lineTo(r,s),a.strokeStyle=u,a.lineWidth=p,a.lineCap="round",a.stroke(),i.current.readyState===WebSocket.OPEN&&i.current.send(JSON.stringify({type:"draw",x:r,y:s,prevX:t.current.lastX,prevY:t.current.lastY,color:u,width:p})),t.current.lastX=r,t.current.lastY=s},w=()=>{y(!1)},C=()=>{const e=t.current.getContext("2d");e.fillStyle="white",e.fillRect(0,0,t.current.width,t.current.height),i.current.send(JSON.stringify({type:"clear"}))};return n.createElement("div",{style:o.overlay,onClick:d},n.createElement("div",{style:o.modal,onClick:e=>e.stopPropagation()},n.createElement("div",{style:o.header},n.createElement("h3",null,"ðŸŽ¨ Ortak Ã‡izim TahtasÄ±"),n.createElement("button",{onClick:d,style:o.closeBtn},n.createElement(Y,null))),n.createElement("div",{style:o.toolbar},n.createElement("input",{type:"color",value:u,onChange:e=>f(e.target.value),style:o.colorPicker}),n.createElement("input",{type:"range",min:"1",max:"20",value:p,onChange:e=>b(e.target.value)}),n.createElement("button",{onClick:()=>f("#ffffff"),style:o.toolBtn},n.createElement(B,null)),n.createElement("button",{onClick:()=>f("#000000"),style:o.toolBtn},n.createElement(T,null)),n.createElement("button",{onClick:C,style:{...o.toolBtn,color:"red"}},n.createElement(D,null))),n.createElement("div",{style:o.canvasContainer},n.createElement("canvas",{ref:t,onMouseDown:E,onMouseMove:k,onMouseUp:w,onMouseLeave:w,style:o.canvas}))))},o={overlay:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0.85)",zIndex:3e3,display:"flex",justifyContent:"center",alignItems:"center"},modal:{backgroundColor:"#2b2d31",borderRadius:"12px",padding:"10px",display:"flex",flexDirection:"column",gap:"10px"},header:{display:"flex",justifyContent:"space-between",color:"white",padding:"0 10px"},closeBtn:{background:"none",border:"none",color:"white",fontSize:"1.5em",cursor:"pointer"},toolbar:{display:"flex",gap:"10px",alignItems:"center",backgroundColor:"#1e1f22",padding:"10px",borderRadius:"8px"},canvasContainer:{border:"1px solid #1e1f22",borderRadius:"4px",overflow:"hidden",backgroundColor:"white"},canvas:{cursor:"crosshair",touchAction:"none"},toolBtn:{background:"none",border:"none",color:"#ccc",fontSize:"1.2em",cursor:"pointer"},colorPicker:{border:"none",width:"30px",height:"30px",cursor:"pointer",padding:0}};export{O as default};
