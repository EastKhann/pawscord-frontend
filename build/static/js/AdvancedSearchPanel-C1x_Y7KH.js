import{r as l,n as e}from"./react-core-BMiyQWF6.js";import{f,a as S,Y as C,H as I,bt as g}from"./icons-vendor-GUGjkvMm.js";import{t as n}from"./index-DBXG7kfi.js";import"./editor-vendor-D9c4a6XZ.js";import"./media-vendor-BuSyE8vR.js";import"./router-vendor-B86Z1mIL.js";import"./state-vendor-CAyNnPM4.js";import"./crypto-vendor-1Q6e4ZD-.js";const A=({fetchWithAuth:u,apiBaseUrl:m,onClose:y,serverId:b,roomSlug:j})=>{const[o,k]=l.useState(""),[d,v]=l.useState([]),[i,c]=l.useState(!1),[s,r]=l.useState({author:"",dateFrom:"",dateTo:"",hasImage:!1,hasVideo:!1,hasLink:!1,hasEmbed:!1}),p=async()=>{if(!o.trim()){n.error("Please enter a search query");return}c(!0);try{const a=new URLSearchParams({q:o,server_id:b||"",room_slug:j||"",author:s.author||"",date_from:s.dateFrom||"",date_to:s.dateTo||"",has_image:s.hasImage||"",has_video:s.hasVideo||"",has_link:s.hasLink||"",has_embed:s.hasEmbed||""}),h=await(await u(`${m}/search/advanced/?${a}`)).json();v(h.results||[]),n.success(`Found ${h.results?.length||0} results`)}catch{n.error("Search failed")}finally{c(!1)}};return e.jsx("div",{style:t.overlay,children:e.jsxs("div",{style:t.modal,children:[e.jsxs("div",{style:t.header,children:[e.jsxs("div",{style:t.headerLeft,children:[e.jsx(f,{style:{marginRight:"10px",color:"#5865f2"}}),e.jsx("h2",{style:t.title,children:"Advanced Search"})]}),e.jsx("button",{onClick:y,style:t.closeButton,children:e.jsx(S,{})})]}),e.jsxs("div",{style:t.searchBar,children:[e.jsx("input",{type:"text",value:o,onChange:a=>k(a.target.value),onKeyDown:a=>a.key==="Enter"&&p(),placeholder:"Search messages...",style:t.searchInput}),e.jsxs("button",{onClick:p,style:t.searchButton,disabled:i,children:[e.jsx(f,{})," ",i?"Searching...":"Search"]})]}),e.jsxs("div",{style:t.filtersSection,children:[e.jsxs("div",{style:t.filterHeader,children:[e.jsx(C,{style:{marginRight:"8px"}}),"Filters"]}),e.jsxs("div",{style:t.filtersGrid,children:[e.jsxs("div",{style:t.filterGroup,children:[e.jsxs("label",{style:t.filterLabel,children:[e.jsx(I,{style:{marginRight:"6px"}}),"Author"]}),e.jsx("input",{type:"text",value:s.author,onChange:a=>r({...s,author:a.target.value}),placeholder:"Username",style:t.filterInput})]}),e.jsxs("div",{style:t.filterGroup,children:[e.jsxs("label",{style:t.filterLabel,children:[e.jsx(g,{style:{marginRight:"6px"}}),"Date From"]}),e.jsx("input",{type:"date",value:s.dateFrom,onChange:a=>r({...s,dateFrom:a.target.value}),style:t.filterInput})]}),e.jsxs("div",{style:t.filterGroup,children:[e.jsxs("label",{style:t.filterLabel,children:[e.jsx(g,{style:{marginRight:"6px"}}),"Date To"]}),e.jsx("input",{type:"date",value:s.dateTo,onChange:a=>r({...s,dateTo:a.target.value}),style:t.filterInput})]})]}),e.jsxs("div",{style:t.checkboxGrid,children:[e.jsxs("label",{style:t.checkbox,children:[e.jsx("input",{type:"checkbox",checked:s.hasImage,onChange:a=>r({...s,hasImage:a.target.checked})}),"Has Image"]}),e.jsxs("label",{style:t.checkbox,children:[e.jsx("input",{type:"checkbox",checked:s.hasVideo,onChange:a=>r({...s,hasVideo:a.target.checked})}),"Has Video"]}),e.jsxs("label",{style:t.checkbox,children:[e.jsx("input",{type:"checkbox",checked:s.hasLink,onChange:a=>r({...s,hasLink:a.target.checked})}),"Has Link"]}),e.jsxs("label",{style:t.checkbox,children:[e.jsx("input",{type:"checkbox",checked:s.hasEmbed,onChange:a=>r({...s,hasEmbed:a.target.checked})}),"Has Embed"]})]})]}),e.jsx("div",{style:t.content,children:i?e.jsx("div",{style:t.loading,children:"Searching..."}):d.length===0?e.jsx("div",{style:t.empty,children:o?"No results found":"Enter a query and press search"}):e.jsx("div",{style:t.resultsList,children:d.map((a,x)=>e.jsxs("div",{style:t.resultCard,children:[e.jsxs("div",{style:t.resultHeader,children:[e.jsx("span",{style:t.resultAuthor,children:a.author_username}),e.jsx("span",{style:t.resultDate,children:new Date(a.created_at).toLocaleString()})]}),e.jsx("div",{style:t.resultContent,children:a.content}),a.room_name&&e.jsxs("div",{style:t.resultMeta,children:["#",a.room_name]}),(a.has_image||a.has_video||a.has_link)&&e.jsxs("div",{style:t.resultAttachments,children:[a.has_image&&e.jsx("span",{style:t.badge,children:"ðŸ“· Image"}),a.has_video&&e.jsx("span",{style:t.badge,children:"ðŸŽ¥ Video"}),a.has_link&&e.jsx("span",{style:t.badge,children:"ðŸ”— Link"})]})]},x))})})]})})},t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999},modal:{backgroundColor:"#1e1e1e",borderRadius:"8px",width:"90%",maxWidth:"1000px",maxHeight:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #2c2f33"},headerLeft:{display:"flex",alignItems:"center"},title:{margin:0,fontSize:"20px",color:"#ffffff"},closeButton:{background:"none",border:"none",color:"#99aab5",cursor:"pointer",fontSize:"20px",padding:"5px"},searchBar:{padding:"20px",borderBottom:"1px solid #2c2f33",display:"flex",gap:"12px"},searchInput:{flex:1,padding:"12px",backgroundColor:"#2c2f33",border:"1px solid #2c2f33",borderRadius:"4px",color:"#ffffff",fontSize:"14px"},searchButton:{padding:"12px 24px",backgroundColor:"#5865f2",border:"none",borderRadius:"4px",color:"#ffffff",cursor:"pointer",fontSize:"14px",display:"flex",alignItems:"center",gap:"8px"},filtersSection:{padding:"20px",borderBottom:"1px solid #2c2f33",backgroundColor:"#2c2f33"},filterHeader:{fontSize:"14px",fontWeight:"600",color:"#ffffff",marginBottom:"16px",display:"flex",alignItems:"center"},filtersGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"12px",marginBottom:"16px"},filterGroup:{display:"flex",flexDirection:"column",gap:"6px"},filterLabel:{fontSize:"13px",color:"#dcddde",display:"flex",alignItems:"center"},filterInput:{padding:"8px",backgroundColor:"#1e1e1e",border:"1px solid #1e1e1e",borderRadius:"4px",color:"#ffffff",fontSize:"13px"},checkboxGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"12px"},checkbox:{fontSize:"13px",color:"#dcddde",display:"flex",alignItems:"center",gap:"8px",cursor:"pointer"},content:{padding:"20px",overflowY:"auto",flex:1},loading:{textAlign:"center",color:"#99aab5",padding:"40px"},empty:{textAlign:"center",color:"#99aab5",padding:"40px"},resultsList:{display:"flex",flexDirection:"column",gap:"12px"},resultCard:{backgroundColor:"#2c2f33",borderRadius:"8px",padding:"16px"},resultHeader:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},resultAuthor:{fontSize:"14px",fontWeight:"600",color:"#5865f2"},resultDate:{fontSize:"12px",color:"#99aab5"},resultContent:{fontSize:"14px",color:"#dcddde",marginBottom:"8px",lineHeight:"1.5"},resultMeta:{fontSize:"12px",color:"#99aab5",marginBottom:"8px"},resultAttachments:{display:"flex",gap:"8px"},badge:{fontSize:"11px",padding:"4px 8px",backgroundColor:"#5865f2",borderRadius:"4px",color:"#ffffff"}};export{A as default};
