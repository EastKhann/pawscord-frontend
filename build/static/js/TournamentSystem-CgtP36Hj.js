import{r as x,d as e,ae as g,aC as T,i as b,G as S,U as w}from"./react-core-DrOm_csO.js";import{t as z}from"./index-BYhWpPLp.js";const _=({onClose:a,fetchWithAuth:c,apiBaseUrl:r,currentUser:d})=>{const[p,l]=x.useState([]),[m,i]=x.useState(null),[f,s]=x.useState(!1),[n,E]=x.useState("all");x.useEffect(()=>{y()},[n]);const y=async()=>{try{const o=await c(`${r}/tournaments/?filter=${n}`);if(o.ok){const u=await o.json();l(u.tournaments||[])}}catch(o){console.error("Tournament load error:",o)}},v=async o=>{try{const u=await c(`${r}/tournaments/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(u.ok){const h=await u.json();l([h.tournament,...p]),s(!1)}}catch(u){console.error("Tournament create error:",u)}},C=async o=>{try{(await c(`${r}/tournaments/${o}/join/`,{method:"POST"})).ok&&(z.success("✅ Turnuvaya katıldınız!"),y())}catch(u){console.error("Join error:",u)}},k=async o=>{if(confirm("Turnuvadan ayrılmak istediğinize emin misiniz?"))try{await c(`${r}/tournaments/${o}/leave/`,{method:"POST"}),y()}catch(u){console.error("Leave error:",u)}};return e.createElement("div",{style:t.overlay},e.createElement("div",{style:t.panel},e.createElement("div",{style:t.header},e.createElement("div",{style:t.headerLeft},e.createElement(g,{size:24,color:"#faa61a"}),e.createElement("h2",{style:t.title},"Turnuvalar")),e.createElement("div",{style:t.headerActions},e.createElement("button",{onClick:()=>s(!0),style:t.createButton},e.createElement(T,{size:14}),e.createElement("span",null,"Yeni Turnuva")),e.createElement("button",{onClick:a,style:t.closeButton},e.createElement(b,{size:20})))),e.createElement("div",{style:t.filters},["all","active","upcoming","completed"].map(o=>e.createElement("button",{key:o,onClick:()=>E(o),style:{...t.filterButton,backgroundColor:n===o?"#5865f2":"#2f3136"}},o==="all"?"Tümü":o==="active"?"Aktif":o==="upcoming"?"Yaklaşan":"Tamamlanan"))),e.createElement("div",{style:t.content},p.length===0?e.createElement("div",{style:t.empty},e.createElement(g,{size:48,color:"#4e5058"}),e.createElement("p",null,"Henüz turnuva yok")):e.createElement("div",{style:t.tournamentGrid},p.map(o=>e.createElement(B,{key:o.id,tournament:o,currentUser:d,onJoin:()=>C(o.id),onLeave:()=>k(o.id),onView:()=>i(o)})))),f&&e.createElement(j,{onClose:()=>s(!1),onCreate:v}),m&&e.createElement(R,{tournament:m,onClose:()=>i(null),fetchWithAuth:c,apiBaseUrl:r})))},B=({tournament:a,currentUser:c,onJoin:r,onLeave:d,onView:p})=>{const l=a.participants?.some(s=>s.username===c),m=a.participants?.length>=a.max_participants,i=a.status==="active",f=a.status==="completed";return e.createElement("div",{style:t.tournamentCard},e.createElement("div",{style:t.cardHeader},e.createElement("div",{style:t.tournamentName},a.name),e.createElement("div",{style:{...t.statusBadge,backgroundColor:i?"#3ba55d":f?"#72767d":"#faa61a"}},a.status)),e.createElement("div",{style:t.cardBody},e.createElement("div",{style:t.cardInfo},e.createElement(S,{size:14}),e.createElement("span",null,a.participants?.length||0,"/",a.max_participants)),e.createElement("div",{style:t.cardInfo},e.createElement(w,{size:14}),e.createElement("span",null,new Date(a.start_date).toLocaleDateString("tr-TR")))),e.createElement("div",{style:t.cardFooter},e.createElement("button",{onClick:p,style:t.viewButton},"Detaylar"),!f&&(l?e.createElement("button",{onClick:d,style:t.leaveButton},"Ayrıl"):e.createElement("button",{onClick:r,disabled:m,style:{...t.joinButton,opacity:m?.5:1,cursor:m?"not-allowed":"pointer"}},m?"Dolu":"Katıl"))))},j=({onClose:a,onCreate:c})=>{const[r,d]=x.useState({name:"",game:"",max_participants:8,start_date:"",prize:"",rules:""}),p=l=>{l.preventDefault(),c(r)};return e.createElement("div",{style:t.modalOverlay},e.createElement("div",{style:t.modal},e.createElement("h3",{style:t.modalTitle},"Yeni Turnuva Oluştur"),e.createElement("form",{onSubmit:p,style:t.form},e.createElement("input",{type:"text",placeholder:"Turnuva Adı",value:r.name,onChange:l=>d({...r,name:l.target.value}),style:t.input,required:!0}),e.createElement("input",{type:"text",placeholder:"Oyun",value:r.game,onChange:l=>d({...r,game:l.target.value}),style:t.input,required:!0}),e.createElement("select",{value:r.max_participants,onChange:l=>d({...r,max_participants:parseInt(l.target.value)}),style:t.input},e.createElement("option",{value:4},"4 Kişi"),e.createElement("option",{value:8},"8 Kişi"),e.createElement("option",{value:16},"16 Kişi"),e.createElement("option",{value:32},"32 Kişi")),e.createElement("input",{type:"datetime-local",value:r.start_date,onChange:l=>d({...r,start_date:l.target.value}),style:t.input,required:!0}),e.createElement("input",{type:"text",placeholder:"Ödül (opsiyonel)",value:r.prize,onChange:l=>d({...r,prize:l.target.value}),style:t.input}),e.createElement("textarea",{placeholder:"Kurallar",value:r.rules,onChange:l=>d({...r,rules:l.target.value}),style:{...t.input,minHeight:"100px"}}),e.createElement("div",{style:t.modalButtons},e.createElement("button",{type:"button",onClick:a,style:t.cancelButton},"İptal"),e.createElement("button",{type:"submit",style:t.submitButton},"Oluştur")))))},R=({tournament:a,onClose:c,fetchWithAuth:r,apiBaseUrl:d})=>{const[p,l]=x.useState(null);x.useEffect(()=>{m()},[a.id]);const m=async()=>{try{const i=await r(`${d}/tournaments/${a.id}/bracket/`);if(i.ok){const f=await i.json();l(f.bracket)}}catch(i){console.error("Bracket load error:",i)}};return e.createElement("div",{style:t.modalOverlay},e.createElement("div",{style:{...t.modal,maxWidth:"800px"}},e.createElement("div",{style:t.modalHeader},e.createElement("h3",{style:t.modalTitle},a.name),e.createElement("button",{onClick:c,style:t.modalClose},e.createElement(b,{size:18}))),e.createElement("div",{style:t.modalContent},e.createElement("div",{style:t.detailSection},e.createElement("h4",null,"Bilgiler"),e.createElement("p",null,e.createElement("strong",null,"Oyun:")," ",a.game),e.createElement("p",null,e.createElement("strong",null,"Katılımcı:")," ",a.participants?.length,"/",a.max_participants),e.createElement("p",null,e.createElement("strong",null,"Başlangıç:")," ",new Date(a.start_date).toLocaleString("tr-TR")),a.prize&&e.createElement("p",null,e.createElement("strong",null,"Ödül:")," ",a.prize)),a.rules&&e.createElement("div",{style:t.detailSection},e.createElement("h4",null,"Kurallar"),e.createElement("p",null,a.rules)),p&&e.createElement("div",{style:t.detailSection},e.createElement("h4",null,"Eşleşmeler"),(()=>{const i={};(Array.isArray(p)?p:[]).forEach(s=>{const n=s.round||1;i[n]||(i[n]=[]),i[n].push(s)});const f=Object.keys(i).sort((s,n)=>s-n);return e.createElement("div",{style:{display:"flex",gap:"20px",overflowX:"auto",padding:"12px 0"}},f.map(s=>e.createElement("div",{key:s,style:{minWidth:"200px",flex:"0 0 auto"}},e.createElement("div",{style:{color:"#5865f2",fontWeight:600,fontSize:"0.85em",marginBottom:"10px",textAlign:"center"}},f.length===1?"Final":`Tur ${s}`),e.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"12px"}},i[s].map(n=>e.createElement("div",{key:n.id,style:{backgroundColor:"#1e1f22",borderRadius:"8px",overflow:"hidden",border:n.status==="completed"?"1px solid #23a559":"1px solid #3f4147"}},e.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 12px",backgroundColor:n.winner&&n.winner===n.participant1?.user_id?"rgba(35,165,89,0.1)":"transparent",borderBottom:"1px solid #2b2d31"}},e.createElement("span",{style:{color:"#dbdee1",fontSize:"0.85em",fontWeight:n.winner===n.participant1?.user_id?700:400}},n.participant1?.username||"TBD"),e.createElement("span",{style:{color:"#949ba4",fontSize:"0.8em",fontWeight:600}},n.score1??"-")),e.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 12px",backgroundColor:n.winner&&n.winner===n.participant2?.user_id?"rgba(35,165,89,0.1)":"transparent"}},e.createElement("span",{style:{color:"#dbdee1",fontSize:"0.85em",fontWeight:n.winner===n.participant2?.user_id?700:400}},n.participant2?.username||"TBD"),e.createElement("span",{style:{color:"#949ba4",fontSize:"0.8em",fontWeight:600}},n.score2??"-"))))))))})()),e.createElement("div",{style:t.detailSection},e.createElement("h4",null,"Katılımcılar"),e.createElement("div",{style:t.participantList},a.participants?.map(i=>e.createElement("div",{key:i.id,style:t.participant},e.createElement("span",null,i.username),i.seed&&e.createElement("span",{style:t.seed},"#",i.seed))))))))},t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,padding:"20px"},panel:{backgroundColor:"#2f3136",borderRadius:"8px",width:"100%",maxWidth:"1200px",maxHeight:"90vh",display:"flex",flexDirection:"column"},header:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"20px",borderBottom:"1px solid #202225"},headerLeft:{display:"flex",alignItems:"center",gap:"12px"},headerActions:{display:"flex",gap:"12px"},title:{margin:0,fontSize:"20px",color:"#ffffff"},createButton:{display:"flex",alignItems:"center",gap:"8px",backgroundColor:"#5865f2",color:"#ffffff",border:"none",padding:"8px 16px",borderRadius:"4px",cursor:"pointer",fontSize:"14px"},closeButton:{background:"none",border:"none",color:"#b9bbbe",cursor:"pointer",padding:"8px"},filters:{display:"flex",gap:"8px",padding:"16px 20px",borderBottom:"1px solid #202225"},filterButton:{padding:"8px 16px",borderRadius:"4px",border:"none",color:"#ffffff",cursor:"pointer",fontSize:"13px"},content:{flex:1,overflowY:"auto",padding:"20px"},empty:{textAlign:"center",padding:"60px 20px",color:"#b9bbbe"},tournamentGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"16px"},tournamentCard:{backgroundColor:"#36393f",borderRadius:"8px",padding:"16px",display:"flex",flexDirection:"column",gap:"12px"},cardHeader:{display:"flex",justifyContent:"space-between",alignItems:"start"},tournamentName:{color:"#ffffff",fontSize:"16px",fontWeight:"bold",flex:1},statusBadge:{padding:"4px 8px",borderRadius:"12px",fontSize:"11px",color:"#ffffff",textTransform:"uppercase",fontWeight:"bold"},cardBody:{display:"flex",flexDirection:"column",gap:"8px"},cardInfo:{display:"flex",alignItems:"center",gap:"8px",color:"#b9bbbe",fontSize:"13px"},cardFooter:{display:"flex",gap:"8px",marginTop:"auto"},viewButton:{flex:1,backgroundColor:"#202225",color:"#ffffff",border:"none",padding:"8px",borderRadius:"4px",cursor:"pointer",fontSize:"13px"},joinButton:{flex:1,backgroundColor:"#3ba55d",color:"#ffffff",border:"none",padding:"8px",borderRadius:"4px",cursor:"pointer",fontSize:"13px",fontWeight:"bold"},leaveButton:{flex:1,backgroundColor:"#ed4245",color:"#ffffff",border:"none",padding:"8px",borderRadius:"4px",cursor:"pointer",fontSize:"13px"},modalOverlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10001},modal:{backgroundColor:"#36393f",borderRadius:"8px",padding:"24px",width:"90%",maxWidth:"500px",maxHeight:"80vh",overflowY:"auto"},modalTitle:{color:"#ffffff",marginBottom:"16px"},form:{display:"flex",flexDirection:"column",gap:"12px"},input:{width:"100%",backgroundColor:"#202225",border:"none",color:"#dcddde",padding:"10px",borderRadius:"4px",fontSize:"14px",outline:"none"},modalButtons:{display:"flex",gap:"8px",justifyContent:"flex-end",marginTop:"16px"},cancelButton:{backgroundColor:"transparent",color:"#ffffff",border:"none",padding:"8px 16px",borderRadius:"4px",cursor:"pointer"},submitButton:{backgroundColor:"#5865f2",color:"#ffffff",border:"none",padding:"8px 16px",borderRadius:"4px",cursor:"pointer",fontWeight:"500"},modalHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},modalClose:{background:"none",border:"none",color:"#b9bbbe",cursor:"pointer",padding:"4px"},modalContent:{display:"flex",flexDirection:"column",gap:"16px"},detailSection:{backgroundColor:"#2f3136",padding:"16px",borderRadius:"8px"},participantList:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(150px, 1fr))",gap:"8px"},participant:{backgroundColor:"#36393f",padding:"8px 12px",borderRadius:"4px",color:"#dcddde",fontSize:"13px",display:"flex",justifyContent:"space-between"},seed:{color:"#faa61a",fontWeight:"bold"}};export{_ as default};
