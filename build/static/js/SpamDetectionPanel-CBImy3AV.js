var A=Object.defineProperty;var d=(s,n)=>A(s,"name",{value:n,configurable:!0});import{j as e,r as g}from"./react-core-Djgtqrmb.js";import{a1 as m,ay as D,d as I,j as E,b3 as P,aB as z,cA as F,aC as M,B as w,a9 as h,a as b,aE as O,az as G}from"./icons-vendor-BMXAt4pj.js";import{g as T,t as v}from"./index-D0nbcjO7.js";import"./media-vendor-CxFPycob.js";import"./router-vendor-gmJ9Mn-1.js";import"./state-vendor-CbW2fAN9.js";import"./crypto-vendor-D1XRGppi.js";import"./ui-vendor-IhB9Znpc.js";const C={low:{messagesPerMinute:15,duplicateThreshold:5,mentionLimit:10,linkLimit:5,capsPercentage:80},medium:{messagesPerMinute:10,duplicateThreshold:3,mentionLimit:5,linkLimit:3,capsPercentage:70},high:{messagesPerMinute:7,duplicateThreshold:2,mentionLimit:3,linkLimit:2,capsPercentage:60},aggressive:{messagesPerMinute:5,duplicateThreshold:2,mentionLimit:2,linkLimit:1,capsPercentage:50}},K={rapidMessages:"HÄ±zlÄ± Mesaj",duplicateContent:"Tekrarlanan Ä°Ã§erik",mentionSpam:"Etiket Spam",linkSpam:"Link Spam",capsLock:"BÃœYÃœK HARF",zalgoText:"Zalgo Metin"},W={warn:"Uyar",mute:"Sustur",kick:"At",ban:"Yasakla"},L=d(s=>({rapidMessages:e.jsx(F,{}),duplicateContent:e.jsx(z,{}),mentionSpam:e.jsx(P,{}),linkSpam:e.jsx(E,{}),capsLock:e.jsx(I,{}),zalgoText:e.jsx(D,{})})[s]||e.jsx(m,{}),"getPatternIcon"),y=d(s=>({warn:"#faa61a",mute:"#5865f2",kick:"#f04747",ban:"#ed4245"})[s]||"#72767d","getActionColor"),k={totalDetected:0,todayDetected:0,actionsTaken:{warn:0,mute:0,kick:0,ban:0},topOffenders:[],recentDetections:[]},N=d(({serverId:s,fetchWithAuth:n,apiBaseUrl:a})=>{const[p,i]=g.useState({enabled:!0,sensitivity:"medium",actions:{warn:!0,mute:!0,kick:!1,ban:!1},patterns:{rapidMessages:!0,duplicateContent:!0,mentionSpam:!0,linkSpam:!0,capsLock:!0,zalgoText:!0},thresholds:C.medium,whitelist:[],customPatterns:[]}),[c,f]=g.useState(k),[o,x]=g.useState(!0),[R,B]=g.useState("overview"),S=g.useCallback(async()=>{x(!0);const r=a||T();try{const l=await n(`${r}/api/servers/${s}/spam-settings/`);if(l.ok){const u=await l.json();i(j=>({...j,...u}))}}catch{}try{const l=await n(`${r}/api/servers/${s}/spam-stats/`);if(l.ok){const u=await l.json();f(j=>({...j,...u}))}else f(k)}catch{f(k)}x(!1)},[s,n,a]);return g.useEffect(()=>{S()},[S]),{settings:p,stats:c,loading:o,activeTab:R,setActiveTab:B,handleSensitivityChange:d(r=>{i(l=>({...l,sensitivity:r,thresholds:C[r]}))},"handleSensitivityChange"),handlePatternToggle:d(r=>{i(l=>({...l,patterns:{...l.patterns,[r]:!l.patterns[r]}}))},"handlePatternToggle"),handleActionToggle:d(r=>{i(l=>({...l,actions:{...l.actions,[r]:!l.actions[r]}}))},"handleActionToggle"),toggleEnabled:d(()=>{i(r=>({...r,enabled:!r.enabled}))},"toggleEnabled"),saveSettings:d(async()=>{try{const r=a||T();(await n(`${r}/api/servers/${s}/spam-settings/`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)})).ok?v.success("Spam koruma ayarlarÄ± kaydedildi! âœ…"):v.error("Ayarlar kaydedilemedi")}catch{v.error("Bir hata oluÅŸtu")}},"saveSettings")}},"useSpamDetection"),t={container:{backgroundColor:"#2f3136",borderRadius:"8px",overflow:"hidden"},loading:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"16px",padding:"60px",color:"#b9bbbe"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #202225"},headerLeft:{display:"flex",alignItems:"center",gap:"16px"},headerRight:{display:"flex",alignItems:"center"},title:{margin:0,fontSize:"18px",fontWeight:"600",color:"#fff"},subtitle:{margin:"4px 0 0",fontSize:"13px",color:"#72767d"},statusBadge:{padding:"6px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},tabs:{display:"flex",padding:"0 20px",borderBottom:"1px solid #202225",gap:"8px"},tab:{display:"flex",alignItems:"center",gap:"8px",padding:"12px 16px",border:"none",borderRadius:"4px 4px 0 0",cursor:"pointer",fontSize:"13px",fontWeight:"500",transition:"all 0.15s"},content:{padding:"20px"},statsGrid:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"12px",marginBottom:"24px"},statCard:{display:"flex",alignItems:"center",gap:"12px",padding:"16px",backgroundColor:"#202225",borderRadius:"8px"},statIcon:{display:"flex",alignItems:"center",justifyContent:"center",width:"40px",height:"40px",backgroundColor:"#36393f",borderRadius:"8px"},statInfo:{flex:1},statValue:{fontSize:"20px",fontWeight:"700",color:"#fff"},statLabel:{fontSize:"12px",color:"#72767d"},section:{marginBottom:"24px"},sectionTitle:{margin:"0 0 16px",fontSize:"14px",fontWeight:"600",color:"#fff",textTransform:"uppercase",letterSpacing:"0.5px"},detectionsList:{display:"flex",flexDirection:"column",gap:"8px"},detectionItem:{display:"flex",alignItems:"center",gap:"12px",padding:"12px 16px",backgroundColor:"#202225",borderRadius:"6px"},detectionIcon:{color:"#faa61a"},detectionInfo:{flex:1},detectionUser:{display:"flex",alignItems:"center",gap:"8px",color:"#fff",fontSize:"14px"},detectionType:{fontSize:"11px",color:"#72767d",backgroundColor:"#40444b",padding:"2px 6px",borderRadius:"3px"},detectionMessage:{fontSize:"12px",color:"#72767d",marginTop:"4px"},actionBadge:{padding:"4px 10px",borderRadius:"4px",color:"#fff",fontSize:"11px",fontWeight:"600",textTransform:"uppercase"},offendersList:{display:"flex",flexDirection:"column",gap:"8px"},offenderItem:{display:"flex",alignItems:"center",gap:"12px",padding:"12px 16px",backgroundColor:"#202225",borderRadius:"6px"},offenderRank:{width:"28px",height:"28px",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#40444b",borderRadius:"50%",fontSize:"12px",fontWeight:"600",color:"#fff"},offenderInfo:{flex:1,display:"flex",flexDirection:"column"},offenderName:{color:"#fff",fontSize:"14px",fontWeight:"500"},offenderCount:{color:"#72767d",fontSize:"12px"},settingRow:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px",backgroundColor:"#202225",borderRadius:"8px",marginBottom:"16px"},settingInfo:{display:"flex",alignItems:"center",gap:"12px"},settingTitle:{color:"#fff",fontSize:"14px",fontWeight:"500"},settingDesc:{color:"#72767d",fontSize:"12px"},toggleButton:{width:"44px",height:"24px",border:"none",borderRadius:"12px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",transition:"background-color 0.2s"},sensitivityGrid:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"8px"},sensitivityButton:{padding:"12px",border:"2px solid transparent",borderRadius:"8px",cursor:"pointer",color:"#fff",fontSize:"13px",fontWeight:"500",transition:"all 0.15s"},patternsGrid:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"8px"},patternItem:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 16px",backgroundColor:"#202225",borderRadius:"6px"},patternInfo:{display:"flex",alignItems:"center",gap:"10px",color:"#dcddde",fontSize:"13px"},miniToggle:{width:"28px",height:"18px",border:"none",borderRadius:"9px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",transition:"background-color 0.2s"},actionsGrid:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"8px"},actionItem:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 16px",backgroundColor:"#202225",borderRadius:"6px"},actionInfo:{display:"flex",alignItems:"center",gap:"8px",color:"#dcddde",fontSize:"13px"},actionDot:{width:"8px",height:"8px",borderRadius:"50%"},saveButton:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",width:"100%",padding:"12px",backgroundColor:"#43b581",border:"none",borderRadius:"4px",color:"#fff",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"background-color 0.15s"},logsHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},filterSelect:{padding:"8px 12px",backgroundColor:"#202225",border:"1px solid #40444b",borderRadius:"4px",color:"#dcddde",fontSize:"13px"},logsList:{display:"flex",flexDirection:"column",gap:"8px"},logItem:{display:"flex",alignItems:"flex-start",gap:"12px",padding:"12px 16px",backgroundColor:"#202225",borderRadius:"6px"},logTime:{fontSize:"11px",color:"#72767d",whiteSpace:"nowrap"},logContent:{flex:1,fontSize:"13px",color:"#dcddde"},logMessage:{fontSize:"12px",color:"#72767d",marginTop:"4px",fontStyle:"italic"}},U=d(({stats:s,settings:n})=>e.jsxs("div",{style:t.content,children:[e.jsxs("div",{style:t.statsGrid,children:[e.jsxs("div",{style:t.statCard,children:[e.jsx("div",{style:t.statIcon,children:e.jsx(m,{size:20,color:"#43b581"})}),e.jsxs("div",{style:t.statInfo,children:[e.jsx("div",{style:t.statValue,children:s.totalDetected}),e.jsx("div",{style:t.statLabel,children:"Toplam Tespit"})]})]}),e.jsxs("div",{style:t.statCard,children:[e.jsx("div",{style:t.statIcon,children:e.jsx(I,{size:20,color:"#faa61a"})}),e.jsxs("div",{style:t.statInfo,children:[e.jsx("div",{style:t.statValue,children:s.todayDetected}),e.jsx("div",{style:t.statLabel,children:"BugÃ¼n"})]})]}),e.jsxs("div",{style:t.statCard,children:[e.jsx("div",{style:t.statIcon,children:e.jsx(M,{size:20,color:"#f04747"})}),e.jsxs("div",{style:t.statInfo,children:[e.jsx("div",{style:t.statValue,children:s.actionsTaken?.ban||0}),e.jsx("div",{style:t.statLabel,children:"Ban"})]})]}),e.jsxs("div",{style:t.statCard,children:[e.jsx("div",{style:t.statIcon,children:e.jsx(w,{size:20,color:"#5865f2"})}),e.jsxs("div",{style:t.statInfo,children:[e.jsx("div",{style:t.statValue,children:Object.values(n.patterns).filter(Boolean).length}),e.jsx("div",{style:t.statLabel,children:"Aktif Kural"})]})]})]}),e.jsxs("div",{style:t.section,children:[e.jsx("h3",{style:t.sectionTitle,children:"Son Tespitler"}),e.jsx("div",{style:t.detectionsList,children:s.recentDetections.map((a,p)=>e.jsxs("div",{style:t.detectionItem,children:[e.jsx("div",{style:t.detectionIcon,children:L(a.type)}),e.jsxs("div",{style:t.detectionInfo,children:[e.jsxs("div",{style:t.detectionUser,children:[e.jsx("strong",{children:a.username}),e.jsx("span",{style:t.detectionType,children:a.type})]}),e.jsxs("div",{style:t.detectionMessage,children:[a.message.substring(0,50),"..."]})]}),e.jsx("div",{style:{...t.actionBadge,backgroundColor:y(a.action)},children:a.action})]},p))})]}),e.jsxs("div",{style:t.section,children:[e.jsx("h3",{style:t.sectionTitle,children:"En Ã‡ok Ä°hlal Edenler"}),e.jsx("div",{style:t.offendersList,children:s.topOffenders.map((a,p)=>e.jsxs("div",{style:t.offenderItem,children:[e.jsx("div",{style:t.offenderRank,children:p+1}),e.jsxs("div",{style:t.offenderInfo,children:[e.jsx("span",{style:t.offenderName,children:a.username}),e.jsxs("span",{style:t.offenderCount,children:[a.count," ihlal"]})]}),e.jsx("div",{style:{...t.actionBadge,backgroundColor:y(a.lastAction)},children:a.lastAction})]},p))})]})]}),"OverviewTab"),H=d(({settings:s,isAdmin:n,onSensitivityChange:a,onPatternToggle:p,onActionToggle:i,onToggleEnabled:c,onSave:f})=>e.jsxs("div",{style:t.content,children:[e.jsxs("div",{style:t.settingRow,children:[e.jsxs("div",{style:t.settingInfo,children:[e.jsx(m,{size:18,color:"#43b581"}),e.jsxs("div",{children:[e.jsx("div",{style:t.settingTitle,children:"Spam KorumasÄ±"}),e.jsx("div",{style:t.settingDesc,children:"Otomatik spam algÄ±lama ve Ã¶nleme"})]})]}),e.jsx("button",{style:{...t.toggleButton,backgroundColor:s.enabled?"#43b581":"#72767d"},onClick:c,children:s.enabled?e.jsx(h,{}):e.jsx(b,{})})]}),e.jsxs("div",{style:t.section,children:[e.jsx("h3",{style:t.sectionTitle,children:"Hassasiyet Seviyesi"}),e.jsx("div",{style:t.sensitivityGrid,children:[{key:"low",label:"ðŸ¢ DÃ¼ÅŸÃ¼k"},{key:"medium",label:"âš–ï¸ Orta"},{key:"high",label:"ðŸ”¥ YÃ¼ksek"},{key:"aggressive",label:"âš¡ Agresif"}].map(({key:o,label:x})=>e.jsx("button",{style:{...t.sensitivityButton,backgroundColor:s.sensitivity===o?"#5865f2":"#40444b",borderColor:s.sensitivity===o?"#5865f2":"transparent"},onClick:d(()=>a(o),"onClick"),children:x},o))})]}),e.jsxs("div",{style:t.section,children:[e.jsx("h3",{style:t.sectionTitle,children:"AlgÄ±lama KalÄ±plarÄ±"}),e.jsx("div",{style:t.patternsGrid,children:Object.entries(s.patterns).map(([o,x])=>e.jsxs("div",{style:t.patternItem,children:[e.jsxs("div",{style:t.patternInfo,children:[L(o),e.jsx("span",{children:K[o]||o})]}),e.jsx("button",{style:{...t.miniToggle,backgroundColor:x?"#43b581":"#72767d"},onClick:d(()=>p(o),"onClick"),children:x?e.jsx(h,{size:10}):e.jsx(b,{size:10})})]},o))})]}),e.jsxs("div",{style:t.section,children:[e.jsx("h3",{style:t.sectionTitle,children:"Otomatik Eylemler"}),e.jsx("div",{style:t.actionsGrid,children:Object.entries(s.actions).map(([o,x])=>e.jsxs("div",{style:t.actionItem,children:[e.jsxs("div",{style:t.actionInfo,children:[e.jsx("div",{style:{...t.actionDot,backgroundColor:y(o)}}),e.jsx("span",{children:W[o]||o})]}),e.jsx("button",{style:{...t.miniToggle,backgroundColor:x?"#43b581":"#72767d"},onClick:d(()=>i(o),"onClick"),children:x?e.jsx(h,{size:10}):e.jsx(b,{size:10})})]},o))})]}),n&&e.jsxs("button",{style:t.saveButton,onClick:f,children:[e.jsx(h,{})," AyarlarÄ± Kaydet"]})]}),"SettingsTab"),V=d(({stats:s})=>e.jsxs("div",{style:t.content,children:[e.jsxs("div",{style:t.logsHeader,children:[e.jsx("h3",{style:t.sectionTitle,children:"Spam KayÄ±tlarÄ±"}),e.jsxs("select",{style:t.filterSelect,children:[e.jsx("option",{value:"all",children:"TÃ¼m Eylemler"}),e.jsx("option",{value:"warn",children:"UyarÄ±lar"}),e.jsx("option",{value:"mute",children:"Susturmalar"}),e.jsx("option",{value:"kick",children:"Atmalar"}),e.jsx("option",{value:"ban",children:"Yasaklamalar"})]})]}),e.jsx("div",{style:t.logsList,children:s.recentDetections.map((n,a)=>e.jsxs("div",{style:t.logItem,children:[e.jsx("div",{style:t.logTime,children:new Date(n.timestamp).toLocaleString("tr-TR")}),e.jsxs("div",{style:t.logContent,children:[e.jsx("strong",{children:n.username})," - ",n.type,e.jsxs("div",{style:t.logMessage,children:['"',n.message,'"']})]}),e.jsx("div",{style:{...t.actionBadge,backgroundColor:y(n.action)},children:n.action})]},a))})]}),"LogsTab"),oe=d(({serverId:s,fetchWithAuth:n,apiBaseUrl:a,isAdmin:p=!1})=>{const i=N({serverId:s,fetchWithAuth:n,apiBaseUrl:a});return i.loading?e.jsx("div",{style:t.container,children:e.jsxs("div",{style:t.loading,children:[e.jsx(w,{className:"pulse",size:32,color:"#5865f2"}),e.jsx("span",{children:"Spam koruma sistemi yÃ¼kleniyor..."})]})}):e.jsxs("div",{style:t.container,children:[e.jsxs("div",{style:t.header,children:[e.jsxs("div",{style:t.headerLeft,children:[e.jsx(m,{size:24,color:"#43b581"}),e.jsxs("div",{children:[e.jsx("h2",{style:t.title,children:"Spam Koruma Sistemi"}),e.jsx("p",{style:t.subtitle,children:"ML tabanlÄ± akÄ±llÄ± spam algÄ±lama"})]})]}),e.jsx("div",{style:t.headerRight,children:e.jsx("div",{style:{...t.statusBadge,backgroundColor:i.settings.enabled?"rgba(67, 181, 129, 0.2)":"rgba(240, 71, 71, 0.2)",color:i.settings.enabled?"#43b581":"#f04747"},children:i.settings.enabled?"âœ“ Aktif":"âœ— KapalÄ±"})})]}),e.jsx("div",{style:t.tabs,children:["overview","settings","logs"].map(c=>e.jsxs("button",{style:{...t.tab,backgroundColor:i.activeTab===c?"#5865f2":"transparent",color:i.activeTab===c?"#fff":"#b9bbbe"},onClick:d(()=>i.setActiveTab(c),"onClick"),children:[c==="overview"&&e.jsx(O,{}),c==="settings"&&e.jsx(G,{}),c==="logs"&&e.jsx(z,{}),c==="overview"?"Genel BakÄ±ÅŸ":c==="settings"?"Ayarlar":"KayÄ±tlar"]},c))}),i.activeTab==="overview"&&e.jsx(U,{stats:i.stats,settings:i.settings}),i.activeTab==="settings"&&e.jsx(H,{settings:i.settings,isAdmin:p,onSensitivityChange:i.handleSensitivityChange,onPatternToggle:i.handlePatternToggle,onActionToggle:i.handleActionToggle,onToggleEnabled:i.toggleEnabled,onSave:i.saveSettings}),i.activeTab==="logs"&&e.jsx(V,{stats:i.stats})]})},"SpamDetectionPanel");export{oe as default};
