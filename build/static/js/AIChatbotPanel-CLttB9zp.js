import{r as c,a0 as b,d0 as N,I as f,bn as k,aK as T,cl as D}from"./react-core-B6hadH-M.js";import{t as l}from"./index-D_6pZib5.js";const q=({username:S,apiBaseUrl:u,fetchWithAuth:d,currentRoomSlug:z})=>{const[n,E]=c.useState("chat"),[y,R]=c.useState([]),[o,i]=c.useState(""),[m,r]=c.useState(!1),[p,C]=c.useState({used:0,limit:100}),[v,w]=c.useState([]),g=c.useRef(null);c.useEffect(()=>{h()},[]),c.useEffect(()=>{A()},[y]);const A=()=>{g.current?.scrollIntoView({behavior:"smooth"})},h=async()=>{try{const a=await(await d(`${u}/ai/quota/`)).json();C(a)}catch(e){console.error("Failed to fetch AI quota:",e)}},I=async e=>{if(e.preventDefault(),!o.trim()||m)return;const a=o.trim();i(""),R(t=>[...t,{role:"user",content:a,timestamp:new Date}]),r(!0);try{const s=await(await d(`${u}/ai/chat/`,{method:"POST",body:JSON.stringify({message:a,context:z||"general"})})).json();R(O=>[...O,{role:"assistant",content:s.response,timestamp:new Date}]),h(),l.success("ğŸ¤– AI yanÄ±tladÄ±!")}catch(t){console.error("AI chat error:",t),l.error("âŒ AI hatasÄ±!"),R(s=>[...s,{role:"assistant",content:"ÃœzgÃ¼nÃ¼m, bir hata oluÅŸtu.",timestamp:new Date,error:!0}])}finally{r(!1)}},j=async e=>{r(!0);try{const t=await(await d(`${u}/ai/smart-reply/`,{method:"POST",body:JSON.stringify({message_id:e,count:3})})).json();w(t.suggestions||[]),l.success("ğŸ’¡ AkÄ±llÄ± cevaplar hazÄ±r!")}catch(a){console.error("Smart reply error:",a),l.error("âŒ AkÄ±llÄ± cevap hatasÄ±!")}finally{r(!1)}},$=async e=>{r(!0);try{const t=await(await d(`${u}/ai/summarize/`,{method:"POST",body:JSON.stringify({message_ids:e,max_length:200})})).json();R(s=>[...s,{role:"assistant",content:`ğŸ“ **Ã–zet:**

${t.summary}`,timestamp:new Date,type:"summary"}]),l.success("ğŸ“ Mesajlar Ã¶zetlendi!")}catch(a){console.error("Summarize error:",a),l.error("âŒ Ã–zetleme hatasÄ±!")}finally{r(!1)}},K=async e=>{r(!0);try{const t=await(await d(`${u}/ai/code/`,{method:"POST",body:JSON.stringify({prompt:e,language:"javascript"})})).json();R(s=>[...s,{role:"assistant",content:`\`\`\`${t.language}
${t.code}
\`\`\`

${t.explanation||""}`,timestamp:new Date,type:"code"}]),l.success("ğŸ’» Kod oluÅŸturuldu!")}catch(a){console.error("Code generation error:",a),l.error("âŒ Kod Ã¼retme hatasÄ±!")}finally{r(!1)}},x=()=>{const e=p.used/p.limit*100,a=e>90?"#ed4245":e>70?"#faa61a":"#43b581";return React.createElement("div",{className:"ai-quota-container"},React.createElement("div",{className:"ai-quota-info"},React.createElement(D,null),React.createElement("span",null,"AI KullanÄ±m: ",p.used," / ",p.limit)),React.createElement("div",{className:"ai-quota-bar"},React.createElement("div",{className:"ai-quota-fill",style:{width:`${e}%`,backgroundColor:a}})))};return React.createElement("div",{className:"ai-chatbot-panel"},React.createElement("div",{className:"ai-header"},React.createElement("div",{className:"ai-header-left"},React.createElement(b,{size:28}),React.createElement("div",null,React.createElement("h3",{className:"ai-title"},"AI Assistant"),React.createElement("p",{className:"ai-subtitle"},"Discord'u geÃ§en AI Ã¶zellikleri"))),x()),React.createElement("div",{className:"ai-tabs"},React.createElement("button",{className:n==="chat"?"active":"",onClick:()=>E("chat")},React.createElement(b,null)," Chat"),React.createElement("button",{className:n==="smart-reply"?"active":"",onClick:()=>E("smart-reply")},React.createElement(N,null)," Smart Reply"),React.createElement("button",{className:n==="summarize"?"active":"",onClick:()=>E("summarize")},React.createElement(f,null)," Ã–zetle"),React.createElement("button",{className:n==="code"?"active":"",onClick:()=>E("code")},React.createElement(k,null)," Kod OluÅŸtur")),n==="chat"&&React.createElement("div",{className:"ai-chat-container"},React.createElement("div",{className:"ai-messages"},y.length===0?React.createElement("div",{className:"ai-empty-state"},React.createElement(b,{size:48}),React.createElement("h4",null,"AI Assistant'a HoÅŸ Geldin!"),React.createElement("p",null,"Soru sor, kod yazdÄ±r, mesajlarÄ± Ã¶zetle veya aÃ§Ä±klama iste."),React.createElement("div",{className:"ai-suggestions"},React.createElement("button",{onClick:()=>i("JavaScript ile bir todo list nasÄ±l yapÄ±lÄ±r?")},"ğŸ’» Kod Ã¶rneÄŸi iste"),React.createElement("button",{onClick:()=>i("React hooks nedir?")},"ğŸ“ Kavram aÃ§Ä±kla"),React.createElement("button",{onClick:()=>i("BugÃ¼n hava nasÄ±l?")},"ğŸ’¬ Sohbet et"))):y.map((e,a)=>React.createElement("div",{key:a,className:`ai-message ${e.role} ${e.error?"error":""}`},React.createElement("div",{className:"ai-message-avatar"},e.role==="user"?"ğŸ‘¤":"ğŸ¤–"),React.createElement("div",{className:"ai-message-content"},React.createElement("div",{className:"ai-message-header"},React.createElement("strong",null,e.role==="user"?S:"AI Assistant"),React.createElement("span",{className:"ai-message-time"},e.timestamp.toLocaleTimeString("tr-TR",{hour:"2-digit",minute:"2-digit"}))),React.createElement("div",{className:"ai-message-text"},e.content.split("```").map((t,s)=>s%2===0?React.createElement("span",{key:s},t):React.createElement("pre",{key:s,className:"ai-code-block"},React.createElement("code",null,t))))))),React.createElement("div",{ref:g})),React.createElement("form",{onSubmit:I,className:"ai-input-form"},React.createElement("input",{type:"text",value:o,onChange:e=>i(e.target.value),placeholder:"AI'ya bir ÅŸey sor...",disabled:m,className:"ai-input"}),React.createElement("button",{type:"submit",disabled:m||!o.trim(),className:"ai-send-btn"},m?"â³":React.createElement(T,null)))),n==="smart-reply"&&React.createElement("div",{className:"ai-feature-container"},React.createElement("div",{className:"ai-feature-header"},React.createElement(N,{size:32}),React.createElement("h4",null,"AkÄ±llÄ± Cevap Ã–nerileri"),React.createElement("p",null,"Mesajlara otomatik yanÄ±t Ã¶nerileri")),React.createElement("button",{onClick:()=>j("last-message-id"),disabled:m,className:"ai-action-btn"},"ğŸ’¡ Son Mesaja AkÄ±llÄ± Cevap Ã–ner"),v.length>0&&React.createElement("div",{className:"ai-smart-replies"},React.createElement("h5",null,"Ã–nerilen Cevaplar:"),v.map((e,a)=>React.createElement("div",{key:a,className:"ai-smart-reply-item"},React.createElement("span",null,e),React.createElement("button",{onClick:()=>i(e)},"Kullan"))))),n==="summarize"&&React.createElement("div",{className:"ai-feature-container"},React.createElement("div",{className:"ai-feature-header"},React.createElement(f,{size:32}),React.createElement("h4",null,"Mesaj Ã–zetleme"),React.createElement("p",null,"Uzun konuÅŸmalarÄ± tek paragrafta Ã¶zetle")),React.createElement("button",{onClick:()=>$(["msg1","msg2","msg3"]),disabled:m,className:"ai-action-btn"},"ğŸ“ Son 50 MesajÄ± Ã–zetle")),n==="code"&&React.createElement("div",{className:"ai-feature-container"},React.createElement("div",{className:"ai-feature-header"},React.createElement(k,{size:32}),React.createElement("h4",null,"Kod Ãœretimi"),React.createElement("p",null,"AI ile kod yaz, GitHub Copilot gibi")),React.createElement("form",{onSubmit:e=>{e.preventDefault(),K(o)},className:"ai-code-form"},React.createElement("textarea",{value:o,onChange:e=>i(e.target.value),placeholder:"Ne yapmak istiyorsun? Ã–rn: 'React'te bir sayaÃ§ komponenti yap'",rows:4,className:"ai-code-textarea"}),React.createElement("button",{type:"submit",disabled:m||!o.trim(),className:"ai-action-btn"},"ğŸ’» Kod Ãœret"))))};export{q as default};
