var S=Object.defineProperty;var r=(o,n)=>S(o,"name",{value:n,configurable:!0});import{r as m,j as e}from"./react-core-Djgtqrmb.js";import{ay as k,d as w,w as C,a1 as R,a0 as B,a as F,a5 as I}from"./icons-vendor-BW7dxHkX.js";import{t as u}from"./index-BT6pEMKq.js";import"./media-vendor-CxFPycob.js";import"./router-vendor-ClgLnMjk.js";import"./state-vendor-BRqaXHJQ.js";import"./crypto-vendor-D1XRGppi.js";import"./ui-vendor-IhB9Znpc.js";const t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999},modal:{backgroundColor:"#1e1e1e",borderRadius:"8px",width:"90%",maxWidth:"900px",maxHeight:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 8px 32px rgba(0,0,0,0.4)"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #2c2f33"},headerLeft:{display:"flex",alignItems:"center"},title:{margin:0,fontSize:"20px",color:"#ffffff"},closeButton:{background:"none",border:"none",color:"#99aab5",cursor:"pointer",fontSize:"20px",padding:"5px"},filters:{display:"flex",gap:"10px",padding:"15px 20px",borderBottom:"1px solid #2c2f33",flexWrap:"wrap"},filterButton:{padding:"8px 16px",backgroundColor:"#2c2f33",border:"none",borderRadius:"4px",color:"#ffffff",cursor:"pointer",fontSize:"14px",transition:"background-color 0.2s"},filterButtonActive:{backgroundColor:"#5865f2"},exportButton:{marginLeft:"auto",padding:"8px 16px",backgroundColor:"#43b581",border:"none",borderRadius:"4px",color:"#ffffff",cursor:"pointer",fontSize:"14px",display:"flex",alignItems:"center"},content:{padding:"20px",overflowY:"auto",flex:1},loading:{textAlign:"center",color:"#99aab5",padding:"40px"},empty:{textAlign:"center",color:"#99aab5",padding:"40px"},resultsList:{display:"flex",flexDirection:"column",gap:"15px"},resultCard:{backgroundColor:"#2c2f33",borderRadius:"6px",padding:"15px"},resultHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},resultStatus:{display:"flex",alignItems:"center",fontSize:"14px"},timestamp:{fontSize:"12px",color:"#99aab5"},resultBody:{display:"flex",flexDirection:"column",gap:"15px"},resultInfo:{display:"flex",flexDirection:"column",gap:"8px"},infoRow:{display:"flex",alignItems:"center",gap:"10px",fontSize:"14px",color:"#dcddde"},progressBar:{flex:1,height:"8px",backgroundColor:"#1e1e1e",borderRadius:"4px",overflow:"hidden"},progressFill:{height:"100%",transition:"width 0.3s"},flags:{display:"flex",flexWrap:"wrap",gap:"5px"},flag:{padding:"4px 8px",backgroundColor:"#f04747",borderRadius:"4px",fontSize:"12px",color:"#ffffff"},actions:{display:"flex",gap:"10px",justifyContent:"flex-end"},actionButton:{padding:"8px 16px",border:"none",borderRadius:"4px",color:"#ffffff",cursor:"pointer",fontSize:"14px",display:"flex",alignItems:"center"},approveButton:{backgroundColor:"#43b581"},blockButton:{backgroundColor:"#f04747"},ignoreButton:{backgroundColor:"#99aab5"}},_=r((o,n,l)=>{const[a,c]=m.useState([]),[d,y]=m.useState(!1),[p,j]=m.useState("all"),h=r(async()=>{y(!0);try{const i=l?`${n}/messages/${l}/scan_results/`:`${n}/content_scanner/results/`,b=await(await o(i)).json();c(b.results||[])}catch{u.error("Failed to load scan results")}finally{y(!1)}},"fetchResults");m.useEffect(()=>{h()},[l]);const v=r(async()=>{try{const f=await(await o(`${n}/content_scanner/export/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filter:p})})).blob(),b=window.URL.createObjectURL(f),g=document.createElement("a");g.href=b,g.download=`scan_results_${new Date().toISOString()}.csv`,document.body.appendChild(g),g.click(),g.remove(),u.success("Results exported successfully")}catch{u.error("Failed to export results")}},"exportResults"),s=r(async(i,f)=>{try{await o(`${n}/content_scanner/results/${i}/review/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:f})}),u.success(`Content ${f}ed successfully`),h()}catch{u.error("Failed to review content")}},"reviewResult"),x=a.filter(i=>p==="all"||i.status===p);return{scanResults:a,filteredResults:x,loading:d,filter:p,setFilter:j,exportResults:v,reviewResult:s}},"useContentScanner"),L={safe:{icon:C,color:"#43b581"},flagged:{icon:w,color:"#faa61a"},blocked:{icon:k,color:"#f04747"}},z=r(({result:o,onReview:n})=>{const l=L[o.status]||{icon:R,color:"#99aab5"},a=l.icon;return e.jsxs("div",{style:t.resultCard,children:[e.jsxs("div",{style:t.resultHeader,children:[e.jsxs("div",{style:t.resultStatus,children:[e.jsx(a,{style:{color:l.color}}),e.jsx("span",{style:{marginLeft:"8px",color:l.color,fontWeight:"600"},children:o.status.toUpperCase()})]}),e.jsx("div",{style:t.timestamp,children:new Date(o.scanned_at).toLocaleString()})]}),e.jsxs("div",{style:t.resultBody,children:[e.jsxs("div",{style:t.resultInfo,children:[e.jsxs("div",{style:t.infoRow,children:[e.jsx("strong",{children:"Type:"})," ",o.content_type]}),o.confidence_score&&e.jsxs("div",{style:t.infoRow,children:[e.jsx("strong",{children:"Confidence:"}),e.jsx("div",{style:t.progressBar,children:e.jsx("div",{style:{...t.progressFill,width:`${o.confidence_score}%`,backgroundColor:o.confidence_score>80?"#f04747":o.confidence_score>50?"#faa61a":"#43b581"}})}),e.jsxs("span",{children:[o.confidence_score,"%"]})]}),o.flags?.length>0&&e.jsxs("div",{style:t.infoRow,children:[e.jsx("strong",{children:"Flags:"}),e.jsx("div",{style:t.flags,children:o.flags.map((c,d)=>e.jsx("span",{style:t.flag,children:c},d))})]}),o.reason&&e.jsxs("div",{style:t.infoRow,children:[e.jsx("strong",{children:"Reason:"})," ",o.reason]})]}),o.status==="flagged"&&e.jsxs("div",{style:t.actions,children:[e.jsxs("button",{onClick:r(()=>n(o.id,"approve"),"onClick"),style:{...t.actionButton,...t.approveButton},children:[e.jsx(C,{style:{marginRight:"5px"}})," Approve"]}),e.jsxs("button",{onClick:r(()=>n(o.id,"block"),"onClick"),style:{...t.actionButton,...t.blockButton},children:[e.jsx(k,{style:{marginRight:"5px"}})," Block"]}),e.jsxs("button",{onClick:r(()=>n(o.id,"ignore"),"onClick"),style:{...t.actionButton,...t.ignoreButton},children:[e.jsx(B,{style:{marginRight:"5px"}})," Ignore"]})]})]})]})},"ScanResultCard"),T=[{key:"all",label:"All",icon:""},{key:"safe",label:"Safe",icon:"âœ… "},{key:"flagged",label:"Flagged",icon:"âš ï¸ "},{key:"blocked",label:"Blocked",icon:"ðŸš« "}],W=r(({fetchWithAuth:o,apiBaseUrl:n,onClose:l,messageId:a})=>{const{scanResults:c,filteredResults:d,loading:y,filter:p,setFilter:j,exportResults:h,reviewResult:v}=_(o,n,a);return e.jsx("div",{style:t.overlay,children:e.jsxs("div",{style:t.modal,children:[e.jsxs("div",{style:t.header,children:[e.jsxs("div",{style:t.headerLeft,children:[e.jsx(R,{style:{marginRight:"10px",color:"#5865f2"}}),e.jsx("h2",{style:t.title,children:"Content Scanner Results"})]}),e.jsx("button",{onClick:l,style:t.closeButton,children:e.jsx(F,{})})]}),e.jsxs("div",{style:t.filters,children:[T.map(s=>e.jsxs("button",{onClick:r(()=>j(s.key),"onClick"),style:{...t.filterButton,...p===s.key&&t.filterButtonActive},children:[s.icon,s.label," (",s.key==="all"?c.length:c.filter(x=>x.status===s.key).length,")"]},s.key)),e.jsxs("button",{onClick:h,style:t.exportButton,children:[e.jsx(I,{style:{marginRight:"5px"}})," Export"]})]}),e.jsx("div",{style:t.content,children:y?e.jsx("div",{style:t.loading,children:"Loading scan results..."}):d.length===0?e.jsx("div",{style:t.empty,children:"No scan results found"}):e.jsx("div",{style:t.resultsList,children:d.map((s,x)=>e.jsx(z,{result:s,onReview:v},x))})})]})})},"ContentScannerPanel");export{W as default};
