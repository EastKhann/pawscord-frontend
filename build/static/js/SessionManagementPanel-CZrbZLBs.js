var v=Object.defineProperty;var o=(n,i)=>v(n,"name",{value:i,configurable:!0});import{r as c,j as e}from"./react-core-Djgtqrmb.js";import{bD as p,a as b,bE as j,z as S,f as k,aX as C,ae as I}from"./icons-vendor-BW7dxHkX.js";import{t as r}from"./index-Dy0QUtja.js";import"./media-vendor-CxFPycob.js";import"./router-vendor-ClgLnMjk.js";import"./state-vendor-BRqaXHJQ.js";import"./crypto-vendor-D1XRGppi.js";import"./ui-vendor-IhB9Znpc.js";const T=o(({fetchWithAuth:n,apiBaseUrl:i,onClose:f})=>{const[l,u]=c.useState([]),[y,x]=c.useState(!1);c.useEffect(()=>{d()},[]);const d=o(async()=>{x(!0);try{const a=await(await n(`${i}/sessions/list/`)).json();u(a.sessions||[])}catch{r.error("Failed to load sessions")}finally{x(!1)}},"fetchSessions"),g=o(async t=>{if(confirm("Are you sure you want to sign out this device?"))try{await n(`${i}/sessions/revoke/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_id:t})}),r.success("Session revoked successfully"),d()}catch{r.error("Failed to revoke session")}},"revokeSession"),m=o(async()=>{if(confirm("This will sign you out from ALL devices except this one. Continue?"))try{await n(`${i}/security/sessions/revoke-all/`,{method:"POST"}),r.success("All other sessions revoked"),d()}catch{r.error("Failed to revoke sessions")}},"revokeAllSessions"),h=o(t=>{switch(t){case"mobile":return e.jsx(I,{style:{fontSize:"24px",color:"#5865f2"}});case"tablet":return e.jsx(C,{style:{fontSize:"24px",color:"#5865f2"}});default:return e.jsx(p,{style:{fontSize:"24px",color:"#5865f2"}})}},"getDeviceIcon");return e.jsx("div",{style:s.overlay,children:e.jsxs("div",{style:s.modal,children:[e.jsxs("div",{style:s.header,children:[e.jsxs("div",{style:s.headerLeft,children:[e.jsx(p,{style:{marginRight:"10px",color:"#5865f2"}}),e.jsx("h2",{style:s.title,children:"Active Sessions"})]}),e.jsx("button",{onClick:f,style:s.closeButton,children:e.jsx(b,{})})]}),e.jsxs("div",{style:s.toolbar,children:[e.jsxs("div",{style:s.sessionCount,children:[l.length," active ",l.length===1?"session":"sessions"]}),e.jsx("button",{onClick:m,style:s.revokeAllButton,children:"Sign Out All Other Devices"})]}),e.jsx("div",{style:s.content,children:y?e.jsx("div",{style:s.loading,children:"Loading sessions..."}):l.length===0?e.jsx("div",{style:s.empty,children:"No active sessions found"}):e.jsx("div",{style:s.sessionsList,children:l.map((t,a)=>e.jsxs("div",{style:{...s.sessionCard,...t.is_current&&s.currentSession},children:[e.jsx("div",{style:s.sessionIcon,children:h(t.device_type)}),e.jsxs("div",{style:s.sessionInfo,children:[e.jsxs("div",{style:s.sessionDevice,children:[t.device_name||"Unknown Device",t.is_current&&e.jsx("span",{style:s.currentBadge,children:"Current Session"})]}),e.jsxs("div",{style:s.sessionDetails,children:[e.jsxs("div",{style:s.detailItem,children:[e.jsx(j,{style:{marginRight:"5px",fontSize:"12px"}}),t.location||"Unknown Location"]}),e.jsxs("div",{style:s.detailItem,children:[e.jsx(S,{style:{marginRight:"5px",fontSize:"12px"}}),"Last active: ",new Date(t.last_activity).toLocaleString()]}),t.ip_address&&e.jsxs("div",{style:s.detailItem,children:["IP: ",t.ip_address]})]})]}),!t.is_current&&e.jsx("button",{onClick:o(()=>g(t.id),"onClick"),style:s.revokeButton,title:"Sign Out",children:e.jsx(k,{})})]},a))})})]})})},"SessionManagementPanel"),s={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999},modal:{backgroundColor:"#1e1e1e",borderRadius:"8px",width:"90%",maxWidth:"700px",maxHeight:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #2c2f33"},headerLeft:{display:"flex",alignItems:"center"},title:{margin:0,fontSize:"20px",color:"#ffffff"},closeButton:{background:"none",border:"none",color:"#99aab5",cursor:"pointer",fontSize:"20px",padding:"5px"},toolbar:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"15px 20px",borderBottom:"1px solid #2c2f33"},sessionCount:{fontSize:"14px",color:"#dcddde"},revokeAllButton:{padding:"8px 16px",backgroundColor:"#f04747",border:"none",borderRadius:"4px",color:"#ffffff",cursor:"pointer",fontSize:"13px",fontWeight:"500"},content:{padding:"20px",overflowY:"auto",flex:1},loading:{textAlign:"center",color:"#99aab5",padding:"40px"},empty:{textAlign:"center",color:"#99aab5",padding:"40px"},sessionsList:{display:"flex",flexDirection:"column",gap:"16px"},sessionCard:{backgroundColor:"#2c2f33",borderRadius:"8px",padding:"16px",display:"flex",gap:"16px",alignItems:"flex-start"},currentSession:{border:"2px solid #43b581"},sessionIcon:{minWidth:"40px",display:"flex",alignItems:"center",justifyContent:"center"},sessionInfo:{flex:1},sessionDevice:{fontSize:"16px",fontWeight:"600",color:"#ffffff",marginBottom:"8px",display:"flex",alignItems:"center",gap:"12px"},currentBadge:{fontSize:"11px",padding:"4px 8px",backgroundColor:"#43b581",borderRadius:"4px",fontWeight:"600"},sessionDetails:{display:"flex",flexDirection:"column",gap:"4px"},detailItem:{fontSize:"13px",color:"#99aab5",display:"flex",alignItems:"center"},revokeButton:{background:"none",border:"none",color:"#f04747",cursor:"pointer",fontSize:"18px",padding:"8px"}};export{T as default};
