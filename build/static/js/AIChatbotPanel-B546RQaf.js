var V=Object.defineProperty;var l=(g,m)=>V(g,"name",{value:m,configurable:!0});import{r as s,j as e}from"./react-core-Djgtqrmb.js";import{t as d}from"./index-BRQzOq3v.js";import{B as v,c5 as S,r as z,b1 as w,aZ as Z,aE as X}from"./icons-vendor-BW7dxHkX.js";import"./media-vendor-CxFPycob.js";import"./router-vendor-gmJ9Mn-1.js";import"./state-vendor-BRqaXHJQ.js";import"./crypto-vendor-D1XRGppi.js";import"./ui-vendor-IhB9Znpc.js";const Y=l(({username:g,apiBaseUrl:m,fetchWithAuth:j,currentRoomSlug:A})=>{const[r,p]=s.useState("chat"),[y,x]=s.useState([]),[c,h]=s.useState(""),[u,o]=s.useState(!1),[b,I]=s.useState({used:0,limit:100}),[N,R]=s.useState([]),C=s.useRef(null);s.useEffect(()=>{f()},[]),s.useEffect(()=>{T()},[y]);const T=l(()=>{C.current?.scrollIntoView({behavior:"smooth"})},"scrollToBottom"),f=l(async()=>{try{const t=await(await j(`${m}/ai/quota/`)).json();I(t)}catch{}},"fetchQuota"),$=l(async a=>{if(a.preventDefault(),!c.trim()||u)return;const t=c.trim();h(""),x(n=>[...n,{role:"user",content:t,timestamp:new Date}]),o(!0);try{const i=await(await j(`${m}/ai/chat/`,{method:"POST",body:JSON.stringify({message:t,context:A||"general"})})).json();x(B=>[...B,{role:"assistant",content:i.response,timestamp:new Date}]),f(),d.success("ğŸ¤– AI yanÄ±tladÄ±!")}catch{d.error("âŒ AI hatasÄ±!"),x(i=>[...i,{role:"assistant",content:"ÃœzgÃ¼nÃ¼m, bir hata oluÅŸtu.",timestamp:new Date,error:!0}])}finally{o(!1)}},"handleAIChat"),K=l(async a=>{o(!0);try{const n=await(await j(`${m}/ai/smart-reply/`,{method:"POST",body:JSON.stringify({message_id:a,count:3})})).json();R(n.suggestions||[]),d.success("ğŸ’¡ AkÄ±llÄ± cevaplar hazÄ±r!")}catch{d.error("âŒ AkÄ±llÄ± cevap hatasÄ±!")}finally{o(!1)}},"handleSmartReply"),O=l(async a=>{o(!0);try{const n=await(await j(`${m}/ai/summarize/`,{method:"POST",body:JSON.stringify({message_ids:a,max_length:200})})).json();x(i=>[...i,{role:"assistant",content:`ğŸ“ **Ã–zet:**

${n.summary}`,timestamp:new Date,type:"summary"}]),d.success("ğŸ“ Mesajlar Ã¶zetlendi!")}catch{d.error("âŒ Ã–zetleme hatasÄ±!")}finally{o(!1)}},"handleSummarize"),D=l(async a=>{o(!0);try{const n=await(await j(`${m}/ai/code/`,{method:"POST",body:JSON.stringify({prompt:a,language:"javascript"})})).json();x(i=>[...i,{role:"assistant",content:`\`\`\`${n.language}
${n.code}
\`\`\`

${n.explanation||""}`,timestamp:new Date,type:"code"}]),d.success("ğŸ’» Kod oluÅŸturuldu!")}catch{d.error("âŒ Kod Ã¼retme hatasÄ±!")}finally{o(!1)}},"handleCodeGeneration"),F=s.useCallback(()=>p("chat"),[]),M=s.useCallback(()=>p("smart-reply"),[]),P=s.useCallback(()=>p("summarize"),[]),E=s.useCallback(()=>p("code"),[]),k=s.useCallback(a=>h(a.target.value),[]),q=s.useCallback(()=>h("JavaScript ile bir todo list nasÄ±l yapÄ±lÄ±r?"),[]),J=s.useCallback(()=>h("React hooks nedir?"),[]),L=s.useCallback(()=>h("BugÃ¼n hava nasÄ±l?"),[]),_=s.useCallback(()=>K("last-message-id"),[]),G=s.useCallback(()=>O(["msg1","msg2","msg3"]),[]),Q=s.useCallback(a=>{a.preventDefault(),D(c)},[c]),H=l(()=>{const a=b.used/b.limit*100,t=a>90?"#ed4245":a>70?"#faa61a":"#43b581";return e.jsxs("div",{className:"ai-quota-container",children:[e.jsxs("div",{className:"ai-quota-info",children:[e.jsx(X,{}),e.jsxs("span",{children:["AI KullanÄ±m: ",b.used," / ",b.limit]})]}),e.jsx("div",{className:"ai-quota-bar",children:e.jsx("div",{className:"ai-quota-fill",style:{width:`${a}%`,backgroundColor:t}})})]})},"renderQuotaBar");return e.jsxs("div",{className:"ai-chatbot-panel",children:[e.jsxs("div",{className:"ai-header",children:[e.jsxs("div",{className:"ai-header-left",children:[e.jsx(v,{size:28}),e.jsxs("div",{children:[e.jsx("h3",{className:"ai-title",children:"AI Assistant"}),e.jsx("p",{className:"ai-subtitle",children:"Discord'u geÃ§en AI Ã¶zellikleri"})]})]}),H()]}),e.jsxs("div",{className:"ai-tabs",children:[e.jsxs("button",{className:r==="chat"?"active":"",onClick:F,children:[e.jsx(v,{})," Chat"]}),e.jsxs("button",{className:r==="smart-reply"?"active":"",onClick:M,children:[e.jsx(S,{})," Smart Reply"]}),e.jsxs("button",{className:r==="summarize"?"active":"",onClick:P,children:[e.jsx(z,{})," Ã–zetle"]}),e.jsxs("button",{className:r==="code"?"active":"",onClick:E,children:[e.jsx(w,{})," Kod OluÅŸtur"]})]}),r==="chat"&&e.jsxs("div",{className:"ai-chat-container",children:[e.jsxs("div",{className:"ai-messages",children:[y.length===0?e.jsxs("div",{className:"ai-empty-state",children:[e.jsx(v,{size:48}),e.jsx("h4",{children:"AI Assistant'a HoÅŸ Geldin!"}),e.jsx("p",{children:"Soru sor, kod yazdÄ±r, mesajlarÄ± Ã¶zetle veya aÃ§Ä±klama iste."}),e.jsxs("div",{className:"ai-suggestions",children:[e.jsx("button",{onClick:q,children:"ğŸ’» Kod Ã¶rneÄŸi iste"}),e.jsx("button",{onClick:J,children:"ğŸ“ Kavram aÃ§Ä±kla"}),e.jsx("button",{onClick:L,children:"ğŸ’¬ Sohbet et"})]})]}):y.map((a,t)=>e.jsxs("div",{className:`ai-message ${a.role} ${a.error?"error":""}`,children:[e.jsx("div",{className:"ai-message-avatar",children:a.role==="user"?"ğŸ‘¤":"ğŸ¤–"}),e.jsxs("div",{className:"ai-message-content",children:[e.jsxs("div",{className:"ai-message-header",children:[e.jsx("strong",{children:a.role==="user"?g:"AI Assistant"}),e.jsx("span",{className:"ai-message-time",children:a.timestamp.toLocaleTimeString("tr-TR",{hour:"2-digit",minute:"2-digit"})})]}),e.jsx("div",{className:"ai-message-text",children:a.content.split("```").map((n,i)=>i%2===0?e.jsx("span",{children:n},i):e.jsx("pre",{className:"ai-code-block",children:e.jsx("code",{children:n})},i))})]})]},t)),e.jsx("div",{ref:C})]}),e.jsxs("form",{onSubmit:$,className:"ai-input-form",children:[e.jsx("input",{type:"text",value:c,onChange:k,placeholder:"AI'ya bir ÅŸey sor...",disabled:u,className:"ai-input"}),e.jsx("button",{type:"submit",disabled:u||!c.trim(),className:"ai-send-btn",children:u?"â³":e.jsx(Z,{})})]})]}),r==="smart-reply"&&e.jsxs("div",{className:"ai-feature-container",children:[e.jsxs("div",{className:"ai-feature-header",children:[e.jsx(S,{size:32}),e.jsx("h4",{children:"AkÄ±llÄ± Cevap Ã–nerileri"}),e.jsx("p",{children:"Mesajlara otomatik yanÄ±t Ã¶nerileri"})]}),e.jsx("button",{onClick:_,disabled:u,className:"ai-action-btn",children:"ğŸ’¡ Son Mesaja AkÄ±llÄ± Cevap Ã–ner"}),N.length>0&&e.jsxs("div",{className:"ai-smart-replies",children:[e.jsx("h5",{children:"Ã–nerilen Cevaplar:"}),N.map((a,t)=>e.jsxs("div",{className:"ai-smart-reply-item",children:[e.jsx("span",{children:a}),e.jsx("button",{onClick:l(()=>h(a),"onClick"),children:"Kullan"})]},t))]})]}),r==="summarize"&&e.jsxs("div",{className:"ai-feature-container",children:[e.jsxs("div",{className:"ai-feature-header",children:[e.jsx(z,{size:32}),e.jsx("h4",{children:"Mesaj Ã–zetleme"}),e.jsx("p",{children:"Uzun konuÅŸmalarÄ± tek paragrafta Ã¶zetle"})]}),e.jsx("button",{onClick:G,disabled:u,className:"ai-action-btn",children:"ğŸ“ Son 50 MesajÄ± Ã–zetle"})]}),r==="code"&&e.jsxs("div",{className:"ai-feature-container",children:[e.jsxs("div",{className:"ai-feature-header",children:[e.jsx(w,{size:32}),e.jsx("h4",{children:"Kod Ãœretimi"}),e.jsx("p",{children:"AI ile kod yaz, GitHub Copilot gibi"})]}),e.jsxs("form",{onSubmit:Q,className:"ai-code-form",children:[e.jsx("textarea",{value:c,onChange:k,placeholder:"Ne yapmak istiyorsun? Ã–rn: 'React'te bir sayaÃ§ komponenti yap'",rows:4,className:"ai-code-textarea"}),e.jsx("button",{type:"submit",disabled:u||!c.trim(),className:"ai-action-btn",children:"ğŸ’» Kod Ãœret"})]})]})]})},"AIChatbotPanel"),re=s.memo(Y);export{re as default};
