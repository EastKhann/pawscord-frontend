import{r as t,n as e}from"./react-core-zXIKm1Jm.js";import{o as z}from"./index-tS2FZNgN.js";import"./editor-vendor-DiU449Dh.js";import"./media-vendor-BSOZ7IB3.js";import"./router-vendor-ltdGXAv4.js";import"./crypto-vendor-D_AcF0lD.js";import"./icons-vendor-BBdoVeJd.js";import"./state-vendor-8NbFPBhQ.js";const $=({bot:s,onClick:m})=>e.jsxs("div",{className:"bot-card",onClick:()=>m(s),children:[e.jsxs("div",{className:"bot-avatar",children:[e.jsx("img",{src:s.avatar||"/default-bot.png",alt:s.name}),s.is_verified&&e.jsx("span",{className:"verified-badge",children:"âœ“"})]}),e.jsxs("div",{className:"bot-info",children:[e.jsxs("h3",{className:"bot-name",children:[s.name,s.is_featured&&e.jsx("span",{className:"featured-tag",children:"â­ Ã–ne Ã‡Ä±kan"})]}),e.jsx("p",{className:"bot-description",children:s.short_description}),e.jsxs("div",{className:"bot-meta",children:[e.jsxs("span",{className:"bot-installs",children:[e.jsx("i",{children:"ðŸ“¥"})," ",s.install_count?.toLocaleString()||0]}),e.jsxs("span",{className:"bot-rating",children:[e.jsx("i",{children:"â­"})," ",s.avg_rating||0]}),s.category&&e.jsx("span",{className:"bot-category",children:s.category})]}),s.tags&&s.tags.length>0&&e.jsx("div",{className:"bot-tags",children:s.tags.slice(0,3).map((x,r)=>e.jsx("span",{className:"tag",children:x},r))})]})]}),E=({bot:s,onClose:m,onInstall:x})=>{const[r,v]=t.useState("overview"),[S,p]=t.useState(!1),[g,B]=t.useState([]),[d,y]=t.useState(null),[c,b]=t.useState(!1),l=z,w=t.useCallback(async()=>{try{const n=localStorage.getItem("access_token"),i=await fetch(`${l}/bots/my-servers/`,{headers:{Authorization:`Bearer ${n}`}});if(i.ok){const j=await i.json();B(j.servers||[])}}catch(n){console.error("Failed to load servers:",n)}},[l]),N=async()=>{if(d){b(!0);try{const n=localStorage.getItem("access_token"),i=await fetch(`${l}/bots/${s.id}/install/`,{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify({server_id:d.id})});if(i.ok)x?.(s,d),p(!1),alert(`${s.name} baÅŸarÄ±yla ${d.name} sunucusuna eklendi!`);else{const j=await i.json();alert(j.error||"YÃ¼kleme baÅŸarÄ±sÄ±z")}}catch(n){console.error("Install failed:",n)}b(!1)}};return t.useEffect(()=>{w()},[w]),s?e.jsx("div",{className:"bot-modal-overlay",onClick:n=>n.target===n.currentTarget&&m(),children:e.jsxs("div",{className:"bot-modal",children:[e.jsxs("div",{className:"bot-modal-header",style:{backgroundImage:s.banner?`url(${s.banner})`:void 0},children:[e.jsx("button",{className:"modal-close",onClick:m,children:"Ã—"}),e.jsxs("div",{className:"bot-header-content",children:[e.jsx("img",{src:s.avatar||"/default-bot.png",alt:s.name,className:"bot-large-avatar"}),e.jsxs("div",{className:"bot-header-info",children:[e.jsxs("h2",{children:[s.name,s.is_verified&&e.jsx("span",{className:"verified",children:"âœ“ DoÄŸrulanmÄ±ÅŸ"})]}),e.jsx("p",{children:s.short_description}),e.jsxs("div",{className:"bot-stats",children:[e.jsxs("span",{children:["ðŸ“¥ ",s.install_count?.toLocaleString()," sunucu"]}),e.jsxs("span",{children:["â­ ",s.avg_rating," (",s.review_count," yorum)"]})]})]}),e.jsx("button",{className:"add-bot-btn",onClick:()=>p(!0),children:"Sunucuya Ekle"})]})]}),e.jsxs("div",{className:"bot-modal-tabs",children:[e.jsx("button",{className:r==="overview"?"active":"",onClick:()=>v("overview"),children:"Genel BakÄ±ÅŸ"}),e.jsx("button",{className:r==="commands"?"active":"",onClick:()=>v("commands"),children:"Komutlar"}),e.jsx("button",{className:r==="reviews"?"active":"",onClick:()=>v("reviews"),children:"Yorumlar"})]}),e.jsxs("div",{className:"bot-modal-content",children:[r==="overview"&&e.jsxs("div",{className:"overview-tab",children:[e.jsxs("div",{className:"description-section",children:[e.jsx("h3",{children:"AÃ§Ä±klama"}),e.jsx("div",{className:"description-content",children:s.description})]}),s.features&&s.features.length>0&&e.jsxs("div",{className:"features-section",children:[e.jsx("h3",{children:"Ã–zellikler"}),e.jsx("div",{className:"features-list",children:s.features.map((n,i)=>e.jsxs("div",{className:"feature-item",children:["âœ… ",n]},i))})]}),e.jsxs("div",{className:"links-section",children:[e.jsx("h3",{children:"BaÄŸlantÄ±lar"}),e.jsxs("div",{className:"links-list",children:[s.website&&e.jsx("a",{href:s.website,target:"_blank",rel:"noopener noreferrer",children:"ðŸŒ Web Sitesi"}),s.support_server&&e.jsx("a",{href:`/invite/${s.support_server}`,children:"ðŸ’¬ Destek Sunucusu"}),s.privacy_policy&&e.jsx("a",{href:s.privacy_policy,target:"_blank",rel:"noopener noreferrer",children:"ðŸ”’ Gizlilik PolitikasÄ±"})]})]}),s.developer&&e.jsxs("div",{className:"developer-section",children:[e.jsx("h3",{children:"GeliÅŸtirici"}),e.jsxs("div",{className:"developer-info",children:[e.jsx("img",{src:s.developer.avatar||"/default-avatar.png",alt:""}),e.jsx("span",{children:s.developer.username})]})]})]}),r==="commands"&&e.jsx("div",{className:"commands-tab",children:s.commands&&s.commands.length>0?e.jsx("div",{className:"commands-list",children:s.commands.map((n,i)=>e.jsxs("div",{className:"command-item",children:[e.jsxs("code",{className:"command-name",children:[s.prefix,n.name]}),e.jsx("p",{className:"command-desc",children:n.description}),n.usage&&e.jsx("code",{className:"command-usage",children:n.usage})]},i))}):e.jsx("p",{className:"no-data",children:"Komut listesi mevcut deÄŸil"})}),r==="reviews"&&e.jsx("div",{className:"reviews-tab",children:s.reviews&&s.reviews.length>0?e.jsx("div",{className:"reviews-list",children:s.reviews.map(n=>e.jsxs("div",{className:"review-item",children:[e.jsxs("div",{className:"review-header",children:[e.jsx("img",{src:n.avatar||"/default-avatar.png",alt:""}),e.jsx("span",{className:"reviewer-name",children:n.user}),e.jsx("span",{className:"review-rating",children:"â­".repeat(n.rating)})]}),e.jsx("p",{className:"review-content",children:n.content}),e.jsx("span",{className:"review-date",children:new Date(n.created_at).toLocaleDateString("tr-TR")})]},n.id))}):e.jsx("p",{className:"no-data",children:"HenÃ¼z yorum yok"})})]}),S&&e.jsx("div",{className:"server-select-overlay",children:e.jsxs("div",{className:"server-select-modal",children:[e.jsx("h3",{children:"Sunucu SeÃ§"}),e.jsxs("p",{children:[s.name," botunu hangi sunucuya eklemek istiyorsunuz?"]}),e.jsx("div",{className:"server-list",children:g.length===0?e.jsx("p",{className:"no-servers",children:"Admin olduÄŸunuz sunucu bulunamadÄ±"}):g.map(n=>e.jsxs("div",{className:`server-item ${d?.id===n.id?"selected":""}`,onClick:()=>y(n),children:[e.jsx("img",{src:n.icon||"/default-server.png",alt:""}),e.jsx("span",{children:n.name}),e.jsxs("span",{className:"member-count",children:[n.member_count," Ã¼ye"]})]},n.id))}),e.jsxs("div",{className:"server-select-actions",children:[e.jsx("button",{className:"cancel-btn",onClick:()=>p(!1),children:"Ä°ptal"}),e.jsx("button",{className:"install-btn",disabled:!d||c,onClick:N,children:c?"YÃ¼kleniyor...":"Ekle"})]})]})})]})}):null},K=({onClose:s})=>{const[m,x]=t.useState([]),[r,v]=t.useState([]),[S,p]=t.useState([]),[g,B]=t.useState([]),[d,y]=t.useState(!0),[c,b]=t.useState(null),[l,w]=t.useState(""),[N,n]=t.useState("popular"),[i,j]=t.useState(null),[f,P]=t.useState(1),[C,A]=t.useState(1),h=z,I=t.useCallback(async()=>{try{const a=new URLSearchParams({page:f,sort:N,limit:20});c&&a.append("category",c),l&&a.append("search",l);const o=await fetch(`${h}/bots/?${a}`);if(o.ok){const u=await o.json();x(u.bots||[]),A(u.pages||1)}}catch(a){console.error("Failed to load bots:",a)}},[h,f,N,c,l]),T=t.useCallback(async()=>{y(!0);try{const[a,o,u]=await Promise.all([fetch(`${h}/bots/categories/`),fetch(`${h}/bots/featured/`),fetch(`${h}/bots/trending/`)]);if(a.ok){const k=await a.json();B(k.categories||[])}if(o.ok){const k=await o.json();v(k.bots||[])}if(u.ok){const k=await u.json();p(k.bots||[])}}catch(a){console.error("Failed to load initial data:",a)}y(!1)},[h]),_=async a=>{try{const o=await fetch(`${h}/bots/${a.id}/`);if(o.ok){const u=await o.json();j(u)}}catch(o){console.error("Failed to load bot detail:",o)}};return t.useEffect(()=>{T()},[T]),t.useEffect(()=>{I()},[I]),d?e.jsx("div",{className:"bot-marketplace",children:e.jsxs("div",{className:"marketplace-loading",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Bot Marketplace yÃ¼kleniyor..."})]})}):e.jsxs("div",{className:"bot-marketplace",children:[e.jsxs("div",{className:"marketplace-header",children:[e.jsxs("div",{className:"header-content",children:[e.jsx("h1",{children:"ðŸ¤– Bot Marketplace"}),e.jsx("p",{children:"Sunucunuzu gÃ¼Ã§lendirecek binlerce bot keÅŸfedin"})]}),s&&e.jsx("button",{className:"close-btn",onClick:s,children:"Ã—"})]}),e.jsxs("div",{className:"marketplace-filters",children:[e.jsxs("div",{className:"search-box",children:[e.jsx("input",{type:"text",placeholder:"Bot ara...",value:l,onChange:a=>w(a.target.value)}),e.jsx("span",{className:"search-icon",children:"ðŸ”"})]}),e.jsxs("div",{className:"filter-group",children:[e.jsxs("select",{value:c||"",onChange:a=>b(a.target.value||null),children:[e.jsx("option",{value:"",children:"TÃ¼m Kategoriler"}),g.map(a=>e.jsxs("option",{value:a.slug,children:[a.icon," ",a.name," (",a.bot_count,")"]},a.id))]}),e.jsxs("select",{value:N,onChange:a=>n(a.target.value),children:[e.jsx("option",{value:"popular",children:"PopÃ¼ler"}),e.jsx("option",{value:"new",children:"Yeni"}),e.jsx("option",{value:"rated",children:"En Ä°yi Puan"})]})]})]}),e.jsxs("div",{className:"marketplace-content",children:[r.length>0&&!l&&!c&&e.jsxs("section",{className:"featured-section",children:[e.jsx("h2",{children:"â­ Ã–ne Ã‡Ä±kan Botlar"}),e.jsx("div",{className:"featured-grid",children:r.map(a=>e.jsx($,{bot:a,onClick:_},a.id))})]}),S.length>0&&!l&&!c&&e.jsxs("section",{className:"trending-section",children:[e.jsx("h2",{children:"ðŸ“ˆ YÃ¼kselen Botlar"}),e.jsx("div",{className:"trending-grid",children:S.map(a=>e.jsx($,{bot:a,onClick:_},a.id))})]}),e.jsxs("section",{className:"all-bots-section",children:[e.jsx("h2",{children:c?g.find(a=>a.slug===c)?.name||"Botlar":l?`"${l}" iÃ§in sonuÃ§lar`:"TÃ¼m Botlar"}),m.length===0?e.jsx("div",{className:"no-results",children:e.jsx("p",{children:"Bot bulunamadÄ±"})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bots-grid",children:m.map(a=>e.jsx($,{bot:a,onClick:_},a.id))}),C>1&&e.jsxs("div",{className:"pagination",children:[e.jsx("button",{disabled:f<=1,onClick:()=>P(a=>a-1),children:"â† Ã–nceki"}),e.jsxs("span",{children:["Sayfa ",f," / ",C]}),e.jsx("button",{disabled:f>=C,onClick:()=>P(a=>a+1),children:"Sonraki â†’"})]})]})]})]}),i&&e.jsx(E,{bot:i,onClose:()=>j(null)})]})};export{K as default};
