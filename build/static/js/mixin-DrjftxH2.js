var Tt=Object.defineProperty;var ct=i=>{throw TypeError(i)};var Et=(i,e,t)=>e in i?Tt(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var c=(i,e,t)=>Et(i,typeof e!="symbol"?e+"":e,t),Y=(i,e,t)=>e.has(i)||ct("Cannot "+t);var s=(i,e,t)=>(Y(i,e,"read from private field"),t?t.call(i):e.get(i)),f=(i,e,t)=>e.has(i)?ct("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,t),a=(i,e,t,r)=>(Y(i,e,"write to private field"),r?r.call(i,t):e.set(i,t),t),y=(i,e,t)=>(Y(i,e,"access private method"),t);const Lt=["abort","canplay","canplaythrough","durationchange","emptied","encrypted","ended","error","loadeddata","loadedmetadata","loadstart","pause","play","playing","progress","ratechange","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting","waitingforkey","resize","enterpictureinpicture","leavepictureinpicture","webkitbeginfullscreen","webkitendfullscreen","webkitpresentationmodechanged"],ft=["autopictureinpicture","disablepictureinpicture","disableremoteplayback","autoplay","controls","controlslist","crossorigin","loop","muted","playsinline","poster","preload","src"];function Rt(i){return`
    <style>
      :host {
        display: inline-flex;
        line-height: 0;
        flex-direction: column;
        justify-content: end;
      }

      audio {
        width: 100%;
      }
    </style>
    <slot name="media">
      <audio${mt(i)}></audio>
    </slot>
    <slot></slot>
  `}function wt(i){return`
    <style>
      :host {
        display: inline-block;
        line-height: 0;
      }

      video {
        max-width: 100%;
        max-height: 100%;
        min-width: 100%;
        min-height: 100%;
        object-fit: var(--media-object-fit, contain);
        object-position: var(--media-object-position, 50% 50%);
      }

      video::-webkit-media-text-track-container {
        transform: var(--media-webkit-text-track-transform);
        transition: var(--media-webkit-text-track-transition);
      }
    </style>
    <slot name="media">
      <video${mt(i)}></video>
    </slot>
    <slot></slot>
  `}function kt(i,{tag:e,is:t}){var u,v,k,lt,N,U,T,W,p,$,Z,vt,_,pt,gt;const r=globalThis.document?.createElement?.(e,{is:t}),d=r?St(r):[];return u=class extends i{constructor(){super(...arguments);f(this,p);f(this,N,!1);f(this,U,null);f(this,T,new Map);f(this,W);c(this,"get");c(this,"set");c(this,"call")}static get observedAttributes(){var h;return y(h=u,k,lt).call(h),[...r?.constructor?.observedAttributes??[],...ft]}get nativeEl(){return y(this,p,$).call(this),s(this,U)??this.querySelector(":scope > [slot=media]")??this.querySelector(e)??this.shadowRoot?.querySelector(e)??null}set nativeEl(o){a(this,U,o)}get defaultMuted(){return this.hasAttribute("muted")}set defaultMuted(o){this.toggleAttribute("muted",o)}get src(){return this.getAttribute("src")}set src(o){this.setAttribute("src",`${o}`)}get preload(){return this.getAttribute("preload")??this.nativeEl?.preload}set preload(o){this.setAttribute("preload",`${o}`)}init(){if(!this.shadowRoot){this.attachShadow({mode:"open"});const o=At(this.attributes);t&&(o.is=t),e&&(o.part=e),this.shadowRoot.innerHTML=this.constructor.getTemplateHTML(o)}this.nativeEl.muted=this.hasAttribute("muted");for(const o of d)y(this,p,pt).call(this,o);a(this,W,new MutationObserver(y(this,p,vt).bind(this))),this.shadowRoot.addEventListener("slotchange",()=>y(this,p,Z).call(this)),y(this,p,Z).call(this);for(const o of this.constructor.Events)this.shadowRoot.addEventListener(o,this,!0)}handleEvent(o){o.target===this.nativeEl&&this.dispatchEvent(new CustomEvent(o.type,{detail:o.detail}))}attributeChangedCallback(o,h,m){y(this,p,$).call(this),y(this,p,gt).call(this,o,h,m)}connectedCallback(){y(this,p,$).call(this)}},v=new WeakMap,k=new WeakSet,lt=function(){if(s(this,v))return;a(this,v,!0);const o=new Set(this.observedAttributes);o.delete("muted");for(const h of d)if(!(h in this.prototype))if(typeof r[h]=="function")this.prototype[h]=function(...m){return y(this,p,$).call(this),this.call?this.call(h,...m):this.nativeEl?.[h]?.apply(this.nativeEl,m)};else{const m={get(){y(this,p,$).call(this);const l=h.toLowerCase();if(o.has(l)){const g=this.getAttribute(l);return g===null?!1:g===""?!0:g}return this.get?.(h)??this.nativeEl?.[h]}};h!==h.toUpperCase()&&(m.set=function(l){y(this,p,$).call(this);const g=h.toLowerCase();if(o.has(g)){l===!0||l===!1||l==null?this.toggleAttribute(g,!!l):this.setAttribute(g,l);return}if(this.set){this.set(h,l);return}this.nativeEl&&(this.nativeEl[h]=l)}),Object.defineProperty(this.prototype,h,m)}},N=new WeakMap,U=new WeakMap,T=new WeakMap,W=new WeakMap,p=new WeakSet,$=function(){s(this,N)||(a(this,N,!0),this.init())},Z=function(){const o=new Map(s(this,T));(this.shadowRoot?.querySelector("slot:not([name])")?.assignedElements({flatten:!0}).filter(l=>["track","source"].includes(l.localName))).forEach(l=>{o.delete(l);let g=s(this,T).get(l);g||(g=l.cloneNode(),s(this,T).set(l,g),s(this,W)?.observe(l,{attributes:!0})),this.nativeEl?.append(g),y(this,p,_).call(this,g)}),o.forEach((l,g)=>{l.remove(),s(this,T).delete(g)})},vt=function(o){for(const h of o)if(h.type==="attributes"){const{target:m,attributeName:l}=h,g=s(this,T).get(m);g&&l&&(g.setAttribute(l,m.getAttribute(l)??""),y(this,p,_).call(this,g))}},_=function(o){o&&o.localName==="track"&&o.default&&(o.kind==="chapters"||o.kind==="metadata")&&o.track.mode==="disabled"&&(o.track.mode="hidden")},pt=function(o){if(Object.prototype.hasOwnProperty.call(this,o)){const h=this[o];delete this[o],this[o]=h}},gt=function(o,h,m){["id","class"].includes(o)||!u.observedAttributes.includes(o)&&this.constructor.observedAttributes.includes(o)||(m===null?this.nativeEl?.removeAttribute(o):this.nativeEl?.getAttribute(o)!==m&&this.nativeEl?.setAttribute(o,m))},f(u,k),c(u,"getTemplateHTML",e.endsWith("audio")?Rt:wt),c(u,"shadowRootOptions",{mode:"open"}),c(u,"Events",Lt),f(u,v,!1),u}function St(i){const e=[];for(let t=Object.getPrototypeOf(i);t&&t!==HTMLElement.prototype;t=Object.getPrototypeOf(t)){const r=Object.getOwnPropertyNames(t);e.push(...r)}return e}function mt(i){let e="";for(const t in i){if(!ft.includes(t))continue;const r=i[t];r===""?e+=` ${t}`:e+=` ${t}="${r}"`}return e}function At(i){const e={};for(const t of i)e[t.name]=t.value;return e}const Nt=kt(globalThis.HTMLElement??class{},{tag:"video"});kt(globalThis.HTMLElement??class{},{tag:"audio"});class Q extends Event{constructor(t,r){super(t);c(this,"track");this.track=r.track}}const tt=new WeakMap;function n(i){return tt.get(i)??xt(i,{})}function xt(i,e){let t=tt.get(i);return t||tt.set(i,t={}),Object.assign(t,e)}function et(i,e){const t=i.videoTracks;n(e).media=i,n(e).renditionSet||(n(e).renditionSet=new Set);const r=n(t).trackSet;r.add(e);const d=r.size-1;d in nt.prototype||Object.defineProperty(nt.prototype,d,{get(){return[...n(this).trackSet][d]}}),queueMicrotask(()=>{t.dispatchEvent(new Q("addtrack",{track:e}))})}function it(i){const e=n(i).media?.videoTracks;if(!e)return;n(e).trackSet.delete(i),queueMicrotask(()=>{e.dispatchEvent(new Q("removetrack",{track:i}))})}function qt(i){const e=n(i).media.videoTracks??[];let t=!1;for(const r of e)r!==i&&(r.selected=!1,t=!0);if(t){if(n(e).changeRequested)return;n(e).changeRequested=!0,queueMicrotask(()=>{delete n(e).changeRequested,e.dispatchEvent(new Event("change"))})}}var E,L,R,C,G;class nt extends EventTarget{constructor(){super();f(this,C);f(this,E);f(this,L);f(this,R);n(this).trackSet=new Set}[Symbol.iterator](){return s(this,C,G).values()}get length(){return s(this,C,G).size}getTrackById(t){return[...s(this,C,G)].find(r=>r.id===t)??null}get selectedIndex(){return[...s(this,C,G)].findIndex(t=>t.selected)}get onaddtrack(){return s(this,E)}set onaddtrack(t){s(this,E)&&(this.removeEventListener("addtrack",s(this,E)),a(this,E,void 0)),typeof t=="function"&&(a(this,E,t),this.addEventListener("addtrack",t))}get onremovetrack(){return s(this,L)}set onremovetrack(t){s(this,L)&&(this.removeEventListener("removetrack",s(this,L)),a(this,L,void 0)),typeof t=="function"&&(a(this,L,t),this.addEventListener("removetrack",t))}get onchange(){return s(this,R)}set onchange(t){s(this,R)&&(this.removeEventListener("change",s(this,R)),a(this,R,void 0)),typeof t=="function"&&(a(this,R,t),this.addEventListener("change",t))}}E=new WeakMap,L=new WeakMap,R=new WeakMap,C=new WeakSet,G=function(){return n(this).trackSet};class X extends Event{constructor(t,r){super(t);c(this,"rendition");this.rendition=r.rendition}}function Mt(i,e){const t=n(i).media.videoRenditions;n(e).media=n(i).media,n(e).track=i;const r=n(i).renditionSet;r.add(e);const d=r.size-1;d in rt.prototype||Object.defineProperty(rt.prototype,d,{get(){return V(this)[d]}}),queueMicrotask(()=>{i.selected&&t.dispatchEvent(new X("addrendition",{rendition:e}))})}function Ot(i){const e=n(i).media.videoRenditions,t=n(i).track;n(t).renditionSet.delete(i),queueMicrotask(()=>{n(i).track.selected&&e.dispatchEvent(new X("removerendition",{rendition:i}))})}function jt(i){const e=n(i).media.videoRenditions;!e||n(e).changeRequested||(n(e).changeRequested=!0,queueMicrotask(()=>{delete n(e).changeRequested,n(i).track.selected&&e.dispatchEvent(new Event("change"))}))}function V(i){return[...n(i).media.videoTracks].filter(t=>t.selected).flatMap(t=>[...n(t).renditionSet])}var w,S,A;class rt extends EventTarget{constructor(){super(...arguments);f(this,w);f(this,S);f(this,A)}[Symbol.iterator](){return V(this).values()}get length(){return V(this).length}getRenditionById(t){return V(this).find(r=>`${r.id}`==`${t}`)??null}get selectedIndex(){return V(this).findIndex(t=>t.selected)}set selectedIndex(t){for(const[r,d]of V(this).entries())d.selected=r===t}get onaddrendition(){return s(this,w)}set onaddrendition(t){s(this,w)&&(this.removeEventListener("addrendition",s(this,w)),a(this,w,void 0)),typeof t=="function"&&(a(this,w,t),this.addEventListener("addrendition",t))}get onremoverendition(){return s(this,S)}set onremoverendition(t){s(this,S)&&(this.removeEventListener("removerendition",s(this,S)),a(this,S,void 0)),typeof t=="function"&&(a(this,S,t),this.addEventListener("removerendition",t))}get onchange(){return s(this,A)}set onchange(t){s(this,A)&&(this.removeEventListener("change",s(this,A)),a(this,A,void 0)),typeof t=="function"&&(a(this,A,t),this.addEventListener("change",t))}}w=new WeakMap,S=new WeakMap,A=new WeakMap;var H;class Pt{constructor(){c(this,"src");c(this,"id");c(this,"width");c(this,"height");c(this,"bitrate");c(this,"frameRate");c(this,"codec");f(this,H,!1)}get selected(){return s(this,H)}set selected(e){s(this,H)!==e&&(a(this,H,e),jt(this))}}H=new WeakMap;var z;class yt{constructor(){c(this,"id");c(this,"kind");c(this,"label","");c(this,"language","");c(this,"sourceBuffer");f(this,z,!1)}addRendition(e,t,r,d,u,v){const k=new Pt;return k.src=e,k.width=t,k.height=r,k.frameRate=v,k.bitrate=u,k.codec=d,Mt(this,k),k}removeRendition(e){Ot(e)}get selected(){return s(this,z)}set selected(e){s(this,z)!==e&&(a(this,z,e),e===!0&&qt(this))}}z=new WeakMap;function $t(i,e){const t=n(i).media.audioRenditions;n(e).media=n(i).media,n(e).track=i;const r=n(i).renditionSet;r.add(e);const d=r.size-1;d in st.prototype||Object.defineProperty(st.prototype,d,{get(){return I(this)[d]}}),queueMicrotask(()=>{i.enabled&&t.dispatchEvent(new X("addrendition",{rendition:e}))})}function Ct(i){const e=n(i).media.audioRenditions,t=n(i).track;n(t).renditionSet.delete(i),queueMicrotask(()=>{n(i).track.enabled&&e.dispatchEvent(new X("removerendition",{rendition:i}))})}function Vt(i){const e=n(i).media.audioRenditions;!e||n(e).changeRequested||(n(e).changeRequested=!0,queueMicrotask(()=>{delete n(e).changeRequested,n(i).track.enabled&&e.dispatchEvent(new Event("change"))}))}function I(i){return[...n(i).media.audioTracks].filter(t=>t.enabled).flatMap(t=>[...n(t).renditionSet])}var x,q,M;class st extends EventTarget{constructor(){super(...arguments);f(this,x);f(this,q);f(this,M)}[Symbol.iterator](){return I(this).values()}get length(){return I(this).length}getRenditionById(t){return I(this).find(r=>`${r.id}`==`${t}`)??null}get selectedIndex(){return I(this).findIndex(t=>t.selected)}set selectedIndex(t){for(const[r,d]of I(this).entries())d.selected=r===t}get onaddrendition(){return s(this,x)}set onaddrendition(t){s(this,x)&&(this.removeEventListener("addrendition",s(this,x)),a(this,x,void 0)),typeof t=="function"&&(a(this,x,t),this.addEventListener("addrendition",t))}get onremoverendition(){return s(this,q)}set onremoverendition(t){s(this,q)&&(this.removeEventListener("removerendition",s(this,q)),a(this,q,void 0)),typeof t=="function"&&(a(this,q,t),this.addEventListener("removerendition",t))}get onchange(){return s(this,M)}set onchange(t){s(this,M)&&(this.removeEventListener("change",s(this,M)),a(this,M,void 0)),typeof t=="function"&&(a(this,M,t),this.addEventListener("change",t))}}x=new WeakMap,q=new WeakMap,M=new WeakMap;var B;class It{constructor(){c(this,"src");c(this,"id");c(this,"bitrate");c(this,"codec");f(this,B,!1)}get selected(){return s(this,B)}set selected(e){s(this,B)!==e&&(a(this,B,e),Vt(this))}}B=new WeakMap;function ot(i,e){const t=i.audioTracks;n(e).media=i,n(e).renditionSet||(n(e).renditionSet=new Set);const r=n(t).trackSet;r.add(e);const d=r.size-1;d in at.prototype||Object.defineProperty(at.prototype,d,{get(){return[...n(this).trackSet][d]}}),queueMicrotask(()=>{t.dispatchEvent(new Q("addtrack",{track:e}))})}function dt(i){const e=n(i).media?.audioTracks;if(!e)return;n(e).trackSet.delete(i),queueMicrotask(()=>{e.dispatchEvent(new Q("removetrack",{track:i}))})}function Ht(i){const e=n(i).media.audioTracks;!e||n(e).changeRequested||(n(e).changeRequested=!0,queueMicrotask(()=>{delete n(e).changeRequested,e.dispatchEvent(new Event("change"))}))}var O,j,P,F,J;class at extends EventTarget{constructor(){super();f(this,F);f(this,O);f(this,j);f(this,P);n(this).trackSet=new Set}[Symbol.iterator](){return s(this,F,J).values()}get length(){return s(this,F,J).size}getTrackById(t){return[...s(this,F,J)].find(r=>r.id===t)??null}get onaddtrack(){return s(this,O)}set onaddtrack(t){s(this,O)&&(this.removeEventListener("addtrack",s(this,O)),a(this,O,void 0)),typeof t=="function"&&(a(this,O,t),this.addEventListener("addtrack",t))}get onremovetrack(){return s(this,j)}set onremovetrack(t){s(this,j)&&(this.removeEventListener("removetrack",s(this,j)),a(this,j,void 0)),typeof t=="function"&&(a(this,j,t),this.addEventListener("removetrack",t))}get onchange(){return s(this,P)}set onchange(t){s(this,P)&&(this.removeEventListener("change",s(this,P)),a(this,P,void 0)),typeof t=="function"&&(a(this,P,t),this.addEventListener("change",t))}}O=new WeakMap,j=new WeakMap,P=new WeakMap,F=new WeakSet,J=function(){return n(this).trackSet};var D;class bt{constructor(){c(this,"id");c(this,"kind");c(this,"label","");c(this,"language","");c(this,"sourceBuffer");f(this,D,!1)}addRendition(e,t,r){const d=new It;return d.src=e,d.codec=t,d.bitrate=r,$t(this,d),d}removeRendition(e){Ct(e)}get enabled(){return s(this,D)}set enabled(e){s(this,D)!==e&&(a(this,D,e),Ht(this))}}D=new WeakMap;const ut=K(globalThis.HTMLMediaElement,"video"),ht=K(globalThis.HTMLMediaElement,"audio");function Ut(i){if(!i?.prototype)return i;const e=K(i,"video");(!e||`${e}`.includes("[native code]"))&&Object.defineProperty(i.prototype,"videoTracks",{get(){return zt(this)}});const t=K(i,"audio");(!t||`${t}`.includes("[native code]"))&&Object.defineProperty(i.prototype,"audioTracks",{get(){return Bt(this)}}),"addVideoTrack"in i.prototype||(i.prototype.addVideoTrack=function(u,v="",k=""){const b=new yt;return b.kind=u,b.label=v,b.language=k,et(this,b),b}),"removeVideoTrack"in i.prototype||(i.prototype.removeVideoTrack=it),"addAudioTrack"in i.prototype||(i.prototype.addAudioTrack=function(u,v="",k=""){const b=new bt;return b.kind=u,b.label=v,b.language=k,ot(this,b),b}),"removeAudioTrack"in i.prototype||(i.prototype.removeAudioTrack=dt),"videoRenditions"in i.prototype||Object.defineProperty(i.prototype,"videoRenditions",{get(){return r(this)}});const r=u=>{let v=n(u).videoRenditions;return v||(v=new rt,n(v).media=u,n(u).videoRenditions=v),v};"audioRenditions"in i.prototype||Object.defineProperty(i.prototype,"audioRenditions",{get(){return d(this)}});const d=u=>{let v=n(u).audioRenditions;return v||(v=new st,n(v).media=u,n(u).audioRenditions=v),v};return i}function K(i,e){if(i?.prototype)return Object.getOwnPropertyDescriptor(i.prototype,`${e}Tracks`)?.get}function zt(i){let e=n(i).videoTracks;if(!e&&(e=new nt,n(i).videoTracks=e,ut)){const t=ut.call(i.nativeEl??i);for(const r of t)et(i,r);t.addEventListener("change",()=>{e.dispatchEvent(new Event("change"))}),t.addEventListener("addtrack",r=>{if([...e].some(d=>d instanceof yt)){for(const d of t)it(d);return}et(i,r.track)}),t.addEventListener("removetrack",r=>{it(r.track)})}return e}function Bt(i){let e=n(i).audioTracks;if(!e&&(e=new at,n(i).audioTracks=e,ht)){const t=ht.call(i.nativeEl??i);for(const r of t)ot(i,r);t.addEventListener("change",()=>{e.dispatchEvent(new Event("change"))}),t.addEventListener("addtrack",r=>{if([...e].some(d=>d instanceof bt)){for(const d of t)dt(d);return}ot(i,r.track)}),t.addEventListener("removetrack",r=>{dt(r.track)})}return e}export{Nt as C,Ut as M};
