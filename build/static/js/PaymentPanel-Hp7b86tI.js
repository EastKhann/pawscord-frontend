import{r,ao as M,l as W,a$ as l,cC as x,b$ as j,V as $}from"./react-core-B6hadH-M.js";import{t as o}from"./index-D_6pZib5.js";const _=({fetchWithAuth:p,apiBaseUrl:d,onClose:R,username:F})=>{const[i,s]=r.useState("balance"),[m,w]=r.useState(0),[E,z]=r.useState([]),[B,P]=r.useState(!0),[c,I]=r.useState(100),[n,b]=r.useState("stripe"),[y,h]=r.useState(""),[g,v]=r.useState(""),[C,S]=r.useState("");r.useEffect(()=>{T(),k()},[]);const T=async()=>{try{const a=await(await p(`${d}/users/balance/`)).json();w(a.balance||0)}catch(t){console.error("Failed to load balance:",t),o.error("Failed to load balance")}finally{P(!1)}},k=async()=>{try{const a=await(await p(`${d}/payments/history/`)).json();z(a.transactions||[])}catch(t){console.error("Failed to load transactions:",t)}},D=async()=>{if(c<100){o.error("Minimum purchase is 100 coins");return}if(!n){o.error("Please select a payment method");return}try{const t=await p(`${d}/payments/coins/purchase/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({coin_amount:parseInt(c),payment_method:n})});if(!t.ok){const u=await t.json();throw new Error(u.error||"Payment failed")}const a=await t.json();a.success?a.redirect_url?(o.info("Redirecting to payment page..."),window.location.href=a.redirect_url):a.payment_page_url?(o.info("Redirecting to payment page..."),window.location.href=a.payment_page_url):o.success("Payment initiated!"):o.error(a.error||"Payment failed")}catch(t){console.error("Payment error:",t),o.error(t.message||"Payment processing failed")}},A=async()=>{if(!y||!g){o.error("Please fill in all fields");return}const t=parseInt(g);if(t<=0||t>m){o.error("Invalid transfer amount");return}try{const u=await(await p(`${d}/coins/transfer/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({recipient:y,amount:t,note:C})})).json();u.success?(o.success(`Transferred ${t} coins to ${y}`),T(),k(),h(""),v(""),S(""),s("balance")):o.error(u.error||"Transfer failed")}catch(a){console.error("Transfer error:",a),o.error("Transfer failed")}},f=[{amount:100,price:.99,bonus:0},{amount:500,price:4.99,bonus:50},{amount:1e3,price:9.99,bonus:150},{amount:2500,price:19.99,bonus:500},{amount:5e3,price:39.99,bonus:1e3}];return React.createElement("div",{style:e.overlay,onClick:R},React.createElement("div",{style:e.modal,onClick:t=>t.stopPropagation()},React.createElement("div",{style:e.header},React.createElement("div",{style:e.headerLeft},React.createElement(M,{style:{fontSize:"24px",color:"#faa61a"}}),React.createElement("h2",{style:{margin:0,fontSize:"20px"}},"Payment Center")),React.createElement("button",{onClick:R,style:e.closeBtn},React.createElement(W,null))),React.createElement("div",{style:e.tabs},React.createElement("button",{onClick:()=>s("balance"),style:{...e.tab,...i==="balance"&&e.activeTab}},React.createElement(l,null)," Balance"),React.createElement("button",{onClick:()=>s("buy"),style:{...e.tab,...i==="buy"&&e.activeTab}},React.createElement(x,null)," Buy Coins"),React.createElement("button",{onClick:()=>s("transfer"),style:{...e.tab,...i==="transfer"&&e.activeTab}},React.createElement(l,null)," Transfer"),React.createElement("button",{onClick:()=>s("history"),style:{...e.tab,...i==="history"&&e.activeTab}},React.createElement(j,null)," History")),React.createElement("div",{style:e.content},B?React.createElement("div",{style:e.loading},"Loading..."):i==="balance"?React.createElement("div",{style:e.balanceView},React.createElement("div",{style:e.balanceCard},React.createElement(l,{style:{fontSize:"48px",color:"#faa61a"}}),React.createElement("div",{style:e.balanceAmount},m.toLocaleString()),React.createElement("div",{style:e.balanceLabel},"Current Balance")),React.createElement("div",{style:e.quickActions},React.createElement("button",{onClick:()=>s("buy"),style:e.actionBtn},React.createElement(x,null)," Buy Coins"),React.createElement("button",{onClick:()=>s("transfer"),style:e.actionBtn},React.createElement(l,null)," Transfer Coins"))):i==="buy"?React.createElement("div",{style:e.buyView},React.createElement("h3",{style:e.sectionTitle},"Choose Payment Method"),React.createElement("div",{style:e.paymentMethods},React.createElement("div",{onClick:()=>b("crypto"),style:{...e.paymentMethodCard,...n==="crypto"&&e.selectedPaymentMethod}},React.createElement("div",{style:e.pmIcon},"ðŸª™"),React.createElement("div",{style:e.pmTitle},"Cryptocurrency"),React.createElement("div",{style:e.pmDesc},"Bitcoin, Ethereum, USDC"),React.createElement("div",{style:e.pmBadge},"Global â€¢ Fast")),React.createElement("div",{onClick:()=>b("stripe"),style:{...e.paymentMethodCard,...n==="stripe"&&e.selectedPaymentMethod}},React.createElement("div",{style:e.pmIcon},"ðŸ’³"),React.createElement("div",{style:e.pmTitle},"Credit/Debit Card"),React.createElement("div",{style:e.pmDesc},"Stripe - Visa, Mastercard"),React.createElement("div",{style:e.pmBadge},"Global â€¢ Secure")),React.createElement("div",{onClick:()=>b("iyzico"),style:{...e.paymentMethodCard,...n==="iyzico"&&e.selectedPaymentMethod}},React.createElement("div",{style:e.pmIcon},"ðŸ‡¹ðŸ‡·"),React.createElement("div",{style:e.pmTitle},"Turkish Payment"),React.createElement("div",{style:e.pmDesc},"Ä°yzico - TL payments"),React.createElement("div",{style:e.pmBadge},"Turkey â€¢ TRY"))),React.createElement("h3",{style:e.sectionTitle},"Select Coin Package"),React.createElement("div",{style:e.packages},f.map((t,a)=>React.createElement("div",{key:a,onClick:()=>I(t.amount),style:{...e.package,...c===t.amount&&e.selectedPackage}},React.createElement(l,{style:{fontSize:"32px",color:"#faa61a"}}),React.createElement("div",{style:e.pkgAmount},t.amount.toLocaleString()),t.bonus>0&&React.createElement("div",{style:e.bonus},"+",t.bonus," BONUS"),React.createElement("div",{style:e.price},"$",t.price),c===t.amount&&React.createElement($,{style:{position:"absolute",top:"10px",right:"10px",color:"#43b581"}})))),React.createElement("div",{style:e.purchaseSection},React.createElement("div",{style:e.paymentInfo},React.createElement("div",{style:e.paymentInfoRow},React.createElement("span",null,"Selected Package:"),React.createElement("strong",null,c.toLocaleString()," coins")),React.createElement("div",{style:e.paymentInfoRow},React.createElement("span",null,"Payment Method:"),React.createElement("strong",null,n==="crypto"&&"ðŸª™ Crypto",n==="stripe"&&"ðŸ’³ Card (Stripe)",n==="iyzico"&&"ðŸ‡¹ðŸ‡· Ä°yzico (TRY)")),React.createElement("div",{style:e.paymentInfoRow},React.createElement("span",null,"Total Price:"),React.createElement("strong",{style:{color:"#faa61a",fontSize:"18px"}},f.find(t=>t.amount===c)?.price&&(n==="iyzico"?`â‚º${(f.find(t=>t.amount===c).price*35).toFixed(0)}`:`$${f.find(t=>t.amount===c).price}`)))),React.createElement("button",{onClick:D,style:e.purchaseBtn},React.createElement(x,null),n==="crypto"&&" Pay with Crypto",n==="stripe"&&" Pay with Card",n==="iyzico"&&" Ä°yzico ile Ã–de"),React.createElement("div",{style:e.paymentNote},n==="crypto"&&"ðŸ”’ Secure cryptocurrency payment via Coinbase Commerce",n==="stripe"&&"ðŸ”’ Secure card payment via Stripe",n==="iyzico"&&"ðŸ”’ GÃ¼venli Ã¶deme - Ä°yzico ile korunur"))):i==="transfer"?React.createElement("div",{style:e.transferView},React.createElement("h3",{style:e.sectionTitle},"Transfer Coins"),React.createElement("div",{style:e.form},React.createElement("div",{style:e.formGroup},React.createElement("label",{style:e.label},"Recipient Username"),React.createElement("input",{type:"text",value:y,onChange:t=>h(t.target.value),placeholder:"@username",style:e.input})),React.createElement("div",{style:e.formGroup},React.createElement("label",{style:e.label},"Amount"),React.createElement("input",{type:"number",value:g,onChange:t=>v(t.target.value),placeholder:"0",min:"1",max:m,style:e.input}),React.createElement("div",{style:e.hint},"Available: ",m," coins")),React.createElement("div",{style:e.formGroup},React.createElement("label",{style:e.label},"Note (Optional)"),React.createElement("input",{type:"text",value:C,onChange:t=>S(t.target.value),placeholder:"Add a message...",style:e.input})),React.createElement("button",{onClick:A,style:e.transferBtn},React.createElement(l,null)," Transfer Coins"))):React.createElement("div",{style:e.historyView},React.createElement("h3",{style:e.sectionTitle},"Transaction History"),E.length===0?React.createElement("div",{style:e.empty},"No transactions yet"):React.createElement("div",{style:e.transactions},E.map((t,a)=>React.createElement("div",{key:a,style:e.transaction},React.createElement("div",{style:e.txIcon},t.type==="purchase"?React.createElement(x,{style:{color:"#5865f2"}}):t.type==="transfer_sent"?React.createElement(l,{style:{color:"#f04747"}}):React.createElement(l,{style:{color:"#43b581"}})),React.createElement("div",{style:e.txDetails},React.createElement("div",{style:e.txTitle},t.description),React.createElement("div",{style:e.txDate},new Date(t.created_at).toLocaleString())),React.createElement("div",{style:{...e.txAmount,color:t.amount>0?"#43b581":"#f04747"}},t.amount>0?"+":"",t.amount))))))))},e={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999},modal:{backgroundColor:"#1e1e1e",borderRadius:"8px",width:"90%",maxWidth:"800px",maxHeight:"80vh",display:"flex",flexDirection:"column",color:"#fff"},header:{padding:"20px",borderBottom:"1px solid #444",display:"flex",justifyContent:"space-between",alignItems:"center"},headerLeft:{display:"flex",alignItems:"center",gap:"12px"},closeBtn:{background:"none",border:"none",color:"#fff",fontSize:"24px",cursor:"pointer",padding:"8px"},tabs:{display:"flex",borderBottom:"1px solid #444",padding:"0 20px"},tab:{background:"none",border:"none",color:"#99aab5",padding:"12px 20px",cursor:"pointer",fontSize:"14px",display:"flex",alignItems:"center",gap:"8px",borderBottom:"2px solid transparent",transition:"all 0.2s"},activeTab:{color:"#5865f2",borderBottomColor:"#5865f2"},content:{padding:"20px",overflowY:"auto",flex:1},loading:{textAlign:"center",padding:"40px",color:"#99aab5"},balanceView:{display:"flex",flexDirection:"column",alignItems:"center",gap:"30px"},balanceCard:{backgroundColor:"#2c2f33",borderRadius:"12px",padding:"40px",textAlign:"center",width:"100%",maxWidth:"400px",display:"flex",flexDirection:"column",alignItems:"center",gap:"16px"},balanceAmount:{fontSize:"48px",fontWeight:"bold",color:"#faa61a"},balanceLabel:{fontSize:"14px",color:"#99aab5"},quickActions:{display:"flex",gap:"12px",width:"100%",maxWidth:"400px"},actionBtn:{flex:1,padding:"12px 20px",backgroundColor:"#5865f2",border:"none",borderRadius:"6px",color:"#fff",cursor:"pointer",fontSize:"14px",fontWeight:"600",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",transition:"background 0.2s"},buyView:{display:"flex",flexDirection:"column",gap:"20px"},sectionTitle:{fontSize:"16px",fontWeight:"600",margin:0,marginBottom:"12px"},packages:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(140px, 1fr))",gap:"12px"},package:{backgroundColor:"#2c2f33",borderRadius:"8px",padding:"20px",textAlign:"center",cursor:"pointer",border:"2px solid transparent",transition:"all 0.2s",position:"relative",display:"flex",flexDirection:"column",alignItems:"center",gap:"8px"},selectedPackage:{borderColor:"#5865f2",backgroundColor:"#2c3136"},pkgAmount:{fontSize:"24px",fontWeight:"bold",color:"#faa61a"},bonus:{fontSize:"10px",color:"#43b581",fontWeight:"bold",padding:"2px 8px",backgroundColor:"rgba(67, 181, 129, 0.1)",borderRadius:"4px"},purchaseSection:{marginTop:"24px"},paymentMethods:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px",marginBottom:"32px"},paymentMethodCard:{padding:"20px",background:"#2b2d31",border:"2px solid #40444b",borderRadius:"12px",textAlign:"center",cursor:"pointer",transition:"all 0.3s ease"},selectedPaymentMethod:{background:"#5865f2",borderColor:"#5865f2",transform:"scale(1.05)",boxShadow:"0 4px 16px rgba(88, 101, 242, 0.3)"},pmIcon:{fontSize:"48px",marginBottom:"12px"},pmTitle:{fontSize:"16px",fontWeight:"600",color:"white",marginBottom:"6px"},pmDesc:{fontSize:"13px",color:"#b9bbbe",marginBottom:"8px"},pmBadge:{display:"inline-block",padding:"4px 12px",background:"#40444b",borderRadius:"12px",fontSize:"11px",color:"#43b581",fontWeight:"600"},paymentInfo:{background:"#2b2d31",borderRadius:"12px",padding:"16px",marginBottom:"16px"},paymentInfoRow:{display:"flex",justifyContent:"space-between",padding:"8px 0",fontSize:"14px",color:"#b9bbbe",borderBottom:"1px solid #40444b"},paymentNote:{textAlign:"center",fontSize:"12px",color:"#43b581",marginTop:"12px"},price:{fontSize:"18px",fontWeight:"600",color:"#fff"},label:{display:"block",fontSize:"14px",fontWeight:"600",marginBottom:"8px",color:"#dcddde"},purchaseBtn:{width:"100%",padding:"14px",backgroundColor:"#43b581",border:"none",borderRadius:"6px",color:"#fff",fontSize:"16px",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",marginTop:"12px"},transferView:{maxWidth:"500px",margin:"0 auto"},form:{display:"flex",flexDirection:"column",gap:"16px"},formGroup:{display:"flex",flexDirection:"column",gap:"8px"},input:{padding:"10px",backgroundColor:"#2c2f33",border:"1px solid #444",borderRadius:"4px",color:"#fff",fontSize:"14px"},hint:{fontSize:"12px",color:"#99aab5"},transferBtn:{width:"100%",padding:"14px",backgroundColor:"#5865f2",border:"none",borderRadius:"6px",color:"#fff",fontSize:"16px",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",marginTop:"12px"},historyView:{display:"flex",flexDirection:"column",gap:"16px"},transactions:{display:"flex",flexDirection:"column",gap:"8px"},transaction:{backgroundColor:"#2c2f33",borderRadius:"6px",padding:"16px",display:"flex",alignItems:"center",gap:"12px"},txIcon:{fontSize:"24px",display:"flex",alignItems:"center",justifyContent:"center"},txDetails:{flex:1},txTitle:{fontSize:"14px",fontWeight:"600"},txDate:{fontSize:"12px",color:"#99aab5",marginTop:"4px"},txAmount:{fontSize:"18px",fontWeight:"bold"},empty:{textAlign:"center",padding:"40px",color:"#99aab5"}};export{_ as default};
