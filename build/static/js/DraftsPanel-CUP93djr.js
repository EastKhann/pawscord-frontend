var j=Object.defineProperty;var r=(s,l)=>j(s,"name",{value:l,configurable:!0});import{r as c,j as e}from"./react-core-Djgtqrmb.js";import{at as g,a as v,z as D,f as C}from"./icons-vendor-BW7dxHkX.js";import{t as n}from"./index-D_luy7FO.js";import"./media-vendor-CxFPycob.js";import"./router-vendor-gmJ9Mn-1.js";import"./state-vendor-BRqaXHJQ.js";import"./crypto-vendor-D1XRGppi.js";import"./ui-vendor-IhB9Znpc.js";const T=r(({fetchWithAuth:s,apiBaseUrl:l,onClose:f,roomSlug:x})=>{const[a,m]=c.useState([]),[y,p]=c.useState(!1);c.useEffect(()=>{i()},[]);const i=r(async()=>{p(!0);try{const d=await(await s(`${l}/api/drafts/?room_slug=${x}`)).json();m(d.drafts||[])}catch{n.error("Failed to load drafts")}finally{p(!1)}},"fetchDrafts"),h=r(o=>{window.dispatchEvent(new CustomEvent("loadDraft",{detail:o})),n.success("Draft loaded into message box"),f()},"loadDraft"),u=r(async o=>{if(confirm("Delete this draft?"))try{await s(`${l}/api/drafts/${o}/delete/`,{method:"DELETE"}),n.success("Draft deleted"),i()}catch{n.error("Failed to delete draft")}},"deleteDraft"),b=r(async()=>{if(confirm(`Delete all ${a.length} drafts?`))try{await s(`${l}/api/drafts/delete-all/`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({room_slug:x})}),n.success("All drafts deleted"),i()}catch{n.error("Failed to delete drafts")}},"deleteAllDrafts");return e.jsx("div",{style:t.overlay,children:e.jsxs("div",{style:t.modal,children:[e.jsxs("div",{style:t.header,children:[e.jsxs("div",{style:t.headerLeft,children:[e.jsx(g,{style:{marginRight:"10px",color:"#5865f2"}}),e.jsx("h2",{style:t.title,children:"Message Drafts"})]}),e.jsx("button",{onClick:f,style:t.closeButton,children:e.jsx(v,{})})]}),a.length>0&&e.jsxs("div",{style:t.toolbar,children:[e.jsxs("div",{style:t.draftCount,children:[a.length," ",a.length===1?"draft":"drafts"]}),e.jsx("button",{onClick:b,style:t.deleteAllButton,children:"Delete All"})]}),e.jsx("div",{style:t.content,children:y?e.jsx("div",{style:t.loading,children:"Loading drafts..."}):a.length===0?e.jsxs("div",{style:t.empty,children:[e.jsx(g,{style:{fontSize:"48px",color:"#2c2f33",marginBottom:"16px"}}),e.jsx("div",{children:"No drafts saved"}),e.jsx("div",{style:t.emptySubtext,children:"Start typing a message and it will be automatically saved as a draft"})]}):e.jsx("div",{style:t.draftsList,children:a.map((o,d)=>e.jsxs("div",{style:t.draftCard,children:[e.jsxs("div",{style:t.draftContent,onClick:r(()=>h(o),"onClick"),children:[e.jsxs("div",{style:t.draftText,children:[o.content.substring(0,200),o.content.length>200&&"..."]}),e.jsxs("div",{style:t.draftMeta,children:[e.jsx(D,{style:{marginRight:"6px",fontSize:"11px"}}),new Date(o.updated_at).toLocaleString()]}),o.room_name&&e.jsxs("div",{style:t.draftRoom,children:["#",o.room_name]})]}),e.jsx("button",{onClick:r(()=>u(o.id),"onClick"),style:t.deleteButton,title:"Delete Draft",children:e.jsx(C,{})})]},d))})})]})})},"DraftsPanel"),t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999},modal:{backgroundColor:"#1e1e1e",borderRadius:"8px",width:"90%",maxWidth:"700px",maxHeight:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #2c2f33"},headerLeft:{display:"flex",alignItems:"center"},title:{margin:0,fontSize:"20px",color:"#ffffff"},closeButton:{background:"none",border:"none",color:"#99aab5",cursor:"pointer",fontSize:"20px",padding:"5px"},toolbar:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 20px",borderBottom:"1px solid #2c2f33",backgroundColor:"#2c2f33"},draftCount:{fontSize:"13px",color:"#dcddde"},deleteAllButton:{padding:"6px 12px",backgroundColor:"#f04747",border:"none",borderRadius:"4px",color:"#ffffff",cursor:"pointer",fontSize:"12px",fontWeight:"500"},content:{padding:"20px",overflowY:"auto",flex:1},loading:{textAlign:"center",color:"#99aab5",padding:"40px"},empty:{textAlign:"center",color:"#99aab5",padding:"60px 20px",display:"flex",flexDirection:"column",alignItems:"center"},emptySubtext:{fontSize:"13px",marginTop:"8px",maxWidth:"300px"},draftsList:{display:"flex",flexDirection:"column",gap:"12px"},draftCard:{backgroundColor:"#2c2f33",borderRadius:"8px",padding:"16px",display:"flex",gap:"12px",alignItems:"flex-start"},draftContent:{flex:1,cursor:"pointer"},draftText:{fontSize:"14px",color:"#dcddde",lineHeight:"1.5",marginBottom:"8px",whiteSpace:"pre-wrap"},draftMeta:{fontSize:"12px",color:"#99aab5",display:"flex",alignItems:"center",marginBottom:"4px"},draftRoom:{fontSize:"12px",color:"#5865f2",fontWeight:"500"},deleteButton:{background:"none",border:"none",color:"#f04747",cursor:"pointer",fontSize:"16px",padding:"8px"}};export{T as default};
