import{r as o,n as e}from"./react-core-Cj7FUMmY.js";import{y as n}from"./ui-vendor-EA4dxvko.js";import{g as M,h as k}from"./index-Cub01ZHs.js";import"./editor-vendor-D9c4a6XZ.js";import"./media-vendor-BsD1gqUZ.js";import"./router-vendor-QeioVw-9.js";import"./icons-vendor-TGltgKsJ.js";import"./state-vendor-MN-5i-Jz.js";import"./crypto-vendor-DK-7ILyQ.js";const H=({serverId:c,onClose:p})=>{const t=M(),[x,g]=o.useState([]),[N,y]=o.useState(!0),[_,d]=o.useState(!1),[b,w]=o.useState([]),[S,z]=o.useState([]),[a,r]=o.useState({title:"",description:"",prize:"",channel_id:"",winners_count:1,duration:3600,required_role_id:"",required_messages:0,required_invites:0,allow_multiple_entries:!1});o.useEffect(()=>{h(),$(),C()},[c]);const h=async()=>{try{const s=await fetch(`${t}/giveaways/server/${c}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(s.ok){const i=await s.json();g(i)}}catch{}finally{y(!1)}},$=async()=>{try{const s=await fetch(`${t}/channels/server/${c}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(s.ok){const i=await s.json();w(i.filter(l=>l.type==="text"))}}catch{}},C=async()=>{try{const s=await fetch(`${t}/roles/server/${c}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(s.ok){const i=await s.json();z(i)}}catch{}},q=async()=>{if(!a.title||!a.prize||!a.channel_id){n.error("âŒ LÃ¼tfen tÃ¼m gerekli alanlarÄ± doldurun");return}try{(await fetch(`${t}/giveaways/create/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`,"Content-Type":"application/json"},body:JSON.stringify({server_id:c,...a})})).ok?(n.success("âœ… Ã‡ekiliÅŸ oluÅŸturuldu!"),d(!1),h(),r({title:"",description:"",prize:"",channel_id:"",winners_count:1,duration:3600,required_role_id:"",required_messages:0,required_invites:0,allow_multiple_entries:!1})):n.error("âŒ Ã‡ekiliÅŸ oluÅŸturulamadÄ±")}catch{n.error("âŒ BaÄŸlantÄ± hatasÄ±")}},B=async s=>{if(await k("Ã‡ekiliÅŸi sonlandÄ±rmak istediÄŸinize emin misiniz?"))try{const i=await fetch(`${t}/giveaways/${s}/end/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(i.ok){const l=await i.json();n.success(`âœ… Ã‡ekiliÅŸ sonlandÄ±! Kazananlar: ${l.winners.join(", ")}`),h()}else n.error("âŒ Ã‡ekiliÅŸ sonlandÄ±rÄ±lamadÄ±")}catch{n.error("âŒ BaÄŸlantÄ± hatasÄ±")}},A=async s=>{try{const i=await fetch(`${t}/giveaways/${s}/reroll/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(i.ok){const l=await i.json();n.success(`âœ… Yeni kazanan: ${l.new_winner}`),h()}else n.error("âŒ Reroll yapÄ±lamadÄ±")}catch{n.error("âŒ BaÄŸlantÄ± hatasÄ±")}},G=async s=>{if(await k("Ã‡ekiliÅŸi silmek istediÄŸinize emin misiniz?"))try{(await fetch(`${t}/giveaways/${s}/delete/`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}})).ok?(n.success("âœ… Ã‡ekiliÅŸ silindi"),h()):n.error("âŒ Ã‡ekiliÅŸ silinemedi")}catch{n.error("âŒ BaÄŸlantÄ± hatasÄ±")}},j=s=>{const i={active:{text:"Aktif",color:"#10b981"},ended:{text:"SonlandÄ±",color:"#6b7280"},cancelled:{text:"Ä°ptal",color:"#ef4444"}};return i[s]||i.active},K=s=>{const i=new Date,l=new Date(s),m=Math.floor((l-i)/1e3);if(m<=0)return"Sona erdi";const v=Math.floor(m/86400),u=Math.floor(m%86400/3600),f=Math.floor(m%3600/60);return v>0?`${v}g ${u}s kaldÄ±`:u>0?`${u}s ${f}dk kaldÄ±`:`${f} dakika kaldÄ±`};return e.jsx("div",{className:"giveaway-panel-overlay",onClick:p,children:e.jsxs("div",{className:"giveaway-panel",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"giveaway-header",children:[e.jsx("h2",{children:"ğŸ‰ Ã‡ekiliÅŸler"}),e.jsx("button",{className:"close-btn",onClick:p,children:"Ã—"})]}),e.jsxs("div",{className:"giveaway-content",children:[e.jsx("div",{className:"giveaway-actions",children:e.jsx("button",{className:"create-giveaway-btn",onClick:()=>d(!0),children:"+ Yeni Ã‡ekiliÅŸ OluÅŸtur"})}),N?e.jsxs("div",{className:"loading-state",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{children:"Ã‡ekiliÅŸler yÃ¼kleniyor..."})]}):x.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("span",{className:"empty-icon",children:"ğŸ"}),e.jsx("p",{children:"HenÃ¼z Ã§ekiliÅŸ yok"}),e.jsx("span",{className:"empty-hint",children:"Yeni bir Ã§ekiliÅŸ oluÅŸturun!"})]}):e.jsx("div",{className:"giveaways-list",children:x.map(s=>e.jsxs("div",{className:"giveaway-card",children:[e.jsxs("div",{className:"giveaway-card-header",children:[e.jsx("h3",{children:s.title}),e.jsx("span",{className:"status-badge",style:{background:j(s.status).color},children:j(s.status).text})]}),e.jsxs("div",{className:"giveaway-card-body",children:[e.jsxs("div",{className:"giveaway-prize",children:[e.jsx("span",{className:"prize-icon",children:"ğŸ"}),e.jsx("span",{className:"prize-text",children:s.prize})]}),s.description&&e.jsx("p",{className:"giveaway-description",children:s.description}),e.jsxs("div",{className:"giveaway-info",children:[e.jsxs("div",{className:"info-item",children:[e.jsx("span",{className:"info-label",children:"Kazanan SayÄ±sÄ±:"}),e.jsxs("span",{className:"info-value",children:[s.winners_count," kiÅŸi"]})]}),e.jsxs("div",{className:"info-item",children:[e.jsx("span",{className:"info-label",children:"KatÄ±lÄ±mcÄ±lar:"}),e.jsxs("span",{className:"info-value",children:[s.entries_count||0," kiÅŸi"]})]}),s.status==="active"&&e.jsxs("div",{className:"info-item",children:[e.jsx("span",{className:"info-label",children:"Kalan SÃ¼re:"}),e.jsx("span",{className:"info-value time-remaining",children:K(s.end_time)})]})]}),s.required_role_id&&e.jsx("div",{className:"requirement-badge",children:"â­ Rol gereksinimi var"}),s.required_messages>0&&e.jsxs("div",{className:"requirement-badge",children:["ğŸ’¬ ",s.required_messages," mesaj gerekli"]}),s.required_invites>0&&e.jsxs("div",{className:"requirement-badge",children:["ğŸ‘¥ ",s.required_invites," davet gerekli"]}),s.winners&&s.winners.length>0&&e.jsxs("div",{className:"winners-section",children:[e.jsx("h4",{children:"ğŸ‰ Kazananlar:"}),e.jsx("ul",{className:"winners-list",children:s.winners.map((i,l)=>e.jsx("li",{children:i},l))})]})]}),e.jsxs("div",{className:"giveaway-card-footer",children:[s.status==="active"&&e.jsx("button",{className:"end-btn",onClick:()=>B(s.id),children:"ğŸ SonlandÄ±r"}),s.status==="ended"&&e.jsx("button",{className:"reroll-btn",onClick:()=>A(s.id),children:"ğŸ”„ Reroll"}),e.jsx("button",{className:"delete-btn",onClick:()=>G(s.id),children:"ğŸ—‘ï¸ Sil"})]})]},s.id))})]}),_&&e.jsx("div",{className:"create-modal-overlay",onClick:()=>d(!1),children:e.jsxs("div",{className:"create-modal",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:"Yeni Ã‡ekiliÅŸ OluÅŸtur"}),e.jsx("button",{className:"close-btn",onClick:()=>d(!1),children:"Ã—"})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"BaÅŸlÄ±k *"}),e.jsx("input",{type:"text",placeholder:"Discord Nitro Ã‡ekiliÅŸi",value:a.title,onChange:s=>r({...a,title:s.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"AÃ§Ä±klama"}),e.jsx("textarea",{placeholder:"Ã‡ekiliÅŸ hakkÄ±nda detaylar...",value:a.description,onChange:s=>r({...a,description:s.target.value}),rows:"3"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Ã–dÃ¼l *"}),e.jsx("input",{type:"text",placeholder:"1 AylÄ±k Discord Nitro",value:a.prize,onChange:s=>r({...a,prize:s.target.value})})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kanal *"}),e.jsxs("select",{value:a.channel_id,onChange:s=>r({...a,channel_id:s.target.value}),children:[e.jsx("option",{value:"",children:"Kanal SeÃ§in"}),b.map(s=>e.jsxs("option",{value:s.id,children:["# ",s.name]},s.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kazanan SayÄ±sÄ±"}),e.jsx("input",{type:"number",min:"1",max:"100",value:a.winners_count,onChange:s=>r({...a,winners_count:parseInt(s.target.value)})})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"SÃ¼re"}),e.jsxs("select",{value:a.duration,onChange:s=>r({...a,duration:parseInt(s.target.value)}),children:[e.jsx("option",{value:"1800",children:"30 dakika"}),e.jsx("option",{value:"3600",children:"1 saat"}),e.jsx("option",{value:"10800",children:"3 saat"}),e.jsx("option",{value:"21600",children:"6 saat"}),e.jsx("option",{value:"43200",children:"12 saat"}),e.jsx("option",{value:"86400",children:"1 gÃ¼n"}),e.jsx("option",{value:"172800",children:"2 gÃ¼n"}),e.jsx("option",{value:"259200",children:"3 gÃ¼n"}),e.jsx("option",{value:"604800",children:"1 hafta"})]})]}),e.jsxs("div",{className:"requirements-section",children:[e.jsx("h4",{children:"KatÄ±lÄ±m Gereksinimleri (Opsiyonel)"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Gerekli Rol"}),e.jsxs("select",{value:a.required_role_id,onChange:s=>r({...a,required_role_id:s.target.value}),children:[e.jsx("option",{value:"",children:"Rol yok"}),S.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Minimum Mesaj SayÄ±sÄ±"}),e.jsx("input",{type:"number",min:"0",value:a.required_messages,onChange:s=>r({...a,required_messages:parseInt(s.target.value)})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Minimum Davet SayÄ±sÄ±"}),e.jsx("input",{type:"number",min:"0",value:a.required_invites,onChange:s=>r({...a,required_invites:parseInt(s.target.value)})})]})]}),e.jsx("div",{className:"form-group",children:e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:a.allow_multiple_entries,onChange:s=>r({...a,allow_multiple_entries:s.target.checked})}),e.jsx("span",{children:"Birden fazla katÄ±lÄ±ma izin ver"})]})})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"cancel-btn",onClick:()=>d(!1),children:"Ä°ptal"}),e.jsx("button",{className:"submit-btn",onClick:q,children:"ğŸ‰ Ã‡ekiliÅŸ OluÅŸtur"})]})]})})]})})};export{H as default};
