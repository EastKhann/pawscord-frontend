import{r as i,d as e,ah as L,i as b,bf as I,bF as _,M as z,aE as T,bA as B,an as F,a6 as A}from"./react-core-GQV1VuAT.js";const G=({serverId:o,fetchWithAuth:d,apiBaseUrl:p,onClose:y})=>{const[s,m]=i.useState([]),[c,E]=i.useState([]),[g,h]=i.useState({total_violations:0,auto_deleted:0,warnings_issued:0,users_banned:0}),[v,f]=i.useState(!1),[n,u]=i.useState({rule_type:"toxic",action:"warn",threshold:.8,keywords:[]}),[k,x]=i.useState(!0);i.useEffect(()=>{w()},[o]);const w=async()=>{x(!0);try{const l=await d(`${p}/moderation/rules/${o}/`);if(l.ok){const r=await l.json();m(r.rules||[])}const a=await d(`${p}/moderation/logs/${o}/`);if(a.ok){const r=await a.json();E(r.logs||r)}c.length>0&&h({total_violations:c.length,auto_deleted:c.filter(r=>r.action==="delete").length,warnings_issued:c.filter(r=>r.action==="warn").length,users_banned:c.filter(r=>r.action==="ban").length})}catch(l){console.error("Failed to load moderation data:",l)}x(!1)},C=async()=>{try{const l=await d(`${p}/moderation/rules/${o}/create/`,{method:"POST",body:JSON.stringify(n)});if(l.ok){const a=await l.json();m([...s,a]),f(!1),u({rule_type:"toxic",action:"warn",threshold:.8,keywords:[]})}}catch(l){console.error("Failed to create rule:",l)}},S=async l=>{try{await d(`${p}/moderation/rules/${l}/toggle/`,{method:"POST"}),m(s.map(a=>a.id===l?{...a,is_enabled:!a.is_enabled}:a))}catch(a){console.error("Failed to toggle rule:",a)}},R=async l=>{if(window.confirm("Bu kuralÄ± silmek istediÄŸine emin misin?"))try{await d(`${p}/moderation/rules/${l}/`,{method:"DELETE"}),m(s.filter(a=>a.id!==l))}catch(a){console.error("Failed to delete rule:",a)}};return e.createElement("div",{style:t.overlay,onClick:y},e.createElement("div",{style:t.panel,onClick:l=>l.stopPropagation()},e.createElement("div",{style:t.header},e.createElement("div",{style:t.headerLeft},e.createElement(L,{style:t.headerIcon}),e.createElement("h2",{style:t.title},"Auto-Moderation")),e.createElement("button",{onClick:y,style:t.closeButton},e.createElement(b,null))),e.createElement("div",{style:t.statsGrid},e.createElement("div",{style:t.statCard},e.createElement(I,{style:{...t.statIcon,color:"#f04747"}}),e.createElement("div",{style:t.statValue},g.total_violations),e.createElement("div",{style:t.statLabel},"Total Violations")),e.createElement("div",{style:t.statCard},e.createElement(_,{style:{...t.statIcon,color:"#ed4245"}}),e.createElement("div",{style:t.statValue},g.auto_deleted),e.createElement("div",{style:t.statLabel},"Auto-Deleted")),e.createElement("div",{style:t.statCard},e.createElement(z,{style:{...t.statIcon,color:"#f0b132"}}),e.createElement("div",{style:t.statValue},g.warnings_issued),e.createElement("div",{style:t.statLabel},"Warnings")),e.createElement("div",{style:t.statCard},e.createElement(T,{style:{...t.statIcon,color:"#43b581"}}),e.createElement("div",{style:t.statValue},s.filter(l=>l.is_enabled).length),e.createElement("div",{style:t.statLabel},"Active Rules"))),e.createElement("div",{style:t.section},e.createElement("div",{style:t.sectionHeader},e.createElement("h3",{style:t.sectionTitle},e.createElement(B,null)," Moderation Rules"),e.createElement("button",{onClick:()=>f(!0),style:t.addButton},e.createElement(F,null)," Add Rule")),k?e.createElement("div",{style:t.loading},"Loading..."):s.length===0?e.createElement("div",{style:t.empty},"No moderation rules yet. Create one to get started!"):e.createElement("div",{style:t.rulesList},s.map(l=>e.createElement("div",{key:l.id,style:t.ruleCard},e.createElement("div",{style:t.ruleHeader},e.createElement("div",{style:t.ruleType},D(l.rule_type),e.createElement("span",null,j(l.rule_type))),e.createElement("div",{style:t.ruleActions},e.createElement("label",{style:t.switch},e.createElement("input",{type:"checkbox",checked:l.is_enabled,onChange:()=>S(l.id)}),e.createElement("span",{style:t.slider})),e.createElement("button",{onClick:()=>R(l.id),style:t.deleteBtn},e.createElement(b,null)))),e.createElement("div",{style:t.ruleDetails},e.createElement("div",{style:t.ruleInfo},e.createElement("span",{style:t.ruleLabel},"Action:"),e.createElement("span",{style:t.ruleValue},V(l.action))),l.threshold&&e.createElement("div",{style:t.ruleInfo},e.createElement("span",{style:t.ruleLabel},"Threshold:"),e.createElement("span",{style:t.ruleValue},(l.threshold*100).toFixed(0),"%")),l.keywords&&l.keywords.length>0&&e.createElement("div",{style:t.ruleInfo},e.createElement("span",{style:t.ruleLabel},"Keywords:"),e.createElement("span",{style:t.ruleValue},l.keywords.join(", ")))))))),e.createElement("div",{style:t.section},e.createElement("h3",{style:t.sectionTitle},e.createElement(A,null)," Recent Activity"),e.createElement("div",{style:t.logsList},c.slice(0,10).map((l,a)=>e.createElement("div",{key:a,style:t.logItem},e.createElement("div",{style:t.logIcon},W(l.action)),e.createElement("div",{style:t.logContent},e.createElement("div",{style:t.logText},e.createElement("strong",null,l.user||"Unknown")," - ",l.violation_type),e.createElement("div",{style:t.logMeta},l.content?.substring(0,50),"... â€¢ ",new Date(l.created_at).toLocaleString())),e.createElement("div",{style:t.logAction},e.createElement("span",{style:$(l.action)},l.action)))))),v&&e.createElement("div",{style:t.modalOverlay,onClick:()=>f(!1)},e.createElement("div",{style:t.modal,onClick:l=>l.stopPropagation()},e.createElement("h3",{style:t.modalTitle},"Create Moderation Rule"),e.createElement("div",{style:t.formGroup},e.createElement("label",{style:t.label},"Rule Type"),e.createElement("select",{value:n.rule_type,onChange:l=>u({...n,rule_type:l.target.value}),style:t.select},e.createElement("option",{value:"toxic"},"Toxic Language"),e.createElement("option",{value:"spam"},"Spam Detection"),e.createElement("option",{value:"keyword"},"Keyword Filter"),e.createElement("option",{value:"link"},"Link Filter"),e.createElement("option",{value:"caps"},"Excessive Caps"))),e.createElement("div",{style:t.formGroup},e.createElement("label",{style:t.label},"Action"),e.createElement("select",{value:n.action,onChange:l=>u({...n,action:l.target.value}),style:t.select},e.createElement("option",{value:"warn"},"Warn User"),e.createElement("option",{value:"delete"},"Delete Message"),e.createElement("option",{value:"timeout"},"Timeout User (5min)"),e.createElement("option",{value:"kick"},"Kick User"),e.createElement("option",{value:"ban"},"Ban User"))),n.rule_type!=="keyword"&&e.createElement("div",{style:t.formGroup},e.createElement("label",{style:t.label},"AI Threshold (",(n.threshold*100).toFixed(0),"%)"),e.createElement("input",{type:"range",min:"0.5",max:"1",step:"0.05",value:n.threshold,onChange:l=>u({...n,threshold:parseFloat(l.target.value)}),style:t.slider})),n.rule_type==="keyword"&&e.createElement("div",{style:t.formGroup},e.createElement("label",{style:t.label},"Keywords (comma separated)"),e.createElement("input",{type:"text",placeholder:"word1, word2, word3",onChange:l=>u({...n,keywords:l.target.value.split(",").map(a=>a.trim())}),style:t.input})),e.createElement("div",{style:t.modalButtons},e.createElement("button",{onClick:()=>f(!1),style:t.cancelBtn},"Cancel"),e.createElement("button",{onClick:C,style:t.createBtn},"Create Rule"))))))},D=o=>{switch(o){case"toxic":return"â˜ ï¸";case"spam":return"ðŸš«";case"keyword":return"ðŸ”¤";case"link":return"ðŸ”—";case"caps":return"ðŸ“¢";default:return"âš™ï¸"}},j=o=>{switch(o){case"toxic":return"Toxic Language";case"spam":return"Spam Detection";case"keyword":return"Keyword Filter";case"link":return"Link Filter";case"caps":return"Excessive Caps";default:return o}},V=o=>{switch(o){case"warn":return"âš ï¸ Warn";case"delete":return"ðŸ—‘ï¸ Delete";case"timeout":return"â±ï¸ Timeout";case"kick":return"ðŸ‘¢ Kick";case"ban":return"ðŸ”¨ Ban";default:return o}},W=o=>{switch(o){case"warn":return"âš ï¸";case"delete":return"ðŸ—‘ï¸";case"timeout":return"â±ï¸";case"ban":return"ðŸ”¨";default:return"â“"}},$=o=>({padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"600",backgroundColor:o==="ban"?"#ed4245":o==="timeout"?"#f0b132":"#5865f2",color:"#fff"}),t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,backdropFilter:"blur(5px)"},panel:{backgroundColor:"#2b2d31",borderRadius:"12px",width:"90%",maxWidth:"1000px",maxHeight:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.5)",overflow:"hidden"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #1e1f22"},headerLeft:{display:"flex",alignItems:"center",gap:"12px"},headerIcon:{fontSize:"24px",color:"#5865f2"},title:{margin:0,color:"#fff",fontSize:"24px",fontWeight:"600"},closeButton:{background:"none",border:"none",color:"#b9bbbe",cursor:"pointer",fontSize:"24px",padding:"8px",borderRadius:"4px"},statsGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px",padding:"20px",borderBottom:"1px solid #1e1f22"},statCard:{backgroundColor:"#1e1f22",borderRadius:"8px",padding:"16px",textAlign:"center"},statIcon:{fontSize:"32px",marginBottom:"8px"},statValue:{fontSize:"32px",fontWeight:"bold",color:"#fff",marginBottom:"4px"},statLabel:{fontSize:"14px",color:"#b9bbbe"},section:{padding:"20px",borderBottom:"1px solid #1e1f22",overflowY:"auto"},sectionHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},sectionTitle:{color:"#fff",fontSize:"18px",fontWeight:"600",margin:0,display:"flex",alignItems:"center",gap:"8px"},addButton:{backgroundColor:"#5865f2",color:"#fff",border:"none",borderRadius:"6px",padding:"8px 16px",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",fontSize:"14px",fontWeight:"600"},loading:{textAlign:"center",color:"#b9bbbe",padding:"40px"},empty:{textAlign:"center",color:"#b9bbbe",padding:"40px",fontSize:"14px"},rulesList:{display:"flex",flexDirection:"column",gap:"12px"},ruleCard:{backgroundColor:"#1e1f22",borderRadius:"8px",padding:"16px"},ruleHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},ruleType:{display:"flex",alignItems:"center",gap:"8px",fontSize:"16px",fontWeight:"600",color:"#fff"},ruleActions:{display:"flex",alignItems:"center",gap:"12px"},switch:{position:"relative",display:"inline-block",width:"44px",height:"24px"},slider:{position:"absolute",cursor:"pointer",top:0,left:0,right:0,bottom:0,backgroundColor:"#72767d",transition:"0.3s",borderRadius:"24px"},deleteBtn:{background:"none",border:"none",color:"#ed4245",cursor:"pointer",fontSize:"18px",padding:"4px"},ruleDetails:{display:"flex",flexDirection:"column",gap:"8px"},ruleInfo:{display:"flex",gap:"8px",fontSize:"14px"},ruleLabel:{color:"#b9bbbe",fontWeight:"500"},ruleValue:{color:"#fff"},logsList:{display:"flex",flexDirection:"column",gap:"8px"},logItem:{display:"flex",alignItems:"center",gap:"12px",backgroundColor:"#1e1f22",borderRadius:"6px",padding:"12px"},logIcon:{fontSize:"24px"},logContent:{flex:1},logText:{color:"#fff",fontSize:"14px",marginBottom:"4px"},logMeta:{color:"#72767d",fontSize:"12px"},logAction:{marginLeft:"auto"},modalOverlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10001},modal:{backgroundColor:"#2b2d31",borderRadius:"12px",padding:"24px",width:"90%",maxWidth:"500px"},modalTitle:{color:"#fff",fontSize:"20px",marginBottom:"20px"},formGroup:{marginBottom:"16px"},label:{display:"block",color:"#b9bbbe",fontSize:"14px",marginBottom:"8px",fontWeight:"500"},select:{width:"100%",backgroundColor:"#1e1f22",border:"1px solid #1e1f22",borderRadius:"6px",padding:"10px",color:"#fff",fontSize:"14px"},input:{width:"100%",backgroundColor:"#1e1f22",border:"1px solid #1e1f22",borderRadius:"6px",padding:"10px",color:"#fff",fontSize:"14px"},modalButtons:{display:"flex",gap:"12px",justifyContent:"flex-end",marginTop:"20px"},cancelBtn:{backgroundColor:"#4e5058",color:"#fff",border:"none",borderRadius:"6px",padding:"10px 20px",cursor:"pointer",fontSize:"14px"},createBtn:{backgroundColor:"#5865f2",color:"#fff",border:"none",borderRadius:"6px",padding:"10px 20px",cursor:"pointer",fontSize:"14px",fontWeight:"600"}};export{G as default};
