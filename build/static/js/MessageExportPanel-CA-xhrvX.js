var z=Object.defineProperty;var o=(d,c)=>z(d,"name",{value:c,configurable:!0});import{r as l,j as e}from"./react-core-Djgtqrmb.js";import{bd as D,a as R,a5 as y,bv as T}from"./icons-vendor-BMXAt4pj.js";import{t as i}from"./index-Bohqi95c.js";import"./media-vendor-CxFPycob.js";import"./router-vendor-gmJ9Mn-1.js";import"./state-vendor-CbW2fAN9.js";import"./crypto-vendor-D1XRGppi.js";import"./ui-vendor-IhB9Znpc.js";const $=o(({fetchWithAuth:d,apiBaseUrl:c,roomSlug:j,onClose:x})=>{const[b,v]=l.useState("json"),[r,h]=l.useState({start_date:"",end_date:""}),[m,k]=l.useState(!1),[f,s]=l.useState(!1),[E,S]=l.useState(null),[p,C]=l.useState(null),I=[{value:"json",label:"JSON",icon:"ðŸ“‹"},{value:"csv",label:"CSV (Excel)",icon:"ðŸ“Š"},{value:"txt",label:"Text",icon:"ðŸ“„"},{value:"html",label:"HTML",icon:"ðŸŒ"}],w=o(async()=>{try{s(!0);const a=await d(`${c}/exports/create/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({room_slug:j,format:b,start_date:r.start_date||null,end_date:r.end_date||null,include_attachments:m})});if(a.ok){const n=await a.json();S(n.job_id),i.success("DÄ±ÅŸa aktarma baÅŸlatÄ±ldÄ±"),B(n.job_id)}else i.error("DÄ±ÅŸa aktarma baÅŸlatÄ±lamadÄ±"),s(!1)}catch{i.error("Bir hata oluÅŸtu"),s(!1)}},"startExport"),B=o(async a=>{const n=setInterval(async()=>{try{const u=await d(`${c}/exports/${a}/status/`);if(u.ok){const g=await u.json();g.status==="completed"?(clearInterval(n),s(!1),C(g.download_url),i.success("DÄ±ÅŸa aktarma tamamlandÄ±!")):g.status==="failed"&&(clearInterval(n),s(!1),i.error("DÄ±ÅŸa aktarma baÅŸarÄ±sÄ±z oldu"))}}catch{clearInterval(n),s(!1)}},2e3)},"checkExportStatus"),_=o(()=>{p&&(window.open(p,"_blank"),i.success("Ä°ndirme baÅŸlatÄ±ldÄ±"))},"downloadExport");return e.jsx("div",{style:t.overlay,onClick:x,children:e.jsxs("div",{style:t.modal,onClick:o(a=>a.stopPropagation(),"onClick"),children:[e.jsxs("div",{style:t.header,children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(D,{style:{color:"#43b581"}}),e.jsx("h2",{style:{margin:0},children:"Sohbet GeÃ§miÅŸini DÄ±ÅŸa Aktar"})]}),e.jsx(R,{onClick:x,style:t.closeBtn})]}),e.jsx("div",{style:t.content,children:p?e.jsxs("div",{style:t.success,children:[e.jsx("div",{style:t.successIcon,children:"âœ…"}),e.jsx("h3",{children:"DÄ±ÅŸa Aktarma TamamlandÄ±!"}),e.jsx("p",{children:"DosyanÄ±z hazÄ±r ve indirilebilir durumda."}),e.jsxs("button",{onClick:_,style:t.downloadBtn,children:[e.jsx(y,{})," DosyayÄ± Ä°ndir"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:t.field,children:[e.jsxs("label",{style:t.label,children:[e.jsx(y,{style:{marginRight:"8px"}}),"Dosya FormatÄ±"]}),e.jsx("div",{style:t.formatGrid,children:I.map(a=>e.jsxs("button",{onClick:o(()=>v(a.value),"onClick"),style:{...t.formatBtn,backgroundColor:b===a.value?"#5865f2":"#2c2f33"},children:[e.jsx("span",{style:{fontSize:"24px"},children:a.icon}),e.jsx("span",{children:a.label})]},a.value))})]}),e.jsxs("div",{style:t.field,children:[e.jsxs("label",{style:t.label,children:[e.jsx(T,{style:{marginRight:"8px"}}),"Tarih AralÄ±ÄŸÄ± (opsiyonel)"]}),e.jsxs("div",{style:t.dateRange,children:[e.jsx("input",{type:"date",value:r.start_date,onChange:o(a=>h({...r,start_date:a.target.value}),"onChange"),style:t.dateInput,placeholder:"BaÅŸlangÄ±Ã§"}),e.jsx("span",{style:{color:"#888"},children:"â†’"}),e.jsx("input",{type:"date",value:r.end_date,onChange:o(a=>h({...r,end_date:a.target.value}),"onChange"),style:t.dateInput,placeholder:"BitiÅŸ"})]})]}),e.jsx("div",{style:t.field,children:e.jsxs("label",{style:t.checkboxLabel,children:[e.jsx("input",{type:"checkbox",checked:m,onChange:o(a=>k(a.target.checked),"onChange")}),e.jsx("span",{children:"Ekleri de dahil et (dosya boyutu artabilir)"})]})}),f&&e.jsxs("div",{style:t.progress,children:[e.jsx("div",{style:t.progressSpinner}),e.jsx("p",{children:"Mesajlar iÅŸleniyor..."}),e.jsx("p",{style:{fontSize:"12px",color:"#888"},children:"Bu iÅŸlem birkaÃ§ dakika sÃ¼rebilir"})]})]})}),!p&&e.jsxs("div",{style:t.footer,children:[e.jsx("button",{onClick:x,style:t.cancelBtn,children:"Ä°ptal"}),e.jsx("button",{onClick:w,disabled:f,style:t.exportBtn,children:f?"Ä°ÅŸleniyor...":"DÄ±ÅŸa Aktar"})]})]})})},"MessageExportPanel"),t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999},modal:{backgroundColor:"#1e1e1e",borderRadius:"8px",width:"90%",maxWidth:"600px",maxHeight:"90vh",display:"flex",flexDirection:"column",color:"#fff"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #333"},closeBtn:{cursor:"pointer",fontSize:"24px",color:"#888"},content:{flex:1,overflowY:"auto",padding:"20px"},field:{marginBottom:"25px"},label:{display:"flex",alignItems:"center",marginBottom:"12px",color:"#dcddde",fontSize:"15px",fontWeight:"600"},formatGrid:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"12px"},formatBtn:{display:"flex",flexDirection:"column",alignItems:"center",gap:"8px",padding:"20px",border:"none",borderRadius:"8px",color:"#fff",cursor:"pointer",fontSize:"14px",fontWeight:"500",transition:"background-color 0.2s"},dateRange:{display:"flex",alignItems:"center",gap:"12px"},dateInput:{flex:1,padding:"10px",backgroundColor:"#2c2f33",border:"1px solid #444",borderRadius:"4px",color:"#fff",fontSize:"14px"},checkboxLabel:{display:"flex",alignItems:"center",gap:"10px",cursor:"pointer",fontSize:"14px"},progress:{textAlign:"center",padding:"30px",backgroundColor:"#2c2f33",borderRadius:"8px"},progressSpinner:{width:"50px",height:"50px",border:"4px solid #333",borderTop:"4px solid #5865f2",borderRadius:"50%",animation:"spin 1s linear infinite",margin:"0 auto 15px"},success:{textAlign:"center",padding:"40px"},successIcon:{fontSize:"64px",marginBottom:"20px"},downloadBtn:{backgroundColor:"#43b581",color:"#fff",border:"none",padding:"15px 30px",borderRadius:"4px",cursor:"pointer",fontSize:"16px",fontWeight:"600",display:"inline-flex",alignItems:"center",gap:"10px",marginTop:"20px"},footer:{display:"flex",gap:"10px",padding:"20px",borderTop:"1px solid #333"},cancelBtn:{flex:1,backgroundColor:"#2c2f33",color:"#fff",border:"none",padding:"12px",borderRadius:"4px",cursor:"pointer",fontSize:"16px",fontWeight:"600"},exportBtn:{flex:1,backgroundColor:"#43b581",color:"#fff",border:"none",padding:"12px",borderRadius:"4px",cursor:"pointer",fontSize:"16px",fontWeight:"600"}};export{$ as default};
