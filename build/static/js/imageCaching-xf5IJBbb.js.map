{"version":3,"file":"imageCaching-xf5IJBbb.js","sources":["../../../src/utils/imageCaching.js"],"sourcesContent":["// frontend/src/utils/imageCaching.js\n// ðŸ–¼ï¸ Advanced Image Caching Strategy with localStorage\n\nimport React from 'react';\n\nconst CACHE_NAME = 'pawscord-image-cache';\nconst CACHE_VERSION = 'v1';\nconst MAX_CACHE_SIZE = 50 * 1024 * 1024; // 50MB\nconst MAX_CACHE_AGE = 7 * 24 * 60 * 60 * 1000; // 7 days\n\n// ðŸ”¥ IN-MEMORY AVATAR CACHE - Ultra-fast, no repeated fetches\nconst inMemoryAvatarCache = new Map();\nconst avatarLoadingPromises = new Map(); // Prevent duplicate fetches\n\nclass ImageCache {\n  constructor() {\n    this.cache = new Map();\n    this.loadFromLocalStorage();\n  }\n\n  /**\n   * Load cache from localStorage\n   */\n  loadFromLocalStorage() {\n    try {\n      const stored = localStorage.getItem(`${CACHE_NAME}-${CACHE_VERSION}`);\n      if (stored) {\n        const data = JSON.parse(stored);\n        Object.entries(data).forEach(([key, value]) => {\n          if (this.isValidCacheEntry(value)) {\n            this.cache.set(key, value);\n          }\n        });\n      }\n    } catch (error) {\n      console.warn('[ImageCache] Failed to load from localStorage:', error);\n      this.clearCache();\n    }\n  }\n\n  /**\n   * Save cache to localStorage\n   */\n  saveToLocalStorage() {\n    try {\n      const data = Object.fromEntries(this.cache);\n      localStorage.setItem(`${CACHE_NAME}-${CACHE_VERSION}`, JSON.stringify(data));\n    } catch (error) {\n      console.warn('[ImageCache] localStorage full, clearing old entries');\n      this.pruneCache();\n    }\n  }\n\n  /**\n   * Check if cache entry is still valid\n   */\n  isValidCacheEntry(entry) {\n    if (!entry || !entry.timestamp) return false;\n    const age = Date.now() - entry.timestamp;\n    return age < MAX_CACHE_AGE;\n  }\n\n  /**\n   * Get cached image\n   */\n  async get(url) {\n    const cached = this.cache.get(url);\n\n    if (cached && this.isValidCacheEntry(cached)) {\n      // Update last accessed time\n      cached.lastAccessed = Date.now();\n      this.saveToLocalStorage();\n      return cached.data;\n    }\n\n    // Cache miss, remove if exists\n    if (cached) {\n      this.cache.delete(url);\n    }\n\n    return null;\n  }\n\n  /**\n   * Set cache entry\n   */\n  async set(url, data) {\n    // Check cache size\n    const currentSize = this.getCacheSize();\n    const dataSize = new Blob([data]).size;\n\n    if (currentSize + dataSize > MAX_CACHE_SIZE) {\n      this.pruneCache();\n    }\n\n    this.cache.set(url, {\n      data,\n      timestamp: Date.now(),\n      lastAccessed: Date.now(),\n      size: dataSize\n    });\n\n    this.saveToLocalStorage();\n  }\n\n  /**\n   * Get total cache size\n   */\n  getCacheSize() {\n    let total = 0;\n    this.cache.forEach(entry => {\n      total += entry.size || 0;\n    });\n    return total;\n  }\n\n  /**\n   * Prune cache (remove oldest entries)\n   */\n  pruneCache() {\n    const entries = Array.from(this.cache.entries());\n\n    // Sort by last accessed (oldest first)\n    entries.sort((a, b) => a[1].lastAccessed - b[1].lastAccessed);\n\n    // Remove oldest 30%\n    const removeCount = Math.ceil(entries.length * 0.3);\n    for (let i = 0; i < removeCount; i++) {\n      this.cache.delete(entries[i][0]);\n    }\n\n    this.saveToLocalStorage();\n  }\n\n  /**\n   * Clear entire cache\n   */\n  clearCache() {\n    this.cache.clear();\n    try {\n      localStorage.removeItem(`${CACHE_NAME}-${CACHE_VERSION}`);\n    } catch (error) {\n      console.warn('[ImageCache] Failed to clear localStorage:', error);\n    }\n  }\n\n  /**\n   * Prefetch images\n   */\n  async prefetch(urls) {\n    const promises = urls.map(async url => {\n      if (this.cache.has(url)) return;\n\n      try {\n        const response = await fetch(url);\n        const blob = await response.blob();\n        const dataUrl = await this.blobToDataUrl(blob);\n        await this.set(url, dataUrl);\n      } catch (error) {\n        console.warn('[ImageCache] Failed to prefetch:', url, error);\n      }\n    });\n\n    await Promise.allSettled(promises);\n  }\n\n  /**\n   * Convert blob to data URL\n   */\n  blobToDataUrl(blob) {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader();\n      reader.onload = () => resolve(reader.result);\n      reader.onerror = reject;\n      reader.readAsDataURL(blob);\n    });\n  }\n\n  /**\n   * Get cache statistics\n   */\n  getStats() {\n    return {\n      entries: this.cache.size,\n      size: this.getCacheSize(),\n      maxSize: MAX_CACHE_SIZE,\n      usage: (this.getCacheSize() / MAX_CACHE_SIZE * 100).toFixed(2) + '%',\n      oldestEntry: Math.min(...Array.from(this.cache.values()).map(e => e.timestamp)),\n      newestEntry: Math.max(...Array.from(this.cache.values()).map(e => e.timestamp))\n    };\n  }\n}\n\n// Singleton instance\nconst imageCache = new ImageCache();\n\n/**\n * ðŸ”¥ OPTIMIZED: React hook for cached images with in-memory deduplication\n * AynÄ± URL iÃ§in sadece 1 kere fetch yapar, diÄŸerleri bunu bekler\n */\nexport const useCachedImage = (url) => {\n  const [cachedUrl, setCachedUrl] = React.useState(() => {\n    // ðŸš€ Ä°lk render'da memory cache'i kontrol et\n    if (url && inMemoryAvatarCache.has(url)) {\n      return inMemoryAvatarCache.get(url);\n    }\n    return null;\n  });\n  const [loading, setLoading] = React.useState(!cachedUrl);\n  const [error, setError] = React.useState(null);\n\n  React.useEffect(() => {\n    let cancelled = false;\n\n    const loadImage = async () => {\n      if (!url) {\n        setLoading(false);\n        return;\n      }\n\n      // ðŸš€ 1. Memory cache'te var mÄ±?\n      if (inMemoryAvatarCache.has(url)) {\n        setCachedUrl(inMemoryAvatarCache.get(url));\n        setLoading(false);\n        return;\n      }\n\n      // ðŸš€ 2. Zaten yÃ¼kleniyor mu? Promise'i bekle\n      if (avatarLoadingPromises.has(url)) {\n        try {\n          const result = await avatarLoadingPromises.get(url);\n          if (!cancelled) {\n            setCachedUrl(result);\n            setLoading(false);\n          }\n        } catch (err) {\n          if (!cancelled) {\n            setError(err);\n            setCachedUrl(url);\n            setLoading(false);\n          }\n        }\n        return;\n      }\n\n      // ðŸš€ 3. Yeni fetch baÅŸlat ve promise'i kaydet\n      const loadPromise = (async () => {\n        try {\n          setLoading(true);\n\n          // localStorage cache'i kontrol et\n          const cached = await imageCache.get(url);\n          if (cached) {\n            inMemoryAvatarCache.set(url, cached);\n            return cached;\n          }\n\n          // Fetch and cache\n          const response = await fetch(url);\n          if (!response.ok) throw new Error('Image fetch failed');\n\n          const blob = await response.blob();\n          const dataUrl = await imageCache.blobToDataUrl(blob);\n\n          // Her iki cache'e de kaydet\n          await imageCache.set(url, dataUrl);\n          inMemoryAvatarCache.set(url, dataUrl);\n\n          return dataUrl;\n        } finally {\n          avatarLoadingPromises.delete(url);\n        }\n      })();\n\n      avatarLoadingPromises.set(url, loadPromise);\n\n      try {\n        const result = await loadPromise;\n        if (!cancelled) {\n          setCachedUrl(result);\n          setLoading(false);\n        }\n      } catch (err) {\n        if (!cancelled) {\n          setError(err);\n          setCachedUrl(url); // Fallback to original URL\n          setLoading(false);\n        }\n      }\n    };\n\n    loadImage();\n\n    return () => {\n      cancelled = true;\n    };\n  }, [url]);\n\n  return { url: cachedUrl, loading, error };\n};\n\n/**\n * Prefetch images for a route\n */\nexport const prefetchRouteImages = async (route) => {\n  const routeImages = {\n    profile: [\n      '/avatars/cat_1.png',\n      // Add common profile images\n    ],\n    home: [\n      '/static/logo.png',\n      // Add home images\n    ],\n    // Add more routes\n  };\n\n  const urls = routeImages[route] || [];\n  await imageCache.prefetch(urls);\n};\n\n/**\n * Clear image cache (for settings)\n */\nexport const clearImageCache = () => {\n  imageCache.clearCache();\n  inMemoryAvatarCache.clear();\n  avatarLoadingPromises.clear();\n};\n\n/**\n * Get cache stats (for debugging)\n */\nexport const getImageCacheStats = () => {\n  return {\n    ...imageCache.getStats(),\n    inMemoryCount: inMemoryAvatarCache.size,\n    pendingLoads: avatarLoadingPromises.size\n  };\n};\n\n/**\n * ðŸ”¥ DM/Friends avatar prefetching - ArkadaÅŸ listesi yÃ¼klenince Ã§aÄŸÄ±r\n * Bu fonksiyon tÃ¼m arkadaÅŸlarÄ±n avatarlarÄ±nÄ± arka planda yÃ¼kler\n */\nexport const prefetchUserAvatars = async (users) => {\n  if (!users || !Array.isArray(users)) return;\n\n  const avatarUrls = users\n    .map(u => u.avatar_url || u.avatar)\n    .filter(url => url && typeof url === 'string' && url.startsWith('http'))\n    .filter(url => !inMemoryAvatarCache.has(url)); // Zaten cache'te olanlarÄ± atla\n\n  if (avatarUrls.length === 0) return;\n\n\n  // Paralel yÃ¼kle ama max 5 concurrent\n  const batchSize = 5;\n  for (let i = 0; i < avatarUrls.length; i += batchSize) {\n    const batch = avatarUrls.slice(i, i + batchSize);\n    await Promise.allSettled(batch.map(async (url) => {\n      if (inMemoryAvatarCache.has(url)) return;\n\n      try {\n        // localStorage'da var mÄ±?\n        const cached = await imageCache.get(url);\n        if (cached) {\n          inMemoryAvatarCache.set(url, cached);\n          return;\n        }\n\n        // Fetch with cache-busting to avoid stale CORS errors\n        const cacheBuster = `?_=${Date.now()}`;\n        const fetchUrl = url.includes('?') ? `${url}&_=${Date.now()}` : `${url}${cacheBuster}`;\n        const response = await fetch(fetchUrl, {\n          mode: 'cors',\n          cache: 'no-cache'\n        });\n        if (!response.ok) return;\n\n        const blob = await response.blob();\n        const dataUrl = await imageCache.blobToDataUrl(blob);\n\n        await imageCache.set(url, dataUrl);\n        inMemoryAvatarCache.set(url, dataUrl);\n      } catch (err) {\n        // Silent fail for prefetch\n      }\n    }));\n  }\n\n};\n\n/**\n * ðŸ”¥ Tek bir avatar'Ä± sync olarak al (zaten cache'te varsa)\n */\nexport const getAvatarFromCache = (url) => {\n  if (!url) return null;\n  return inMemoryAvatarCache.get(url) || null;\n};\n\nexport default imageCache;\n\n\n"],"names":[],"mappings":"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"}