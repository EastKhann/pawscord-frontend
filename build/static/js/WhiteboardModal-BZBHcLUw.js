import{r as a,j as r}from"./react-vendor-D4QjtNWS.js";import{a as X,as as Y,at as B,m as T}from"./icons-vendor-BZYtSAMW.js";import"./vendor-Brv1On52.js";import"./state-vendor-T8XA44Ud.js";import"./perf-vendor-CmoV45_-.js";const F=({roomSlug:p,onClose:d,wsProtocol:x,apiHost:g})=>{const t=a.useRef(null),l=a.useRef(null),[b,y]=a.useState(!1),[u,h]=a.useState("#000000"),[f,m]=a.useState(3);a.useEffect(()=>{const e=`${x}://${g}/ws/whiteboard/${p}/`;return l.current=new WebSocket(e),l.current.onmessage=n=>{const{x:c,y:s,type:v,color:S,width:E,prevX:R,prevY:W}=JSON.parse(n.data),i=t.current.getContext("2d");v==="draw"?(i.beginPath(),i.moveTo(R,W),i.lineTo(c,s),i.strokeStyle=S,i.lineWidth=E,i.lineCap="round",i.stroke()):v==="clear"&&i.clearRect(0,0,t.current.width,t.current.height)},()=>l.current.close()},[p,x,g]),a.useEffect(()=>{const e=n=>{n.key==="Escape"&&d()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[d]),a.useEffect(()=>{const e=t.current;e.width=800,e.height=600;const n=e.getContext("2d");n.fillStyle="white",n.fillRect(0,0,e.width,e.height)},[]);const k=({nativeEvent:e})=>{const{offsetX:n,offsetY:c}=e;y(!0),t.current.lastX=n,t.current.lastY=c},j=({nativeEvent:e})=>{if(!b)return;const{offsetX:n,offsetY:c}=e,s=t.current.getContext("2d");s.beginPath(),s.moveTo(t.current.lastX,t.current.lastY),s.lineTo(n,c),s.strokeStyle=u,s.lineWidth=f,s.lineCap="round",s.stroke(),l.current.readyState===WebSocket.OPEN&&l.current.send(JSON.stringify({type:"draw",x:n,y:c,prevX:t.current.lastX,prevY:t.current.lastY,color:u,width:f})),t.current.lastX=n,t.current.lastY=c},w=()=>{y(!1)},C=()=>{const e=t.current.getContext("2d");e.fillStyle="white",e.fillRect(0,0,t.current.width,t.current.height),l.current.send(JSON.stringify({type:"clear"}))};return r.jsx("div",{style:o.overlay,onClick:d,children:r.jsxs("div",{style:o.modal,onClick:e=>e.stopPropagation(),children:[r.jsxs("div",{style:o.header,children:[r.jsx("h3",{children:"ðŸŽ¨ Ortak Ã‡izim TahtasÄ±"}),r.jsx("button",{onClick:d,style:o.closeBtn,children:r.jsx(X,{})})]}),r.jsxs("div",{style:o.toolbar,children:[r.jsx("input",{type:"color",value:u,onChange:e=>h(e.target.value),style:o.colorPicker}),r.jsx("input",{type:"range",min:"1",max:"20",value:f,onChange:e=>m(e.target.value)}),r.jsx("button",{onClick:()=>h("#ffffff"),style:o.toolBtn,children:r.jsx(Y,{})}),r.jsx("button",{onClick:()=>h("#000000"),style:o.toolBtn,children:r.jsx(B,{})}),r.jsx("button",{onClick:C,style:{...o.toolBtn,color:"red"},children:r.jsx(T,{})})]}),r.jsx("div",{style:o.canvasContainer,children:r.jsx("canvas",{ref:t,onMouseDown:k,onMouseMove:j,onMouseUp:w,onMouseLeave:w,style:o.canvas})})]})})},o={overlay:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0.85)",zIndex:3e3,display:"flex",justifyContent:"center",alignItems:"center"},modal:{backgroundColor:"#2b2d31",borderRadius:"12px",padding:"10px",display:"flex",flexDirection:"column",gap:"10px"},header:{display:"flex",justifyContent:"space-between",color:"white",padding:"0 10px"},closeBtn:{background:"none",border:"none",color:"white",fontSize:"1.5em",cursor:"pointer"},toolbar:{display:"flex",gap:"10px",alignItems:"center",backgroundColor:"#1e1f22",padding:"10px",borderRadius:"8px"},canvasContainer:{border:"1px solid #1e1f22",borderRadius:"4px",overflow:"hidden",backgroundColor:"white"},canvas:{cursor:"crosshair",touchAction:"none"},toolBtn:{background:"none",border:"none",color:"#ccc",fontSize:"1.2em",cursor:"pointer"},colorPicker:{border:"none",width:"30px",height:"30px",cursor:"pointer",padding:0}};export{F as default};
