var I=Object.defineProperty;var a=(t,l)=>I(t,"name",{value:l,configurable:!0});import{r as m,j as e}from"./react-core-Djgtqrmb.js";import{cg as L,c0 as D,cv as H,b_ as K,bZ as Y,bX as G,bU as R,bY as J,cw as f,cx as U,a8 as q,aK as V,q as X,b$ as z,a9 as S,c as Z,az as _,j as A,an as $,k as C,a as B,t as Q}from"./icons-vendor-BMXAt4pj.js";import{y as x}from"./ui-vendor-IhB9Znpc.js";import{d as E}from"./index-D09YXCFH.js";import"./media-vendor-CxFPycob.js";import"./router-vendor-gmJ9Mn-1.js";import"./state-vendor-CbW2fAN9.js";import"./crypto-vendor-D1XRGppi.js";const F={github:J,spotify:R,twitch:G,youtube:Y,discord:K,slack:H,google:D,twitter:L},T={github:"#333",spotify:"#1db954",twitch:"#9146ff",youtube:"#ff0000",discord:"#5865f2",slack:"#4a154b",google:"#4285f4",twitter:"#1da1f2"},ee=a(t=>{switch(t){case"development":return e.jsx(X,{});case"entertainment":return e.jsx(V,{});case"streaming":return e.jsx(q,{});case"productivity":return e.jsx(U,{});default:return e.jsx(f,{})}},"getCategoryIcon"),se=a(t=>{const[l,c]=m.useState("connected"),[d,u]=m.useState([]),[o,s]=m.useState([]),[r,n]=m.useState(!0),[j,p]=m.useState(""),[i,N]=m.useState({show:!1,integration:null}),k=localStorage.getItem("access_token");m.useEffect(()=>{g()},[t]);const g=a(async()=>{n(!0);try{const[h,b]=await Promise.all([fetch(`/api/servers/${t}/integrations/`,{headers:{Authorization:`Bearer ${k}`}}),fetch("/api/integrations/available/",{headers:{Authorization:`Bearer ${k}`}})]);if(h.ok){const y=await h.json();u(y.integrations||[])}if(b.ok){const y=await b.json();s(y.integrations||[])}else s([])}catch{s([])}n(!1)},"fetchIntegrations"),w=a(async h=>{try{const b=await fetch(`/api/servers/${t}/integrations/connect/`,{method:"POST",headers:{Authorization:`Bearer ${k}`,"Content-Type":"application/json"},body:JSON.stringify({integration_type:h})});if(b.ok){const y=await b.json();y.oauth_url&&window.open(y.oauth_url,"_blank","width=500,height=600"),x.success(`${h} entegrasyon başlatıldı`),g()}else x.error("Bağlantı başlatılamadı")}catch{x.error("Bağlantı hatası")}},"handleConnect"),v=a(async h=>{if(await E("Bu entegrasyonu kaldırmak istediğinize emin misiniz?"))try{(await fetch(`/api/servers/${t}/integrations/${h}/disconnect/`,{method:"POST",headers:{Authorization:`Bearer ${k}`}})).ok&&(x.success("Entegrasyon kaldırıldı"),g())}catch{x.error("Entegrasyon kaldırılamadı")}},"handleDisconnect"),W=a(async h=>{try{(await fetch(`/api/servers/${t}/integrations/${h}/sync/`,{method:"POST",headers:{Authorization:`Bearer ${k}`}})).ok&&x.success("Senkronizasyon başlatıldı")}catch{x.error("Senkronizasyon başarısız")}},"handleSync"),M=o.filter(h=>h.name.toLowerCase().includes(j.toLowerCase())||h.description.toLowerCase().includes(j.toLowerCase())),O=d.map(h=>h.type),P=M.filter(h=>!O.includes(h.id));return{activeTab:l,setActiveTab:c,integrations:d,notConnected:P,loading:r,searchTerm:j,setSearchTerm:p,configModal:i,setConfigModal:N,token:k,handleConnect:w,handleDisconnect:v,handleSync:W,fetchIntegrations:g}},"useIntegrationHub"),ae=a(({integrations:t,icons:l,colors:c,onDisconnect:d,onSync:u,onConfigure:o})=>t.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx(z,{}),e.jsx("p",{children:"Henüz bağlı entegrasyon yok"}),e.jsx("span",{className:"hint",children:'"Mevcut" sekmesinden entegrasyon ekleyin'})]}):e.jsx("div",{className:"connected-list",children:t.map(s=>{const r=l[s.type]||f,n=c[s.type]||"#666";return e.jsxs("div",{className:"integration-card connected",children:[e.jsx("div",{className:"integration-icon",style:{background:n},children:e.jsx(r,{})}),e.jsxs("div",{className:"integration-info",children:[e.jsx("h4",{children:s.name}),e.jsxs("div",{className:"connection-info",children:[e.jsxs("span",{className:"status connected",children:[e.jsx(S,{})," Bağlı"]}),s.account_name&&e.jsxs("span",{className:"account",children:["@",s.account_name]})]}),e.jsxs("div",{className:"last-sync",children:["Son senkronizasyon: ",s.last_sync||"Hiç"]})]}),e.jsxs("div",{className:"integration-actions",children:[e.jsx("button",{className:"action-btn sync",onClick:a(()=>u(s.id),"onClick"),title:"Senkronize Et",children:e.jsx(Z,{})}),e.jsx("button",{className:"action-btn config",onClick:a(()=>o(s),"onClick"),title:"Ayarlar",children:e.jsx(_,{})}),e.jsx("button",{className:"action-btn disconnect",onClick:a(()=>d(s.id),"onClick"),title:"Bağlantıyı Kes",children:e.jsx(z,{})})]})]},s.id)})}),"ConnectedIntegrations"),ne=a(({integrations:t,icons:l,colors:c,getCategoryIcon:d,onConnect:u})=>{const o=[...new Set(t.map(s=>s.category))];return t.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx(f,{}),e.jsx("p",{children:"Tüm entegrasyonlar zaten bağlı"})]}):e.jsx("div",{className:"available-list",children:o.map(s=>e.jsxs("div",{className:"category-section",children:[e.jsxs("h3",{className:"category-title",children:[d(s),s==="development"&&"Geliştirme",s==="entertainment"&&"Eğlence",s==="streaming"&&"Yayın",s==="productivity"&&"Üretkenlik",s==="content"&&"İçerik",s==="social"&&"Sosyal"]}),e.jsx("div",{className:"integrations-grid",children:t.filter(r=>r.category===s).map(r=>{const n=l[r.id]||f,j=c[r.id]||"#666";return e.jsxs("div",{className:"integration-card available",children:[e.jsx("div",{className:"integration-icon",style:{background:j},children:e.jsx(n,{})}),e.jsxs("div",{className:"integration-details",children:[e.jsx("h4",{children:r.name}),e.jsx("p",{children:r.description}),e.jsx("ul",{className:"features",children:r.features?.slice(0,3).map((p,i)=>e.jsxs("li",{children:[e.jsx(S,{})," ",p]},i))})]}),e.jsxs("button",{className:"connect-btn",onClick:a(()=>u(r.id),"onClick"),children:[e.jsx(A,{})," Bağla"]})]},r.id)})})]},s))})},"AvailableIntegrations"),te=a(({serverId:t,token:l,onClose:c,onCreated:d})=>{const[u,o]=m.useState(""),[s,r]=m.useState(""),[n,j]=m.useState([]);m.useEffect(()=>{fetch(`/api/servers/${t}/channels/`,{headers:{Authorization:`Bearer ${l}`}}).then(i=>i.json()).then(i=>j(i.channels||[])).catch(()=>{})},[]);const p=a(async()=>{if(!u||!s){x.warning("Tüm alanları doldurun");return}try{(await fetch(`/api/servers/${t}/webhooks/`,{method:"POST",headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"},body:JSON.stringify({name:u,channel_id:s})})).ok&&(x.success("Webhook oluşturuldu"),d())}catch{x.error("Webhook oluşturulamadı")}},"handleCreate");return e.jsx("div",{className:"modal-overlay",onClick:a(i=>i.target.className==="modal-overlay"&&c(),"onClick"),children:e.jsxs("div",{className:"webhook-modal",children:[e.jsxs("h3",{children:[e.jsx($,{})," Yeni Webhook Oluştur"]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Webhook Adı"}),e.jsx("input",{type:"text",value:u,onChange:a(i=>o(i.target.value),"onChange"),placeholder:"örn: GitHub Bot"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kanal"}),e.jsxs("select",{value:s,onChange:a(i=>r(i.target.value),"onChange"),children:[e.jsx("option",{value:"",children:"Kanal seçin..."}),n.map(i=>e.jsx("option",{value:i.id,children:i.name},i.id))]})]}),e.jsxs("div",{className:"modal-actions",children:[e.jsx("button",{className:"cancel-btn",onClick:c,children:"İptal"}),e.jsx("button",{className:"create-btn",onClick:p,children:"Oluştur"})]})]})})},"CreateWebhookModal"),oe=a(({serverId:t,token:l})=>{const[c,d]=m.useState([]),[u,o]=m.useState(!1);m.useEffect(()=>{s()},[]);const s=a(async()=>{try{const n=await fetch(`/api/servers/${t}/webhooks/`,{headers:{Authorization:`Bearer ${l}`}});if(n.ok){const j=await n.json();d(j.webhooks||[])}}catch{}},"fetchWebhooks"),r=a(async n=>{if(await E("Bu webhook'u silmek istediğinize emin misiniz?"))try{(await fetch(`/api/servers/${t}/webhooks/${n}/`,{method:"DELETE",headers:{Authorization:`Bearer ${l}`}})).ok&&(x.success("Webhook silindi"),s())}catch{x.error("Webhook silinemedi")}},"handleDeleteWebhook");return e.jsxs("div",{className:"webhooks-view",children:[e.jsxs("div",{className:"webhooks-header",children:[e.jsx("p",{children:"Webhooks ile dış servislerden otomatik mesajlar alın"}),e.jsxs("button",{className:"create-webhook-btn",onClick:a(()=>o(!0),"onClick"),children:[e.jsx($,{})," Yeni Webhook"]})]}),c.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx(C,{}),e.jsx("p",{children:"Henüz webhook oluşturulmamış"})]}):e.jsx("div",{className:"webhooks-list",children:c.map(n=>e.jsxs("div",{className:"webhook-item",children:[e.jsx("div",{className:"webhook-avatar",children:n.avatar?e.jsx("img",{src:n.avatar,alt:""}):e.jsx(C,{})}),e.jsxs("div",{className:"webhook-info",children:[e.jsx("h4",{children:n.name}),e.jsx("span",{className:"webhook-channel",children:n.channel_name}),e.jsxs("div",{className:"webhook-url",children:[e.jsxs("code",{children:[n.url.substring(0,40),"..."]}),e.jsx("button",{onClick:a(()=>{navigator.clipboard.writeText(n.url),x.success("URL kopyalandı")},"onClick"),children:"Kopyala"})]})]}),e.jsx("div",{className:"webhook-actions",children:e.jsx("button",{className:"action-btn delete",onClick:a(()=>r(n.id),"onClick"),children:e.jsx(B,{})})})]},n.id))}),u&&e.jsx(te,{serverId:t,token:l,onClose:a(()=>o(!1),"onClose"),onCreated:a(()=>{s(),o(!1)},"onCreated")})]})},"WebhooksView"),ie=a(({integration:t,serverId:l,token:c,onClose:d,onSave:u})=>{const[o,s]=m.useState({notifications_enabled:!0,notification_channel:"",auto_sync:!0,sync_interval:30}),r=a(async()=>{try{(await fetch(`/api/servers/${l}/integrations/${t.id}/configure/`,{method:"POST",headers:{Authorization:`Bearer ${c}`,"Content-Type":"application/json"},body:JSON.stringify(o)})).ok&&(x.success("Ayarlar kaydedildi"),u(),d())}catch{x.error("Ayarlar kaydedilemedi")}},"handleSave");return e.jsx("div",{className:"modal-overlay",onClick:a(n=>n.target.className==="modal-overlay"&&d(),"onClick"),children:e.jsxs("div",{className:"config-modal",children:[e.jsxs("h3",{children:[e.jsx(_,{})," ",t.name," Ayarları"]}),e.jsx("div",{className:"config-section",children:e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:o.notifications_enabled,onChange:a(n=>s({...o,notifications_enabled:n.target.checked}),"onChange")}),"Bildirimleri Etkinleştir"]})}),e.jsx("div",{className:"config-section",children:e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:o.auto_sync,onChange:a(n=>s({...o,auto_sync:n.target.checked}),"onChange")}),"Otomatik Senkronizasyon"]})}),o.auto_sync&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Senkronizasyon Aralığı (dakika)"}),e.jsx("input",{type:"number",value:o.sync_interval,onChange:a(n=>s({...o,sync_interval:parseInt(n.target.value)}),"onChange"),min:5,max:1440})]}),e.jsxs("div",{className:"modal-actions",children:[e.jsx("button",{className:"cancel-btn",onClick:d,children:"İptal"}),e.jsxs("button",{className:"save-btn",onClick:r,children:[e.jsx(S,{})," Kaydet"]})]})]})})},"ConfigurationModal"),be=a(({serverId:t,onClose:l})=>{const{activeTab:c,setActiveTab:d,integrations:u,notConnected:o,loading:s,searchTerm:r,setSearchTerm:n,configModal:j,setConfigModal:p,token:i,handleConnect:N,handleDisconnect:k,handleSync:g,fetchIntegrations:w}=se(t);return e.jsx("div",{className:"integration-hub-overlay",onClick:a(v=>v.target.className==="integration-hub-overlay"&&l(),"onClick"),children:e.jsxs("div",{className:"integration-hub-panel",children:[e.jsxs("div",{className:"panel-header",children:[e.jsxs("h2",{children:[e.jsx(f,{})," Entegrasyon Merkezi"]}),e.jsx("button",{className:"close-btn",onClick:l,children:e.jsx(B,{})})]}),e.jsx("div",{className:"tabs-bar",children:e.jsxs("div",{className:"tabs",children:[e.jsxs("button",{className:`tab ${c==="connected"?"active":""}`,onClick:a(()=>d("connected"),"onClick"),children:[e.jsx(A,{})," Bağlı (",u.length,")"]}),e.jsxs("button",{className:`tab ${c==="available"?"active":""}`,onClick:a(()=>d("available"),"onClick"),children:[e.jsx($,{})," Mevcut (",o.length,")"]}),e.jsxs("button",{className:`tab ${c==="webhooks"?"active":""}`,onClick:a(()=>d("webhooks"),"onClick"),children:[e.jsx(C,{})," Webhooks"]})]})}),c==="available"&&e.jsxs("div",{className:"search-bar",children:[e.jsx(Q,{}),e.jsx("input",{type:"text",placeholder:"Entegrasyon ara...",value:r,onChange:a(v=>n(v.target.value),"onChange")})]}),e.jsx("div",{className:"panel-content",children:s?e.jsx("div",{className:"loading",children:"Yükleniyor..."}):e.jsxs(e.Fragment,{children:[c==="connected"&&e.jsx(ae,{integrations:u,icons:F,colors:T,onDisconnect:k,onSync:g,onConfigure:a(v=>p({show:!0,integration:v}),"onConfigure")}),c==="available"&&e.jsx(ne,{integrations:o,icons:F,colors:T,getCategoryIcon:ee,onConnect:N}),c==="webhooks"&&e.jsx(oe,{serverId:t,token:i})]})}),j.show&&e.jsx(ie,{integration:j.integration,serverId:t,token:i,onClose:a(()=>p({show:!1,integration:null}),"onClose"),onSave:w})]})})},"IntegrationHubPanel");export{be as default};
