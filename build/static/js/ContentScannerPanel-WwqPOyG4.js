import{r as g,d as e,af as v,i as F,ay as _,J as C,bD as h,ae as I,bf as L}from"./react-core-CecKX_Gm.js";import{t as r}from"./index-nWEO2Ei4.js";const $=({fetchWithAuth:c,apiBaseUrl:i,onClose:k,messageId:d})=>{const[s,y]=g.useState([]),[w,f]=g.useState(!1),[a,p]=g.useState("all");g.useEffect(()=>{d?x():b()},[d]);const x=async()=>{f(!0);try{const o=await(await c(`${i}/api/messages/${d}/scan_results/`)).json();y(o.results||[])}catch{r.error("Failed to load scan results")}finally{f(!1)}},b=async()=>{f(!0);try{const o=await(await c(`${i}/api/content_scanner/results/`)).json();y(o.results||[])}catch{r.error("Failed to load scan results")}finally{f(!1)}},B=async()=>{try{const o=await(await c(`${i}/api/content_scanner/export/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filter:a})})).blob(),u=window.URL.createObjectURL(o),l=document.createElement("a");l.href=u,l.download=`scan_results_${new Date().toISOString()}.csv`,document.body.appendChild(l),l.click(),l.remove(),r.success("Results exported successfully")}catch{r.error("Failed to export results")}},m=async(n,o)=>{try{await c(`${i}/api/content_scanner/results/${n}/review/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:o})}),r.success(`Content ${o}ed successfully`),d?x():b()}catch{r.error("Failed to review content")}},R=n=>{switch(n){case"safe":return e.createElement(C,{style:{color:"#43b581"}});case"flagged":return e.createElement(L,{style:{color:"#faa61a"}});case"blocked":return e.createElement(h,{style:{color:"#f04747"}});default:return e.createElement(v,null)}},S=n=>{switch(n){case"safe":return"#43b581";case"flagged":return"#faa61a";case"blocked":return"#f04747";default:return"#99aab5"}},E=s.filter(n=>a==="all"?!0:n.status===a);return e.createElement("div",{style:t.overlay},e.createElement("div",{style:t.modal},e.createElement("div",{style:t.header},e.createElement("div",{style:t.headerLeft},e.createElement(v,{style:{marginRight:"10px",color:"#5865f2"}}),e.createElement("h2",{style:t.title},"Content Scanner Results")),e.createElement("button",{onClick:k,style:t.closeButton},e.createElement(F,null))),e.createElement("div",{style:t.filters},e.createElement("button",{onClick:()=>p("all"),style:{...t.filterButton,...a==="all"&&t.filterButtonActive}},"All (",s.length,")"),e.createElement("button",{onClick:()=>p("safe"),style:{...t.filterButton,...a==="safe"&&t.filterButtonActive}},"âœ… Safe (",s.filter(n=>n.status==="safe").length,")"),e.createElement("button",{onClick:()=>p("flagged"),style:{...t.filterButton,...a==="flagged"&&t.filterButtonActive}},"âš ï¸ Flagged (",s.filter(n=>n.status==="flagged").length,")"),e.createElement("button",{onClick:()=>p("blocked"),style:{...t.filterButton,...a==="blocked"&&t.filterButtonActive}},"ðŸš« Blocked (",s.filter(n=>n.status==="blocked").length,")"),e.createElement("button",{onClick:B,style:t.exportButton},e.createElement(_,{style:{marginRight:"5px"}}),"Export")),e.createElement("div",{style:t.content},w?e.createElement("div",{style:t.loading},"Loading scan results..."):E.length===0?e.createElement("div",{style:t.empty},"No scan results found"):e.createElement("div",{style:t.resultsList},E.map((n,o)=>e.createElement("div",{key:o,style:t.resultCard},e.createElement("div",{style:t.resultHeader},e.createElement("div",{style:t.resultStatus},R(n.status),e.createElement("span",{style:{marginLeft:"8px",color:S(n.status),fontWeight:"600"}},n.status.toUpperCase())),e.createElement("div",{style:t.timestamp},new Date(n.scanned_at).toLocaleString())),e.createElement("div",{style:t.resultBody},e.createElement("div",{style:t.resultInfo},e.createElement("div",{style:t.infoRow},e.createElement("strong",null,"Type:")," ",n.content_type),n.confidence_score&&e.createElement("div",{style:t.infoRow},e.createElement("strong",null,"Confidence:"),e.createElement("div",{style:t.progressBar},e.createElement("div",{style:{...t.progressFill,width:`${n.confidence_score}%`,backgroundColor:n.confidence_score>80?"#f04747":n.confidence_score>50?"#faa61a":"#43b581"}})),e.createElement("span",null,n.confidence_score,"%")),n.flags&&n.flags.length>0&&e.createElement("div",{style:t.infoRow},e.createElement("strong",null,"Flags:"),e.createElement("div",{style:t.flags},n.flags.map((u,l)=>e.createElement("span",{key:l,style:t.flag},u)))),n.reason&&e.createElement("div",{style:t.infoRow},e.createElement("strong",null,"Reason:")," ",n.reason)),n.status==="flagged"&&e.createElement("div",{style:t.actions},e.createElement("button",{onClick:()=>m(n.id,"approve"),style:{...t.actionButton,...t.approveButton}},e.createElement(C,{style:{marginRight:"5px"}}),"Approve"),e.createElement("button",{onClick:()=>m(n.id,"block"),style:{...t.actionButton,...t.blockButton}},e.createElement(h,{style:{marginRight:"5px"}}),"Block"),e.createElement("button",{onClick:()=>m(n.id,"ignore"),style:{...t.actionButton,...t.ignoreButton}},e.createElement(I,{style:{marginRight:"5px"}}),"Ignore")))))))))},t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999},modal:{backgroundColor:"#1e1e1e",borderRadius:"8px",width:"90%",maxWidth:"900px",maxHeight:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #2c2f33"},headerLeft:{display:"flex",alignItems:"center"},title:{margin:0,fontSize:"20px",color:"#ffffff"},closeButton:{background:"none",border:"none",color:"#99aab5",cursor:"pointer",fontSize:"20px",padding:"5px"},filters:{display:"flex",gap:"10px",padding:"15px 20px",borderBottom:"1px solid #2c2f33",flexWrap:"wrap"},filterButton:{padding:"8px 16px",backgroundColor:"#2c2f33",border:"none",borderRadius:"4px",color:"#ffffff",cursor:"pointer",fontSize:"14px",transition:"background-color 0.2s"},filterButtonActive:{backgroundColor:"#5865f2"},exportButton:{marginLeft:"auto",padding:"8px 16px",backgroundColor:"#43b581",border:"none",borderRadius:"4px",color:"#ffffff",cursor:"pointer",fontSize:"14px",display:"flex",alignItems:"center"},content:{padding:"20px",overflowY:"auto",flex:1},loading:{textAlign:"center",color:"#99aab5",padding:"40px"},empty:{textAlign:"center",color:"#99aab5",padding:"40px"},resultsList:{display:"flex",flexDirection:"column",gap:"15px"},resultCard:{backgroundColor:"#2c2f33",borderRadius:"6px",padding:"15px"},resultHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},resultStatus:{display:"flex",alignItems:"center",fontSize:"14px"},timestamp:{fontSize:"12px",color:"#99aab5"},resultBody:{display:"flex",flexDirection:"column",gap:"15px"},resultInfo:{display:"flex",flexDirection:"column",gap:"8px"},infoRow:{display:"flex",alignItems:"center",gap:"10px",fontSize:"14px",color:"#dcddde"},progressBar:{flex:1,height:"8px",backgroundColor:"#1e1e1e",borderRadius:"4px",overflow:"hidden"},progressFill:{height:"100%",transition:"width 0.3s"},flags:{display:"flex",flexWrap:"wrap",gap:"5px"},flag:{padding:"4px 8px",backgroundColor:"#f04747",borderRadius:"4px",fontSize:"12px",color:"#ffffff"},actions:{display:"flex",gap:"10px",justifyContent:"flex-end"},actionButton:{padding:"8px 16px",border:"none",borderRadius:"4px",color:"#ffffff",cursor:"pointer",fontSize:"14px",display:"flex",alignItems:"center"},approveButton:{backgroundColor:"#43b581"},blockButton:{backgroundColor:"#f04747"},ignoreButton:{backgroundColor:"#99aab5"}};export{$ as default};
