import{r,j as e}from"./react-core-D6cE4lil.js";import{b3 as I,cq as w,aG as R,a as F,bN as B,v as V,x as z,bM as A,cr as M}from"./icons-vendor-DT2gd7vx.js";const P=l=>{const s=Math.floor(l/60),i=l%60;return`${s.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}`};function D(l,s,i){const[b,c]=r.useState(!1),[f,y]=r.useState(!1),[x,a]=r.useState(""),[d,h]=r.useState(""),[u,o]=r.useState({cameras:[],microphones:[]}),[n,p]=r.useState("720p"),v=r.useRef(null),j=r.useRef(null),S=r.useRef(null);return r.useEffect(()=>{l&&(async()=>{try{const g=await navigator.mediaDevices.enumerateDevices(),m=g.filter(k=>k.kind==="videoinput"),C=g.filter(k=>k.kind==="audioinput");o({cameras:m,microphones:C}),m.length>0&&!x&&a(m[0].deviceId),C.length>0&&!d&&h(C[0].deviceId)}catch{}})()},[l]),r.useEffect(()=>{v.current&&s&&(v.current.srcObject=s)},[s]),r.useEffect(()=>{j.current&&i&&(j.current.srcObject=i)},[i]),{isFullscreen:b,showSettings:f,setShowSettings:y,selectedCamera:x,setSelectedCamera:a,selectedMicrophone:d,setSelectedMicrophone:h,devices:u,videoQuality:n,setVideoQuality:p,localVideoRef:v,remoteVideoRef:j,containerRef:S,toggleFullscreen:async()=>{if(document.fullscreenElement)await document.exitFullscreen(),c(!1);else try{await S.current?.requestFullscreen(),c(!0)}catch{}}}}const t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.95)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center"},container:{width:"100%",height:"100%",backgroundColor:"#1e1f22",display:"flex",flexDirection:"column",position:"relative"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 24px",backgroundColor:"#2f3136",borderBottom:"1px solid #1e1f22"},headerInfo:{display:"flex",alignItems:"center",gap:"12px"},avatar:{width:"40px",height:"40px",borderRadius:"50%",backgroundColor:"#5865f2",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"18px",fontWeight:"bold",color:"#fff"},userInfo:{display:"flex",flexDirection:"column",gap:"4px"},username:{fontSize:"16px",fontWeight:"bold",color:"#fff"},status:{fontSize:"13px",color:"#b9bbbe"},headerActions:{display:"flex",gap:"8px"},headerButton:{backgroundColor:"transparent",border:"none",color:"#b9bbbe",fontSize:"18px",cursor:"pointer",padding:"8px",borderRadius:"4px",transition:"background-color 0.2s"},closeButton:{backgroundColor:"#f04747",border:"none",color:"#fff",fontSize:"18px",cursor:"pointer",padding:"8px 12px",borderRadius:"4px"},settingsPanel:{position:"absolute",top:"70px",right:"24px",backgroundColor:"#2f3136",border:"1px solid #1e1f22",borderRadius:"8px",padding:"16px",width:"280px",zIndex:100,boxShadow:"0 8px 16px rgba(0,0,0,0.4)"},settingsTitle:{fontSize:"14px",fontWeight:"bold",color:"#fff",marginBottom:"12px"},settingGroup:{marginBottom:"12px"},settingLabel:{display:"block",fontSize:"12px",color:"#b9bbbe",marginBottom:"6px"},settingSelect:{width:"100%",backgroundColor:"#40444b",border:"1px solid #1e1f22",borderRadius:"4px",padding:"8px",color:"#dcddde",fontSize:"13px"},videoGrid:{flex:1,position:"relative",backgroundColor:"#000"},remoteVideoContainer:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},remoteVideo:{width:"100%",height:"100%",objectFit:"contain"},videoPlaceholder:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"16px",color:"#b9bbbe"},placeholderAvatar:{width:"120px",height:"120px",borderRadius:"50%",backgroundColor:"#5865f2",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"48px",fontWeight:"bold",color:"#fff"},localVideoContainer:{position:"absolute",bottom:"100px",right:"24px",width:"240px",height:"180px",borderRadius:"8px",overflow:"hidden",border:"2px solid #5865f2",backgroundColor:"#000",boxShadow:"0 4px 12px rgba(0,0,0,0.5)"},localVideo:{width:"100%",height:"100%",objectFit:"cover",transform:"scaleX(-1)"},localVideoPlaceholder:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#2f3136"},placeholderAvatarSmall:{width:"60px",height:"60px",borderRadius:"50%",backgroundColor:"#5865f2",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"24px",fontWeight:"bold",color:"#fff"},controls:{display:"flex",justifyContent:"center",alignItems:"center",gap:"16px",padding:"24px",backgroundColor:"#2f3136"},controlButton:{width:"56px",height:"56px",borderRadius:"50%",border:"none",backgroundColor:"#40444b",color:"#fff",fontSize:"20px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},controlButtonActive:{backgroundColor:"#f04747"},hangupButton:{width:"56px",height:"56px",borderRadius:"50%",border:"none",backgroundColor:"#f04747",color:"#fff",fontSize:"20px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"}},W=({isOpen:l,onClose:s,targetUser:i,currentUser:b,localStream:c,remoteStream:f,onToggleVideo:y,onToggleMute:x,isVideoEnabled:a,isMuted:d,callDuration:h=0,callStatus:u="connecting"})=>{const o=D(l,c,f);return l?e.jsx("div",{style:t.overlay,children:e.jsxs("div",{ref:o.containerRef,style:t.container,children:[e.jsxs("div",{style:t.header,children:[e.jsxs("div",{style:t.headerInfo,children:[e.jsx("div",{style:t.avatar,children:i?.username?.[0]?.toUpperCase()||"U"}),e.jsxs("div",{style:t.userInfo,children:[e.jsx("span",{style:t.username,children:i?.username||"Unknown"}),e.jsxs("span",{style:t.status,children:[u==="connecting"&&"ðŸ”„ BaÄŸlanÄ±yor...",u==="active"&&`â±ï¸ ${P(h)}`,u==="ended"&&"ðŸ“ž Arama sona erdi"]})]})]}),e.jsxs("div",{style:t.headerActions,children:[e.jsx("button",{onClick:()=>o.setShowSettings(!o.showSettings),style:t.headerButton,title:"Ayarlar",children:e.jsx(I,{})}),e.jsx("button",{onClick:o.toggleFullscreen,style:t.headerButton,title:"Tam ekran",children:o.isFullscreen?e.jsx(w,{}):e.jsx(R,{})}),e.jsx("button",{onClick:s,style:t.closeButton,title:"Kapat",children:e.jsx(F,{})})]})]}),o.showSettings&&e.jsxs("div",{style:t.settingsPanel,children:[e.jsx("h4",{style:t.settingsTitle,children:"Video Ayarlar\\u0131"}),e.jsxs("div",{style:t.settingGroup,children:[e.jsx("label",{style:t.settingLabel,children:"Kamera"}),e.jsx("select",{value:o.selectedCamera,onChange:n=>o.setSelectedCamera(n.target.value),style:t.settingSelect,children:o.devices.cameras.map((n,p)=>e.jsx("option",{value:n.deviceId,children:n.label||`Kamera ${p+1}`},n.deviceId))})]}),e.jsxs("div",{style:t.settingGroup,children:[e.jsx("label",{style:t.settingLabel,children:"Mikrofon"}),e.jsx("select",{value:o.selectedMicrophone,onChange:n=>o.setSelectedMicrophone(n.target.value),style:t.settingSelect,children:o.devices.microphones.map((n,p)=>e.jsx("option",{value:n.deviceId,children:n.label||`Mikrofon ${p+1}`},n.deviceId))})]}),e.jsxs("div",{style:t.settingGroup,children:[e.jsx("label",{style:t.settingLabel,children:"Kalite"}),e.jsxs("select",{value:o.videoQuality,onChange:n=>o.setVideoQuality(n.target.value),style:t.settingSelect,children:[e.jsx("option",{value:"480p",children:"480p (D\\u00fc\\u015f\\u00fck)"}),e.jsx("option",{value:"720p",children:"720p (Orta)"}),e.jsx("option",{value:"1080p",children:"1080p (Y\\u00fcksek)"})]})]})]}),e.jsxs("div",{style:t.videoGrid,children:[e.jsx("div",{style:t.remoteVideoContainer,children:f?e.jsx("video",{ref:o.remoteVideoRef,autoPlay:!0,playsInline:!0,style:t.remoteVideo}):e.jsxs("div",{style:t.videoPlaceholder,children:[e.jsx("div",{style:t.placeholderAvatar,children:i?.username?.[0]?.toUpperCase()||"U"}),e.jsx("p",{children:"Kamera a\\u00e7\\u0131lmad\\u0131"})]})}),e.jsx("div",{style:t.localVideoContainer,children:c&&a?e.jsx("video",{ref:o.localVideoRef,autoPlay:!0,playsInline:!0,muted:!0,style:t.localVideo}):e.jsx("div",{style:t.localVideoPlaceholder,children:e.jsx("div",{style:t.placeholderAvatarSmall,children:b?.[0]?.toUpperCase()||"M"})})})]}),e.jsxs("div",{style:t.controls,children:[e.jsx("button",{onClick:x,style:{...t.controlButton,...d&&t.controlButtonActive},title:d?"Mikrofonu aÃ§":"Mikrofonu kapat",children:d?e.jsx(B,{}):e.jsx(V,{})}),e.jsx("button",{onClick:y,style:{...t.controlButton,...!a&&t.controlButtonActive},title:a?"KamerayÄ± kapat":"KamerayÄ± aÃ§",children:a?e.jsx(z,{}):e.jsx(A,{})}),e.jsx("button",{onClick:s,style:t.hangupButton,title:"Aramay\\u0131 sonland\\u0131r",children:e.jsx(M,{style:{transform:"rotate(135deg)"}})})]})]})}):null};export{W as default};
