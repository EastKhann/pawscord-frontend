var A=Object.defineProperty;var t=(c,m)=>A(c,"name",{value:m,configurable:!0});import{r as o,j as e}from"./react-core-Djgtqrmb.js";import{y as r}from"./ui-vendor-IhB9Znpc.js";import{g as L,d as R}from"./index-m2zCEI_Z.js";import"./media-vendor-CxFPycob.js";import"./router-vendor-gmJ9Mn-1.js";import"./state-vendor-BRqaXHJQ.js";import"./crypto-vendor-D1XRGppi.js";import"./icons-vendor-BW7dxHkX.js";const I=t(({serverId:c,onClose:m})=>{const d=L(),[p,b]=o.useState([]),[g,N]=o.useState([]),[k,y]=o.useState(!0),[h,f]=o.useState(!1),[a,l]=o.useState({title:"",description:"",color:"#5865f2",thumbnail:"",image:"",author_name:"",author_icon:"",footer_text:"",footer_icon:"",fields:[]}),[u,_]=o.useState("");o.useEffect(()=>{x(),C()},[c]);const x=t(async()=>{try{const s=await fetch(`${d}/custom-embeds/server/${c}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(s.ok){const i=await s.json();b(i)}}catch{}finally{y(!1)}},"fetchEmbeds"),C=t(async()=>{try{const s=await fetch(`${d}/channels/server/${c}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(s.ok){const i=await s.json();N(i.filter(n=>n.type==="text"))}}catch{}},"fetchChannels"),E=t(async()=>{if(!a.title&&!a.description){r.error("âŒ En az baÅŸlÄ±k veya aÃ§Ä±klama gerekli");return}try{(await fetch(`${d}/custom-embeds/save/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`,"Content-Type":"application/json"},body:JSON.stringify({server_id:c,...a})})).ok?(r.success("âœ… Embed kaydedildi"),f(!1),x(),B()):r.error("âŒ Kaydetme hatasÄ±")}catch{r.error("âŒ BaÄŸlantÄ± hatasÄ±")}},"saveEmbed"),S=t(async s=>{if(!u){r.error("âŒ LÃ¼tfen bir kanal seÃ§in");return}try{(await fetch(`${d}/custom-embeds/${s}/send/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`,"Content-Type":"application/json"},body:JSON.stringify({channel_id:u})})).ok?r.success("âœ… Embed gÃ¶nderildi"):r.error("âŒ GÃ¶nderim hatasÄ±")}catch{r.error("âŒ BaÄŸlantÄ± hatasÄ±")}},"sendEmbed"),w=t(async s=>{if(await R("Embed'i silmek istediÄŸinize emin misiniz?"))try{(await fetch(`${d}/custom-embeds/${s}/delete/`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}})).ok&&(r.success("âœ… Embed silindi"),x())}catch{r.error("âŒ Silme hatasÄ±")}},"deleteEmbed"),z=t(()=>{l({...a,fields:[...a.fields,{name:"",value:"",inline:!1}]})},"addField"),j=t((s,i,n)=>{const v=[...a.fields];v[s][i]=n,l({...a,fields:v})},"updateField"),$=t(s=>{l({...a,fields:a.fields.filter((i,n)=>n!==s)})},"removeField"),B=t(()=>{l({title:"",description:"",color:"#5865f2",thumbnail:"",image:"",author_name:"",author_icon:"",footer_text:"",footer_icon:"",fields:[]})},"resetEmbed");return e.jsx("div",{className:"custom-embed-overlay",onClick:m,children:e.jsxs("div",{className:"custom-embed-panel",onClick:t(s=>s.stopPropagation(),"onClick"),children:[e.jsxs("div",{className:"custom-embed-header",children:[e.jsx("h2",{children:"ğŸ“ Ã–zel Embed OluÅŸturucu"}),e.jsx("button",{className:"close-btn",onClick:m,children:"Ã—"})]}),e.jsxs("div",{className:"custom-embed-content",children:[e.jsx("button",{className:"create-embed-btn",onClick:t(()=>f(!h),"onClick"),children:h?"âŒ DÃ¼zenleyiciyi Kapat":"+ Yeni Embed OluÅŸtur"}),h&&e.jsxs("div",{className:"embed-editor",children:[e.jsxs("div",{className:"editor-form",children:[e.jsxs("div",{className:"form-section",children:[e.jsx("h3",{children:"Yazar"}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Ä°sim"}),e.jsx("input",{value:a.author_name,onChange:t(s=>l({...a,author_name:s.target.value}),"onChange"),placeholder:"Yazar adÄ±"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Ä°kon URL"}),e.jsx("input",{value:a.author_icon,onChange:t(s=>l({...a,author_icon:s.target.value}),"onChange"),placeholder:"https://..."})]})]})]}),e.jsxs("div",{className:"form-section",children:[e.jsx("h3",{children:"Ä°Ã§erik"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"BaÅŸlÄ±k"}),e.jsx("input",{value:a.title,onChange:t(s=>l({...a,title:s.target.value}),"onChange"),placeholder:"Embed baÅŸlÄ±ÄŸÄ±"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"AÃ§Ä±klama"}),e.jsx("textarea",{value:a.description,onChange:t(s=>l({...a,description:s.target.value}),"onChange"),rows:"4",placeholder:"Embed aÃ§Ä±klamasÄ±"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Renk"}),e.jsx("input",{type:"color",value:a.color,onChange:t(s=>l({...a,color:s.target.value}),"onChange")})]})]}),e.jsxs("div",{className:"form-section",children:[e.jsx("h3",{children:"GÃ¶rseller"}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"KÃ¼Ã§Ã¼k Resim URL"}),e.jsx("input",{value:a.thumbnail,onChange:t(s=>l({...a,thumbnail:s.target.value}),"onChange"),placeholder:"https://..."})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"BÃ¼yÃ¼k Resim URL"}),e.jsx("input",{value:a.image,onChange:t(s=>l({...a,image:s.target.value}),"onChange"),placeholder:"https://..."})]})]})]}),e.jsxs("div",{className:"form-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h3",{children:"Alanlar"}),e.jsx("button",{className:"add-field-btn",onClick:z,children:"+ Alan Ekle"})]}),a.fields.map((s,i)=>e.jsx("div",{className:"field-item",children:e.jsxs("div",{className:"field-inputs",children:[e.jsx("input",{value:s.name,onChange:t(n=>j(i,"name",n.target.value),"onChange"),placeholder:"Alan adÄ±"}),e.jsx("input",{value:s.value,onChange:t(n=>j(i,"value",n.target.value),"onChange"),placeholder:"Alan deÄŸeri"}),e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:s.inline,onChange:t(n=>j(i,"inline",n.target.checked),"onChange")}),e.jsx("span",{children:"Inline"})]}),e.jsx("button",{className:"remove-field-btn",onClick:t(()=>$(i),"onClick"),children:"ğŸ—‘ï¸"})]})},i))]}),e.jsxs("div",{className:"form-section",children:[e.jsx("h3",{children:"Footer"}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Metin"}),e.jsx("input",{value:a.footer_text,onChange:t(s=>l({...a,footer_text:s.target.value}),"onChange"),placeholder:"Footer metni"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Ä°kon URL"}),e.jsx("input",{value:a.footer_icon,onChange:t(s=>l({...a,footer_icon:s.target.value}),"onChange"),placeholder:"https://..."})]})]})]}),e.jsx("button",{className:"save-embed-btn",onClick:E,children:"ğŸ’¾ Kaydet"})]}),e.jsxs("div",{className:"embed-preview",children:[e.jsx("h3",{children:"Ã–nizleme"}),e.jsxs("div",{className:"discord-embed",style:{borderLeftColor:a.color},children:[a.author_name&&e.jsxs("div",{className:"embed-author",children:[a.author_icon&&e.jsx("img",{src:a.author_icon,alt:""}),e.jsx("span",{children:a.author_name})]}),a.title&&e.jsx("div",{className:"embed-title",children:a.title}),a.description&&e.jsx("div",{className:"embed-description",children:a.description}),a.fields.length>0&&e.jsx("div",{className:"embed-fields",children:a.fields.map((s,i)=>e.jsxs("div",{className:`embed-field ${s.inline?"inline":""}`,children:[e.jsx("div",{className:"field-name",children:s.name}),e.jsx("div",{className:"field-value",children:s.value})]},i))}),a.image&&e.jsx("img",{className:"embed-image",src:a.image,alt:""}),a.footer_text&&e.jsxs("div",{className:"embed-footer",children:[a.footer_icon&&e.jsx("img",{src:a.footer_icon,alt:""}),e.jsx("span",{children:a.footer_text})]})]})]})]}),k?e.jsxs("div",{className:"loading-state",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{children:"YÃ¼kleniyor..."})]}):p.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("span",{className:"empty-icon",children:"ğŸ“"}),e.jsx("p",{children:"HenÃ¼z kayÄ±tlÄ± embed yok"})]}):e.jsx("div",{className:"embeds-list",children:p.map(s=>e.jsxs("div",{className:"embed-card",children:[e.jsxs("div",{className:"embed-info",children:[e.jsx("h4",{children:s.title||"BaÅŸlÄ±ksÄ±z Embed"}),e.jsxs("p",{children:[s.description?.substring(0,100),s.description?.length>100?"...":""]})]}),e.jsxs("div",{className:"embed-actions",children:[e.jsxs("select",{value:u,onChange:t(i=>_(i.target.value),"onChange"),children:[e.jsx("option",{value:"",children:"Kanal seÃ§"}),g.map(i=>e.jsx("option",{value:i.id,children:i.name},i.id))]}),e.jsx("button",{onClick:t(()=>S(s.id),"onClick"),children:"ğŸ“¤ GÃ¶nder"}),e.jsx("button",{onClick:t(()=>w(s.id),"onClick"),children:"ğŸ—‘ï¸"})]})]},s.id))})]})]})})},"CustomEmbedPanel");export{I as default};
