import{r as n,n as e}from"./react-core-BMiyQWF6.js";import{t as c}from"./index-CbrAkfmn.js";import{G as v,c3 as f,q as k,ay as S,ae as D,bq as M}from"./icons-vendor-T72gfvdf.js";import"./editor-vendor-D9c4a6XZ.js";import"./media-vendor-BuSyE8vR.js";import"./router-vendor-B86Z1mIL.js";import"./state-vendor-CAyNnPM4.js";import"./crypto-vendor-1Q6e4ZD-.js";const H=({username:z,apiBaseUrl:u,fetchWithAuth:h,currentRoomSlug:C})=>{const[r,x]=n.useState("chat"),[b,j]=n.useState([]),[o,d]=n.useState(""),[m,l]=n.useState(!1),[p,w]=n.useState({used:0,limit:100}),[y,A]=n.useState([]),g=n.useRef(null);n.useEffect(()=>{N()},[]),n.useEffect(()=>{I()},[b]);const I=()=>{g.current?.scrollIntoView({behavior:"smooth"})},N=async()=>{try{const a=await(await h(`${u}/ai/quota/`)).json();w(a)}catch{}},$=async s=>{if(s.preventDefault(),!o.trim()||m)return;const a=o.trim();d(""),j(t=>[...t,{role:"user",content:a,timestamp:new Date}]),l(!0);try{const i=await(await h(`${u}/ai/chat/`,{method:"POST",body:JSON.stringify({message:a,context:C||"general"})})).json();j(q=>[...q,{role:"assistant",content:i.response,timestamp:new Date}]),N(),c.success("ğŸ¤– AI yanÄ±tladÄ±!")}catch{c.error("âŒ AI hatasÄ±!"),j(i=>[...i,{role:"assistant",content:"ÃœzgÃ¼nÃ¼m, bir hata oluÅŸtu.",timestamp:new Date,error:!0}])}finally{l(!1)}},R=async s=>{l(!0);try{const t=await(await h(`${u}/ai/smart-reply/`,{method:"POST",body:JSON.stringify({message_id:s,count:3})})).json();A(t.suggestions||[]),c.success("ğŸ’¡ AkÄ±llÄ± cevaplar hazÄ±r!")}catch{c.error("âŒ AkÄ±llÄ± cevap hatasÄ±!")}finally{l(!1)}},K=async s=>{l(!0);try{const t=await(await h(`${u}/ai/summarize/`,{method:"POST",body:JSON.stringify({message_ids:s,max_length:200})})).json();j(i=>[...i,{role:"assistant",content:`ğŸ“ **Ã–zet:**

${t.summary}`,timestamp:new Date,type:"summary"}]),c.success("ğŸ“ Mesajlar Ã¶zetlendi!")}catch{c.error("âŒ Ã–zetleme hatasÄ±!")}finally{l(!1)}},O=async s=>{l(!0);try{const t=await(await h(`${u}/ai/code/`,{method:"POST",body:JSON.stringify({prompt:s,language:"javascript"})})).json();j(i=>[...i,{role:"assistant",content:`\`\`\`${t.language}
${t.code}
\`\`\`

${t.explanation||""}`,timestamp:new Date,type:"code"}]),c.success("ğŸ’» Kod oluÅŸturuldu!")}catch{c.error("âŒ Kod Ã¼retme hatasÄ±!")}finally{l(!1)}},T=()=>{const s=p.used/p.limit*100,a=s>90?"#ed4245":s>70?"#faa61a":"#43b581";return e.jsxs("div",{className:"ai-quota-container",children:[e.jsxs("div",{className:"ai-quota-info",children:[e.jsx(M,{}),e.jsxs("span",{children:["AI KullanÄ±m: ",p.used," / ",p.limit]})]}),e.jsx("div",{className:"ai-quota-bar",children:e.jsx("div",{className:"ai-quota-fill",style:{width:`${s}%`,backgroundColor:a}})})]})};return e.jsxs("div",{className:"ai-chatbot-panel",children:[e.jsxs("div",{className:"ai-header",children:[e.jsxs("div",{className:"ai-header-left",children:[e.jsx(v,{size:28}),e.jsxs("div",{children:[e.jsx("h3",{className:"ai-title",children:"AI Assistant"}),e.jsx("p",{className:"ai-subtitle",children:"Discord'u geÃ§en AI Ã¶zellikleri"})]})]}),T()]}),e.jsxs("div",{className:"ai-tabs",children:[e.jsxs("button",{className:r==="chat"?"active":"",onClick:()=>x("chat"),children:[e.jsx(v,{})," Chat"]}),e.jsxs("button",{className:r==="smart-reply"?"active":"",onClick:()=>x("smart-reply"),children:[e.jsx(f,{})," Smart Reply"]}),e.jsxs("button",{className:r==="summarize"?"active":"",onClick:()=>x("summarize"),children:[e.jsx(k,{})," Ã–zetle"]}),e.jsxs("button",{className:r==="code"?"active":"",onClick:()=>x("code"),children:[e.jsx(S,{})," Kod OluÅŸtur"]})]}),r==="chat"&&e.jsxs("div",{className:"ai-chat-container",children:[e.jsxs("div",{className:"ai-messages",children:[b.length===0?e.jsxs("div",{className:"ai-empty-state",children:[e.jsx(v,{size:48}),e.jsx("h4",{children:"AI Assistant'a HoÅŸ Geldin!"}),e.jsx("p",{children:"Soru sor, kod yazdÄ±r, mesajlarÄ± Ã¶zetle veya aÃ§Ä±klama iste."}),e.jsxs("div",{className:"ai-suggestions",children:[e.jsx("button",{onClick:()=>d("JavaScript ile bir todo list nasÄ±l yapÄ±lÄ±r?"),children:"ğŸ’» Kod Ã¶rneÄŸi iste"}),e.jsx("button",{onClick:()=>d("React hooks nedir?"),children:"ğŸ“ Kavram aÃ§Ä±kla"}),e.jsx("button",{onClick:()=>d("BugÃ¼n hava nasÄ±l?"),children:"ğŸ’¬ Sohbet et"})]})]}):b.map((s,a)=>e.jsxs("div",{className:`ai-message ${s.role} ${s.error?"error":""}`,children:[e.jsx("div",{className:"ai-message-avatar",children:s.role==="user"?"ğŸ‘¤":"ğŸ¤–"}),e.jsxs("div",{className:"ai-message-content",children:[e.jsxs("div",{className:"ai-message-header",children:[e.jsx("strong",{children:s.role==="user"?z:"AI Assistant"}),e.jsx("span",{className:"ai-message-time",children:s.timestamp.toLocaleTimeString("tr-TR",{hour:"2-digit",minute:"2-digit"})})]}),e.jsx("div",{className:"ai-message-text",children:s.content.split("```").map((t,i)=>i%2===0?e.jsx("span",{children:t},i):e.jsx("pre",{className:"ai-code-block",children:e.jsx("code",{children:t})},i))})]})]},a)),e.jsx("div",{ref:g})]}),e.jsxs("form",{onSubmit:$,className:"ai-input-form",children:[e.jsx("input",{type:"text",value:o,onChange:s=>d(s.target.value),placeholder:"AI'ya bir ÅŸey sor...",disabled:m,className:"ai-input"}),e.jsx("button",{type:"submit",disabled:m||!o.trim(),className:"ai-send-btn",children:m?"â³":e.jsx(D,{})})]})]}),r==="smart-reply"&&e.jsxs("div",{className:"ai-feature-container",children:[e.jsxs("div",{className:"ai-feature-header",children:[e.jsx(f,{size:32}),e.jsx("h4",{children:"AkÄ±llÄ± Cevap Ã–nerileri"}),e.jsx("p",{children:"Mesajlara otomatik yanÄ±t Ã¶nerileri"})]}),e.jsx("button",{onClick:()=>R("last-message-id"),disabled:m,className:"ai-action-btn",children:"ğŸ’¡ Son Mesaja AkÄ±llÄ± Cevap Ã–ner"}),y.length>0&&e.jsxs("div",{className:"ai-smart-replies",children:[e.jsx("h5",{children:"Ã–nerilen Cevaplar:"}),y.map((s,a)=>e.jsxs("div",{className:"ai-smart-reply-item",children:[e.jsx("span",{children:s}),e.jsx("button",{onClick:()=>d(s),children:"Kullan"})]},a))]})]}),r==="summarize"&&e.jsxs("div",{className:"ai-feature-container",children:[e.jsxs("div",{className:"ai-feature-header",children:[e.jsx(k,{size:32}),e.jsx("h4",{children:"Mesaj Ã–zetleme"}),e.jsx("p",{children:"Uzun konuÅŸmalarÄ± tek paragrafta Ã¶zetle"})]}),e.jsx("button",{onClick:()=>K(["msg1","msg2","msg3"]),disabled:m,className:"ai-action-btn",children:"ğŸ“ Son 50 MesajÄ± Ã–zetle"})]}),r==="code"&&e.jsxs("div",{className:"ai-feature-container",children:[e.jsxs("div",{className:"ai-feature-header",children:[e.jsx(S,{size:32}),e.jsx("h4",{children:"Kod Ãœretimi"}),e.jsx("p",{children:"AI ile kod yaz, GitHub Copilot gibi"})]}),e.jsxs("form",{onSubmit:s=>{s.preventDefault(),O(o)},className:"ai-code-form",children:[e.jsx("textarea",{value:o,onChange:s=>d(s.target.value),placeholder:"Ne yapmak istiyorsun? Ã–rn: 'React'te bir sayaÃ§ komponenti yap'",rows:4,className:"ai-code-textarea"}),e.jsx("button",{type:"submit",disabled:m||!o.trim(),className:"ai-action-btn",children:"ğŸ’» Kod Ãœret"})]})]})]})};export{H as default};
