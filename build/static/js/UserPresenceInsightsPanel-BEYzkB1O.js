import{r as s,n as F,bQ as C,aE as d,l as w,Y as p,d1 as A,L as N,K as M,am as S,aj as y,aW as h,d2 as g,cN as $,ak as P,al as T,bK as U}from"./react-core-B6hadH-M.js";import{g as z}from"./index-D_6pZib5.js";const G=({userId:o,username:u,onClose:n,fetchWithAuth:v})=>{const[a,r]=s.useState(null),[b,E]=s.useState(!0),[c,i]=s.useState("overview"),R=s.useCallback(async()=>{E(!0);try{const e=await v(`${z()}/users/${o}/presence-insights/`);if(e.ok){const t=await e.json();r(t)}else r({user:{username:u||"User",status:"online",joined:"2024-03-15",timezone:"UTC+3"},activity_summary:{total_online_hours:847,messages_sent:12453,voice_hours:234,servers_active:8,reactions_given:3421},active_hours:Array(24).fill(0).map((t,f)=>({hour:f,activity:Math.random()*100})),weekly_pattern:[{day:"Mon",activity:65},{day:"Tue",activity:72},{day:"Wed",activity:80},{day:"Thu",activity:75},{day:"Fri",activity:90},{day:"Sat",activity:100},{day:"Sun",activity:85}],status_distribution:{online:45,idle:25,dnd:15,offline:15},top_activities:[{name:"Gaming",hours:156,icon:"gaming"},{name:"Music",hours:89,icon:"music"},{name:"Voice Chat",hours:234,icon:"voice"},{name:"Streaming",hours:45,icon:"stream"}],engagement_score:87,peak_time:{start:20,end:23},preferred_timezone:"Evening (8PM - 11PM)"})}catch(e){console.error("Error loading insights:",e),r(null)}E(!1)},[o,u,v]);s.useEffect(()=>{R()},[R]);const l=e=>e>=1e6?(e/1e6).toFixed(1)+"M":e>=1e3?(e/1e3).toFixed(1)+"K":e?.toString()||"0",m=e=>{switch(e){case"online":return"#10b981";case"idle":return"#f59e0b";case"dnd":return"#ef4444";default:return"#6b7280"}},k=e=>{switch(e){case"gaming":return React.createElement(h,null);case"music":return React.createElement(U,null);case"voice":return React.createElement(N,null);case"stream":return React.createElement(y,null);default:return React.createElement(T,null)}},_=()=>a?.active_hours?Math.max(...a.active_hours.map(e=>e.activity),1):1;return b?React.createElement("div",{className:"presence-insights-overlay",onClick:n},React.createElement("div",{className:"presence-insights-panel",onClick:e=>e.stopPropagation()},React.createElement("div",{className:"loading-state"},React.createElement(F,{className:"spin"}),React.createElement("span",null,"Analyzing activity patterns...")))):React.createElement("div",{className:"presence-insights-overlay",onClick:n},React.createElement("div",{className:"presence-insights-panel",onClick:e=>e.stopPropagation()},React.createElement("div",{className:"panel-header"},React.createElement("div",{className:"user-header"},React.createElement("div",{className:"user-avatar-large"},React.createElement("span",null,(a?.user?.username||"U").charAt(0).toUpperCase()),React.createElement("div",{className:"status-indicator",style:{backgroundColor:m(a?.user?.status)}})),React.createElement("div",{className:"user-info"},React.createElement("h2",null,a?.user?.username||"User"),React.createElement("div",{className:"user-meta"},React.createElement("span",null,React.createElement(C,null)," Joined ",a?.user?.joined||"N/A"),React.createElement("span",null,React.createElement(d,null)," ",a?.user?.timezone||"Unknown")))),React.createElement("div",{className:"engagement-score"},React.createElement("div",{className:"score-circle"},React.createElement("span",{className:"score-value"},a?.engagement_score||0)),React.createElement("span",{className:"score-label"},"Engagement")),React.createElement("button",{className:"close-btn",onClick:n},React.createElement(w,null))),React.createElement("div",{className:"stats-bar"},React.createElement("div",{className:"stat"},React.createElement(p,null),React.createElement("span",{className:"stat-value"},l(a?.activity_summary?.total_online_hours),"h"),React.createElement("span",{className:"stat-label"},"Online")),React.createElement("div",{className:"stat"},React.createElement(A,null),React.createElement("span",{className:"stat-value"},l(a?.activity_summary?.messages_sent)),React.createElement("span",{className:"stat-label"},"Messages")),React.createElement("div",{className:"stat"},React.createElement(N,null),React.createElement("span",{className:"stat-value"},l(a?.activity_summary?.voice_hours),"h"),React.createElement("span",{className:"stat-label"},"Voice")),React.createElement("div",{className:"stat"},React.createElement(M,null),React.createElement("span",{className:"stat-value"},a?.activity_summary?.servers_active||0),React.createElement("span",{className:"stat-label"},"Servers")),React.createElement("div",{className:"stat"},React.createElement(S,null),React.createElement("span",{className:"stat-value"},l(a?.activity_summary?.reactions_given)),React.createElement("span",{className:"stat-label"},"Reactions"))),React.createElement("div",{className:"tabs"},React.createElement("button",{className:`tab ${c==="overview"?"active":""}`,onClick:()=>i("overview")},React.createElement(y,null)," Overview"),React.createElement("button",{className:`tab ${c==="schedule"?"active":""}`,onClick:()=>i("schedule")},React.createElement(p,null)," Activity Schedule"),React.createElement("button",{className:`tab ${c==="activities"?"active":""}`,onClick:()=>i("activities")},React.createElement(h,null)," Activities")),React.createElement("div",{className:"tab-content"},c==="overview"&&React.createElement("div",{className:"overview-tab"},React.createElement("div",{className:"peak-info"},React.createElement("div",{className:"peak-card"},React.createElement(g,{className:"peak-icon day"}),React.createElement("div",{className:"peak-content"},React.createElement("span",{className:"peak-label"},"Peak Activity Time"),React.createElement("span",{className:"peak-value"},a?.preferred_timezone)))),React.createElement("div",{className:"section"},React.createElement("h3",null,"Status Distribution"),React.createElement("div",{className:"status-bars"},Object.entries(a?.status_distribution||{}).map(([e,t])=>React.createElement("div",{key:e,className:"status-bar-item"},React.createElement("div",{className:"status-bar-header"},React.createElement("span",{className:"status-name",style:{color:m(e)}},e.toUpperCase()),React.createElement("span",{className:"status-percent"},t,"%")),React.createElement("div",{className:"status-bar-track"},React.createElement("div",{className:"status-bar-fill",style:{width:`${t}%`,backgroundColor:m(e)}})))))),React.createElement("div",{className:"section"},React.createElement("h3",null,"Weekly Activity Pattern"),React.createElement("div",{className:"weekly-chart"},(a?.weekly_pattern||[]).map((e,t)=>React.createElement("div",{key:t,className:"day-bar"},React.createElement("div",{className:"bar",style:{height:`${e.activity}%`}}),React.createElement("span",{className:"day-label"},e.day)))))),c==="schedule"&&React.createElement("div",{className:"schedule-tab"},React.createElement("div",{className:"section"},React.createElement("h3",null,React.createElement($,null)," ",React.createElement(g,null)," 24-Hour Activity Pattern"),React.createElement("div",{className:"hourly-chart"},(a?.active_hours||[]).map((e,t)=>React.createElement("div",{key:t,className:"hour-column"},React.createElement("div",{className:`hour-bar ${t>=(a?.peak_time?.start||0)&&t<=(a?.peak_time?.end||23)?"peak":""}`,style:{height:`${Math.max(e.activity/_()*100,5)}%`},title:`${e.hour}:00 - Activity: ${Math.round(e.activity)}%`}),React.createElement("span",{className:"hour-num"},e.hour)))),React.createElement("div",{className:"chart-legend"},React.createElement("span",null,React.createElement("span",{className:"legend-dot peak"})," Peak hours"),React.createElement("span",null,React.createElement("span",{className:"legend-dot"})," Regular activity"))),React.createElement("div",{className:"timezone-note"},React.createElement(d,null),React.createElement("span",null,"Times shown in user's local timezone (",a?.user?.timezone,")"))),c==="activities"&&React.createElement("div",{className:"activities-tab"},React.createElement("div",{className:"section"},React.createElement("h3",null,React.createElement(P,null)," Top Activities"),React.createElement("div",{className:"activities-list"},(a?.top_activities||[]).map((e,t)=>React.createElement("div",{key:t,className:`activity-item rank-${t+1}`},React.createElement("span",{className:"activity-rank"},"#",t+1),React.createElement("div",{className:"activity-icon"},k(e.icon)),React.createElement("div",{className:"activity-info"},React.createElement("span",{className:"activity-name"},e.name),React.createElement("span",{className:"activity-hours"},e.hours," hours total")),React.createElement("div",{className:"activity-bar"},React.createElement("div",{className:"bar-fill",style:{width:`${e.hours/(a?.top_activities?.[0]?.hours||1)*100}%`}})))),(!a?.top_activities||a.top_activities.length===0)&&React.createElement("div",{className:"empty-state"},"No activity data available")))))))};export{G as default};
