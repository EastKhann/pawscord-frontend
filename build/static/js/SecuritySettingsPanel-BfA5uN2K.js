var U=Object.defineProperty;var i=(n,t)=>U(n,"name",{value:t,configurable:!0});import{r as d,j as e}from"./react-core-Djgtqrmb.js";import{y as r}from"./ui-vendor-IhB9Znpc.js";import{e as $,g as M}from"./index-Dy0QUtja.js";import"./media-vendor-CxFPycob.js";import"./router-vendor-ClgLnMjk.js";import"./state-vendor-BRqaXHJQ.js";import"./crypto-vendor-D1XRGppi.js";import"./icons-vendor-BW7dxHkX.js";const G=i(()=>{const[n,t]=d.useState(!1),[o,c]=d.useState([]),[m,h]=d.useState([]),[b,f]=d.useState([]),[k,x]=d.useState([]),[p,v]=d.useState(""),[T,P]=d.useState(""),[N,F]=d.useState(""),[I,C]=d.useState(null),[O,_]=d.useState("2fa"),l=M(),j={Authorization:`Bearer ${localStorage.getItem("access_token")}`},u={...j,"Content-Type":"application/json"},w=i(async()=>{try{const a=await(await fetch(`${l}/security/status/`,{headers:j})).json();C(a),t(a.two_factor_enabled||!1)}catch{}},"fetchSecurityStatus"),z=i(async()=>{try{const a=await(await fetch(`${l}/2fa/methods/`,{headers:j})).json();c(a.methods||[])}catch{}},"fetch2FAMethods"),S=i(async()=>{try{const a=await(await fetch(`${l}/security/sessions/`,{headers:j})).json();h(a.sessions||[])}catch{}},"fetchSessions"),A=i(async()=>{try{const a=await(await fetch(`${l}/security/ip-whitelist/`,{headers:j})).json();f(a.whitelist||[])}catch{}},"fetchIPWhitelist"),E=i(async()=>{try{const s=await fetch(`${l}/security/2fa/enable/`,{method:"POST",headers:u}),a=await s.json();s.ok?(v(a.qr_code||""),x(a.backup_codes||[]),r.info("â„¹ï¸ QR kodu tarayÄ±n ve doÄŸrulama kodunu girin")):r.error(`âŒ ${a.error||"2FA etkinleÅŸtirilemedi"}`)}catch{r.error("âŒ 2FA etkinleÅŸtirme hatasÄ±")}},"enable2FA"),B=i(async()=>{try{const s=await fetch(`${l}/security/2fa/verify-setup/`,{method:"POST",headers:u,body:JSON.stringify({code:T})}),a=await s.json();s.ok?(r.success("âœ… 2FA baÅŸarÄ±yla etkinleÅŸtirildi!"),t(!0),v(""),P(""),w()):r.error(`âŒ ${a.error||"GeÃ§ersiz kod"}`)}catch{r.error("âŒ DoÄŸrulama hatasÄ±")}},"verify2FASetup"),D=i(async()=>{if(await $("2FA'yÄ± devre dÄ±ÅŸÄ± bÄ±rakmak istediÄŸinizden emin misiniz?"))try{const s=await fetch(`${l}/security/2fa/disable/`,{method:"POST",headers:u}),a=await s.json();s.ok?(r.info("â„¹ï¸ 2FA devre dÄ±ÅŸÄ± bÄ±rakÄ±ldÄ±"),t(!1),w()):r.error(`âŒ ${a.error||"2FA devre dÄ±ÅŸÄ± bÄ±rakÄ±lamadÄ±"}`)}catch{r.error("âŒ 2FA devre dÄ±ÅŸÄ± bÄ±rakma hatasÄ±")}},"disable2FA"),R=i(async()=>{try{const s=await fetch(`${l}/security/2fa/backup-codes/`,{method:"POST",headers:u}),a=await s.json();s.ok?(x(a.backup_codes||[]),r.success("âœ… Yedek kodlar oluÅŸturuldu")):r.error(`âŒ ${a.error||"Yedek kodlar oluÅŸturulamadÄ±"}`)}catch{r.error("âŒ Yedek kod hatasÄ±")}},"getBackupCodes"),L=i(async s=>{try{const a=await fetch(`${l}/security/sessions/${s}/revoke/`,{method:"POST",headers:u}),y=await a.json();a.ok?(r.success("âœ… Oturum sonlandÄ±rÄ±ldÄ±"),S()):r.error(`âŒ ${y.error||"Oturum sonlandÄ±rÄ±lamadÄ±"}`)}catch{r.error("âŒ Oturum sonlandÄ±rma hatasÄ±")}},"revokeSession"),W=i(async()=>{if(await $("TÃ¼m oturumlarÄ± sonlandÄ±rmak istediÄŸinizden emin misiniz?"))try{const s=await fetch(`${l}/security/sessions/revoke-all/`,{method:"POST",headers:u}),a=await s.json();s.ok?(r.success("âœ… TÃ¼m oturumlar sonlandÄ±rÄ±ldÄ±"),S()):r.error(`âŒ ${a.error||"Oturumlar sonlandÄ±rÄ±lamadÄ±"}`)}catch{r.error("âŒ Toplu sonlandÄ±rma hatasÄ±")}},"revokeAllSessions"),K=i(async()=>{if(!N.trim()){r.error("âŒ IP adresi gerekli");return}try{const s=await fetch(`${l}/security/ip-whitelist/add/`,{method:"POST",headers:u,body:JSON.stringify({ip_address:N})}),a=await s.json();s.ok?(r.success("âœ… IP beyaz listeye eklendi"),F(""),A()):r.error(`âŒ ${a.error||"IP eklenemedi"}`)}catch{r.error("âŒ IP ekleme hatasÄ±")}},"addIPToWhitelist"),Y=i(async s=>{try{(await fetch(`${l}/security/ip-whitelist/${s}/`,{method:"DELETE",headers:j})).ok?(r.success("âœ… IP beyaz listeden kaldÄ±rÄ±ldÄ±"),A()):r.error("âŒ IP kaldÄ±rÄ±lamadÄ±")}catch{r.error("âŒ IP kaldÄ±rma hatasÄ±")}},"removeIPFromWhitelist"),Q=i(()=>{const s=k.join(`
`),a=new Blob([s],{type:"text/plain"}),y=window.URL.createObjectURL(a),g=document.createElement("a");g.href=y,g.download=`pawscord_backup_codes_${new Date().toISOString()}.txt`,g.click(),window.URL.revokeObjectURL(y),r.success("âœ… Yedek kodlar indirildi")},"downloadBackupCodes");return d.useEffect(()=>{w(),z(),S(),A()},[]),{twoFactorEnabled:n,twoFactorMethods:o,sessions:m,ipWhitelist:b,backupCodes:k,qrCode:p,verificationCode:T,setVerificationCode:P,newIp:N,setNewIp:F,securityStatus:I,activeTab:O,setActiveTab:_,enable2FA:E,verify2FASetup:B,disable2FA:D,getBackupCodes:R,downloadBackupCodes:Q,revokeSession:L,revokeAllSessions:W,addIPToWhitelist:K,removeIPFromWhitelist:Y}},"useSecurityAPI"),H=i(({twoFactorEnabled:n,qrCode:t,verificationCode:o,setVerificationCode:c,backupCodes:m,enable2FA:h,verify2FASetup:b,disable2FA:f,getBackupCodes:k,downloadBackupCodes:x})=>e.jsxs("div",{className:"tab-content",children:[e.jsxs("h3",{children:["Ä°","ki FaktÃ¶rlÃ¼ Kimlik DoÄŸrulama (2FA)"]}),e.jsx("p",{children:"HesabÄ±nÄ±zÄ± ekstra bir gÃ¼venlik katmanÄ±yla koruyun"}),!n&&!t?e.jsx("div",{className:"enable-2fa",children:e.jsx("button",{className:"enable-btn",onClick:h,children:"2FA'yÄ± EtkinleÅŸtir"})}):n?e.jsxs("div",{className:"enabled-2fa",children:[e.jsxs("div",{className:"success-message",children:[e.jsx("span",{className:"success-icon",children:"âœ…"}),e.jsx("span",{children:"2FA aktif - HesabÄ±nÄ±z korunuyor"})]}),e.jsx("button",{className:"disable-btn",onClick:f,children:"2FA'yÄ± Devre DÄ±ÅŸÄ± BÄ±rak"}),e.jsx("button",{className:"backup-btn",onClick:k,children:"Yeni Yedek Kodlar OluÅŸtur"})]}):e.jsxs("div",{className:"setup-2fa",children:[e.jsxs("div",{className:"qr-section",children:[e.jsx("h4",{children:"1. QR Kodu TarayÄ±n"}),t&&e.jsx("img",{src:t,alt:"2FA QR Code",className:"qr-code"}),e.jsx("p",{children:"Authenticator uygulamanÄ±zla QR kodu tarayÄ±n"})]}),e.jsxs("div",{className:"verify-section",children:[e.jsx("h4",{children:"2. DoÄŸrulama Kodunu Girin"}),e.jsx("input",{type:"text",placeholder:"6 haneli kod",value:o,onChange:i(p=>c(p.target.value),"onChange"),maxLength:6,className:"verification-input"}),e.jsx("button",{className:"verify-btn",onClick:b,children:"DoÄŸrula ve EtkinleÅŸtir"})]}),m.length>0&&e.jsxs("div",{className:"backup-codes",children:[e.jsx("h4",{children:"3. Yedek KodlarÄ±nÄ±z"}),e.jsx("p",{children:"Bu kodlarÄ± gÃ¼venli bir yerde saklayÄ±n!"}),e.jsx("div",{className:"codes-grid",children:m.map((p,v)=>e.jsx("div",{className:"backup-code",children:p},v))}),e.jsxs("button",{className:"download-btn",onClick:x,children:["ðŸ“¥"," KodlarÄ± ","Ä°","ndir"]})]})]})]}),"TwoFactorTab"),q=i(({sessions:n,revokeSession:t,revokeAllSessions:o})=>e.jsxs("div",{className:"tab-content",children:[e.jsxs("div",{className:"sessions-header",children:[e.jsx("h3",{children:"Aktif Oturumlar"}),e.jsx("button",{className:"revoke-all-btn",onClick:o,children:"TÃ¼mÃ¼nÃ¼ SonlandÄ±r"})]}),e.jsx("div",{className:"sessions-list",children:n.map(c=>e.jsxs("div",{className:"session-card",children:[e.jsxs("div",{className:"session-info",children:[e.jsxs("div",{className:"session-device",children:[e.jsx("span",{className:"device-icon",children:c.device_type==="mobile"?"ðŸ“±":"ðŸ’»"}),e.jsxs("div",{className:"device-details",children:[e.jsx("span",{className:"device-name",children:c.device_name||"Bilinmeyen Cihaz"}),e.jsx("span",{className:"device-location",children:c.location||"Bilinmeyen Konum"})]})]}),e.jsxs("div",{className:"session-meta",children:[e.jsxs("span",{className:"session-ip",children:["IP: ",c.ip_address]}),e.jsxs("span",{className:"session-time",children:["Son Aktivite: ",new Date(c.last_activity).toLocaleString("tr-TR")]})]})]}),c.is_current?e.jsx("span",{className:"current-badge",children:"Mevcut Oturum"}):e.jsx("button",{className:"revoke-btn",onClick:i(()=>t(c.id),"onClick"),children:"SonlandÄ±r"})]},c.id))})]}),"SessionsTab"),J=i(({ipWhitelist:n,newIp:t,setNewIp:o,addIPToWhitelist:c,removeIPFromWhitelist:m})=>e.jsxs("div",{className:"tab-content",children:[e.jsx("h3",{children:"IP Adresi Beyaz Listesi"}),e.jsx("p",{children:"Sadece izin verilen IP adreslerinden giriÅŸ yapÄ±n"}),e.jsxs("div",{className:"add-ip",children:[e.jsx("input",{type:"text",placeholder:"IP Adresi (Ã¶rn: 192.168.1.1)",value:t,onChange:i(h=>o(h.target.value),"onChange"),className:"ip-input"}),e.jsx("button",{className:"add-btn",onClick:c,children:"+ Ekle"})]}),e.jsx("div",{className:"ip-list",children:n.map(h=>e.jsxs("div",{className:"ip-card",children:[e.jsxs("div",{className:"ip-info",children:[e.jsx("span",{className:"ip-address",children:h.ip_address}),e.jsxs("span",{className:"ip-added",children:["Eklendi: ",new Date(h.created_at).toLocaleDateString("tr-TR")]})]}),e.jsx("button",{className:"remove-btn",onClick:i(()=>m(h.id),"onClick"),children:"KaldÄ±r"})]},h.id))})]}),"IPWhitelistTab"),ne=i(({onClose:n})=>{const t=G();return e.jsx("div",{className:"security-overlay",onClick:n,children:e.jsxs("div",{className:"security-panel",onClick:i(o=>o.stopPropagation(),"onClick"),children:[e.jsxs("div",{className:"security-header",children:[e.jsxs("h2",{children:["ðŸ”’"," GÃ¼venlik AyarlarÄ±"]}),e.jsx("button",{className:"close-btn",onClick:n,children:"âœ•"})]}),t.securityStatus&&e.jsxs("div",{className:"security-status",children:[e.jsxs("div",{className:"status-item",children:[e.jsx("span",{className:"status-icon",children:"ðŸ”"}),e.jsx("span",{className:"status-label",children:"2FA:"}),e.jsx("span",{className:`status-value ${t.twoFactorEnabled?"active":"inactive"}`,children:t.twoFactorEnabled?"Aktif":"Pasif"})]}),e.jsxs("div",{className:"status-item",children:[e.jsx("span",{className:"status-icon",children:"ðŸ’»"}),e.jsx("span",{className:"status-label",children:"Aktif Oturumlar:"}),e.jsx("span",{className:"status-value",children:t.sessions.length})]}),e.jsxs("div",{className:"status-item",children:[e.jsx("span",{className:"status-icon",children:"ðŸŒ"}),e.jsx("span",{className:"status-label",children:"IP Whitelist:"}),e.jsx("span",{className:"status-value",children:t.ipWhitelist.length})]})]}),e.jsx("div",{className:"security-tabs",children:[["2fa","ðŸ” 2FA"],["sessions","ðŸ’» Oturumlar"],["ip","ðŸŒ IP Whitelist"]].map(([o,c])=>e.jsx("button",{className:`tab-btn ${t.activeTab===o?"active":""}`,onClick:i(()=>t.setActiveTab(o),"onClick"),children:c},o))}),e.jsxs("div",{className:"security-content",children:[t.activeTab==="2fa"&&e.jsx(H,{...t}),t.activeTab==="sessions"&&e.jsx(q,{...t}),t.activeTab==="ip"&&e.jsx(J,{...t})]})]})})},"SecuritySettingsPanel");export{ne as default};
