import{r as u,n as e}from"./react-core-BMiyQWF6.js";import{a4 as m,a as F,an as _,A as v,b4 as C,a3 as I,d as L}from"./icons-vendor-T72gfvdf.js";import{t as l}from"./index-CtJTBp2J.js";import"./editor-vendor-D9c4a6XZ.js";import"./media-vendor-BuSyE8vR.js";import"./router-vendor-B86Z1mIL.js";import"./state-vendor-CAyNnPM4.js";import"./crypto-vendor-1Q6e4ZD-.js";const N=({fetchWithAuth:i,apiBaseUrl:c,onClose:k,messageId:d})=>{const[a,y]=u.useState([]),[w,f]=u.useState(!1),[n,p]=u.useState("all");u.useEffect(()=>{d?h():b()},[d]);const h=async()=>{f(!0);try{const o=await(await i(`${c}/messages/${d}/scan_results/`)).json();y(o.results||[])}catch{l.error("Failed to load scan results")}finally{f(!1)}},b=async()=>{f(!0);try{const o=await(await i(`${c}/content_scanner/results/`)).json();y(o.results||[])}catch{l.error("Failed to load scan results")}finally{f(!1)}},B=async()=>{try{const o=await(await i(`${c}/content_scanner/export/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filter:n})})).blob(),x=window.URL.createObjectURL(o),r=document.createElement("a");r.href=x,r.download=`scan_results_${new Date().toISOString()}.csv`,document.body.appendChild(r),r.click(),r.remove(),l.success("Results exported successfully")}catch{l.error("Failed to export results")}},g=async(s,o)=>{try{await i(`${c}/content_scanner/results/${s}/review/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:o})}),l.success(`Content ${o}ed successfully`),d?h():b()}catch{l.error("Failed to review content")}},R=s=>{switch(s){case"safe":return e.jsx(v,{style:{color:"#43b581"}});case"flagged":return e.jsx(L,{style:{color:"#faa61a"}});case"blocked":return e.jsx(C,{style:{color:"#f04747"}});default:return e.jsx(m,{})}},S=s=>{switch(s){case"safe":return"#43b581";case"flagged":return"#faa61a";case"blocked":return"#f04747";default:return"#99aab5"}},j=a.filter(s=>n==="all"?!0:s.status===n);return e.jsx("div",{style:t.overlay,children:e.jsxs("div",{style:t.modal,children:[e.jsxs("div",{style:t.header,children:[e.jsxs("div",{style:t.headerLeft,children:[e.jsx(m,{style:{marginRight:"10px",color:"#5865f2"}}),e.jsx("h2",{style:t.title,children:"Content Scanner Results"})]}),e.jsx("button",{onClick:k,style:t.closeButton,children:e.jsx(F,{})})]}),e.jsxs("div",{style:t.filters,children:[e.jsxs("button",{onClick:()=>p("all"),style:{...t.filterButton,...n==="all"&&t.filterButtonActive},children:["All (",a.length,")"]}),e.jsxs("button",{onClick:()=>p("safe"),style:{...t.filterButton,...n==="safe"&&t.filterButtonActive},children:["âœ… Safe (",a.filter(s=>s.status==="safe").length,")"]}),e.jsxs("button",{onClick:()=>p("flagged"),style:{...t.filterButton,...n==="flagged"&&t.filterButtonActive},children:["âš ï¸ Flagged (",a.filter(s=>s.status==="flagged").length,")"]}),e.jsxs("button",{onClick:()=>p("blocked"),style:{...t.filterButton,...n==="blocked"&&t.filterButtonActive},children:["ðŸš« Blocked (",a.filter(s=>s.status==="blocked").length,")"]}),e.jsxs("button",{onClick:B,style:t.exportButton,children:[e.jsx(_,{style:{marginRight:"5px"}}),"Export"]})]}),e.jsx("div",{style:t.content,children:w?e.jsx("div",{style:t.loading,children:"Loading scan results..."}):j.length===0?e.jsx("div",{style:t.empty,children:"No scan results found"}):e.jsx("div",{style:t.resultsList,children:j.map((s,o)=>e.jsxs("div",{style:t.resultCard,children:[e.jsxs("div",{style:t.resultHeader,children:[e.jsxs("div",{style:t.resultStatus,children:[R(s.status),e.jsx("span",{style:{marginLeft:"8px",color:S(s.status),fontWeight:"600"},children:s.status.toUpperCase()})]}),e.jsx("div",{style:t.timestamp,children:new Date(s.scanned_at).toLocaleString()})]}),e.jsxs("div",{style:t.resultBody,children:[e.jsxs("div",{style:t.resultInfo,children:[e.jsxs("div",{style:t.infoRow,children:[e.jsx("strong",{children:"Type:"})," ",s.content_type]}),s.confidence_score&&e.jsxs("div",{style:t.infoRow,children:[e.jsx("strong",{children:"Confidence:"}),e.jsx("div",{style:t.progressBar,children:e.jsx("div",{style:{...t.progressFill,width:`${s.confidence_score}%`,backgroundColor:s.confidence_score>80?"#f04747":s.confidence_score>50?"#faa61a":"#43b581"}})}),e.jsxs("span",{children:[s.confidence_score,"%"]})]}),s.flags&&s.flags.length>0&&e.jsxs("div",{style:t.infoRow,children:[e.jsx("strong",{children:"Flags:"}),e.jsx("div",{style:t.flags,children:s.flags.map((x,r)=>e.jsx("span",{style:t.flag,children:x},r))})]}),s.reason&&e.jsxs("div",{style:t.infoRow,children:[e.jsx("strong",{children:"Reason:"})," ",s.reason]})]}),s.status==="flagged"&&e.jsxs("div",{style:t.actions,children:[e.jsxs("button",{onClick:()=>g(s.id,"approve"),style:{...t.actionButton,...t.approveButton},children:[e.jsx(v,{style:{marginRight:"5px"}}),"Approve"]}),e.jsxs("button",{onClick:()=>g(s.id,"block"),style:{...t.actionButton,...t.blockButton},children:[e.jsx(C,{style:{marginRight:"5px"}}),"Block"]}),e.jsxs("button",{onClick:()=>g(s.id,"ignore"),style:{...t.actionButton,...t.ignoreButton},children:[e.jsx(I,{style:{marginRight:"5px"}}),"Ignore"]})]})]})]},o))})})]})})},t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999},modal:{backgroundColor:"#1e1e1e",borderRadius:"8px",width:"90%",maxWidth:"900px",maxHeight:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #2c2f33"},headerLeft:{display:"flex",alignItems:"center"},title:{margin:0,fontSize:"20px",color:"#ffffff"},closeButton:{background:"none",border:"none",color:"#99aab5",cursor:"pointer",fontSize:"20px",padding:"5px"},filters:{display:"flex",gap:"10px",padding:"15px 20px",borderBottom:"1px solid #2c2f33",flexWrap:"wrap"},filterButton:{padding:"8px 16px",backgroundColor:"#2c2f33",border:"none",borderRadius:"4px",color:"#ffffff",cursor:"pointer",fontSize:"14px",transition:"background-color 0.2s"},filterButtonActive:{backgroundColor:"#5865f2"},exportButton:{marginLeft:"auto",padding:"8px 16px",backgroundColor:"#43b581",border:"none",borderRadius:"4px",color:"#ffffff",cursor:"pointer",fontSize:"14px",display:"flex",alignItems:"center"},content:{padding:"20px",overflowY:"auto",flex:1},loading:{textAlign:"center",color:"#99aab5",padding:"40px"},empty:{textAlign:"center",color:"#99aab5",padding:"40px"},resultsList:{display:"flex",flexDirection:"column",gap:"15px"},resultCard:{backgroundColor:"#2c2f33",borderRadius:"6px",padding:"15px"},resultHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},resultStatus:{display:"flex",alignItems:"center",fontSize:"14px"},timestamp:{fontSize:"12px",color:"#99aab5"},resultBody:{display:"flex",flexDirection:"column",gap:"15px"},resultInfo:{display:"flex",flexDirection:"column",gap:"8px"},infoRow:{display:"flex",alignItems:"center",gap:"10px",fontSize:"14px",color:"#dcddde"},progressBar:{flex:1,height:"8px",backgroundColor:"#1e1e1e",borderRadius:"4px",overflow:"hidden"},progressFill:{height:"100%",transition:"width 0.3s"},flags:{display:"flex",flexWrap:"wrap",gap:"5px"},flag:{padding:"4px 8px",backgroundColor:"#f04747",borderRadius:"4px",fontSize:"12px",color:"#ffffff"},actions:{display:"flex",gap:"10px",justifyContent:"flex-end"},actionButton:{padding:"8px 16px",border:"none",borderRadius:"4px",color:"#ffffff",cursor:"pointer",fontSize:"14px",display:"flex",alignItems:"center"},approveButton:{backgroundColor:"#43b581"},blockButton:{backgroundColor:"#f04747"},ignoreButton:{backgroundColor:"#99aab5"}};export{N as default};
