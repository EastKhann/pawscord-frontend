import{b as e,r as a}from"./react-core-9vc7GIjk.js";import{h as I,R as B,a as F,bs as M,e as _,av as H}from"./icons-vendor-NoxEirJf.js";import{A as W}from"./index-DK2jvQ9U.js";import"./editor-vendor-DiU449Dh.js";import"./media-vendor-B-uSUaIv.js";import"./router-vendor-u6fxj6P4.js";import"./crypto-vendor-C1qXRpJv.js";import"./state-vendor-0vlBuk0v.js";const $=({isOpen:c,onClose:y,onNavigateToMessage:h,currentUsername:m})=>{const[f,E]=a.useState([]),[i,g]=a.useState(!1),[S,k]=a.useState(1),[b,z]=a.useState(!1),[u,C]=a.useState(0),[x,A]=a.useState(""),l=a.useCallback(async(n=1,r=!1)=>{g(!0);try{const s=localStorage.getItem("access_token");let o=`${W}/api/mentions/inbox/?page=${n}&page_size=25`;x&&(o+=`&room_id=${x}`);const d=await fetch(o,{headers:{Authorization:`Bearer ${s}`}});if(d.ok){const p=await d.json();E(w=>r?[...w,...p.results]:p.results),z(p.has_next),C(p.total),k(n)}}catch{}finally{g(!1)}},[x]);a.useEffect(()=>{c&&l(1)},[c,l]);const R=()=>{b&&l(S+1,!0)},v=n=>{const r=new Date(n),o=new Date-r;return o<6e4?"Az √∂nce":o<36e5?`${Math.floor(o/6e4)} dk √∂nce`:o<864e5?`${Math.floor(o/36e5)} sa √∂nce`:o<6048e5?`${Math.floor(o/864e5)} g√ºn √∂nce`:r.toLocaleDateString("tr-TR")},T=n=>{if(!n||!m)return n;const r=new RegExp(`(@${m})`,"gi");return n.split(r).map((o,d)=>r.test(o)?e.createElement("span",{key:d,style:t.mentionHighlight},o):o)};return c?e.createElement("div",{style:t.overlay},e.createElement("div",{style:t.panel},e.createElement("div",{style:t.header},e.createElement("div",{style:t.headerLeft},e.createElement(I,{style:{color:"#5865F2",fontSize:18}}),e.createElement("h3",{style:t.title},"Bahsedilmeler"),u>0&&e.createElement("span",{style:t.badge},u)),e.createElement("div",{style:t.headerRight},e.createElement("button",{onClick:()=>l(1),style:t.refreshBtn,title:"Yenile"},e.createElement(B,{style:i?{animation:"spin 1s linear infinite"}:{}})),e.createElement("button",{onClick:y,style:t.closeBtn},e.createElement(F,null)))),e.createElement("div",{style:t.content},i&&f.length===0?e.createElement("div",{style:t.emptyState},e.createElement("div",{style:t.spinner}),e.createElement("p",null,"Y√ºkleniyor...")):f.length===0?e.createElement("div",{style:t.emptyState},e.createElement("span",{style:{fontSize:48}},"üì≠"),e.createElement("p",{style:t.emptyTitle},"Bahsedilme yok"),e.createElement("p",{style:t.emptySubtitle},"Birisi seni @",m," ile etiketlediƒüinde burada g√∂r√ºn√ºr")):e.createElement(e.Fragment,null,f.map(n=>e.createElement("div",{key:n.id,style:t.mentionItem,onClick:()=>h?.(n)},e.createElement("div",{style:t.mentionHeader},e.createElement("span",{style:t.mentionUser},n.username),e.createElement("span",{style:t.mentionTime},v(n.timestamp))),e.createElement("div",{style:t.mentionContent},T(n.content?.slice(0,200)),n.content?.length>200&&"..."),e.createElement("div",{style:t.mentionFooter},n.room_name&&e.createElement("span",{style:t.roomTag},e.createElement(M,{style:{fontSize:10}}),n.room_name),n.is_pinned&&e.createElement("span",{style:t.pinnedTag},e.createElement(_,{style:{fontSize:10}})," Sabitlenmi≈ü"),n.has_thread&&e.createElement("span",{style:t.threadTag},e.createElement(H,{style:{fontSize:10}})," Thread")))),b&&e.createElement("button",{onClick:R,style:t.loadMoreBtn,disabled:i},i?"Y√ºkleniyor...":"Daha Fazla G√∂ster"))))):null},t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.6)",display:"flex",justifyContent:"center",alignItems:"flex-start",paddingTop:"60px",zIndex:1e3},panel:{width:"500px",maxWidth:"90vw",maxHeight:"80vh",backgroundColor:"#2f3136",borderRadius:"12px",overflow:"hidden",display:"flex",flexDirection:"column",boxShadow:"0 8px 32px rgba(0,0,0,0.4)"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 20px",borderBottom:"1px solid #202225",backgroundColor:"#292b2f"},headerLeft:{display:"flex",alignItems:"center",gap:"10px"},headerRight:{display:"flex",alignItems:"center",gap:"8px"},title:{margin:0,fontSize:"16px",fontWeight:600,color:"#fff"},badge:{backgroundColor:"#ed4245",color:"#fff",fontSize:"11px",fontWeight:700,padding:"2px 6px",borderRadius:"10px",minWidth:"18px",textAlign:"center"},refreshBtn:{background:"none",border:"none",color:"#b9bbbe",cursor:"pointer",padding:"6px",borderRadius:"4px",fontSize:"14px"},closeBtn:{background:"none",border:"none",color:"#b9bbbe",cursor:"pointer",padding:"6px",borderRadius:"4px",fontSize:"16px"},content:{flex:1,overflowY:"auto",padding:"8px"},emptyState:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"48px 24px",color:"#72767d"},emptyTitle:{fontSize:"16px",fontWeight:600,color:"#dcddde",margin:"12px 0 4px"},emptySubtitle:{fontSize:"13px",textAlign:"center"},mentionItem:{padding:"12px 16px",borderRadius:"8px",cursor:"pointer",transition:"background 0.15s",marginBottom:"4px",borderLeft:"3px solid #5865F2",backgroundColor:"rgba(88, 101, 242, 0.06)"},mentionHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"6px"},mentionUser:{fontWeight:600,color:"#fff",fontSize:"14px"},mentionTime:{color:"#72767d",fontSize:"12px"},mentionContent:{color:"#dcddde",fontSize:"14px",lineHeight:1.5,wordBreak:"break-word"},mentionHighlight:{backgroundColor:"rgba(88, 101, 242, 0.3)",color:"#dee0fc",padding:"1px 3px",borderRadius:"3px",fontWeight:600},mentionFooter:{display:"flex",gap:"8px",marginTop:"8px"},roomTag:{display:"flex",alignItems:"center",gap:"4px",backgroundColor:"rgba(255,255,255,0.06)",color:"#b9bbbe",padding:"2px 8px",borderRadius:"4px",fontSize:"12px"},pinnedTag:{display:"flex",alignItems:"center",gap:"4px",backgroundColor:"rgba(250, 166, 26, 0.1)",color:"#faa61a",padding:"2px 8px",borderRadius:"4px",fontSize:"12px"},threadTag:{display:"flex",alignItems:"center",gap:"4px",backgroundColor:"rgba(88, 101, 242, 0.1)",color:"#5865F2",padding:"2px 8px",borderRadius:"4px",fontSize:"12px"},loadMoreBtn:{width:"100%",padding:"10px",backgroundColor:"#5865F2",color:"#fff",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:500,marginTop:"8px"},spinner:{width:32,height:32,border:"3px solid #5865F2",borderTopColor:"transparent",borderRadius:"50%",animation:"spin 0.8s linear infinite",marginBottom:12}},q=e.memo($);export{q as default};
