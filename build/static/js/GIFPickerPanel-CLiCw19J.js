import{r as t,n as e}from"./react-core-zXIKm1Jm.js";import{ad as p,cA as $,cB as E,f as G,bw as L}from"./icons-vendor-DZdpmN99.js";import"./editor-vendor-DiU449Dh.js";function M({apiBaseUrl:i,fetchWithAuth:r,onSelectGIF:m}){const[f,u]=t.useState([]),[y,N]=t.useState([]),[o,v]=t.useState("all"),[c,w]=t.useState(""),[n,h]=t.useState("grid"),[l,j]=t.useState(new Set),[F,x]=t.useState(!1);t.useEffect(()=>{S(),b(),k()},[o,c]);const S=async()=>{x(!0);try{const s=new URLSearchParams;o!=="all"&&s.append("category",o),c&&s.append("search",c);const a=await r(`${i}/gifs/list_local/?${s}`);if(a.ok){const d=await a.json();u(d.gifs||[])}}catch(s){console.error("Error loading GIFs:",s)}finally{x(!1)}},b=async()=>{try{const s=await r(`${i}/gifs/categories/`);if(s.ok){const a=await s.json();N(a.categories||[])}}catch(s){console.error("Error loading categories:",s)}},k=async()=>{try{const s=await r(`${i}/gifs/favorites/`);if(s.ok){const a=await s.json();j(new Set(a.gif_ids||[]))}}catch(s){console.error("Error loading favorites:",s)}},C=async s=>{try{const a=l.has(s),d=a?`${i}/gifs/favorites/remove/`:`${i}/gifs/favorites/add/`;if((await r(d,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({gif_id:s})})).ok){const g=new Set(l);a?g.delete(s):g.add(s),j(g)}}catch(a){console.error("Error toggling favorite:",a)}};return e.jsxs("div",{className:"gif-picker-panel",children:[e.jsxs("div",{className:"gif-header",children:[e.jsxs("h2",{children:[e.jsx(p,{})," GIF Library"]}),e.jsxs("div",{className:"view-controls",children:[e.jsx("button",{className:`view-btn ${n==="grid"?"active":""}`,onClick:()=>h("grid"),children:e.jsx($,{})}),e.jsx("button",{className:`view-btn ${n==="list"?"active":""}`,onClick:()=>h("list"),children:e.jsx(E,{})})]})]}),e.jsxs("div",{className:"gif-search",children:[e.jsx(G,{className:"search-icon"}),e.jsx("input",{type:"text",placeholder:"Search GIFs...",value:c,onChange:s=>w(s.target.value),className:"search-input"})]}),e.jsxs("div",{className:"gif-categories",children:[e.jsx("button",{className:`category-btn ${o==="all"?"active":""}`,onClick:()=>v("all"),children:"All"}),y.map(s=>e.jsx("button",{className:`category-btn ${o===s.id?"active":""}`,onClick:()=>v(s.id),children:s.name},s.id))]}),e.jsx("div",{className:`gif-grid ${n}`,children:F?e.jsx("div",{className:"gif-loading",children:"Loading GIFs..."}):f.length===0?e.jsxs("div",{className:"empty-gifs",children:[e.jsx(p,{className:"empty-icon"}),e.jsx("p",{children:"No GIFs found"})]}):f.map(s=>e.jsxs("div",{className:"gif-item",children:[e.jsx("img",{src:s.url,alt:s.name,onClick:()=>m&&m(s),className:"gif-image"}),e.jsx("div",{className:"gif-overlay",children:e.jsx("button",{className:`fav-btn ${l.has(s.id)?"favorited":""}`,onClick:a=>{a.stopPropagation(),C(s.id)},children:e.jsx(L,{})})})]},s.id))})]})}export{M as default};
