import{r as i,j as e}from"./react-core-D6cE4lil.js";import{s as C}from"./index-ClHcoIda.js";import"./media-vendor-Du00QUHb.js";import"./router-vendor-wrB4dqw3.js";import"./icons-vendor-DT2gd7vx.js";import"./state-vendor-DnurjGY_.js";import"./crypto-vendor-BYnay7oC.js";import"./ui-vendor-CZOhtEfS.js";const z={early_supporter:{name:"Early Supporter",icon:"ðŸŒŸ",color:"#FFD700"},premium:{name:"Premium",icon:"ðŸ’Ž",color:"#a855f7"},verified:{name:"Verified",icon:"âœ“",color:"#5865F2"},developer:{name:"Developer",icon:"ðŸ› ï¸",color:"#3b82f6"},bug_hunter:{name:"Bug Hunter",icon:"ðŸ›",color:"#22c55e"},top_contributor:{name:"Top Contributor",icon:"ðŸ†",color:"#f59e0b"},server_owner:{name:"Server Owner",icon:"ðŸ‘‘",color:"#ef4444"},moderator:{name:"Moderator",icon:"ðŸ›¡ï¸",color:"#10b981"},artist:{name:"Artist",icon:"ðŸŽ¨",color:"#ec4899"},streamer:{name:"Streamer",icon:"ðŸ“º",color:"#8b5cf6"}};function P(o,u){const[s,a]=i.useState(null),[n,g]=i.useState([]),[v,j]=i.useState([]),[p,c]=i.useState(!0),[d,b]=i.useState(!1),[$,T]=i.useState("appearance"),[N,x]=i.useState({banner:"",banner_color:"#5865F2",theme:"default",bio:"",links:[]}),[y,S]=i.useState([]),[k,_]=i.useState({name:"",url:""}),h=C,w=i.useCallback(async()=>{try{const r=localStorage.getItem("access_token"),[t,m,f]=await Promise.all([fetch(`${h}/profile/card/`,{headers:{Authorization:`Bearer ${r}`}}),fetch(`${h}/profile/themes/`,{headers:{Authorization:`Bearer ${r}`}}),fetch(`${h}/profile/badges/`,{headers:{Authorization:`Bearer ${r}`}})]);if(t.ok){const l=await t.json();a(l),x({banner:l.banner||"",banner_color:l.banner_color||"#5865F2",theme:l.theme||"default",bio:l.bio||"",links:l.links||[]}),S(l.badges||[])}if(m.ok){const l=await m.json();g(l.themes||[])}if(f.ok){const l=await f.json();j(l.badges||[])}}catch{}c(!1)},[h]),D=async()=>{b(!0);try{const r=localStorage.getItem("access_token"),t=await fetch(`${h}/profile/card/update/`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"},body:JSON.stringify(N)});await fetch(`${h}/profile/badges/set/`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"},body:JSON.stringify({badges:y})}),t.ok&&(u?.(),o())}catch{}b(!1)},A=async()=>{if(k.url)try{const r=localStorage.getItem("access_token"),t=await fetch(`${h}/profile/links/add/`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"},body:JSON.stringify(k)});if(t.ok){const m=await t.json();x(f=>({...f,links:m.links})),_({name:"",url:""})}}catch{}},B=async r=>{try{const t=localStorage.getItem("access_token"),m=await fetch(`${h}/profile/links/${r}/remove/`,{method:"DELETE",headers:{Authorization:`Bearer ${t}`}});if(m.ok){const f=await m.json();x(l=>({...l,links:f.links}))}}catch{}},L=r=>{S(t=>t.includes(r)?t.filter(m=>m!==r):t.length>=3?t:[...t,r])};return i.useEffect(()=>{w()},[w]),{profile:s,themes:n,badges:v,loading:p,saving:d,activeTab:$,setActiveTab:T,formData:N,setFormData:x,selectedBadges:y,newLink:k,setNewLink:_,handleSave:D,handleAddLink:A,handleRemoveLink:B,toggleBadge:L}}const H=({onClose:o,onSave:u})=>{const s=P(o,u);return s.loading?e.jsx("div",{className:"profile-editor-modal",children:e.jsx("div",{className:"editor-loading",children:e.jsx("div",{className:"loading-spinner"})})}):e.jsx("div",{className:"profile-editor-overlay",onClick:a=>a.target===a.currentTarget&&o(),children:e.jsxs("div",{className:"profile-editor-modal",children:[e.jsxs("div",{className:"editor-header",children:[e.jsxs("h2",{children:["ðŸŽ¨"," Profil Kart\\u0131 D\\u00fczenle"]}),e.jsx("button",{className:"close-btn",onClick:o,children:"\\u00d7"})]}),e.jsxs("div",{className:"editor-tabs",children:[e.jsxs("button",{className:s.activeTab==="appearance"?"active":"",onClick:()=>s.setActiveTab("appearance"),children:["ðŸŽ¨"," G\\u00f6r\\u00fcn\\u00fcm"]}),e.jsxs("button",{className:s.activeTab==="badges"?"active":"",onClick:()=>s.setActiveTab("badges"),children:["ðŸ…"," Rozetler"]}),e.jsxs("button",{className:s.activeTab==="links"?"active":"",onClick:()=>s.setActiveTab("links"),children:["ðŸ”—"," Ba\\u011flant\\u0131lar"]})]}),e.jsxs("div",{className:"editor-content",children:[s.activeTab==="appearance"&&e.jsxs("div",{className:"appearance-tab",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Banner URL"}),e.jsx("input",{type:"url",placeholder:"https://...",value:s.formData.banner,onChange:a=>s.setFormData(n=>({...n,banner:a.target.value}))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Banner Rengi (resim yoksa)"}),e.jsxs("div",{className:"color-picker",children:[e.jsx("input",{type:"color",value:s.formData.banner_color,onChange:a=>s.setFormData(n=>({...n,banner_color:a.target.value}))}),e.jsx("span",{children:s.formData.banner_color})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Tema"}),e.jsx("div",{className:"theme-grid",children:s.themes.map(a=>e.jsxs("div",{className:`theme-option ${s.formData.theme===a.id?"selected":""}`,onClick:()=>s.setFormData(n=>({...n,theme:a.id})),style:{background:`linear-gradient(135deg, ${a.primary}, ${a.secondary})`},children:[e.jsx("span",{className:"theme-name",children:a.id}),e.jsx("div",{className:"theme-colors",children:e.jsx("span",{style:{backgroundColor:a.accent}})})]},a.id))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Biyografi"}),e.jsx("textarea",{placeholder:"Kendiniz hakk\\u0131nda bir \\u015feyler yaz\\u0131n...",value:s.formData.bio,onChange:a=>s.setFormData(n=>({...n,bio:a.target.value.slice(0,500)})),rows:4,maxLength:500}),e.jsxs("span",{className:"char-count",children:[s.formData.bio.length,"/500"]})]})]}),s.activeTab==="badges"&&e.jsxs("div",{className:"badges-tab",children:[e.jsx("p",{className:"badges-hint",children:"Profilinizde g\\u00f6r\\u00fcnt\\u00fclenecek en fazla 3 rozet se\\u00e7in"}),e.jsx("div",{className:"badges-grid",children:s.badges.map(a=>e.jsxs("div",{className:`badge-option ${a.owned?"":"locked"} ${s.selectedBadges.includes(a.id)?"selected":""}`,onClick:()=>a.owned&&s.toggleBadge(a.id),children:[e.jsx("span",{className:"badge-icon",style:{backgroundColor:a.color},children:a.icon}),e.jsx("span",{className:"badge-name",children:a.name}),!a.owned&&e.jsx("span",{className:"lock-icon",children:"ðŸ”’"})]},a.id))})]}),s.activeTab==="links"&&e.jsxs("div",{className:"links-tab",children:[e.jsx("p",{className:"links-hint",children:"En fazla 5 ba\\u011flant\\u0131 ekleyebilirsiniz"}),e.jsx("div",{className:"current-links",children:s.formData.links.map((a,n)=>e.jsxs("div",{className:"link-row",children:[e.jsx("span",{className:"link-icon",children:a.icon}),e.jsx("span",{className:"link-name",children:a.name}),e.jsxs("a",{href:a.url,target:"_blank",rel:"noopener noreferrer",className:"link-url",children:[a.url.slice(0,40),"..."]}),e.jsx("button",{className:"remove-link",onClick:()=>s.handleRemoveLink(n),children:"\\u00d7"})]},n))}),s.formData.links.length<5&&e.jsxs("div",{className:"add-link-form",children:[e.jsx("input",{type:"text",placeholder:"\\u0130sim (opsiyonel)",value:s.newLink.name,onChange:a=>s.setNewLink(n=>({...n,name:a.target.value}))}),e.jsx("input",{type:"url",placeholder:"URL",value:s.newLink.url,onChange:a=>s.setNewLink(n=>({...n,url:a.target.value}))}),e.jsx("button",{onClick:s.handleAddLink,children:"Ekle"})]})]})]}),e.jsxs("div",{className:"editor-preview",children:[e.jsx("h4",{children:"\\u00d6nizleme"}),e.jsx(R,{username:s.profile?.username,compact:!0})]}),e.jsxs("div",{className:"editor-footer",children:[e.jsx("button",{className:"cancel-btn",onClick:o,children:"\\u0130ptal"}),e.jsx("button",{className:"save-btn",onClick:s.handleSave,disabled:s.saving,children:s.saving?"Kaydediliyor...":"Kaydet"})]})]})})},R=({username:o,onEdit:u,compact:s=!1})=>{const[a,n]=i.useState(null),[g,v]=i.useState(!0),j=C;if(i.useEffect(()=>{(async()=>{try{const c=localStorage.getItem("access_token"),d=o?`${j}/profile/card/${o}/`:`${j}/profile/card/`,b=await fetch(d,{headers:{Authorization:`Bearer ${c}`}});b.ok&&n(await b.json())}catch{}v(!1)})()},[o,j]),g)return e.jsx("div",{className:"profile-card loading",children:e.jsx("div",{className:"loading-spinner"})});if(!a)return e.jsx("div",{className:"profile-card error",children:"Profil y\\u00fcklenemedi"});const p=a.custom_colors||a.theme_colors;return e.jsxs("div",{className:`profile-card ${s?"compact":""}`,style:{"--primary":p.primary,"--secondary":p.secondary,"--accent":p.accent,"--bg":p.background},children:[e.jsx("div",{className:"card-banner",style:{backgroundImage:a.banner?`url(${a.banner})`:void 0,backgroundColor:a.banner_color},children:u&&e.jsx("button",{className:"edit-btn",onClick:u,children:"âœï¸"})}),e.jsxs("div",{className:"card-avatar",children:[e.jsx("img",{src:a.avatar||"/default-avatar.png",alt:""}),a.status_text&&e.jsx("div",{className:"status-indicator",title:a.status_text,children:a.status_text.slice(0,1)})]}),e.jsxs("div",{className:"card-content",children:[a.badges?.length>0&&e.jsx("div",{className:"card-badges",children:a.badges.map(c=>{const d=z[c];return d?e.jsx("span",{className:"badge",style:{backgroundColor:d.color},title:d.name,children:d.icon},c):null})}),e.jsx("h2",{className:"card-name",children:a.display_name||a.username}),e.jsxs("p",{className:"card-username",children:["@",a.username]}),a.bio&&e.jsx("p",{className:"card-bio",children:a.bio}),e.jsxs("div",{className:"card-stats",children:[e.jsxs("div",{className:"stat",children:[e.jsxs("span",{className:"stat-value",children:["Lv.",a.level]}),e.jsx("span",{className:"stat-label",children:"Seviye"})]}),e.jsxs("div",{className:"stat",children:[e.jsx("span",{className:"stat-value",children:a.xp?.toLocaleString()}),e.jsx("span",{className:"stat-label",children:"XP"})]}),e.jsxs("div",{className:"stat",children:[e.jsx("span",{className:"stat-value",children:new Date(a.created_at).toLocaleDateString("tr-TR",{month:"short",year:"numeric"})}),e.jsx("span",{className:"stat-label",children:"Kat\\u0131l\\u0131m"})]})]}),a.links?.length>0&&e.jsx("div",{className:"card-links",children:a.links.map((c,d)=>e.jsx("a",{href:c.url,target:"_blank",rel:"noopener noreferrer",className:"link-item",title:c.name,children:c.icon},d))}),a.spotify_connected&&e.jsxs("div",{className:"spotify-badge",children:["ðŸŽµ"," Spotify Ba\\u011fl\\u0131"]}),a.is_premium&&e.jsxs("div",{className:"premium-badge",children:["ðŸ’Ž"," Premium"]})]})]})};export{R as ProfileCard,H as ProfileCardEditor,R as default};
