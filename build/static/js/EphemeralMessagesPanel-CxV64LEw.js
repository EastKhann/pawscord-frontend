import{r as i,d as e,M as E,i as h,b$ as S,c0 as C}from"./react-core-DMT_QkRe.js";import{t as o}from"./index-CgWAyShr.js";const T=({fetchWithAuth:d,apiBaseUrl:c,onClose:m,roomSlug:n})=>{const[l,b]=i.useState(null),[x,g]=i.useState(!1),[r,u]=i.useState(3600),f=[{value:300,label:"5 minutes"},{value:600,label:"10 minutes"},{value:1800,label:"30 minutes"},{value:3600,label:"1 hour"},{value:7200,label:"2 hours"},{value:14400,label:"4 hours"},{value:28800,label:"8 hours"},{value:86400,label:"24 hours"},{value:604800,label:"7 days"}];i.useEffect(()=>{p()},[n]);const p=async()=>{g(!0);try{const s=await(await d(`${c}/api/rooms/${n}/ephemeral/`)).json();b(s),s.ttl&&u(s.ttl)}catch{o.error("Failed to load ephemeral settings")}finally{g(!1)}},y=async()=>{try{await d(`${c}/api/rooms/${n}/ephemeral/set/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({enabled:!l?.enabled,ttl:r})}),o.success(`Ephemeral messages ${l?.enabled?"disabled":"enabled"}`),p()}catch{o.error("Failed to update settings")}},v=async a=>{if(u(a),l?.enabled)try{await d(`${c}/api/rooms/${n}/ephemeral/set/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({enabled:!0,ttl:a})}),o.success("Auto-delete time updated"),p()}catch{o.error("Failed to update TTL")}};return e.createElement("div",{style:t.overlay},e.createElement("div",{style:t.modal},e.createElement("div",{style:t.header},e.createElement("div",{style:t.headerLeft},e.createElement(E,{style:{marginRight:"10px",color:"#5865f2"}}),e.createElement("h2",{style:t.title},"Auto-Delete Messages")),e.createElement("button",{onClick:m,style:t.closeButton},e.createElement(h,null))),e.createElement("div",{style:t.content},x?e.createElement("div",{style:t.loading},"Loading settings..."):e.createElement(e.Fragment,null,e.createElement("div",{style:t.toggleSection},e.createElement("div",null,e.createElement("div",{style:t.toggleLabel},"Enable Auto-Delete"),e.createElement("div",{style:t.toggleDescription},"Messages will automatically delete after the specified time")),e.createElement("button",{onClick:y,style:t.toggleButton},l?.enabled?e.createElement(S,{style:{fontSize:"32px",color:"#43b581"}}):e.createElement(C,{style:{fontSize:"32px",color:"#99aab5"}}))),l?.enabled&&e.createElement("div",{style:t.ttlSection},e.createElement("label",{style:t.label},"Auto-Delete After"),e.createElement("div",{style:t.optionsGrid},f.map(a=>e.createElement("button",{key:a.value,onClick:()=>v(a.value),style:{...t.optionButton,...r===a.value&&t.optionButtonActive}},a.label))),e.createElement("div",{style:t.info},"⏱️ Current setting: Messages auto-delete after"," ",e.createElement("strong",null,f.find(a=>a.value===r)?.label||`${r} seconds`))),!l?.enabled&&e.createElement("div",{style:t.disabledMessage},"Ephemeral messages are currently disabled. Enable them to automatically delete messages after a set time period.")))))},t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999},modal:{backgroundColor:"#1e1e1e",borderRadius:"8px",width:"90%",maxWidth:"600px",maxHeight:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #2c2f33"},headerLeft:{display:"flex",alignItems:"center"},title:{margin:0,fontSize:"20px",color:"#ffffff"},closeButton:{background:"none",border:"none",color:"#99aab5",cursor:"pointer",fontSize:"20px",padding:"5px"},content:{padding:"20px",overflowY:"auto",flex:1},loading:{textAlign:"center",color:"#99aab5",padding:"40px"},toggleSection:{backgroundColor:"#2c2f33",borderRadius:"8px",padding:"20px",display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},toggleLabel:{fontSize:"16px",fontWeight:"600",color:"#ffffff",marginBottom:"4px"},toggleDescription:{fontSize:"13px",color:"#99aab5"},toggleButton:{background:"none",border:"none",cursor:"pointer",padding:"5px"},ttlSection:{display:"flex",flexDirection:"column",gap:"16px"},label:{fontSize:"14px",fontWeight:"600",color:"#dcddde"},optionsGrid:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"12px"},optionButton:{padding:"12px",backgroundColor:"#2c2f33",border:"none",borderRadius:"4px",color:"#ffffff",cursor:"pointer",fontSize:"14px",transition:"background-color 0.2s"},optionButtonActive:{backgroundColor:"#5865f2"},info:{backgroundColor:"#2c2f33",borderRadius:"6px",padding:"12px",fontSize:"14px",color:"#dcddde",textAlign:"center"},disabledMessage:{backgroundColor:"#2c2f33",borderRadius:"6px",padding:"20px",fontSize:"14px",color:"#99aab5",textAlign:"center"}};export{T as default};
