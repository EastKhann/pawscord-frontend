import{r as n,d as e}from"./react-core-DrOm_csO.js";import{p as A}from"./index-DmEhdEtw.js";const P=({bot:a,onClick:d})=>e.createElement("div",{className:"bot-card",onClick:()=>d(a)},e.createElement("div",{className:"bot-avatar"},e.createElement("img",{src:a.avatar||"/default-bot.png",alt:a.name}),a.is_verified&&e.createElement("span",{className:"verified-badge"},"âœ“")),e.createElement("div",{className:"bot-info"},e.createElement("h3",{className:"bot-name"},a.name,a.is_featured&&e.createElement("span",{className:"featured-tag"},"â­ Ã–ne Ã‡Ä±kan")),e.createElement("p",{className:"bot-description"},a.short_description),e.createElement("div",{className:"bot-meta"},e.createElement("span",{className:"bot-installs"},e.createElement("i",null,"ðŸ“¥")," ",a.install_count?.toLocaleString()||0),e.createElement("span",{className:"bot-rating"},e.createElement("i",null,"â­")," ",a.avg_rating||0),a.category&&e.createElement("span",{className:"bot-category"},a.category)),a.tags&&a.tags.length>0&&e.createElement("div",{className:"bot-tags"},a.tags.slice(0,3).map((p,r)=>e.createElement("span",{key:r,className:"tag"},p))))),j=({bot:a,onClose:d,onInstall:p})=>{const[r,g]=n.useState("overview"),[S,N]=n.useState(!1),[k,C]=n.useState([]),[i,b]=n.useState(null),[m,w]=n.useState(!1),s=A,B=n.useCallback(async()=>{try{const l=localStorage.getItem("access_token"),c=await fetch(`${s}/bots/my-servers/`,{headers:{Authorization:`Bearer ${l}`}});if(c.ok){const v=await c.json();C(v.servers||[])}}catch(l){console.error("Failed to load servers:",l)}},[s]),f=async()=>{if(i){w(!0);try{const l=localStorage.getItem("access_token"),c=await fetch(`${s}/bots/${a.id}/install/`,{method:"POST",headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"},body:JSON.stringify({server_id:i.id})});if(c.ok)p?.(a,i),N(!1),alert(`${a.name} baÅŸarÄ±yla ${i.name} sunucusuna eklendi!`);else{const v=await c.json();alert(v.error||"YÃ¼kleme baÅŸarÄ±sÄ±z")}}catch(l){console.error("Install failed:",l)}w(!1)}};return n.useEffect(()=>{B()},[B]),a?e.createElement("div",{className:"bot-modal-overlay",onClick:l=>l.target===l.currentTarget&&d()},e.createElement("div",{className:"bot-modal"},e.createElement("div",{className:"bot-modal-header",style:{backgroundImage:a.banner?`url(${a.banner})`:void 0}},e.createElement("button",{className:"modal-close",onClick:d},"Ã—"),e.createElement("div",{className:"bot-header-content"},e.createElement("img",{src:a.avatar||"/default-bot.png",alt:a.name,className:"bot-large-avatar"}),e.createElement("div",{className:"bot-header-info"},e.createElement("h2",null,a.name,a.is_verified&&e.createElement("span",{className:"verified"},"âœ“ DoÄŸrulanmÄ±ÅŸ")),e.createElement("p",null,a.short_description),e.createElement("div",{className:"bot-stats"},e.createElement("span",null,"ðŸ“¥ ",a.install_count?.toLocaleString()," sunucu"),e.createElement("span",null,"â­ ",a.avg_rating," (",a.review_count," yorum)"))),e.createElement("button",{className:"add-bot-btn",onClick:()=>N(!0)},"Sunucuya Ekle"))),e.createElement("div",{className:"bot-modal-tabs"},e.createElement("button",{className:r==="overview"?"active":"",onClick:()=>g("overview")},"Genel BakÄ±ÅŸ"),e.createElement("button",{className:r==="commands"?"active":"",onClick:()=>g("commands")},"Komutlar"),e.createElement("button",{className:r==="reviews"?"active":"",onClick:()=>g("reviews")},"Yorumlar")),e.createElement("div",{className:"bot-modal-content"},r==="overview"&&e.createElement("div",{className:"overview-tab"},e.createElement("div",{className:"description-section"},e.createElement("h3",null,"AÃ§Ä±klama"),e.createElement("div",{className:"description-content"},a.description)),a.features&&a.features.length>0&&e.createElement("div",{className:"features-section"},e.createElement("h3",null,"Ã–zellikler"),e.createElement("div",{className:"features-list"},a.features.map((l,c)=>e.createElement("div",{key:c,className:"feature-item"},"âœ… ",l)))),e.createElement("div",{className:"links-section"},e.createElement("h3",null,"BaÄŸlantÄ±lar"),e.createElement("div",{className:"links-list"},a.website&&e.createElement("a",{href:a.website,target:"_blank",rel:"noopener noreferrer"},"ðŸŒ Web Sitesi"),a.support_server&&e.createElement("a",{href:`/invite/${a.support_server}`},"ðŸ’¬ Destek Sunucusu"),a.privacy_policy&&e.createElement("a",{href:a.privacy_policy,target:"_blank",rel:"noopener noreferrer"},"ðŸ”’ Gizlilik PolitikasÄ±"))),a.developer&&e.createElement("div",{className:"developer-section"},e.createElement("h3",null,"GeliÅŸtirici"),e.createElement("div",{className:"developer-info"},e.createElement("img",{src:a.developer.avatar||"/default-avatar.png",alt:""}),e.createElement("span",null,a.developer.username)))),r==="commands"&&e.createElement("div",{className:"commands-tab"},a.commands&&a.commands.length>0?e.createElement("div",{className:"commands-list"},a.commands.map((l,c)=>e.createElement("div",{key:c,className:"command-item"},e.createElement("code",{className:"command-name"},a.prefix,l.name),e.createElement("p",{className:"command-desc"},l.description),l.usage&&e.createElement("code",{className:"command-usage"},l.usage)))):e.createElement("p",{className:"no-data"},"Komut listesi mevcut deÄŸil")),r==="reviews"&&e.createElement("div",{className:"reviews-tab"},a.reviews&&a.reviews.length>0?e.createElement("div",{className:"reviews-list"},a.reviews.map(l=>e.createElement("div",{key:l.id,className:"review-item"},e.createElement("div",{className:"review-header"},e.createElement("img",{src:l.avatar||"/default-avatar.png",alt:""}),e.createElement("span",{className:"reviewer-name"},l.user),e.createElement("span",{className:"review-rating"},"â­".repeat(l.rating))),e.createElement("p",{className:"review-content"},l.content),e.createElement("span",{className:"review-date"},new Date(l.created_at).toLocaleDateString("tr-TR"))))):e.createElement("p",{className:"no-data"},"HenÃ¼z yorum yok"))),S&&e.createElement("div",{className:"server-select-overlay"},e.createElement("div",{className:"server-select-modal"},e.createElement("h3",null,"Sunucu SeÃ§"),e.createElement("p",null,a.name," botunu hangi sunucuya eklemek istiyorsunuz?"),e.createElement("div",{className:"server-list"},k.length===0?e.createElement("p",{className:"no-servers"},"Admin olduÄŸunuz sunucu bulunamadÄ±"):k.map(l=>e.createElement("div",{key:l.id,className:`server-item ${i?.id===l.id?"selected":""}`,onClick:()=>b(l)},e.createElement("img",{src:l.icon||"/default-server.png",alt:""}),e.createElement("span",null,l.name),e.createElement("span",{className:"member-count"},l.member_count," Ã¼ye")))),e.createElement("div",{className:"server-select-actions"},e.createElement("button",{className:"cancel-btn",onClick:()=>N(!1)},"Ä°ptal"),e.createElement("button",{className:"install-btn",disabled:!i||m,onClick:f},m?"YÃ¼kleniyor...":"Ekle")))))):null},F=({onClose:a})=>{const[d,p]=n.useState([]),[r,g]=n.useState([]),[S,N]=n.useState([]),[k,C]=n.useState([]),[i,b]=n.useState(!0),[m,w]=n.useState(null),[s,B]=n.useState(""),[f,l]=n.useState("popular"),[c,v]=n.useState(null),[h,I]=n.useState(1),[_,R]=n.useState(1),u=A,T=n.useCallback(async()=>{try{const t=new URLSearchParams({page:h,sort:f,limit:20});m&&t.append("category",m),s&&t.append("search",s);const o=await fetch(`${u}/bots/?${t}`);if(o.ok){const E=await o.json();p(E.bots||[]),R(E.pages||1)}}catch(t){console.error("Failed to load bots:",t)}},[u,h,f,m,s]),z=n.useCallback(async()=>{b(!0);try{const[t,o,E]=await Promise.all([fetch(`${u}/bots/categories/`),fetch(`${u}/bots/featured/`),fetch(`${u}/bots/trending/`)]);if(t.ok){const y=await t.json();C(y.categories||[])}if(o.ok){const y=await o.json();g(y.bots||[])}if(E.ok){const y=await E.json();N(y.bots||[])}}catch(t){console.error("Failed to load initial data:",t)}b(!1)},[u]),$=async t=>{try{const o=await fetch(`${u}/bots/${t.id}/`);if(o.ok){const E=await o.json();v(E)}}catch(o){console.error("Failed to load bot detail:",o)}};return n.useEffect(()=>{z()},[z]),n.useEffect(()=>{T()},[T]),i?e.createElement("div",{className:"bot-marketplace"},e.createElement("div",{className:"marketplace-loading"},e.createElement("div",{className:"loading-spinner"}),e.createElement("p",null,"Bot Marketplace yÃ¼kleniyor..."))):e.createElement("div",{className:"bot-marketplace"},e.createElement("div",{className:"marketplace-header"},e.createElement("div",{className:"header-content"},e.createElement("h1",null,"ðŸ¤– Bot Marketplace"),e.createElement("p",null,"Sunucunuzu gÃ¼Ã§lendirecek binlerce bot keÅŸfedin")),a&&e.createElement("button",{className:"close-btn",onClick:a},"Ã—")),e.createElement("div",{className:"marketplace-filters"},e.createElement("div",{className:"search-box"},e.createElement("input",{type:"text",placeholder:"Bot ara...",value:s,onChange:t=>B(t.target.value)}),e.createElement("span",{className:"search-icon"},"ðŸ”")),e.createElement("div",{className:"filter-group"},e.createElement("select",{value:m||"",onChange:t=>w(t.target.value||null)},e.createElement("option",{value:""},"TÃ¼m Kategoriler"),k.map(t=>e.createElement("option",{key:t.id,value:t.slug},t.icon," ",t.name," (",t.bot_count,")"))),e.createElement("select",{value:f,onChange:t=>l(t.target.value)},e.createElement("option",{value:"popular"},"PopÃ¼ler"),e.createElement("option",{value:"new"},"Yeni"),e.createElement("option",{value:"rated"},"En Ä°yi Puan")))),e.createElement("div",{className:"marketplace-content"},r.length>0&&!s&&!m&&e.createElement("section",{className:"featured-section"},e.createElement("h2",null,"â­ Ã–ne Ã‡Ä±kan Botlar"),e.createElement("div",{className:"featured-grid"},r.map(t=>e.createElement(P,{key:t.id,bot:t,onClick:$})))),S.length>0&&!s&&!m&&e.createElement("section",{className:"trending-section"},e.createElement("h2",null,"ðŸ“ˆ YÃ¼kselen Botlar"),e.createElement("div",{className:"trending-grid"},S.map(t=>e.createElement(P,{key:t.id,bot:t,onClick:$})))),e.createElement("section",{className:"all-bots-section"},e.createElement("h2",null,m?k.find(t=>t.slug===m)?.name||"Botlar":s?`"${s}" iÃ§in sonuÃ§lar`:"TÃ¼m Botlar"),d.length===0?e.createElement("div",{className:"no-results"},e.createElement("p",null,"Bot bulunamadÄ±")):e.createElement(e.Fragment,null,e.createElement("div",{className:"bots-grid"},d.map(t=>e.createElement(P,{key:t.id,bot:t,onClick:$}))),_>1&&e.createElement("div",{className:"pagination"},e.createElement("button",{disabled:h<=1,onClick:()=>I(t=>t-1)},"â† Ã–nceki"),e.createElement("span",null,"Sayfa ",h," / ",_),e.createElement("button",{disabled:h>=_,onClick:()=>I(t=>t+1)},"Sonraki â†’"))))),c&&e.createElement(j,{bot:c,onClose:()=>v(null)}))};export{F as default};
