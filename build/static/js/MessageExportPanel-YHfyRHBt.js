import{r as n,j as e}from"./react-vendor-D8Fi5F9E.js";import{b4 as _,a as z,aa as m,bl as D}from"./icons-vendor-BPCemF_6.js";import{t as l}from"./index-CwlM2zFi.js";import"./media-vendor-Dp18sh1g.js";import"./router-vendor-CTPwQFnc.js";import"./crypto-vendor-Cz32ecGD.js";import"./state-vendor-De5qIGw3.js";const J=({fetchWithAuth:u,apiBaseUrl:f,roomSlug:y,onClose:c})=>{const[g,j]=n.useState("json"),[o,h]=n.useState({start_date:"",end_date:""}),[b,k]=n.useState(!1),[p,r]=n.useState(!1),[R,v]=n.useState(null),[i,S]=n.useState(null),C=[{value:"json",label:"JSON",icon:"ðŸ“‹"},{value:"csv",label:"CSV (Excel)",icon:"ðŸ“Š"},{value:"txt",label:"Text",icon:"ðŸ“„"},{value:"html",label:"HTML",icon:"ðŸŒ"}],I=async()=>{try{r(!0);const a=await u(`${f}/api/exports/create/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({room_slug:y,format:g,start_date:o.start_date||null,end_date:o.end_date||null,include_attachments:b})});if(a.ok){const s=await a.json();v(s.job_id),l.success("DÄ±ÅŸa aktarma baÅŸlatÄ±ldÄ±"),w(s.job_id)}else l.error("DÄ±ÅŸa aktarma baÅŸlatÄ±lamadÄ±"),r(!1)}catch(a){console.error("Export baÅŸlatma hatasÄ±:",a),l.error("Bir hata oluÅŸtu"),r(!1)}},w=async a=>{const s=setInterval(async()=>{try{const d=await u(`${f}/api/exports/${a}/status/`);if(d.ok){const x=await d.json();x.status==="completed"?(clearInterval(s),r(!1),S(x.download_url),l.success("DÄ±ÅŸa aktarma tamamlandÄ±!")):x.status==="failed"&&(clearInterval(s),r(!1),l.error("DÄ±ÅŸa aktarma baÅŸarÄ±sÄ±z oldu"))}}catch(d){clearInterval(s),r(!1),console.error("Status kontrol hatasÄ±:",d)}},2e3)},B=()=>{i&&(window.open(i,"_blank"),l.success("Ä°ndirme baÅŸlatÄ±ldÄ±"))};return e.jsx("div",{style:t.overlay,onClick:c,children:e.jsxs("div",{style:t.modal,onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{style:t.header,children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(_,{style:{color:"#43b581"}}),e.jsx("h2",{style:{margin:0},children:"Sohbet GeÃ§miÅŸini DÄ±ÅŸa Aktar"})]}),e.jsx(z,{onClick:c,style:t.closeBtn})]}),e.jsx("div",{style:t.content,children:i?e.jsxs("div",{style:t.success,children:[e.jsx("div",{style:t.successIcon,children:"âœ…"}),e.jsx("h3",{children:"DÄ±ÅŸa Aktarma TamamlandÄ±!"}),e.jsx("p",{children:"DosyanÄ±z hazÄ±r ve indirilebilir durumda."}),e.jsxs("button",{onClick:B,style:t.downloadBtn,children:[e.jsx(m,{})," DosyayÄ± Ä°ndir"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:t.field,children:[e.jsxs("label",{style:t.label,children:[e.jsx(m,{style:{marginRight:"8px"}}),"Dosya FormatÄ±"]}),e.jsx("div",{style:t.formatGrid,children:C.map(a=>e.jsxs("button",{onClick:()=>j(a.value),style:{...t.formatBtn,backgroundColor:g===a.value?"#5865f2":"#2c2f33"},children:[e.jsx("span",{style:{fontSize:"24px"},children:a.icon}),e.jsx("span",{children:a.label})]},a.value))})]}),e.jsxs("div",{style:t.field,children:[e.jsxs("label",{style:t.label,children:[e.jsx(D,{style:{marginRight:"8px"}}),"Tarih AralÄ±ÄŸÄ± (opsiyonel)"]}),e.jsxs("div",{style:t.dateRange,children:[e.jsx("input",{type:"date",value:o.start_date,onChange:a=>h({...o,start_date:a.target.value}),style:t.dateInput,placeholder:"BaÅŸlangÄ±Ã§"}),e.jsx("span",{style:{color:"#888"},children:"â†’"}),e.jsx("input",{type:"date",value:o.end_date,onChange:a=>h({...o,end_date:a.target.value}),style:t.dateInput,placeholder:"BitiÅŸ"})]})]}),e.jsx("div",{style:t.field,children:e.jsxs("label",{style:t.checkboxLabel,children:[e.jsx("input",{type:"checkbox",checked:b,onChange:a=>k(a.target.checked)}),e.jsx("span",{children:"Ekleri de dahil et (dosya boyutu artabilir)"})]})}),p&&e.jsxs("div",{style:t.progress,children:[e.jsx("div",{style:t.progressSpinner}),e.jsx("p",{children:"Mesajlar iÅŸleniyor..."}),e.jsx("p",{style:{fontSize:"12px",color:"#888"},children:"Bu iÅŸlem birkaÃ§ dakika sÃ¼rebilir"})]})]})}),!i&&e.jsxs("div",{style:t.footer,children:[e.jsx("button",{onClick:c,style:t.cancelBtn,children:"Ä°ptal"}),e.jsx("button",{onClick:I,disabled:p,style:t.exportBtn,children:p?"Ä°ÅŸleniyor...":"DÄ±ÅŸa Aktar"})]})]})})},t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999},modal:{backgroundColor:"#1e1e1e",borderRadius:"8px",width:"90%",maxWidth:"600px",maxHeight:"90vh",display:"flex",flexDirection:"column",color:"#fff"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #333"},closeBtn:{cursor:"pointer",fontSize:"24px",color:"#888"},content:{flex:1,overflowY:"auto",padding:"20px"},field:{marginBottom:"25px"},label:{display:"flex",alignItems:"center",marginBottom:"12px",color:"#dcddde",fontSize:"15px",fontWeight:"600"},formatGrid:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"12px"},formatBtn:{display:"flex",flexDirection:"column",alignItems:"center",gap:"8px",padding:"20px",border:"none",borderRadius:"8px",color:"#fff",cursor:"pointer",fontSize:"14px",fontWeight:"500",transition:"background-color 0.2s"},dateRange:{display:"flex",alignItems:"center",gap:"12px"},dateInput:{flex:1,padding:"10px",backgroundColor:"#2c2f33",border:"1px solid #444",borderRadius:"4px",color:"#fff",fontSize:"14px"},checkboxLabel:{display:"flex",alignItems:"center",gap:"10px",cursor:"pointer",fontSize:"14px"},progress:{textAlign:"center",padding:"30px",backgroundColor:"#2c2f33",borderRadius:"8px"},progressSpinner:{width:"50px",height:"50px",border:"4px solid #333",borderTop:"4px solid #5865f2",borderRadius:"50%",animation:"spin 1s linear infinite",margin:"0 auto 15px"},success:{textAlign:"center",padding:"40px"},successIcon:{fontSize:"64px",marginBottom:"20px"},downloadBtn:{backgroundColor:"#43b581",color:"#fff",border:"none",padding:"15px 30px",borderRadius:"4px",cursor:"pointer",fontSize:"16px",fontWeight:"600",display:"inline-flex",alignItems:"center",gap:"10px",marginTop:"20px"},footer:{display:"flex",gap:"10px",padding:"20px",borderTop:"1px solid #333"},cancelBtn:{flex:1,backgroundColor:"#2c2f33",color:"#fff",border:"none",padding:"12px",borderRadius:"4px",cursor:"pointer",fontSize:"16px",fontWeight:"600"},exportBtn:{flex:1,backgroundColor:"#43b581",color:"#fff",border:"none",padding:"12px",borderRadius:"4px",cursor:"pointer",fontSize:"16px",fontWeight:"600"}};export{J as default};
