import{r as d,n as t}from"./react-core-Cj7FUMmY.js";import{i as _,a as h,W as B,g as I,as as E}from"./icons-vendor-TGltgKsJ.js";import{h as R}from"./index-DrIBbDZv.js";import"./editor-vendor-D9c4a6XZ.js";import"./media-vendor-BsD1gqUZ.js";import"./router-vendor-QeioVw-9.js";import"./state-vendor-MN-5i-Jz.js";import"./crypto-vendor-DK-7ILyQ.js";const W=({fetchWithAuth:r,apiBaseUrl:a,currentUser:$,onClose:c})=>{const[l,s]=d.useState([]),[k,j]=d.useState(!0),f=d.useRef(null);d.useEffect(()=>{v()},[]),d.useEffect(()=>{const e=n=>{f.current&&!f.current.contains(n.target)&&c()};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[c]);const v=async()=>{try{const e=await r(`${a}/notifications/`);if(e.ok){const n=await e.json();s(n.results||n)}}catch{}finally{j(!1)}},u=async e=>{try{await r(`${a}/notifications/${e}/read/`,{method:"POST"}),s(n=>n.map(i=>i.id===e?{...i,is_read:!0}:i))}catch{}},w=async()=>{try{await r(`${a}/notifications/mark_all_read/`,{method:"POST"}),s(e=>e.map(n=>({...n,is_read:!0})))}catch{}},S=async e=>{try{await r(`${a}/notifications/${e}/`,{method:"DELETE"}),s(n=>n.filter(i=>i.id!==e))}catch{}},C=async()=>{if(await R("TÃ¼m bildirimleri silmek istediÄŸinize emin misiniz?"))try{await r(`${a}/notifications/clear_all/`,{method:"POST"}),s([])}catch{}},z=e=>{switch(e){case"message":return"ðŸ’¬";case"mention":return"@";case"friend_request":return"ðŸ‘¥";case"server_invite":return"ðŸ ";case"reaction":return"ðŸ‘";case"reply":return"â†©ï¸";default:return"ðŸ””"}},T=e=>{const n=new Date(e),x=new Date-n,m=Math.floor(x/6e4),b=Math.floor(x/36e5),g=Math.floor(x/864e5);return m<1?"Az Ã¶nce":m<60?`${m} dakika Ã¶nce`:b<24?`${b} saat Ã¶nce`:g<7?`${g} gÃ¼n Ã¶nce`:n.toLocaleDateString()},p=l.filter(e=>!e.is_read).length;return t.jsxs("div",{ref:f,style:o.dropdown,children:[t.jsxs("div",{style:o.header,children:[t.jsxs("div",{style:o.headerLeft,children:[t.jsx(_,{}),t.jsx("span",{style:o.headerTitle,children:"Bildirimler"}),p>0&&t.jsx("span",{style:o.badge,children:p})]}),t.jsx("button",{onClick:c,style:o.closeButton,children:t.jsx(h,{})})]}),l.length>0&&t.jsxs("div",{style:o.actions,children:[p>0&&t.jsxs("button",{onClick:w,style:o.actionButton,children:[t.jsx(B,{})," TÃ¼mÃ¼nÃ¼ okundu iÅŸaretle"]}),t.jsxs("button",{onClick:C,style:{...o.actionButton,color:"#ed4245"},children:[t.jsx(I,{})," TÃ¼mÃ¼nÃ¼ temizle"]})]}),t.jsx("div",{style:o.list,children:k?t.jsx("div",{style:o.loading,children:"YÃ¼kleniyor..."}):l.length===0?t.jsxs("div",{style:o.empty,children:[t.jsx("div",{style:o.emptyIcon,children:"ðŸ””"}),t.jsx("div",{children:"Bildirim yok"}),t.jsx("div",{style:o.emptySubtext,children:"Yeni bildirimler burada gÃ¶rÃ¼necek"})]}):l.map(e=>t.jsxs("div",{style:{...o.notificationItem,backgroundColor:e.is_read?"transparent":"rgba(88, 101, 242, 0.05)"},onClick:()=>!e.is_read&&u(e.id),children:[t.jsx("div",{style:o.notificationIcon,children:z(e.notification_type)}),t.jsxs("div",{style:o.notificationContent,children:[t.jsx("div",{style:o.notificationMessage,children:e.message}),t.jsx("div",{style:o.notificationTime,children:T(e.created_at)})]}),t.jsxs("div",{style:o.notificationActions,children:[!e.is_read&&t.jsx("button",{onClick:n=>{n.stopPropagation(),u(e.id)},style:o.iconButton,title:"Okundu iÅŸaretle",children:t.jsx(E,{})}),t.jsx("button",{onClick:n=>{n.stopPropagation(),S(e.id)},style:o.iconButton,title:"Sil",children:t.jsx(h,{})})]})]},e.id))})]})},o={dropdown:{position:"absolute",top:"100%",right:0,marginTop:"8px",width:"420px",maxWidth:"90vw",maxHeight:"600px",backgroundColor:"#2b2d31",borderRadius:"8px",boxShadow:"0 8px 16px rgba(0,0,0,0.5)",zIndex:1e4,display:"flex",flexDirection:"column",overflow:"hidden"},header:{padding:"16px",borderBottom:"1px solid #1e1f22",display:"flex",justifyContent:"space-between",alignItems:"center",backgroundColor:"#1e1f22"},headerLeft:{display:"flex",alignItems:"center",gap:"8px",color:"#fff",fontSize:"1em",fontWeight:"600"},headerTitle:{fontSize:"1em",fontWeight:"600"},badge:{backgroundColor:"#ed4245",color:"#fff",fontSize:"0.75em",fontWeight:"bold",padding:"2px 6px",borderRadius:"10px",minWidth:"18px",textAlign:"center"},closeButton:{background:"none",border:"none",color:"#b9bbbe",cursor:"pointer",fontSize:"1.2em",padding:"4px",display:"flex",alignItems:"center",borderRadius:"4px",transition:"all 0.15s"},actions:{padding:"12px",display:"flex",gap:"8px",borderBottom:"1px solid #1e1f22",flexWrap:"wrap"},actionButton:{background:"none",border:"1px solid #40444b",color:"#b9bbbe",cursor:"pointer",fontSize:"0.85em",padding:"6px 12px",borderRadius:"4px",display:"flex",alignItems:"center",gap:"6px",transition:"all 0.15s"},list:{flex:1,overflowY:"auto",overflowX:"hidden"},loading:{padding:"40px",textAlign:"center",color:"#b9bbbe"},empty:{padding:"40px 20px",textAlign:"center",color:"#b9bbbe"},emptyIcon:{fontSize:"3em",marginBottom:"12px",opacity:.5},emptySubtext:{fontSize:"0.85em",color:"#72767d",marginTop:"8px"},notificationItem:{padding:"12px 16px",display:"flex",gap:"12px",borderBottom:"1px solid #1e1f22",cursor:"pointer",transition:"background-color 0.15s"},notificationIcon:{fontSize:"1.5em",flexShrink:0},notificationContent:{flex:1,minWidth:0},notificationMessage:{color:"#dbdee1",fontSize:"0.9em",lineHeight:"1.4",marginBottom:"4px"},notificationTime:{color:"#72767d",fontSize:"0.75em"},notificationActions:{display:"flex",gap:"4px",flexShrink:0},iconButton:{background:"none",border:"none",color:"#b9bbbe",cursor:"pointer",fontSize:"0.9em",padding:"4px",display:"flex",alignItems:"center",borderRadius:"4px",transition:"all 0.15s"}},y=document.createElement("style");y.textContent=`
    .notification-item:hover {
        background-color: rgba(255, 255, 255, 0.05) !important;
    }
    .icon-button-notification:hover {
        background-color: rgba(255, 255, 255, 0.1);
        color: #fff;
    }
    .close-button-notification:hover {
        background-color: rgba(255, 255, 255, 0.1);
        color: #fff;
    }
    .action-button-notification:hover {
        background-color: rgba(88, 101, 242, 0.1);
        color: #fff;
        border-color: #5865f2;
    }
`;document.head.appendChild(y);export{W as default};
