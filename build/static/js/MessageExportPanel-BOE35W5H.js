import{r as o,d as e,bS as _,i as z,ay as y,c8 as D}from"./react-core-CecKX_Gm.js";import{t as s}from"./index-DwScqZjU.js";const F=({fetchWithAuth:u,apiBaseUrl:x,roomSlug:E,onClose:d})=>{const[f,h]=o.useState("json"),[l,g]=o.useState({start_date:"",end_date:""}),[b,k]=o.useState(!1),[p,n]=o.useState(!1),[R,v]=o.useState(null),[i,S]=o.useState(null),C=[{value:"json",label:"JSON",icon:"ðŸ“‹"},{value:"csv",label:"CSV (Excel)",icon:"ðŸ“Š"},{value:"txt",label:"Text",icon:"ðŸ“„"},{value:"html",label:"HTML",icon:"ðŸŒ"}],I=async()=>{try{n(!0);const a=await u(`${x}/api/exports/create/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({room_slug:E,format:f,start_date:l.start_date||null,end_date:l.end_date||null,include_attachments:b})});if(a.ok){const r=await a.json();v(r.job_id),s.success("DÄ±ÅŸa aktarma baÅŸlatÄ±ldÄ±"),w(r.job_id)}else s.error("DÄ±ÅŸa aktarma baÅŸlatÄ±lamadÄ±"),n(!1)}catch(a){console.error("Export baÅŸlatma hatasÄ±:",a),s.error("Bir hata oluÅŸtu"),n(!1)}},w=async a=>{const r=setInterval(async()=>{try{const c=await u(`${x}/api/exports/${a}/status/`);if(c.ok){const m=await c.json();m.status==="completed"?(clearInterval(r),n(!1),S(m.download_url),s.success("DÄ±ÅŸa aktarma tamamlandÄ±!")):m.status==="failed"&&(clearInterval(r),n(!1),s.error("DÄ±ÅŸa aktarma baÅŸarÄ±sÄ±z oldu"))}}catch(c){clearInterval(r),n(!1),console.error("Status kontrol hatasÄ±:",c)}},2e3)},B=()=>{i&&(window.open(i,"_blank"),s.success("Ä°ndirme baÅŸlatÄ±ldÄ±"))};return e.createElement("div",{style:t.overlay,onClick:d},e.createElement("div",{style:t.modal,onClick:a=>a.stopPropagation()},e.createElement("div",{style:t.header},e.createElement("div",{style:{display:"flex",alignItems:"center",gap:"10px"}},e.createElement(_,{style:{color:"#43b581"}}),e.createElement("h2",{style:{margin:0}},"Sohbet GeÃ§miÅŸini DÄ±ÅŸa Aktar")),e.createElement(z,{onClick:d,style:t.closeBtn})),e.createElement("div",{style:t.content},i?e.createElement("div",{style:t.success},e.createElement("div",{style:t.successIcon},"âœ…"),e.createElement("h3",null,"DÄ±ÅŸa Aktarma TamamlandÄ±!"),e.createElement("p",null,"DosyanÄ±z hazÄ±r ve indirilebilir durumda."),e.createElement("button",{onClick:B,style:t.downloadBtn},e.createElement(y,null)," DosyayÄ± Ä°ndir")):e.createElement(e.Fragment,null,e.createElement("div",{style:t.field},e.createElement("label",{style:t.label},e.createElement(y,{style:{marginRight:"8px"}}),"Dosya FormatÄ±"),e.createElement("div",{style:t.formatGrid},C.map(a=>e.createElement("button",{key:a.value,onClick:()=>h(a.value),style:{...t.formatBtn,backgroundColor:f===a.value?"#5865f2":"#2c2f33"}},e.createElement("span",{style:{fontSize:"24px"}},a.icon),e.createElement("span",null,a.label))))),e.createElement("div",{style:t.field},e.createElement("label",{style:t.label},e.createElement(D,{style:{marginRight:"8px"}}),"Tarih AralÄ±ÄŸÄ± (opsiyonel)"),e.createElement("div",{style:t.dateRange},e.createElement("input",{type:"date",value:l.start_date,onChange:a=>g({...l,start_date:a.target.value}),style:t.dateInput,placeholder:"BaÅŸlangÄ±Ã§"}),e.createElement("span",{style:{color:"#888"}},"â†’"),e.createElement("input",{type:"date",value:l.end_date,onChange:a=>g({...l,end_date:a.target.value}),style:t.dateInput,placeholder:"BitiÅŸ"}))),e.createElement("div",{style:t.field},e.createElement("label",{style:t.checkboxLabel},e.createElement("input",{type:"checkbox",checked:b,onChange:a=>k(a.target.checked)}),e.createElement("span",null,"Ekleri de dahil et (dosya boyutu artabilir)"))),p&&e.createElement("div",{style:t.progress},e.createElement("div",{style:t.progressSpinner}),e.createElement("p",null,"Mesajlar iÅŸleniyor..."),e.createElement("p",{style:{fontSize:"12px",color:"#888"}},"Bu iÅŸlem birkaÃ§ dakika sÃ¼rebilir")))),!i&&e.createElement("div",{style:t.footer},e.createElement("button",{onClick:d,style:t.cancelBtn},"Ä°ptal"),e.createElement("button",{onClick:I,disabled:p,style:t.exportBtn},p?"Ä°ÅŸleniyor...":"DÄ±ÅŸa Aktar"))))},t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999},modal:{backgroundColor:"#1e1e1e",borderRadius:"8px",width:"90%",maxWidth:"600px",maxHeight:"90vh",display:"flex",flexDirection:"column",color:"#fff"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #333"},closeBtn:{cursor:"pointer",fontSize:"24px",color:"#888"},content:{flex:1,overflowY:"auto",padding:"20px"},field:{marginBottom:"25px"},label:{display:"flex",alignItems:"center",marginBottom:"12px",color:"#dcddde",fontSize:"15px",fontWeight:"600"},formatGrid:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"12px"},formatBtn:{display:"flex",flexDirection:"column",alignItems:"center",gap:"8px",padding:"20px",border:"none",borderRadius:"8px",color:"#fff",cursor:"pointer",fontSize:"14px",fontWeight:"500",transition:"background-color 0.2s"},dateRange:{display:"flex",alignItems:"center",gap:"12px"},dateInput:{flex:1,padding:"10px",backgroundColor:"#2c2f33",border:"1px solid #444",borderRadius:"4px",color:"#fff",fontSize:"14px"},checkboxLabel:{display:"flex",alignItems:"center",gap:"10px",cursor:"pointer",fontSize:"14px"},progress:{textAlign:"center",padding:"30px",backgroundColor:"#2c2f33",borderRadius:"8px"},progressSpinner:{width:"50px",height:"50px",border:"4px solid #333",borderTop:"4px solid #5865f2",borderRadius:"50%",animation:"spin 1s linear infinite",margin:"0 auto 15px"},success:{textAlign:"center",padding:"40px"},successIcon:{fontSize:"64px",marginBottom:"20px"},downloadBtn:{backgroundColor:"#43b581",color:"#fff",border:"none",padding:"15px 30px",borderRadius:"4px",cursor:"pointer",fontSize:"16px",fontWeight:"600",display:"inline-flex",alignItems:"center",gap:"10px",marginTop:"20px"},footer:{display:"flex",gap:"10px",padding:"20px",borderTop:"1px solid #333"},cancelBtn:{flex:1,backgroundColor:"#2c2f33",color:"#fff",border:"none",padding:"12px",borderRadius:"4px",cursor:"pointer",fontSize:"16px",fontWeight:"600"},exportBtn:{flex:1,backgroundColor:"#43b581",color:"#fff",border:"none",padding:"12px",borderRadius:"4px",cursor:"pointer",fontSize:"16px",fontWeight:"600"}};export{F as default};
