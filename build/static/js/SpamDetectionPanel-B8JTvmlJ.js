import{r as o,n as e}from"./react-core-BMiyQWF6.js";import{G as S,a4 as x,bo as M,aZ as F,b2 as C,d as I,b3 as E,ar as g,a as u,b1 as O,j as G,a6 as K,cx as W}from"./icons-vendor-GUGjkvMm.js";import{g as T,t as j}from"./index-CAB0Mj32.js";import"./editor-vendor-D9c4a6XZ.js";import"./media-vendor-BuSyE8vR.js";import"./router-vendor-B86Z1mIL.js";import"./state-vendor-CAyNnPM4.js";import"./crypto-vendor-1Q6e4ZD-.js";const _=({serverId:d,fetchWithAuth:c,apiBaseUrl:f,isAdmin:w=!1})=>{const[n,r]=o.useState({enabled:!0,sensitivity:"medium",actions:{warn:!0,mute:!0,kick:!1,ban:!1},patterns:{rapidMessages:!0,duplicateContent:!0,mentionSpam:!0,linkSpam:!0,capsLock:!0,zalgoText:!0},thresholds:{messagesPerMinute:10,duplicateThreshold:3,mentionLimit:5,linkLimit:3,capsPercentage:70},whitelist:[],customPatterns:[]}),[a,m]=o.useState({totalDetected:0,todayDetected:0,actionsToken:{warn:0,mute:0,kick:0,ban:0},topOffenders:[],recentDetections:[]}),[z,b]=o.useState(!0),[l,R]=o.useState("overview"),L={low:{messagesPerMinute:15,duplicateThreshold:5,mentionLimit:10,linkLimit:5,capsPercentage:80},medium:{messagesPerMinute:10,duplicateThreshold:3,mentionLimit:5,linkLimit:3,capsPercentage:70},high:{messagesPerMinute:7,duplicateThreshold:2,mentionLimit:3,linkLimit:2,capsPercentage:60},aggressive:{messagesPerMinute:5,duplicateThreshold:2,mentionLimit:2,linkLimit:1,capsPercentage:50}},v=o.useCallback(async()=>{b(!0);const s=f||T();try{const i=await c(`${s}/api/servers/${d}/spam-settings/`);if(i.ok){const y=await i.json();r(h=>({...h,...y}))}}catch{}try{const i=await c(`${s}/api/servers/${d}/spam-stats/`);if(i.ok){const y=await i.json();m(h=>({...h,...y}))}else m({totalDetected:0,todayDetected:0,actionsTaken:{warn:0,mute:0,kick:0,ban:0},topOffenders:[],recentDetections:[]})}catch{m({totalDetected:0,todayDetected:0,actionsTaken:{warn:0,mute:0,kick:0,ban:0},topOffenders:[],recentDetections:[]})}b(!1)},[d,c,f]);o.useEffect(()=>{v()},[v]);const D=s=>{r(i=>({...i,sensitivity:s,thresholds:L[s]}))},B=s=>{r(i=>({...i,patterns:{...i.patterns,[s]:!i.patterns[s]}}))},P=s=>{r(i=>({...i,actions:{...i.actions,[s]:!i.actions[s]}}))},A=async()=>{try{const s=f||T();(await c(`${s}/api/servers/${d}/spam-settings/`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})).ok?j.success("Spam koruma ayarlarÄ± kaydedildi! âœ…"):j.error("Ayarlar kaydedilemedi")}catch{j.error("Bir hata oluÅŸtu")}},k=s=>({rapidMessages:e.jsx(W,{}),duplicateContent:e.jsx(C,{}),mentionSpam:e.jsx(K,{}),linkSpam:e.jsx(G,{}),capsLock:e.jsx(I,{}),zalgoText:e.jsx(O,{})})[s]||e.jsx(x,{}),p=s=>({warn:"#faa61a",mute:"#5865f2",kick:"#f04747",ban:"#ed4245"})[s]||"#72767d";return z?e.jsx("div",{style:t.container,children:e.jsxs("div",{style:t.loading,children:[e.jsx(S,{className:"pulse",size:32,color:"#5865f2"}),e.jsx("span",{children:"Spam koruma sistemi yÃ¼kleniyor..."})]})}):e.jsxs("div",{style:t.container,children:[e.jsxs("div",{style:t.header,children:[e.jsxs("div",{style:t.headerLeft,children:[e.jsx(x,{size:24,color:"#43b581"}),e.jsxs("div",{children:[e.jsx("h2",{style:t.title,children:"Spam Koruma Sistemi"}),e.jsx("p",{style:t.subtitle,children:"ML tabanlÄ± akÄ±llÄ± spam algÄ±lama"})]})]}),e.jsx("div",{style:t.headerRight,children:e.jsx("div",{style:{...t.statusBadge,backgroundColor:n.enabled?"rgba(67, 181, 129, 0.2)":"rgba(240, 71, 71, 0.2)",color:n.enabled?"#43b581":"#f04747"},children:n.enabled?"âœ“ Aktif":"âœ— KapalÄ±"})})]}),e.jsx("div",{style:t.tabs,children:["overview","settings","logs"].map(s=>e.jsxs("button",{style:{...t.tab,backgroundColor:l===s?"#5865f2":"transparent",color:l===s?"#fff":"#b9bbbe"},onClick:()=>R(s),children:[s==="overview"&&e.jsx(M,{}),s==="settings"&&e.jsx(F,{}),s==="logs"&&e.jsx(C,{}),s==="overview"?"Genel BakÄ±ÅŸ":s==="settings"?"Ayarlar":"KayÄ±tlar"]},s))}),l==="overview"&&e.jsxs("div",{style:t.content,children:[e.jsxs("div",{style:t.statsGrid,children:[e.jsxs("div",{style:t.statCard,children:[e.jsx("div",{style:t.statIcon,children:e.jsx(x,{size:20,color:"#43b581"})}),e.jsxs("div",{style:t.statInfo,children:[e.jsx("div",{style:t.statValue,children:a.totalDetected}),e.jsx("div",{style:t.statLabel,children:"Toplam Tespit"})]})]}),e.jsxs("div",{style:t.statCard,children:[e.jsx("div",{style:t.statIcon,children:e.jsx(I,{size:20,color:"#faa61a"})}),e.jsxs("div",{style:t.statInfo,children:[e.jsx("div",{style:t.statValue,children:a.todayDetected}),e.jsx("div",{style:t.statLabel,children:"BugÃ¼n"})]})]}),e.jsxs("div",{style:t.statCard,children:[e.jsx("div",{style:t.statIcon,children:e.jsx(E,{size:20,color:"#f04747"})}),e.jsxs("div",{style:t.statInfo,children:[e.jsx("div",{style:t.statValue,children:a.actionsTaken?.ban||0}),e.jsx("div",{style:t.statLabel,children:"Ban"})]})]}),e.jsxs("div",{style:t.statCard,children:[e.jsx("div",{style:t.statIcon,children:e.jsx(S,{size:20,color:"#5865f2"})}),e.jsxs("div",{style:t.statInfo,children:[e.jsx("div",{style:t.statValue,children:Object.values(n.patterns).filter(Boolean).length}),e.jsx("div",{style:t.statLabel,children:"Aktif Kural"})]})]})]}),e.jsxs("div",{style:t.section,children:[e.jsx("h3",{style:t.sectionTitle,children:"Son Tespitler"}),e.jsx("div",{style:t.detectionsList,children:a.recentDetections.map((s,i)=>e.jsxs("div",{style:t.detectionItem,children:[e.jsx("div",{style:t.detectionIcon,children:k(s.type)}),e.jsxs("div",{style:t.detectionInfo,children:[e.jsxs("div",{style:t.detectionUser,children:[e.jsx("strong",{children:s.username}),e.jsx("span",{style:t.detectionType,children:s.type})]}),e.jsxs("div",{style:t.detectionMessage,children:[s.message.substring(0,50),"..."]})]}),e.jsx("div",{style:{...t.actionBadge,backgroundColor:p(s.action)},children:s.action})]},i))})]}),e.jsxs("div",{style:t.section,children:[e.jsx("h3",{style:t.sectionTitle,children:"En Ã‡ok Ä°hlal Edenler"}),e.jsx("div",{style:t.offendersList,children:a.topOffenders.map((s,i)=>e.jsxs("div",{style:t.offenderItem,children:[e.jsxs("div",{style:t.offenderRank,children:["#",i+1]}),e.jsxs("div",{style:t.offenderInfo,children:[e.jsx("span",{style:t.offenderName,children:s.username}),e.jsxs("span",{style:t.offenderCount,children:[s.count," ihlal"]})]}),e.jsx("div",{style:{...t.actionBadge,backgroundColor:p(s.lastAction)},children:s.lastAction})]},i))})]})]}),l==="settings"&&e.jsxs("div",{style:t.content,children:[e.jsxs("div",{style:t.settingRow,children:[e.jsxs("div",{style:t.settingInfo,children:[e.jsx(x,{size:18,color:"#43b581"}),e.jsxs("div",{children:[e.jsx("div",{style:t.settingTitle,children:"Spam KorumasÄ±"}),e.jsx("div",{style:t.settingDesc,children:"Otomatik spam algÄ±lama ve Ã¶nleme"})]})]}),e.jsx("button",{style:{...t.toggleButton,backgroundColor:n.enabled?"#43b581":"#72767d"},onClick:()=>r(s=>({...s,enabled:!s.enabled})),children:n.enabled?e.jsx(g,{}):e.jsx(u,{})})]}),e.jsxs("div",{style:t.section,children:[e.jsx("h3",{style:t.sectionTitle,children:"Hassasiyet Seviyesi"}),e.jsx("div",{style:t.sensitivityGrid,children:["low","medium","high","aggressive"].map(s=>e.jsxs("button",{style:{...t.sensitivityButton,backgroundColor:n.sensitivity===s?"#5865f2":"#40444b",borderColor:n.sensitivity===s?"#5865f2":"transparent"},onClick:()=>D(s),children:[s==="low"&&"ðŸ¢ DÃ¼ÅŸÃ¼k",s==="medium"&&"âš–ï¸ Orta",s==="high"&&"ðŸ”¥ YÃ¼ksek",s==="aggressive"&&"âš¡ Agresif"]},s))})]}),e.jsxs("div",{style:t.section,children:[e.jsx("h3",{style:t.sectionTitle,children:"AlgÄ±lama KalÄ±plarÄ±"}),e.jsx("div",{style:t.patternsGrid,children:Object.entries(n.patterns).map(([s,i])=>e.jsxs("div",{style:t.patternItem,children:[e.jsxs("div",{style:t.patternInfo,children:[k(s),e.jsx("span",{children:s==="rapidMessages"?"HÄ±zlÄ± Mesaj":s==="duplicateContent"?"Tekrarlanan Ä°Ã§erik":s==="mentionSpam"?"Etiket Spam":s==="linkSpam"?"Link Spam":s==="capsLock"?"BÃœYÃœK HARF":"Zalgo Metin"})]}),e.jsx("button",{style:{...t.miniToggle,backgroundColor:i?"#43b581":"#72767d"},onClick:()=>B(s),children:i?e.jsx(g,{size:10}):e.jsx(u,{size:10})})]},s))})]}),e.jsxs("div",{style:t.section,children:[e.jsx("h3",{style:t.sectionTitle,children:"Otomatik Eylemler"}),e.jsx("div",{style:t.actionsGrid,children:Object.entries(n.actions).map(([s,i])=>e.jsxs("div",{style:t.actionItem,children:[e.jsxs("div",{style:t.actionInfo,children:[e.jsx("div",{style:{...t.actionDot,backgroundColor:p(s)}}),e.jsx("span",{children:s==="warn"?"Uyar":s==="mute"?"Sustur":s==="kick"?"At":"Yasakla"})]}),e.jsx("button",{style:{...t.miniToggle,backgroundColor:i?"#43b581":"#72767d"},onClick:()=>P(s),children:i?e.jsx(g,{size:10}):e.jsx(u,{size:10})})]},s))})]}),w&&e.jsxs("button",{style:t.saveButton,onClick:A,children:[e.jsx(g,{})," AyarlarÄ± Kaydet"]})]}),l==="logs"&&e.jsxs("div",{style:t.content,children:[e.jsxs("div",{style:t.logsHeader,children:[e.jsx("h3",{style:t.sectionTitle,children:"Spam KayÄ±tlarÄ±"}),e.jsxs("select",{style:t.filterSelect,children:[e.jsx("option",{value:"all",children:"TÃ¼m Eylemler"}),e.jsx("option",{value:"warn",children:"UyarÄ±lar"}),e.jsx("option",{value:"mute",children:"Susturmalar"}),e.jsx("option",{value:"kick",children:"Atmalar"}),e.jsx("option",{value:"ban",children:"Yasaklamalar"})]})]}),e.jsx("div",{style:t.logsList,children:a.recentDetections.map((s,i)=>e.jsxs("div",{style:t.logItem,children:[e.jsx("div",{style:t.logTime,children:new Date(s.timestamp).toLocaleString("tr-TR")}),e.jsxs("div",{style:t.logContent,children:[e.jsx("strong",{children:s.username})," - ",s.type,e.jsxs("div",{style:t.logMessage,children:['"',s.message,'"']})]}),e.jsx("div",{style:{...t.actionBadge,backgroundColor:p(s.action)},children:s.action})]},i))})]})]})},t={container:{backgroundColor:"#2f3136",borderRadius:"8px",overflow:"hidden"},loading:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"16px",padding:"60px",color:"#b9bbbe"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #202225"},headerLeft:{display:"flex",alignItems:"center",gap:"16px"},headerRight:{display:"flex",alignItems:"center"},title:{margin:0,fontSize:"18px",fontWeight:"600",color:"#fff"},subtitle:{margin:"4px 0 0",fontSize:"13px",color:"#72767d"},statusBadge:{padding:"6px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},tabs:{display:"flex",padding:"0 20px",borderBottom:"1px solid #202225",gap:"8px"},tab:{display:"flex",alignItems:"center",gap:"8px",padding:"12px 16px",border:"none",borderRadius:"4px 4px 0 0",cursor:"pointer",fontSize:"13px",fontWeight:"500",transition:"all 0.15s"},content:{padding:"20px"},statsGrid:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"12px",marginBottom:"24px"},statCard:{display:"flex",alignItems:"center",gap:"12px",padding:"16px",backgroundColor:"#202225",borderRadius:"8px"},statIcon:{display:"flex",alignItems:"center",justifyContent:"center",width:"40px",height:"40px",backgroundColor:"#36393f",borderRadius:"8px"},statInfo:{flex:1},statValue:{fontSize:"20px",fontWeight:"700",color:"#fff"},statLabel:{fontSize:"12px",color:"#72767d"},section:{marginBottom:"24px"},sectionTitle:{margin:"0 0 16px",fontSize:"14px",fontWeight:"600",color:"#fff",textTransform:"uppercase",letterSpacing:"0.5px"},detectionsList:{display:"flex",flexDirection:"column",gap:"8px"},detectionItem:{display:"flex",alignItems:"center",gap:"12px",padding:"12px 16px",backgroundColor:"#202225",borderRadius:"6px"},detectionIcon:{color:"#faa61a"},detectionInfo:{flex:1},detectionUser:{display:"flex",alignItems:"center",gap:"8px",color:"#fff",fontSize:"14px"},detectionType:{fontSize:"11px",color:"#72767d",backgroundColor:"#40444b",padding:"2px 6px",borderRadius:"3px"},detectionMessage:{fontSize:"12px",color:"#72767d",marginTop:"4px"},actionBadge:{padding:"4px 10px",borderRadius:"4px",color:"#fff",fontSize:"11px",fontWeight:"600",textTransform:"uppercase"},offendersList:{display:"flex",flexDirection:"column",gap:"8px"},offenderItem:{display:"flex",alignItems:"center",gap:"12px",padding:"12px 16px",backgroundColor:"#202225",borderRadius:"6px"},offenderRank:{width:"28px",height:"28px",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#40444b",borderRadius:"50%",fontSize:"12px",fontWeight:"600",color:"#fff"},offenderInfo:{flex:1,display:"flex",flexDirection:"column"},offenderName:{color:"#fff",fontSize:"14px",fontWeight:"500"},offenderCount:{color:"#72767d",fontSize:"12px"},settingRow:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px",backgroundColor:"#202225",borderRadius:"8px",marginBottom:"16px"},settingInfo:{display:"flex",alignItems:"center",gap:"12px"},settingTitle:{color:"#fff",fontSize:"14px",fontWeight:"500"},settingDesc:{color:"#72767d",fontSize:"12px"},toggleButton:{width:"44px",height:"24px",border:"none",borderRadius:"12px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",transition:"background-color 0.2s"},sensitivityGrid:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"8px"},sensitivityButton:{padding:"12px",border:"2px solid transparent",borderRadius:"8px",cursor:"pointer",color:"#fff",fontSize:"13px",fontWeight:"500",transition:"all 0.15s"},patternsGrid:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"8px"},patternItem:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 16px",backgroundColor:"#202225",borderRadius:"6px"},patternInfo:{display:"flex",alignItems:"center",gap:"10px",color:"#dcddde",fontSize:"13px"},miniToggle:{width:"28px",height:"18px",border:"none",borderRadius:"9px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",transition:"background-color 0.2s"},actionsGrid:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"8px"},actionItem:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 16px",backgroundColor:"#202225",borderRadius:"6px"},actionInfo:{display:"flex",alignItems:"center",gap:"8px",color:"#dcddde",fontSize:"13px"},actionDot:{width:"8px",height:"8px",borderRadius:"50%"},saveButton:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",width:"100%",padding:"12px",backgroundColor:"#43b581",border:"none",borderRadius:"4px",color:"#fff",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"background-color 0.15s"},logsHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},filterSelect:{padding:"8px 12px",backgroundColor:"#202225",border:"1px solid #40444b",borderRadius:"4px",color:"#dcddde",fontSize:"13px"},logsList:{display:"flex",flexDirection:"column",gap:"8px"},logItem:{display:"flex",alignItems:"flex-start",gap:"12px",padding:"12px 16px",backgroundColor:"#202225",borderRadius:"6px"},logTime:{fontSize:"11px",color:"#72767d",whiteSpace:"nowrap"},logContent:{flex:1,fontSize:"13px",color:"#dcddde"},logMessage:{fontSize:"12px",color:"#72767d",marginTop:"4px",fontStyle:"italic"}};export{_ as default};
