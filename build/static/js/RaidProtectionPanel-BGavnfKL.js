import{r,b as e}from"./react-core-9vc7GIjk.js";import{t as y}from"./index-yU2QQOg8.js";import{V as x,a as C,aU as _,bd as b,aJ as L,be as I,aN as B}from"./icons-vendor-BHKL7tCa.js";import"./editor-vendor-DiU449Dh.js";import"./media-vendor-B-uSUaIv.js";import"./router-vendor-u6fxj6P4.js";import"./crypto-vendor-C1qXRpJv.js";import"./state-vendor-0vlBuk0v.js";const N=({serverId:l,fetchWithAuth:c,apiBaseUrl:s,onClose:m})=>{const[a,d]=r.useState({enabled:!1,join_rate_limit:10,new_account_age:7,verification_level:"medium",auto_kick_suspicious:!0,lockdown_mode:!1}),[g,v]=r.useState([]),[p,R]=r.useState({blocked_joins:0,kicked_users:0,raid_attempts:0,last_raid:null}),[z,E]=r.useState(!0);r.useEffect(()=>{k(),f();const i=setInterval(f,3e4);return()=>clearInterval(i)},[l]);const k=async()=>{try{const i=await c(`${s}/moderation/raid-protection/${l}/`);if(i.ok){const o=await i.json();d(o)}}catch(i){console.error("Failed to load raid protection:",i)}E(!1)},f=async()=>{try{const i=await c(`${s}/moderation/raid-protection/check/`,{method:"POST",body:JSON.stringify({server_id:l})});if(i.ok){const o=await i.json();v(o.recent_activity||[]),o.raid_detected&&y.error(`‚ö†Ô∏è RAID DETECTED!
${o.message}

Automatic protection activated.`)}}catch(i){console.error("Failed to check raid activity:",i)}},h=async()=>{try{const i=await c(`${s}/moderation/raid-protection/enable/`,{method:"POST",body:JSON.stringify({server_id:l,enabled:!a.enabled})});if(i.ok){const o=await i.json();d({...a,enabled:!a.enabled})}}catch(i){console.error("Failed to toggle raid protection:",i)}},n=async(i,o)=>{const u={...a,[i]:o};d(u);try{await c(`${s}/moderation/raid-protection/update/`,{method:"POST",body:JSON.stringify({server_id:l,...u})})}catch(S){console.error("Failed to update setting:",S)}},w=async()=>{if(window.confirm(`‚ö†Ô∏è LOCKDOWN MODE

This will:
- Block all new joins
- Require manual approval for each user
- Kick suspicious accounts

Activate?`))try{await n("lockdown_mode",!0),y.success("üîí Lockdown Mode Activated!")}catch(i){console.error("Failed to activate lockdown:",i)}};return e.createElement("div",{style:t.overlay,onClick:m},e.createElement("div",{style:t.panel,onClick:i=>i.stopPropagation()},e.createElement("div",{style:t.header},e.createElement("div",{style:t.headerLeft},e.createElement(x,{style:{...t.headerIcon,color:a.enabled?"#43b581":"#72767d"}}),e.createElement("h2",{style:t.title},"Raid Protection"),a.lockdown_mode&&e.createElement("span",{style:t.lockdownBadge},"üîí LOCKDOWN")),e.createElement("button",{onClick:m,style:t.closeButton},e.createElement(C,null))),e.createElement("div",{style:t.statsGrid},e.createElement("div",{style:t.statCard},e.createElement(_,{style:{...t.statIcon,color:"#ed4245"}}),e.createElement("div",{style:t.statValue},p.blocked_joins),e.createElement("div",{style:t.statLabel},"Blocked Joins")),e.createElement("div",{style:t.statCard},e.createElement(b,{style:{...t.statIcon,color:"#f0b132"}}),e.createElement("div",{style:t.statValue},p.kicked_users),e.createElement("div",{style:t.statLabel},"Auto-Kicked")),e.createElement("div",{style:t.statCard},e.createElement(L,{style:{...t.statIcon,color:"#f04747"}}),e.createElement("div",{style:t.statValue},p.raid_attempts),e.createElement("div",{style:t.statLabel},"Raid Attempts")),e.createElement("div",{style:t.statCard},e.createElement(I,{style:{...t.statIcon,color:"#5865f2"}}),e.createElement("div",{style:t.statValue},a.enabled?"ACTIVE":"OFF"),e.createElement("div",{style:t.statLabel},"Status"))),e.createElement("div",{style:t.section},e.createElement("div",{style:t.sectionHeader},e.createElement("h3",{style:t.sectionTitle},e.createElement(B,null)," Protection Settings"),e.createElement("label",{style:t.masterSwitch},e.createElement("input",{type:"checkbox",checked:a.enabled,onChange:h}),e.createElement("span",{style:t.switchSlider}),e.createElement("span",{style:t.switchLabel},a.enabled?"Enabled":"Disabled"))),e.createElement("div",{style:t.settings},e.createElement("div",{style:t.setting},e.createElement("div",{style:t.settingInfo},e.createElement("div",{style:t.settingLabel},"Join Rate Limit"),e.createElement("div",{style:t.settingDesc},"Maximum users per minute: ",a.join_rate_limit)),e.createElement("input",{type:"range",min:"5",max:"50",value:a.join_rate_limit,onChange:i=>n("join_rate_limit",parseInt(i.target.value)),style:t.slider,disabled:!a.enabled})),e.createElement("div",{style:t.setting},e.createElement("div",{style:t.settingInfo},e.createElement("div",{style:t.settingLabel},"New Account Age Limit"),e.createElement("div",{style:t.settingDesc},"Block accounts younger than ",a.new_account_age," days")),e.createElement("select",{value:a.new_account_age,onChange:i=>n("new_account_age",parseInt(i.target.value)),style:t.select,disabled:!a.enabled},e.createElement("option",{value:"1"},"1 day"),e.createElement("option",{value:"3"},"3 days"),e.createElement("option",{value:"7"},"7 days"),e.createElement("option",{value:"14"},"14 days"),e.createElement("option",{value:"30"},"30 days"))),e.createElement("div",{style:t.setting},e.createElement("div",{style:t.settingInfo},e.createElement("div",{style:t.settingLabel},"Verification Level"),e.createElement("div",{style:t.settingDesc},a.verification_level==="low"&&"Basic: Email verification",a.verification_level==="medium"&&"Medium: Email + Phone",a.verification_level==="high"&&"High: Email + Phone + Captcha")),e.createElement("select",{value:a.verification_level,onChange:i=>n("verification_level",i.target.value),style:t.select,disabled:!a.enabled},e.createElement("option",{value:"low"},"Low"),e.createElement("option",{value:"medium"},"Medium"),e.createElement("option",{value:"high"},"High"))),e.createElement("div",{style:t.setting},e.createElement("div",{style:t.settingInfo},e.createElement("div",{style:t.settingLabel},"Auto-Kick Suspicious Accounts"),e.createElement("div",{style:t.settingDesc},"Automatically kick accounts flagged as suspicious")),e.createElement("label",{style:t.toggleSwitch},e.createElement("input",{type:"checkbox",checked:a.auto_kick_suspicious,onChange:i=>n("auto_kick_suspicious",i.target.checked),disabled:!a.enabled}),e.createElement("span",{style:t.toggleSlider}))),e.createElement("div",{style:t.setting},e.createElement("div",{style:t.settingInfo},e.createElement("div",{style:t.settingLabel},"üîí Lockdown Mode"),e.createElement("div",{style:t.settingDesc},"Block ALL new joins (emergency mode)")),a.lockdown_mode?e.createElement("button",{onClick:()=>n("lockdown_mode",!1),style:t.lockdownDeactivateBtn},"Deactivate"):e.createElement("button",{onClick:w,style:t.lockdownBtn,disabled:!a.enabled},"Activate")))),e.createElement("div",{style:t.section},e.createElement("h3",{style:t.sectionTitle},e.createElement(b,null)," Recent Activity"),e.createElement("div",{style:t.activityList},g.length===0?e.createElement("div",{style:t.empty},"No suspicious activity detected"):g.map((i,o)=>e.createElement("div",{key:o,style:t.activityItem},e.createElement("div",{style:t.activityIcon},i.type==="raid"?"‚ö†Ô∏è":i.type==="suspicious"?"üëÄ":"‚úÖ"),e.createElement("div",{style:t.activityContent},e.createElement("div",{style:t.activityText},i.message),e.createElement("div",{style:t.activityTime},new Date(i.timestamp).toLocaleString())),i.action&&e.createElement("div",{style:t.activityAction},e.createElement("span",{style:t.actionBadge},i.action)))))),e.createElement("div",{style:t.infoBox},e.createElement(x,{style:t.infoIcon}),e.createElement("div",{style:t.infoContent},e.createElement("strong",null,"How Raid Protection Works:"),e.createElement("ul",{style:t.infoList},e.createElement("li",null,"Monitors join rate (users per minute)"),e.createElement("li",null,"Checks account age and activity"),e.createElement("li",null,"Auto-kicks suspicious patterns"),e.createElement("li",null,"Activates lockdown during active raids"))))))},t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,backdropFilter:"blur(5px)"},panel:{backgroundColor:"#2b2d31",borderRadius:"12px",width:"90%",maxWidth:"900px",maxHeight:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.5)",overflow:"hidden"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #1e1f22"},headerLeft:{display:"flex",alignItems:"center",gap:"12px"},headerIcon:{fontSize:"24px"},title:{margin:0,color:"#fff",fontSize:"24px",fontWeight:"600"},lockdownBadge:{backgroundColor:"#ed4245",color:"#fff",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"700",animation:"pulse 1.5s infinite"},closeButton:{background:"none",border:"none",color:"#b9bbbe",cursor:"pointer",fontSize:"24px",padding:"8px",borderRadius:"4px"},statsGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:"16px",padding:"20px",borderBottom:"1px solid #1e1f22"},statCard:{backgroundColor:"#1e1f22",borderRadius:"8px",padding:"16px",textAlign:"center"},statIcon:{fontSize:"32px",marginBottom:"8px"},statValue:{fontSize:"28px",fontWeight:"bold",color:"#fff",marginBottom:"4px"},statLabel:{fontSize:"13px",color:"#b9bbbe"},section:{padding:"20px",borderBottom:"1px solid #1e1f22",overflowY:"auto"},sectionHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},sectionTitle:{color:"#fff",fontSize:"18px",fontWeight:"600",margin:0,display:"flex",alignItems:"center",gap:"8px"},masterSwitch:{display:"flex",alignItems:"center",gap:"12px",cursor:"pointer"},switchSlider:{position:"relative",width:"48px",height:"24px",backgroundColor:"#72767d",borderRadius:"24px",transition:"0.3s"},switchLabel:{color:"#fff",fontSize:"14px",fontWeight:"600"},settings:{display:"flex",flexDirection:"column",gap:"20px"},setting:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px",backgroundColor:"#1e1f22",borderRadius:"8px"},settingInfo:{flex:1},settingLabel:{color:"#fff",fontSize:"15px",fontWeight:"600",marginBottom:"4px"},settingDesc:{color:"#b9bbbe",fontSize:"13px"},slider:{width:"200px",marginLeft:"20px"},select:{backgroundColor:"#2b2d31",border:"1px solid #1e1f22",borderRadius:"6px",padding:"8px 12px",color:"#fff",fontSize:"14px",marginLeft:"20px",minWidth:"150px"},toggleSwitch:{position:"relative",width:"48px",height:"24px",marginLeft:"20px"},toggleSlider:{position:"absolute",cursor:"pointer",top:0,left:0,right:0,bottom:0,backgroundColor:"#72767d",transition:"0.3s",borderRadius:"24px"},lockdownBtn:{backgroundColor:"#ed4245",color:"#fff",border:"none",borderRadius:"6px",padding:"8px 16px",cursor:"pointer",fontSize:"14px",fontWeight:"600",marginLeft:"20px"},lockdownDeactivateBtn:{backgroundColor:"#43b581",color:"#fff",border:"none",borderRadius:"6px",padding:"8px 16px",cursor:"pointer",fontSize:"14px",fontWeight:"600",marginLeft:"20px"},activityList:{display:"flex",flexDirection:"column",gap:"12px"},empty:{textAlign:"center",color:"#b9bbbe",padding:"40px",fontSize:"14px"},activityItem:{display:"flex",alignItems:"center",gap:"12px",padding:"12px",backgroundColor:"#1e1f22",borderRadius:"6px"},activityIcon:{fontSize:"24px"},activityContent:{flex:1},activityText:{color:"#fff",fontSize:"14px",marginBottom:"4px"},activityTime:{color:"#72767d",fontSize:"12px"},activityAction:{marginLeft:"auto"},actionBadge:{padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"600",backgroundColor:"#5865f2",color:"#fff"},infoBox:{display:"flex",gap:"16px",padding:"20px",backgroundColor:"rgba(88, 101, 242, 0.1)",borderTop:"1px solid #5865f2"},infoIcon:{fontSize:"24px",color:"#5865f2",marginTop:"4px"},infoContent:{color:"#fff",fontSize:"14px"},infoList:{margin:"8px 0 0 0",paddingLeft:"20px",color:"#b9bbbe"}};export{N as default};
