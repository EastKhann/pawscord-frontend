import{r as c,l as X,bI as Y,bJ as B,v as T}from"./react-core-B6hadH-M.js";const M=({roomSlug:p,onClose:i,wsProtocol:h,apiHost:g})=>{const t=c.useRef(null),s=c.useRef(null),[v,y]=c.useState(!1),[d,u]=c.useState("#000000"),[f,x]=c.useState(3);c.useEffect(()=>{const e=`${h}://${g}/ws/whiteboard/${p}/`;return s.current=new WebSocket(e),s.current.onmessage=n=>{const{x:l,y:o,type:w,color:k,width:C,prevX:S,prevY:W}=JSON.parse(n.data),a=t.current.getContext("2d");w==="draw"?(a.beginPath(),a.moveTo(S,W),a.lineTo(l,o),a.strokeStyle=k,a.lineWidth=C,a.lineCap="round",a.stroke()):w==="clear"&&a.clearRect(0,0,t.current.width,t.current.height)},()=>s.current.close()},[p,h,g]),c.useEffect(()=>{const e=n=>{n.key==="Escape"&&i()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[i]),c.useEffect(()=>{const e=t.current;e.width=800,e.height=600;const n=e.getContext("2d");n.fillStyle="white",n.fillRect(0,0,e.width,e.height)},[]);const b=({nativeEvent:e})=>{const{offsetX:n,offsetY:l}=e;y(!0),t.current.lastX=n,t.current.lastY=l},E=({nativeEvent:e})=>{if(!v)return;const{offsetX:n,offsetY:l}=e,o=t.current.getContext("2d");o.beginPath(),o.moveTo(t.current.lastX,t.current.lastY),o.lineTo(n,l),o.strokeStyle=d,o.lineWidth=f,o.lineCap="round",o.stroke(),s.current.readyState===WebSocket.OPEN&&s.current.send(JSON.stringify({type:"draw",x:n,y:l,prevX:t.current.lastX,prevY:t.current.lastY,color:d,width:f})),t.current.lastX=n,t.current.lastY=l},m=()=>{y(!1)},R=()=>{const e=t.current.getContext("2d");e.fillStyle="white",e.fillRect(0,0,t.current.width,t.current.height),s.current.send(JSON.stringify({type:"clear"}))};return React.createElement("div",{style:r.overlay,onClick:i},React.createElement("div",{style:r.modal,onClick:e=>e.stopPropagation()},React.createElement("div",{style:r.header},React.createElement("h3",null,"ðŸŽ¨ Ortak Ã‡izim TahtasÄ±"),React.createElement("button",{onClick:i,style:r.closeBtn},React.createElement(X,null))),React.createElement("div",{style:r.toolbar},React.createElement("input",{type:"color",value:d,onChange:e=>u(e.target.value),style:r.colorPicker}),React.createElement("input",{type:"range",min:"1",max:"20",value:f,onChange:e=>x(e.target.value)}),React.createElement("button",{onClick:()=>u("#ffffff"),style:r.toolBtn},React.createElement(Y,null)),React.createElement("button",{onClick:()=>u("#000000"),style:r.toolBtn},React.createElement(B,null)),React.createElement("button",{onClick:R,style:{...r.toolBtn,color:"red"}},React.createElement(T,null))),React.createElement("div",{style:r.canvasContainer},React.createElement("canvas",{ref:t,onMouseDown:b,onMouseMove:E,onMouseUp:m,onMouseLeave:m,style:r.canvas}))))},r={overlay:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0.85)",zIndex:3e3,display:"flex",justifyContent:"center",alignItems:"center"},modal:{backgroundColor:"#2b2d31",borderRadius:"12px",padding:"10px",display:"flex",flexDirection:"column",gap:"10px"},header:{display:"flex",justifyContent:"space-between",color:"white",padding:"0 10px"},closeBtn:{background:"none",border:"none",color:"white",fontSize:"1.5em",cursor:"pointer"},toolbar:{display:"flex",gap:"10px",alignItems:"center",backgroundColor:"#1e1f22",padding:"10px",borderRadius:"8px"},canvasContainer:{border:"1px solid #1e1f22",borderRadius:"4px",overflow:"hidden",backgroundColor:"white"},canvas:{cursor:"crosshair",touchAction:"none"},toolBtn:{background:"none",border:"none",color:"#ccc",fontSize:"1.2em",cursor:"pointer"},colorPicker:{border:"none",width:"30px",height:"30px",cursor:"pointer",padding:0}};export{M as default};
