import{r as l,n as j,D as n,l as y,ct as _,a1 as g,am as h,cl as f,ak as E,Y as k}from"./react-core-B6hadH-M.js";import{g as $}from"./index-D_6pZib5.js";const F=({serverId:R,onClose:m,fetchWithAuth:v})=>{const[a,i]=l.useState(null),[N,u]=l.useState(!0),[c,r]=l.useState("overview"),[o,p]=l.useState("week"),d=l.useCallback(async()=>{u(!0);try{const e=await v(`${$()}/servers/${R}/reaction-stats/?range=${o}`);if(e.ok){const t=await e.json();i(t)}else i({total_reactions:0,unique_emojis:0,top_emojis:[],top_reactors:[],hourly_distribution:Array(24).fill(0),daily_trend:[],most_reacted_messages:[]})}catch(e){console.error("Error loading reaction stats:",e),i({total_reactions:0,unique_emojis:0,top_emojis:[],top_reactors:[],hourly_distribution:Array(24).fill(0),daily_trend:[],most_reacted_messages:[]})}u(!1)},[R,o,v]);l.useEffect(()=>{d()},[d]);const s=e=>e>=1e6?(e/1e6).toFixed(1)+"M":e>=1e3?(e/1e3).toFixed(1)+"K":e?.toString()||"0",b=()=>a?.hourly_distribution?Math.max(...a.hourly_distribution,1):1;return N?React.createElement("div",{className:"reaction-stats-overlay",onClick:m},React.createElement("div",{className:"reaction-stats-panel",onClick:e=>e.stopPropagation()},React.createElement("div",{className:"loading-spinner"},React.createElement(j,{className:"spin"}),React.createElement("span",null,"Loading reaction statistics...")))):React.createElement("div",{className:"reaction-stats-overlay",onClick:m},React.createElement("div",{className:"reaction-stats-panel",onClick:e=>e.stopPropagation()},React.createElement("div",{className:"panel-header"},React.createElement("div",{className:"header-info"},React.createElement("h2",null,React.createElement(n,null)," Reaction Statistics"),React.createElement("span",{className:"subtitle"},"Discover emoji trends and patterns")),React.createElement("div",{className:"header-actions"},React.createElement("select",{value:o,onChange:e=>p(e.target.value),className:"time-range-select"},React.createElement("option",{value:"day"},"Last 24 Hours"),React.createElement("option",{value:"week"},"Last 7 Days"),React.createElement("option",{value:"month"},"Last 30 Days"),React.createElement("option",{value:"all"},"All Time")),React.createElement("button",{className:"close-btn",onClick:m},React.createElement(y,null)))),React.createElement("div",{className:"stats-overview"},React.createElement("div",{className:"stat-card"},React.createElement("div",{className:"stat-icon"},React.createElement(_,null)),React.createElement("div",{className:"stat-info"},React.createElement("span",{className:"stat-value"},s(a?.total_reactions)),React.createElement("span",{className:"stat-label"},"Total Reactions"))),React.createElement("div",{className:"stat-card"},React.createElement("div",{className:"stat-icon"},React.createElement(n,null)),React.createElement("div",{className:"stat-info"},React.createElement("span",{className:"stat-value"},s(a?.unique_emojis)),React.createElement("span",{className:"stat-label"},"Unique Emojis"))),React.createElement("div",{className:"stat-card"},React.createElement("div",{className:"stat-icon"},React.createElement(g,null)),React.createElement("div",{className:"stat-info"},React.createElement("span",{className:"stat-value"},s(a?.top_reactors?.length)),React.createElement("span",{className:"stat-label"},"Active Reactors"))),React.createElement("div",{className:"stat-card"},React.createElement("div",{className:"stat-icon"},React.createElement(h,null)),React.createElement("div",{className:"stat-info"},React.createElement("span",{className:"stat-value"},a?.top_emojis?.[0]?.emoji||"ðŸ”¥"),React.createElement("span",{className:"stat-label"},"Top Emoji")))),React.createElement("div",{className:"tabs"},React.createElement("button",{className:`tab ${c==="overview"?"active":""}`,onClick:()=>r("overview")},React.createElement(f,null)," Overview"),React.createElement("button",{className:`tab ${c==="emojis"?"active":""}`,onClick:()=>r("emojis")},React.createElement(n,null)," Top Emojis"),React.createElement("button",{className:`tab ${c==="users"?"active":""}`,onClick:()=>r("users")},React.createElement(E,null)," Top Reactors"),React.createElement("button",{className:`tab ${c==="time"?"active":""}`,onClick:()=>r("time")},React.createElement(k,null)," Activity Pattern")),React.createElement("div",{className:"tab-content"},c==="overview"&&React.createElement("div",{className:"overview-tab"},React.createElement("div",{className:"section"},React.createElement("h3",null,"ðŸ”¥ Trending Emojis"),React.createElement("div",{className:"emoji-grid"},(a?.top_emojis||[]).slice(0,10).map((e,t)=>React.createElement("div",{key:t,className:"emoji-item"},React.createElement("span",{className:"emoji"},e.emoji),React.createElement("span",{className:"count"},s(e.count)),React.createElement("div",{className:"progress-bar"},React.createElement("div",{className:"progress",style:{width:`${e.count/(a?.top_emojis?.[0]?.count||1)*100}%`}})))),(!a?.top_emojis||a.top_emojis.length===0)&&React.createElement("div",{className:"empty-state"},"No reaction data yet")))),c==="emojis"&&React.createElement("div",{className:"emojis-tab"},React.createElement("div",{className:"emoji-leaderboard"},(a?.top_emojis||[]).map((e,t)=>React.createElement("div",{key:t,className:`leaderboard-item ${t<3?"top-three":""}`},React.createElement("span",{className:"rank"},"#",t+1),React.createElement("span",{className:"emoji-large"},e.emoji),React.createElement("div",{className:"emoji-details"},React.createElement("span",{className:"emoji-name"},e.name||"Custom Emoji"),React.createElement("span",{className:"emoji-usage"},s(e.count)," uses")),React.createElement("div",{className:"emoji-bar"},React.createElement("div",{className:"bar-fill",style:{width:`${e.count/(a?.top_emojis?.[0]?.count||1)*100}%`}})))),(!a?.top_emojis||a.top_emojis.length===0)&&React.createElement("div",{className:"empty-state"},React.createElement(n,{size:48}),React.createElement("p",null,"No emoji data available")))),c==="users"&&React.createElement("div",{className:"users-tab"},React.createElement("div",{className:"user-leaderboard"},(a?.top_reactors||[]).map((e,t)=>React.createElement("div",{key:t,className:`user-item ${t<3?"top-three":""}`},React.createElement("span",{className:`rank rank-${t+1}`},t<3?React.createElement(E,null):`#${t+1}`),React.createElement("div",{className:"user-avatar"},e.avatar?React.createElement("img",{src:e.avatar,alt:e.username}):e.username?.charAt(0).toUpperCase()||"?"),React.createElement("div",{className:"user-info"},React.createElement("span",{className:"username"},e.username),React.createElement("span",{className:"reaction-count"},s(e.count)," reactions")),React.createElement("div",{className:"user-favorite"},React.createElement("span",{className:"favorite-emoji"},e.favorite_emoji||"â¤ï¸")))),(!a?.top_reactors||a.top_reactors.length===0)&&React.createElement("div",{className:"empty-state"},React.createElement(E,{size:48}),React.createElement("p",null,"No reactor data available")))),c==="time"&&React.createElement("div",{className:"time-tab"},React.createElement("div",{className:"section"},React.createElement("h3",null,"â° Hourly Activity"),React.createElement("div",{className:"hourly-chart"},(a?.hourly_distribution||Array(24).fill(0)).map((e,t)=>React.createElement("div",{key:t,className:"hour-bar"},React.createElement("div",{className:"bar",style:{height:`${Math.max(e/b()*100,5)}%`},title:`${t}:00 - ${e} reactions`}),React.createElement("span",{className:"hour-label"},t)))),React.createElement("p",{className:"chart-note"},"Hours shown in your local timezone"))))))};export{F as default};
