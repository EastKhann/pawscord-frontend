import{T as h,a8 as E,r as t,$ as S,ay as C,az as z}from"./react-core-B6hadH-M.js";import{a as A,A as v}from"./index-D_6pZib5.js";const B=()=>{const{login:m}=A(),r=h(),[x]=E(),[d,k]=t.useState(""),[o,b]=t.useState(!1),[p,y]=t.useState(""),[g,l]=t.useState(""),[i,f]=t.useState(!1),c=x.get("temp_token");if(t.useEffect(()=>{c||(console.warn("üîê [2FA] No temp_token found, redirecting to login"),r("/login"))},[c,r]),!c)return null;const R=async n=>{n.preventDefault(),l(""),f(!0);const s=o?p:d;if(!s){l("Kod gerekli"),f(!1);return}try{const u=await fetch(`${v}/security/2fa/verify-login/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({temp_token:c,code:s})}),a=await u.json();u.ok&&a.verified?(m(a.access,a.refresh),r("/")):(console.error("‚ùå [2FA] Verification failed:",a),l(a.error||"Ge√ßersiz kod"))}catch(u){console.error("‚ùå [2FA] Network error:",u),l("Baƒülantƒ± hatasƒ± olu≈ütu")}finally{f(!1)}};return React.createElement("div",{style:e.container},React.createElement("div",{style:e.card},React.createElement("button",{onClick:()=>r("/login"),style:e.backButton},React.createElement(S,null)," Geri"),React.createElement(C,{style:e.icon}),React.createElement("h2",{style:e.title},"ƒ∞ki Fakt√∂rl√º Doƒürulama"),React.createElement("p",{style:e.subtitle},o?"Yedek kodunuzu girin":"Authenticator uygulamanƒ±zdaki 6 haneli kodu girin"),React.createElement("form",{onSubmit:R,style:e.form},o?React.createElement(React.Fragment,null,React.createElement("input",{type:"text",placeholder:"Yedek kod",value:p,onChange:n=>y(n.target.value),style:e.backupInput,autoFocus:!0,disabled:i}),React.createElement("button",{type:"button",onClick:()=>b(!1),style:e.backupLink},"‚Üê Authenticator kodu kullan")):React.createElement(React.Fragment,null,React.createElement("input",{type:"text",maxLength:6,placeholder:"000000",value:d,onChange:n=>{const s=n.target.value.replace(/\D/g,"");k(s)},style:e.codeInput,autoFocus:!0,disabled:i}),React.createElement("button",{type:"button",onClick:()=>b(!0),style:e.backupLink},React.createElement(z,null)," Yedek kod kullan")),g&&React.createElement("div",{style:e.error},"‚ùå ",g),React.createElement("button",{type:"submit",style:e.submitButton,disabled:i||!o&&d.length!==6||o&&!p},i?"Doƒürulanƒ±yor...":"Giri≈ü Yap")),React.createElement("div",{style:e.info},React.createElement("p",{style:e.infoTitle},"üí° ƒ∞pu√ßlarƒ±:"),React.createElement("ul",{style:e.infoList},React.createElement("li",null,"Kod s√ºrekli deƒüi≈üir (30 saniyede bir)"),React.createElement("li",null,"Telefonunuzu kaybettiyseniz yedek kod kullanƒ±n"),React.createElement("li",null,"Her yedek kod sadece bir kere kullanƒ±labilir")))))},e={container:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#1e1f22",padding:"20px"},card:{backgroundColor:"#2b2d31",borderRadius:"12px",padding:"40px",maxWidth:"500px",width:"100%",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.5)",position:"relative"},backButton:{position:"absolute",top:"20px",left:"20px",background:"none",border:"none",color:"#b9bbbe",cursor:"pointer",fontSize:"16px",display:"flex",alignItems:"center",gap:"8px",transition:"color 0.2s"},icon:{fontSize:"64px",color:"#5865f2",display:"block",margin:"0 auto 20px"},title:{color:"#fff",fontSize:"28px",textAlign:"center",margin:"0 0 10px 0"},subtitle:{color:"#b9bbbe",fontSize:"16px",textAlign:"center",marginBottom:"30px"},form:{display:"flex",flexDirection:"column",gap:"15px"},codeInput:{backgroundColor:"#1e1f22",border:"2px solid #5865f2",borderRadius:"6px",padding:"16px",color:"#fff",fontSize:"32px",textAlign:"center",letterSpacing:"8px",fontFamily:"monospace",outline:"none"},backupInput:{backgroundColor:"#1e1f22",border:"1px solid #1e1f22",borderRadius:"6px",padding:"12px",color:"#fff",fontSize:"16px",textAlign:"center",fontFamily:"monospace",outline:"none"},backupLink:{background:"none",border:"none",color:"#5865f2",cursor:"pointer",fontSize:"14px",textAlign:"center",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},error:{backgroundColor:"#da373c",color:"#fff",padding:"12px",borderRadius:"6px",fontSize:"14px",textAlign:"center"},submitButton:{backgroundColor:"#5865f2",color:"#fff",border:"none",borderRadius:"6px",padding:"12px",fontSize:"16px",fontWeight:"bold",cursor:"pointer",transition:"background-color 0.2s"},info:{backgroundColor:"#1e1f22",borderRadius:"8px",padding:"15px",marginTop:"20px"},infoTitle:{color:"#fff",fontSize:"14px",fontWeight:"bold",margin:"0 0 10px 0"},infoList:{color:"#b9bbbe",fontSize:"14px",margin:0,paddingLeft:"20px"}};export{B as default};
