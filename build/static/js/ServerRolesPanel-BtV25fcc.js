import{r as s,b as e}from"./react-core-9vc7GIjk.js";import{a6 as k,a as P,_ as F,aN as N,bj as O,m as T}from"./icons-vendor-C1zuqBwn.js";import{t as n}from"./index-C1-LpR7z.js";import"./editor-vendor-DiU449Dh.js";import"./media-vendor-B-uSUaIv.js";import"./router-vendor-u6fxj6P4.js";import"./crypto-vendor-C1qXRpJv.js";import"./state-vendor-0vlBuk0v.js";const W=({fetchWithAuth:c,apiBaseUrl:p,serverId:y,onClose:b})=>{const[d,E]=s.useState([]),[S,h]=s.useState(!0),[R,m]=s.useState(!1),[a,u]=s.useState({name:"",color:"#5865f2",permissions:[]}),[i,v]=s.useState(null);s.useEffect(()=>{g()},[]);const g=async()=>{try{h(!0);const t=await c(`${p}/servers/${y}/roles/list/`);if(t.ok){const r=await t.json();E(r.sort((l,x)=>(x.position||0)-(l.position||0)))}}catch(t){console.error("Rol yÃ¼kleme hatasÄ±:",t),n.error("Roller yÃ¼klenemedi")}finally{h(!1)}},C=async()=>{if(!a.name.trim()){n.error("Rol adÄ± gerekli");return}try{(await c(`${p}/servers/${y}/roles/create/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).ok?(n.success("Rol oluÅŸturuldu"),u({name:"",color:"#5865f2",permissions:[]}),m(!1),g()):n.error("Rol oluÅŸturulamadÄ±")}catch(t){console.error("Rol oluÅŸturma hatasÄ±:",t),n.error("Bir hata oluÅŸtu")}},w=async t=>{if(confirm("Bu rolÃ¼ silmek istediÄŸinize emin misiniz?"))try{(await c(`${p}/roles/${t}/delete/`,{method:"DELETE"})).ok?(n.success("Rol silindi"),g()):n.error("Rol silinemedi")}catch(r){console.error("Rol silme hatasÄ±:",r),n.error("Bir hata oluÅŸtu")}},B=t=>{v(t)},z=(t,r)=>{if(t.preventDefault(),!i||i.id===r.id)return;const l=[...d],x=l.findIndex(f=>f.id===i.id),D=l.findIndex(f=>f.id===r.id);l.splice(x,1),l.splice(D,0,i),E(l)},I=async()=>{if(i){try{(await c(`${p}/roles/reorder/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({roles:d.map((r,l)=>({id:r.id,position:d.length-l}))})})).ok&&n.success("Rol sÄ±ralamasÄ± gÃ¼ncellendi")}catch(t){console.error("SÄ±ralama hatasÄ±:",t),n.error("Bir hata oluÅŸtu")}v(null)}};return e.createElement("div",{style:o.overlay,onClick:b},e.createElement("div",{style:o.modal,onClick:t=>t.stopPropagation()},e.createElement("div",{style:o.header},e.createElement("div",{style:{display:"flex",alignItems:"center",gap:"10px"}},e.createElement(k,{style:{color:"#5865f2"}}),e.createElement("h2",{style:{margin:0}},"Sunucu Rolleri")),e.createElement(P,{onClick:b,style:o.closeBtn})),e.createElement("div",{style:o.toolbar},e.createElement("button",{onClick:()=>m(!R),style:o.newRoleBtn},e.createElement(F,null)," Yeni Rol"),e.createElement("p",{style:{fontSize:"12px",color:"#888",margin:"10px 0 0 0"}},"ðŸ’¡ Rolleri sÃ¼rÃ¼kleyerek hiyerarÅŸiyi deÄŸiÅŸtirebilirsiniz")),R&&e.createElement("div",{style:o.newRoleForm},e.createElement("input",{type:"text",placeholder:"Rol adÄ±...",value:a.name,onChange:t=>u({...a,name:t.target.value}),style:o.input}),e.createElement("div",{style:{display:"flex",gap:"10px",alignItems:"center",marginBottom:"15px"}},e.createElement(N,{style:{color:"#888"}}),e.createElement("input",{type:"color",value:a.color,onChange:t=>u({...a,color:t.target.value}),style:o.colorPicker}),e.createElement("span",{style:{color:"#dcddde",fontSize:"14px"}},a.color)),e.createElement("div",{style:{display:"flex",gap:"10px"}},e.createElement("button",{onClick:C,style:o.saveBtn},"OluÅŸtur"),e.createElement("button",{onClick:()=>m(!1),style:o.cancelBtn},"Ä°ptal"))),e.createElement("div",{style:o.rolesList},S?e.createElement("div",{style:o.loading},"YÃ¼kleniyor..."):d.length===0?e.createElement("div",{style:o.empty},e.createElement(k,{style:{fontSize:"48px",color:"#555"}}),e.createElement("p",null,"HenÃ¼z rol yok")):d.map((t,r)=>e.createElement("div",{key:t.id,draggable:!0,onDragStart:()=>B(t),onDragOver:l=>z(l,t),onDragEnd:I,style:{...o.roleItem,opacity:i?.id===t.id?.5:1}},e.createElement("div",{style:o.dragHandle},e.createElement(O,{style:{color:"#888"}})),e.createElement("div",{style:{...o.roleColor,backgroundColor:t.color||"#5865f2"}}),e.createElement("div",{style:o.roleContent},e.createElement("div",{style:o.roleName},t.name),e.createElement("div",{style:o.roleMeta},"Pozisyon: ",r+1," â€¢ ",t.member_count||0," Ã¼ye")),!t.is_default&&e.createElement("button",{onClick:()=>w(t.id),style:o.deleteBtn,title:"Sil"},e.createElement(T,null)))))))},o={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999},modal:{backgroundColor:"#1e1e1e",borderRadius:"8px",width:"90%",maxWidth:"600px",maxHeight:"90vh",display:"flex",flexDirection:"column",color:"#fff"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #333"},closeBtn:{cursor:"pointer",fontSize:"24px",color:"#888"},toolbar:{padding:"15px 20px",borderBottom:"1px solid #333"},newRoleBtn:{backgroundColor:"#5865f2",color:"#fff",border:"none",padding:"10px 20px",borderRadius:"4px",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",fontSize:"14px",fontWeight:"500"},newRoleForm:{padding:"20px",backgroundColor:"#2c2f33",borderBottom:"1px solid #333"},input:{width:"100%",padding:"10px",backgroundColor:"#1e1e1e",border:"1px solid #444",borderRadius:"4px",color:"#fff",fontSize:"14px",marginBottom:"15px"},colorPicker:{width:"60px",height:"40px",border:"none",borderRadius:"4px",cursor:"pointer"},saveBtn:{flex:1,backgroundColor:"#43b581",color:"#fff",border:"none",padding:"10px",borderRadius:"4px",cursor:"pointer",fontSize:"14px",fontWeight:"500"},cancelBtn:{flex:1,backgroundColor:"#4e5058",color:"#fff",border:"none",padding:"10px",borderRadius:"4px",cursor:"pointer",fontSize:"14px",fontWeight:"500"},rolesList:{flex:1,overflowY:"auto",padding:"20px"},roleItem:{display:"flex",gap:"15px",padding:"12px",backgroundColor:"#2c2f33",borderRadius:"8px",marginBottom:"8px",alignItems:"center",cursor:"move",transition:"opacity 0.2s"},dragHandle:{cursor:"grab",padding:"5px"},roleColor:{width:"4px",height:"40px",borderRadius:"2px"},roleContent:{flex:1},roleName:{fontWeight:"600",marginBottom:"4px"},roleMeta:{fontSize:"12px",color:"#888"},deleteBtn:{backgroundColor:"transparent",border:"none",color:"#ed4245",cursor:"pointer",fontSize:"18px",padding:"8px"},loading:{textAlign:"center",padding:"40px",color:"#888"},empty:{textAlign:"center",padding:"60px 20px",color:"#888"}};export{W as default};
