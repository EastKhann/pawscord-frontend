import{r as s,n as e}from"./react-core-Cj7FUMmY.js";import{t as l}from"./index-7m1MRR8f.js";import"./editor-vendor-D9c4a6XZ.js";import"./media-vendor-BsD1gqUZ.js";import"./router-vendor-QeioVw-9.js";import"./icons-vendor-TGltgKsJ.js";import"./state-vendor-DGcbxrkI.js";import"./crypto-vendor-DK-7ILyQ.js";function $({inviteCode:a,fetchWithAuth:x,onClose:c,apiBaseUrl:p}){const[b,f]=s.useState(!0),[m,y]=s.useState(null),[i,v]=s.useState(null),[u,h]=s.useState(!1);s.useEffect(()=>{j()},[a]);const j=async()=>{try{f(!0),y(null);const t=await fetch(`${p}/invites/${a}/`);if(!t.ok){const r=await t.json().catch(()=>({}));throw new Error(r.error||"Davet bulunamadƒ± veya s√ºresi dolmu≈ü")}if(!(t.headers.get("content-type")||"").includes("application/json"))throw new Error("Davet bulunamadƒ±");const d=await t.json();v(d)}catch(t){y(t.message)}finally{f(!1)}},S=async()=>{if(i){if(!x){l.warning("üîê Sunucuya katƒ±lmak i√ßin giri≈ü yapmalƒ±sƒ±nƒ±z!"),sessionStorage.setItem("pending_invite",a),window.location.hash="#/";return}try{h(!0);const g=i?.type==="vanity"?`${p}/servers/${i.server.id}/join/`:`${p}/invites/${a}/accept/`,d=await x(g,{method:"POST"}),r=await d.json().catch(()=>({}));if(d.ok||r.success)l.success(`‚úÖ ${r.server_name||r.message||"Sunucuya katƒ±ldƒ±nƒ±z!"}`),c();else if(r.error&&r.error.includes("zaten"))l.info("‚ÑπÔ∏è Zaten bu sunucudasƒ±nƒ±z!"),c();else throw new Error(r.error||"Sunucuya katƒ±lƒ±namadƒ±")}catch(t){l.error("‚ùå "+t.message)}finally{h(!1)}}};if(b)return e.jsx("div",{style:n.container,children:e.jsxs("div",{style:n.card,children:[e.jsx("div",{style:n.loadingSpinner}),e.jsx("p",{style:n.loadingText,children:"Davet bilgileri y√ºkleniyor..."})]})});if(m)return e.jsx("div",{style:n.container,children:e.jsxs("div",{style:n.card,children:[e.jsx("div",{style:n.errorIcon,children:"‚ùå"}),e.jsx("h2",{style:n.errorTitle,children:"Davet Bulunamadƒ±"}),e.jsx("p",{style:n.errorText,children:m}),e.jsx("button",{onClick:c,style:n.closeButton,children:"Ana Sayfaya D√∂n"})]})});const o=i?.server;return e.jsx("div",{style:n.container,children:e.jsxs("div",{style:n.card,children:[e.jsx("div",{style:n.serverIconContainer,children:o?.icon?e.jsx("img",{src:o.icon,alt:o?.name,style:n.serverIcon}):e.jsx("div",{style:n.serverIconPlaceholder,children:o?.name?.charAt(0)?.toUpperCase()||"?"})}),e.jsxs("p",{style:n.invitedBy,children:[i?.inviter?.username||"Birisi"," seni davet ediyor:"]}),e.jsx("h2",{style:n.serverName,children:o?.name||"Bilinmeyen Sunucu"}),e.jsx("div",{style:n.memberInfo,children:e.jsxs("span",{style:n.memberCount,children:["üë• ",o?.member_count||0," √ºye"]})}),e.jsx("button",{onClick:S,disabled:u,style:{...n.joinButton,opacity:u?.7:1},children:u?"‚è≥ Katƒ±lƒ±nƒ±yor...":"‚úÖ Sunucuya Katƒ±l"}),e.jsx("button",{onClick:c,style:n.backButton,children:"‚Üê Geri D√∂n"})]})})}const n={container:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",background:"linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%)",padding:"20px"},card:{background:"#2b2d31",borderRadius:"16px",padding:"40px",maxWidth:"440px",width:"100%",textAlign:"center",boxShadow:"0 8px 32px rgba(0,0,0,0.4)"},serverIconContainer:{display:"flex",justifyContent:"center",marginBottom:"20px"},serverIcon:{width:"80px",height:"80px",borderRadius:"50%",objectFit:"cover",border:"3px solid #5865f2"},serverIconPlaceholder:{width:"80px",height:"80px",borderRadius:"50%",background:"#5865f2",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"36px",fontWeight:"bold",color:"#fff"},invitedBy:{color:"#b5bac1",fontSize:"14px",marginBottom:"8px"},serverName:{color:"#fff",fontSize:"24px",fontWeight:"bold",marginBottom:"12px"},memberInfo:{marginBottom:"24px"},memberCount:{color:"#b5bac1",fontSize:"14px"},joinButton:{width:"100%",padding:"14px",background:"#5865f2",color:"#fff",border:"none",borderRadius:"8px",fontSize:"16px",fontWeight:"600",cursor:"pointer",transition:"background 0.2s",marginBottom:"12px"},backButton:{width:"100%",padding:"10px",background:"transparent",color:"#b5bac1",border:"1px solid #4e5058",borderRadius:"8px",fontSize:"14px",cursor:"pointer"},loadingSpinner:{width:"40px",height:"40px",border:"3px solid #4e5058",borderTop:"3px solid #5865f2",borderRadius:"50%",animation:"spin 1s linear infinite",margin:"0 auto 16px"},loadingText:{color:"#b5bac1",fontSize:"16px"},errorIcon:{fontSize:"48px",marginBottom:"16px"},errorTitle:{color:"#fff",fontSize:"20px",marginBottom:"8px"},errorText:{color:"#b5bac1",fontSize:"14px",marginBottom:"20px"},closeButton:{padding:"12px 24px",background:"#4e5058",color:"#fff",border:"none",borderRadius:"8px",fontSize:"14px",cursor:"pointer"}};export{$ as default};
