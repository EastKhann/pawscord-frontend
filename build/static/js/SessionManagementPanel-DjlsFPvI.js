import{r as l,cy as d,l as g,cz as v,Y as b,v as R,bC as E,bB as S}from"./react-core-B6hadH-M.js";import{t as o}from"./index-D_6pZib5.js";const C=({fetchWithAuth:a,apiBaseUrl:r,onClose:p})=>{const[n,f]=l.useState([]),[m,c]=l.useState(!1);l.useEffect(()=>{i()},[]);const i=async()=>{c(!0);try{const s=await(await a(`${r}/sessions/list/`)).json();f(s.sessions||[])}catch{o.error("Failed to load sessions")}finally{c(!1)}},x=async t=>{if(confirm("Are you sure you want to sign out this device?"))try{await a(`${r}/sessions/revoke/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_id:t})}),o.success("Session revoked successfully"),i()}catch{o.error("Failed to revoke session")}},u=async()=>{if(confirm("This will sign you out from ALL devices except this one. Continue?"))try{await a(`${r}/security/sessions/revoke-all/`,{method:"POST"}),o.success("All other sessions revoked"),i()}catch{o.error("Failed to revoke sessions")}},y=t=>{switch(t){case"mobile":return React.createElement(S,{style:{fontSize:"24px",color:"#5865f2"}});case"tablet":return React.createElement(E,{style:{fontSize:"24px",color:"#5865f2"}});default:return React.createElement(d,{style:{fontSize:"24px",color:"#5865f2"}})}};return React.createElement("div",{style:e.overlay},React.createElement("div",{style:e.modal},React.createElement("div",{style:e.header},React.createElement("div",{style:e.headerLeft},React.createElement(d,{style:{marginRight:"10px",color:"#5865f2"}}),React.createElement("h2",{style:e.title},"Active Sessions")),React.createElement("button",{onClick:p,style:e.closeButton},React.createElement(g,null))),React.createElement("div",{style:e.toolbar},React.createElement("div",{style:e.sessionCount},n.length," active ",n.length===1?"session":"sessions"),React.createElement("button",{onClick:u,style:e.revokeAllButton},"Sign Out All Other Devices")),React.createElement("div",{style:e.content},m?React.createElement("div",{style:e.loading},"Loading sessions..."):n.length===0?React.createElement("div",{style:e.empty},"No active sessions found"):React.createElement("div",{style:e.sessionsList},n.map((t,s)=>React.createElement("div",{key:s,style:{...e.sessionCard,...t.is_current&&e.currentSession}},React.createElement("div",{style:e.sessionIcon},y(t.device_type)),React.createElement("div",{style:e.sessionInfo},React.createElement("div",{style:e.sessionDevice},t.device_name||"Unknown Device",t.is_current&&React.createElement("span",{style:e.currentBadge},"Current Session")),React.createElement("div",{style:e.sessionDetails},React.createElement("div",{style:e.detailItem},React.createElement(v,{style:{marginRight:"5px",fontSize:"12px"}}),t.location||"Unknown Location"),React.createElement("div",{style:e.detailItem},React.createElement(b,{style:{marginRight:"5px",fontSize:"12px"}}),"Last active: ",new Date(t.last_activity).toLocaleString()),t.ip_address&&React.createElement("div",{style:e.detailItem},"IP: ",t.ip_address))),!t.is_current&&React.createElement("button",{onClick:()=>x(t.id),style:e.revokeButton,title:"Sign Out"},React.createElement(R,null))))))))},e={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999},modal:{backgroundColor:"#1e1e1e",borderRadius:"8px",width:"90%",maxWidth:"700px",maxHeight:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #2c2f33"},headerLeft:{display:"flex",alignItems:"center"},title:{margin:0,fontSize:"20px",color:"#ffffff"},closeButton:{background:"none",border:"none",color:"#99aab5",cursor:"pointer",fontSize:"20px",padding:"5px"},toolbar:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"15px 20px",borderBottom:"1px solid #2c2f33"},sessionCount:{fontSize:"14px",color:"#dcddde"},revokeAllButton:{padding:"8px 16px",backgroundColor:"#f04747",border:"none",borderRadius:"4px",color:"#ffffff",cursor:"pointer",fontSize:"13px",fontWeight:"500"},content:{padding:"20px",overflowY:"auto",flex:1},loading:{textAlign:"center",color:"#99aab5",padding:"40px"},empty:{textAlign:"center",color:"#99aab5",padding:"40px"},sessionsList:{display:"flex",flexDirection:"column",gap:"16px"},sessionCard:{backgroundColor:"#2c2f33",borderRadius:"8px",padding:"16px",display:"flex",gap:"16px",alignItems:"flex-start"},currentSession:{border:"2px solid #43b581"},sessionIcon:{minWidth:"40px",display:"flex",alignItems:"center",justifyContent:"center"},sessionInfo:{flex:1},sessionDevice:{fontSize:"16px",fontWeight:"600",color:"#ffffff",marginBottom:"8px",display:"flex",alignItems:"center",gap:"12px"},currentBadge:{fontSize:"11px",padding:"4px 8px",backgroundColor:"#43b581",borderRadius:"4px",fontWeight:"600"},sessionDetails:{display:"flex",flexDirection:"column",gap:"4px"},detailItem:{fontSize:"13px",color:"#99aab5",display:"flex",alignItems:"center"},revokeButton:{background:"none",border:"none",color:"#f04747",cursor:"pointer",fontSize:"18px",padding:"8px"}};export{C as default};
