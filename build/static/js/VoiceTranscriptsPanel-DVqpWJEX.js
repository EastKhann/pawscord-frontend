var L=Object.defineProperty;var s=(c,p)=>L(c,"name",{value:p,configurable:!0});import{r as l,j as e}from"./react-core-Djgtqrmb.js";import{E as m,a as R,t as B,a5 as T,av as z}from"./icons-vendor-BW7dxHkX.js";import{t as h}from"./index-GGLPABCW.js";import"./media-vendor-CxFPycob.js";import"./router-vendor-ClgLnMjk.js";import"./state-vendor-BRqaXHJQ.js";import"./crypto-vendor-D1XRGppi.js";import"./ui-vendor-IhB9Znpc.js";const O=s(({fetchWithAuth:c,apiBaseUrl:p,onClose:y,roomSlug:b})=>{const[x,j]=l.useState([]),[v,g]=l.useState(!1),[i,w]=l.useState(""),[f,u]=l.useState([]);l.useEffect(()=>{C()},[]),l.useEffect(()=>{if(i){const t=x.filter(r=>r.text.toLowerCase().includes(i.toLowerCase())||r.speaker_username.toLowerCase().includes(i.toLowerCase()));u(t)}else u(x)},[i,x]);const C=s(async()=>{g(!0);try{const r=await(await c(`${p}/voice/transcripts/?room_slug=${b}`)).json();j(r.transcripts||[]),u(r.transcripts||[])}catch{h.error("Failed to load transcripts")}finally{g(!1)}},"fetchTranscripts"),k=s(t=>{const r=`Voice Transcript
Speaker: ${t.speaker_username}
Date: ${new Date(t.created_at).toLocaleString()}
Confidence: ${(t.confidence*100).toFixed(1)}%

${t.text}
`,d=new Blob([r],{type:"text/plain"}),a=window.URL.createObjectURL(d),n=document.createElement("a");n.href=a,n.download=`transcript_${t.id}.txt`,document.body.appendChild(n),n.click(),window.URL.revokeObjectURL(a),document.body.removeChild(n)},"downloadTranscript"),S=s(()=>{const t=[["Speaker","Date","Text","Confidence"],...f.map(n=>[n.speaker_username,new Date(n.created_at).toLocaleString(),`"${n.text.replace(/"/g,'""')}"`,`${(n.confidence*100).toFixed(1)}%`])].map(n=>n.join(",")).join(`
`),r=new Blob([t],{type:"text/csv"}),d=window.URL.createObjectURL(r),a=document.createElement("a");a.href=d,a.download=`voice_transcripts_${Date.now()}.csv`,document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(d),document.body.removeChild(a),h.success("Transcripts exported")},"exportAll");return e.jsx("div",{style:o.overlay,children:e.jsxs("div",{style:o.modal,children:[e.jsxs("div",{style:o.header,children:[e.jsxs("div",{style:o.headerLeft,children:[e.jsx(m,{style:{marginRight:"10px",color:"#5865f2"}}),e.jsx("h2",{style:o.title,children:"Voice Transcripts"})]}),e.jsx("button",{onClick:y,style:o.closeButton,children:e.jsx(R,{})})]}),e.jsxs("div",{style:o.toolbar,children:[e.jsxs("div",{style:o.searchBox,children:[e.jsx(B,{style:{color:"#99aab5",marginRight:"8px"}}),e.jsx("input",{type:"text",value:i,onChange:s(t=>w(t.target.value),"onChange"),placeholder:"Search transcripts...",style:o.searchInput})]}),e.jsxs("button",{onClick:S,style:o.exportButton,children:[e.jsx(T,{style:{marginRight:"6px"}}),"Export All"]})]}),e.jsx("div",{style:o.content,children:v?e.jsx("div",{style:o.loading,children:"Loading transcripts..."}):f.length===0?e.jsx("div",{style:o.empty,children:i?"No transcripts match your search":"No voice transcripts yet"}):e.jsx("div",{style:o.transcriptsList,children:f.map((t,r)=>e.jsxs("div",{style:o.transcriptCard,children:[e.jsxs("div",{style:o.transcriptHeader,children:[e.jsxs("div",{style:o.speaker,children:[e.jsx(m,{style:{marginRight:"8px",color:"#5865f2",fontSize:"14px"}}),t.speaker_username]}),e.jsxs("div",{style:o.metadata,children:[e.jsx("span",{style:o.date,children:new Date(t.created_at).toLocaleString()}),e.jsxs("span",{style:{...o.confidence,color:t.confidence>=.8?"#43b581":t.confidence>=.6?"#faa61a":"#f04747"},children:[(t.confidence*100).toFixed(1),"% confidence"]})]})]}),e.jsx("div",{style:o.transcriptText,children:t.text}),t.duration&&e.jsxs("div",{style:o.duration,children:["Duration: ",t.duration,"s"]}),e.jsxs("button",{onClick:s(()=>k(t),"onClick"),style:o.downloadButton,children:[e.jsx(z,{style:{marginRight:"6px"}}),"Download"]})]},r))})})]})})},"VoiceTranscriptsPanel"),o={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999},modal:{backgroundColor:"#1e1e1e",borderRadius:"8px",width:"90%",maxWidth:"900px",maxHeight:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #2c2f33"},headerLeft:{display:"flex",alignItems:"center"},title:{margin:0,fontSize:"20px",color:"#ffffff"},closeButton:{background:"none",border:"none",color:"#99aab5",cursor:"pointer",fontSize:"20px",padding:"5px"},toolbar:{display:"flex",gap:"12px",padding:"15px 20px",borderBottom:"1px solid #2c2f33"},searchBox:{flex:1,display:"flex",alignItems:"center",backgroundColor:"#2c2f33",borderRadius:"4px",padding:"8px 12px"},searchInput:{flex:1,background:"none",border:"none",color:"#ffffff",fontSize:"14px",outline:"none"},exportButton:{padding:"8px 16px",backgroundColor:"#5865f2",border:"none",borderRadius:"4px",color:"#ffffff",cursor:"pointer",fontSize:"13px",display:"flex",alignItems:"center"},content:{padding:"20px",overflowY:"auto",flex:1},loading:{textAlign:"center",color:"#99aab5",padding:"40px"},empty:{textAlign:"center",color:"#99aab5",padding:"40px"},transcriptsList:{display:"flex",flexDirection:"column",gap:"16px"},transcriptCard:{backgroundColor:"#2c2f33",borderRadius:"8px",padding:"16px"},transcriptHeader:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"12px"},speaker:{fontSize:"14px",fontWeight:"600",color:"#ffffff",display:"flex",alignItems:"center"},metadata:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"4px"},date:{fontSize:"12px",color:"#99aab5"},confidence:{fontSize:"12px",fontWeight:"500"},transcriptText:{fontSize:"14px",color:"#dcddde",lineHeight:"1.6",marginBottom:"12px",padding:"12px",backgroundColor:"#1e1e1e",borderRadius:"4px"},duration:{fontSize:"12px",color:"#99aab5",marginBottom:"12px"},downloadButton:{padding:"6px 12px",backgroundColor:"#5865f2",border:"none",borderRadius:"4px",color:"#ffffff",cursor:"pointer",fontSize:"12px",display:"inline-flex",alignItems:"center"}};export{O as default};
