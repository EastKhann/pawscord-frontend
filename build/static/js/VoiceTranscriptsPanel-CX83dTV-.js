import{r as i,b as e}from"./react-core-9vc7GIjk.js";import{o as x,a as S,b as L,aa as R,Y as B}from"./icons-vendor-BHKL7tCa.js";import{t as m}from"./index-DV60LZzJ.js";import"./editor-vendor-DiU449Dh.js";import"./media-vendor-B-uSUaIv.js";import"./router-vendor-qCr-Mpaw.js";import"./crypto-vendor-C1qXRpJv.js";import"./state-vendor-0vlBuk0v.js";const U=({fetchWithAuth:u,apiBaseUrl:g,onClose:y,roomSlug:b})=>{const[s,h]=i.useState([]),[E,f]=i.useState(!1),[l,v]=i.useState(""),[d,p]=i.useState([]);i.useEffect(()=>{w()},[]),i.useEffect(()=>{if(l){const t=s.filter(n=>n.text.toLowerCase().includes(l.toLowerCase())||n.speaker_username.toLowerCase().includes(l.toLowerCase()));p(t)}else p(s)},[l,s]);const w=async()=>{f(!0);try{const n=await(await u(`${g}/api/voice/transcripts/?room_slug=${b}`)).json();h(n.transcripts||[]),p(n.transcripts||[])}catch{m.error("Failed to load transcripts")}finally{f(!1)}},C=t=>{const n=`Voice Transcript
Speaker: ${t.speaker_username}
Date: ${new Date(t.created_at).toLocaleString()}
Confidence: ${(t.confidence*100).toFixed(1)}%

${t.text}
`,c=new Blob([n],{type:"text/plain"}),r=window.URL.createObjectURL(c),a=document.createElement("a");a.href=r,a.download=`transcript_${t.id}.txt`,document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(r),document.body.removeChild(a)},k=()=>{const t=[["Speaker","Date","Text","Confidence"],...d.map(a=>[a.speaker_username,new Date(a.created_at).toLocaleString(),`"${a.text.replace(/"/g,'""')}"`,`${(a.confidence*100).toFixed(1)}%`])].map(a=>a.join(",")).join(`
`),n=new Blob([t],{type:"text/csv"}),c=window.URL.createObjectURL(n),r=document.createElement("a");r.href=c,r.download=`voice_transcripts_${Date.now()}.csv`,document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(c),document.body.removeChild(r),m.success("Transcripts exported")};return e.createElement("div",{style:o.overlay},e.createElement("div",{style:o.modal},e.createElement("div",{style:o.header},e.createElement("div",{style:o.headerLeft},e.createElement(x,{style:{marginRight:"10px",color:"#5865f2"}}),e.createElement("h2",{style:o.title},"Voice Transcripts")),e.createElement("button",{onClick:y,style:o.closeButton},e.createElement(S,null))),e.createElement("div",{style:o.toolbar},e.createElement("div",{style:o.searchBox},e.createElement(L,{style:{color:"#99aab5",marginRight:"8px"}}),e.createElement("input",{type:"text",value:l,onChange:t=>v(t.target.value),placeholder:"Search transcripts...",style:o.searchInput})),e.createElement("button",{onClick:k,style:o.exportButton},e.createElement(R,{style:{marginRight:"6px"}}),"Export All")),e.createElement("div",{style:o.content},E?e.createElement("div",{style:o.loading},"Loading transcripts..."):d.length===0?e.createElement("div",{style:o.empty},l?"No transcripts match your search":"No voice transcripts yet"):e.createElement("div",{style:o.transcriptsList},d.map((t,n)=>e.createElement("div",{key:n,style:o.transcriptCard},e.createElement("div",{style:o.transcriptHeader},e.createElement("div",{style:o.speaker},e.createElement(x,{style:{marginRight:"8px",color:"#5865f2",fontSize:"14px"}}),t.speaker_username),e.createElement("div",{style:o.metadata},e.createElement("span",{style:o.date},new Date(t.created_at).toLocaleString()),e.createElement("span",{style:{...o.confidence,color:t.confidence>=.8?"#43b581":t.confidence>=.6?"#faa61a":"#f04747"}},(t.confidence*100).toFixed(1),"% confidence"))),e.createElement("div",{style:o.transcriptText},t.text),t.duration&&e.createElement("div",{style:o.duration},"Duration: ",t.duration,"s"),e.createElement("button",{onClick:()=>C(t),style:o.downloadButton},e.createElement(B,{style:{marginRight:"6px"}}),"Download")))))))},o={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999},modal:{backgroundColor:"#1e1e1e",borderRadius:"8px",width:"90%",maxWidth:"900px",maxHeight:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #2c2f33"},headerLeft:{display:"flex",alignItems:"center"},title:{margin:0,fontSize:"20px",color:"#ffffff"},closeButton:{background:"none",border:"none",color:"#99aab5",cursor:"pointer",fontSize:"20px",padding:"5px"},toolbar:{display:"flex",gap:"12px",padding:"15px 20px",borderBottom:"1px solid #2c2f33"},searchBox:{flex:1,display:"flex",alignItems:"center",backgroundColor:"#2c2f33",borderRadius:"4px",padding:"8px 12px"},searchInput:{flex:1,background:"none",border:"none",color:"#ffffff",fontSize:"14px",outline:"none"},exportButton:{padding:"8px 16px",backgroundColor:"#5865f2",border:"none",borderRadius:"4px",color:"#ffffff",cursor:"pointer",fontSize:"13px",display:"flex",alignItems:"center"},content:{padding:"20px",overflowY:"auto",flex:1},loading:{textAlign:"center",color:"#99aab5",padding:"40px"},empty:{textAlign:"center",color:"#99aab5",padding:"40px"},transcriptsList:{display:"flex",flexDirection:"column",gap:"16px"},transcriptCard:{backgroundColor:"#2c2f33",borderRadius:"8px",padding:"16px"},transcriptHeader:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"12px"},speaker:{fontSize:"14px",fontWeight:"600",color:"#ffffff",display:"flex",alignItems:"center"},metadata:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"4px"},date:{fontSize:"12px",color:"#99aab5"},confidence:{fontSize:"12px",fontWeight:"500"},transcriptText:{fontSize:"14px",color:"#dcddde",lineHeight:"1.6",marginBottom:"12px",padding:"12px",backgroundColor:"#1e1e1e",borderRadius:"4px"},duration:{fontSize:"12px",color:"#99aab5",marginBottom:"12px"},downloadButton:{padding:"6px 12px",backgroundColor:"#5865f2",border:"none",borderRadius:"4px",color:"#ffffff",cursor:"pointer",fontSize:"12px",display:"inline-flex",alignItems:"center"}};export{U as default};
