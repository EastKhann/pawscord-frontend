import{r as c,d as e,aS as W,af as H,aT as Y,ae as _,aR as G,aU as U,aV as V,K as q,aK as $,U as J,e as Z}from"./react-core-DrOm_csO.js";import{t as b}from"./index-DmEhdEtw.js";import X from"./SessionManagerModal-rvk1zm3V.js";import D from"./UserNotesModal-k-ggb4sS.js";const Q=({achievement:a,size:l="medium"})=>{const m={trophy:_,medal:Y,star:H,crown:W}[a.icon_type]||_,x={small:{width:"30px",height:"30px",fontSize:"14px"},medium:{width:"50px",height:"50px",fontSize:"24px"},large:{width:"70px",height:"70px",fontSize:"32px"}};return e.createElement("div",{style:{...x[l],backgroundColor:a.color||"#5865f2",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",color:"white",boxShadow:"0 2px 8px rgba(0,0,0,0.3)",position:"relative",cursor:"pointer"},title:`${a.name}: ${a.description}`},e.createElement(m,null),a.is_new&&e.createElement("span",{style:{position:"absolute",top:"-5px",right:"-5px",width:"12px",height:"12px",backgroundColor:"#f04747",borderRadius:"50%",border:"2px solid #2b2d31"}}))},ee=({username:a,fetchWithAuth:l,apiBaseUrl:h})=>{const[m,x]=c.useState([]),[i,s]=c.useState([]),[E,f]=c.useState(!0);c.useEffect(()=>{d()},[a]);const d=async()=>{try{const[o,k]=await Promise.all([l(`${h}/api/user/achievements/`),l(`${h}/api/user/badges/`)]);if(o.ok){const y=await o.json();x(y.achievements||[])}if(k.ok){const y=await k.json();s(y.badges||[])}}catch(o){console.error("Achievement load error:",o)}finally{f(!1)}};return E?e.createElement("div",{style:{color:"#949ba4",fontSize:"0.9em"}},"YÃ¼kleniyor..."):m.length===0&&i.length===0?e.createElement("div",{style:{color:"#949ba4",fontSize:"0.9em"}},"HenÃ¼z baÅŸarÄ± kazanÄ±lmadÄ±"):e.createElement("div",{style:{marginTop:"15px"}},m.length>0&&e.createElement("div",{style:{marginBottom:"15px"}},e.createElement("h4",{style:{color:"#949ba4",fontSize:"0.85em",marginBottom:"10px",textTransform:"uppercase"}},"ðŸ† BaÅŸarÄ±lar (",m.length,")"),e.createElement("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"}},m.slice(0,10).map(o=>e.createElement(Q,{key:o.id,achievement:o,size:"medium"})))),i.length>0&&e.createElement("div",null,e.createElement("h4",{style:{color:"#949ba4",fontSize:"0.85em",marginBottom:"10px",textTransform:"uppercase"}},"ðŸŽ–ï¸ Rozetler (",i.length,")"),e.createElement("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"}},i.map(o=>e.createElement("div",{key:o.id,style:{padding:"5px 12px",backgroundColor:o.color||"#5865f2",borderRadius:"12px",color:"white",fontSize:"0.8em",fontWeight:"bold",display:"flex",alignItems:"center",gap:"5px"},title:o.description},o.emoji&&e.createElement("span",null,o.emoji),o.name)))))},te=a=>a.includes("steam")?"fab fa-steam":a.includes("x")?"fab fa-twitter":a.includes("instagram")?"fab fa-instagram":"fa fa-link",ae=(a,l)=>!a||a.trim()===""?"#":a.startsWith("http://")||a.startsWith("https://")?a:l==="x"?`https://x.com/${a.replace("@","")}`:l==="instagram"?`https://instagram.com/${a.replace("@","")}`:`https://${a}`,le=({user:a,onClose:l,onStartDM:h,onImageClick:m,getDeterministicAvatar:x,fetchWithAuth:i,apiBaseUrl:s,currentUser:E,friendsList:f})=>{const[d,o]=c.useState("idle"),[k,y]=c.useState(!1),[F,w]=c.useState(!1),[u,C]=c.useState("profile"),[T,z]=c.useState([]);if(c.useEffect(()=>{u==="activity"&&a.username&&(async()=>{try{const n=await i(`${s}/presence/${a.username}/`);if(n.ok){const p=await n.json();z(p.presence||[])}}catch(n){console.error("Failed to fetch presence history:",n),z([])}})()},[u,a.username,i,s]),!a)return null;const B=f&&Array.isArray(f)&&f.some(t=>typeof t=="string"?t===a.username:t.username===a.username||t.sender_username===a.username||t.receiver_username===a.username),g=a.username===E;console.log("ðŸ” [ProfileModal Debug]:",{username:a.username,currentUser:E,isFriend:B,isSelf:g,friendsListLength:f?.length,friendsList:f?.slice(0,3)});const L=async()=>{o("loading");try{(await i(`${s}/friends/send/`,{method:"POST",body:JSON.stringify({username:a.username})})).ok?o("success"):(b.error("âŒ Ä°stek gÃ¶nderilemedi. Zaten ekli veya bekliyor olabilir."),o("idle"))}catch(t){console.error("ArkadaÅŸ ekleme hatasÄ±:",t),o("idle")}},R=(t,n)=>{try{navigator.clipboard.writeText(t),b.success(`âœ… '${n}' panoya kopyalandÄ±`)}catch{b.error("âŒ Kopyalama hatasÄ±.")}},P={steam_trade:"Steam Trade URL",steam_profile:"Steam Profili",steam_friend_code:"Steam ArkadaÅŸ Kodu",x:"X (Twitter)",instagram:"Instagram"},N=async()=>{const t=prompt(`Ne kadar Coin gÃ¶ndermek istiyorsun? (${a.username} kiÅŸisine)`);if(t)try{const n=await i(`${s}/store/transfer/`,{method:"POST",body:JSON.stringify({target_username:a.username,amount:t})}),p=await n.json();n.ok?b.success(p.message):b.error(p.error)}catch{b.error("âŒ Hata.")}},j=a.social_links||{},I=Object.entries(j).filter(([t,n])=>n&&n.trim()!==""),A=()=>{h(a.username)},v=a.avatar||x(a.username),S=typeof v=="string"&&v.startsWith("http")?v:typeof v=="string"?`${s}${v}`:x(a.username),K=S+(a.avatar&&typeof a.avatar=="string"?`?t=${Date.now()}`:""),O=e.createElement("div",{style:{...r.overlay,zIndex:9999},onClick:l},e.createElement("div",{style:{...r.modal,zIndex:1e4,position:"relative"},onClick:t=>t.stopPropagation()},e.createElement("div",{style:{position:"relative",height:"180px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:"16px 16px 0 0",overflow:"visible"}},e.createElement("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1440 320'%3E%3Cpath fill='rgba(255,255,255,0.1)' d='M0,96L48,112C96,128,192,160,288,160C384,160,480,128,576,112C672,96,768,96,864,112C960,128,1056,160,1152,165.3C1248,171,1344,149,1392,138.7L1440,128L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z'%3E%3C/path%3E%3C/svg%3E")`,backgroundRepeat:"no-repeat",backgroundPosition:"bottom",backgroundSize:"cover",opacity:.3,zIndex:1,borderRadius:"16px 16px 0 0",overflow:"hidden"}}),e.createElement("div",{style:{position:"absolute",bottom:"-50px",left:"32px",width:"120px",height:"120px",borderRadius:"50%",border:"5px solid #2f3136",overflow:"hidden",boxShadow:"0 8px 16px rgba(0, 0, 0, 0.3)",cursor:"pointer",transition:"transform 0.3s ease",zIndex:1e3,backgroundColor:"#2f3136"},onMouseEnter:t=>t.currentTarget.style.transform="scale(1.05)",onMouseLeave:t=>t.currentTarget.style.transform="scale(1)",onClick:()=>m(S)},e.createElement("img",{src:K,key:S,style:{width:"100%",height:"100%",objectFit:"cover"},alt:`${a.username} avatar`,onError:t=>{console.error("âŒ [UserProfileModal] Avatar load failed:",t.target.src),t.target.src=x(a.username)}})),e.createElement("div",{style:{position:"absolute",top:"16px",right:"16px",display:"flex",gap:"8px",zIndex:1e3}},e.createElement("button",{onClick:t=>{t.preventDefault(),t.stopPropagation(),l()},style:{width:"36px",height:"36px",borderRadius:"50%",border:"2px solid rgba(255, 255, 255, 0.3)",background:"rgba(0, 0, 0, 0.6)",color:"#fff",fontSize:"20px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease",zIndex:1001},onMouseEnter:t=>{t.currentTarget.style.background="rgba(240, 71, 71, 0.8)",t.currentTarget.style.transform="scale(1.1)"},onMouseLeave:t=>{t.currentTarget.style.background="rgba(0, 0, 0, 0.6)",t.currentTarget.style.transform="scale(1)"}},"Ã—"))),e.createElement("div",{style:{padding:"70px 32px 24px 32px",background:"#2f3136"}},e.createElement("h2",{style:{fontSize:"28px",fontWeight:"700",margin:"0 0 12px 0",color:"#fff",display:"flex",alignItems:"center",gap:"8px"}},a.username,a.is_premium&&e.createElement("span",{style:{fontSize:"20px"}},"ðŸ’Ž"),a.is_verified&&e.createElement("span",{style:{fontSize:"20px"}},"âœ…")),e.createElement("div",{style:{display:"flex",gap:"10px",marginBottom:"20px"}},!B&&!g&&e.createElement("button",{onClick:L,style:{...r.actionButton,backgroundColor:d==="success"?"#43b581":"#5865f2",cursor:d==="success"||d==="loading"?"default":"pointer",flex:1},disabled:d!=="idle"},d==="loading"?"...":d==="success"?e.createElement(G,null):e.createElement(U,null),d==="success"?" GÃ¶nderildi":" ArkadaÅŸ Ekle"),!g&&e.createElement("button",{onClick:N,style:{...r.actionButton,backgroundColor:"#f0b232",flex:1}},e.createElement(V,null)," Coin GÃ¶nder"),g&&e.createElement("button",{onClick:()=>y(!0),style:{...r.actionButton,backgroundColor:"#43b581",flex:1},title:"Aktif OturumlarÄ± YÃ¶net"},e.createElement(q,null)," Oturumlar"),!g&&e.createElement("button",{onClick:A,style:{...r.messageButton,flex:1}},"ðŸ’¬ Mesaj GÃ¶nder"),!g&&e.createElement("button",{onClick:()=>w(!0),style:{...r.actionButton,backgroundColor:"#faa61a",flex:0,minWidth:"44px"},title:"KullanÄ±cÄ± Notu"},e.createElement($,null)))),e.createElement("div",{style:{...r.content,padding:"24px 32px",overflowY:"auto"}},a.friend_code&&e.createElement("div",{onClick:()=>R(a.friend_code,"ArkadaÅŸ Kodu"),style:{...r.friendCodeContainer,background:"rgba(88, 101, 242, 0.1)",border:"1px solid rgba(88, 101, 242, 0.3)",borderRadius:"8px",padding:"12px 16px",marginBottom:"16px",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:t=>t.currentTarget.style.background="rgba(88, 101, 242, 0.2)",onMouseLeave:t=>t.currentTarget.style.background="rgba(88, 101, 242, 0.1)",title:"Kodu Kopyalamak Ä°Ã§in TÄ±kla"},e.createElement("span",{style:r.friendCodeLabel},"ArkadaÅŸ Kodu"),e.createElement("span",{style:r.friendCodeValue},a.friend_code)),a.status_message&&e.createElement("div",{style:r.section},e.createElement("h4",{style:r.sectionTitle},"Durum"),e.createElement("p",{style:r.statusText},a.status_message)),e.createElement("div",{style:r.tabsContainer},e.createElement("button",{onClick:()=>C("profile"),style:{...r.tabButton,...u==="profile"&&r.activeTab}},"Profile"),e.createElement("button",{onClick:()=>C("activity"),style:{...r.tabButton,...u==="activity"&&r.activeTab}},e.createElement(J,null)," Activity"),!g&&e.createElement("button",{onClick:()=>C("notes"),style:{...r.tabButton,...u==="notes"&&r.activeTab}},e.createElement($,null)," Notes")),u==="profile"&&e.createElement(e.Fragment,null,e.createElement(ee,{username:a.username,fetchWithAuth:i,apiBaseUrl:s}),I.length>0&&e.createElement("div",{style:r.section},e.createElement("h4",{style:r.sectionTitle},"BaÄŸlantÄ±lar"),e.createElement("div",{style:r.linksContainer},I.map(([t,n])=>{const p=P[t]||t.charAt(0).toUpperCase()+t.slice(1),M=te(t);return t==="steam_friend_code"||t==="steam_trade"?e.createElement("button",{key:t,onClick:()=>R(n,p),style:r.linkButton,title:`Kopyala: ${n}`},e.createElement("i",{className:M}),e.createElement("span",{style:r.linkText},p),e.createElement("i",{className:"fa fa-copy",style:{marginLeft:"auto",color:"var(--text-secondary)"}})):e.createElement("a",{key:t,href:ae(n,t),target:"_blank",rel:"noopener noreferrer",style:r.linkButton,title:n},e.createElement("i",{className:M}),e.createElement("span",{style:r.linkText},p))})))),u==="activity"&&e.createElement("div",{style:r.section},e.createElement("h4",{style:r.sectionTitle},"Activity Timeline"),T.length===0?e.createElement("p",{style:r.noDataText},"No activity data available"):e.createElement("div",{style:r.presenceTimeline},T.map((t,n)=>e.createElement("div",{key:n,style:r.presenceEntry},e.createElement("div",{style:{...r.presenceStatus,backgroundColor:t.status==="online"?"#43b581":t.status==="idle"?"#faa61a":t.status==="dnd"?"#f04747":"#747f8d"}}),e.createElement("div",{style:r.presenceDetails},e.createElement("span",{style:r.presenceStatusText},t.status==="online"?"ðŸŸ¢ Online":t.status==="idle"?"ðŸŸ¡ Idle":t.status==="dnd"?"ðŸ”´ Do Not Disturb":"âš« Offline"),e.createElement("span",{style:r.presenceTime},new Date(t.timestamp).toLocaleString("tr-TR",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}))))))))),u==="notes"&&!g&&e.createElement("div",{style:{padding:"0 32px 24px"}},e.createElement(D,{targetUser:a.username,apiBaseUrl:s?s.replace(/\/api\/?$/,"")+"/api":"",fetchWithAuth:i,onClose:()=>C("profile"),inline:!0})),F&&e.createElement(D,{targetUser:a.username,apiBaseUrl:s?s.replace(/\/api\/?$/,"")+"/api":"",fetchWithAuth:i,onClose:()=>w(!1)}),k&&e.createElement(X,{onClose:()=>y(!1),fetchWithAuth:i,apiBaseUrl:s}));return Z.createPortal(O,document.body)},r={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(8px)"},modal:{width:"500px",maxWidth:"90vw",backgroundColor:"#2f3136",borderRadius:"16px",boxShadow:"0 25px 50px rgba(0,0,0,0.5)",display:"flex",flexDirection:"column",position:"relative",overflow:"hidden",maxHeight:"90vh",border:"1px solid rgba(255, 255, 255, 0.1)"},actionButton:{padding:"12px 20px",color:"white",border:"none",borderRadius:"8px",fontWeight:"600",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",fontSize:"14px",transition:"all 0.2s",cursor:"pointer"},messageButton:{padding:"12px 20px",backgroundColor:"#5865f2",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"bold",fontSize:"0.9em"},content:{padding:"20px",maxHeight:"60vh",overflowY:"auto"},friendCodeContainer:{backgroundColor:"rgba(88, 101, 242, 0.1)",padding:"10px 15px",borderRadius:"8px",cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",border:"1px dashed #5865f2",marginBottom:"15px",transition:"background-color 0.2s"},friendCodeLabel:{fontSize:"0.75em",color:"#949ba4",textTransform:"uppercase",fontWeight:"bold",marginBottom:"4px"},friendCodeValue:{fontSize:"1.3em",color:"#5865f2",fontWeight:"800",letterSpacing:"2px"},section:{marginTop:"20px"},sectionTitle:{color:"var(--text-secondary)",fontSize:"0.8em",fontWeight:"bold",textTransform:"uppercase",margin:"0 0 8px 0",borderBottom:"1px solid var(--border-primary)",paddingBottom:"5px"},statusText:{color:"var(--text-primary)",margin:0,fontSize:"0.9em"},linksContainer:{display:"flex",flexDirection:"column",gap:"8px"},linkButton:{display:"flex",alignItems:"center",padding:"10px 12px",backgroundColor:"var(--background-secondary)",borderRadius:"4px",color:"var(--text-primary)",textDecoration:"none",transition:"background-color 0.2s ease",border:"none",fontFamily:"inherit",fontSize:"1em",width:"auto",cursor:"pointer",textAlign:"left",alignSelf:"flex-start"},linkText:{marginLeft:"10px",fontWeight:"500"},tabsContainer:{display:"flex",gap:"10px",borderBottom:"2px solid var(--background-tertiary)",marginBottom:"20px"},tabButton:{background:"none",border:"none",padding:"10px 20px",color:"var(--text-secondary)",cursor:"pointer",fontWeight:"500",borderBottom:"2px solid transparent",transition:"all 0.2s",display:"flex",alignItems:"center",gap:"5px"},activeTab:{color:"var(--brand-color)",borderBottomColor:"var(--brand-color)"},presenceTimeline:{display:"flex",flexDirection:"column",gap:"12px",marginTop:"15px"},presenceEntry:{display:"flex",alignItems:"center",gap:"12px",padding:"10px",backgroundColor:"var(--background-secondary)",borderRadius:"6px",transition:"background-color 0.2s"},presenceStatus:{width:"12px",height:"12px",borderRadius:"50%",flexShrink:0},presenceDetails:{display:"flex",flexDirection:"column",gap:"4px",flex:1},presenceStatusText:{color:"var(--text-primary)",fontWeight:"500",fontSize:"0.95em"},presenceTime:{color:"var(--text-secondary)",fontSize:"0.85em"},noDataText:{color:"var(--text-secondary)",textAlign:"center",padding:"20px",fontStyle:"italic"}};export{le as default};
