import{r as a,j as e}from"./react-vendor-D8Fi5F9E.js";import{a5 as k,a as P,Z as E,aM as F,bj as N,m as O}from"./icons-vendor-BPCemF_6.js";import{t as s}from"./index-CwlM2zFi.js";import"./media-vendor-Dp18sh1g.js";import"./router-vendor-CTPwQFnc.js";import"./crypto-vendor-Cz32ecGD.js";import"./state-vendor-De5qIGw3.js";const W=({fetchWithAuth:c,apiBaseUrl:p,serverId:y,onClose:h})=>{const[d,b]=a.useState([]),[S,j]=a.useState(!0),[R,x]=a.useState(!1),[n,u]=a.useState({name:"",color:"#5865f2",permissions:[]}),[i,v]=a.useState(null);a.useEffect(()=>{g()},[]);const g=async()=>{try{j(!0);const o=await c(`${p}/api/servers/${y}/roles/list/`);if(o.ok){const t=await o.json();b(t.sort((l,f)=>(f.position||0)-(l.position||0)))}}catch(o){console.error("Rol yÃ¼kleme hatasÄ±:",o),s.error("Roller yÃ¼klenemedi")}finally{j(!1)}},C=async()=>{if(!n.name.trim()){s.error("Rol adÄ± gerekli");return}try{(await c(`${p}/api/servers/${y}/roles/create/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})).ok?(s.success("Rol oluÅŸturuldu"),u({name:"",color:"#5865f2",permissions:[]}),x(!1),g()):s.error("Rol oluÅŸturulamadÄ±")}catch(o){console.error("Rol oluÅŸturma hatasÄ±:",o),s.error("Bir hata oluÅŸtu")}},w=async o=>{if(confirm("Bu rolÃ¼ silmek istediÄŸinize emin misiniz?"))try{(await c(`${p}/api/roles/${o}/delete/`,{method:"DELETE"})).ok?(s.success("Rol silindi"),g()):s.error("Rol silinemedi")}catch(t){console.error("Rol silme hatasÄ±:",t),s.error("Bir hata oluÅŸtu")}},B=o=>{v(o)},z=(o,t)=>{if(o.preventDefault(),!i||i.id===t.id)return;const l=[...d],f=l.findIndex(m=>m.id===i.id),D=l.findIndex(m=>m.id===t.id);l.splice(f,1),l.splice(D,0,i),b(l)},I=async()=>{if(i){try{(await c(`${p}/api/roles/reorder/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({roles:d.map((t,l)=>({id:t.id,position:d.length-l}))})})).ok&&s.success("Rol sÄ±ralamasÄ± gÃ¼ncellendi")}catch(o){console.error("SÄ±ralama hatasÄ±:",o),s.error("Bir hata oluÅŸtu")}v(null)}};return e.jsx("div",{style:r.overlay,onClick:h,children:e.jsxs("div",{style:r.modal,onClick:o=>o.stopPropagation(),children:[e.jsxs("div",{style:r.header,children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(k,{style:{color:"#5865f2"}}),e.jsx("h2",{style:{margin:0},children:"Sunucu Rolleri"})]}),e.jsx(P,{onClick:h,style:r.closeBtn})]}),e.jsxs("div",{style:r.toolbar,children:[e.jsxs("button",{onClick:()=>x(!R),style:r.newRoleBtn,children:[e.jsx(E,{})," Yeni Rol"]}),e.jsx("p",{style:{fontSize:"12px",color:"#888",margin:"10px 0 0 0"},children:"ðŸ’¡ Rolleri sÃ¼rÃ¼kleyerek hiyerarÅŸiyi deÄŸiÅŸtirebilirsiniz"})]}),R&&e.jsxs("div",{style:r.newRoleForm,children:[e.jsx("input",{type:"text",placeholder:"Rol adÄ±...",value:n.name,onChange:o=>u({...n,name:o.target.value}),style:r.input}),e.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center",marginBottom:"15px"},children:[e.jsx(F,{style:{color:"#888"}}),e.jsx("input",{type:"color",value:n.color,onChange:o=>u({...n,color:o.target.value}),style:r.colorPicker}),e.jsx("span",{style:{color:"#dcddde",fontSize:"14px"},children:n.color})]}),e.jsxs("div",{style:{display:"flex",gap:"10px"},children:[e.jsx("button",{onClick:C,style:r.saveBtn,children:"OluÅŸtur"}),e.jsx("button",{onClick:()=>x(!1),style:r.cancelBtn,children:"Ä°ptal"})]})]}),e.jsx("div",{style:r.rolesList,children:S?e.jsx("div",{style:r.loading,children:"YÃ¼kleniyor..."}):d.length===0?e.jsxs("div",{style:r.empty,children:[e.jsx(k,{style:{fontSize:"48px",color:"#555"}}),e.jsx("p",{children:"HenÃ¼z rol yok"})]}):d.map((o,t)=>e.jsxs("div",{draggable:!0,onDragStart:()=>B(o),onDragOver:l=>z(l,o),onDragEnd:I,style:{...r.roleItem,opacity:i?.id===o.id?.5:1},children:[e.jsx("div",{style:r.dragHandle,children:e.jsx(N,{style:{color:"#888"}})}),e.jsx("div",{style:{...r.roleColor,backgroundColor:o.color||"#5865f2"}}),e.jsxs("div",{style:r.roleContent,children:[e.jsx("div",{style:r.roleName,children:o.name}),e.jsxs("div",{style:r.roleMeta,children:["Pozisyon: ",t+1," â€¢ ",o.member_count||0," Ã¼ye"]})]}),!o.is_default&&e.jsx("button",{onClick:()=>w(o.id),style:r.deleteBtn,title:"Sil",children:e.jsx(O,{})})]},o.id))})]})})},r={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999},modal:{backgroundColor:"#1e1e1e",borderRadius:"8px",width:"90%",maxWidth:"600px",maxHeight:"90vh",display:"flex",flexDirection:"column",color:"#fff"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #333"},closeBtn:{cursor:"pointer",fontSize:"24px",color:"#888"},toolbar:{padding:"15px 20px",borderBottom:"1px solid #333"},newRoleBtn:{backgroundColor:"#5865f2",color:"#fff",border:"none",padding:"10px 20px",borderRadius:"4px",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",fontSize:"14px",fontWeight:"500"},newRoleForm:{padding:"20px",backgroundColor:"#2c2f33",borderBottom:"1px solid #333"},input:{width:"100%",padding:"10px",backgroundColor:"#1e1e1e",border:"1px solid #444",borderRadius:"4px",color:"#fff",fontSize:"14px",marginBottom:"15px"},colorPicker:{width:"60px",height:"40px",border:"none",borderRadius:"4px",cursor:"pointer"},saveBtn:{flex:1,backgroundColor:"#43b581",color:"#fff",border:"none",padding:"10px",borderRadius:"4px",cursor:"pointer",fontSize:"14px",fontWeight:"500"},cancelBtn:{flex:1,backgroundColor:"#4e5058",color:"#fff",border:"none",padding:"10px",borderRadius:"4px",cursor:"pointer",fontSize:"14px",fontWeight:"500"},rolesList:{flex:1,overflowY:"auto",padding:"20px"},roleItem:{display:"flex",gap:"15px",padding:"12px",backgroundColor:"#2c2f33",borderRadius:"8px",marginBottom:"8px",alignItems:"center",cursor:"move",transition:"opacity 0.2s"},dragHandle:{cursor:"grab",padding:"5px"},roleColor:{width:"4px",height:"40px",borderRadius:"2px"},roleContent:{flex:1},roleName:{fontWeight:"600",marginBottom:"4px"},roleMeta:{fontSize:"12px",color:"#888"},deleteBtn:{backgroundColor:"transparent",border:"none",color:"#ed4245",cursor:"pointer",fontSize:"18px",padding:"8px"},loading:{textAlign:"center",padding:"40px",color:"#888"},empty:{textAlign:"center",padding:"60px 20px",color:"#888"}};export{W as default};
