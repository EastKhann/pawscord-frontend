import{r as x,j as e}from"./react-core-D6cE4lil.js";import{y as r}from"./ui-vendor-CZOhtEfS.js";import{h as y,g as C}from"./index-BvqjkDq7.js";import"./media-vendor-Du00QUHb.js";import"./router-vendor-wrB4dqw3.js";import"./icons-vendor-DT2gd7vx.js";import"./state-vendor-DnurjGY_.js";import"./crypto-vendor-BYnay7oC.js";const b={title:"",description:"",prize:"",channel_id:"",winners_count:1,duration:3600,required_role_id:"",required_messages:0,required_invites:0,allow_multiple_entries:!1},S=[{value:1800,label:"30 dakika"},{value:3600,label:"1 saat"},{value:10800,label:"3 saat"},{value:21600,label:"6 saat"},{value:43200,label:"12 saat"},{value:86400,label:"1 gÃ¼n"},{value:172800,label:"2 gÃ¼n"},{value:259200,label:"3 gÃ¼n"},{value:604800,label:"1 hafta"}],z=s=>{const i={active:{text:"Aktif",color:"#10b981"},ended:{text:"SonlandÄ±",color:"#6b7280"},cancelled:{text:"Ä°ptal",color:"#ef4444"}};return i[s]||i.active},$=s=>{const i=Math.floor((new Date(s)-new Date)/1e3);if(i<=0)return"Sona erdi";const c=Math.floor(i/86400),o=Math.floor(i%86400/3600),d=Math.floor(i%3600/60);return c>0?`${c}g ${o}s kaldÄ±`:o>0?`${o}s ${d}dk kaldÄ±`:`${d} dakika kaldÄ±`},q=s=>{const i=C(),[c,o]=x.useState([]),[d,m]=x.useState(!0),[n,a]=x.useState(!1),[j,k]=x.useState([]),[N,g]=x.useState([]),[u,f]=x.useState(b),t={Authorization:`Bearer ${localStorage.getItem("access_token")}`},v=async()=>{try{const l=await fetch(`${i}/giveaways/server/${s}/`,{headers:t});l.ok&&o(await l.json())}catch{}finally{m(!1)}},w=async()=>{try{const l=await fetch(`${i}/channels/server/${s}/`,{headers:t});if(l.ok){const h=await l.json();k(h.filter(p=>p.type==="text"))}}catch{}},_=async()=>{try{const l=await fetch(`${i}/roles/server/${s}/`,{headers:t});l.ok&&g(await l.json())}catch{}};return x.useEffect(()=>{v(),w(),_()},[s]),{giveaways:c,loading:d,showCreateModal:n,setShowCreateModal:a,channels:j,roles:N,newGiveaway:u,setNewGiveaway:f,createGiveaway:async()=>{if(!u.title||!u.prize||!u.channel_id){r.error("âŒ LÃ¼tfen tÃ¼m gerekli alanlarÄ± doldurun");return}try{(await fetch(`${i}/giveaways/create/`,{method:"POST",headers:{...t,"Content-Type":"application/json"},body:JSON.stringify({server_id:s,...u})})).ok?(r.success("âœ… Ã‡ekiliÅŸ oluÅŸturuldu!"),a(!1),v(),f(b)):r.error("âŒ Ã‡ekiliÅŸ oluÅŸturulamadÄ±")}catch{r.error("âŒ BaÄŸlantÄ± hatasÄ±")}},endGiveaway:async l=>{if(await y("Ã‡ekiliÅŸi sonlandÄ±rmak istediÄŸinize emin misiniz?"))try{const h=await fetch(`${i}/giveaways/${l}/end/`,{method:"POST",headers:t});if(h.ok){const p=await h.json();r.success(`âœ… Ã‡ekiliÅŸ sonlandÄ±! Kazananlar: ${p.winners.join(", ")}`),v()}else r.error("âŒ Ã‡ekiliÅŸ sonlandÄ±rÄ±lamadÄ±")}catch{r.error("âŒ BaÄŸlantÄ± hatasÄ±")}},rerollGiveaway:async l=>{try{const h=await fetch(`${i}/giveaways/${l}/reroll/`,{method:"POST",headers:t});if(h.ok){const p=await h.json();r.success(`âœ… Yeni kazanan: ${p.new_winner}`),v()}else r.error("âŒ Reroll yapÄ±lamadÄ±")}catch{r.error("âŒ BaÄŸlantÄ± hatasÄ±")}},deleteGiveaway:async l=>{if(await y("Ã‡ekiliÅŸi silmek istediÄŸinize emin misiniz?"))try{(await fetch(`${i}/giveaways/${l}/delete/`,{method:"DELETE",headers:t})).ok?(r.success("âœ… Ã‡ekiliÅŸ silindi"),v()):r.error("âŒ Ã‡ekiliÅŸ silinemedi")}catch{r.error("âŒ BaÄŸlantÄ± hatasÄ±")}}}},G=({giveaway:s,onEnd:i,onReroll:c,onDelete:o})=>{const d=z(s.status);return e.jsxs("div",{className:"giveaway-card",children:[e.jsxs("div",{className:"giveaway-card-header",children:[e.jsx("h3",{children:s.title}),e.jsx("span",{className:"status-badge",style:{background:d.color},children:d.text})]}),e.jsxs("div",{className:"giveaway-card-body",children:[e.jsxs("div",{className:"giveaway-prize",children:[e.jsx("span",{className:"prize-icon",children:"ðŸŽ"}),e.jsx("span",{className:"prize-text",children:s.prize})]}),s.description&&e.jsx("p",{className:"giveaway-description",children:s.description}),e.jsxs("div",{className:"giveaway-info",children:[e.jsxs("div",{className:"info-item",children:[e.jsxs("span",{className:"info-label",children:["Kazanan Say","Ä±","s","Ä±",":"]}),e.jsxs("span",{className:"info-value",children:[s.winners_count," ki","ÅŸ","i"]})]}),e.jsxs("div",{className:"info-item",children:[e.jsxs("span",{className:"info-label",children:["Kat","Ä±","l","Ä±","mc","Ä±","lar:"]}),e.jsxs("span",{className:"info-value",children:[s.entries_count||0," ki","ÅŸ","i"]})]}),s.status==="active"&&e.jsxs("div",{className:"info-item",children:[e.jsxs("span",{className:"info-label",children:["Kalan S","Ã¼","re:"]}),e.jsx("span",{className:"info-value time-remaining",children:$(s.end_time)})]})]}),s.required_role_id&&e.jsxs("div",{className:"requirement-badge",children:["â­"," Rol gereksinimi var"]}),s.required_messages>0&&e.jsxs("div",{className:"requirement-badge",children:["ðŸ’¬"," ",s.required_messages," mesaj gerekli"]}),s.required_invites>0&&e.jsxs("div",{className:"requirement-badge",children:["ðŸ‘¥"," ",s.required_invites," davet gerekli"]}),s.winners&&s.winners.length>0&&e.jsxs("div",{className:"winners-section",children:[e.jsxs("h4",{children:["ðŸŽ‰"," Kazananlar:"]}),e.jsx("ul",{className:"winners-list",children:s.winners.map((m,n)=>e.jsx("li",{children:m},n))})]})]}),e.jsxs("div",{className:"giveaway-card-footer",children:[s.status==="active"&&e.jsxs("button",{className:"end-btn",onClick:()=>i(s.id),children:["ðŸ"," Sonland","Ä±","r"]}),s.status==="ended"&&e.jsxs("button",{className:"reroll-btn",onClick:()=>c(s.id),children:["ðŸ”„"," Reroll"]}),e.jsxs("button",{className:"delete-btn",onClick:()=>o(s.id),children:["ðŸ—‘ï¸"," Sil"]})]})]})},M=({newGiveaway:s,setNewGiveaway:i,channels:c,roles:o,onCreate:d,onClose:m})=>{const n=(a,j)=>i({...s,[a]:j});return e.jsx("div",{className:"create-modal-overlay",onClick:m,children:e.jsxs("div",{className:"create-modal",onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("h3",{children:["Yeni ","Ã‡","ekili","ÅŸ"," Olu","ÅŸ","tur"]}),e.jsx("button",{className:"close-btn",onClick:m,children:"Ã—"})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["Ba","ÅŸ","l","Ä±","k *"]}),e.jsx("input",{type:"text",placeholder:"Discord Nitro \\u00C7ekili\\u015Fi",value:s.title,onChange:a=>n("title",a.target.value)})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["A","Ã§Ä±","klama"]}),e.jsx("textarea",{placeholder:"Ã‡ekiliÅŸ hakkÄ±nda detaylar...",value:s.description,onChange:a=>n("description",a.target.value),rows:"3"})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["Ã–","d","Ã¼","l *"]}),e.jsx("input",{type:"text",placeholder:"1 Ayl\\u0131k Discord Nitro",value:s.prize,onChange:a=>n("prize",a.target.value)})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kanal *"}),e.jsxs("select",{value:s.channel_id,onChange:a=>n("channel_id",a.target.value),children:[e.jsxs("option",{value:"",children:["Kanal Se","Ã§","in"]}),c.map(a=>e.jsxs("option",{value:a.id,children:["# ",a.name]},a.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["Kazanan Say","Ä±","s","Ä±"]}),e.jsx("input",{type:"number",min:"1",max:"100",value:s.winners_count,onChange:a=>n("winners_count",parseInt(a.target.value))})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["S","Ã¼","re"]}),e.jsx("select",{value:s.duration,onChange:a=>n("duration",parseInt(a.target.value)),children:S.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})]}),e.jsxs("div",{className:"requirements-section",children:[e.jsxs("h4",{children:["Kat","Ä±","l","Ä±","m Gereksinimleri (Opsiyonel)"]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Gerekli Rol"}),e.jsxs("select",{value:s.required_role_id,onChange:a=>n("required_role_id",a.target.value),children:[e.jsx("option",{value:"",children:"Rol yok"}),o.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["Minimum Mesaj Say","Ä±","s","Ä±"]}),e.jsx("input",{type:"number",min:"0",value:s.required_messages,onChange:a=>n("required_messages",parseInt(a.target.value))})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["Minimum Davet Say","Ä±","s","Ä±"]}),e.jsx("input",{type:"number",min:"0",value:s.required_invites,onChange:a=>n("required_invites",parseInt(a.target.value))})]})]}),e.jsx("div",{className:"form-group",children:e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:s.allow_multiple_entries,onChange:a=>n("allow_multiple_entries",a.target.checked)}),e.jsxs("span",{children:["Birden fazla kat","Ä±","l","Ä±","ma izin ver"]})]})})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsxs("button",{className:"cancel-btn",onClick:m,children:["Ä°","ptal"]}),e.jsxs("button",{className:"submit-btn",onClick:d,children:["ðŸŽ‰"," ","Ã‡","ekili","ÅŸ"," Olu","ÅŸ","tur"]})]})]})})},H=({serverId:s,onClose:i})=>{const{giveaways:c,loading:o,showCreateModal:d,setShowCreateModal:m,channels:n,roles:a,newGiveaway:j,setNewGiveaway:k,createGiveaway:N,endGiveaway:g,rerollGiveaway:u,deleteGiveaway:f}=q(s);return e.jsx("div",{className:"giveaway-panel-overlay",onClick:i,children:e.jsxs("div",{className:"giveaway-panel",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"giveaway-header",children:[e.jsxs("h2",{children:["ðŸŽ‰"," ","Ã‡","ekili","ÅŸ","ler"]}),e.jsx("button",{className:"close-btn",onClick:i,children:"Ã—"})]}),e.jsxs("div",{className:"giveaway-content",children:[e.jsx("div",{className:"giveaway-actions",children:e.jsxs("button",{className:"create-giveaway-btn",onClick:()=>m(!0),children:["+ Yeni ","Ã‡","ekili","ÅŸ"," Olu","ÅŸ","tur"]})}),o?e.jsxs("div",{className:"loading-state",children:[e.jsx("div",{className:"spinner"}),e.jsxs("p",{children:["Ã‡","ekili","ÅŸ","ler y","Ã¼","kleniyor..."]})]}):c.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("span",{className:"empty-icon",children:"ðŸŽ"}),e.jsxs("p",{children:["Hen","Ã¼","z ","Ã§","ekili","ÅŸ"," yok"]}),e.jsxs("span",{className:"empty-hint",children:["Yeni bir ","Ã§","ekili","ÅŸ"," olu","ÅŸ","turun!"]})]}):e.jsx("div",{className:"giveaways-list",children:c.map(t=>e.jsx(G,{giveaway:t,onEnd:g,onReroll:u,onDelete:f},t.id))})]}),d&&e.jsx(M,{newGiveaway:j,setNewGiveaway:k,channels:n,roles:a,onCreate:N,onClose:()=>m(!1)})]})})};export{H as default};
