import{r as m,n as e}from"./react-core-Cj7FUMmY.js";import{y as o}from"./ui-vendor-EA4dxvko.js";import{g as z,h as K}from"./index-DrIBbDZv.js";import"./editor-vendor-D9c4a6XZ.js";import"./media-vendor-BsD1gqUZ.js";import"./router-vendor-QeioVw-9.js";import"./icons-vendor-TGltgKsJ.js";import"./state-vendor-MN-5i-Jz.js";import"./crypto-vendor-DK-7ILyQ.js";const U=({serverId:l,onClose:g})=>{const[d,u]=m.useState([]),[b,x]=m.useState(!1),[A,v]=m.useState(null),[t,r]=m.useState({name:"",description:"",response:"",trigger_type:"exact",enabled:!0,cooldown:0,permissions:"everyone",delete_trigger:!1,embed:!1,embed_color:"#5865f2"}),[f,N]=m.useState(!0),[p,y]=m.useState(null),c=z();m.useEffect(()=>{l&&(k(),j())},[l]);const k=async()=>{try{const s=localStorage.getItem("access_token"),a=await fetch(`${c}/commands/server/${l}/`,{headers:{Authorization:`Bearer ${s}`}});if(a.ok){const n=await a.json();u(n.commands||[])}}catch{}finally{N(!1)}},j=async()=>{try{const s=localStorage.getItem("access_token"),a=await fetch(`${c}/commands/server/${l}/stats/`,{headers:{Authorization:`Bearer ${s}`}});if(a.ok){const n=await a.json();y(n)}}catch{}},C=async()=>{if(!t.name||!t.response){o.error("âŒ Komut adÄ± ve yanÄ±t zorunludur");return}try{const s=localStorage.getItem("access_token"),a=await fetch(`${c}/commands/create/`,{method:"POST",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},body:JSON.stringify({server_id:l,...t})});if(a.ok){const n=await a.json();u([...d,n.command]),r({name:"",description:"",response:"",trigger_type:"exact",enabled:!0,cooldown:0,permissions:"everyone",delete_trigger:!1,embed:!1,embed_color:"#5865f2"}),x(!1),o.success("âœ… Komut oluÅŸturuldu"),j()}else o.error("âŒ Komut oluÅŸturulamadÄ±")}catch{o.error("âŒ BaÄŸlantÄ± hatasÄ±")}},w=async s=>{if(await K("Bu komutu silmek istediÄŸinizden emin misiniz?"))try{const a=localStorage.getItem("access_token");(await fetch(`${c}/commands/${s}/delete/`,{method:"DELETE",headers:{Authorization:`Bearer ${a}`}})).ok?(u(d.filter(h=>h.id!==s)),o.success("âœ… Komut silindi"),j()):o.error("âŒ Komut silinemedi")}catch{o.error("âŒ BaÄŸlantÄ± hatasÄ±")}},_=async(s,a)=>{try{const n=localStorage.getItem("access_token");(await fetch(`${c}/commands/${s}/toggle/`,{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify({enabled:a})})).ok&&(u(d.map(i=>i.id===s?{...i,enabled:a}:i)),o.success(`âœ… Komut ${a?"etkinleÅŸtirildi":"devre dÄ±ÅŸÄ± bÄ±rakÄ±ldÄ±"}`))}catch{o.error("âŒ Ä°ÅŸlem baÅŸarÄ±sÄ±z")}},$=async()=>{try{const s=localStorage.getItem("access_token"),a=await fetch(`${c}/commands/server/${l}/export/`,{headers:{Authorization:`Bearer ${s}`}});if(a.ok){const n=await a.blob(),h=window.URL.createObjectURL(n),i=document.createElement("a");i.href=h,i.download=`commands_${l}.json`,i.click(),o.success("âœ… Komutlar dÄ±ÅŸa aktarÄ±ldÄ±")}}catch{o.error("âŒ DÄ±ÅŸa aktarma baÅŸarÄ±sÄ±z")}},S=async s=>{const a=new FormData;a.append("file",s),a.append("server_id",l);try{const n=localStorage.getItem("access_token");(await fetch(`${c}/commands/import/`,{method:"POST",headers:{Authorization:`Bearer ${n}`},body:a})).ok?(k(),o.success("âœ… Komutlar iÃ§e aktarÄ±ldÄ±")):o.error("âŒ Ä°Ã§e aktarma baÅŸarÄ±sÄ±z")}catch{o.error("âŒ BaÄŸlantÄ± hatasÄ±")}};return f?e.jsx("div",{className:"custom-commands-overlay",children:e.jsx("div",{className:"custom-commands-panel",children:e.jsxs("div",{className:"loading-state",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{children:"Komutlar yÃ¼kleniyor..."})]})})}):e.jsx("div",{className:"custom-commands-overlay",onClick:g,children:e.jsxs("div",{className:"custom-commands-panel",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"commands-header",children:[e.jsx("h2",{children:"âš¡ Ã–zel Komutlar"}),e.jsx("button",{className:"close-btn",onClick:g,children:"Ã—"})]}),e.jsxs("div",{className:"commands-content",children:[p&&e.jsxs("div",{className:"stats-overview",children:[e.jsxs("div",{className:"stat-card",children:[e.jsx("span",{className:"stat-value",children:p.total_commands||0}),e.jsx("span",{className:"stat-label",children:"Toplam Komut"})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("span",{className:"stat-value",children:p.enabled_commands||0}),e.jsx("span",{className:"stat-label",children:"Aktif"})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("span",{className:"stat-value",children:p.total_uses||0}),e.jsx("span",{className:"stat-label",children:"KullanÄ±m"})]})]}),e.jsxs("div",{className:"action-buttons",children:[e.jsx("button",{className:"create-btn",onClick:()=>x(!0),children:"â• Yeni Komut"}),e.jsx("button",{className:"export-btn",onClick:$,children:"ğŸ“¤ DÄ±ÅŸa Aktar"}),e.jsxs("label",{className:"import-btn",children:["ğŸ“¥ Ä°Ã§e Aktar",e.jsx("input",{type:"file",accept:".json",onChange:s=>s.target.files[0]&&S(s.target.files[0]),style:{display:"none"}})]})]}),b&&e.jsxs("div",{className:"command-form",children:[e.jsx("h3",{children:"Yeni Komut OluÅŸtur"}),e.jsxs("div",{className:"form-grid",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Komut AdÄ± *"}),e.jsx("input",{type:"text",placeholder:"!komut",value:t.name,onChange:s=>r({...t,name:s.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"AÃ§Ä±klama"}),e.jsx("input",{type:"text",placeholder:"Komut aÃ§Ä±klamasÄ±",value:t.description,onChange:s=>r({...t,description:s.target.value})})]}),e.jsxs("div",{className:"form-group full-width",children:[e.jsx("label",{children:"YanÄ±t *"}),e.jsx("textarea",{placeholder:"Komut yanÄ±tÄ± (deÄŸiÅŸkenler: {user}, {server}, {channel})",value:t.response,onChange:s=>r({...t,response:s.target.value}),rows:3})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Tetikleme Tipi"}),e.jsxs("select",{value:t.trigger_type,onChange:s=>r({...t,trigger_type:s.target.value}),children:[e.jsx("option",{value:"exact",children:"Tam EÅŸleÅŸme"}),e.jsx("option",{value:"contains",children:"Ä°Ã§erir"}),e.jsx("option",{value:"starts_with",children:"Ä°le BaÅŸlar"}),e.jsx("option",{value:"regex",children:"Regex"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Ä°zinler"}),e.jsxs("select",{value:t.permissions,onChange:s=>r({...t,permissions:s.target.value}),children:[e.jsx("option",{value:"everyone",children:"Herkes"}),e.jsx("option",{value:"mods",children:"ModeratÃ¶rler"}),e.jsx("option",{value:"admins",children:"Adminler"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Cooldown (saniye)"}),e.jsx("input",{type:"number",min:"0",max:"300",value:t.cooldown,onChange:s=>r({...t,cooldown:parseInt(s.target.value)})})]}),e.jsx("div",{className:"form-group",children:e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:t.delete_trigger,onChange:s=>r({...t,delete_trigger:s.target.checked})}),"Tetikleyici mesajÄ± sil"]})}),e.jsx("div",{className:"form-group",children:e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:t.embed,onChange:s=>r({...t,embed:s.target.checked})}),"Embed olarak gÃ¶nder"]})}),t.embed&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Embed Rengi"}),e.jsx("input",{type:"color",value:t.embed_color,onChange:s=>r({...t,embed_color:s.target.value})})]})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{className:"cancel-btn",onClick:()=>x(!1),children:"Ä°ptal"}),e.jsx("button",{className:"submit-btn",onClick:C,children:"OluÅŸtur"})]})]}),e.jsx("div",{className:"commands-list",children:d.length>0?d.map(s=>e.jsxs("div",{className:`command-card ${s.enabled?"":"disabled"}`,children:[e.jsxs("div",{className:"command-header",children:[e.jsxs("div",{className:"command-info",children:[e.jsx("h4",{children:s.name}),s.description&&e.jsx("p",{children:s.description})]}),e.jsxs("label",{className:"toggle-switch",children:[e.jsx("input",{type:"checkbox",checked:s.enabled,onChange:a=>_(s.id,a.target.checked)}),e.jsx("span",{className:"slider"})]})]}),e.jsxs("div",{className:"command-response",children:[e.jsx("strong",{children:"YanÄ±t:"})," ",s.response]}),e.jsxs("div",{className:"command-meta",children:[e.jsxs("span",{className:"meta-item",children:["ğŸ¯ ",s.trigger_type]}),e.jsxs("span",{className:"meta-item",children:["ğŸ‘¥ ",s.permissions]}),s.cooldown>0&&e.jsxs("span",{className:"meta-item",children:["â±ï¸ ",s.cooldown,"s"]}),e.jsxs("span",{className:"meta-item",children:["ğŸ“Š ",s.use_count||0," kullanÄ±m"]})]}),e.jsxs("div",{className:"command-actions",children:[e.jsx("button",{className:"edit-btn",onClick:()=>v(s.id),children:"âœï¸"}),e.jsx("button",{className:"delete-btn",onClick:()=>w(s.id),children:"ğŸ—‘ï¸"})]})]},s.id)):!b&&e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-icon",children:"âš¡"}),e.jsx("h3",{children:"HenÃ¼z Ã¶zel komut yok"}),e.jsx("p",{children:"Sunucunuz iÃ§in Ã¶zel komutlar oluÅŸturun"})]})})]})]})})};export{U as default};
