import{r,n as e}from"./react-core-BMiyQWF6.js";import{t as F}from"./index-CAB0Mj32.js";import{bk as l,a as g,ar as R,a3 as D,Y as H,H as k,s as P,b1 as W,bc as A}from"./icons-vendor-GUGjkvMm.js";import"./editor-vendor-D9c4a6XZ.js";import"./media-vendor-BuSyE8vR.js";import"./router-vendor-B86Z1mIL.js";import"./state-vendor-CAyNnPM4.js";import"./crypto-vendor-1Q6e4ZD-.js";const Y=({serverId:f,fetchWithAuth:h,apiBaseUrl:y,onClose:u})=>{const[m,w]=r.useState([]),[d,B]=r.useState("pending"),[a,I]=r.useState("all"),[o,c]=r.useState(null),[z,b]=r.useState(!0),[p,T]=r.useState({pending:0,resolved:0,dismissed:0,total:0});r.useEffect(()=>{j(),v()},[f,d,a]);const j=async()=>{b(!0);try{const s=new URLSearchParams({server:f,status:d!=="all"?d:"",report_type:a!=="all"?a:""}),n=await h(`${y}/moderation/reports/?${s}`);if(n.ok){const i=await n.json();w(i.results||i)}}catch{}b(!1)},v=async()=>{try{const s=await h(`${y}/moderation/reports/stats/${f}/`);if(s.ok){const n=await s.json();T(n)}}catch{}},x=async(s,n,i="")=>{try{(await h(`${y}/moderation/reports/${s}/handle/`,{method:"POST",body:JSON.stringify({action:n,reason:i,moderator_notes:i})})).ok?(j(),v(),c(null)):F.error("❌ Failed to handle report")}catch{}},_=s=>{switch(s){case"message":return e.jsx(A,{});case"user":return e.jsx(k,{});case"server":return e.jsx(l,{});default:return e.jsx(l,{})}},C=s=>{switch(s){case"pending":return"#f0b132";case"resolved":return"#43b581";case"dismissed":return"#72767d";default:return"#5865f2"}},S=s=>{switch(s){case"low":return"#43b581";case"medium":return"#f0b132";case"high":return"#ed4245";case"critical":return"#a12929";default:return"#72767d"}};return e.jsx("div",{style:t.overlay,onClick:u,children:e.jsxs("div",{style:t.panel,onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{style:t.header,children:[e.jsxs("div",{style:t.headerLeft,children:[e.jsx(l,{style:t.headerIcon}),e.jsx("h2",{style:t.title,children:"Report System"})]}),e.jsx("button",{onClick:u,style:t.closeButton,children:e.jsx(g,{})})]}),e.jsxs("div",{style:t.statsGrid,children:[e.jsxs("div",{style:t.statCard,children:[e.jsx(l,{style:{...t.statIcon,color:"#f0b132"}}),e.jsx("div",{style:t.statValue,children:p.pending}),e.jsx("div",{style:t.statLabel,children:"Pending"})]}),e.jsxs("div",{style:t.statCard,children:[e.jsx(R,{style:{...t.statIcon,color:"#43b581"}}),e.jsx("div",{style:t.statValue,children:p.resolved}),e.jsx("div",{style:t.statLabel,children:"Resolved"})]}),e.jsxs("div",{style:t.statCard,children:[e.jsx(g,{style:{...t.statIcon,color:"#72767d"}}),e.jsx("div",{style:t.statValue,children:p.dismissed}),e.jsx("div",{style:t.statLabel,children:"Dismissed"})]}),e.jsxs("div",{style:t.statCard,children:[e.jsx(D,{style:{...t.statIcon,color:"#5865f2"}}),e.jsx("div",{style:t.statValue,children:p.total}),e.jsx("div",{style:t.statLabel,children:"Total Reports"})]})]}),e.jsx("div",{style:t.filters,children:e.jsxs("div",{style:t.filterGroup,children:[e.jsx(H,{style:t.filterIcon}),e.jsxs("select",{value:d,onChange:s=>B(s.target.value),style:t.filterSelect,children:[e.jsx("option",{value:"all",children:"All Reports"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"resolved",children:"Resolved"}),e.jsx("option",{value:"dismissed",children:"Dismissed"})]}),e.jsxs("select",{value:a,onChange:s=>I(s.target.value),style:t.filterSelect,children:[e.jsx("option",{value:"all",children:"All Types"}),e.jsx("option",{value:"message",children:"Messages"}),e.jsx("option",{value:"user",children:"Users"}),e.jsx("option",{value:"server",children:"Server"})]})]})}),e.jsx("div",{style:t.reportsList,children:z?e.jsx("div",{style:t.loading,children:"Loading reports..."}):m.length===0?e.jsxs("div",{style:t.empty,children:[e.jsx(l,{style:t.emptyIcon}),e.jsx("p",{children:"No reports found"})]}):m.map(s=>e.jsxs("div",{style:t.reportCard,onClick:()=>c(s),children:[e.jsxs("div",{style:t.reportHeader,children:[e.jsx("div",{style:t.reportIcon,children:_(s.report_type)}),e.jsxs("div",{style:t.reportInfo,children:[e.jsx("div",{style:t.reportTitle,children:s.reason||`${s.report_type} Report`}),e.jsxs("div",{style:t.reportMeta,children:[e.jsxs("span",{children:["By: ",s.reporter_username||"Unknown"]}),e.jsx("span",{children:"•"}),e.jsx("span",{children:new Date(s.created_at).toLocaleString()})]})]}),e.jsxs("div",{style:t.reportBadges,children:[e.jsx("span",{style:{...t.badge,backgroundColor:C(s.status)},children:s.status}),s.severity&&e.jsx("span",{style:{...t.badge,backgroundColor:S(s.severity)},children:s.severity})]})]}),e.jsxs("div",{style:t.reportContent,children:[e.jsx("p",{style:t.reportText,children:s.description}),s.message_content&&e.jsxs("div",{style:t.reportedContent,children:[e.jsx("strong",{children:"Reported Content:"}),e.jsx("p",{children:s.message_content})]}),s.reported_username&&e.jsxs("div",{style:t.reportedUser,children:[e.jsx(k,{}),e.jsxs("span",{children:["Reported User: ",s.reported_username]})]})]})]},s.id))}),o&&e.jsx("div",{style:t.modalOverlay,onClick:()=>c(null),children:e.jsxs("div",{style:t.modal,onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{style:t.modalHeader,children:[e.jsx("h3",{style:t.modalTitle,children:"Report Details"}),e.jsx("button",{onClick:()=>c(null),style:t.modalClose,children:e.jsx(g,{})})]}),e.jsxs("div",{style:t.modalContent,children:[e.jsxs("div",{style:t.detailRow,children:[e.jsx("strong",{children:"Report Type:"}),e.jsx("span",{children:o.report_type})]}),e.jsxs("div",{style:t.detailRow,children:[e.jsx("strong",{children:"Status:"}),e.jsx("span",{style:{...t.badge,backgroundColor:C(o.status)},children:o.status})]}),e.jsxs("div",{style:t.detailRow,children:[e.jsx("strong",{children:"Severity:"}),e.jsx("span",{style:{...t.badge,backgroundColor:S(o.severity)},children:o.severity||"N/A"})]}),e.jsxs("div",{style:t.detailRow,children:[e.jsx("strong",{children:"Reporter:"}),e.jsx("span",{children:o.reporter_username})]}),e.jsxs("div",{style:t.detailRow,children:[e.jsx("strong",{children:"Reported User:"}),e.jsx("span",{children:o.reported_username||"N/A"})]}),e.jsxs("div",{style:t.detailRow,children:[e.jsx("strong",{children:"Created:"}),e.jsx("span",{children:new Date(o.created_at).toLocaleString()})]}),e.jsxs("div",{style:t.detailSection,children:[e.jsx("strong",{children:"Reason:"}),e.jsx("p",{style:t.detailText,children:o.reason})]}),e.jsxs("div",{style:t.detailSection,children:[e.jsx("strong",{children:"Description:"}),e.jsx("p",{style:t.detailText,children:o.description})]}),o.message_content&&e.jsxs("div",{style:t.detailSection,children:[e.jsx("strong",{children:"Reported Message:"}),e.jsx("div",{style:t.messageBox,children:o.message_content})]}),o.moderator_notes&&e.jsxs("div",{style:t.detailSection,children:[e.jsx("strong",{children:"Moderator Notes:"}),e.jsx("p",{style:t.detailText,children:o.moderator_notes})]})]}),o.status==="pending"&&e.jsxs("div",{style:t.modalActions,children:[e.jsxs("button",{onClick:()=>{const s=prompt("Resolution notes (optional):");x(o.id,"resolve",s||"")},style:t.actionBtn,children:[e.jsx(R,{})," Resolve"]}),o.message_id&&e.jsxs("button",{onClick:()=>{window.confirm("Delete this message?")&&x(o.id,"delete_message")},style:{...t.actionBtn,backgroundColor:"#ed4245"},children:[e.jsx(P,{})," Delete Message"]}),o.reported_user&&e.jsxs("button",{onClick:()=>{if(window.confirm("Ban this user?")){const s=prompt("Ban reason:");s&&x(o.id,"ban_user",s)}},style:{...t.actionBtn,backgroundColor:"#a12929"},children:[e.jsx(W,{})," Ban User"]}),e.jsxs("button",{onClick:()=>{const s=prompt("Dismiss reason:");s&&x(o.id,"dismiss",s)},style:{...t.actionBtn,backgroundColor:"#72767d"},children:[e.jsx(g,{})," Dismiss"]})]})]})})]})})},t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,backdropFilter:"blur(5px)"},panel:{backgroundColor:"#2b2d31",borderRadius:"12px",width:"90%",maxWidth:"1000px",maxHeight:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.5)",overflow:"hidden"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #1e1f22"},headerLeft:{display:"flex",alignItems:"center",gap:"12px"},headerIcon:{fontSize:"24px",color:"#f0b132"},title:{margin:0,color:"#fff",fontSize:"24px",fontWeight:"600"},closeButton:{background:"none",border:"none",color:"#b9bbbe",cursor:"pointer",fontSize:"24px",padding:"8px"},statsGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"16px",padding:"20px",borderBottom:"1px solid #1e1f22"},statCard:{backgroundColor:"#1e1f22",borderRadius:"8px",padding:"16px",textAlign:"center"},statIcon:{fontSize:"32px",marginBottom:"8px"},statValue:{fontSize:"28px",fontWeight:"bold",color:"#fff",marginBottom:"4px"},statLabel:{fontSize:"13px",color:"#b9bbbe"},filters:{padding:"16px 20px",borderBottom:"1px solid #1e1f22",backgroundColor:"#1e1f22"},filterGroup:{display:"flex",alignItems:"center",gap:"12px"},filterIcon:{color:"#b9bbbe",fontSize:"16px"},filterSelect:{backgroundColor:"#2b2d31",border:"1px solid #1e1f22",borderRadius:"6px",padding:"8px 12px",color:"#fff",fontSize:"14px",cursor:"pointer"},reportsList:{flex:1,overflowY:"auto",padding:"20px"},loading:{textAlign:"center",color:"#b9bbbe",padding:"40px",fontSize:"14px"},empty:{textAlign:"center",color:"#b9bbbe",padding:"60px"},emptyIcon:{fontSize:"48px",marginBottom:"16px",opacity:.5},reportCard:{backgroundColor:"#1e1f22",borderRadius:"8px",padding:"16px",marginBottom:"12px",cursor:"pointer",transition:"background-color 0.2s",":hover":{backgroundColor:"#2b2d31"}},reportHeader:{display:"flex",alignItems:"flex-start",gap:"12px",marginBottom:"12px"},reportIcon:{fontSize:"20px",color:"#f0b132",marginTop:"4px"},reportInfo:{flex:1},reportTitle:{color:"#fff",fontSize:"16px",fontWeight:"600",marginBottom:"4px"},reportMeta:{color:"#72767d",fontSize:"13px",display:"flex",gap:"8px"},reportBadges:{display:"flex",gap:"8px"},badge:{padding:"4px 8px",borderRadius:"4px",fontSize:"11px",fontWeight:"600",color:"#fff",textTransform:"uppercase"},reportContent:{paddingLeft:"32px"},reportText:{color:"#b9bbbe",fontSize:"14px",margin:"0 0 12px 0"},reportedContent:{backgroundColor:"#2b2d31",padding:"12px",borderRadius:"6px",borderLeft:"3px solid #ed4245",marginBottom:"12px"},reportedUser:{display:"flex",alignItems:"center",gap:"8px",color:"#b9bbbe",fontSize:"13px"},modalOverlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10001},modal:{backgroundColor:"#2b2d31",borderRadius:"12px",width:"90%",maxWidth:"600px",maxHeight:"80vh",display:"flex",flexDirection:"column",overflow:"hidden"},modalHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #1e1f22"},modalTitle:{margin:0,color:"#fff",fontSize:"20px",fontWeight:"600"},modalClose:{background:"none",border:"none",color:"#b9bbbe",cursor:"pointer",fontSize:"20px"},modalContent:{flex:1,overflowY:"auto",padding:"20px"},detailRow:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 0",borderBottom:"1px solid #1e1f22",color:"#fff",fontSize:"14px"},detailSection:{marginTop:"20px"},detailText:{color:"#b9bbbe",fontSize:"14px",marginTop:"8px",lineHeight:"1.5"},messageBox:{backgroundColor:"#1e1f22",padding:"12px",borderRadius:"6px",borderLeft:"3px solid #ed4245",color:"#fff",fontSize:"14px",marginTop:"8px"},modalActions:{display:"flex",gap:"12px",padding:"16px 20px",borderTop:"1px solid #1e1f22",flexWrap:"wrap"},actionBtn:{flex:1,backgroundColor:"#43b581",color:"#fff",border:"none",borderRadius:"6px",padding:"10px 16px",cursor:"pointer",fontSize:"14px",fontWeight:"600",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",minWidth:"120px"}};export{Y as default};
