import{r as t,n as e}from"./react-core-BMiyQWF6.js";import{y as r}from"./ui-vendor-6RMGJYFH.js";import{g as $}from"./index-CiuOrqQ3.js";import"./editor-vendor-D9c4a6XZ.js";import"./media-vendor-BuSyE8vR.js";import"./router-vendor-B86Z1mIL.js";import"./icons-vendor-GUGjkvMm.js";import"./state-vendor-CAyNnPM4.js";import"./crypto-vendor-1Q6e4ZD-.js";const H=({serverId:n,onClose:m})=>{const[a,l]=t.useState({welcome_enabled:!1,welcome_channel_id:"",welcome_message:"HoÅŸ geldin {user}! {server} sunucusuna katÄ±ldÄ±n!",welcome_embed:!1,welcome_embed_color:"#5865f2",welcome_embed_title:"HoÅŸ Geldin!",welcome_embed_description:"{user} sunucuya katÄ±ldÄ±!",welcome_dm:!1,welcome_dm_message:"Merhaba {user}! {server} sunucusuna hoÅŸ geldin!",goodbye_enabled:!1,goodbye_channel_id:"",goodbye_message:"{user} sunucudan ayrÄ±ldÄ±. HoÅŸÃ§a kal!",goodbye_embed:!1,goodbye_embed_color:"#ed4245",auto_role_enabled:!1,auto_role_ids:[]}),[h,x]=t.useState([]),[j,_]=t.useState([]),[i,p]=t.useState(null),[w,f]=t.useState(!0),[K,M]=t.useState(null),d=$();t.useEffect(()=>{n&&(v(),y(),k(),b())},[n]);const v=async()=>{try{const s=localStorage.getItem("access_token"),c=await fetch(`${d}/welcome-messages/server/${n}/`,{headers:{Authorization:`Bearer ${s}`}});if(c.ok){const o=await c.json();o.config&&l(o.config)}}catch{}finally{f(!1)}},y=async()=>{try{const s=localStorage.getItem("access_token"),c=await fetch(`${d}/servers/${n}/channels/`,{headers:{Authorization:`Bearer ${s}`}});if(c.ok){const o=await c.json();x(o.channels||[])}}catch{}},k=async()=>{try{const s=localStorage.getItem("access_token"),c=await fetch(`${d}/servers/${n}/roles/`,{headers:{Authorization:`Bearer ${s}`}});if(c.ok){const o=await c.json();_(o.roles||[])}}catch{}},b=async()=>{try{const s=localStorage.getItem("access_token"),c=await fetch(`${d}/welcome-messages/server/${n}/stats/`,{headers:{Authorization:`Bearer ${s}`}});if(c.ok){const o=await c.json();p(o)}}catch{}},N=async()=>{try{const s=localStorage.getItem("access_token");(await fetch(`${d}/welcome-messages/server/${n}/update/`,{method:"POST",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},body:JSON.stringify(a)})).ok?(r.success("âœ… KarÅŸÄ±lama ayarlarÄ± kaydedildi"),b()):r.error("âŒ Kaydetme baÅŸarÄ±sÄ±z")}catch{r.error("âŒ Kaydetme baÅŸarÄ±sÄ±z")}},C=async()=>{try{const s=localStorage.getItem("access_token");(await fetch(`${d}/welcome-messages/server/${n}/test/`,{method:"POST",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},body:JSON.stringify({type:"welcome"})})).ok?r.success("âœ… Test mesajÄ± gÃ¶nderildi"):r.error("âŒ Test mesajÄ± gÃ¶nderilemedi")}catch{r.error("âŒ Test baÅŸarÄ±sÄ±z")}},g=(s,c)=>{l({...a,[s]:a[s]+` ${c}`})},u=[{code:"{user}",desc:"KullanÄ±cÄ± adÄ±"},{code:"{user_mention}",desc:"KullanÄ±cÄ± mention"},{code:"{server}",desc:"Sunucu adÄ±"},{code:"{member_count}",desc:"Ãœye sayÄ±sÄ±"},{code:"{user_id}",desc:"KullanÄ±cÄ± ID"}];return w?e.jsx("div",{className:"welcome-messages-overlay",children:e.jsx("div",{className:"welcome-messages-panel",children:e.jsxs("div",{className:"loading-state",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{children:"KarÅŸÄ±lama mesajlarÄ± yÃ¼kleniyor..."})]})})}):e.jsx("div",{className:"welcome-messages-overlay",onClick:m,children:e.jsxs("div",{className:"welcome-messages-panel",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"welcome-header",children:[e.jsx("h2",{children:"ğŸ‘‹ KarÅŸÄ±lama & Veda MesajlarÄ±"}),e.jsx("button",{className:"close-btn",onClick:m,children:"Ã—"})]}),i&&e.jsxs("div",{className:"stats-overview",children:[e.jsxs("div",{className:"stat-card",children:[e.jsx("span",{className:"stat-icon",children:"ğŸ‘‹"}),e.jsx("span",{className:"stat-value",children:i.total_welcomes||0}),e.jsx("span",{className:"stat-label",children:"Toplam KarÅŸÄ±lama"})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("span",{className:"stat-icon",children:"ğŸ˜¢"}),e.jsx("span",{className:"stat-value",children:i.total_goodbyes||0}),e.jsx("span",{className:"stat-label",children:"Toplam Veda"})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("span",{className:"stat-icon",children:"ğŸ“…"}),e.jsx("span",{className:"stat-value",children:i.welcomes_today||0}),e.jsx("span",{className:"stat-label",children:"BugÃ¼n KatÄ±lan"})]})]}),e.jsxs("div",{className:"config-content",children:[e.jsxs("div",{className:"config-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h3",{children:"ğŸ‘‹ HoÅŸ Geldin MesajlarÄ±"}),e.jsxs("label",{className:"toggle-switch",children:[e.jsx("input",{type:"checkbox",checked:a.welcome_enabled,onChange:s=>l({...a,welcome_enabled:s.target.checked})}),e.jsx("span",{className:"slider"}),e.jsx("span",{className:"toggle-label",children:a.welcome_enabled?"Aktif":"Pasif"})]})]}),e.jsxs("div",{className:"form-grid",children:[e.jsxs("div",{className:"form-group full-width",children:[e.jsx("label",{children:"KarÅŸÄ±lama KanalÄ±"}),e.jsxs("select",{value:a.welcome_channel_id,onChange:s=>l({...a,welcome_channel_id:s.target.value}),disabled:!a.welcome_enabled,children:[e.jsx("option",{value:"",children:"Kanal seÃ§in"}),h.map(s=>e.jsxs("option",{value:s.id,children:["#",s.name]},s.id))]})]}),e.jsxs("div",{className:"form-group full-width",children:[e.jsx("label",{children:"HoÅŸ Geldin MesajÄ±"}),e.jsx("textarea",{value:a.welcome_message,onChange:s=>l({...a,welcome_message:s.target.value}),disabled:!a.welcome_enabled,rows:"3"}),e.jsx("div",{className:"variables-bar",children:u.map(s=>e.jsx("button",{className:"variable-btn",onClick:()=>g("welcome_message",s.code),disabled:!a.welcome_enabled,title:s.desc,children:s.code},s.code))})]}),e.jsx("div",{className:"form-group",children:e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:a.welcome_embed,onChange:s=>l({...a,welcome_embed:s.target.checked}),disabled:!a.welcome_enabled}),e.jsx("span",{children:"Embed olarak gÃ¶nder"})]})}),a.welcome_embed&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Embed Rengi"}),e.jsx("input",{type:"color",value:a.welcome_embed_color,onChange:s=>l({...a,welcome_embed_color:s.target.value}),disabled:!a.welcome_enabled})]}),e.jsxs("div",{className:"form-group full-width",children:[e.jsx("label",{children:"Embed BaÅŸlÄ±k"}),e.jsx("input",{type:"text",value:a.welcome_embed_title,onChange:s=>l({...a,welcome_embed_title:s.target.value}),disabled:!a.welcome_enabled})]}),e.jsxs("div",{className:"form-group full-width",children:[e.jsx("label",{children:"Embed AÃ§Ä±klama"}),e.jsx("textarea",{value:a.welcome_embed_description,onChange:s=>l({...a,welcome_embed_description:s.target.value}),disabled:!a.welcome_enabled,rows:"3"})]})]}),e.jsx("div",{className:"form-group full-width",children:e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:a.welcome_dm,onChange:s=>l({...a,welcome_dm:s.target.checked}),disabled:!a.welcome_enabled}),e.jsx("span",{children:"KullanÄ±cÄ±ya DM gÃ¶nder"})]})}),a.welcome_dm&&e.jsxs("div",{className:"form-group full-width",children:[e.jsx("label",{children:"DM MesajÄ±"}),e.jsx("textarea",{value:a.welcome_dm_message,onChange:s=>l({...a,welcome_dm_message:s.target.value}),disabled:!a.welcome_enabled,rows:"3"})]})]}),e.jsx("button",{className:"test-btn",onClick:C,disabled:!a.welcome_enabled,children:"ğŸ§ª Test Et"})]}),e.jsxs("div",{className:"config-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h3",{children:"ğŸ˜¢ Veda MesajlarÄ±"}),e.jsxs("label",{className:"toggle-switch",children:[e.jsx("input",{type:"checkbox",checked:a.goodbye_enabled,onChange:s=>l({...a,goodbye_enabled:s.target.checked})}),e.jsx("span",{className:"slider"}),e.jsx("span",{className:"toggle-label",children:a.goodbye_enabled?"Aktif":"Pasif"})]})]}),e.jsxs("div",{className:"form-grid",children:[e.jsxs("div",{className:"form-group full-width",children:[e.jsx("label",{children:"Veda KanalÄ±"}),e.jsxs("select",{value:a.goodbye_channel_id,onChange:s=>l({...a,goodbye_channel_id:s.target.value}),disabled:!a.goodbye_enabled,children:[e.jsx("option",{value:"",children:"Kanal seÃ§in"}),h.map(s=>e.jsxs("option",{value:s.id,children:["#",s.name]},s.id))]})]}),e.jsxs("div",{className:"form-group full-width",children:[e.jsx("label",{children:"Veda MesajÄ±"}),e.jsx("textarea",{value:a.goodbye_message,onChange:s=>l({...a,goodbye_message:s.target.value}),disabled:!a.goodbye_enabled,rows:"3"}),e.jsx("div",{className:"variables-bar",children:u.map(s=>e.jsx("button",{className:"variable-btn",onClick:()=>g("goodbye_message",s.code),disabled:!a.goodbye_enabled,title:s.desc,children:s.code},s.code))})]}),e.jsx("div",{className:"form-group",children:e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:a.goodbye_embed,onChange:s=>l({...a,goodbye_embed:s.target.checked}),disabled:!a.goodbye_enabled}),e.jsx("span",{children:"Embed olarak gÃ¶nder"})]})}),a.goodbye_embed&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Embed Rengi"}),e.jsx("input",{type:"color",value:a.goodbye_embed_color,onChange:s=>l({...a,goodbye_embed_color:s.target.value}),disabled:!a.goodbye_enabled})]})]})]}),e.jsxs("div",{className:"config-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h3",{children:"â­ Otomatik Rol"}),e.jsxs("label",{className:"toggle-switch",children:[e.jsx("input",{type:"checkbox",checked:a.auto_role_enabled,onChange:s=>l({...a,auto_role_enabled:s.target.checked})}),e.jsx("span",{className:"slider"}),e.jsx("span",{className:"toggle-label",children:a.auto_role_enabled?"Aktif":"Pasif"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Otomatik verilecek roller"}),e.jsx("div",{className:"roles-selector",children:j.map(s=>e.jsxs("label",{className:"role-checkbox",children:[e.jsx("input",{type:"checkbox",checked:a.auto_role_ids.includes(s.id),onChange:c=>{const o=c.target.checked?[...a.auto_role_ids,s.id]:a.auto_role_ids.filter(S=>S!==s.id);l({...a,auto_role_ids:o})},disabled:!a.auto_role_enabled}),e.jsx("span",{children:s.name})]},s.id))})]})]}),e.jsx("button",{className:"save-btn",onClick:N,children:"ğŸ’¾ AyarlarÄ± Kaydet"})]})]})})};export{H as default};
