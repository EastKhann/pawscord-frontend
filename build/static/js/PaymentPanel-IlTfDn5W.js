import{r as a,n as e}from"./react-core-zXIKm1Jm.js";import{U as W,a as F,au as l,bF as h,b1 as L,A as _}from"./icons-vendor-BBdoVeJd.js";import{t as i}from"./index-V-uT6Vi8.js";import"./editor-vendor-DiU449Dh.js";import"./media-vendor-BSOZ7IB3.js";import"./router-vendor-PJALNo1v.js";import"./crypto-vendor-D_AcF0lD.js";import"./state-vendor-8NbFPBhQ.js";const J=({fetchWithAuth:p,apiBaseUrl:x,onClose:j,username:$})=>{const[c,d]=a.useState("balance"),[y,B]=a.useState(0),[v,P]=a.useState([]),[I,R]=a.useState(!0),[s,D]=a.useState(100),[r,b]=a.useState("stripe"),[f,C]=a.useState(""),[g,S]=a.useState(""),[T,k]=a.useState("");a.useEffect(()=>{w(),z()},[]);const w=async()=>{try{const o=await(await p(`${x}/users/balance/`)).json();B(o.balance||0)}catch(n){console.error("Failed to load balance:",n),i.error("Failed to load balance")}finally{R(!1)}},z=async()=>{try{const o=await(await p(`${x}/payments/history/`)).json();P(o.transactions||[])}catch(n){console.error("Failed to load transactions:",n)}},A=async()=>{if(s<100){i.error("Minimum purchase is 100 coins");return}if(!r){i.error("Please select a payment method");return}try{const n=await p(`${x}/payments/coins/purchase/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({coin_amount:parseInt(s),payment_method:r})});if(!n.ok){const u=await n.json();throw new Error(u.error||"Payment failed")}const o=await n.json();o.success?o.redirect_url?(i.info("Redirecting to payment page..."),window.location.href=o.redirect_url):o.payment_page_url?(i.info("Redirecting to payment page..."),window.location.href=o.payment_page_url):i.success("Payment initiated!"):i.error(o.error||"Payment failed")}catch(n){console.error("Payment error:",n),i.error(n.message||"Payment processing failed")}},M=async()=>{if(!f||!g){i.error("Please fill in all fields");return}const n=parseInt(g);if(n<=0||n>y){i.error("Invalid transfer amount");return}try{const u=await(await p(`${x}/coins/transfer/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({recipient:f,amount:n,note:T})})).json();u.success?(i.success(`Transferred ${n} coins to ${f}`),w(),z(),C(""),S(""),k(""),d("balance")):i.error(u.error||"Transfer failed")}catch(o){console.error("Transfer error:",o),i.error("Transfer failed")}},m=[{amount:100,price:.99,bonus:0},{amount:500,price:4.99,bonus:50},{amount:1e3,price:9.99,bonus:150},{amount:2500,price:19.99,bonus:500},{amount:5e3,price:39.99,bonus:1e3}];return e.jsx("div",{style:t.overlay,onClick:j,children:e.jsxs("div",{style:t.modal,onClick:n=>n.stopPropagation(),children:[e.jsxs("div",{style:t.header,children:[e.jsxs("div",{style:t.headerLeft,children:[e.jsx(W,{style:{fontSize:"24px",color:"#faa61a"}}),e.jsx("h2",{style:{margin:0,fontSize:"20px"},children:"Payment Center"})]}),e.jsx("button",{onClick:j,style:t.closeBtn,children:e.jsx(F,{})})]}),e.jsxs("div",{style:t.tabs,children:[e.jsxs("button",{onClick:()=>d("balance"),style:{...t.tab,...c==="balance"&&t.activeTab},children:[e.jsx(l,{})," Balance"]}),e.jsxs("button",{onClick:()=>d("buy"),style:{...t.tab,...c==="buy"&&t.activeTab},children:[e.jsx(h,{})," Buy Coins"]}),e.jsxs("button",{onClick:()=>d("transfer"),style:{...t.tab,...c==="transfer"&&t.activeTab},children:[e.jsx(l,{})," Transfer"]}),e.jsxs("button",{onClick:()=>d("history"),style:{...t.tab,...c==="history"&&t.activeTab},children:[e.jsx(L,{})," History"]})]}),e.jsx("div",{style:t.content,children:I?e.jsx("div",{style:t.loading,children:"Loading..."}):c==="balance"?e.jsxs("div",{style:t.balanceView,children:[e.jsxs("div",{style:t.balanceCard,children:[e.jsx(l,{style:{fontSize:"48px",color:"#faa61a"}}),e.jsx("div",{style:t.balanceAmount,children:y.toLocaleString()}),e.jsx("div",{style:t.balanceLabel,children:"Current Balance"})]}),e.jsxs("div",{style:t.quickActions,children:[e.jsxs("button",{onClick:()=>d("buy"),style:t.actionBtn,children:[e.jsx(h,{})," Buy Coins"]}),e.jsxs("button",{onClick:()=>d("transfer"),style:t.actionBtn,children:[e.jsx(l,{})," Transfer Coins"]})]})]}):c==="buy"?e.jsxs("div",{style:t.buyView,children:[e.jsx("h3",{style:t.sectionTitle,children:"Choose Payment Method"}),e.jsxs("div",{style:t.paymentMethods,children:[e.jsxs("div",{onClick:()=>b("crypto"),style:{...t.paymentMethodCard,...r==="crypto"&&t.selectedPaymentMethod},children:[e.jsx("div",{style:t.pmIcon,children:"ðŸª™"}),e.jsx("div",{style:t.pmTitle,children:"Cryptocurrency"}),e.jsx("div",{style:t.pmDesc,children:"Bitcoin, Ethereum, USDC"}),e.jsx("div",{style:t.pmBadge,children:"Global â€¢ Fast"})]}),e.jsxs("div",{onClick:()=>b("stripe"),style:{...t.paymentMethodCard,...r==="stripe"&&t.selectedPaymentMethod},children:[e.jsx("div",{style:t.pmIcon,children:"ðŸ’³"}),e.jsx("div",{style:t.pmTitle,children:"Credit/Debit Card"}),e.jsx("div",{style:t.pmDesc,children:"Stripe - Visa, Mastercard"}),e.jsx("div",{style:t.pmBadge,children:"Global â€¢ Secure"})]}),e.jsxs("div",{onClick:()=>b("iyzico"),style:{...t.paymentMethodCard,...r==="iyzico"&&t.selectedPaymentMethod},children:[e.jsx("div",{style:t.pmIcon,children:"ðŸ‡¹ðŸ‡·"}),e.jsx("div",{style:t.pmTitle,children:"Turkish Payment"}),e.jsx("div",{style:t.pmDesc,children:"Ä°yzico - TL payments"}),e.jsx("div",{style:t.pmBadge,children:"Turkey â€¢ TRY"})]})]}),e.jsx("h3",{style:t.sectionTitle,children:"Select Coin Package"}),e.jsx("div",{style:t.packages,children:m.map((n,o)=>e.jsxs("div",{onClick:()=>D(n.amount),style:{...t.package,...s===n.amount&&t.selectedPackage},children:[e.jsx(l,{style:{fontSize:"32px",color:"#faa61a"}}),e.jsx("div",{style:t.pkgAmount,children:n.amount.toLocaleString()}),n.bonus>0&&e.jsxs("div",{style:t.bonus,children:["+",n.bonus," BONUS"]}),e.jsxs("div",{style:t.price,children:["$",n.price]}),s===n.amount&&e.jsx(_,{style:{position:"absolute",top:"10px",right:"10px",color:"#43b581"}})]},o))}),e.jsxs("div",{style:t.purchaseSection,children:[e.jsxs("div",{style:t.paymentInfo,children:[e.jsxs("div",{style:t.paymentInfoRow,children:[e.jsx("span",{children:"Selected Package:"}),e.jsxs("strong",{children:[s.toLocaleString()," coins"]})]}),e.jsxs("div",{style:t.paymentInfoRow,children:[e.jsx("span",{children:"Payment Method:"}),e.jsxs("strong",{children:[r==="crypto"&&"ðŸª™ Crypto",r==="stripe"&&"ðŸ’³ Card (Stripe)",r==="iyzico"&&"ðŸ‡¹ðŸ‡· Ä°yzico (TRY)"]})]}),e.jsxs("div",{style:t.paymentInfoRow,children:[e.jsx("span",{children:"Total Price:"}),e.jsx("strong",{style:{color:"#faa61a",fontSize:"18px"},children:m.find(n=>n.amount===s)?.price&&(r==="iyzico"?`â‚º${(m.find(n=>n.amount===s).price*35).toFixed(0)}`:`$${m.find(n=>n.amount===s).price}`)})]})]}),e.jsxs("button",{onClick:A,style:t.purchaseBtn,children:[e.jsx(h,{}),r==="crypto"&&" Pay with Crypto",r==="stripe"&&" Pay with Card",r==="iyzico"&&" Ä°yzico ile Ã–de"]}),e.jsxs("div",{style:t.paymentNote,children:[r==="crypto"&&"ðŸ”’ Secure cryptocurrency payment via Coinbase Commerce",r==="stripe"&&"ðŸ”’ Secure card payment via Stripe",r==="iyzico"&&"ðŸ”’ GÃ¼venli Ã¶deme - Ä°yzico ile korunur"]})]})]}):c==="transfer"?e.jsxs("div",{style:t.transferView,children:[e.jsx("h3",{style:t.sectionTitle,children:"Transfer Coins"}),e.jsxs("div",{style:t.form,children:[e.jsxs("div",{style:t.formGroup,children:[e.jsx("label",{style:t.label,children:"Recipient Username"}),e.jsx("input",{type:"text",value:f,onChange:n=>C(n.target.value),placeholder:"@username",style:t.input})]}),e.jsxs("div",{style:t.formGroup,children:[e.jsx("label",{style:t.label,children:"Amount"}),e.jsx("input",{type:"number",value:g,onChange:n=>S(n.target.value),placeholder:"0",min:"1",max:y,style:t.input}),e.jsxs("div",{style:t.hint,children:["Available: ",y," coins"]})]}),e.jsxs("div",{style:t.formGroup,children:[e.jsx("label",{style:t.label,children:"Note (Optional)"}),e.jsx("input",{type:"text",value:T,onChange:n=>k(n.target.value),placeholder:"Add a message...",style:t.input})]}),e.jsxs("button",{onClick:M,style:t.transferBtn,children:[e.jsx(l,{})," Transfer Coins"]})]})]}):e.jsxs("div",{style:t.historyView,children:[e.jsx("h3",{style:t.sectionTitle,children:"Transaction History"}),v.length===0?e.jsx("div",{style:t.empty,children:"No transactions yet"}):e.jsx("div",{style:t.transactions,children:v.map((n,o)=>e.jsxs("div",{style:t.transaction,children:[e.jsx("div",{style:t.txIcon,children:n.type==="purchase"?e.jsx(h,{style:{color:"#5865f2"}}):n.type==="transfer_sent"?e.jsx(l,{style:{color:"#f04747"}}):e.jsx(l,{style:{color:"#43b581"}})}),e.jsxs("div",{style:t.txDetails,children:[e.jsx("div",{style:t.txTitle,children:n.description}),e.jsx("div",{style:t.txDate,children:new Date(n.created_at).toLocaleString()})]}),e.jsxs("div",{style:{...t.txAmount,color:n.amount>0?"#43b581":"#f04747"},children:[n.amount>0?"+":"",n.amount]})]},o))})]})})]})})},t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999},modal:{backgroundColor:"#1e1e1e",borderRadius:"8px",width:"90%",maxWidth:"800px",maxHeight:"80vh",display:"flex",flexDirection:"column",color:"#fff"},header:{padding:"20px",borderBottom:"1px solid #444",display:"flex",justifyContent:"space-between",alignItems:"center"},headerLeft:{display:"flex",alignItems:"center",gap:"12px"},closeBtn:{background:"none",border:"none",color:"#fff",fontSize:"24px",cursor:"pointer",padding:"8px"},tabs:{display:"flex",borderBottom:"1px solid #444",padding:"0 20px"},tab:{background:"none",border:"none",color:"#99aab5",padding:"12px 20px",cursor:"pointer",fontSize:"14px",display:"flex",alignItems:"center",gap:"8px",borderBottom:"2px solid transparent",transition:"all 0.2s"},activeTab:{color:"#5865f2",borderBottomColor:"#5865f2"},content:{padding:"20px",overflowY:"auto",flex:1},loading:{textAlign:"center",padding:"40px",color:"#99aab5"},balanceView:{display:"flex",flexDirection:"column",alignItems:"center",gap:"30px"},balanceCard:{backgroundColor:"#2c2f33",borderRadius:"12px",padding:"40px",textAlign:"center",width:"100%",maxWidth:"400px",display:"flex",flexDirection:"column",alignItems:"center",gap:"16px"},balanceAmount:{fontSize:"48px",fontWeight:"bold",color:"#faa61a"},balanceLabel:{fontSize:"14px",color:"#99aab5"},quickActions:{display:"flex",gap:"12px",width:"100%",maxWidth:"400px"},actionBtn:{flex:1,padding:"12px 20px",backgroundColor:"#5865f2",border:"none",borderRadius:"6px",color:"#fff",cursor:"pointer",fontSize:"14px",fontWeight:"600",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",transition:"background 0.2s"},buyView:{display:"flex",flexDirection:"column",gap:"20px"},sectionTitle:{fontSize:"16px",fontWeight:"600",margin:0,marginBottom:"12px"},packages:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(140px, 1fr))",gap:"12px"},package:{backgroundColor:"#2c2f33",borderRadius:"8px",padding:"20px",textAlign:"center",cursor:"pointer",border:"2px solid transparent",transition:"all 0.2s",position:"relative",display:"flex",flexDirection:"column",alignItems:"center",gap:"8px"},selectedPackage:{borderColor:"#5865f2",backgroundColor:"#2c3136"},pkgAmount:{fontSize:"24px",fontWeight:"bold",color:"#faa61a"},bonus:{fontSize:"10px",color:"#43b581",fontWeight:"bold",padding:"2px 8px",backgroundColor:"rgba(67, 181, 129, 0.1)",borderRadius:"4px"},purchaseSection:{marginTop:"24px"},paymentMethods:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px",marginBottom:"32px"},paymentMethodCard:{padding:"20px",background:"#2b2d31",border:"2px solid #40444b",borderRadius:"12px",textAlign:"center",cursor:"pointer",transition:"all 0.3s ease"},selectedPaymentMethod:{background:"#5865f2",borderColor:"#5865f2",transform:"scale(1.05)",boxShadow:"0 4px 16px rgba(88, 101, 242, 0.3)"},pmIcon:{fontSize:"48px",marginBottom:"12px"},pmTitle:{fontSize:"16px",fontWeight:"600",color:"white",marginBottom:"6px"},pmDesc:{fontSize:"13px",color:"#b9bbbe",marginBottom:"8px"},pmBadge:{display:"inline-block",padding:"4px 12px",background:"#40444b",borderRadius:"12px",fontSize:"11px",color:"#43b581",fontWeight:"600"},paymentInfo:{background:"#2b2d31",borderRadius:"12px",padding:"16px",marginBottom:"16px"},paymentInfoRow:{display:"flex",justifyContent:"space-between",padding:"8px 0",fontSize:"14px",color:"#b9bbbe",borderBottom:"1px solid #40444b"},paymentNote:{textAlign:"center",fontSize:"12px",color:"#43b581",marginTop:"12px"},price:{fontSize:"18px",fontWeight:"600",color:"#fff"},label:{display:"block",fontSize:"14px",fontWeight:"600",marginBottom:"8px",color:"#dcddde"},purchaseBtn:{width:"100%",padding:"14px",backgroundColor:"#43b581",border:"none",borderRadius:"6px",color:"#fff",fontSize:"16px",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",marginTop:"12px"},transferView:{maxWidth:"500px",margin:"0 auto"},form:{display:"flex",flexDirection:"column",gap:"16px"},formGroup:{display:"flex",flexDirection:"column",gap:"8px"},input:{padding:"10px",backgroundColor:"#2c2f33",border:"1px solid #444",borderRadius:"4px",color:"#fff",fontSize:"14px"},hint:{fontSize:"12px",color:"#99aab5"},transferBtn:{width:"100%",padding:"14px",backgroundColor:"#5865f2",border:"none",borderRadius:"6px",color:"#fff",fontSize:"16px",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",marginTop:"12px"},historyView:{display:"flex",flexDirection:"column",gap:"16px"},transactions:{display:"flex",flexDirection:"column",gap:"8px"},transaction:{backgroundColor:"#2c2f33",borderRadius:"6px",padding:"16px",display:"flex",alignItems:"center",gap:"12px"},txIcon:{fontSize:"24px",display:"flex",alignItems:"center",justifyContent:"center"},txDetails:{flex:1},txTitle:{fontSize:"14px",fontWeight:"600"},txDate:{fontSize:"12px",color:"#99aab5",marginTop:"4px"},txAmount:{fontSize:"18px",fontWeight:"bold"},empty:{textAlign:"center",padding:"40px",color:"#99aab5"}};export{J as default};
