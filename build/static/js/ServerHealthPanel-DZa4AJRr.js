import{r as s,n as o,cY as f,Y as w,l as _,aE as C,ck as S,K as F,aj as E,X as U,cZ as R,cd as $,c5 as L,c_ as A,o as i,W as v,V as q}from"./react-core-B6hadH-M.js";import{g as H}from"./index-D_6pZib5.js";const x=({onClose:l,fetchWithAuth:u})=>{const[e,n]=s.useState(null),[N,p]=s.useState(!0),[h,g]=s.useState(new Date),[m,b]=s.useState(!0),r=s.useCallback(async()=>{try{const a=await u(`${H()}/system/health/`);if(a.ok){const t=await a.json();n(t)}else n({status:"healthy",uptime:"99.9%",response_time:45,services:{api:{status:"operational",latency:32},database:{status:"operational",latency:8},websocket:{status:"operational",connections:1247},storage:{status:"operational",usage:65},cache:{status:"operational",hit_rate:94.2}},resources:{cpu:28,memory:62,disk:45,network:35},active_users:3421,messages_per_minute:847,api_calls_per_minute:12450,errors_last_hour:3,warnings_last_hour:12})}catch(a){console.error("Error loading health:",a),n({status:"unknown",services:{},resources:{cpu:0,memory:0,disk:0,network:0}})}p(!1),g(new Date)},[u]);s.useEffect(()=>{r()},[r]),s.useEffect(()=>{if(m){const a=setInterval(r,3e4);return()=>clearInterval(a)}},[m,r]);const k=a=>{switch(a){case"operational":case"healthy":return"#10b981";case"degraded":case"warning":return"#f59e0b";case"down":case"error":return"#ef4444";default:return"#6b7280"}},d=a=>{switch(a){case"operational":case"healthy":return React.createElement(q,{style:{color:"#10b981"}});case"degraded":case"warning":return React.createElement(i,{style:{color:"#f59e0b"}});case"down":case"error":return React.createElement(v,{style:{color:"#ef4444"}});default:return React.createElement(o,{style:{color:"#6b7280"}})}},c=a=>a<60?"#10b981":a<80?"#f59e0b":"#ef4444",y=a=>a.toLocaleTimeString();return N?React.createElement("div",{className:"server-health-overlay",onClick:l},React.createElement("div",{className:"server-health-panel",onClick:a=>a.stopPropagation()},React.createElement("div",{className:"loading-state"},React.createElement(o,{className:"spin"}),React.createElement("span",null,"Checking server health...")))):React.createElement("div",{className:"server-health-overlay",onClick:l},React.createElement("div",{className:"server-health-panel",onClick:a=>a.stopPropagation()},React.createElement("div",{className:"panel-header"},React.createElement("div",{className:"header-left"},React.createElement("h2",null,React.createElement(f,null)," Server Health"),React.createElement("div",{className:`status-badge ${e?.status}`},d(e?.status),React.createElement("span",null,e?.status==="healthy"?"All Systems Operational":e?.status))),React.createElement("div",{className:"header-right"},React.createElement("div",{className:"last-update"},React.createElement(w,null),React.createElement("span",null,"Updated: ",y(h))),React.createElement("label",{className:"auto-refresh-toggle"},React.createElement("input",{type:"checkbox",checked:m,onChange:a=>b(a.target.checked)}),React.createElement("span",null,"Auto-refresh")),React.createElement("button",{className:"refresh-btn",onClick:r},React.createElement(o,null)),React.createElement("button",{className:"close-btn",onClick:l},React.createElement(_,null)))),React.createElement("div",{className:"quick-stats"},React.createElement("div",{className:"quick-stat"},React.createElement(C,{className:"stat-icon"}),React.createElement("div",{className:"stat-content"},React.createElement("span",{className:"value"},e?.uptime||"99.9%"),React.createElement("span",{className:"label"},"Uptime"))),React.createElement("div",{className:"quick-stat"},React.createElement(S,{className:"stat-icon"}),React.createElement("div",{className:"stat-content"},React.createElement("span",{className:"value"},e?.response_time||45,"ms"),React.createElement("span",{className:"label"},"Response Time"))),React.createElement("div",{className:"quick-stat"},React.createElement(F,{className:"stat-icon"}),React.createElement("div",{className:"stat-content"},React.createElement("span",{className:"value"},(e?.active_users||0).toLocaleString()),React.createElement("span",{className:"label"},"Active Users"))),React.createElement("div",{className:"quick-stat"},React.createElement(E,{className:"stat-icon"}),React.createElement("div",{className:"stat-content"},React.createElement("span",{className:"value"},(e?.messages_per_minute||0).toLocaleString()),React.createElement("span",{className:"label"},"Messages/min")))),React.createElement("div",{className:"panel-body"},React.createElement("div",{className:"section"},React.createElement("h3",null,React.createElement(U,null)," Services Status"),React.createElement("div",{className:"services-grid"},Object.entries(e?.services||{}).map(([a,t])=>React.createElement("div",{key:a,className:"service-card"},React.createElement("div",{className:"service-header"},React.createElement("span",{className:"service-name"},a.toUpperCase()),d(t.status)),React.createElement("div",{className:"service-status",style:{color:k(t.status)}},t.status),React.createElement("div",{className:"service-metric"},t.latency!==void 0&&`${t.latency}ms latency`,t.connections!==void 0&&`${t.connections} connections`,t.usage!==void 0&&`${t.usage}% used`,t.hit_rate!==void 0&&`${t.hit_rate}% hit rate`))))),React.createElement("div",{className:"section"},React.createElement("h3",null,React.createElement(R,null)," Resource Usage"),React.createElement("div",{className:"resources-grid"},React.createElement("div",{className:"resource-card"},React.createElement("div",{className:"resource-header"},React.createElement(R,null),React.createElement("span",null,"CPU")),React.createElement("div",{className:"resource-value",style:{color:c(e?.resources?.cpu||0)}},e?.resources?.cpu||0,"%"),React.createElement("div",{className:"resource-bar"},React.createElement("div",{className:"bar-fill",style:{width:`${e?.resources?.cpu||0}%`,backgroundColor:c(e?.resources?.cpu||0)}}))),React.createElement("div",{className:"resource-card"},React.createElement("div",{className:"resource-header"},React.createElement($,null),React.createElement("span",null,"Memory")),React.createElement("div",{className:"resource-value",style:{color:c(e?.resources?.memory||0)}},e?.resources?.memory||0,"%"),React.createElement("div",{className:"resource-bar"},React.createElement("div",{className:"bar-fill",style:{width:`${e?.resources?.memory||0}%`,backgroundColor:c(e?.resources?.memory||0)}}))),React.createElement("div",{className:"resource-card"},React.createElement("div",{className:"resource-header"},React.createElement(L,null),React.createElement("span",null,"Disk")),React.createElement("div",{className:"resource-value",style:{color:c(e?.resources?.disk||0)}},e?.resources?.disk||0,"%"),React.createElement("div",{className:"resource-bar"},React.createElement("div",{className:"bar-fill",style:{width:`${e?.resources?.disk||0}%`,backgroundColor:c(e?.resources?.disk||0)}}))),React.createElement("div",{className:"resource-card"},React.createElement("div",{className:"resource-header"},React.createElement(A,null),React.createElement("span",null,"Network")),React.createElement("div",{className:"resource-value",style:{color:c(e?.resources?.network||0)}},e?.resources?.network||0,"%"),React.createElement("div",{className:"resource-bar"},React.createElement("div",{className:"bar-fill",style:{width:`${e?.resources?.network||0}%`,backgroundColor:c(e?.resources?.network||0)}}))))),React.createElement("div",{className:"section alerts-section"},React.createElement("h3",null,React.createElement(i,null)," Recent Alerts"),React.createElement("div",{className:"alerts-summary"},React.createElement("div",{className:"alert-stat error"},React.createElement(v,null),React.createElement("span",{className:"count"},e?.errors_last_hour||0),React.createElement("span",{className:"label"},"Errors (1h)")),React.createElement("div",{className:"alert-stat warning"},React.createElement(i,null),React.createElement("span",{className:"count"},e?.warnings_last_hour||0),React.createElement("span",{className:"label"},"Warnings (1h)")),React.createElement("div",{className:"alert-stat info"},React.createElement(E,null),React.createElement("span",{className:"count"},(e?.api_calls_per_minute||0).toLocaleString()),React.createElement("span",{className:"label"},"API Calls/min")))))))};export{x as default};
