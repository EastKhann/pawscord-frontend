import{r as D,a as u,n as y}from"./react-core-Cj7FUMmY.js";import"./editor-vendor-D9c4a6XZ.js";var j=Object.defineProperty,K=(c,t,e)=>t in c?j(c,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):c[t]=e,m=(c,t,e)=>K(c,typeof t!="symbol"?t+"":t,e);const Y={x:0,y:0,width:0,height:0,unit:"px"},S=(c,t,e)=>Math.min(Math.max(c,t),e),I=(...c)=>c.filter(t=>t&&typeof t=="string").join(" "),X=(c,t)=>c===t||c.width===t.width&&c.height===t.height&&c.x===t.x&&c.y===t.y&&c.unit===t.unit;function H(c,t,e){return c.unit==="%"?{...Y,...c,unit:"%"}:{unit:"%",x:c.x?c.x/t*100:0,y:c.y?c.y/e*100:0,width:c.width?c.width/t*100:0,height:c.height?c.height/e*100:0}}function k(c,t,e){return c.unit?c.unit==="px"?{...Y,...c,unit:"px"}:{unit:"px",x:c.x?c.x*t/100:0,y:c.y?c.y*e/100:0,width:c.width?c.width*t/100:0,height:c.height?c.height*e/100:0}:{...Y,...c,unit:"px"}}function _(c,t,e,a,i,n=0,h=0,l=a,s=i){const r={...c};let d=Math.min(n,a),p=Math.min(h,i),w=Math.min(l,a),o=Math.min(s,i);t&&(t>1?(d=h?h*t:d,p=d/t,w=l*t):(p=n?n/t:p,d=p*t,o=s/t)),r.y<0&&(r.height=Math.max(r.height+r.y,p),r.y=0),r.x<0&&(r.width=Math.max(r.width+r.x,d),r.x=0);const g=a-(r.x+r.width);g<0&&(r.x=Math.min(r.x,a-d),r.width+=g);const x=i-(r.y+r.height);if(x<0&&(r.y=Math.min(r.y,i-p),r.height+=x),r.width<d&&((e==="sw"||e=="nw")&&(r.x-=d-r.width),r.width=d),r.height<p&&((e==="nw"||e=="ne")&&(r.y-=p-r.height),r.height=p),r.width>w&&((e==="sw"||e=="nw")&&(r.x-=w-r.width),r.width=w),r.height>o&&((e==="nw"||e=="ne")&&(r.y-=o-r.height),r.height=o),t){const v=r.width/r.height;if(v<t){const C=Math.max(r.width/t,p);(e==="nw"||e=="ne")&&(r.y-=C-r.height),r.height=C}else if(v>t){const C=Math.max(r.height*t,d);(e==="sw"||e=="nw")&&(r.x-=C-r.width),r.width=C}}return r}function A(c,t,e,a){const i={...c};return t==="ArrowLeft"?a==="nw"?(i.x-=e,i.y-=e,i.width+=e,i.height+=e):a==="w"?(i.x-=e,i.width+=e):a==="sw"?(i.x-=e,i.width+=e,i.height+=e):a==="ne"?(i.y+=e,i.width-=e,i.height-=e):a==="e"?i.width-=e:a==="se"&&(i.width-=e,i.height-=e):t==="ArrowRight"&&(a==="nw"?(i.x+=e,i.y+=e,i.width-=e,i.height-=e):a==="w"?(i.x+=e,i.width-=e):a==="sw"?(i.x+=e,i.width-=e,i.height-=e):a==="ne"?(i.y-=e,i.width+=e,i.height+=e):a==="e"?i.width+=e:a==="se"&&(i.width+=e,i.height+=e)),t==="ArrowUp"?a==="nw"?(i.x-=e,i.y-=e,i.width+=e,i.height+=e):a==="n"?(i.y-=e,i.height+=e):a==="ne"?(i.y-=e,i.width+=e,i.height+=e):a==="sw"?(i.x+=e,i.width-=e,i.height-=e):a==="s"?i.height-=e:a==="se"&&(i.width-=e,i.height-=e):t==="ArrowDown"&&(a==="nw"?(i.x+=e,i.y+=e,i.width-=e,i.height-=e):a==="n"?(i.y+=e,i.height-=e):a==="ne"?(i.y+=e,i.width-=e,i.height-=e):a==="sw"?(i.x-=e,i.width+=e,i.height+=e):a==="s"?i.height+=e:a==="se"&&(i.width+=e,i.height+=e)),i}const N={capture:!0,passive:!1};let B=0;const E=class b extends D.PureComponent{constructor(){super(...arguments),m(this,"docMoveBound",!1),m(this,"mouseDownOnCrop",!1),m(this,"dragStarted",!1),m(this,"evData",{startClientX:0,startClientY:0,startCropX:0,startCropY:0,clientX:0,clientY:0,isResize:!0}),m(this,"componentRef",D.createRef()),m(this,"mediaRef",D.createRef()),m(this,"resizeObserver"),m(this,"initChangeCalled",!1),m(this,"instanceId",`rc-${B++}`),m(this,"state",{cropIsActive:!1,newCropIsBeingDrawn:!1}),m(this,"onCropPointerDown",t=>{const{crop:e,disabled:a}=this.props,i=this.getBox();if(!e)return;const n=k(e,i.width,i.height);if(a)return;t.cancelable&&t.preventDefault(),this.bindDocMove(),this.componentRef.current.focus({preventScroll:!0});const h=t.target.dataset.ord,l=!!h;let s=t.clientX,r=t.clientY,d=n.x,p=n.y;if(h){const w=t.clientX-i.x,o=t.clientY-i.y;let g=0,x=0;h==="ne"||h=="e"?(g=w-(n.x+n.width),x=o-n.y,d=n.x,p=n.y+n.height):h==="se"||h==="s"?(g=w-(n.x+n.width),x=o-(n.y+n.height),d=n.x,p=n.y):h==="sw"||h=="w"?(g=w-n.x,x=o-(n.y+n.height),d=n.x+n.width,p=n.y):(h==="nw"||h=="n")&&(g=w-n.x,x=o-n.y,d=n.x+n.width,p=n.y+n.height),s=d+i.x+g,r=p+i.y+x}this.evData={startClientX:s,startClientY:r,startCropX:d,startCropY:p,clientX:t.clientX,clientY:t.clientY,isResize:l,ord:h},this.mouseDownOnCrop=!0,this.setState({cropIsActive:!0})}),m(this,"onComponentPointerDown",t=>{const{crop:e,disabled:a,locked:i,keepSelection:n,onChange:h}=this.props,l=this.getBox();if(a||i||n&&e)return;t.cancelable&&t.preventDefault(),this.bindDocMove(),this.componentRef.current.focus({preventScroll:!0});const s=t.clientX-l.x,r=t.clientY-l.y,d={unit:"px",x:s,y:r,width:0,height:0};this.evData={startClientX:t.clientX,startClientY:t.clientY,startCropX:s,startCropY:r,clientX:t.clientX,clientY:t.clientY,isResize:!0},this.mouseDownOnCrop=!0,h(k(d,l.width,l.height),H(d,l.width,l.height)),this.setState({cropIsActive:!0,newCropIsBeingDrawn:!0})}),m(this,"onDocPointerMove",t=>{const{crop:e,disabled:a,onChange:i,onDragStart:n}=this.props,h=this.getBox();if(a||!e||!this.mouseDownOnCrop)return;t.cancelable&&t.preventDefault(),this.dragStarted||(this.dragStarted=!0,n&&n(t));const{evData:l}=this;l.clientX=t.clientX,l.clientY=t.clientY;let s;l.isResize?s=this.resizeCrop():s=this.dragCrop(),X(e,s)||i(k(s,h.width,h.height),H(s,h.width,h.height))}),m(this,"onComponentKeyDown",t=>{const{crop:e,disabled:a,onChange:i,onComplete:n}=this.props;if(a)return;const h=t.key;let l=!1;if(!e)return;const s=this.getBox(),r=this.makePixelCrop(s),d=(navigator.platform.match("Mac")?t.metaKey:t.ctrlKey)?b.nudgeStepLarge:t.shiftKey?b.nudgeStepMedium:b.nudgeStep;if(h==="ArrowLeft"?(r.x-=d,l=!0):h==="ArrowRight"?(r.x+=d,l=!0):h==="ArrowUp"?(r.y-=d,l=!0):h==="ArrowDown"&&(r.y+=d,l=!0),l){t.cancelable&&t.preventDefault(),r.x=S(r.x,0,s.width-r.width),r.y=S(r.y,0,s.height-r.height);const p=k(r,s.width,s.height),w=H(r,s.width,s.height);i(p,w),n&&n(p,w)}}),m(this,"onHandlerKeyDown",(t,e)=>{const{aspect:a=0,crop:i,disabled:n,minWidth:h=0,minHeight:l=0,maxWidth:s,maxHeight:r,onChange:d,onComplete:p}=this.props,w=this.getBox();if(n||!i)return;if(t.key==="ArrowUp"||t.key==="ArrowDown"||t.key==="ArrowLeft"||t.key==="ArrowRight")t.stopPropagation(),t.preventDefault();else return;const o=(navigator.platform.match("Mac")?t.metaKey:t.ctrlKey)?b.nudgeStepLarge:t.shiftKey?b.nudgeStepMedium:b.nudgeStep,g=k(i,w.width,w.height),x=A(g,t.key,o,e),v=_(x,a,e,w.width,w.height,h,l,s,r);if(!X(i,v)){const C=H(v,w.width,w.height);d(v,C),p&&p(v,C)}}),m(this,"onDocPointerDone",t=>{const{crop:e,disabled:a,onComplete:i,onDragEnd:n}=this.props,h=this.getBox();this.unbindDocMove(),!(a||!e)&&this.mouseDownOnCrop&&(this.mouseDownOnCrop=!1,this.dragStarted=!1,n&&n(t),i&&i(k(e,h.width,h.height),H(e,h.width,h.height)),this.setState({cropIsActive:!1,newCropIsBeingDrawn:!1}))}),m(this,"onDragFocus",()=>{var t;(t=this.componentRef.current)==null||t.scrollTo(0,0)})}get document(){return document}getBox(){const t=this.mediaRef.current;if(!t)return{x:0,y:0,width:0,height:0};const{x:e,y:a,width:i,height:n}=t.getBoundingClientRect();return{x:e,y:a,width:i,height:n}}componentDidUpdate(t){const{crop:e,onComplete:a}=this.props;if(a&&!t.crop&&e){const{width:i,height:n}=this.getBox();i&&n&&a(k(e,i,n),H(e,i,n))}}componentWillUnmount(){this.resizeObserver&&this.resizeObserver.disconnect(),this.unbindDocMove()}bindDocMove(){this.docMoveBound||(this.document.addEventListener("pointermove",this.onDocPointerMove,N),this.document.addEventListener("pointerup",this.onDocPointerDone,N),this.document.addEventListener("pointercancel",this.onDocPointerDone,N),this.docMoveBound=!0)}unbindDocMove(){this.docMoveBound&&(this.document.removeEventListener("pointermove",this.onDocPointerMove,N),this.document.removeEventListener("pointerup",this.onDocPointerDone,N),this.document.removeEventListener("pointercancel",this.onDocPointerDone,N),this.docMoveBound=!1)}getCropStyle(){const{crop:t}=this.props;if(t)return{top:`${t.y}${t.unit}`,left:`${t.x}${t.unit}`,width:`${t.width}${t.unit}`,height:`${t.height}${t.unit}`}}dragCrop(){const{evData:t}=this,e=this.getBox(),a=this.makePixelCrop(e),i=t.clientX-t.startClientX,n=t.clientY-t.startClientY;return a.x=S(t.startCropX+i,0,e.width-a.width),a.y=S(t.startCropY+n,0,e.height-a.height),a}getPointRegion(t,e,a,i){const{evData:n}=this,h=n.clientX-t.x,l=n.clientY-t.y;let s;i&&e?s=e==="nw"||e==="n"||e==="ne":s=l<n.startCropY;let r;return a&&e?r=e==="nw"||e==="w"||e==="sw":r=h<n.startCropX,r?s?"nw":"sw":s?"ne":"se"}resolveMinDimensions(t,e,a=0,i=0){const n=Math.min(a,t.width),h=Math.min(i,t.height);return!e||!n&&!h?[n,h]:e>1?n?[n,n/e]:[h*e,h]:h?[h*e,h]:[n,n/e]}resizeCrop(){const{evData:t}=this,{aspect:e=0,maxWidth:a,maxHeight:i}=this.props,n=this.getBox(),[h,l]=this.resolveMinDimensions(n,e,this.props.minWidth,this.props.minHeight);let s=this.makePixelCrop(n);const r=this.getPointRegion(n,t.ord,h,l),d=t.ord||r;let p=t.clientX-t.startClientX,w=t.clientY-t.startClientY;(h&&d==="nw"||d==="w"||d==="sw")&&(p=Math.min(p,-h)),(l&&d==="nw"||d==="n"||d==="ne")&&(w=Math.min(w,-l));const o={unit:"px",x:0,y:0,width:0,height:0};r==="ne"?(o.x=t.startCropX,o.width=p,e?(o.height=o.width/e,o.y=t.startCropY-o.height):(o.height=Math.abs(w),o.y=t.startCropY-o.height)):r==="se"?(o.x=t.startCropX,o.y=t.startCropY,o.width=p,e?o.height=o.width/e:o.height=w):r==="sw"?(o.x=t.startCropX+p,o.y=t.startCropY,o.width=Math.abs(p),e?o.height=o.width/e:o.height=w):r==="nw"&&(o.x=t.startCropX+p,o.width=Math.abs(p),e?(o.height=o.width/e,o.y=t.startCropY-o.height):(o.height=Math.abs(w),o.y=t.startCropY+w));const g=_(o,e,r,n.width,n.height,h,l,a,i);return e||b.xyOrds.indexOf(d)>-1?s=g:b.xOrds.indexOf(d)>-1?(s.x=g.x,s.width=g.width):b.yOrds.indexOf(d)>-1&&(s.y=g.y,s.height=g.height),s.x=S(s.x,0,n.width-s.width),s.y=S(s.y,0,n.height-s.height),s}renderCropSelection(){const{ariaLabels:t=b.defaultProps.ariaLabels,disabled:e,locked:a,renderSelectionAddon:i,ruleOfThirds:n,crop:h}=this.props,l=this.getCropStyle();if(h)return u.createElement("div",{style:l,className:"ReactCrop__crop-selection",onPointerDown:this.onCropPointerDown,"aria-label":t.cropArea,tabIndex:0,onKeyDown:this.onComponentKeyDown,role:"group"},!e&&!a&&u.createElement("div",{className:"ReactCrop__drag-elements",onFocus:this.onDragFocus},u.createElement("div",{className:"ReactCrop__drag-bar ord-n","data-ord":"n"}),u.createElement("div",{className:"ReactCrop__drag-bar ord-e","data-ord":"e"}),u.createElement("div",{className:"ReactCrop__drag-bar ord-s","data-ord":"s"}),u.createElement("div",{className:"ReactCrop__drag-bar ord-w","data-ord":"w"}),u.createElement("div",{className:"ReactCrop__drag-handle ord-nw","data-ord":"nw",tabIndex:0,"aria-label":t.nwDragHandle,onKeyDown:s=>this.onHandlerKeyDown(s,"nw"),role:"button"}),u.createElement("div",{className:"ReactCrop__drag-handle ord-n","data-ord":"n",tabIndex:0,"aria-label":t.nDragHandle,onKeyDown:s=>this.onHandlerKeyDown(s,"n"),role:"button"}),u.createElement("div",{className:"ReactCrop__drag-handle ord-ne","data-ord":"ne",tabIndex:0,"aria-label":t.neDragHandle,onKeyDown:s=>this.onHandlerKeyDown(s,"ne"),role:"button"}),u.createElement("div",{className:"ReactCrop__drag-handle ord-e","data-ord":"e",tabIndex:0,"aria-label":t.eDragHandle,onKeyDown:s=>this.onHandlerKeyDown(s,"e"),role:"button"}),u.createElement("div",{className:"ReactCrop__drag-handle ord-se","data-ord":"se",tabIndex:0,"aria-label":t.seDragHandle,onKeyDown:s=>this.onHandlerKeyDown(s,"se"),role:"button"}),u.createElement("div",{className:"ReactCrop__drag-handle ord-s","data-ord":"s",tabIndex:0,"aria-label":t.sDragHandle,onKeyDown:s=>this.onHandlerKeyDown(s,"s"),role:"button"}),u.createElement("div",{className:"ReactCrop__drag-handle ord-sw","data-ord":"sw",tabIndex:0,"aria-label":t.swDragHandle,onKeyDown:s=>this.onHandlerKeyDown(s,"sw"),role:"button"}),u.createElement("div",{className:"ReactCrop__drag-handle ord-w","data-ord":"w",tabIndex:0,"aria-label":t.wDragHandle,onKeyDown:s=>this.onHandlerKeyDown(s,"w"),role:"button"})),i&&u.createElement("div",{className:"ReactCrop__selection-addon",onPointerDown:s=>s.stopPropagation()},i(this.state)),n&&u.createElement(u.Fragment,null,u.createElement("div",{className:"ReactCrop__rule-of-thirds-hz"}),u.createElement("div",{className:"ReactCrop__rule-of-thirds-vt"})))}makePixelCrop(t){const e={...Y,...this.props.crop||{}};return k(e,t.width,t.height)}render(){const{aspect:t,children:e,circularCrop:a,className:i,crop:n,disabled:h,locked:l,style:s,ruleOfThirds:r}=this.props,{cropIsActive:d,newCropIsBeingDrawn:p}=this.state,w=n?this.renderCropSelection():null,o=I("ReactCrop",i,d&&"ReactCrop--active",h&&"ReactCrop--disabled",l&&"ReactCrop--locked",p&&"ReactCrop--new-crop",n&&t&&"ReactCrop--fixed-aspect",n&&a&&"ReactCrop--circular-crop",n&&r&&"ReactCrop--rule-of-thirds",!this.dragStarted&&n&&!n.width&&!n.height&&"ReactCrop--invisible-crop",a&&"ReactCrop--no-animate");return u.createElement("div",{ref:this.componentRef,className:o,style:s},u.createElement("div",{ref:this.mediaRef,className:"ReactCrop__child-wrapper",onPointerDown:this.onComponentPointerDown},e),n?u.createElement("svg",{className:"ReactCrop__crop-mask",width:"100%",height:"100%"},u.createElement("defs",null,u.createElement("mask",{id:`hole-${this.instanceId}`},u.createElement("rect",{width:"100%",height:"100%",fill:"white"}),a?u.createElement("ellipse",{cx:`${n.x+n.width/2}${n.unit}`,cy:`${n.y+n.height/2}${n.unit}`,rx:`${n.width/2}${n.unit}`,ry:`${n.height/2}${n.unit}`,fill:"black"}):u.createElement("rect",{x:`${n.x}${n.unit}`,y:`${n.y}${n.unit}`,width:`${n.width}${n.unit}`,height:`${n.height}${n.unit}`,fill:"black"}))),u.createElement("rect",{fill:"black",fillOpacity:.5,width:"100%",height:"100%",mask:`url(#hole-${this.instanceId})`})):void 0,w)}};m(E,"xOrds",["e","w"]),m(E,"yOrds",["n","s"]),m(E,"xyOrds",["nw","ne","se","sw"]),m(E,"nudgeStep",1),m(E,"nudgeStepMedium",10),m(E,"nudgeStepLarge",100),m(E,"defaultProps",{ariaLabels:{cropArea:"Use the arrow keys to move the crop selection area",nwDragHandle:"Use the arrow keys to move the north west drag handle to change the crop selection area",nDragHandle:"Use the up and down arrow keys to move the north drag handle to change the crop selection area",neDragHandle:"Use the arrow keys to move the north east drag handle to change the crop selection area",eDragHandle:"Use the up and down arrow keys to move the east drag handle to change the crop selection area",seDragHandle:"Use the arrow keys to move the south east drag handle to change the crop selection area",sDragHandle:"Use the up and down arrow keys to move the south drag handle to change the crop selection area",swDragHandle:"Use the arrow keys to move the south west drag handle to change the crop selection area",wDragHandle:"Use the up and down arrow keys to move the west drag handle to change the crop selection area"}});let O=E;const U=({onCropComplete:c,onCancel:t,imageFile:e})=>{const[a,i]=D.useState(null),[n,h]=D.useState({unit:"%",width:50,aspect:1}),[l,s]=D.useState(null),r=D.useRef(null),d=D.useRef(null);D.useEffect(()=>{if(e){const o=new FileReader;o.addEventListener("load",()=>{i(o.result)}),o.readAsDataURL(e)}},[e]);const p=D.useCallback(o=>{r.current=o;const g=o.width,x=o.height,v=Math.min(g,x),C=(g-v)/2,R=(x-v)/2,f={unit:"px",width:v,height:v,x:C,y:R,aspect:1};h(f),s(f)},[]);D.useEffect(()=>{if(!l||!r.current||!d.current)return;const o=r.current,g=d.current,x=l,v=o.naturalWidth/o.width,C=o.naturalHeight/o.height,R=g.getContext("2d"),f=window.devicePixelRatio||1,M=180;g.width=M*f,g.height=M*f,R.setTransform(f,0,0,f,0,0),R.imageSmoothingQuality="high",R.drawImage(o,x.x*v,x.y*C,x.width*v,x.height*C,0,0,M,M)},[l]);const w=D.useCallback(async()=>{if(!l||!r.current||!d.current)return;const o=r.current,g=d.current,x=l,v=o.naturalWidth/o.width,C=o.naturalHeight/o.height,R=g.getContext("2d"),f=window.devicePixelRatio,M=512;return g.width=M*f,g.height=M*f,R.setTransform(f,0,0,f,0,0),R.imageSmoothingQuality="high",R.drawImage(o,x.x*v,x.y*C,x.width*v,x.height*C,0,0,M,M),new Promise($=>{g.toBlob(P=>{P&&(P.name="avatar.png",c(P),$())},"image/png",1)})},[l,c]);return y.jsx("div",{className:"avatar-cropper-modal",onClick:t,children:y.jsxs("div",{className:"avatar-cropper-content",onClick:o=>o.stopPropagation(),children:[y.jsxs("div",{className:"avatar-cropper-header",children:[y.jsx("h2",{children:"üì∏ Profil Fotoƒürafƒ±nƒ± D√ºzenle"}),y.jsx("button",{className:"close-btn",onClick:t,children:"√ó"})]}),y.jsxs("div",{className:"avatar-cropper-body",children:[!a&&y.jsxs("div",{style:{padding:"40px",textAlign:"center",color:"#dcddde"},children:[y.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"‚è≥"}),y.jsx("p",{children:"Fotoƒüraf y√ºkleniyor..."}),!e&&y.jsx("p",{style:{color:"#f04747",marginTop:"8px"},children:"‚ö†Ô∏è Dosya bulunamadƒ±!"})]}),a&&y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"crop-container",children:y.jsx(O,{crop:n,onChange:o=>h(o),onComplete:o=>s(o),aspect:1,circularCrop:!1,keepSelection:!0,minWidth:100,minHeight:100,children:y.jsx("img",{ref:r,src:a,alt:"Crop",onLoad:o=>p(o.currentTarget),style:{maxWidth:"100%",maxHeight:"55vh",display:"block",objectFit:"contain"}})})}),y.jsxs("div",{className:"preview-section",children:[y.jsx("h3",{children:"√ñnizleme:"}),y.jsx("div",{className:"preview-container",children:y.jsx("canvas",{ref:d,style:{width:180,height:180,borderRadius:"50%",objectFit:"cover"}})}),y.jsx("p",{className:"preview-note",children:"‚ÑπÔ∏è Tam kare (1:1)"})]})]})]}),a&&y.jsxs("div",{className:"avatar-cropper-footer",children:[y.jsx("button",{className:"btn-secondary",onClick:t,children:"ƒ∞ptal"}),y.jsx("button",{className:"btn-primary",onClick:w,children:"‚úì Kaydet"})]})]})})};export{U as default};
