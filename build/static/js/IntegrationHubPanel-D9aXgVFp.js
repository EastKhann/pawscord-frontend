import{r as u,dr as y,l as F,A,aI as g,x as v,w as j,db as L,cX as I,ds as D,cV as H,cU as K,cS as G,cP as Y,cT as J,cW as z,aX as f,n as U,bV as B,ch as d,dt as V,aW as X,bK as q,H as Q}from"./react-core-B6hadH-M.js";import{h as _}from"./index-D_6pZib5.js";const se=({serverId:n,onClose:r})=>{const[s,i]=u.useState("connected"),[m,l]=u.useState([]),[e,c]=u.useState([]),[t,h]=u.useState(!0),[R,o]=u.useState(""),[N,w]=u.useState({show:!1,integration:null}),b=localStorage.getItem("access_token"),C={github:J,spotify:Y,twitch:G,youtube:K,discord:H,slack:D,google:I,twitter:L},S={github:"#333",spotify:"#1db954",twitch:"#9146ff",youtube:"#ff0000",discord:"#5865f2",slack:"#4a154b",google:"#4285f4",twitter:"#1da1f2"};u.useEffect(()=>{p()},[n]);const p=async()=>{h(!0);try{const[a,E]=await Promise.all([fetch(`/api/servers/${n}/integrations/`,{headers:{Authorization:`Bearer ${b}`}}),fetch("/api/integrations/available/",{headers:{Authorization:`Bearer ${b}`}})]);if(a.ok){const k=await a.json();l(k.integrations||[])}if(E.ok){const k=await E.json();c(k.integrations||[])}else c([])}catch(a){console.error("Error fetching integrations:",a),c([])}h(!1)},T=async a=>{try{const E=await fetch(`/api/servers/${n}/integrations/connect/`,{method:"POST",headers:{Authorization:`Bearer ${b}`,"Content-Type":"application/json"},body:JSON.stringify({integration_type:a})});if(E.ok){const k=await E.json();k.oauth_url&&window.open(k.oauth_url,"_blank","width=500,height=600"),d.success(`${a} entegrasyon başlatıldı`),p()}else d.error("Bağlantı başlatılamadı")}catch{d.error("Bağlantı hatası")}},W=async a=>{if(await _("Bu entegrasyonu kaldırmak istediğinize emin misiniz?"))try{(await fetch(`/api/servers/${n}/integrations/${a}/disconnect/`,{method:"POST",headers:{Authorization:`Bearer ${b}`}})).ok&&(d.success("Entegrasyon kaldırıldı"),p())}catch{d.error("Entegrasyon kaldırılamadı")}},x=async a=>{try{(await fetch(`/api/servers/${n}/integrations/${a}/sync/`,{method:"POST",headers:{Authorization:`Bearer ${b}`}})).ok&&d.success("Senkronizasyon başlatıldı")}catch{d.error("Senkronizasyon başarısız")}},O=a=>{switch(a){case"development":return React.createElement(Q,null);case"entertainment":return React.createElement(q,null);case"streaming":return React.createElement(X,null);case"productivity":return React.createElement(V,null);default:return React.createElement(y,null)}},M=e.filter(a=>a.name.toLowerCase().includes(R.toLowerCase())||a.description.toLowerCase().includes(R.toLowerCase())),P=m.map(a=>a.type),$=M.filter(a=>!P.includes(a.id));return React.createElement("div",{className:"integration-hub-overlay",onClick:a=>a.target.className==="integration-hub-overlay"&&r()},React.createElement("div",{className:"integration-hub-panel"},React.createElement("div",{className:"panel-header"},React.createElement("h2",null,React.createElement(y,null)," Entegrasyon Merkezi"),React.createElement("button",{className:"close-btn",onClick:r},React.createElement(F,null))),React.createElement("div",{className:"tabs-bar"},React.createElement("div",{className:"tabs"},React.createElement("button",{className:`tab ${s==="connected"?"active":""}`,onClick:()=>i("connected")},React.createElement(A,null)," Bağlı (",m.length,")"),React.createElement("button",{className:`tab ${s==="available"?"active":""}`,onClick:()=>i("available")},React.createElement(g,null)," Mevcut (",$.length,")"),React.createElement("button",{className:`tab ${s==="webhooks"?"active":""}`,onClick:()=>i("webhooks")},React.createElement(v,null)," Webhooks"))),s==="available"&&React.createElement("div",{className:"search-bar"},React.createElement(j,null),React.createElement("input",{type:"text",placeholder:"Entegrasyon ara...",value:R,onChange:a=>o(a.target.value)})),React.createElement("div",{className:"panel-content"},t?React.createElement("div",{className:"loading"},"Yükleniyor..."):React.createElement(React.Fragment,null,s==="connected"&&React.createElement(Z,{integrations:m,icons:C,colors:S,onDisconnect:W,onSync:x,onConfigure:a=>w({show:!0,integration:a})}),s==="available"&&React.createElement(ee,{integrations:$,icons:C,colors:S,getCategoryIcon:O,onConnect:T}),s==="webhooks"&&React.createElement(te,{serverId:n,token:b}))),N.show&&React.createElement(ne,{integration:N.integration,serverId:n,token:b,onClose:()=>w({show:!1,integration:null}),onSave:p})))},Z=({integrations:n,icons:r,colors:s,onDisconnect:i,onSync:m,onConfigure:l})=>n.length===0?React.createElement("div",{className:"empty-state"},React.createElement(z,null),React.createElement("p",null,"Henüz bağlı entegrasyon yok"),React.createElement("span",{className:"hint"},'"Mevcut" sekmesinden entegrasyon ekleyin')):React.createElement("div",{className:"connected-list"},n.map(e=>{const c=r[e.type]||y,t=s[e.type]||"#666";return React.createElement("div",{key:e.id,className:"integration-card connected"},React.createElement("div",{className:"integration-icon",style:{background:t}},React.createElement(c,null)),React.createElement("div",{className:"integration-info"},React.createElement("h4",null,e.name),React.createElement("div",{className:"connection-info"},React.createElement("span",{className:"status connected"},React.createElement(f,null)," Bağlı"),e.account_name&&React.createElement("span",{className:"account"},"@",e.account_name)),React.createElement("div",{className:"last-sync"},"Son senkronizasyon: ",e.last_sync||"Hiç")),React.createElement("div",{className:"integration-actions"},React.createElement("button",{className:"action-btn sync",onClick:()=>m(e.id),title:"Senkronize Et"},React.createElement(U,null)),React.createElement("button",{className:"action-btn config",onClick:()=>l(e),title:"Ayarlar"},React.createElement(B,null)),React.createElement("button",{className:"action-btn disconnect",onClick:()=>i(e.id),title:"Bağlantıyı Kes"},React.createElement(z,null))))})),ee=({integrations:n,icons:r,colors:s,getCategoryIcon:i,onConnect:m})=>{const l=[...new Set(n.map(e=>e.category))];return n.length===0?React.createElement("div",{className:"empty-state"},React.createElement(y,null),React.createElement("p",null,"Tüm entegrasyonlar zaten bağlı")):React.createElement("div",{className:"available-list"},l.map(e=>React.createElement("div",{key:e,className:"category-section"},React.createElement("h3",{className:"category-title"},i(e),e==="development"&&"Geliştirme",e==="entertainment"&&"Eğlence",e==="streaming"&&"Yayın",e==="productivity"&&"Üretkenlik",e==="content"&&"İçerik",e==="social"&&"Sosyal"),React.createElement("div",{className:"integrations-grid"},n.filter(c=>c.category===e).map(c=>{const t=r[c.id]||y,h=s[c.id]||"#666";return React.createElement("div",{key:c.id,className:"integration-card available"},React.createElement("div",{className:"integration-icon",style:{background:h}},React.createElement(t,null)),React.createElement("div",{className:"integration-details"},React.createElement("h4",null,c.name),React.createElement("p",null,c.description),React.createElement("ul",{className:"features"},c.features?.slice(0,3).map((R,o)=>React.createElement("li",{key:o},React.createElement(f,null)," ",R)))),React.createElement("button",{className:"connect-btn",onClick:()=>m(c.id)},React.createElement(A,null)," Bağla"))})))))},te=({serverId:n,token:r})=>{const[s,i]=u.useState([]),[m,l]=u.useState(!1);u.useEffect(()=>{e()},[]);const e=async()=>{try{const t=await fetch(`/api/servers/${n}/webhooks/`,{headers:{Authorization:`Bearer ${r}`}});if(t.ok){const h=await t.json();i(h.webhooks||[])}}catch(t){console.error("Error fetching webhooks:",t)}},c=async t=>{if(await _("Bu webhook'u silmek istediğinize emin misiniz?"))try{(await fetch(`/api/servers/${n}/webhooks/${t}/`,{method:"DELETE",headers:{Authorization:`Bearer ${r}`}})).ok&&(d.success("Webhook silindi"),e())}catch{d.error("Webhook silinemedi")}};return React.createElement("div",{className:"webhooks-view"},React.createElement("div",{className:"webhooks-header"},React.createElement("p",null,"Webhooks ile dış servislerden otomatik mesajlar alın"),React.createElement("button",{className:"create-webhook-btn",onClick:()=>l(!0)},React.createElement(g,null)," Yeni Webhook")),s.length===0?React.createElement("div",{className:"empty-state"},React.createElement(v,null),React.createElement("p",null,"Henüz webhook oluşturulmamış")):React.createElement("div",{className:"webhooks-list"},s.map(t=>React.createElement("div",{key:t.id,className:"webhook-item"},React.createElement("div",{className:"webhook-avatar"},t.avatar?React.createElement("img",{src:t.avatar,alt:""}):React.createElement(v,null)),React.createElement("div",{className:"webhook-info"},React.createElement("h4",null,t.name),React.createElement("span",{className:"webhook-channel"},"#",t.channel_name),React.createElement("div",{className:"webhook-url"},React.createElement("code",null,t.url.substring(0,40),"..."),React.createElement("button",{onClick:()=>{navigator.clipboard.writeText(t.url),d.success("URL kopyalandı")}},"Kopyala"))),React.createElement("div",{className:"webhook-actions"},React.createElement("button",{className:"action-btn delete",onClick:()=>c(t.id)},React.createElement(F,null)))))),m&&React.createElement(ae,{serverId:n,token:r,onClose:()=>l(!1),onCreated:()=>{e(),l(!1)}}))},ae=({serverId:n,token:r,onClose:s,onCreated:i})=>{const[m,l]=u.useState(""),[e,c]=u.useState(""),[t,h]=u.useState([]);u.useEffect(()=>{fetch(`/api/servers/${n}/channels/`,{headers:{Authorization:`Bearer ${r}`}}).then(o=>o.json()).then(o=>h(o.channels||[])).catch(()=>{})},[]);const R=async()=>{if(!m||!e){d.warning("Tüm alanları doldurun");return}try{(await fetch(`/api/servers/${n}/webhooks/`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"},body:JSON.stringify({name:m,channel_id:e})})).ok&&(d.success("Webhook oluşturuldu"),i())}catch{d.error("Webhook oluşturulamadı")}};return React.createElement("div",{className:"modal-overlay",onClick:o=>o.target.className==="modal-overlay"&&s()},React.createElement("div",{className:"webhook-modal"},React.createElement("h3",null,React.createElement(g,null)," Yeni Webhook Oluştur"),React.createElement("div",{className:"form-group"},React.createElement("label",null,"Webhook Adı"),React.createElement("input",{type:"text",value:m,onChange:o=>l(o.target.value),placeholder:"örn: GitHub Bot"})),React.createElement("div",{className:"form-group"},React.createElement("label",null,"Kanal"),React.createElement("select",{value:e,onChange:o=>c(o.target.value)},React.createElement("option",{value:""},"Kanal seçin..."),t.map(o=>React.createElement("option",{key:o.id,value:o.id},"#",o.name)))),React.createElement("div",{className:"modal-actions"},React.createElement("button",{className:"cancel-btn",onClick:s},"İptal"),React.createElement("button",{className:"create-btn",onClick:R},"Oluştur"))))},ne=({integration:n,serverId:r,token:s,onClose:i,onSave:m})=>{const[l,e]=u.useState({notifications_enabled:!0,notification_channel:"",auto_sync:!0,sync_interval:30}),c=async()=>{try{(await fetch(`/api/servers/${r}/integrations/${n.id}/configure/`,{method:"POST",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},body:JSON.stringify(l)})).ok&&(d.success("Ayarlar kaydedildi"),m(),i())}catch{d.error("Ayarlar kaydedilemedi")}};return React.createElement("div",{className:"modal-overlay",onClick:t=>t.target.className==="modal-overlay"&&i()},React.createElement("div",{className:"config-modal"},React.createElement("h3",null,React.createElement(B,null)," ",n.name," Ayarları"),React.createElement("div",{className:"config-section"},React.createElement("label",{className:"checkbox-label"},React.createElement("input",{type:"checkbox",checked:l.notifications_enabled,onChange:t=>e({...l,notifications_enabled:t.target.checked})}),"Bildirimleri Etkinleştir")),React.createElement("div",{className:"config-section"},React.createElement("label",{className:"checkbox-label"},React.createElement("input",{type:"checkbox",checked:l.auto_sync,onChange:t=>e({...l,auto_sync:t.target.checked})}),"Otomatik Senkronizasyon")),l.auto_sync&&React.createElement("div",{className:"form-group"},React.createElement("label",null,"Senkronizasyon Aralığı (dakika)"),React.createElement("input",{type:"number",value:l.sync_interval,onChange:t=>e({...l,sync_interval:parseInt(t.target.value)}),min:5,max:1440})),React.createElement("div",{className:"modal-actions"},React.createElement("button",{className:"cancel-btn",onClick:i},"İptal"),React.createElement("button",{className:"save-btn",onClick:c},React.createElement(f,null)," Kaydet"))))};export{se as default};
