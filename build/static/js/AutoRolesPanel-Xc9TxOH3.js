import{r as s,ch as l}from"./react-core-B6hadH-M.js";import{g as q,h as $}from"./index-D_6pZib5.js";const C=({serverId:o,onClose:d})=>{const c=q(),[m,v]=s.useState([]),[g,E]=s.useState([]),[p,R]=s.useState(!0),[a,n]=s.useState({role_id:"",trigger_type:"on_join",delay:0,required_level:0,required_invites:0,required_messages:0,remove_after:0,enabled:!0}),u=[{value:"on_join",label:"Sunucuya KatÄ±lÄ±nca",icon:"ğŸ‘‹"},{value:"on_verify",label:"DoÄŸrulama SonrasÄ±",icon:"âœ…"},{value:"on_level",label:"Seviyeye UlaÅŸÄ±nca",icon:"â­"},{value:"on_invites",label:"Davet SayÄ±sÄ±",icon:"ğŸ‘¥"},{value:"on_messages",label:"Mesaj SayÄ±sÄ±",icon:"ğŸ’¬"},{value:"on_reaction",label:"Reaksiyon Verince",icon:"ğŸ˜€"},{value:"on_boost",label:"Sunucu Boost",icon:"ğŸš€"}];s.useEffect(()=>{i(),y()},[o]);const i=async()=>{try{const e=await fetch(`${c}/auto-roles/server/${o}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(e.ok){const t=await e.json();v(t)}}catch(e){console.error("Error fetching auto roles:",e)}finally{R(!1)}},y=async()=>{try{const e=await fetch(`${c}/roles/server/${o}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(e.ok){const t=await e.json();E(t)}}catch(e){console.error("Error fetching roles:",e)}},_=async()=>{if(!a.role_id){l.error("âŒ LÃ¼tfen rol seÃ§in");return}try{(await fetch(`${c}/auto-roles/create/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`,"Content-Type":"application/json"},body:JSON.stringify({server_id:o,...a})})).ok?(l.success("âœ… Otomatik rol oluÅŸturuldu"),i(),n({role_id:"",trigger_type:"on_join",delay:0,required_level:0,required_invites:0,required_messages:0,remove_after:0,enabled:!0})):l.error("âŒ Otomatik rol oluÅŸturulamadÄ±")}catch(e){console.error("Error creating auto role:",e),l.error("âŒ BaÄŸlantÄ± hatasÄ±")}},k=async(e,t)=>{try{(await fetch(`${c}/auto-roles/${e}/toggle/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}})).ok?(l.success(t?"âœ… Otomatik rol devre dÄ±ÅŸÄ±":"âœ… Otomatik rol aktif"),i()):l.error("âŒ Durum gÃ¼ncellenemedi")}catch(r){console.error("Error toggling auto role:",r),l.error("âŒ BaÄŸlantÄ± hatasÄ±")}},f=async e=>{if(await $("Otomatik rolÃ¼ silmek istediÄŸinize emin misiniz?"))try{(await fetch(`${c}/auto-roles/${e}/delete/`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}})).ok?(l.success("âœ… Otomatik rol silindi"),i()):l.error("âŒ Otomatik rol silinemedi")}catch(t){console.error("Error deleting auto role:",t),l.error("âŒ BaÄŸlantÄ± hatasÄ±")}},h=e=>{const t=g.find(r=>r.id===e);return t?t.name:"Bilinmeyen Rol"},N=e=>{const t=u.find(r=>r.value===e);return t?t.label:e},b=e=>{const t=u.find(r=>r.value===e);return t?t.icon:"âš™ï¸"},S=e=>{if(e===0)return"AnÄ±nda";const t=Math.floor(e/60),r=Math.floor(t/60);return r>0?`${r} saat`:`${t} dakika`};return React.createElement("div",{className:"autoroles-panel-overlay",onClick:d},React.createElement("div",{className:"autoroles-panel",onClick:e=>e.stopPropagation()},React.createElement("div",{className:"autoroles-header"},React.createElement("h2",null,"âš¡ Otomatik Roller"),React.createElement("button",{className:"close-btn",onClick:d},"Ã—")),React.createElement("div",{className:"autoroles-content"},React.createElement("div",{className:"create-autorole-section"},React.createElement("h3",null,"Yeni Otomatik Rol Ekle"),React.createElement("div",{className:"create-form"},React.createElement("div",{className:"form-row"},React.createElement("div",{className:"form-group"},React.createElement("label",null,"Rol *"),React.createElement("select",{value:a.role_id,onChange:e=>n({...a,role_id:e.target.value})},React.createElement("option",{value:""},"Rol SeÃ§in"),g.map(e=>React.createElement("option",{key:e.id,value:e.id},e.name)))),React.createElement("div",{className:"form-group"},React.createElement("label",null,"Tetikleyici"),React.createElement("select",{value:a.trigger_type,onChange:e=>n({...a,trigger_type:e.target.value})},u.map(e=>React.createElement("option",{key:e.value,value:e.value},e.icon," ",e.label))))),React.createElement("div",{className:"form-row"},React.createElement("div",{className:"form-group"},React.createElement("label",null,"Gecikme (Saniye)"),React.createElement("input",{type:"number",min:"0",placeholder:"0 = AnÄ±nda",value:a.delay,onChange:e=>n({...a,delay:parseInt(e.target.value)||0})})),a.trigger_type==="on_level"&&React.createElement("div",{className:"form-group"},React.createElement("label",null,"Gerekli Seviye"),React.createElement("input",{type:"number",min:"1",value:a.required_level,onChange:e=>n({...a,required_level:parseInt(e.target.value)||0})})),a.trigger_type==="on_invites"&&React.createElement("div",{className:"form-group"},React.createElement("label",null,"Gerekli Davet"),React.createElement("input",{type:"number",min:"1",value:a.required_invites,onChange:e=>n({...a,required_invites:parseInt(e.target.value)||0})})),a.trigger_type==="on_messages"&&React.createElement("div",{className:"form-group"},React.createElement("label",null,"Gerekli Mesaj"),React.createElement("input",{type:"number",min:"1",value:a.required_messages,onChange:e=>n({...a,required_messages:parseInt(e.target.value)||0})})),React.createElement("div",{className:"form-group"},React.createElement("label",null,"Otomatik KaldÄ±r (Saat)"),React.createElement("input",{type:"number",min:"0",placeholder:"0 = HiÃ§bir zaman",value:a.remove_after,onChange:e=>n({...a,remove_after:parseInt(e.target.value)||0})}))),React.createElement("button",{className:"create-btn",onClick:_},"âš¡ Otomatik Rol OluÅŸtur"))),React.createElement("div",{className:"autoroles-list-section"},React.createElement("h3",null,"Aktif Otomatik Roller (",m.length,")"),p?React.createElement("div",{className:"loading-state"},React.createElement("div",{className:"spinner"}),React.createElement("p",null,"Otomatik roller yÃ¼kleniyor...")):m.length===0?React.createElement("div",{className:"empty-state"},React.createElement("span",{className:"empty-icon"},"âš¡"),React.createElement("p",null,"HenÃ¼z otomatik rol yok"),React.createElement("span",{className:"empty-hint"},"KullanÄ±cÄ±lara otomatik rol atamalarÄ± yapabilirsiniz")):React.createElement("div",{className:"autoroles-list"},m.map(e=>React.createElement("div",{key:e.id,className:`autorole-card ${e.enabled?"":"disabled"}`},React.createElement("div",{className:"autorole-card-header"},React.createElement("div",{className:"role-info"},React.createElement("span",{className:"trigger-icon"},b(e.trigger_type)),React.createElement("div",null,React.createElement("h4",null,h(e.role_id)),React.createElement("span",{className:"trigger-label"},N(e.trigger_type)))),React.createElement("div",{className:"autorole-actions"},React.createElement("button",{className:`toggle-btn ${e.enabled?"active":""}`,onClick:()=>k(e.id,e.enabled)},e.enabled?"âœ“":"â—‹"),React.createElement("button",{className:"delete-btn",onClick:()=>f(e.id)},"ğŸ—‘ï¸"))),React.createElement("div",{className:"autorole-details"},e.delay>0&&React.createElement("div",{className:"detail-item"},React.createElement("span",{className:"detail-icon"},"â±ï¸"),React.createElement("span",null,"Gecikme: ",S(e.delay))),e.required_level>0&&React.createElement("div",{className:"detail-item"},React.createElement("span",{className:"detail-icon"},"â­"),React.createElement("span",null,"Seviye ",e.required_level," gerekli")),e.required_invites>0&&React.createElement("div",{className:"detail-item"},React.createElement("span",{className:"detail-icon"},"ğŸ‘¥"),React.createElement("span",null,e.required_invites," davet gerekli")),e.required_messages>0&&React.createElement("div",{className:"detail-item"},React.createElement("span",{className:"detail-icon"},"ğŸ’¬"),React.createElement("span",null,e.required_messages," mesaj gerekli")),e.remove_after>0&&React.createElement("div",{className:"detail-item"},React.createElement("span",{className:"detail-icon"},"ğŸ”„"),React.createElement("span",null,e.remove_after," saat sonra kaldÄ±rÄ±lÄ±r")),e.uses_count>0&&React.createElement("div",{className:"detail-item"},React.createElement("span",{className:"detail-icon"},"ğŸ“Š"),React.createElement("span",null,e.uses_count," kere kullanÄ±ldÄ±"))))))))))};export{C as default};
