const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["static/js/web-BPVhH1jM.js","static/js/media-vendor-Dp18sh1g.js","static/js/react-vendor-D8Fi5F9E.js","static/js/router-vendor-CTPwQFnc.js","static/js/crypto-vendor-Cz32ecGD.js","static/js/icons-vendor-CfNiWYc_.js","static/js/state-vendor-De5qIGw3.js","static/js/ServerSettingsModal-FE5ow_H-.js","static/js/ui-vendor-KQ6Wr7TQ.js","static/js/chart-vendor-Bq6p6uOO.js","static/js/AutoResponderManager-gx7SDMl5.js","static/js/VanityURLManager-qQgZVE57.js","static/js/UserProfileModal-B1XiVkUh.js","static/js/ImageModal-DvMxeGLp.js","static/js/GifPicker-D7YGUzBv.js","static/js/StickerPicker-TWKP2FiL.js","static/js/SoundboardModal-Ci6ZSUq8.js","static/js/WatchPartyEnhanced-CC3dwbgb.js","static/js/CinemaModal-CA_FSz-7.js","static/js/WhiteboardModal-Bt_-grsQ.js","static/js/PollCreateModal-DicI4JEE.js","static/js/CodeSnippetModal-HqRam3JM.js","static/js/MessageTemplateModal-3oMjA6Ei.js","static/js/Message-DldVD5L_.js","static/js/LazyImage-DecNWMsX.js","static/js/imageCaching-CJAldTs3.js","static/js/syntax-core-8EW0dctf.js","static/js/perf-vendor-DdRnm6hC.js","static/js/VirtualMessageList-0z34i2WX.js","static/js/MessageInput-ByXZcLsN.js","static/js/ScheduledMessageModal-DX62JiSu.js","static/css/MessageInput-Q2oINpgp.css","static/js/UserVideoContainer-DpDJFq5E.js","static/js/VoiceAudioController-Dwu6Kikc.js","static/js/RichTextEditor-C0d9eYRw.js","static/js/editor-vendor-B3ZvpqBn.js","static/css/RichTextEditor-D1KllEDh.css","static/js/StickyMessageBanner-B7bpqCIc.js","static/js/LoginPage-DKTIeTOV.js","static/js/recaptcha-BrFCBv3a.js","static/js/WelcomeScreen-80Y5TqNU.js","static/js/DownloadModal-Db_9Fq-7.js","static/js/AvatarCropper-VTC0DazT.js","static/css/AvatarCropper-D7v9iP7L.css","static/js/CryptoChartModal-bWx0Fo2m.js","static/js/CryptoStoreModal-DoWO-3nG.js","static/js/PremiumStoreModal-DmxQJmMo.js","static/js/KanbanBoard-BMZp3t3J.js","static/js/SummaryModal-B_xnst5k.js","static/js/DJModal-DXLWNKMJ.js","static/js/ThemeStoreModal-Vlw4KhLI.js","static/js/EncryptionKeyModal-Dlo2-5j2.js","static/js/CreateGroupModal-DEPKR65k.js","static/js/AdminAnalyticsPanel-CL6MfWJX.js","static/js/AdminPanelModal-CUZ8CPfI.js","static/js/WebhooksPanel-2bYSp32b.js","static/css/WebhooksPanel-Cn13v79_.css","static/js/AutoModerationDashboard-CYbp70z1.js","static/js/AutoModerationPanel-DxSoyahz.js","static/css/AutoModerationPanel-iAw0CZQU.css","static/js/RaidProtectionPanel-DNxR9pVs.js","static/js/ReportSystemPanel-BYoxLzjN.js","static/js/AuditLogPanel-CFN6TcnH.js","static/js/UserWarningsPanel-BLtBnntt.js","static/js/BookmarkPanel-CnGge8ze.js","static/js/ReadLaterPanel-Dei1yxHi.js","static/css/ReadLaterPanel-B_WZGTiX.css","static/js/ChannelPermissionsPanel-C9wTzHoH.js","static/js/MessageThreadsPanel-DKflF_At.js","static/js/ModeratorNotesPanel-CUJLH5gH.js","static/js/ServerRolesPanel-JGGBb650.js","static/js/NotificationPreferencesPanel-C6yngncc.js","static/js/MessageOCRPanel-BeAxSGeb.js","static/js/MassActionsPanel-K7v7xUi6.js","static/js/TimeoutMutePanel-BgwTpqnY.js","static/js/ServerThemesPanel-Dhd6hBaq.js","static/js/KeywordMutesPanel-BgB0JESj.js","static/js/WelcomeTemplatesPanel-Dtqho3Hh.js","static/js/StickyMessagesPanel-BpRxOv7U.js","static/js/MessageTemplatesPanel-DdCewsAn.js","static/js/MessageExportPanel-DebNTDFr.js","static/js/ArchivedRoomsPanel-BPbLwSC1.js","static/js/SlowModePanel-BNVsoyrd.js","static/js/EmojiManagementPanel-Bj5hoQ20.js","static/js/ReactionAnalyticsPanel-CFdz44yZ.js","static/js/LinkClickTrackingPanel-Dc7GGPnv.js","static/js/JoinLeaveLogsPanel-DMlUUrw6.js","static/js/UserActivityPanel-qT2r2uAK.js","static/js/NicknameHistoryPanel-CQdyPB8g.js","static/js/FieldChangeTrackingPanel-BRUD08pF.js","static/js/InviteAnalyticsPanel-3z3_JiRX.js","static/js/ContentScannerPanel-BPHfmpot.js","static/js/EphemeralMessagesPanel-BAaHHn44.js","static/js/TopicHistoryPanel-KtZ6XAMm.js","static/js/DraftsPanel-CAcdQ4Qb.js","static/js/ServerNicknamesPanel-DKM1Ff-7.js","static/js/ServerBoostPanel-DcdmtXnT.js","static/js/RoomWebhooksPanel-B6vTs5mZ.js","static/js/OAuthAppsPanel-BYHlWpBv.js","static/js/VanityURLPanel-Dv4NezFM.js","static/js/AutoRespondersPanel-DwozNvuy.js","static/js/SessionManagementPanel-mbzPgeIR.js","static/js/GDPRExportPanel-QpFJSSuM.js","static/js/DataRetentionPanel-DFH22vxl.js","static/js/TwoFactorSetupWizard-Bf_XSm6A.js","static/js/EnhancedPollsPanel-DX9wawMQ.js","static/js/VoiceTranscriptsPanel-DjX6UTWf.js","static/js/PaymentPanel-Bxn7aqWr.js","static/js/StoreModal-2oWg1_66.js","static/js/DailyRewardsModal-BnxF08cE.js","static/js/APIUsagePanel-CZXc6lan.js","static/js/ExportJobsPanel-BuqquDNz.js","static/js/ScheduledAnnouncementsPanel-C7XD5Vob.js","static/js/InviteExportPanel-8nj7zr3n.js","static/js/AdvancedSearchPanel-Dvw3UwSm.js","static/js/GrowthMetricsPanel-CIg2KuYV.js","static/js/LinkPreviewRenderer-Bam8wnDm.js","static/js/InventoryPanel-DtJI-gG2.js","static/js/WaitlistPanel-BOf8LTxh.js","static/js/ReferralRewardsPanel-Bvexxfgm.js","static/js/VerifyEmailPage-DysnN1lb.js","static/js/ForgotPasswordPage-ohAe50EJ.js","static/js/ResetPasswordPage-BB5pWXbh.js","static/js/TwoFactorLoginPage-BeasgjlK.js","static/js/TwoFactorSetup-9CKJrvYF.js","static/css/TwoFactorSetup-CtmcmlFU.css","static/js/TwoFactorLogin-CcEn5NhU.js","static/css/TwoFactorLogin-DgREC4Q6.css","static/js/VanityInviteScreen-P6Pd5mKS.js","static/js/EmailVerification-DqUw7EwK.js","static/css/EmailVerification-CE2S-15C.css","static/js/MobileNav-CO0ERRQF.js","static/css/MobileNav-BLwPGkd1.css","static/js/SwipeActions-C58H47F9.js","static/css/SwipeActions-CCPpS4d3.css","static/js/VoiceMessage-Dzd1LK8h.js","static/css/VoiceMessage-Czmu0SFR.css","static/js/FriendsTab-D3c3smon.js","static/js/RoomList-DFIxLmPX.js","static/js/UserFooter-D3hWYj37.js","static/js/UserProfilePanel-yUgOSd48.js","static/js/index-B9ygI19o.js","static/css/UserProfilePanel-DaqyzPyG.css","static/js/VoiceChatPanel-CCOND8lU.js","static/js/cjs-qL8QB1Zx.js","static/js/UserContextMenu-BdRIxptA.js","static/css/VoiceChatPanel-D0hk1ENV.css","static/js/ChatUserList-DrmQeT8B.js","static/js/PinnedMessages-BkjmKgQ8.js","static/js/FloatingVoiceIsland-D7ZJxsEv.js","static/css/FloatingVoiceIsland-CMKNK2uU.css","static/js/CinemaPlayer-BIm6GB88.js","static/js/ConnectionsPanel-CdTOvVL4.js","static/css/ConnectionsPanel-BHb_cRVQ.css","static/js/PasswordSetupModal-D-i2GT24.js","static/css/PasswordSetupModal-hiiUdoNl.css","static/js/NotificationDropdown-CHo6lGRx.js","static/js/ReactionStatsPanel-Dy3v48ME.js","static/css/ReactionStatsPanel-C-EVTLx8.css","static/js/ServerHealthPanel-B5EnFhx4.js","static/css/ServerHealthPanel-BMi05DZE.css","static/js/ChannelAnalyticsPanel-5w104hJr.js","static/css/ChannelAnalyticsPanel-B6Q8OoDz.css","static/js/SmartSuggestionsPanel-H5EidFgH.js","static/css/SmartSuggestionsPanel-BFDBx7VC.css","static/js/UserPresenceInsightsPanel-uAmDkHwl.js","static/css/UserPresenceInsightsPanel-WBZVzGk9.css","static/js/pushNotifications-BJ6K-mfw.js","static/js/urlHandlers-B0YpveNd.js","static/js/EnglishHub-B_CgDonV.js","static/js/GrammarQuizPage-TGoWuvbp.js","static/js/grammarQuestions-DGt-yM1z.js","static/js/EnglishLearningPage-TPLz2hUV.js","static/js/CryptoDashboard-DTuFwFWd.js","static/js/LandingPage-CIFFO7cv.js","static/css/LandingPage-CHHpsw7G.css","static/js/ReferralProgram-Br_NowEc.js","static/css/ReferralProgram-CBBjqZR4.css","static/js/GrowthDashboard-CXRvTiSe.js","static/css/GrowthDashboard-xlqndw5F.css","static/js/ToastDemo-vagu7hek.js","static/css/ToastDemo-DxNVRuTl.css"])))=>i.map(i=>d[i]);
var xl=Object.defineProperty;var Sl=(i,r,n)=>r in i?xl(i,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[r]=n;var Dr=(i,r,n)=>Sl(i,typeof r!="symbol"?r+"":r,n);import{_ as x}from"./media-vendor-Dp18sh1g.js";import{b as y,j as e,r as o,f as bl,h as wl}from"./react-vendor-D8Fi5F9E.js";import{u as pa,a as ma,b as Gr,L as ga,H as vl,R as _l,c as Se}from"./router-vendor-CTPwQFnc.js";import{C as Vn,j as yo,S as kl}from"./crypto-vendor-Cz32ecGD.js";import{F as Cl,a as Go,b as jl,c as Ys,d as Js,e as El,f as Tl,g as Rl,h as Al,i as Pl,j as Il,k as Zs,l as Ll,m as Ol,n as Bn,o as Gn,p as Dl,q as $l,r as Ml,s as zl,t as ha,u as Hn,v as Kn,w as Ul,x as Vl,y as ya,z as Xs,A as Bl,B as Nl,C as Fl,D as Wl,E as Gl,G as Hl,H as Kl}from"./icons-vendor-CfNiWYc_.js";import{c as ql}from"./state-vendor-De5qIGw3.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))m(c);new MutationObserver(c=>{for(const b of c)if(b.type==="childList")for(const j of b.addedNodes)j.tagName==="LINK"&&j.rel==="modulepreload"&&m(j)}).observe(document,{childList:!0,subtree:!0});function n(c){const b={};return c.integrity&&(b.integrity=c.integrity),c.referrerPolicy&&(b.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?b.credentials="include":c.crossOrigin==="anonymous"?b.credentials="omit":b.credentials="same-origin",b}function m(c){if(c.ep)return;c.ep=!0;const b=n(c);fetch(c.href,b)}})();var So;(function(i){i.Unimplemented="UNIMPLEMENTED",i.Unavailable="UNAVAILABLE"})(So||(So={}));class Mn extends Error{constructor(r,n,m){super(r),this.message=r,this.code=n,this.data=m}}const Yl=i=>{var r,n;return i?.androidBridge?"android":!((n=(r=i?.webkit)===null||r===void 0?void 0:r.messageHandlers)===null||n===void 0)&&n.bridge?"ios":"web"},Jl=i=>{const r=i.CapacitorCustomPlatform||null,n=i.Capacitor||{},m=n.Plugins=n.Plugins||{},c=()=>r!==null?r.name:Yl(i),b=()=>c()!=="web",j=D=>{const z=L.get(D);return!!(z?.platforms.has(c())||R(D))},R=D=>{var z;return(z=n.PluginHeaders)===null||z===void 0?void 0:z.find(ee=>ee.name===D)},E=D=>i.console.error(D),L=new Map,q=(D,z={})=>{const ee=L.get(D);if(ee)return console.warn(`Capacitor plugin "${D}" already registered. Cannot register plugins twice.`),ee.proxy;const H=c(),B=R(D);let U;const G=async()=>(!U&&H in z?U=typeof z[H]=="function"?U=await z[H]():U=z[H]:r!==null&&!U&&"web"in z&&(U=typeof z.web=="function"?U=await z.web():U=z.web),U),J=(Y,pe)=>{var be,ze;if(B){const X=B?.methods.find(ye=>pe===ye.name);if(X)return X.rtype==="promise"?ye=>n.nativePromise(D,pe.toString(),ye):(ye,Ue)=>n.nativeCallback(D,pe.toString(),ye,Ue);if(Y)return(be=Y[pe])===null||be===void 0?void 0:be.bind(Y)}else{if(Y)return(ze=Y[pe])===null||ze===void 0?void 0:ze.bind(Y);throw new Mn(`"${D}" plugin is not implemented on ${H}`,So.Unimplemented)}},fe=Y=>{let pe;const be=(...ze)=>{const X=G().then(ye=>{const Ue=J(ye,Y);if(Ue){const De=Ue(...ze);return pe=De?.remove,De}else throw new Mn(`"${D}.${Y}()" is not implemented on ${H}`,So.Unimplemented)});return Y==="addListener"&&(X.remove=async()=>pe()),X};return be.toString=()=>`${Y.toString()}() { [capacitor code] }`,Object.defineProperty(be,"name",{value:Y,writable:!1,configurable:!1}),be},ie=fe("addListener"),Z=fe("removeListener"),ne=(Y,pe)=>{const be=ie({eventName:Y},pe),ze=async()=>{const ye=await be;Z({eventName:Y,callbackId:ye},pe)},X=new Promise(ye=>be.then(()=>ye({remove:ze})));return X.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await ze()},X},ue=new Proxy({},{get(Y,pe){switch(pe){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return B?ne:ie;case"removeListener":return Z;default:return fe(pe)}}});return m[D]=ue,L.set(D,{name:D,proxy:ue,platforms:new Set([...Object.keys(z),...B?[H]:[]])}),ue};return n.convertFileSrc||(n.convertFileSrc=D=>D),n.getPlatform=c,n.handleError=E,n.isNativePlatform=b,n.isPluginAvailable=j,n.registerPlugin=q,n.Exception=Mn,n.DEBUG=!!n.DEBUG,n.isLoggingEnabled=!!n.isLoggingEnabled,n},Zl=i=>i.Capacitor=Jl(i),bo=Zl(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),qn=bo.registerPlugin;class xa{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(r,n){let m=!1;this.listeners[r]||(this.listeners[r]=[],m=!0),this.listeners[r].push(n);const b=this.windowListeners[r];b&&!b.registered&&this.addWindowListener(b),m&&this.sendRetainedArgumentsForEvent(r);const j=async()=>this.removeListener(r,n);return Promise.resolve({remove:j})}async removeAllListeners(){this.listeners={};for(const r in this.windowListeners)this.removeWindowListener(this.windowListeners[r]);this.windowListeners={}}notifyListeners(r,n,m){const c=this.listeners[r];if(!c){if(m){let b=this.retainedEventArguments[r];b||(b=[]),b.push(n),this.retainedEventArguments[r]=b}return}c.forEach(b=>b(n))}hasListeners(r){var n;return!!(!((n=this.listeners[r])===null||n===void 0)&&n.length)}registerWindowListener(r,n){this.windowListeners[n]={registered:!1,windowEventName:r,pluginEventName:n,handler:m=>{this.notifyListeners(n,m)}}}unimplemented(r="not implemented"){return new bo.Exception(r,So.Unimplemented)}unavailable(r="not available"){return new bo.Exception(r,So.Unavailable)}async removeListener(r,n){const m=this.listeners[r];if(!m)return;const c=m.indexOf(n);this.listeners[r].splice(c,1),this.listeners[r].length||this.removeWindowListener(this.windowListeners[r])}addWindowListener(r){window.addEventListener(r.windowEventName,r.handler),r.registered=!0}removeWindowListener(r){r&&(window.removeEventListener(r.windowEventName,r.handler),r.registered=!1)}sendRetainedArgumentsForEvent(r){const n=this.retainedEventArguments[r];n&&(delete this.retainedEventArguments[r],n.forEach(m=>{this.notifyListeners(r,m)}))}}const Qs=i=>encodeURIComponent(i).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),ea=i=>i.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class Xl extends xa{async getCookies(){const r=document.cookie,n={};return r.split(";").forEach(m=>{if(m.length<=0)return;let[c,b]=m.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");c=ea(c).trim(),b=ea(b).trim(),n[c]=b}),n}async setCookie(r){try{const n=Qs(r.key),m=Qs(r.value),c=`; expires=${(r.expires||"").replace("expires=","")}`,b=(r.path||"/").replace("path=",""),j=r.url!=null&&r.url.length>0?`domain=${r.url}`:"";document.cookie=`${n}=${m||""}${c}; path=${b}; ${j};`}catch(n){return Promise.reject(n)}}async deleteCookie(r){try{document.cookie=`${r.key}=; Max-Age=0`}catch(n){return Promise.reject(n)}}async clearCookies(){try{const r=document.cookie.split(";")||[];for(const n of r)document.cookie=n.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(r){return Promise.reject(r)}}async clearAllCookies(){try{await this.clearCookies()}catch(r){return Promise.reject(r)}}}qn("CapacitorCookies",{web:()=>new Xl});const Ql=async i=>new Promise((r,n)=>{const m=new FileReader;m.onload=()=>{const c=m.result;r(c.indexOf(",")>=0?c.split(",")[1]:c)},m.onerror=c=>n(c),m.readAsDataURL(i)}),ec=(i={})=>{const r=Object.keys(i);return Object.keys(i).map(c=>c.toLocaleLowerCase()).reduce((c,b,j)=>(c[b]=i[r[j]],c),{})},tc=(i,r=!0)=>i?Object.entries(i).reduce((m,c)=>{const[b,j]=c;let R,E;return Array.isArray(j)?(E="",j.forEach(L=>{R=r?encodeURIComponent(L):L,E+=`${b}=${R}&`}),E.slice(0,-1)):(R=r?encodeURIComponent(j):j,E=`${b}=${R}`),`${m}&${E}`},"").substr(1):null,oc=(i,r={})=>{const n=Object.assign({method:i.method||"GET",headers:i.headers},r),c=ec(i.headers)["content-type"]||"";if(typeof i.data=="string")n.body=i.data;else if(c.includes("application/x-www-form-urlencoded")){const b=new URLSearchParams;for(const[j,R]of Object.entries(i.data||{}))b.set(j,R);n.body=b.toString()}else if(c.includes("multipart/form-data")||i.data instanceof FormData){const b=new FormData;if(i.data instanceof FormData)i.data.forEach((R,E)=>{b.append(E,R)});else for(const R of Object.keys(i.data))b.append(R,i.data[R]);n.body=b;const j=new Headers(n.headers);j.delete("content-type"),n.headers=j}else(c.includes("application/json")||typeof i.data=="object")&&(n.body=JSON.stringify(i.data));return n};class rc extends xa{async request(r){const n=oc(r,r.webFetchExtra),m=tc(r.params,r.shouldEncodeUrlParams),c=m?`${r.url}?${m}`:r.url,b=await fetch(c,n),j=b.headers.get("content-type")||"";let{responseType:R="text"}=b.ok?r:{};j.includes("application/json")&&(R="json");let E,L;switch(R){case"arraybuffer":case"blob":L=await b.blob(),E=await Ql(L);break;case"json":E=await b.json();break;default:E=await b.text()}const q={};return b.headers.forEach((D,z)=>{q[z]=D}),{data:E,headers:q,status:b.status,url:b.url}}async get(r){return this.request(Object.assign(Object.assign({},r),{method:"GET"}))}async post(r){return this.request(Object.assign(Object.assign({},r),{method:"POST"}))}async put(r){return this.request(Object.assign(Object.assign({},r),{method:"PUT"}))}async patch(r){return this.request(Object.assign(Object.assign({},r),{method:"PATCH"}))}async delete(r){return this.request(Object.assign(Object.assign({},r),{method:"DELETE"}))}}qn("CapacitorHttp",{web:()=>new rc});const nc=qn("GoogleAuth",{web:()=>x(()=>import("./web-BPVhH1jM.js"),__vite__mapDeps([0,1,2,3,4,5,6])).then(i=>new i.GoogleAuthWeb)});let sc=class extends y.Component{constructor(n){super(n);Dr(this,"reportError",async(n,m)=>{try{await fetch("/api/errors/report/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({error:n.toString(),stack:m.componentStack,url:window.location.href,userAgent:navigator.userAgent,timestamp:new Date().toISOString()})})}catch(c){console.error("Failed to report error:",c)}});Dr(this,"handleReset",()=>{this.setState({hasError:!1,error:null,errorInfo:null})});this.state={hasError:!1,error:null,errorInfo:null,errorCount:0}}static getDerivedStateFromError(n){return{hasError:!0}}componentDidCatch(n,m){console.error("Error Boundary caught error:",n,m),this.setState({error:n,errorInfo:m,errorCount:this.state.errorCount+1}),window.gtag&&window.gtag("event","exception",{description:n.toString(),fatal:!1}),this.reportError(n,m)}render(){return this.state.hasError?this.state.errorCount>3?e.jsx("div",{className:"error-boundary critical",children:e.jsxs("div",{className:"error-content",children:[e.jsx("h1",{children:"‚ö†Ô∏è Critical Error"}),e.jsx("p",{children:"Multiple errors detected. Please refresh the page."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"btn-reload",children:"Refresh Page"})]})}):e.jsx("div",{className:"error-boundary",children:e.jsxs("div",{className:"error-content",children:[e.jsx("div",{className:"error-icon",children:"üòï"}),e.jsx("h1",{children:"Oops! Something went wrong"}),e.jsx("p",{className:"error-message",children:this.props.fallbackMessage||"We're sorry for the inconvenience. The error has been reported."}),!1,e.jsxs("div",{className:"error-actions",children:[e.jsx("button",{onClick:this.handleReset,className:"btn-retry",children:"Try Again"}),e.jsx("button",{onClick:()=>window.location.href="/",className:"btn-home",children:"Go Home"})]})]})}):this.props.children}},mo=null;function ac(){return mo||(mo=document.createElement("div"),mo.id="toast-container",mo.style.cssText=`
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 999999;
            display: flex;
            flex-direction: column;
            gap: 10px;
            pointer-events: none;
        `,document.body.appendChild(mo)),mo}function Wo(i,r="info",n=3e3){const m=ac(),c=document.createElement("div");c.className=`toast toast-${r}`;let b="‚ÑπÔ∏è",j="#3b82f6";switch(r){case"success":b="‚úÖ",j="#10b981";break;case"error":b="‚ùå",j="#ef4444";break;case"warning":b="‚ö†Ô∏è",j="#f59e0b";break;case"info":b="‚ÑπÔ∏è",j="#3b82f6";break}c.style.cssText=`
        background: ${j};
        color: white;
        padding: 12px 20px;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        display: flex;
        align-items: center;
        gap: 10px;
        min-width: 300px;
        max-width: 500px;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        font-size: 14px;
        pointer-events: all;
        animation: slideIn 0.3s ease-out;
        transition: opacity 0.3s ease-out;
    `,c.innerHTML=`
        <span style="font-size: 20px;">${b}</span>
        <span style="flex: 1;">${i}</span>
        <button onclick="this.parentElement.remove()" style="
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s;
        " onmouseover="this.style.background='rgba(255,255,255,0.3)'" 
           onmouseout="this.style.background='rgba(255,255,255,0.2)'">√ó</button>
    `,m.appendChild(c);const R=document.createElement("style");R.textContent=`
        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        @keyframes slideOut {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(400px);
                opacity: 0;
            }
        }
    `,document.getElementById("toast-styles")||(R.id="toast-styles",document.head.appendChild(R)),setTimeout(()=>{c.style.animation="slideOut 0.3s ease-out",setTimeout(()=>c.remove(),300)},n)}const V={success:(i,r)=>Wo(i,"success",r),error:(i,r)=>Wo(i,"error",r),warning:(i,r)=>Wo(i,"warning",r),info:(i,r)=>Wo(i,"info",r)};typeof window<"u"&&(window.toast=V,window.showToast=Wo);const ic=async()=>{if(typeof window<"u"&&(window.process?.versions?.electron||window.navigator?.userAgent?.toLowerCase().includes("electron")||window.location?.protocol==="file:"))return console.log("‚ö†Ô∏è [PWA] Service Worker disabled in Electron (file:// protocol)"),null;if("serviceWorker"in navigator)try{const r=await navigator.serviceWorker.register("/service-worker.js",{scope:"/"});return console.log("‚úÖ Service Worker registered:",r.scope),r.addEventListener("updatefound",()=>{const n=r.installing;console.log("üîÑ New Service Worker installing..."),n.addEventListener("statechange",()=>{n.state==="installed"&&navigator.serviceWorker.controller&&lc()})}),setInterval(()=>{r.update()},3600*1e3),r}catch(r){return console.error("‚ùå Service Worker registration failed:",r),null}},lc=()=>{console.log("‚ÑπÔ∏è Yeni versiyon mevcut - UI g√ºncelleme butonu aktif")},cc=()=>{window.addEventListener("beforeinstallprompt",i=>{i.preventDefault();const r=document.getElementById("install-pwa-button");r&&(r.style.display="block"),console.log("üì± PWA install prompt ready")}),window.addEventListener("appinstalled",()=>{console.log("‚úÖ PWA installed successfully"),window.gtag&&window.gtag("event","pwa_installed",{event_category:"PWA",event_label:"App Installed"})})},dc=(i,r)=>{const n=()=>{console.log("‚úÖ Network: Online"),i&&i(),ta("üü¢ √áevrimi√ßi","success")},m=()=>{console.log("‚ùå Network: Offline"),r&&r(),ta("üî¥ √áevrimdƒ±≈üƒ± - Baƒülantƒ± koptu","error")};return window.addEventListener("online",n),window.addEventListener("offline",m),navigator.onLine||m(),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",m)}},ta=(i,r="info")=>{const n=document.getElementById("network-banner");n&&n.remove();const m=document.createElement("div");m.id="network-banner",m.textContent=i,m.style.cssText=`
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        padding: 12px;
        text-align: center;
        color: white;
        font-weight: 600;
        z-index: 9999;
        animation: slideDown 0.3s ease;
        background: ${r==="success"?"#43b581":"#ed4245"};
    `,document.body.appendChild(m),r==="success"&&setTimeout(()=>{m.style.animation="slideUp 0.3s ease",setTimeout(()=>m.remove(),300)},3e3)},uc=()=>{const i=document.createElement("style");i.textContent=`
        @keyframes slideDown {
            from { transform: translateY(-100%); }
            to { transform: translateY(0); }
        }
        
        @keyframes slideUp {
            from { transform: translateY(0); }
            to { transform: translateY(-100%); }
        }
    `,document.head.appendChild(i)};uc();const fc=`
/* üé® PAWSCORD Critical CSS - Above the Fold */

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Whitney', 'Helvetica Neue', Helvetica, Arial, sans-serif;
    background-color: #1e1f22;
    color: #dcddde;
    overflow: hidden;
}

/* Loading Screen */
#loading-screen {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: #1e1f22;
    display: flex;
    align-items: center;
    justify-center: center;
    z-index: 9999;
}

.spinner {
    width: 50px;
    height: 50px;
    border: 4px solid #40444b;
    border-top-color: #5865f2;
    border-radius: 50%;
    animation: spin 1s linear infinite;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

/* Main Layout */
#root {
    width: 100vw;
    height: 100vh;
    overflow: hidden;
}

.app-container {
    display: flex;
    width: 100%;
    height: 100%;
}

/* Sidebar */
.sidebar {
    width: 240px;
    background: #2b2d31;
    flex-shrink: 0;
}

/* Chat Area */
.chat-container {
    flex: 1;
    display: flex;
    flex-direction: column;
    background: #313338;
}

/* Message Input - Critical */
.message-input-container {
    padding: 16px;
    background: #383a40;
}

.message-input {
    width: 100%;
    padding: 12px;
    background: #40444b;
    border: none;
    border-radius: 8px;
    color: #dcddde;
    font-size: 15px;
    outline: none;
}

/* Button Base */
button {
    cursor: pointer;
    border: none;
    background: transparent;
    color: inherit;
    font-family: inherit;
}

.btn-primary {
    background: #5865f2;
    color: white;
    padding: 10px 16px;
    border-radius: 4px;
    font-weight: 500;
    transition: background 0.17s ease;
}

.btn-primary:hover {
    background: #4752c4;
}

/* Scrollbar */
::-webkit-scrollbar {
    width: 8px;
    height: 8px;
}

::-webkit-scrollbar-track {
    background: #2b2d31;
}

::-webkit-scrollbar-thumb {
    background: #1a1b1e;
    border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
    background: #141517;
}

/* Typography */
h1, h2, h3, h4, h5, h6 {
    font-weight: 600;
    line-height: 1.2;
}

/* Utilities */
.flex {
    display: flex;
}

.flex-col {
    flex-direction: column;
}

.items-center {
    align-items: center;
}

.justify-center {
    justify-content: center;
}

.gap-2 {
    gap: 8px;
}

.gap-4 {
    gap: 16px;
}

.hidden {
    display: none !important;
}

/* Mobile Responsive */
@media (max-width: 768px) {
    .sidebar {
        width: 100%;
        position: absolute;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.3s ease;
    }
    
    .sidebar.open {
        transform: translateX(0);
    }
}
`,pc=()=>{const i=document.createElement("style");i.id="critical-css",i.textContent=fc,document.head.insertBefore(i,document.head.firstChild),console.log("‚úÖ Critical CSS inlined")},mc=i=>new Promise((r,n)=>{const m=document.createElement("link");m.rel="stylesheet",m.href=i,m.onload=()=>{console.log(`‚úÖ Lazy loaded CSS: ${i}`),r()},m.onerror=n,document.head.appendChild(m)}),gc=()=>{const i=[],r=()=>{i.forEach(n=>{mc(n)})};"requestIdleCallback"in window?requestIdleCallback(r):setTimeout(r,1)},hc=()=>{if(typeof window<"u"&&(window.process?.versions?.electron||window.navigator?.userAgent?.includes("Electron")||window.location?.protocol==="file:")){console.log("‚ö° [Performance] Electron'da font preload atlandƒ±");return}console.log("‚ö° [Performance] Font preload atlandƒ± - system fonts kullanƒ±lƒ±yor")},yc=()=>{if(typeof window<"u"&&(window.process?.versions?.electron||window.navigator?.userAgent?.includes("Electron")||window.location?.protocol==="file:")){console.log("‚ÑπÔ∏è Preload skipped: Electron detected");return}console.log("‚úÖ Key resources preloaded")},oa=()=>{const i=document.getElementById("critical-css");i&&setTimeout(()=>{i.remove(),console.log("üóëÔ∏è Critical CSS removed (full CSS loaded)")},1e3)},xc=()=>{pc(),yc(),hc(),gc(),document.readyState==="complete"?oa():window.addEventListener("load",oa)},Br={serverSettings:()=>x(()=>import("./ServerSettingsModal-FE5ow_H-.js"),__vite__mapDeps([7,2,5,8,9,10,11,1,3,4,6])),userProfile:()=>x(()=>import("./UserProfileModal-B1XiVkUh.js"),__vite__mapDeps([12,2,5,1,3,4,6])),imageModal:()=>x(()=>import("./ImageModal-DvMxeGLp.js"),__vite__mapDeps([13,2])),gifPicker:()=>x(()=>import("./GifPicker-D7YGUzBv.js"),__vite__mapDeps([14,2])),stickerPicker:()=>x(()=>import("./StickerPicker-TWKP2FiL.js"),__vite__mapDeps([15,2])),soundboard:()=>x(()=>import("./SoundboardModal-Ci6ZSUq8.js"),__vite__mapDeps([16,2,5])),watchParty:()=>x(()=>import("./WatchPartyEnhanced-CC3dwbgb.js"),__vite__mapDeps([17,2,5])),cinema:()=>x(()=>import("./CinemaModal-CA_FSz-7.js"),__vite__mapDeps([18,1,2,5])),whiteboard:()=>x(()=>import("./WhiteboardModal-Bt_-grsQ.js"),__vite__mapDeps([19,2,5])),poll:()=>x(()=>import("./PollCreateModal-DicI4JEE.js"),__vite__mapDeps([20,2,5])),codeSnippet:()=>x(()=>import("./CodeSnippetModal-HqRam3JM.js"),__vite__mapDeps([21,2,5])),messageTemplate:()=>x(()=>import("./MessageTemplateModal-3oMjA6Ei.js"),__vite__mapDeps([22,2,5]))},Sa=()=>{const i=[Br.userProfile,Br.imageModal];setTimeout(()=>{i.forEach(r=>r())},3e3)},Nn=()=>{"requestIdleCallback"in window&&requestIdleCallback(()=>{Br.gifPicker(),Br.stickerPicker()})},Fn={default:{name:"Pawscord Dark",colors:{"--background-primary":"#313338","--background-secondary":"#2b2d31","--background-tertiary":"#1e1f22","--background-accent":"#404249","--text-primary":"#dbdee1","--text-secondary":"#949ba4","--text-muted":"#787f89","--text-link":"#00a8fc","--button-primary":"#5865f2","--button-secondary":"#4e5058","--border-primary":"#1f2023"}},midnight:{name:"Midnight AMOLED",colors:{"--background-primary":"#000000","--background-secondary":"#0a0a0a","--background-tertiary":"#111111","--background-accent":"#222222","--text-primary":"#ffffff","--text-secondary":"#b0b0b0","--text-muted":"#666666","--text-link":"#3ea6ff","--button-primary":"#3ea6ff","--button-secondary":"#333333","--border-primary":"#333333"}},dracula:{name:"Dracula",colors:{"--background-primary":"#282a36","--background-secondary":"#44475a","--background-tertiary":"#6272a4","--background-accent":"#44475a","--text-primary":"#f8f8f2","--text-secondary":"#bfbfbf","--text-muted":"#6272a4","--text-link":"#8be9fd","--button-primary":"#bd93f9","--button-secondary":"#44475a","--border-primary":"#44475a"}},ocean:{name:"Deep Ocean",colors:{"--background-primary":"#0f172a","--background-secondary":"#1e293b","--background-tertiary":"#334155","--background-accent":"#334155","--text-primary":"#e2e8f0","--text-secondary":"#94a3b8","--text-muted":"#64748b","--text-link":"#38bdf8","--button-primary":"#0ea5e9","--button-secondary":"#334155","--border-primary":"#1e293b"}},forest:{name:"Enchanted Forest",colors:{"--background-primary":"#1a2f1a","--background-secondary":"#243b24","--background-tertiary":"#2f4b2f","--background-accent":"#3a5a3a","--text-primary":"#e0ffe0","--text-secondary":"#a0cca0","--text-muted":"#608060","--text-link":"#4caf50","--button-primary":"#4caf50","--button-secondary":"#2f4b2f","--border-primary":"#2f4b2f"}},matrix:{name:"The Matrix",colors:{"--background-primary":"#0d0d0d","--background-secondary":"#121212","--background-tertiary":"#1a1a1a","--background-accent":"#003b00","--text-primary":"#00ff41","--text-secondary":"#008f11","--text-muted":"#003b00","--text-link":"#00ff41","--button-primary":"#008f11","--button-secondary":"#003b00","--border-primary":"#003b00"}},sunset:{name:"Sunset Vibes",colors:{"--background-primary":"#2d1b2e","--background-secondary":"#442740","--background-tertiary":"#5a3450","--background-accent":"#734361","--text-primary":"#ffccaa","--text-secondary":"#ff9e7d","--text-muted":"#b05963","--text-link":"#ffbd69","--button-primary":"#ff6b6b","--button-secondary":"#5a3450","--border-primary":"#5a3450"}}},Sc=i=>{const r=Fn[i]||Fn.default,n=document.documentElement;Object.entries(r.colors).forEach(([m,c])=>{n.style.setProperty(m,c)}),localStorage.setItem("pawscord_theme",i)},bc=()=>{const i=localStorage.getItem("pawscord_theme");return i&&Fn[i]?(Sc(i),i):"default"},Ce=ql((i,r)=>({messages:[],encryptionKeys:{},activeChat:{type:"welcome",id:"welcome",targetUser:null},unreadCounts:{},typingUsers:[],onlineUsers:[],voiceUsers:{},currentPermissions:{is_owner:!1,can_manage_channels:!1,can_delete_messages:!1,can_manage_roles:!1,can_ban_members:!1},setActiveChat:(n,m,c=null)=>{console.log("üîÑ [Store] setActiveChat called:",{type:n,id:m,targetUser:c}),console.log("üîÑ [Store] Current messages count:",r().messages.length),i({activeChat:{type:n,id:m,targetUser:c}});const b=n==="room"?`room-${m}`:`dm-${m}`;i(j=>{const R={...j.unreadCounts};return delete R[b],{unreadCounts:R}})},addMessage:n=>i(m=>!n||typeof n!="object"||!n.id?(console.warn("‚ö†Ô∏è [Store] Invalid message rejected:",n),m):n.temp_id&&m.messages.some(b=>b.temp_id===n.temp_id)?{messages:m.messages.map(b=>b.temp_id===n.temp_id?n:b)}:m.messages.some(c=>c.id===n.id)?m:{messages:[...m.messages,n]}),updateMessage:(n,m)=>i(c=>({messages:c.messages.map(b=>b.id===n?{...b,...m}:b)})),setMessages:n=>i(m=>{const c=typeof n=="function"?n(m.messages):n;return{messages:Array.isArray(c)?c.filter(j=>j&&typeof j=="object"&&j.id):[]}}),prependMessages:n=>i(m=>({messages:[...n,...m.messages]})),incrementUnread:n=>i(m=>({unreadCounts:{...m.unreadCounts,[n]:(m.unreadCounts[n]||0)+1}})),setOnlineUsers:n=>i({onlineUsers:n}),setTypingUser:(n,m)=>i(c=>m?{typingUsers:c.typingUsers.includes(n)?c.typingUsers:[...c.typingUsers,n]}:{typingUsers:c.typingUsers.filter(b=>b!==n)}),setVoiceUsers:n=>i({voiceUsers:n}),setEncryptionKey:(n,m)=>i(c=>({encryptionKeys:{...c.encryptionKeys,[n]:m}})),setPermissions:n=>i({currentPermissions:n||{is_owner:!1,can_manage_channels:!1,can_delete_messages:!1,can_manage_roles:!1,can_ban_members:!1}})})),Nr="ENC::",wc=(i,r)=>{if(!i||!r)return i;try{const n=Vn.AES.encrypt(i,r).toString();return Nr+n}catch(n){return console.error("≈ûifreleme hatasƒ±:",n),i}},pp=(i,r)=>{if(!i||!i.startsWith(Nr)||!r)return i;try{const n=i.replace(Nr,""),c=Vn.AES.decrypt(n,r).toString(Vn.enc.Utf8);return c||"üîí ≈ûifreli Mesaj (Anahtar Yanlƒ±≈ü)"}catch(n){return console.error("≈ûifre √ß√∂zme hatasƒ±:",n),"üîí √á√∂z√ºlemedi"}},mp=i=>i&&typeof i=="string"&&i.startsWith(Nr),Qe={mobile:768,tablet:1024,desktop:1920,ultrawide:2560},vc=()=>{const[i,r]=o.useState({width:typeof window<"u"?window.innerWidth:1920,height:typeof window<"u"?window.innerHeight:1080});o.useEffect(()=>{if(typeof window>"u")return;let c;const b=()=>{clearTimeout(c),c=setTimeout(()=>{r({width:window.innerWidth,height:window.innerHeight})},150)};return b(),window.addEventListener("resize",b),window.addEventListener("orientationchange",b),()=>{clearTimeout(c),window.removeEventListener("resize",b),window.removeEventListener("orientationchange",b)}},[]);const{width:n,height:m}=i;return{isMobile:n<=Qe.mobile,isTablet:n>Qe.mobile&&n<=Qe.tablet,isDesktop:n>Qe.tablet&&n<=Qe.desktop,isUltrawide:n>Qe.desktop,width:n,height:m,orientation:m>n?"portrait":"landscape",isSmallScreen:n<=Qe.mobile,isMediumScreen:n>Qe.mobile&&n<=Qe.tablet,isLargeScreen:n>Qe.tablet,isTouchDevice:typeof window<"u"&&("ontouchstart"in window||navigator.maxTouchPoints>0),breakpoints:Qe}},_c=(i,r,n)=>o.useMemo(()=>{if(!i||!Array.isArray(i))return[];let c=i;if(r&&typeof r=="string"&&r.trim()){const b=r.toLowerCase();c=c.filter(j=>j.content?.toLowerCase().includes(b)||j.user?.username?.toLowerCase().includes(b))}return c.sort((b,j)=>{const R=new Date(b.created_at||b.timestamp),E=new Date(j.created_at||j.timestamp);return R-E})},[i,r]),kc=i=>o.useMemo(()=>!i||!Array.isArray(i)?[]:i.filter(r=>r.is_online||r.online),[i]),Cc=typeof window<"u"&&typeof window.require=="function",jc=typeof window<"u"&&window.Capacitor?.isNativePlatform?.(),Ec=!0,Tc=typeof window<"u"&&window.location?.hostname?.includes("pawscord.com"),ra=8888,Yn=()=>{if(jc||Cc&&Ec||Tc)return"https://api.pawscord.com";if(typeof window<"u"){const i=window.location?.hostname;return i==="localhost"||i==="127.0.0.1"?`http://${i}:${ra}`:`${window.location.protocol}//${i}:${ra}`}return"https://api.pawscord.com"},Rc=()=>`${Yn()}/api`,Ac=()=>Yn().startsWith("https")?"wss":"ws",Pc=()=>Yn().replace(/^https?:\/\//,""),Ic={API_BASE_URL:Rc(),WS_PROTOCOL:Ac(),API_HOSTNAME:Pc()},Lc=Ic.API_BASE_URL,Oc=()=>{let i=sessionStorage.getItem("analytics_session_id");return i||(i=`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,sessionStorage.setItem("analytics_session_id",i)),i},Dc=()=>{const i=pa();o.useEffect(()=>{(async()=>{try{const n=Oc();await fetch(`${Lc}/analytics/track/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:i.pathname,session_id:n,referrer:document.referrer,timestamp:new Date().toISOString()})}),console.log("üìä Page tracked:",i.pathname)}catch(n){console.error("Analytics tracking error:",n)}})()},[i.pathname])},$c=(i,r)=>{const n=o.useRef(null);return o.useCallback((...m)=>{n.current&&clearTimeout(n.current),n.current=setTimeout(()=>{i(...m)},r)},[i,r])},Mc=(i,r)=>{const n=o.useRef(Date.now());return o.useCallback((...m)=>{const c=Date.now();c-n.current>=r&&(i(...m),n.current=c)},[i,r])},gp=i=>{const r=o.useRef(0),n=o.useRef(0);o.useEffect(()=>{const m=performance.now();return r.current+=1,()=>{const b=performance.now()-m;n.current+=b,r.current%10===0&&console.log(`üéØ ${i} Performance Stats:`,`
  Total Renders: ${r.current}`,`
  Average Time: ${(n.current/r.current).toFixed(2)}ms`,`
  Last Render: ${b.toFixed(2)}ms`)}})},zc="192.168.68.53",Uc="8888",Jn=typeof window>"u"?!1:!!(typeof window.require=="function"||typeof process<"u"&&process.versions&&process.versions.electron||navigator.userAgent.toLowerCase().includes("electron")||window.location.protocol==="file:"),ba=bo.isNativePlatform(),Jt=ba||Jn||!window.location.hostname.includes("localhost")&&!window.location.hostname.includes("192.168.")?"https://api.pawscord.com":`http://${zc}:${Uc}`,Vc=`${Jt}/api`;ba||Jn||window.location.hostname.includes("localhost");const Fr=Jt.startsWith("https")?"wss":"ws",Wr=Jt.replace(/^https?:\/\//,""),wa=o.createContext(null),Bc=Jt,Nc=({children:i})=>{const r=localStorage.getItem("access_token"),n=(()=>{if(!r)return!1;try{return yo(r).exp>Date.now()/1e3-300}catch{return!1}})(),[m,c]=o.useState(n?{username:localStorage.getItem("chat_username")||""}:null),[b,j]=o.useState(r),[R,E]=o.useState(n),[L,q]=o.useState(!1),D=o.useRef(null),z=o.useCallback(async()=>{const U=localStorage.getItem("refresh_token");if(!U)return console.warn("‚ö†Ô∏è [Auth] No refresh token available"),B(),!1;try{console.log("üîÑ [Auth] Refreshing access token...");const G=await fetch(`${Bc}/api/auth/token/refresh/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh:U})});if(G.ok){const J=await G.json();localStorage.setItem("access_token",J.access),J.refresh&&localStorage.setItem("refresh_token",J.refresh);const fe=yo(J.access);return j(J.access),c({username:fe.username}),E(!0),console.log("‚úÖ [Auth] Token refreshed successfully"),ee(J.access),!0}else return console.error("‚ùå [Auth] Token refresh failed:",G.status),B(),!1}catch(G){return console.error("‚ùå [Auth] Token refresh error:",G),B(),!1}},[]),ee=o.useCallback(U=>{D.current&&clearTimeout(D.current);try{const G=yo(U),J=Date.now()/1e3,fe=G.exp-J,ie=Math.max((fe-300)*1e3,6e4);console.log(`‚è∞ [Auth] Token will refresh in ${Math.round(ie/1e3/60)} minutes`),D.current=setTimeout(()=>{z()},ie)}catch(G){console.error("‚ùå [Auth] Failed to schedule token refresh:",G)}},[z]);o.useEffect(()=>{const U=localStorage.getItem("access_token");if(U)try{const G=yo(U),J=Date.now()/1e3,fe=300,ie=G.exp>J-fe;console.log("üîê [Auth] Token check:",{exp:G.exp,currentTime:J,gracePeriod:fe,isValid:ie,username:G.username}),ie?(j(U),c({username:G.username}),E(!0),localStorage.setItem("chat_username",G.username),ee(U),console.log("‚úÖ [Auth] User authenticated:",G.username)):(console.warn("‚ö†Ô∏è [Auth] Token expired, attempting refresh..."),z())}catch(G){console.error("‚ùå [Auth] Invalid token:",G),B()}else console.log("‚ÑπÔ∏è [Auth] No token found");return()=>{D.current&&clearTimeout(D.current)}},[ee,z]);const H=(U,G)=>{console.log("üîì [Auth] Login called");try{localStorage.setItem("access_token",U),localStorage.setItem("refresh_token",G);const J=yo(U);localStorage.setItem("chat_username",J.username),console.log("‚úÖ [Auth] Login successful, user:",J.username),j(U),c({username:J.username}),E(!0),ee(U)}catch(J){console.error("‚ùå [Auth] Login failed:",J),B()}},B=o.useCallback(()=>{D.current&&clearTimeout(D.current),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("chat_username"),j(null),c(null),E(!1)},[]);return e.jsx(wa.Provider,{value:{user:m,token:b,isAuthenticated:R,login:H,logout:B,isLoading:L,refreshAccessToken:z},children:i})},Ho=()=>o.useContext(wa),Re={log:(...i)=>{},warn:(...i)=>{},error:(...i)=>{console.error(...i)},debug:(...i)=>{},voice:(...i)=>{},webrtc:(...i)=>{},signal:(...i)=>{},audio:(...i)=>{}};class Fc{constructor(){this.audioContext=null,this.masterGain=null,this.spatialNodes={},this.listenerPosition={x:0,y:0,z:0},this.initialized=!1}async initialize(){if(!this.initialized)try{const r=window.AudioContext||window.webkitAudioContext;this.audioContext=new r,this.masterGain=this.audioContext.createGain(),this.masterGain.gain.value=1,this.masterGain.connect(this.audioContext.destination),this.audioContext.state==="suspended"&&await this.audioContext.resume(),this.setupListener(),this.initialized=!0,console.log("üéß Spatial Audio Engine initialized")}catch(r){throw console.error("Failed to initialize spatial audio:",r),r}}setupListener(){const r=this.audioContext.listener;r.positionX?(r.positionX.value=this.listenerPosition.x,r.positionY.value=this.listenerPosition.y,r.positionZ.value=this.listenerPosition.z):r.setPosition(this.listenerPosition.x,this.listenerPosition.y,this.listenerPosition.z),r.forwardX?(r.forwardX.value=0,r.forwardY.value=0,r.forwardZ.value=-1,r.upX.value=0,r.upY.value=1,r.upZ.value=0):r.setOrientation(0,0,-1,0,1,0)}addUser(r,n,m={x:0,y:0,z:-1}){if(!this.initialized)return console.warn("Spatial audio not initialized"),null;this.spatialNodes[r]&&this.removeUser(r);try{const c=this.audioContext.createMediaStreamSource(n),b=this.audioContext.createPanner();b.panningModel="HRTF",b.distanceModel="inverse",b.refDistance=1,b.maxDistance=1e4,b.rolloffFactor=1.5,b.coneInnerAngle=360,b.coneOuterAngle=360,b.coneOuterGain=0,this.setUserPosition(r,m,b);const j=this.audioContext.createGain();j.gain.value=1;const R=this.audioContext.createAnalyser();return R.fftSize=256,R.smoothingTimeConstant=.8,c.connect(R),R.connect(b),b.connect(j),j.connect(this.masterGain),this.spatialNodes[r]={source:c,panner:b,gain:j,analyser:R,position:m,audioElement:null},console.log(`üéß Added spatial audio for ${r} at position`,m),this.spatialNodes[r]}catch(c){return console.error(`Failed to add spatial audio for ${r}:`,c),null}}setUserPosition(r,n,m=null){const c=m||this.spatialNodes[r]?.panner;c&&(c.positionX?(c.positionX.setValueAtTime(n.x,this.audioContext.currentTime),c.positionY.setValueAtTime(n.y,this.audioContext.currentTime),c.positionZ.setValueAtTime(n.z,this.audioContext.currentTime)):c.setPosition(n.x,n.y,n.z),this.spatialNodes[r]&&(this.spatialNodes[r].position=n))}setUserVolume(r,n){const m=this.spatialNodes[r];if(!m)return;const c=Math.max(0,Math.min(1,n));m.gain.gain.setValueAtTime(c,this.audioContext.currentTime)}getVoiceActivity(r){const n=this.spatialNodes[r];if(!n)return 0;const m=n.analyser,c=new Uint8Array(m.frequencyBinCount);m.getByteFrequencyData(c);const j=c.reduce((R,E)=>R+E,0)/c.length;return Math.round(j/255*100)}removeUser(r){const n=this.spatialNodes[r];if(n)try{n.source.disconnect(),n.analyser.disconnect(),n.panner.disconnect(),n.gain.disconnect(),delete this.spatialNodes[r],console.log(`üéß Removed spatial audio for ${r}`)}catch(m){console.error(`Error removing spatial audio for ${r}:`,m)}}updateListenerPosition(r){this.listenerPosition=r,this.setupListener()}setMasterVolume(r){if(!this.masterGain)return;const n=Math.max(0,Math.min(1,r));this.masterGain.gain.setValueAtTime(n,this.audioContext.currentTime)}setUserMuted(r,n){this.setUserVolume(r,n?0:1)}destroy(){Object.keys(this.spatialNodes).forEach(r=>{this.removeUser(r)}),this.audioContext&&(this.audioContext.close(),this.audioContext=null),this.initialized=!1,console.log("üéß Spatial Audio Engine destroyed")}getUserDistance(r){const n=this.spatialNodes[r];if(!n)return 1/0;const m=n.position,c=this.listenerPosition;return Math.sqrt(Math.pow(m.x-c.x,2)+Math.pow(m.y-c.y,2)+Math.pow(m.z-c.z,2))}arrangeUsersInCircle(r,n=3){const m={},c=2*Math.PI/r.length;return r.forEach((b,j)=>{const R=c*j,E={x:Math.cos(R)*n,y:0,z:Math.sin(R)*n};m[b]=E,this.setUserPosition(b,E)}),m}}const Fo=new Fc,va=o.createContext(null),Yt=[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun2.l.google.com:19302"},{urls:"stun:stun3.l.google.com:19302"},{urls:"stun:stun4.l.google.com:19302"},{urls:"stun:stun.cloudflare.com:3478"},{urls:"stun:stun.services.mozilla.com:3478"},{urls:"stun:stun.stunprotocol.org:3478"},{urls:"turn:openrelay.metered.ca:80",username:"openrelayproject",credential:"openrelayproject"},{urls:"turn:openrelay.metered.ca:443",username:"openrelayproject",credential:"openrelayproject"},{urls:"turn:openrelay.metered.ca:443?transport=tcp",username:"openrelayproject",credential:"openrelayproject"}];let Wn={iceServers:Yt,iceCandidatePoolSize:10,iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"};const $r=i=>{Wn={...Wn,iceServers:i}};console.log("[VoiceContext] üéØ isElectron:",Jn,"API_URL:",Jt,"WS_PROTOCOL:",Fr,"API_HOST:",Wr);const Wc=({children:i})=>{const{user:r,token:n}=Ho(),m=r?.username,[c,b]=o.useState(!1),[j,R]=o.useState(!1),[E,L]=o.useState(null),[q,D]=o.useState(!1),[z,ee]=o.useState(!1),[H,B]=o.useState(!1),[U,G]=o.useState(!1),[J,fe]=o.useState(!1),[ie,Z]=o.useState(!1),[ne,ue]=o.useState(0),[Y,pe]=o.useState(null),[be,ze]=o.useState(50),[X,ye]=o.useState(null),[Ue,De]=o.useState(null),[St,Ke]=o.useState(null),[Ee,ct]=o.useState({}),[qo,l]=o.useState([]),[Hr,Zt]=o.useState(null),[Kr,Yo]=o.useState({isActive:!1,url:"https://www.youtube.com/watch?v=jfKfPfyJRdk",playing:!1,time:0,lastSyncAction:null,timestamp:0}),[de,Ae]=o.useState({gameType:"rps",moves:{},result:null,players:[],currentTurn:null}),[Jo,Zo]=o.useState({}),[qr,Yr]=o.useState(()=>{try{return parseInt(localStorage.getItem("pawscord_noise_gate"))||-50}catch{return-50}}),[Jr,Zr]=o.useState(()=>{try{return localStorage.getItem("pawscord_noise_gate_enabled")!=="false"}catch{return!0}}),[Xo,Qo]=o.useState({local:new Uint8Array(128),remote:{}}),[bt,Xr]=o.useState(()=>{try{return localStorage.getItem("pawscord_visualizer")==="true"}catch{return!1}}),[Xt,Qr]=o.useState(()=>{try{return JSON.parse(localStorage.getItem("pawscord_user_volumes"))||{}}catch{return{}}}),[er,Xn]=o.useState(new Set),[dt,tr]=o.useState(()=>{try{return localStorage.getItem("pawscord_spatial_audio")==="true"}catch{return!1}}),[Ot,en]=o.useState(()=>{try{return parseInt(localStorage.getItem("pawscord_vad_sensitivity"))||45}catch{return 45}}),[Dt,tn]=o.useState(()=>{try{const a=localStorage.getItem("pawscord_noise_suppression");return a===null?!0:a==="true"}catch{return!0}}),[or,on]=o.useState(()=>{try{return JSON.parse(localStorage.getItem("voice_settings")||"{}").audio?.noiseSuppressionLevel||"medium"}catch{return"medium"}}),[me,I]=o.useState(()=>{try{return localStorage.getItem("pawscord_screen_quality")||"1080p"}catch{return"1080p"}}),[Qt,wo]=o.useState(()=>{try{return parseInt(localStorage.getItem("pawscord_screen_fps"))||30}catch{return 30}}),[vo,rn]=o.useState(()=>{try{return localStorage.getItem("pawscord_system_audio")!=="false"}catch{return!1}}),[We,eo]=o.useState(()=>{try{return localStorage.getItem("pawscord_ptt_mode")==="true"}catch{return!1}}),[Q,rr]=o.useState(()=>{try{return localStorage.getItem("pawscord_ptt_key")||"Space"}catch{return"Space"}}),[nr,$t]=o.useState(!1),[Mt,_o]=o.useState(Yt),[sr,Ve]=o.useState(!1),[ar,ut]=o.useState(0),[ko,wt]=o.useState(1e3),tt=o.useRef(null),to=o.useRef(null);o.useRef(null);const Co=o.useCallback(async()=>{if(!n){console.log("üßä [RTC] No token, using STUN only"),_o(Yt),$r(Yt);return}try{const a=await fetch(`${Jt}/api/voice/turn-credentials/`,{headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"}});if(!a.ok)throw a.status===401||a.status===403?console.warn("üßä [RTC] Auth failed, using STUN only"):console.warn(`üßä [RTC] TURN fetch failed (${a.status}), using STUN only`),new Error(`TURN fetch failed ${a.status}`);const u=await a.json(),p=[...Yt,...u?.iceServers||[]];_o(p),$r(p),console.log("üßä [RTC] ICE servers updated with TURN credentials:",p.length,"servers")}catch(a){console.warn("üßä [RTC] Using STUN-only mode:",a.message),_o(Yt),$r(Yt)}},[n]);o.useEffect(()=>{Co()},[Co]);const N=o.useRef(null),se=o.useRef({}),ft=o.useRef(null),we=o.useRef(null),M=o.useRef(null),ve=o.useRef(null),re=o.useRef(null),pt=o.useRef([]),ot=o.useRef(null),vt=o.useRef(null),Be=o.useRef(!1),rt=o.useRef(!1),qe=o.useRef(null),zt=o.useRef(null),jo=o.useRef(null),_e=o.useRef(null);o.useEffect(()=>{localStorage.setItem("pawscord_user_volumes",JSON.stringify(Xt))},[Xt]);const Eo=o.useCallback((a,u)=>{Qr(p=>({...p,[a]:Math.max(0,Math.min(100,u))}))},[]);o.useEffect(()=>{M.current=X},[X]),o.useEffect(()=>{ve.current=Ue},[Ue]),o.useEffect(()=>{re.current=St},[St]),o.useEffect(()=>{if(!X||!c||q){fe(!1);return}if(!we.current){const K=window.AudioContext||window.webkitAudioContext;we.current=new K,console.log("üéµ [Performance] Global AudioContext created (reused for all users)")}const a=we.current,u=a.createAnalyser();u.fftSize=2048,u.smoothingTimeConstant=.85;const p=u.frequencyBinCount,v=new Uint8Array(p),C=a.createMediaStreamSource(X);C.connect(u);let w=null;const h=Ot,g=150;let T=null;const O=()=>{u.getByteFrequencyData(v);const K=v.slice(10,100);K.reduce((ge,Ne)=>ge+Ne,0)/K.length>h&&(fe(!0),w&&clearTimeout(w),w=setTimeout(()=>fe(!1),g)),c&&!q&&(T=requestAnimationFrame(O))};return O(),()=>{w&&clearTimeout(w),T&&cancelAnimationFrame(T),C.disconnect()}},[X,c,q,Ot]);const Ye=o.useCallback(()=>{if(!ft.current){const a=window.AudioContext||window.webkitAudioContext;ft.current=new a}ft.current.state==="suspended"&&ft.current.resume()},[]),nn=o.useCallback(async()=>{const a=!dt;if(a)try{await Fo.initialize(),Object.keys(Ee).forEach((u,p)=>{const v=Ee[u],C=u.replace("_camera","").replace("_screen","");if(!u.includes("_camera")&&!u.includes("_screen")){const w=p/Object.keys(Ee).length*2*Math.PI,h={x:Math.cos(w)*3,y:0,z:Math.sin(w)*3};Fo.addUser(C,v,h),console.log(`üéß [Spatial] Added ${C} at angle ${(w*180/Math.PI).toFixed(0)}¬∞`)}}),console.log("üéß [Spatial Audio] ENABLED - 3D audio active!")}catch(u){console.error("Failed to enable spatial audio:",u),V.warning("Spatial Audio ba≈ülatƒ±lamadƒ±. Tarayƒ±cƒ±nƒ±z desteklemiyor olabilir.");return}else Fo.destroy(),console.log("üéß [Spatial Audio] DISABLED - Normal stereo audio");tr(a),localStorage.setItem("pawscord_spatial_audio",a.toString())},[dt,Ee]),ir=o.useCallback(a=>{const u=Math.max(20,Math.min(80,a));en(u),localStorage.setItem("pawscord_vad_sensitivity",u.toString()),console.log(`üéöÔ∏è [VAD] Sensitivity updated: ${u}`)},[]),oo=o.useCallback(async()=>{const a=!Dt;if(tn(a),localStorage.setItem("pawscord_noise_suppression",a.toString()),X){const u=X.getAudioTracks()[0];if(u&&u.applyConstraints)try{await u.applyConstraints({noiseSuppression:a,echoCancellation:!0,autoGainControl:!0}),console.log(`üéõÔ∏è [Noise Suppression] ${a?"ENABLED":"DISABLED"}`)}catch(p){console.warn("[Noise] Failed to apply, trying fallback getUserMedia:",p);try{const C=(await navigator.mediaDevices.getUserMedia({audio:{noiseSuppression:a,echoCancellation:!0,autoGainControl:!0,googHighpassFilter:!0,googNoiseSuppression:a,googNoiseSuppression2:a,googEchoCancellation:!0,googAutoGainControl:!0,googTypingNoiseDetection:!0,sampleRate:{ideal:48e3},latency:{ideal:.01},channelCount:{ideal:1}}})).getAudioTracks()[0],w=new MediaStream([C]);ye(w),M.current=w,console.log("[Noise] Enhanced fallback stream acquired")}catch(v){console.error("[Noise] Fallback failed:",v)}}}},[Dt,X]),lr=o.useCallback(a=>{const p=["low","medium","high","aggressive"].includes(a)?a:"high";on(p);try{const v=JSON.parse(localStorage.getItem("voice_settings")||"{}");v.audio={...v.audio,noiseSuppressionLevel:p},localStorage.setItem("voice_settings",JSON.stringify(v))}catch(v){console.error("[Noise Level] Storage error:",v)}console.log(`üéõÔ∏è [Noise Level] Updated to: ${p}`)},[]),sn=o.useCallback(a=>{rn(a),localStorage.setItem("pawscord_system_audio",a.toString()),console.log(`üîä [System Audio] ${a?"ENABLED":"DISABLED"}`)},[]),cr=o.useCallback(()=>{const a=!We;eo(a),localStorage.setItem("pawscord_ptt_mode",a.toString()),a?(console.log("üéôÔ∏è [PTT] Mode enabled, VAD disabled"),M.current&&M.current.getAudioTracks().forEach(u=>{u.enabled=!1}),D(!0)):(console.log("üéôÔ∏è [PTT] Mode disabled, VAD enabled"),M.current&&M.current.getAudioTracks().forEach(u=>{u.enabled=!0}),D(!1))},[We]),an=o.useCallback(a=>{rr(a),localStorage.setItem("pawscord_ptt_key",a),console.log(`‚å®Ô∏è [PTT] Key updated to: ${a}`)},[]);o.useEffect(()=>{if(!We||!c)return;const a=p=>{const v=p.target;v.tagName==="INPUT"||v.tagName==="TEXTAREA"||p.code===Q&&!p.repeat&&($t(!0),M.current&&M.current.getAudioTracks().forEach(C=>{C.enabled=!0}),console.log("üéôÔ∏è [PTT] Key pressed, mic ON"))},u=p=>{p.code===Q&&($t(!1),M.current&&M.current.getAudioTracks().forEach(v=>{v.enabled=!1}),console.log("üéôÔ∏è [PTT] Key released, mic OFF"))};return window.addEventListener("keydown",a),window.addEventListener("keyup",u),()=>{window.removeEventListener("keydown",a),window.removeEventListener("keyup",u)}},[We,c,Q]);const Je=o.useCallback(a=>{I(a),localStorage.setItem("pawscord_screen_quality",a),console.log(`üì∫ [Screen Quality] Updated to: ${a}`)},[]),ln=o.useCallback(a=>{const u=parseInt(a);wo(u),localStorage.setItem("pawscord_screen_fps",u.toString()),console.log(`üé¨ [Screen FPS] Updated to: ${u}`)},[]);o.useEffect(()=>{dt&&Object.keys(Ee).forEach((a,u)=>{const p=Ee[a],v=a.replace("_camera","").replace("_screen","");if(!a.includes("_camera")&&!a.includes("_screen")&&!Fo.spatialNodes[v]){const C=u/Object.keys(Ee).length*2*Math.PI,w={x:Math.cos(C)*3,y:0,z:Math.sin(C)*3};Fo.addUser(v,p,w),console.log(`üéß [Spatial] Auto-added ${v}`)}})},[Ee,dt]),o.useCallback(async a=>{try{const u=a.getAudioTracks();if(u.length===0)return a;const p=u[0],v={echoCancellation:{exact:!0},noiseSuppression:{exact:!0},autoGainControl:{exact:!0},googEchoCancellation:{exact:!0},googAutoGainControl:{exact:!0},googNoiseSuppression:{exact:!0},googHighpassFilter:{exact:!0},googTypingNoiseDetection:{exact:!0},googAudioMirroring:!1,googAutoGainControl2:{exact:!0},echoCancellationType:"system"};if(p.applyConstraints)try{await p.applyConstraints(v),Re.audio("üéØ ADVANCED noise suppression enabled")}catch{await p.applyConstraints({echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}),Re.audio("‚úÖ Basic noise suppression enabled (fallback)")}return a}catch{return a}},[]);const To=o.useCallback(a=>{try{const p=JSON.parse(localStorage.getItem("voice_settings")||"{}").audio?.noiseSuppressionLevel||"high",v={low:{gateThreshold:-70,compressorThreshold:-15,compressorRatio:2,highPassFreq:50,lowPassFreq:14e3,gateRelease:.3,speechThreshold:20},medium:{gateThreshold:-60,compressorThreshold:-20,compressorRatio:3,highPassFreq:80,lowPassFreq:12e3,gateRelease:.25,speechThreshold:25},high:{gateThreshold:-50,compressorThreshold:-25,compressorRatio:4,highPassFreq:100,lowPassFreq:1e4,gateRelease:.2,speechThreshold:30},aggressive:{gateThreshold:-45,compressorThreshold:-30,compressorRatio:6,highPassFreq:120,lowPassFreq:8e3,gateRelease:.15,speechThreshold:35}},C=v[p]||v.high;if(console.log(`üîä [Audio] Noise suppression level: ${p}`,C),!we.current){const Gt=window.AudioContext||window.webkitAudioContext;we.current=new Gt({sampleRate:48e3,latencyHint:"interactive"}),console.log("üéµ [Performance] Global AudioContext created (48kHz, interactive mode)")}const w=we.current;w.state==="suspended"&&w.resume().then(()=>{console.log("üéµ [Audio] AudioContext resumed from suspended state")});const h=w.createMediaStreamSource(a),g=w.createGain();let T=!0;const O=C.gateThreshold,K=.005,le=C.gateRelease,ge=w.createDynamicsCompressor();ge.threshold.value=C.compressorThreshold,ge.knee.value=30,ge.ratio.value=Math.min(C.compressorRatio,4),ge.attack.value=.003,ge.release.value=.15;const Ne=w.createBiquadFilter();Ne.type="highpass",Ne.frequency.value=C.highPassFreq,Ne.Q.value=.707;const Ct=w.createBiquadFilter();Ct.type="lowpass",Ct.frequency.value=C.lowPassFreq,Ct.Q.value=.707;const Ze=w.createBiquadFilter();Ze.type="notch",Ze.frequency.value=50,Ze.Q.value=10;const Wt=w.createBiquadFilter();Wt.type="peaking",Wt.frequency.value=6e3,Wt.Q.value=1,Wt.gain.value=-3;const jt=w.createAnalyser();jt.fftSize=2048,jt.smoothingTimeConstant=.85;const Et=new Uint8Array(jt.frequencyBinCount);let mr=new Float32Array(jt.frequencyBinCount),gr=!0,Lo=0;const es=()=>{if(jt.getByteFrequencyData(Et),Et.reduce((it,Do)=>it+Do)/Et.length<20){if(Lo++,Lo>10)for(let it=0;it<Et.length;it++)mr[it]=Math.max(mr[it],Et[it])}else Lo=0;gr&&Lo>50&&(gr=!1,console.log("üéØ [Audio] Noise profile learned"))},hn=C.speechThreshold||25,yn=setInterval(()=>{jt.getByteFrequencyData(Et);const Gt=Et.slice(8,120),Do=Gt.reduce((xn,Sn)=>xn+Sn)/Gt.length-(mr[50]||0),hr=w.currentTime;Do>hn?T||(g.gain.setTargetAtTime(1,hr,K),T=!0):T&&(g.gain.setTargetAtTime(0,hr,le),T=!1),(gr||Math.random()<.01)&&es()},30);h.connect(Ne),Ne.connect(Ze),Ze.connect(Ct),Ct.connect(Wt),Wt.connect(ge),ge.connect(g),g.connect(jt);const Oo=w.createMediaStreamDestination();return g.connect(Oo),Oo.stream.addEventListener("inactive",()=>{clearInterval(yn),console.log("üéöÔ∏è [Audio] Filter chain cleaned up")}),console.log("üéöÔ∏è [Audio] Professional filters applied: Notch(50Hz) + De-Esser + Compressor + Noise Gate"),Oo.stream}catch(u){return console.error("‚ùå [Audio] Could not apply professional filters:",u),a}},[]),Pe=o.useCallback(a=>{N.current?.readyState===WebSocket.OPEN?(Re.signal(`Sending ${a.type} to ${a.receiver_username||"BROADCAST"}`),N.current.send(JSON.stringify({...a,sender_username:m}))):Re.warn("[Signal] WS not ready, cannot send:",a.type)},[m]),Ut=o.useCallback((a,u)=>{try{const v=a.getSenders().find(g=>g.track?.kind==="video");if(!v){console.log("[Bandwidth] No video sender found, skipping adjustment");return}const C=v.getParameters();(!C.encodings||C.encodings.length===0)&&(C.encodings=[{}]);const w={low:{maxBitrate:3e5,maxFramerate:15},medium:{maxBitrate:8e5,maxFramerate:24},high:{maxBitrate:25e5,maxFramerate:30}},h=w[u]||w.medium;C.encodings[0].maxBitrate=h.maxBitrate,C.encodings[0].maxFramerate=h.maxFramerate,v.setParameters(C).then(()=>{console.log(`‚úÖ [Bandwidth] Video quality set to ${u.toUpperCase()} (${h.maxBitrate/1e3}kbps, ${h.maxFramerate}fps)`)}).catch(g=>{console.warn("[Bandwidth] Failed to set parameters:",g)})}catch(p){console.warn("[Bandwidth] Error adjusting bandwidth:",p)}},[]),Vt=o.useCallback((a,u)=>{const{track:p}=u;Re.webrtc(`Track Received from ${a}:`,p.kind,p.id,"label:",p.label,"hint:",p.contentHint);const v=(p.label||"").toLowerCase(),C=v.includes("screen")||v.includes("window")||v.includes("monitor")||v.includes("display")||v.includes("tab")||p.contentHint==="detail",w=p.kind==="video"&&C?`${a}_screen`:p.kind==="video"?`${a}_camera`:a;if(console.log(`üìπ [WebRTC] Detected ${C?"SCREEN":"CAMERA"} track from ${a}, key: ${w}`),ct(h=>{const g=h[w];if(g){if(!g.getTracks().some(O=>O.id===p.id)){g.addTrack(p);const O=new MediaStream(g.getTracks());return console.log(`[WebRTC] Added track to existing stream: ${w}`),{...h,[w]:O}}return h}const T=new MediaStream([p]);return console.log(`[WebRTC] Created new stream: ${w}`),{...h,[w]:T}}),p.kind==="audio"){console.log(`[WebRTC] Audio track received from ${a}`),Ye();try{const h=document.createElement("audio");h.id=`remote-audio-${a}`,h.srcObject=new MediaStream([p]),h.autoplay=!0,h.playsInline=!0;const g=document.getElementById(`remote-audio-${a}`);g&&g.remove(),h.style.display="none",document.body.appendChild(h),h.play().then(()=>{console.log(`üîä [Audio] Playing remote audio from ${a}`)}).catch(T=>{console.warn(`[Audio] Autoplay blocked for ${a}, waiting for interaction:`,T.message);const O=()=>{h.play().catch(()=>{}),document.removeEventListener("click",O)};document.addEventListener("click",O,{once:!0})}),console.log(`‚úÖ [Audio] Created audio element for ${a}`)}catch(h){console.error(`[Audio] Failed to create audio element for ${a}:`,h)}}else p.kind==="video"&&console.log(`[WebRTC] Video track (${C?"screen":"camera"}) received from ${a}`)},[Ye]),Ie=o.useRef({}),Bt=o.useCallback((a,u=!1)=>{if(se.current[a])return se.current[a];const p=new RTCPeerConnection(Wn);se.current[a]=p;try{p.getTransceivers().forEach(C=>{if(C.sender&&C.sender.track?.kind==="audio"){const w=RTCRtpSender.getCapabilities("audio")?.codecs||[],h=w.filter(O=>O.mimeType.toLowerCase().includes("opus")),g=w.filter(O=>!O.mimeType.toLowerCase().includes("opus")),T=[...h,...g];C.setCodecPreferences&&T.length>0&&(C.setCodecPreferences(T),console.log("üéµ [Codec] Opus prioritized for audio"))}})}catch(v){console.warn("[Codec] setCodecPreferences not supported:",v.message)}return typeof window<"u"&&(window.__pawscord_peer_connections__=se.current),p.onicecandidate=v=>{v.candidate&&Pe({type:"candidate",candidate:v.candidate,receiver_username:a})},p.ontrack=v=>Vt(a,v),M.current&&M.current.getTracks().forEach(v=>{Re.webrtc(`Adding local audio track to PC for ${a}:`,v.kind),p.addTrack(v,M.current)}),p.oniceconnectionstatechange=()=>{console.log(`[WebRTC] ICE State (${a}):`,p.iceConnectionState),p.iceConnectionState==="failed"?(console.warn(`[WebRTC] ICE failed with ${a}, attempting restart...`),Ve(!0),Co().finally(()=>{p.restartIce(),setTimeout(()=>Ve(!1),1500)})):p.iceConnectionState==="disconnected"?(console.warn(`[WebRTC] ICE disconnected from ${a}, waiting for reconnection...`),Ve(!0),setTimeout(()=>{(p.iceConnectionState==="disconnected"||p.iceConnectionState==="failed")&&(console.error(`[WebRTC] ICE reconnection timeout for ${a}, cleaning up...`),ct(v=>{const C={...v};return delete C[a],C}),se.current[a]&&(se.current[a].close(),delete se.current[a])),Ve(!1)},15e3)):p.iceConnectionState==="closed"?(console.log(`[WebRTC] ICE closed for ${a}, cleaning up...`),ct(v=>{const C={...v};return delete C[a],C}),se.current[a]&&delete se.current[a],Ve(!1)):p.iceConnectionState==="connected"?(console.log(`‚úÖ [WebRTC] ICE connected with ${a}`),Ve(!1),setTimeout(async()=>{try{(await p.getStats()).forEach(C=>{if(C.type==="candidate-pair"&&C.state==="succeeded"){const w=C.currentRoundTripTime*1e3;console.log(`üìä [Bandwidth] ${a} RTT: ${w.toFixed(0)}ms`),w>500?(console.warn(`‚ö†Ô∏è [Bandwidth] High latency detected (${w.toFixed(0)}ms), reducing video quality to LOW`),Ut(p,"low")):w>300?(console.warn(`‚ö†Ô∏è [Bandwidth] Medium latency detected (${w.toFixed(0)}ms), reducing video quality to MEDIUM`),Ut(p,"medium")):(console.log(`‚úÖ [Bandwidth] Good connection (${w.toFixed(0)}ms), using HIGH quality`),Ut(p,"high"))}})}catch(v){console.warn("[Bandwidth] Failed to get stats:",v)}},2e3)):p.iceConnectionState==="checking"&&console.log(`üîç [WebRTC] ICE checking with ${a}`)},p},[Pe,Vt]),_t=o.useCallback(async a=>{if(a.type==="kicked"){console.warn("üî¥ [Voice] Kicked from channel:",a.reason,a.message),V.warning(`Sesli Kanaldan √áƒ±karƒ±ldƒ±nƒ±z

Neden: ${a.message}`,5e3),nt();return}if(a.type==="video_ended"){const h=a.from||a.username,g=a.streamType||"camera",T=`${h}_${g}`;console.log(`üìπ [Video] ${h} ended ${g} stream`),ct(O=>{const K={...O};return K[T]&&(K[T].getTracks().forEach(le=>le.stop()),delete K[T],console.log(`üìπ [Video] Cleaned up ${T} stream`)),K});return}if(a.type==="voice_reaction"){const h=a.from||a.username;console.log(`üí¨ [Reaction] ${h} sent: ${a.emoji}`),Zt({username:h,emoji:a.emoji,timestamp:Date.now()}),setTimeout(()=>{Zt(g=>g&&g.timestamp===Date.now()?null:g)},3e3);return}if(a.type==="game_signal"){const h=a.from||a.username;console.log(`üéÆ [Game] ${h}:`,a.action,a.move),Ae(g=>{const T={...g};if(a.action==="start")T.gameType=a.game_type,T.players=[h,a.target].filter(Boolean),T.moves={},T.result=null,T.currentTurn=h;else if(a.action==="move"){if(T.moves={...g.moves,[h]:a.move},a.game_type==="rps"&&Object.keys(T.moves).length===2){const[O,K]=Object.keys(T.moves),le=T.moves[O],ge=T.moves[K];le===ge?T.result={winner:null,type:"draw"}:{rock:"scissors",scissors:"paper",paper:"rock"}[le]===ge?T.result={winner:O,loser:K}:T.result={winner:K,loser:O}}}else a.action==="end"&&(T.result=a.result||{type:"cancelled"});return T});return}if(a.type==="cinema_sync"){const h=a.from||a.username;console.log(`üé¨ [Cinema] ${h}:`,a.action),Yo(g=>({...g,isActive:a.action!=="stop",url:a.url||g.url,playing:a.action==="play",time:a.time||g.time,lastSyncAction:a.action,timestamp:Date.now(),syncedBy:h}));return}if(a.type==="current_users"){console.log("[Voice] Received current users from backend:",a.users),l(h=>{const g=a.users||[],T=g.some(le=>le.username===m),O=h.find(le=>le.username===m);let K=[...g];return!T&&O?(console.log("[Voice] Backend list missing me, adding from local state"),K=[O,...g]):!T&&m&&(console.log("[Voice] Backend list missing me, adding with defaults"),K=[{username:m,isMuted:q,isCameraOn:H,isScreenSharing:U,isTalking:J},...g]),console.log("‚úÖ [Voice] Final connected users:",K.map(le=>le.username)),K});return}const u=a.from||a.sender_username||a.username,{type:p,sdp:v,candidate:C}=a;if(!u){console.error("[Signal] No sender username found in message:",a);return}if(u===m){console.log(`[Signal] Ignoring ${p} from self (${u})`);return}console.log(`[Signal] Received ${p} from ${u}`,a);let w=se.current[u];if(!w)if(p==="offer")w=Bt(u,!1);else if(p==="user_joined"){if(l(h=>h.find(g=>g.username===u)?h:[...h,{username:u,isMuted:!1,isCameraOn:!1,isScreenSharing:!1}]),w=Bt(u,!0),console.log(`[user_joined] Checking streams for ${u}:`,{hasAudio:!!M.current,hasCamera:!!ve.current,hasScreen:!!re.current,cameraEnabled:H,screenEnabled:U}),M.current){const h=w.getSenders();M.current.getTracks().forEach(g=>{h.some(O=>O.track===g)||(Re.webrtc(`Adding audio track to new peer ${u}:`,g.kind),w.addTrack(g,M.current))}),console.log(`‚úÖ [user_joined] Audio track added to ${u}`)}if(ve.current){const h=w.getSenders();ve.current.getTracks().forEach(g=>{h.some(O=>O.track===g)||(Re.webrtc(`Adding camera track to new peer ${u}:`,g.kind),w.addTrack(g,ve.current))}),console.log(`‚úÖ [user_joined] Camera track added to ${u}`)}if(re.current){const h=w.getSenders();re.current.getTracks().forEach(g=>{h.some(O=>O.track===g)||(Re.webrtc(`Adding screen track to new peer ${u}:`,g.kind),w.addTrack(g,re.current))}),console.log(`‚úÖ [user_joined] Screen track added to ${u}`)}try{const h=await w.createOffer();await w.setLocalDescription(h),Pe({type:"offer",sdp:w.localDescription,target:u}),Re.signal(`Sent offer to ${u}`),console.log(`‚úÖ [user_joined] Offer successfully sent to ${u}`)}catch(h){Re.error("Offer creation failed",h),console.error(`‚ùå [user_joined] Failed to create/send offer to ${u}:`,h)}return}else if(p==="user_left"){console.log(`[Signal] ${u} left the channel`),l(g=>g.filter(T=>T.username!==u));const h=document.getElementById(`remote-audio-${u}`);h&&(h.pause(),h.srcObject=null,h.remove(),console.log(`üîä [Audio] Removed audio element for ${u}`)),ct(g=>{const T={...g};return delete T[u],delete T[`${u}_camera`],delete T[`${u}_screen`],T}),se.current[u]&&(se.current[u].close(),delete se.current[u]);return}else if(p==="stream_update"){if(console.log(`[Signal] ${u} stream update:`,a),l(h=>h.map(g=>g.username===u?{...g,isCameraOn:a.streamType==="camera"?a.enabled:g.isCameraOn,isScreenSharing:a.streamType==="screen"?a.enabled:g.isScreenSharing}:g)),a.enabled&&!se.current[u]){console.log(`[stream_update] Creating PC for ${u} due to ${a.streamType} stream`);const h=Bt(u,!0);M.current&&M.current.getTracks().forEach(g=>{Re.webrtc(`Adding audio track to ${u}:`,g.kind),h.addTrack(g,M.current)}),ve.current&&ve.current.getTracks().forEach(g=>{Re.webrtc(`Adding camera track to ${u}:`,g.kind),h.addTrack(g,ve.current)}),re.current&&re.current.getTracks().forEach(g=>{Re.webrtc(`Adding screen track to ${u}:`,g.kind),h.addTrack(g,re.current)});try{const g=await h.createOffer();await h.setLocalDescription(g),Pe({type:"offer",sdp:h.localDescription,target:u}),Re.signal(`Sent offer to ${u} after stream_update`)}catch(g){Re.error(`Failed to create offer for ${u}:`,g)}}return}else{console.warn(`[Signal] Ignored ${p} from ${u} (No PC)`);return}try{if(p==="offer"){if(w.signalingState!=="stable"){console.warn(`[Signal] Ignoring offer from ${u}, already in state: ${w.signalingState}`);return}await w.setRemoteDescription(new RTCSessionDescription(v));const h=await w.createAnswer();if(await w.setLocalDescription(h),Pe({type:"answer",sdp:w.localDescription,target:u}),console.log(`[Signal] Sent answer to ${u}`),Ie.current[u]){console.log(`[Signal] Processing ${Ie.current[u].length} buffered candidates for ${u}`);for(const g of Ie.current[u])try{await w.addIceCandidate(g)}catch(T){console.warn("[Signal] Failed to add buffered candidate:",T)}delete Ie.current[u]}}else if(p==="answer"){if(w.signalingState!=="have-local-offer"){console.warn(`[WebRTC] Error handling answer from ${u}: InvalidStateError: Failed to execute 'setRemoteDescription' on 'RTCPeerConnection': Failed to set remote answer sdp: Called in wrong state: ${w.signalingState}`);return}if(await w.setRemoteDescription(new RTCSessionDescription(v)),console.log(`[Signal] Set remote description from ${u}`),Ie.current[u]){console.log(`[Signal] Processing ${Ie.current[u].length} buffered candidates for ${u}`);for(const h of Ie.current[u])try{await w.addIceCandidate(h)}catch(g){console.warn("[Signal] Failed to add buffered candidate:",g)}delete Ie.current[u]}}else p==="candidate"&&(w.remoteDescription?(await w.addIceCandidate(new RTCIceCandidate(C)),console.log(`[Signal] Added ICE candidate from ${u}`)):(console.log(`[Signal] Buffering ICE candidate from ${u} (no remote description yet)`),Ie.current[u]||(Ie.current[u]=[]),Ie.current[u].push(new RTCIceCandidate(C))))}catch(h){console.error(`[WebRTC] Error handling ${p} from ${u}:`,h)}},[m,Bt,Pe]),nt=o.useCallback(()=>{if(Be.current){console.log("[Voice] Already leaving, skipping...");return}if(Be.current=!0,console.log("[Voice] Leaving voice room..."),N.current&&N.current.readyState===WebSocket.OPEN)try{N.current.send(JSON.stringify({type:"user_leaving",sender_username:m}))}catch(a){console.warn("[Voice] Failed to send leave signal:",a)}M.current&&(M.current.getTracks().forEach(a=>{a.stop(),console.log(`[Voice] Stopped track: ${a.kind}`)}),ye(null),M.current=null),Ue&&(Ue.getTracks().forEach(a=>{a.stop(),console.log(`[Voice] Stopped camera track: ${a.kind}`)}),De(null),B(!1)),St&&(St.getTracks().forEach(a=>{a.stop(),console.log(`[Voice] Stopped screen track: ${a.kind}`)}),Ke(null),G(!1)),Object.entries(se.current).forEach(([a,u])=>{console.log(`[Voice] Closing PC for ${a}`),u.close()}),se.current={},ct({}),Ie.current={},N.current&&(N.current.onclose=null,N.current.close(),N.current=null),b(!1),L(null),R(!1),D(!1),ee(!1),ie&&(console.log("[Voice] Stopping recording on leave"),ot.current&&ot.current.state!=="inactive"&&ot.current.stop(),vt.current&&(clearInterval(vt.current),vt.current=null),Z(!1),ue(0)),qe.current&&(clearInterval(qe.current),qe.current=null),tt.current&&(clearTimeout(tt.current),tt.current=null,console.log("[Voice] Cleared pending WebSocket reconnect")),to.current&&(clearInterval(to.current),to.current=null),ut(0),wt(1e3),Ve(!1),setTimeout(()=>{Be.current=!1},100)},[m,Ue,St,ie]),st=o.useCallback(async a=>{if(c&&E&&E!==a&&!rt.current&&(console.log(`[Voice] Switching from ${E} to ${a}`),rt.current=!0,await new Promise(p=>{if(N.current){const v=N.current,C=v.onclose;v.onclose=w=>{C&&C(w),console.log("[Voice] Old WebSocket fully closed"),p()},v.close(1e3,"Switching channel"),N.current=null,setTimeout(p,2e3)}else p()}),Object.values(se.current).forEach(p=>{p.close()}),se.current={},ct({}),await new Promise(p=>setTimeout(p,150)),rt.current=!1,console.log(`[Voice] Now joining ${a}`)),c&&E===a){console.log(`[Voice] Already in ${a}, skipping join`);return}if(rt.current){console.log("[Voice] Currently switching channels, skipping...");return}console.log(`[Voice] Joining room: ${a}`),R(!0),L(a);try{Mt&&Mt.length>0&&($r(Mt),console.log(`üîê [TURN] Using cached ICE servers (${Mt.length})`));const u=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0,sampleRate:{ideal:48e3},sampleSize:{ideal:16},channelCount:{ideal:1},googEchoCancellation:!0,googAutoGainControl:!0,googNoiseSuppression:!0,googHighpassFilter:!0,googTypingNoiseDetection:!0,googAudioMirroring:!1,latency:{ideal:.02}},video:!1});console.log("[Voice] üé§ Got microphone access with AGGRESSIVE noise suppression");let p=u;if(Dt)try{p=To(u),console.log("üéöÔ∏è [Voice] Professional audio filters APPLIED")}catch(w){console.warn("‚ö†Ô∏è [Voice] Could not apply professional filters, using raw stream:",w),p=u}ye(p),M.current=p,console.log("üé§ [Voice] Stream ready with noise suppression"),console.log("üé§ [Voice] Stream tracks:",p.getAudioTracks().map(w=>({id:w.id,label:w.label,enabled:w.enabled,readyState:w.readyState,muted:w.muted}))),Ye(),qe.current||(qe.current=setInterval(async()=>{const h=M.current?.getAudioTracks()?.[0];if(!(!c||Be.current)&&(ft.current?.state==="suspended"&&await ft.current.resume().catch(()=>{}),!h||h.readyState==="ended"||!h.enabled&&!q&&!We))try{const g=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0,googEchoCancellation:!0,googNoiseSuppression:!0,googHighpassFilter:!0,googTypingNoiseDetection:!0,sampleRate:48e3,channelCount:1},video:!1});ye(g),M.current=g;const T=g.getAudioTracks()[0];Object.values(se.current).forEach(O=>{O.getSenders().filter(K=>K.track?.kind==="audio").forEach(K=>K.replaceTrack(T).catch(()=>{}))}),console.log("üîÑ [Mic Watchdog] Audio track yenilendi (basit stream)")}catch(g){console.warn("[Mic Watchdog] Mic refresh failed:",g)}},8e3));const v=`${Fr}://${Wr}/ws/voice/${a}/?token=${n}`;console.log(`[Voice] Connecting to ${v}`);const C=new WebSocket(v);N.current=C,C.onopen=()=>{console.log("üé§ [VoiceWS] Connected to room:",a),b(!0),R(!1),l(w=>w.some(g=>g.username===m)?w:(console.log("‚úÖ [Voice] Added self to connected users immediately"),[{username:m,isMuted:q,isCameraOn:H,isScreenSharing:U,isTalking:!1},...w]))},C.onmessage=w=>{try{const h=JSON.parse(w.data);console.log("[VoiceWS] Message received:",h.type||h),_t(h)}catch(h){console.error("[VoiceWS] Parse error:",h)}},C.onerror=w=>{console.error("üé§ [VoiceWS] Error:",w),R(!1),!Be.current&&!rt.current&&console.warn("[VoiceWS] Error occurred, reconnect will be attempted on close")},C.onclose=w=>{if(console.log("üé§ [VoiceWS] Disconnected, code:",w.code,"reason:",w.reason),Be.current||rt.current){console.log("[VoiceWS] User intentionally left or switching, not reconnecting"),Ve(!1),ut(0),wt(1e3),tt.current&&(clearTimeout(tt.current),tt.current=null);return}if(w.code===1e3){console.log("[VoiceWS] Normal closure (1000), cleaning up"),nt();return}if(a&&c){const g=ar+1;if(g>10){console.error("[VoiceWS] ‚ùå Max retry limit reached (10), giving up"),V.error("Sesli sohbet baƒülantƒ±sƒ± 10 denemeden sonra kurulamadƒ±. L√ºtfen sayfayƒ± yenileyin.",5e3),nt(),ut(0),wt(1e3);return}const T=Math.min(ko,3e4);console.warn(`[VoiceWS] üîÑ Unexpected disconnect (code: ${w.code})`),console.log(`[VoiceWS] üîÑ Reconnect attempt ${g}/10 in ${T}ms...`),Ve(!0),ut(g),tt.current&&clearTimeout(tt.current),tt.current=setTimeout(()=>{!Be.current&&!rt.current&&a?(console.log(`[VoiceWS] ‚ö° Executing reconnect attempt ${g} to ${a}`),wt(O=>Math.min(O*2,3e4)),st(a).then(()=>{console.log("[VoiceWS] ‚úÖ Reconnection successful! Resetting retry counters."),ut(0),wt(1e3),Ve(!1)}).catch(O=>{console.error("[VoiceWS] Reconnection failed:",O)})):(console.log("[VoiceWS] Reconnect cancelled (user left or room changed)"),Ve(!1),ut(0),wt(1e3))},T)}else console.log("[VoiceWS] Not in voice or no room, cleaning up"),nt()}}catch(u){console.error("Voice Join Error:",u),R(!1),rt.current=!1,u.name==="NotAllowedError"?V.warning("Mikrofon izni reddedildi. L√ºtfen tarayƒ±cƒ± ayarlarƒ±ndan izin verin.",5e3):u.name==="NotFoundError"?V.warning("Mikrofon bulunamadƒ±. L√ºtfen bir mikrofon baƒülayƒ±n."):V.error("Sesli sohbete baƒülanƒ±lamadƒ±: "+u.message)}},[c,E,n,_t,Ye,nt]),cn=o.useCallback(()=>{D(a=>{const u=!a;return M.current&&M.current.getAudioTracks().forEach(p=>{p.enabled=!u}),N.current?.readyState===WebSocket.OPEN&&N.current.send(JSON.stringify({type:"mic_off_state",is_mic_off:u})),console.log(`[Voice] Mute: ${u}`),u})},[]),dr=o.useCallback(()=>{ee(a=>{const u=!a;return N.current?.readyState===WebSocket.OPEN&&N.current.send(JSON.stringify({type:"deaf_state",is_deafened:u})),console.log(`[Voice] Deafened: ${u}`),u})},[]),ro=o.useRef(!1),Ro=o.useCallback(async()=>{if(ro.current){console.log("[Camera] Toggle already in progress, skipping...");return}ro.current=!0;try{const a=ve.current;if(a){console.log("[Camera] Stopping camera stream"),B(!1),De(null),ve.current=null,a.getTracks().forEach(p=>{p.stop(),console.log(`[Camera] Stopped ${p.kind} track`)});const u=[];for(const[p,v]of Object.entries(se.current)){const C=v.getSenders();let w=!1;for(const h of C)if(h.track&&h.track.kind==="video"&&h.track.contentHint!=="detail")try{v.removeTrack(h),w=!0,console.log(`[Camera] Removed video track from peer: ${p}`)}catch(g){console.warn(`[Camera] Failed to remove track from ${p}:`,g)}if(w){const h=(async()=>{try{const g=await v.createOffer();await v.setLocalDescription(g),Pe({type:"offer",sdp:v.localDescription,target:p}),console.log(`[Camera] Sent renegotiation offer to ${p} after removal`)}catch(g){console.warn(`[Camera] Renegotiation failed with ${p}:`,g)}})();u.push(h)}}N.current?.readyState===WebSocket.OPEN&&(N.current.send(JSON.stringify({type:"camera_state",is_camera_on:!1})),N.current.send(JSON.stringify({type:"video_ended",streamType:"camera"})),console.log("[Camera] Sent video_ended signal")),Promise.all(u).catch(p=>console.warn("[Camera] Some renegotiations failed:",p))}else{console.log("[Camera] Starting camera stream");const u=await navigator.mediaDevices.getUserMedia({video:{width:{ideal:1280},height:{ideal:720},frameRate:{ideal:30}}});if(!ro.current){console.log("[Camera] Toggle was cancelled, stopping new stream"),u.getTracks().forEach(C=>C.stop());return}console.log("[Camera] Got camera stream:",u.id),ve.current=u,De(u),B(!0);const p=u.getVideoTracks()[0];p.onended=()=>{console.log("[Camera] Track ended by browser/system"),De(null),ve.current=null,B(!1),N.current?.readyState===WebSocket.OPEN&&N.current.send(JSON.stringify({type:"video_ended",streamType:"camera"}))};try{p.contentHint="motion"}catch(C){console.warn("[Camera] contentHint not supported:",C)}const v=[];for(const[C,w]of Object.entries(se.current)){const h=(async()=>{try{w.addTrack(p,u),console.log(`[Camera] Added video track to peer: ${C}`);const g=await w.createOffer();await w.setLocalDescription(g),Pe({type:"offer",sdp:w.localDescription,target:C}),console.log(`[Camera] Sent renegotiation offer to ${C}`)}catch(g){console.warn(`[Camera] Failed to add/renegotiate with ${C}:`,g)}})();v.push(h)}N.current?.readyState===WebSocket.OPEN&&(N.current.send(JSON.stringify({type:"camera_state",is_camera_on:!0})),console.log("[Camera] State sent to backend: is_camera_on=true")),Promise.all(v).catch(C=>console.warn("[Camera] Some track additions failed:",C))}}catch(a){console.error("[Camera] Error:",a),a.name==="NotAllowedError"?V.warning("Kamera izni reddedildi. L√ºtfen tarayƒ±cƒ± ayarlarƒ±ndan kamera iznini a√ßƒ±n.",5e3):a.name==="NotFoundError"?V.warning("Kamera bulunamadƒ±. L√ºtfen bir kamera baƒülayƒ±n."):V.error("Kamera ba≈ülatƒ±lamadƒ±: "+a.message),B(!1),ve.current=null,De(null)}finally{setTimeout(()=>{ro.current=!1},300)}},[Pe]),dn=Ro,Nt=o.useRef(!1),un=o.useCallback(async()=>{if(Nt.current){console.log("[Screen] Toggle already in progress, skipping...");return}Nt.current=!0;try{const a=re.current;if(a){console.log("[Screen] Stopping screen share"),G(!1),Ke(null),re.current=null,a.getTracks().forEach(p=>{p.stop(),console.log(`[Screen] Stopped ${p.kind} track`)});const u=[];for(const[p,v]of Object.entries(se.current)){const C=v.getSenders();let w=!1;for(const h of C)if(h.track&&h.track.contentHint==="detail")try{v.removeTrack(h),w=!0,console.log(`[Screen] Removed screen track from peer: ${p}`)}catch(g){console.warn(`[Screen] Failed to remove track from ${p}:`,g)}if(w){const h=(async()=>{try{const g=await v.createOffer();await v.setLocalDescription(g),Pe({type:"offer",sdp:v.localDescription,target:p}),console.log(`[Screen] Sent renegotiation offer to ${p} after removal`)}catch(g){console.warn(`[Screen] Renegotiation failed with ${p}:`,g)}})();u.push(h)}}N.current?.readyState===WebSocket.OPEN&&(N.current.send(JSON.stringify({type:"screen_share_state",is_sharing:!1})),N.current.send(JSON.stringify({type:"video_ended",streamType:"screen"})),console.log("[Screen] Sent video_ended signal")),Promise.all(u).catch(p=>console.warn("[Screen] Some renegotiations failed:",p))}else{console.log("[Screen] Starting screen share");const u={"720p":{width:1280,height:720},"1080p":{width:1920,height:1080},"4K":{width:3840,height:2160}},p=u[me]||u["1080p"];console.log(`üé¨ [Screen] Quality: ${me}, FPS: ${Qt}`);const v=await navigator.mediaDevices.getDisplayMedia({video:{cursor:"always",displaySurface:"monitor",width:{ideal:p.width},height:{ideal:p.height},frameRate:{ideal:Qt}},audio:vo});if(!Nt.current){console.log("[Screen] Toggle was cancelled, stopping new stream"),v.getTracks().forEach(h=>h.stop());return}console.log("[Screen] Got screen stream:",v.id),v.getVideoTracks()[0].onended=()=>{console.log("[Screen] User stopped sharing via browser"),Ke(null),re.current=null,G(!1),N.current?.readyState===WebSocket.OPEN&&(N.current.send(JSON.stringify({type:"screen_share_state",is_sharing:!1})),N.current.send(JSON.stringify({type:"video_ended",streamType:"screen"})))},re.current=v,Ke(v),G(!0);const C=v.getVideoTracks()[0];try{C.contentHint="detail"}catch(h){console.warn("[Screen] contentHint not supported:",h)}const w=[];for(const[h,g]of Object.entries(se.current)){const T=(async()=>{try{g.addTrack(C,v),console.log(`[Screen] Added screen track to peer: ${h}`);const O=await g.createOffer();await g.setLocalDescription(O),Pe({type:"offer",sdp:g.localDescription,target:h}),console.log(`[Screen] Sent renegotiation offer to ${h}`)}catch(O){console.error(`[Screen] Failed to add track to ${h}:`,O.message)}})();w.push(T)}N.current?.readyState===WebSocket.OPEN&&N.current.send(JSON.stringify({type:"screen_share_state",is_sharing:!0})),Promise.all(w).catch(h=>console.warn("[Screen] Some track additions failed:",h))}}catch(a){console.error("[Screen] Error:",a),a.name==="NotAllowedError"?console.log("[Screen] User cancelled screen share"):a.name==="NotFoundError"?V.warning("Ekran payla≈üƒ±mƒ± desteklenmiyor."):V.error("Ekran payla≈üƒ±mƒ± ba≈ülatƒ±lamadƒ±: "+a.message),G(!1),re.current=null,Ke(null)}finally{setTimeout(()=>{Nt.current=!1},300)}},[Pe,me,Qt,vo]),Ao=o.useCallback(()=>{if(!c||ie){console.warn("[Recording] Cannot start - not in voice or already recording");return}try{const a=new(window.AudioContext||window.webkitAudioContext),u=a.createMediaStreamDestination();X&&a.createMediaStreamSource(X).connect(u),Object.entries(Ee).forEach(([v,C])=>{!v.includes("_camera")&&!v.includes("_screen")&&C.getAudioTracks().length>0&&a.createMediaStreamSource(C).connect(u)});const p=new MediaRecorder(u.stream,{mimeType:"audio/webm;codecs=opus",audioBitsPerSecond:128e3});pt.current=[],p.ondataavailable=v=>{v.data.size>0&&pt.current.push(v.data)},p.onstop=()=>{const v=new Blob(pt.current,{type:"audio/webm"}),C=URL.createObjectURL(v),w=document.createElement("a");w.href=C,w.download=`pawscord-voice-${E}-${Date.now()}.webm`,w.click(),URL.revokeObjectURL(C),console.log("‚úÖ [Recording] Saved recording")},p.start(1e3),ot.current=p,Z(!0),ue(0),vt.current=setInterval(()=>{ue(v=>v+1)},1e3),console.log("üî¥ [Recording] Started")}catch(a){console.error("[Recording] Start error:",a),V.error("Kayƒ±t ba≈ülatƒ±lamadƒ±: "+a.message)}},[c,ie,X,Ee,E]),Po=o.useCallback(()=>{ie&&(ot.current&&ot.current.state!=="inactive"&&ot.current.stop(),vt.current&&(clearInterval(vt.current),vt.current=null),ot.current=null,Z(!1),ue(0),console.log("‚èπÔ∏è [Recording] Stopped"))},[ie]),ur=o.useCallback(()=>{if(pt.current.length===0){V.warning("Hen√ºz kayƒ±t yok!");return}const a=new Blob(pt.current,{type:"audio/webm"}),u=URL.createObjectURL(a),p=document.createElement("a");p.href=u,p.download=`pawscord-voice-${E||"recording"}-${Date.now()}.webm`,document.body.appendChild(p),p.click(),document.body.removeChild(p),URL.revokeObjectURL(u),console.log("üíæ [Recording] Downloaded manually")},[E]),fn=o.useCallback(async(a,u=50)=>{if(!X||!c){console.warn("[VoiceEffect] No stream or not in voice");return}try{if(zt.current&&(zt.current.forEach(g=>{try{g.disconnect()}catch{}}),zt.current=null),!a){pe(null),console.log("üéµ [VoiceEffect] Cleared");return}const p=we.current||new AudioContext;we.current||(we.current=p);const v=p.createMediaStreamSource(X),C=p.createMediaStreamDestination(),w=[],h=u/100;switch(a){case"robot":{const g=p.createOscillator(),T=p.createGain(),O=p.createWaveShaper();g.type="sawtooth",g.frequency.value=50+h*100,T.gain.value=.3+h*.4;const K=new Float32Array(256);for(let le=0;le<256;le++){const ge=le/128-1;K[le]=Math.tanh(ge*(1+h*3))}O.curve=K,g.connect(T),v.connect(O),O.connect(C),g.start(),w.push(g,T,O);break}case"echo":{const g=p.createDelay(1),T=p.createGain(),O=p.createGain(),K=p.createGain();g.delayTime.value=.1+h*.4,T.gain.value=.2+h*.5,O.gain.value=.3+h*.4,K.gain.value=1-h*.3,v.connect(K),v.connect(g),g.connect(T),T.connect(g),g.connect(O),K.connect(C),O.connect(C),w.push(g,T,O,K);break}case"deep":{const g=p.createBiquadFilter(),T=p.createGain();g.type="lowshelf",g.frequency.value=500,g.gain.value=10+h*15,T.gain.value=1.2,v.connect(g),g.connect(T),T.connect(C),w.push(g,T);break}case"high":{const g=p.createBiquadFilter(),T=p.createGain();g.type="highshelf",g.frequency.value=1e3,g.gain.value=8+h*12,T.gain.value=.9,v.connect(g),g.connect(T),T.connect(C),w.push(g,T);break}case"radio":{const g=p.createBiquadFilter(),T=p.createBiquadFilter(),O=p.createWaveShaper();g.type="lowpass",g.frequency.value=3e3-h*1e3,T.type="highpass",T.frequency.value=300+h*200;const K=new Float32Array(256);for(let le=0;le<256;le++){const ge=le/128-1;K[le]=Math.sign(ge)*Math.pow(Math.abs(ge),.8)}O.curve=K,v.connect(T),T.connect(g),g.connect(O),O.connect(C),w.push(g,T,O);break}case"reverb":{const g=p.createConvolver(),T=p.createGain(),O=p.createGain(),K=p.sampleRate,le=K*(.5+h*2),ge=p.createBuffer(2,le,K);for(let Ne=0;Ne<2;Ne++){const Ct=ge.getChannelData(Ne);for(let Ze=0;Ze<le;Ze++)Ct[Ze]=(Math.random()*2-1)*Math.pow(1-Ze/le,2)}g.buffer=ge,T.gain.value=.3+h*.5,O.gain.value=1-h*.2,v.connect(O),v.connect(g),g.connect(T),O.connect(C),T.connect(C),w.push(g,T,O);break}default:v.connect(C)}zt.current=w,jo.current=C.stream,pe(a),ze(u),console.log(`üéµ [VoiceEffect] Applied: ${a} at ${u}%`)}catch(p){console.error("[VoiceEffect] Error:",p),V.error("Ses efekti uygulanamadƒ±")}},[X,c]),fr=o.useCallback(a=>{if(!N.current||N.current.readyState!==WebSocket.OPEN){console.warn("[Reaction] WebSocket not connected");return}N.current.send(JSON.stringify({type:"voice_reaction",emoji:a})),console.log(`üí¨ [Reaction] Sent: ${a}`)},[]),Qn=o.useCallback((a,u,p=null,v=null)=>{if(!N.current||N.current.readyState!==WebSocket.OPEN){console.warn("[Game] WebSocket not connected");return}N.current.send(JSON.stringify({type:"game_signal",game_type:a,action:u,move:p,target:v})),console.log(`üéÆ [Game] Sent: ${a} - ${u}`,p)},[]),pn=o.useCallback((a,u=0,p=null)=>{if(!N.current||N.current.readyState!==WebSocket.OPEN){console.warn("[Cinema] WebSocket not connected");return}N.current.send(JSON.stringify({type:"cinema_sync",action:a,time:u,url:p})),console.log(`üé¨ [Cinema] Sent: ${a}`,{time:u,url:p})},[]),mn=o.useCallback(()=>{_e.current||(_e.current=setInterval(async()=>{const a={};for(const[u,p]of Object.entries(se.current))try{const v=await p.getStats();let C=null,w=null;v.forEach(h=>{h.type==="inbound-rtp"&&h.kind==="audio"&&(C={packetsReceived:h.packetsReceived,packetsLost:h.packetsLost,jitter:h.jitter,bytesReceived:h.bytesReceived}),h.type==="inbound-rtp"&&h.kind==="video"&&(w={packetsReceived:h.packetsReceived,packetsLost:h.packetsLost,framesDecoded:h.framesDecoded,frameWidth:h.frameWidth,frameHeight:h.frameHeight}),h.type==="candidate-pair"&&h.state==="succeeded"&&(a[u]={...a[u],rtt:h.currentRoundTripTime*1e3,connectionType:h.localCandidateId?.includes("relay")?"TURN":"STUN/Direct"})}),a[u]={...a[u],audio:C,video:w,connectionState:p.connectionState,iceConnectionState:p.iceConnectionState}}catch(v){console.warn(`[Stats] Failed to get stats for ${u}:`,v)}Zo(a)},2e3),console.log("üìä [Stats] Monitoring started"))},[]),no=o.useCallback(()=>{_e.current&&(clearInterval(_e.current),_e.current=null,Zo({}),console.log("üìä [Stats] Monitoring stopped"))},[]),pr=o.useCallback(a=>{Zr(a),localStorage.setItem("pawscord_noise_gate_enabled",a.toString()),console.log(`üéöÔ∏è [Noise Gate] ${a?"ENABLED":"DISABLED"}`)},[]),Io=o.useCallback(a=>{const u=Math.max(-80,Math.min(-20,a));Yr(u),localStorage.setItem("pawscord_noise_gate",u.toString()),console.log(`üéöÔ∏è [Noise Gate] Threshold: ${u}dB`)},[]),gn=o.useCallback(a=>{Xr(a),localStorage.setItem("pawscord_visualizer",a.toString()),console.log(`üìä [Visualizer] ${a?"ENABLED":"DISABLED"}`)},[]),kt=o.useRef(null),at=o.useRef(null),Ft=o.useCallback(()=>{if(!(!bt||!X)&&!kt.current)try{we.current||(we.current=new(window.AudioContext||window.webkitAudioContext));const a=we.current,u=a.createAnalyser();u.fftSize=256;const p=a.createMediaStreamSource(X);p.connect(u),at.current={local:u,localSource:p,remote:{}},Object.entries(Ee).forEach(([v,C])=>{if(!v.includes("_camera")&&!v.includes("_screen")){const w=a.createAnalyser();w.fftSize=256;const h=a.createMediaStreamSource(C);h.connect(w),at.current.remote[v]={analyser:w,source:h}}}),kt.current=setInterval(()=>{const v=new Uint8Array(128);at.current.local.getByteFrequencyData(v);const C={};Object.entries(at.current.remote).forEach(([w,{analyser:h}])=>{const g=new Uint8Array(128);h.getByteFrequencyData(g),C[w]=g}),Qo({local:v,remote:C})},33),console.log("üìä [Visualizer] Started")}catch(a){console.error("[Visualizer] Failed to start:",a)}},[bt,X,Ee]),so=o.useCallback(()=>{if(kt.current&&(clearInterval(kt.current),kt.current=null),at.current){try{at.current.localSource?.disconnect(),Object.values(at.current.remote).forEach(({source:a})=>{a?.disconnect()})}catch{}at.current=null}Qo({local:new Uint8Array(128),remote:{}}),console.log("üìä [Visualizer] Stopped")},[]);return o.useEffect(()=>(c&&bt?Ft():so(),()=>so()),[c,bt,Ft,so]),o.useEffect(()=>()=>{ie&&Po(),qe.current&&(clearInterval(qe.current),qe.current=null),no()},[ie,Po,no]),e.jsx(va.Provider,{value:{isInVoice:c,isConnecting:j,currentRoom:E,isMuted:q,isDeafened:z,isVideoEnabled:H,isScreenSharing:U,isTalking:J,isSpatialAudioEnabled:dt,vadSensitivity:Ot,isNoiseSuppressionEnabled:Dt,screenShareQuality:me,screenShareFPS:Qt,isRecording:ie,recordingDuration:ne,isPTTMode:We,isPTTActive:nr,pttKey:Q,includeSystemAudio:vo,localStream:X,localAudioStream:X,localCameraStream:Ue,localScreenStream:St,remoteStreams:Ee,connectedUsers:qo,remoteVolumes:Xt,mutedUsers:er,joinVoiceRoom:st,leaveVoiceRoom:nt,joinChannel:st,leaveChannel:nt,setRemoteVolume:Eo,setIsMuted:D,setIsDeafened:ee,setIsVideoEnabled:B,setIsScreenSharing:G,toggleMute:cn,toggleDeafened:dr,toggleVideo:Ro,toggleCamera:dn,toggleScreenShare:un,toggleSpatialAudio:nn,updateVadSensitivity:ir,toggleNoiseSuppression:oo,updateScreenQuality:Je,updateScreenFPS:ln,toggleSystemAudio:sn,togglePTTMode:cr,updatePTTKey:an,startRecording:Ao,stopRecording:Po,downloadRecording:ur,sendSignal:Pe,isPttActive:nr,sendReaction:fr,lastReaction:Hr,applyVoiceEffect:fn,activeVoiceEffect:Y,voiceEffectIntensity:be,setVoiceEffectIntensity:ze,cinemaState:Kr,setCinemaState:Yo,sendCinemaSync:pn,gameState:de,setGameState:Ae,sendGameSignal:Qn,connectionStats:Jo,startStatsMonitoring:mn,stopStatsMonitoring:no,noiseSuppressionLevel:or,updateNoiseSuppressionLevel:lr,iceServers:Mt,isReconnecting:sr,adjustBandwidth:Ut,noiseGateThreshold:qr,isNoiseGateEnabled:Jr,toggleNoiseGate:pr,updateNoiseGateThreshold:Io,audioVisualizerData:Xo,isVisualizerEnabled:bt,toggleVisualizer:gn,startVisualizer:Ft,stopVisualizer:so},children:i})},Gc=()=>o.useContext(va),_a=o.createContext(null),Hc=({children:i})=>{const[r,n]=o.useState(!1),[m,c]=o.useState(null),[b,j]=o.useState(0),R=o.useRef(null),E=o.useRef(null),L=o.useCallback(()=>{const q=localStorage.getItem("access_token");if(!q)return;let D="Anonymous";try{D=yo(q).username}catch(H){console.error("Token decode hatasƒ±",H)}const z=`${Fr}://${Wr}/ws/status/?username=${encodeURIComponent(D)}&token=${q}`;R.current&&R.current.close();const ee=new WebSocket(z);R.current=ee,ee.onopen=()=>{console.log("üåê [GlobalWS] Baƒülandƒ±"),n(!0)},ee.onmessage=H=>{const B=JSON.parse(H.data);c(B),B.type==="chat_message_handler"&&B.username==="‚ö° Signal Bot"&&(Notification.permission==="granted"&&document.hidden&&new Notification("üö® YENƒ∞ KRƒ∞PTO Sƒ∞NYALƒ∞!",{body:`${B.content.split(`
`)[2]}`,icon:"/logo192.png"}),j(U=>U+1))},ee.onclose=H=>{console.log("üåê [GlobalWS] Kapandƒ±",H.code),n(!1),clearTimeout(E.current),E.current=setTimeout(L,5e3)},ee.onerror=H=>{console.error("üåê [GlobalWS] Hata",H),ee.close()}},[Wr,Fr]);return o.useEffect(()=>{const q=setTimeout(()=>{L()},2e3);return()=>{clearTimeout(q),R.current&&R.current.close(),clearTimeout(E.current)}},[L]),e.jsx(_a.Provider,{value:{isConnected:r,globalData:m,unreadGlobal:b,setUnreadGlobal:j},children:i})},ka=()=>o.useContext(_a),Kc=({message:i,endTime:r,level:n="info",onDismiss:m})=>{const[c,b]=o.useState("");o.useEffect(()=>{if(!r)return;const E=()=>{const q=new Date,z=new Date(r)-q;if(z<=0){b("Ending soon..."),setTimeout(()=>window.location.reload(),5e3);return}const ee=Math.floor(z/(1e3*60*60)),H=Math.floor(z%(1e3*60*60)/(1e3*60));b(`${ee}h ${H}m remaining`)};E();const L=setInterval(E,6e4);return()=>clearInterval(L)},[r]);const j={info:{bg:"rgba(88, 101, 242, 0.1)",border:"#5865f2",text:"#5865f2"},warning:{bg:"rgba(250, 166, 26, 0.1)",border:"#faa61a",text:"#faa61a"},critical:{bg:"rgba(240, 71, 71, 0.1)",border:"#f04747",text:"#f04747"}},R=j[n]||j.info;return e.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,backgroundColor:R.bg,borderBottom:`2px solid ${R.border}`,padding:"12px 20px",display:"flex",alignItems:"center",justifyContent:"space-between",zIndex:9999,animation:"slideDown 0.3s ease"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx(Cl,{style:{color:R.text,fontSize:"18px"}}),e.jsxs("div",{children:[e.jsx("div",{style:{color:R.text,fontWeight:"bold"},children:n==="critical"?"üö® Critical Maintenance":n==="warning"?"‚ö†Ô∏è Scheduled Maintenance":"‚ÑπÔ∏è Maintenance Notice"}),e.jsxs("div",{style:{color:"#dcddde",fontSize:"14px",marginTop:"2px"},children:[i,c&&e.jsxs("span",{style:{marginLeft:"10px",opacity:.7},children:["(",c,")"]})]})]})]}),m&&e.jsx("button",{onClick:m,style:{background:"none",border:"none",color:"#b9bbbe",cursor:"pointer",padding:"8px",borderRadius:"4px",transition:"background 0.2s"},onMouseEnter:E=>E.target.style.background="rgba(255,255,255,0.1)",onMouseLeave:E=>E.target.style.background="none",children:e.jsx(Go,{})})]})},et=({size:i="medium",text:r="Y√ºkleniyor...",fullscreen:n=!1})=>{const m={small:{spinner:24,text:"12px"},medium:{spinner:40,text:"14px"},large:{spinner:60,text:"16px"}},c=m[i]||m.medium,b=n?go.fullscreenContainer:go.inlineContainer;return e.jsxs("div",{style:b,children:[e.jsxs("div",{style:{...go.spinnerWrapper,width:c.spinner,height:c.spinner},children:[e.jsx("div",{style:go.spinnerOuter}),e.jsx("div",{style:go.spinnerInner})]}),r&&e.jsx("div",{style:{...go.loadingText,fontSize:c.text},children:r})]})},go={fullscreenContainer:{position:"fixed",top:0,left:0,right:0,bottom:0,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",backgroundColor:"#36393f",zIndex:9999,gap:"16px"},inlineContainer:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"12px",padding:"20px",minHeight:"100px"},spinnerWrapper:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center"},spinnerOuter:{position:"absolute",width:"100%",height:"100%",border:"3px solid rgba(88, 101, 242, 0.2)",borderTop:"3px solid #5865f2",borderRadius:"50%",animation:"spin 1s linear infinite"},spinnerInner:{position:"absolute",width:"70%",height:"70%",border:"3px solid rgba(88, 101, 242, 0.1)",borderBottom:"3px solid #7289da",borderRadius:"50%",animation:"spin 0.7s linear infinite reverse"},loadingText:{color:"#b5bac1",fontWeight:500,textAlign:"center",animation:"pulse 1.5s ease-in-out infinite"}};if(typeof document<"u"){const i=document.createElement("style");i.innerText=`
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 0.6; }
            50% { opacity: 1; }
        }
    `,document.head.querySelector("[data-loading-spinner-styles]")||(i.setAttribute("data-loading-spinner-styles","true"),document.head.appendChild(i))}const Zn=()=>{const i=window.navigator?.userAgent?.toLowerCase().includes("electron"),r=window.location.hostname.includes("pawscord.com"),n=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1";return i||r?"https://api.pawscord.com":n?"http://localhost:8888":"https://api.pawscord.com"};Zn();const qc=()=>Zn().replace("/api","/media"),Yc=Zn,hp=qc,Jc="https://media.pawscord.com",Zc=`${Jc}/assets`,Xc=`${Zc}/logo.png`;Yc().replace("/api","");const Qc=Xc,ed=()=>e.jsxs("svg",{className:"splash-logo",viewBox:"0 0 100 100",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("ellipse",{cx:"50",cy:"62",rx:"22",ry:"18",fill:"white"}),e.jsx("ellipse",{cx:"28",cy:"38",rx:"10",ry:"12",fill:"white"}),e.jsx("ellipse",{cx:"72",cy:"38",rx:"10",ry:"12",fill:"white"}),e.jsx("ellipse",{cx:"22",cy:"55",rx:"8",ry:"10",fill:"white"}),e.jsx("ellipse",{cx:"78",cy:"55",rx:"8",ry:"10",fill:"white"})]}),td=()=>{const[i,r]=o.useState(!1);return i?e.jsx(ed,{}):e.jsx("img",{src:Qc,alt:"Pawscord",className:"splash-logo",onError:()=>r(!0)})},od=({animationState:i})=>e.jsxs("div",{className:`splash-screen ${i}`,children:[e.jsx("div",{className:"particles",children:[...Array(15)].map((r,n)=>e.jsx("div",{className:"particle",style:{"--delay":`${Math.random()*2}s`,"--x":`${Math.random()*100}%`,"--size":`${4+Math.random()*8}px`,"--duration":`${2+Math.random()*3}s`}},n))}),e.jsxs("div",{className:"rings-container",children:[e.jsx("div",{className:"ring ring-1"}),e.jsx("div",{className:"ring ring-2"}),e.jsx("div",{className:"ring ring-3"})]}),e.jsxs("div",{className:"logo-container",children:[e.jsx("div",{className:"logo-glow"}),e.jsx(td,{})]}),e.jsxs("div",{className:"brand-text",children:[e.jsx("span",{className:"letter",style:{"--i":0},children:"P"}),e.jsx("span",{className:"letter",style:{"--i":1},children:"A"}),e.jsx("span",{className:"letter",style:{"--i":2},children:"W"}),e.jsx("span",{className:"letter",style:{"--i":3},children:"S"}),e.jsx("span",{className:"letter",style:{"--i":4},children:"C"}),e.jsx("span",{className:"letter",style:{"--i":5},children:"O"}),e.jsx("span",{className:"letter",style:{"--i":6},children:"R"}),e.jsx("span",{className:"letter",style:{"--i":7},children:"D"})]}),e.jsx("div",{className:"loading-bar",children:e.jsx("div",{className:"loading-progress"})})]}),na=y.memo(od),sa=y.lazy(()=>x(()=>import("./Message-DldVD5L_.js"),__vite__mapDeps([23,1,2,5,24,25,26,27,8,9,3,4,6]))),rd=y.lazy(()=>x(()=>import("./VirtualMessageList-0z34i2WX.js"),__vite__mapDeps([28,2,27,8,9]))),nd=y.lazy(()=>x(()=>import("./MessageInput-ByXZcLsN.js"),__vite__mapDeps([29,1,2,5,22,30,3,4,6,31]))),Mr=y.lazy(()=>x(()=>import("./UserVideoContainer-DpDJFq5E.js"),__vite__mapDeps([32,2]))),sd=y.lazy(()=>x(()=>import("./VoiceAudioController-Dwu6Kikc.js"),__vite__mapDeps([33,2,1,3,4,5,6])));y.lazy(()=>x(()=>import("./RichTextEditor-C0d9eYRw.js"),__vite__mapDeps([34,2,35,9,5,36])));const ad=y.lazy(()=>x(()=>import("./StickyMessageBanner-B7bpqCIc.js"),__vite__mapDeps([37,2,5]))),id=y.lazy(()=>x(()=>import("./LoginPage-DKTIeTOV.js"),__vite__mapDeps([38,2,5,39,4,1,3,6]))),ld=y.lazy(()=>x(()=>import("./WelcomeScreen-80Y5TqNU.js"),__vite__mapDeps([40,2,5,41,1,3,4,6]))),cd=y.lazy(()=>x(()=>import("./ImageModal-DvMxeGLp.js"),__vite__mapDeps([13,2]))),dd=y.lazy(()=>x(()=>import("./UserProfileModal-B1XiVkUh.js"),__vite__mapDeps([12,2,5,1,3,4,6]))),ud=y.lazy(()=>x(()=>import("./PollCreateModal-DicI4JEE.js"),__vite__mapDeps([20,2,5]))),fd=y.lazy(()=>x(()=>import("./CodeSnippetModal-HqRam3JM.js"),__vite__mapDeps([21,2,5])));y.lazy(()=>x(()=>import("./AvatarCropper-VTC0DazT.js"),__vite__mapDeps([42,2,43])));const pd=y.lazy(()=>x(()=>import("./CryptoChartModal-bWx0Fo2m.js"),__vite__mapDeps([44,2,5])));y.lazy(()=>x(()=>import("./CryptoStoreModal-DoWO-3nG.js"),__vite__mapDeps([45,2,5,1,3,4,6])));const md=y.lazy(()=>x(()=>import("./PremiumStoreModal-DmxQJmMo.js"),__vite__mapDeps([46,2,5,1,3,4,6]))),gd=y.lazy(()=>x(()=>import("./WhiteboardModal-Bt_-grsQ.js"),__vite__mapDeps([19,2,5]))),hd=y.lazy(()=>x(()=>import("./SoundboardModal-Ci6ZSUq8.js"),__vite__mapDeps([16,2,5]))),yd=y.lazy(()=>x(()=>import("./KanbanBoard-BMZp3t3J.js"),__vite__mapDeps([47,2,8,9,5]))),aa=y.lazy(()=>x(()=>import("./SummaryModal-B_xnst5k.js"),__vite__mapDeps([48,2,5]))),xd=y.lazy(()=>x(()=>import("./MessageTemplateModal-3oMjA6Ei.js"),__vite__mapDeps([22,2,5]))),Sd=y.lazy(()=>x(()=>import("./CinemaModal-CA_FSz-7.js"),__vite__mapDeps([18,1,2,5]))),bd=y.lazy(()=>x(()=>import("./StickerPicker-TWKP2FiL.js"),__vite__mapDeps([15,2]))),wd=y.lazy(()=>x(()=>import("./GifPicker-D7YGUzBv.js"),__vite__mapDeps([14,2]))),vd=y.lazy(()=>x(()=>import("./DJModal-DXLWNKMJ.js"),__vite__mapDeps([49,1,2,5]))),_d=y.lazy(()=>x(()=>import("./ThemeStoreModal-Vlw4KhLI.js"),__vite__mapDeps([50,2,5,1,3,4,6]))),kd=y.lazy(()=>x(()=>import("./EncryptionKeyModal-Dlo2-5j2.js"),__vite__mapDeps([51,2,5]))),Cd=y.lazy(()=>x(()=>import("./DownloadModal-Db_9Fq-7.js"),__vite__mapDeps([41,2,5,1,3,4,6]))),jd=y.lazy(()=>x(()=>import("./ServerSettingsModal-FE5ow_H-.js"),__vite__mapDeps([7,2,5,8,9,10,11,1,3,4,6]))),Ed=y.lazy(()=>x(()=>import("./CreateGroupModal-DEPKR65k.js"),__vite__mapDeps([52,2,5,1,3,4,6]))),Td=y.lazy(()=>x(()=>import("./AdminAnalyticsPanel-CL6MfWJX.js"),__vite__mapDeps([53,2,5,9]))),Rd=y.lazy(()=>x(()=>import("./AdminPanelModal-CUZ8CPfI.js"),__vite__mapDeps([54,2,5,1,3,4,6]))),Ad=y.lazy(()=>x(()=>import("./WebhooksPanel-2bYSp32b.js"),__vite__mapDeps([55,2,8,9,1,3,4,5,6,56]))),Pd=y.lazy(()=>x(()=>import("./VanityURLManager-qQgZVE57.js"),__vite__mapDeps([11,2,5,1,3,4,6]))),Id=y.lazy(()=>x(()=>import("./AutoModerationDashboard-CYbp70z1.js"),__vite__mapDeps([57,2,5]))),Ld=y.lazy(()=>x(()=>import("./AutoModerationPanel-DxSoyahz.js"),__vite__mapDeps([58,2,5,1,3,4,6,59]))),Od=y.lazy(()=>x(()=>import("./RaidProtectionPanel-DNxR9pVs.js"),__vite__mapDeps([60,2,5,1,3,4,6]))),Dd=y.lazy(()=>x(()=>import("./ReportSystemPanel-BYoxLzjN.js"),__vite__mapDeps([61,2,5,1,3,4,6]))),$d=y.lazy(()=>x(()=>import("./AuditLogPanel-CFN6TcnH.js"),__vite__mapDeps([62,2,5]))),Md=y.lazy(()=>x(()=>import("./UserWarningsPanel-BLtBnntt.js"),__vite__mapDeps([63,2,5,1,3,4,6]))),zd=y.lazy(()=>x(()=>import("./BookmarkPanel-CnGge8ze.js"),__vite__mapDeps([64,2,5,1,3,4,6]))),Ud=y.lazy(()=>x(()=>import("./ReadLaterPanel-Dei1yxHi.js"),__vite__mapDeps([65,2,5,66]))),Vd=y.lazy(()=>x(()=>import("./ChannelPermissionsPanel-C9wTzHoH.js"),__vite__mapDeps([67,2,5,1,3,4,6])));y.lazy(()=>x(()=>import("./MessageThreadsPanel-DKflF_At.js"),__vite__mapDeps([68,2,5,1,3,4,6])));y.lazy(()=>x(()=>import("./ModeratorNotesPanel-CUJLH5gH.js"),__vite__mapDeps([69,2,5,1,3,4,6])));y.lazy(()=>x(()=>import("./ServerRolesPanel-JGGBb650.js"),__vite__mapDeps([70,2,5,1,3,4,6])));y.lazy(()=>x(()=>import("./NotificationPreferencesPanel-C6yngncc.js"),__vite__mapDeps([71,2,5,1,3,4,6])));y.lazy(()=>x(()=>import("./MessageOCRPanel-BeAxSGeb.js"),__vite__mapDeps([72,2,5,1,3,4,6])));y.lazy(()=>x(()=>import("./MassActionsPanel-K7v7xUi6.js"),__vite__mapDeps([73,2,5,1,3,4,6])));y.lazy(()=>x(()=>import("./TimeoutMutePanel-BgwTpqnY.js"),__vite__mapDeps([74,2,5,1,3,4,6])));y.lazy(()=>x(()=>import("./ServerThemesPanel-Dhd6hBaq.js"),__vite__mapDeps([75,2,5,1,3,4,6])));y.lazy(()=>x(()=>import("./KeywordMutesPanel-BgB0JESj.js"),__vite__mapDeps([76,2,5,1,3,4,6])));y.lazy(()=>x(()=>import("./WelcomeTemplatesPanel-Dtqho3Hh.js"),__vite__mapDeps([77,2,5,1,3,4,6])));y.lazy(()=>x(()=>import("./StickyMessagesPanel-BpRxOv7U.js"),__vite__mapDeps([78,2,5,1,3,4,6])));y.lazy(()=>x(()=>import("./MessageTemplatesPanel-DdCewsAn.js"),__vite__mapDeps([79,2,5,1,3,4,6])));y.lazy(()=>x(()=>import("./MessageExportPanel-DebNTDFr.js"),__vite__mapDeps([80,2,5,1,3,4,6])));y.lazy(()=>x(()=>import("./ArchivedRoomsPanel-BPbLwSC1.js"),__vite__mapDeps([81,2,5,1,3,4,6])));y.lazy(()=>x(()=>import("./SlowModePanel-BNVsoyrd.js"),__vite__mapDeps([82,2,5,1,3,4,6])));y.lazy(()=>x(()=>import("./EmojiManagementPanel-Bj5hoQ20.js"),__vite__mapDeps([83,2,5,1,3,4,6])));const Bd=y.lazy(()=>x(()=>import("./ReactionAnalyticsPanel-CFdz44yZ.js"),__vite__mapDeps([84,2,5,1,3,4,6]))),Nd=y.lazy(()=>x(()=>import("./LinkClickTrackingPanel-Dc7GGPnv.js"),__vite__mapDeps([85,2,5,1,3,4,6]))),Fd=y.lazy(()=>x(()=>import("./JoinLeaveLogsPanel-DMlUUrw6.js"),__vite__mapDeps([86,2,5,1,3,4,6]))),Wd=y.lazy(()=>x(()=>import("./UserActivityPanel-qT2r2uAK.js"),__vite__mapDeps([87,2,5,1,3,4,6]))),Gd=y.lazy(()=>x(()=>import("./NicknameHistoryPanel-CQdyPB8g.js"),__vite__mapDeps([88,2,5,1,3,4,6]))),Hd=y.lazy(()=>x(()=>import("./FieldChangeTrackingPanel-BRUD08pF.js"),__vite__mapDeps([89,2,5,1,3,4,6]))),Kd=y.lazy(()=>x(()=>import("./InviteAnalyticsPanel-3z3_JiRX.js"),__vite__mapDeps([90,2,5,1,3,4,6]))),qd=y.lazy(()=>x(()=>import("./ContentScannerPanel-BPHfmpot.js"),__vite__mapDeps([91,2,5,1,3,4,6]))),Yd=y.lazy(()=>x(()=>import("./EphemeralMessagesPanel-BAaHHn44.js"),__vite__mapDeps([92,2,5,1,3,4,6]))),Jd=y.lazy(()=>x(()=>import("./TopicHistoryPanel-KtZ6XAMm.js"),__vite__mapDeps([93,2,5,1,3,4,6]))),Zd=y.lazy(()=>x(()=>import("./DraftsPanel-CAcdQ4Qb.js"),__vite__mapDeps([94,2,5,1,3,4,6]))),Xd=y.lazy(()=>x(()=>import("./ServerNicknamesPanel-DKM1Ff-7.js"),__vite__mapDeps([95,2,5,1,3,4,6]))),Qd=y.lazy(()=>x(()=>import("./ServerBoostPanel-DcdmtXnT.js"),__vite__mapDeps([96,2,5,1,3,4,6]))),eu=y.lazy(()=>x(()=>import("./RoomWebhooksPanel-B6vTs5mZ.js"),__vite__mapDeps([97,2,5,1,3,4,6]))),tu=y.lazy(()=>x(()=>import("./OAuthAppsPanel-BYHlWpBv.js"),__vite__mapDeps([98,2,5,1,3,4,6])));y.lazy(()=>x(()=>import("./VanityURLPanel-Dv4NezFM.js"),__vite__mapDeps([99,2,5,1,3,4,6])));const ia=y.lazy(()=>x(()=>import("./AutoRespondersPanel-DwozNvuy.js"),__vite__mapDeps([100,2,5,1,3,4,6]))),ou=y.lazy(()=>x(()=>import("./SessionManagementPanel-mbzPgeIR.js"),__vite__mapDeps([101,2,5,1,3,4,6]))),ru=y.lazy(()=>x(()=>import("./GDPRExportPanel-QpFJSSuM.js"),__vite__mapDeps([102,2,5,1,3,4,6]))),nu=y.lazy(()=>x(()=>import("./DataRetentionPanel-DFH22vxl.js"),__vite__mapDeps([103,2,5,1,3,4,6]))),su=y.lazy(()=>x(()=>import("./TwoFactorSetupWizard-Bf_XSm6A.js"),__vite__mapDeps([104,2,5,1,3,4,6]))),au=y.lazy(()=>x(()=>import("./EnhancedPollsPanel-DX9wawMQ.js"),__vite__mapDeps([105,2,5,1,3,4,6]))),iu=y.lazy(()=>x(()=>import("./VoiceTranscriptsPanel-DjX6UTWf.js"),__vite__mapDeps([106,2,5,1,3,4,6]))),lu=y.lazy(()=>x(()=>import("./PaymentPanel-Bxn7aqWr.js"),__vite__mapDeps([107,2,5,1,3,4,6]))),cu=y.lazy(()=>x(()=>import("./StoreModal-2oWg1_66.js"),__vite__mapDeps([108,2,5,1,3,4,6]))),du=y.lazy(()=>x(()=>import("./DailyRewardsModal-BnxF08cE.js"),__vite__mapDeps([109,2,5,1,3,4,6]))),uu=y.lazy(()=>x(()=>import("./APIUsagePanel-CZXc6lan.js"),__vite__mapDeps([110,2,5,1,3,4,6]))),fu=y.lazy(()=>x(()=>import("./ExportJobsPanel-BuqquDNz.js"),__vite__mapDeps([111,2,5,1,3,4,6]))),pu=y.lazy(()=>x(()=>import("./ScheduledAnnouncementsPanel-C7XD5Vob.js"),__vite__mapDeps([112,2,5,1,3,4,6]))),mu=y.lazy(()=>x(()=>import("./InviteExportPanel-8nj7zr3n.js"),__vite__mapDeps([113,2,5,1,3,4,6]))),gu=y.lazy(()=>x(()=>import("./AdvancedSearchPanel-Dvw3UwSm.js"),__vite__mapDeps([114,2,5,1,3,4,6]))),hu=y.lazy(()=>x(()=>import("./GrowthMetricsPanel-CIg2KuYV.js"),__vite__mapDeps([115,2,5,1,3,4,6]))),yu=y.lazy(()=>x(()=>import("./LinkPreviewRenderer-Bam8wnDm.js"),__vite__mapDeps([116,2,5]))),xu=y.lazy(()=>x(()=>import("./InventoryPanel-DtJI-gG2.js"),__vite__mapDeps([117,2,5,1,3,4,6]))),Su=y.lazy(()=>x(()=>import("./WaitlistPanel-BOf8LTxh.js"),__vite__mapDeps([118,2,5,1,3,4,6]))),bu=y.lazy(()=>x(()=>import("./ReferralRewardsPanel-Bvexxfgm.js"),__vite__mapDeps([119,2,5,1,3,4,6])));y.lazy(()=>x(()=>import("./VerifyEmailPage-DysnN1lb.js"),__vite__mapDeps([120,2,5,3])));y.lazy(()=>x(()=>import("./ForgotPasswordPage-ohAe50EJ.js"),__vite__mapDeps([121,2,5,39,3])));y.lazy(()=>x(()=>import("./ResetPasswordPage-BB5pWXbh.js"),__vite__mapDeps([122,2,5,3])));y.lazy(()=>x(()=>import("./TwoFactorLoginPage-BeasgjlK.js"),__vite__mapDeps([123,2,5,3])));y.lazy(()=>x(()=>import("./TwoFactorSetup-9CKJrvYF.js"),__vite__mapDeps([124,2,1,3,4,5,6,125])));y.lazy(()=>x(()=>import("./TwoFactorLogin-CcEn5NhU.js"),__vite__mapDeps([126,2,127])));const wu=y.lazy(()=>x(()=>import("./VanityInviteScreen-P6Pd5mKS.js"),__vite__mapDeps([128,2,8,9])));y.lazy(()=>x(()=>import("./EmailVerification-DqUw7EwK.js"),__vite__mapDeps([129,2,3,130])));y.lazy(()=>x(()=>import("./MobileNav-CO0ERRQF.js"),__vite__mapDeps([131,2,132])));y.lazy(()=>x(()=>import("./SwipeActions-C58H47F9.js"),__vite__mapDeps([133,2,134])));y.lazy(()=>x(()=>import("./VoiceMessage-Dzd1LK8h.js"),__vite__mapDeps([135,2,1,3,4,5,6,136])));const vu=y.lazy(()=>x(()=>import("./FriendsTab-D3c3smon.js"),__vite__mapDeps([137,2,5,24,1,3,4,6]))),_u=y.lazy(()=>x(()=>import("./RoomList-DFIxLmPX.js"),__vite__mapDeps([138,2,5,4,139,30,11,1,3,6,10,24]))),ku=y.lazy(()=>x(()=>import("./UserProfilePanel-yUgOSd48.js"),__vite__mapDeps([140,2,141,1,42,43,3,4,5,6,142]))),la=y.lazy(()=>x(()=>import("./VoiceChatPanel-CCOND8lU.js"),__vite__mapDeps([143,2,144,8,9,145,5,4,1,3,6,146]))),Cu=y.lazy(()=>x(()=>import("./ChatUserList-DrmQeT8B.js"),__vite__mapDeps([147,2,5]))),ju=y.lazy(()=>x(()=>import("./PinnedMessages-BkjmKgQ8.js"),__vite__mapDeps([148,2,23,1,5,24,25,26,27,8,9,3,4,6]))),Eu=y.lazy(()=>x(()=>import("./FloatingVoiceIsland-D7ZJxsEv.js"),__vite__mapDeps([149,2,144,8,9,150]))),Tu=y.lazy(()=>x(()=>import("./CinemaPlayer-BIm6GB88.js"),__vite__mapDeps([151,1,2,5,3,4,6]))),Ru=y.lazy(()=>x(()=>import("./ConnectionsPanel-CdTOvVL4.js"),__vite__mapDeps([152,2,5,1,3,4,6,153]))),Au=y.lazy(()=>x(()=>import("./PasswordSetupModal-D-i2GT24.js"),__vite__mapDeps([154,2,5,1,3,4,6,155]))),Pu=y.lazy(()=>x(()=>import("./NotificationDropdown-CHo6lGRx.js"),__vite__mapDeps([156,2,5])));y.lazy(()=>x(()=>import("./ReactionStatsPanel-Dy3v48ME.js"),__vite__mapDeps([157,2,5,1,3,4,6,158])));y.lazy(()=>x(()=>import("./ServerHealthPanel-B5EnFhx4.js"),__vite__mapDeps([159,2,5,1,3,4,6,160])));y.lazy(()=>x(()=>import("./ChannelAnalyticsPanel-5w104hJr.js"),__vite__mapDeps([161,2,5,1,3,4,6,162])));y.lazy(()=>x(()=>import("./SmartSuggestionsPanel-H5EidFgH.js"),__vite__mapDeps([163,2,5,1,3,4,6,164])));y.lazy(()=>x(()=>import("./UserPresenceInsightsPanel-uAmDkHwl.js"),__vite__mapDeps([165,2,5,1,3,4,6,166])));y.lazy(()=>x(()=>import("./UserFooter-D3hWYj37.js").then(i=>i.a),__vite__mapDeps([139,2,5])));const Iu=y.lazy(()=>x(()=>import("./UserContextMenu-BdRIxptA.js"),__vite__mapDeps([145,2,5]))),Lu="8888",xo=typeof window<"u"&&typeof window.require=="function",Lt=window.Capacitor&&window.Capacitor.isNativePlatform(),Ko=(()=>{if(Lt||xo)return"https://api.pawscord.com";const i=window.location.protocol,r=window.location.hostname;return r.includes("pawscord.com")?"https://api.pawscord.com":`${i}//${r}:${Lu}`})(),ho=xo||Lt?"https://www.pawscord.com":Ko,W=`${Ko}/api`,A=Ko,zr=Ko.startsWith("https")?"wss":"ws",Ur=Ko.replace(/^https?:\/\//,""),ca=`${W}/auth/login/`,da=`${W}/auth/register/`,Ou=`${W}/messages/history/room/`,Du=`${W}/messages/history/dm/`,zn=`${W}/rooms/list_with_categories/`,$u=`${W}/conversations/`,Mu=`${W}/conversations/find_or_create/`,zu=`${W}/users/update_profile/`,Uu=`${W}/users/default_avatars/`,Vu=`${W}/users/change_username/`,Bu=`${W}/gifs/list_local/`,Nu="774757987258-poa0elqqapnab8eud3tol3h2pilcqe71.apps.googleusercontent.com",ua="chat_drafts_v1",Vr=()=>(Date.now()+Math.floor(Math.random()*1e3)).toString(),Fu=i=>new Promise((r,n)=>{const c=Math.ceil(i.size/2097152);let b=0;const j=new kl.ArrayBuffer,R=new FileReader;R.onload=L=>{j.append(L.target.result),b++,b<c?E():r(j.end())},R.onerror=L=>n(L);function E(){const L=b*2097152,q=Math.min(L+2097152,i.size);R.readAsArrayBuffer(i.slice(L,q))}E()}),Wu=()=>{const{user:i,isAuthenticated:r,token:n,login:m,logout:c,isLoading:b}=Ho(),{isInVoice:j,isConnecting:R,currentRoom:E,joinChannel:L,leaveChannel:q,isMuted:D,isDeafened:z,toggleMute:ee,toggleDeafened:H,toggleVideo:B,toggleScreenShare:U,remoteVolumes:G,setRemoteVolume:J,localCameraStream:fe,remoteStreams:ie,isTalking:Z,sendSignal:ne,isScreenSharing:ue,isVideoEnabled:Y,isPttActive:pe,localScreenStream:be,sendReaction:ze,lastReaction:X,applyVoiceEffect:ye,activeEffect:Ue,cinemaState:De,setCinemaState:St,gameState:Ke,sendGameSignal:Ee,mutedUsers:ct}=Gc(),{globalData:qo}=ka(),l=Ce(t=>t.activeChat),Hr=Ce(t=>t.messages),Zt=Ce(t=>t.encryptionKeys),Kr=Ce(t=>t.voiceUsers),Yo=Ce(t=>t.unreadCounts),de=Ce(t=>t.setActiveChat);Ce(t=>t.addMessage),Ce(t=>t.updateMessage);const Ae=Ce(t=>t.setMessages),Jo=Ce(t=>t.setTypingUser),Zo=Ce(t=>t.setOnlineUsers),qr=Ce(t=>t.setVoiceUsers),Yr=Ce(t=>t.incrementUnread),Jr=Ce(t=>t.setEncryptionKey),[Zr,Xo]=o.useState(!1),[Qo,bt]=o.useState(!1),[Xr,Xt]=o.useState(!1),[Qr,er]=o.useState(!1),[Xn,dt]=o.useState(!1),[tr,Ot]=o.useState(null),[en,Dt]=o.useState(!1),[tn,or]=o.useState(0),[on,me]=o.useState(""),I=i?.username||"",[Qt,wo]=o.useState(!1),[vo,rn]=o.useState(!1),[We,eo]=o.useState(null),{isMobile:Q}=vc(),[rr,nr]=o.useState(""),$t=$c(rr,300),[Mt,_o]=o.useState("0px"),sr=Lt?"max(20px, env(safe-area-inset-bottom))":"0px",[Ve,ar]=o.useState({width:300,height:225,x:100,y:100}),[ut,ko]=o.useState(!0),[wt,tt]=o.useState(!0),[to,Co]=o.useState(!1),[N,se]=o.useState("start"),[ft,we]=o.useState([]),[M,ve]=o.useState([]),[re,pt]=o.useState([]),[ot,vt]=o.useState([]),[Be,rt]=o.useState([]),[qe,zt]=o.useState(!1),[jo,_e]=o.useState(!1),[Eo,Ye]=o.useState(!1),[nn,ir]=o.useState(!1),[oo,lr]=o.useState(!1),[sn,cr]=o.useState(!1),[an,Je]=o.useState(""),[ln,To]=o.useState(!1),[Pe,Ut]=o.useState(!1),[Vt,Ie]=o.useState(new Set),[Bt,_t]=o.useState(null),[nt,st]=o.useState(null),[cn,dr]=o.useState(null),[ro,Ro]=o.useState(!1),[dn,Nt]=o.useState(!1),[un,Ao]=o.useState(!1),[Po,ur]=o.useState(!1),[fn,fr]=o.useState(!1),[Qn,pn]=o.useState(!1),[mn,no]=o.useState(!1),[pr,Io]=o.useState(!1),[gn,kt]=o.useState(!1),[at,Ft]=o.useState(!1),[so,a]=o.useState(!1),[u,p]=o.useState(!1),[v,C]=o.useState(!1),[w,h]=o.useState(!1),[g,T]=o.useState(!1),[O,K]=o.useState(!1),[le,ge]=o.useState(!1),[Ne,Ct]=o.useState(!1),[Ze,Wt]=o.useState(!1),[jt,Et]=o.useState(!1),[mr,gr]=o.useState(!1),[Lo,es]=o.useState(!1),[hn,ts]=o.useState(!1),[yn,Oo]=o.useState(!1),[Gt,it]=o.useState(!1),[Do,hr]=o.useState(!1),[xn,Sn]=o.useState(!1),[Ra,Aa]=o.useState(!1),[Pa,Ia]=o.useState(!1),[La,Oa]=o.useState(!1),[Da,$a]=o.useState(!1),[Ma,za]=o.useState(!1),[Ua,os]=o.useState(!1),[Va,Ba]=o.useState(!1),[Na,Fa]=o.useState(!1),[Wa,Ga]=o.useState(!1),[Ha,Ka]=o.useState(!1),[qa,Ya]=o.useState(!1),[Ja,Za]=o.useState(!1),[Xa,Qa]=o.useState(!1),[ei,ti]=o.useState(!1),[oi,rs]=o.useState(!1),[ri,ni]=o.useState(!1),[si,ai]=o.useState(!1),[ii,li]=o.useState(!1),[ci,ns]=o.useState(!1),[di,ui]=o.useState(!1),[fi,pi]=o.useState(!1),[mi,gi]=o.useState(!1),[hi,yi]=o.useState(!1),[xi,Si]=o.useState(!1),[bi,ss]=o.useState(!1),[wi,as]=o.useState(!1),[vi,is]=o.useState(!1),[jf,Ef]=o.useState(!1),[Tf,Rf]=o.useState(!1),[Af,Pf]=o.useState(!1),[If,Lf]=o.useState(!1),[Of,Df]=o.useState(!1),[$f,Mf]=o.useState(!1),[zf,Uf]=o.useState(!1),[Vf,Bf]=o.useState(!1),[Nf,Ff]=o.useState(!1),[Wf,Gf]=o.useState(!1),[_i,ls]=o.useState("default"),[cs,ao]=o.useState(null),[Hf,Kf]=o.useState(!1),[ki,yr]=o.useState(!1),[qf,xr]=o.useState(!0),[Yf,bn]=o.useState(0),[io,Ci]=o.useState(!1),[Ht,wn]=o.useState([]),[ji,Ei]=o.useState(0),[Tt,ds]=o.useState([]),[Kt,Rt]=o.useState([]),[Jf,Ti]=o.useState(null),[mt,Sr]=o.useState(null),[us,fs]=o.useState(!1),[Ri,ps]=o.useState(!1),[ms,gs]=o.useState(null),[hs,vn]=o.useState(!1),[Ai,ys]=o.useState(!1),[Pi,br]=o.useState(""),[$o,xs]=o.useState(()=>JSON.parse(localStorage.getItem("chat_sound_settings"))||{notifications:!0,mentions:!0,userJoinLeave:!0}),[wr,_n]=o.useState(null),[Ii,Ss]=o.useState(!1),[bs,vr]=o.useState(!1),[ws,kn]=o.useState(!1),[Cn,_r]=o.useState(0),[Zf,Xf]=o.useState(!1),[Qf,lo]=o.useState(!1),[ep,co]=o.useState(""),[Li,kr]=o.useState(!1),[tp,uo]=o.useState(null),[op,vs]=o.useState(null),[rp,_s]=o.useState(null),[ks,np]=o.useState(!1),[jn,Cs]=o.useState(!1),[Mo,Fe]=o.useState(!1),[Cr,js]=o.useState(null),[zo,jr]=o.useState(null),[Oi,Es]=o.useState(!1),[Di,Ts]=o.useState(!1),[$i,Rs]=o.useState(!1),[Mi,As]=o.useState(!1),[zi,Ps]=o.useState(!1),[Ui,Is]=o.useState(!1),[Ls,Os]=o.useState(null),[Vi,Ds]=o.useState(!1),[Bi,$s]=o.useState(!1),Ms=Ce(t=>t.typingUsers),zs=o.useMemo(()=>Ms.filter(t=>t!==I),[Ms,I]);o.useRef(null),o.useRef([]);const ke=o.useRef(null),Er=o.useRef(null),En=o.useRef(null);o.useRef(null);const Uo=o.useRef(null),Tn=o.useRef(null),Us=o.useRef(null),gt=o.useRef({}),Te=I==="Eastkhan"||I==="PawPaw"||mt?.role==="admin",Ni=o.useMemo(()=>{const t=M?.find(S=>S.id===l?.serverId),s=t?.owner===I||t?.created_by===I,f=Kt?.find(S=>S.username===I)?.role==="moderator";return{isAdmin:Te,isServerOwner:s,isModerator:f,canKick:Te||s||f,canBan:Te||s,canMute:Te||s||f,canWarn:Te||s||f,canManageRoles:Te||s}},[Te,M,l?.serverId,I,Kt]),Fi=o.useMemo(()=>{if(!M||M.length===0)return[];if(!Tt||Tt.length===0)return M;const t=[],s=[];return Tt.forEach(f=>{const S=M.find(d=>d.id===f);S&&t.push(S)}),M.forEach(f=>{Tt.includes(f.id)||s.push(f)}),[...t,...s]},[M,Tt]),Rn=Ce(t=>t.onlineUsers),Wi=Ce(t=>t.messages),An=_c(Wi,$t);kc(re),o.useEffect(()=>{if(N==="finished")return;se("start");const t=setTimeout(()=>se("pre-transition"),1500),s=setTimeout(()=>se("finished"),2200),f=setTimeout(()=>se("finished"),3e3);return()=>{clearTimeout(t),clearTimeout(s),clearTimeout(f)}},[]),o.useEffect(()=>{const t=new URLSearchParams(window.location.search),s=t.get("verification"),f=t.get("username"),S=t.get("reason"),d=t.get("needs_password");if(s==="success")V.success(`√¢≈ì‚Ä¶ Email do√Ñ≈∏ruland√Ñ¬±! Ho√Ö≈∏geldin ${f||"kullan√Ñ¬±c√Ñ¬±"}!`),window.history.replaceState({},document.title,window.location.pathname);else if(s==="failed"){const _=S==="expired"?"√¢¬è¬∞ Do√Ñ≈∏rulama linki s√É¬ºresi dolmu√Ö≈∏. Yeni bir link talep edin.":"√¢¬ù≈í Ge√É¬ßersiz do√Ñ≈∏rulama linki.";V.error(_),window.history.replaceState({},document.title,window.location.pathname)}d==="true"&&(console.log("√∞≈∏‚Äù‚Äò [Auth] Google user needs to set password"),$s(!0),window.history.replaceState({},document.title,window.location.pathname))},[]),o.useEffect(()=>{const s=window.location.hash.match(/^#\/join\/([^/?]+)/);if(s){const f=s[1];console.log("√∞≈∏‚Äù‚Äî [Vanity] Detected vanity path:",f),Os(f)}},[]),o.useEffect(()=>(window.showAutoModeration=()=>Io(!0),window.showRaidProtection=()=>kt(!0),window.showReportSystem=()=>Ft(!0),window.showAuditLog=()=>a(!0),window.showUserWarnings=()=>p(!0),()=>{delete window.showAutoModeration,delete window.showRaidProtection,delete window.showReportSystem,delete window.showAuditLog,delete window.showUserWarnings}),[]),o.useEffect(()=>{const t=s=>{Mo&&!s.target.closest(".toolbar-menu-container")&&Fe(!1)};return document.addEventListener("click",t),()=>document.removeEventListener("click",t)},[Mo]),o.useEffect(()=>{const t=()=>{Ds(!0)};return window.addEventListener("openConnectionsPanel",t),()=>window.removeEventListener("openConnectionsPanel",t)},[]),o.useEffect(()=>{ic(),cc(),dc(),xc(),setTimeout(()=>{Sa()},3e3),"requestIdleCallback"in window&&requestIdleCallback(()=>{Nn()}),r&&i&&x(async()=>{const{pushNotificationManager:t}=await import("./pushNotifications-BJ6K-mfw.js");return{pushNotificationManager:t}},__vite__mapDeps([167,1,2])).then(({pushNotificationManager:t})=>{t.init(W,k)}),Lt&&x(async()=>{const{initializeDeepLinkHandler:t}=await import("./urlHandlers-B0YpveNd.js");return{initializeDeepLinkHandler:t}},__vite__mapDeps([168,1,2,3,4,5,6])).then(({initializeDeepLinkHandler:t})=>{console.log("√¢≈ì‚Ä¶ Deep link handler ready")}),console.log("√¢≈ì‚Ä¶ PWA ve optimizasyonlar aktif!")},[r,i]);const Vo=o.useMemo(()=>{if(l.type==="room"){if(M){for(const t of M)if(t.categories)for(const s of t.categories){const f=s.rooms?.find(S=>S.slug===l.id);if(f)return String(f.name)}}return String(l.id)}else if(l.type==="dm")return`@ ${String(l.targetUser||"DM")}`;return""},[l,M]),fo=o.useMemo(()=>!l||!l.id?"":`${l.type}-${l.id}`,[l]),Tr=o.useCallback(()=>{try{const t=localStorage.getItem(ua);if(!t)return{};const s=JSON.parse(t);return s&&typeof s=="object"?s:{}}catch(t){return console.warn("Taslak okunamad√Ñ¬±",t),{}}},[]),Gi=o.useCallback(t=>{if(!fo)return;const s=Tr();s[fo]=t,localStorage.setItem(ua,JSON.stringify(s))},[fo,Tr]);o.useEffect(()=>{if(!fo){co(""),lo(!1);return}const s=Tr()[fo]||"";co(s),lo(!!s.trim())},[fo,Tr]);const Hi=o.useMemo(()=>{if(l.type!=="room"||!M)return"text";for(const t of M)if(t.categories)for(const s of t.categories){const f=s.rooms?.find(S=>S.slug===l.id);if(f)return f.channel_type}return"text"},[l,M]),At=o.useCallback((t="auto")=>{En.current&&En.current.scrollIntoView({behavior:t})},[]),Pn=o.useCallback(()=>{const t=Tn.current;return t?t.scrollHeight-t.scrollTop-t.clientHeight<160:!0},[]),In=o.useCallback(()=>{const t=Tn.current;if(!t)return;const s=t.scrollHeight-t.scrollTop-t.clientHeight;kr(s>160)},[]),Ki=Mc(In,100),Ge=o.useCallback(t=>{if(t==="√¢≈°¬° Signal Bot")return`${ho}/static/bot/signal.png`;if(t==="PawPaw AI")return`${ho}/static/bot/ai.png`;if(!t||!Be||Be.length===0)return`${ho}/avatars/cat_1.png`;let s=0;for(let _=0;_<t.length;_++)s=t.charCodeAt(_)+((s<<5)-s);const f=Math.abs(s%Be.length),S=Be[f];let d;return typeof S=="object"&&S!==null?d=S.original||S.thumbnail||S.url:typeof S=="string"&&(d=S),!d||typeof d!="string"?`${ho}/avatars/cat_1.png`:d.startsWith("http")||d.startsWith("blob:")?d:(d.startsWith("/")||(d="/"+d),`${ho}${d}`)},[Be]),Xe=o.useCallback(t=>{const s=re.find(f=>f.username===t);if(s&&s.avatar&&typeof s.avatar=="string"){if(s.avatar.startsWith("http://")||s.avatar.startsWith("https://")||s.avatar.startsWith("blob:"))return s.avatar;let f=s.avatar;return f.startsWith("/")||(f="/"+f),`${ho}${f}`}return Ge(t)},[re,Ge]),k=o.useCallback(async(t,s={})=>{const f=s.headers||{};n&&(f.Authorization=`Bearer ${n}`),s.body instanceof FormData||(f["Content-Type"]="application/json");try{const d=t.includes("upload")||s.body instanceof FormData?3e5:3e4,_=new AbortController,P=setTimeout(()=>_.abort(),d),te=await fetch(t,{...s,headers:f,signal:_.signal});if(clearTimeout(P),te.status===401)throw t.includes("/auth/")||t.includes("/login")?(console.warn("√¢≈°¬†√Ø¬∏¬è [Auth] 401 on auth endpoint, logging out"),c()):console.warn("√¢≈°¬†√Ø¬∏¬è [Auth] 401 error on:",t,"- NOT logging out"),new Error("Unauthorized");return te}catch(S){throw S.name==="AbortError"?(console.error("√¢¬è¬±√Ø¬∏¬è [Fetch] Request timed out:",t),new Error("√Ñ¬∞stek zaman a√Ö≈∏√Ñ¬±m√Ñ¬±na u√Ñ≈∏rad√Ñ¬±")):(console.error("Fetch error:",S),S)}},[n,c]);Dc(),o.useEffect(()=>{const t=window.location.hash,s=t.includes("?")?t.split("?")[1]:"",S=new URLSearchParams(s).get("join_server");if(S&&r&&M&&M.length>0){console.log("√∞≈∏‚Äù‚Äî [Vanity URL] Found join_server parameter:",S);const d=M.find(_=>_.id===parseInt(S));if(d){if(console.log(`√∞≈∏‚Äù‚Äî Vanity URL: Redirecting to server ${d.name}`),d.categories&&d.categories.length>0){const _=d.categories[0];if(_.rooms&&_.rooms.length>0){const P=_.rooms[0];de({type:"room",id:P.slug})}}window.history.replaceState({},document.title,"/#/")}else console.log(`√∞≈∏‚Äù‚Äî Vanity URL: Server ${S} not found, showing invite modal`),(async()=>{try{const P=await k(`${W}/servers/${S}/join/`,{method:"POST"});if(P.ok)V.success("Sunucuya kat√Ñ¬±ld√Ñ¬±n√Ñ¬±z!"),window.location.reload();else{const te=await P.json();V.error(te.error||"Sunucuya kat√Ñ¬±l√Ñ¬±namad√Ñ¬±")}}catch(P){console.error("Join server error:",P),V.error("Sunucuya kat√Ñ¬±l√Ñ¬±rken hata olu√Ö≈∏tu")}finally{window.history.replaceState({},document.title,"/#/")}})()}},[r,M,k]);const Vs=o.useCallback(async t=>{try{await k(`${W}/user/server-order/update/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({server_order:t})}),console.log("√∞≈∏‚Äô¬æ Server order saved:",t)}catch(s){console.error("Server order save error:",s)}},[k]),qi=(t,s,f)=>{t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("serverId",s.toString()),t.dataTransfer.setData("sourceIndex",f.toString());const S=t.currentTarget.cloneNode(!0);S.style.position="absolute",S.style.top="-9999px",S.style.opacity="0.8",S.style.transform="rotate(5deg)",S.style.pointerEvents="none",document.body.appendChild(S),t.dataTransfer.setDragImage(S,24,24),setTimeout(()=>{document.body.contains(S)&&document.body.removeChild(S)},0),t.currentTarget.style.opacity="0.4"},Yi=t=>{t.preventDefault(),t.dataTransfer.dropEffect="move"},Ji=t=>{t.currentTarget.style.opacity="1"},Zi=o.useCallback((t,s)=>{t.preventDefault(),parseInt(t.dataTransfer.getData("serverId"));const f=parseInt(t.dataTransfer.getData("sourceIndex"));if(console.log("√∞≈∏‚Äú¬ù DROP: sourceIndex:",f,"√¢‚Ä†‚Äô targetIndex:",s),f===s){console.log("√¢¬ù≈í Ayn√Ñ¬± yere b√Ñ¬±rak√Ñ¬±l√Ñ¬±yor (sourceIndex === targetIndex), i√Ö≈∏lem iptal");return}let S=Tt.length>0?[...Tt]:M.map(P=>P.id);console.log("√∞≈∏‚Äú¬ù Mevcut s√Ñ¬±ralama:",S),console.log("√∞≈∏‚Äù‚Äû Kaynak index:",f,"√¢‚Ä†‚Äô Hedef index:",s);const[d]=S.splice(f,1),_=f<s?s-1:s;console.log("√∞≈∏≈Ω¬Ø Adjusted target index:",_),S.splice(_,0,d),console.log("√¢≈ì‚Ä¶ Yeni s√Ñ¬±ralama:",S),ds(S),Vs(S)},[Tt,M,Vs]),Bs=t=>{const s=document.getElementById(`message-${t}`);s&&s.scrollIntoView({behavior:"smooth",block:"center"})},Xi=async()=>{if(window.confirm("Bu odadaki t√É¬ºm mesajlar√Ñ¬± silmek istedi√Ñ≈∏ine emin misin?"))try{(await k(`${W}/rooms/${l.id}/clear/`,{method:"POST"})).ok&&Ae([])}catch(t){console.error(t)}},Qi=async()=>{vn(!0),ys(!0),br("");try{const t=await k(`${W}/rooms/${l.id}/summarize/`,{method:"POST"}),s=await t.json();t.ok?br(s.summary):br("Hata: "+s.error)}catch{br("Ba√Ñ≈∏lant√Ñ¬± hatas√Ñ¬±.")}ys(!1)},Ln=t=>{if(console.log("√∞≈∏‚Äú¬§ [DEBUG] sendMessage called with:",t),console.log("√∞≈∏‚Äú¬§ [DEBUG] ws.current:",ke.current),console.log("√∞≈∏‚Äú¬§ [DEBUG] ws.current.readyState:",ke.current?.readyState),console.log("√∞≈∏‚Äú¬§ [DEBUG] activeChat:",l),!t)return;const s=t.trim();if(!s)return;if(s==="/tema"){Nt(!0),uo(null),lo(!1),co(""),Uo.current?.clear?.();return}if(s==="/sablon"){dt(!0),uo(null),lo(!1),co(""),Uo.current?.clear?.();return}if(s.startsWith("/duyuru ")){const $=s.slice(8).trim();if($){const ae={type:l.type==="room"?"chat_message":"dm_message",message:`[ANNOUNCE] ${$}`,username:I,temp_id:Vr(),...l.type==="room"?{room:l.id}:{conversation:l.id}};ke.current?.send(JSON.stringify(ae)),ao({message:$,type:"info",author:I}),uo(null),lo(!1),co(""),Uo.current?.clear?.();return}}uo(null),lo(!1),co(""),Gi("");const f=l.type==="room"?`room-${l.id}`:`dm-${l.id}`,S=Zt[f];let d=s;l.type==="dm"&&S&&(d=wc(s,S));const _={type:l.type==="room"?"chat_message":"dm_message",message:d,username:I,temp_id:Vr(),...l.type==="room"?{room:l.id}:{conversation:l.id}},P=JSON.stringify(_),te=async()=>{let xe=0;for(;ke.current&&ke.current.readyState===WebSocket.CONNECTING&&xe<3e3;)await new Promise($e=>setTimeout($e,100)),xe+=100;if(ke.current&&ke.current.readyState===WebSocket.OPEN)try{return ke.current.send(P),!0}catch($e){return console.error("WebSocket send error:",$e),!1}return!1},ce=async()=>{try{const $=l.type==="dm"?`${W}/messages/send_dm/`:`${W}/messages/send/`,ae=l.type==="dm"?{conversation_id:l.id,content:d}:{room:l.id,content:d};return(await k($,{method:"POST",body:JSON.stringify(ae)})).ok}catch($){return console.error("HTTP fallback error:",$),!1}};(async()=>await te()||await ce())(),Ae($=>{const ae={..._,content:d,timestamp:new Date().toISOString(),id:_.temp_id,avatar:mt?.avatar||Ge(I)},xe=[...$,ae],$e=l.type==="room"?`room-${l.id}`:`dm-${l.id}`;return gt.current[$e]&&(gt.current[$e].messages=xe),xe}),Uo.current?.clear?.(),At("smooth")},el=t=>{const s={type:l.type==="room"?"chat_message":"dm_message",message:"",username:I,temp_id:Vr(),snippet_data:t,...l.type==="room"?{room:l.id}:{conversation:l.id}};ke.current?.send(JSON.stringify(s)),Ae(f=>[...f,{...s,timestamp:new Date().toISOString(),id:s.temp_id,avatar:mt?.avatar||Ge(I)}]),wo(!1)},On=o.useCallback(()=>{if(!l.id||l.type==="welcome"||l.type==="friends"||!I)return;if(ke.current&&ke.current.readyState===WebSocket.OPEN){const S=ke.current.url,d=l.type==="room"?`/ws/chat/${l.id}/`:`/ws/dm/${l.id}/`;if(S.includes(d)){console.log("√¢¬è¬≠√Ø¬∏¬è [WebSocket] Already connected to this chat, skipping reconnect");return}}ke.current&&(console.log("√∞≈∏‚Äù≈í [WebSocket] Closing existing connection before new one"),ke.current.close(1e3,"change_room"));let t="";const s=`?username=${encodeURIComponent(I)}&token=${n}`;l.type==="room"?t=`${zr}://${Ur}/ws/chat/${l.id}/${s}`:l.type==="dm"&&(t=`${zr}://${Ur}/ws/dm/${l.id}/${s}`),console.log("√∞≈∏‚Äù≈í [WebSocket] Connecting to:",t.split("?")[0]);const f=new WebSocket(t);ke.current=f,f.onopen=()=>{console.log("√¢≈ì‚Ä¶ [WebSocket] Connected successfully"),zt(!0)},f.onmessage=S=>{const d=JSON.parse(S.data);if(d.type==="chat"||d.type==="dm"||d.type==="chat_message_handler"){console.log("√∞≈∏‚Äú¬® [WebSocket] Message data:",{type:d.type,id:d.id,temp_id:d.temp_id,room:d.room,conversation:d.conversation});const _=P=>P.room?`room-${P.room}`:P.conversation?`dm-${P.conversation}`:(console.warn("√¢≈°¬†√Ø¬∏¬è [WebSocket] No room/conversation in message, using activeChat fallback"),l.type==="room"?`room-${l.id}`:`dm-${l.id}`);Ae(P=>{if(d.temp_id){const $=P.findIndex(ae=>ae.temp_id===d.temp_id);if($!==-1){console.log("√∞≈∏‚Äù‚Äû [WebSocket] Replacing temp message with real message:",d.temp_id,"√¢‚Ä†‚Äô",d.id);const ae=[...P];ae[$]=d;const xe=_(d);return gt.current[xe]&&(gt.current[xe].messages=ae),ae}}if(d.id&&P.some($=>$.id===d.id))return console.log("√¢¬è¬≠√Ø¬∏¬è [WebSocket] Duplicate message (by ID) skipped:",d.id),P;console.log("√∞≈∏‚Äú¬® [WebSocket] New message received:",d);const te=[...P,d],ce=_(d);return gt.current[ce]&&(gt.current[ce].messages=te),te}),Jo(d.username,!1),Pn()?At("smooth"):kr(!0)}else d.type==="typing_status_update"?d.username!==I&&Jo(d.username,d.is_typing):d.type==="chat_cleared"&&Ae([]);if(d.message&&d.message.startsWith("[ANNOUNCE] ")){const _=d.message.replace("[ANNOUNCE] ","");ao({message:_,type:"info",author:d.username})}},f.onerror=S=>{console.error("√¢¬ù≈í [WebSocket] Connection error:",S)},f.onclose=S=>{console.log("√∞≈∏‚Äù≈í [WebSocket] Connection closed:",S.code,S.reason),zt(!1)}},[l.id,l.type,I,n]);o.useEffect(()=>{bo.isNativePlatform()&&(nc.initialize({clientId:Nu,scopes:["profile","email"],grantOfflineAccess:!0}),_o("max(35px, env(safe-area-inset-top))"))},[]),o.useEffect(()=>{r&&!io&&(async()=>{try{const[s,f,S,d,_]=await Promise.all([k(Uu).then($=>$.json()),k(zn).then($=>$.json()),k(`${$u}?username=${encodeURIComponent(I)}`).then($=>$.json()),k(`${W}/friends/list/`).then($=>$.json()),k(`${W}/users/me/`).then($=>$.json())]);rt(s);const P={username:_?.username||I,email:_?.email||"",avatar:_?.avatar||null,status_message:_?.status_message||"",friend_code:_?.friend_code||"0000",social_links:_?.social_links||{},coins:_?.coins||0,status:"online",role:_?.role||"member"};Sr(P);const ce=(d.friends||[]).map($=>{const ae=$.sender_username===I,xe=ae?$.receiver_username:$.sender_username,$e=ae?$.receiver_avatar:$.sender_avatar,Pt=ae?$.receiver_status:$.sender_status,Le=ae?$.receiver_activity:$.sender_activity;return xe?{username:xe,avatar:$e,status:Pt||"offline",display_name:xe,current_activity:Le||{},status_message:"",last_seen:$.created_at,role:"friend",friend_code:""}:null}).filter(Boolean).filter($=>$.username!==P.username);pt(ce),ve(f),we(S),wn(ce),Ci(!0),x(async()=>{const{prefetchUserAvatars:$}=await import("./imageCaching-CJAldTs3.js");return{prefetchUserAvatars:$}},__vite__mapDeps([25,2])).then(({prefetchUserAvatars:$})=>{$(ce)})}catch(s){console.error("Init Data Error",s),Je("Veriler y√É¬ºklenemedi.")}})()},[r,io,k,I]),o.useEffect(()=>{I&&(async()=>{try{const s=await k(`${W}/user/server-order/`);if(s.ok){const f=await s.json();ds(f.server_order||[]),console.log("√∞≈∏≈Ω¬Ø Server order loaded:",f.server_order)}}catch(s){console.error("Server order fetch error:",s)}})()},[I,k]),o.useEffect(()=>{const t=async()=>{if(!l.id||l.type!=="room"){ao(null);return}try{const s=await k(`${W}/stickies/list/?room=${l.id}`);if(s.ok){const f=await s.json();f&&f.length>0?ao({message:f[0].content,type:"info",author:f[0].creator}):ao(null)}}catch(s){console.error("Sticky messages fetch error:",s)}};r&&l.id&&t()},[l.id,l.type,r,k]);const Rr=o.useCallback(async t=>{if(!t){Rt([]);return}try{console.log(`√∞≈∏‚Äù¬ç [Server Members] Fetching members for server ${t}...`);const s=await k(`${W}/servers/${t}/members/`);if(s.ok){const f=await s.json();console.log(`√∞≈∏‚Äò¬• [Server Members] Fetched ${f.length} members for server ${t}:`,f),Rt(f)}else{const f=await s.text();console.error("√¢¬ù≈í Server members fetch failed:",s.status,f),Rt([])}}catch(s){console.error("√¢¬ù≈í Server members fetch error:",s),Rt([])}},[k]),tl=o.useCallback(t=>{console.log("√∞≈∏‚Äì¬±√Ø¬∏¬è [Server Select] Server clicked:",t.name,t.id),Ti(t),Rr(t.id),de("server",t.id,null)},[Rr,de]);o.useEffect(()=>{const t=async()=>{if(!l.id||l.type!=="room"){l.type!=="server"&&Rt([]);return}try{let s=null;for(const f of M){if(!f.categories||!Array.isArray(f.categories)){console.warn("√¢≈°¬†√Ø¬∏¬è Server has no categories array:",f);continue}for(const S of f.categories)if(!(!S.rooms||!Array.isArray(S.rooms))){for(const d of S.rooms)if(d.slug===l.id){s=f.id;break}if(s)break}if(s)break}if(!s){console.warn("√∞≈∏‚Äù¬¥ Server ID bulunamad√Ñ¬± for room:",l.id),Rt([]);return}Rr(s)}catch(s){console.error("√¢¬ù≈í Server members fetch error:",s),Rt([])}};r&&l.id&&l.type==="room"?t():l.type!=="server"&&Rt([])},[l.id,l.type,r,Rr,M]),o.useEffect(()=>{const t=async()=>{try{const f=await fetch(`${W}/maintenance/status/`);if(f.ok){const S=await f.json();S.active?_n({message:S.message||"System maintenance in progress",endTime:S.end_time,level:S.level||"info"}):_n(null)}}catch(f){console.error("Maintenance check error:",f)}};t();const s=setInterval(t,300*1e3);return()=>clearInterval(s)},[]),o.useEffect(()=>{const t=(S,d)=>{try{const _=S.split(".").map(Number),P=d.split(".").map(Number);return _[0]>P[0]?!0:_[0]<P[0]?!1:_[1]>P[1]?!0:_[1]<P[1]?!1:_[2]>P[2]}catch(_){return console.error("√¢¬ù≈í Version kar√Ö≈∏√Ñ¬±la√Ö≈∏t√Ñ¬±rma hatas√Ñ¬±:",_),!1}},s=async()=>{const S=window.location.hostname==="localhost"&&window.location.port==="3000";if(!xo&&!Lt&&!S){console.log("√¢¬è¬≠√Ø¬∏¬è Version check atland√Ñ¬± (web browser)");return}try{console.log("√∞≈∏‚Äù¬ç Version kontrol√É¬º yap√Ñ¬±l√Ñ¬±yor...",{isElectron:xo,isNative:Lt,isDebugMode:S,hostname:window.location.hostname});const d="1.1.198";console.log("√∞≈∏‚Äú¬¶ Mevcut versiyon:",d);const _=await fetch("https://media.pawscord.com/builds/version.json");if(!_.ok){console.warn("√¢≈°¬†√Ø¬∏¬è version.json al√Ñ¬±namad√Ñ¬±:",_.status);return}const P=await _.json(),te=P.latest_version;console.log("√∞≈∏≈í¬ê Son versiyon:",te),console.log("√∞≈∏‚Äú≈† Kar√Ö≈∏√Ñ¬±la√Ö≈∏t√Ñ¬±rma:",{current:d,latest:te});const ce=t(te,d);if(console.log("√∞≈∏‚Äù¬ç √Ñ¬∞s newer?",ce),te&&ce){if(console.log("√¢≈ì‚Ä¶ YEN√Ñ¬∞ G√É≈ìNCELLEME MEVCUT!",{current:d,latest:te}),fs(!0),window.require){const{ipcRenderer:$}=window.require("electron");$.send("update-available",{currentVersion:d,latestVersion:te,downloadUrl:P.download_url_windows})}}else console.log("√¢‚Äû¬π√Ø¬∏¬è Versiyon g√É¬ºncel veya eski:",d,">=",te),fs(!1)}catch(d){console.error("√¢¬ù≈í Version check hatas√Ñ¬±:",d)}};s();const f=setInterval(s,1800*1e3);return()=>clearInterval(f)},[]),o.useEffect(()=>{if(!io||!l.id||l.type==="friends"||l.type==="welcome")return;console.log("√∞≈∏‚Äù‚Äû [DEBUG activeChat] Chat de√Ñ≈∏i√Ö≈∏ti:",l);let t=!1;const s=l.type==="room"?`room-${l.id}`:`dm-${l.id}`,f=gt.current[s];return f?.messages?.length>0?(console.log("√∞≈∏‚Äú¬¶ [Cache] Restoring cached messages:",f.messages.length,"(skipping API call)"),Ae(f.messages),xr(!!f.hasMore),bn(f.offset||0),setTimeout(()=>{t||At("auto")},50),t||On()):(console.log("√∞≈∏≈í¬ê [Fetch] No cache, fetching from server..."),bn(0),xr(!0),t||On(),setTimeout(()=>{t||Fs(!0,0)},50)),()=>{t=!0,console.log("√∞≈∏¬ß¬π [Cleanup] activeChat useEffect cleanup triggered")}},[l.id,l.type,io,On]),o.useEffect(()=>{qo?.type==="server_structure_update"&&(console.log("√∞≈∏‚Äù‚Äû Real-time Update: Refetching Server List..."),(async()=>{try{const s=await k(zn);if(s.ok){const f=await s.json();ve(f)}}catch(s){console.error("Real-time Update Failed:",s)}})())},[qo,k]),o.useEffect(()=>{if(!r||!I)return;const t={current:null},s=async()=>{try{const S=await k(`${W}/users/rich_presence/${I}/`);if(S.ok){const d=await S.json();let _={};const P=$=>{if(!$)return!0;const ae=new Date($);return(new Date-ae)/1e3/60<2};d.spotify&&P(d.spotify.timestamp)&&(_.spotify={type:"listening",name:d.spotify.track,details:d.spotify.artist,album_art:d.spotify.album_art}),d.steam&&P(d.steam.timestamp)&&(_.steam={type:"playing",name:d.steam.game,state:d.steam.state}),Object.keys(_).length===0&&(_=null);const te=JSON.stringify(t.current),ce=JSON.stringify(_);te!==ce&&(t.current=_,Er.current&&Er.current.readyState===WebSocket.OPEN&&Er.current.send(JSON.stringify({type:"update_activity",activity:_})))}}catch{}},f=setInterval(s,3e4);return s(),()=>clearInterval(f)},[r,I,k]),o.useEffect(()=>{Pn()&&(At("smooth"),kr(!1))},[Hr,Pn,At]),o.useEffect(()=>{In()},[l,In]),o.useEffect(()=>{const t=s=>{(s.ctrlKey||s.metaKey)&&s.key.toLowerCase()==="k"&&(s.preventDefault(),Us.current?.focus())};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[]),o.useEffect(()=>{if(!r||!io)return;const t=bc();ls(t);const s=`${zr}://${Ur}/ws/status/?username=${encodeURIComponent(I)}&token=${n}`,f=new WebSocket(s);return Er.current=f,f.onmessage=S=>{const d=JSON.parse(S.data);if(d.type==="online_user_list_update"){const _=Array.isArray(d.users)?d.users.map(P=>typeof P=="string"?P:P.username||P):[];console.log("√∞≈∏‚Äò¬• [Online Users] Updated:",_),Zo(_)}if(d.type==="voice_users_update"&&(console.log("√∞≈∏‚Äù≈† [GlobalWS] Received voice_users_update:",d.voice_users),qr(d.voice_users)),d.type==="user_activity_update"&&pt(_=>_.map(P=>P.username===d.username?{...P,current_activity:d.activity}:P)),d.type==="user_profile_update"&&d.user_data){const _=d.user_data;_.username===I&&(console.log("√∞≈∏‚Äò¬§ [Profile Update] Updating currentUserProfile:",_),Sr(P=>({...P,avatar:_.avatar,status_message:_.status_message,social_links:_.social_links,coins:_.coins,xp:_.xp,level:_.level,status:_.status,role:_.role}))),pt(P=>P.map(te=>te.username===_.username?{...te,..._}:te))}if(d.type==="global_message_notification"&&d.username!==I){const _=d.room_slug?`room-${d.room_slug}`:`dm-${d.conversation_id}`,P=l.type==="room"?`room-${l.id}`:`dm-${l.id}`;_!==P&&Yr(_)}d.type==="server_structure_update"&&(console.log("Server structure update received, refreshing..."),k(zn).then(_=>_.json()).then(_=>ve(_)).catch(console.error))},()=>f.close()},[r,io,I,n,l]),o.useEffect(()=>{j&&E&&(console.log(`√∞≈∏‚Äù≈† [Voice] Switched to voice chat panel: ${E}`),de("voice",E))},[j,E]);const Ns=t=>{de("room",t),Q&&_e(!1)},Bo=t=>{k(Mu,{method:"POST",body:JSON.stringify({target_username:t})}).then(s=>s.json()).then(s=>{de("dm",s.conversation_id,t),Q&&_e(!1)})},ol=o.useCallback(t=>{t&&(window.location.hash=t.startsWith("#/")?t:`#${t.startsWith("/")?t:`/${t}`}`,Q&&Ye(!1))},[Q]),rl=o.useCallback(()=>{xs(t=>{const s={...t,notifications:!t.notifications};return localStorage.setItem("chat_sound_settings",JSON.stringify(s)),s})},[]),nl=o.useCallback(async()=>{if(!l?.id)return;const t=`${window.location.origin}/#/${l.type==="dm"?`dm/${l.id}`:`room/${l.id}`}`;try{await navigator.clipboard.writeText(t),me("Link kopyaland√Ñ¬±"),setTimeout(()=>me(""),1500)}catch(s){console.error("Link kopyalanamad√Ñ¬±",s),V.error("Link kopyalanamad√Ñ¬±")}},[l]),Fs=async(t=!0,s=0)=>{if(!l.id)return;if(l.type==="voice"){console.log("[Voice] Skipping message history for voice chat"),Ae([]),xr(!1);return}console.log("√∞≈∏‚Äù‚Äû [fetchMessageHistory] Starting fetch:",{isInitial:t,offset:s,activeChat:l}),yr(!0);const f=l.type==="room"?Ou:Du,S=l.type==="room"?`room-${l.id}`:`dm-${l.id}`;try{const d=await k(`${f}${l.id}/?limit=50&offset=${s}`);if(d.ok){const _=await d.json(),P=_.results||[],te=P.filter(Le=>!Le||typeof Le!="object"?(console.warn("√¢≈°¬†√Ø¬∏¬è [fetchMessageHistory] Invalid message object:",Le),!1):!Le.id&&!Le.temp_id?(console.warn("√¢≈°¬†√Ø¬∏¬è [fetchMessageHistory] Message without ID:",Le),!1):!0);te.length<P.length&&console.warn(`√¢≈°¬†√Ø¬∏¬è [fetchMessageHistory] Filtered out ${P.length-te.length} invalid messages`);const ce=te.reverse();console.log("√¢≈ì‚Ä¶ [fetchMessageHistory] Fetched messages:",ce.length);let $=ce;t?(console.log("√∞≈∏‚Äú¬ù [fetchMessageHistory] Setting messages (INITIAL):",ce.length),Ae(ce),setTimeout(()=>At("auto"),100)):Ae(Le=>(console.log("√∞≈∏‚Äú¬ù [fetchMessageHistory] Appending to existing:",Le.length,"+",ce.length),$=[...ce,...Le],$));const ae=t?ce.length:s+ce.length,xe=!!_.next;xr(xe),t||bn(ae);const $e=gt.current[S]?.messages||[],Pt=t?ce:[...ce,...$e];gt.current[S]={messages:$||Pt,offset:ae,hasMore:xe},console.log("√∞≈∏‚Äô¬æ [fetchMessageHistory] Cached:",S,"with",($||Pt).length,"messages")}}catch(d){console.error("√¢¬ù≈í [fetchMessageHistory] Error:",d)}yr(!1)},sl=async(t,s)=>{try{console.log("√∞≈∏‚Äù‚Äò [Auth] Login attempt:",{username:t,url:ca});const f=await fetch(ca,{method:"POST",body:JSON.stringify({username:t,password:s}),headers:{"Content-Type":"application/json"}});console.log("√∞≈∏‚Äù‚Äò [Auth] Response status:",f.status);const S=await f.json();f.ok?(console.log("√¢≈ì‚Ä¶ [Auth] Login successful"),m(S.access,S.refresh)):(console.error("√¢¬ù≈í [Auth] Login failed:",S),f.status===401?Je("Kullan√Ñ¬±c√Ñ¬± ad√Ñ¬± veya √Ö≈∏ifre hatal√Ñ¬±"):f.status===400?Je(S.detail||S.error||"Ge√É¬ßersiz giri√Ö≈∏ bilgileri"):f.status>=500?Je("Sunucu hatas√Ñ¬±. L√É¬ºtfen daha sonra tekrar deneyin."):Je(S.detail||S.error||"Giri√Ö≈∏ ba√Ö≈∏ar√Ñ¬±s√Ñ¬±z"))}catch(f){console.error("√¢¬ù≈í [Auth] Network error:",f),Je("Sunucuya ba√Ñ≈∏lan√Ñ¬±lamad√Ñ¬±. √Ñ¬∞nternet ba√Ñ≈∏lant√Ñ¬±n√Ñ¬±z√Ñ¬± kontrol edin.")}},al=async(t,s,f)=>{try{console.log("√∞≈∏‚Äú¬ù [Auth] Register attempt:",{username:t,email:s,url:da});const S=await fetch(da,{method:"POST",body:JSON.stringify({username:t,email:s,password:f}),headers:{"Content-Type":"application/json"}});if(console.log("√∞≈∏‚Äú¬ù [Auth] Response status:",S.status),S.status===201)return console.log("√¢≈ì‚Ä¶ [Auth] Registration successful"),!0;const d=await S.json();console.error("√¢¬ù≈í [Auth] Registration failed:",d);let _="";return d.username?_=d.username.join(" "):d.email?_=d.email.join(" "):d.password?_=d.password.join(" "):d.detail?_=d.detail:_=Object.values(d).flat().join(" "),Je(_||"Kay√Ñ¬±t i√Ö≈∏lemi ba√Ö≈∏ar√Ñ¬±s√Ñ¬±z"),!1}catch(S){return console.error("√¢¬ù≈í [Auth] Network error:",S),Je("Sunucuya ba√Ñ≈∏lan√Ñ¬±lamad√Ñ¬±. √Ñ¬∞nternet ba√Ñ≈∏lant√Ñ¬±n√Ñ¬±z√Ñ¬± kontrol edin."),!1}},Ar=o.useCallback(async(t,s=!1,f=0,S=null)=>{kn(!0),_r(0);const d=S||l,_=Vr();try{const P=await Fu(t),te=t.type||"application/octet-stream",ce=10*1024*1024,$=5,ae=Math.ceil(t.size/ce);console.log("√∞≈∏≈°‚Ç¨ [R2 Multipart] Starting upload:",{fileName:t.name,fileSize:(t.size/(1024*1024)).toFixed(2)+" MB",totalParts:ae,parallelUploads:$});const $e=await(await k(`${W}/upload/multipart/init/`,{method:"POST",body:JSON.stringify({file_name:t.name,file_size:t.size,content_type:te,file_hash:P})})).json();if($e.file_exists){console.log("√¢≈ì‚Ä¶ [R2] File already exists, skipping upload"),V.success("Dosya zaten y√É¬ºkl√É¬º!"),kn(!1),_r(100);return}const{upload_id:Pt,key:Le}=$e;console.log(`√∞≈∏‚Äú¬¶ [R2] Upload ID: ${Pt.substring(0,20)}..., Key: ${Le}`);const Lr=[];let Hs=0;const gl=async he=>{const He=(he-1)*ce,It=Math.min(He+ce,t.size),po=t.slice(He,It);console.log(`√∞≈∏‚Äú¬§ [R2] Part ${he}/${ae} uploading...`);const No=new FormData;No.append("upload_id",Pt),No.append("key",Le),No.append("part_number",he.toString()),No.append("chunk",po,`part_${he}`);const Or=await k(`${W}/upload/multipart/upload-part/`,{method:"POST",body:No,headers:{}});if(!Or.ok){const yl=await Or.text();throw new Error(`Part ${he} upload failed: ${Or.status} - ${yl}`)}const{etag:Ks,part_number:hl}=await Or.json();Hs++;const qs=Math.round(Hs/ae*95);return _r(qs),console.log(`√¢≈ì‚Ä¶ [R2] Part ${he}/${ae} complete (${qs}%), ETag: ${Ks}`),{ETag:Ks,PartNumber:hl}};for(let he=0;he<ae;he+=$){const He=[];for(let po=0;po<$&&he+po<ae;po++)He.push(gl(he+po+1));const It=await Promise.all(He);Lr.push(...It)}Lr.sort((he,He)=>he.PartNumber-He.PartNumber),console.log("√∞≈∏‚Äú‚Äπ [R2] All parts uploaded, completing...",Lr);const $n=await k(`${W}/upload/multipart/complete/`,{method:"POST",body:JSON.stringify({upload_id:Pt,key:Le,parts:Lr,file_name:t.name,file_hash:P,room_slug:d.type==="room"?d.id:null,conversation_id:d.type==="dm"?d.id:null,temp_id:_,is_voice_message:s?"true":"false",duration:f.toString()})});if(!$n.ok){const he=await $n.text();throw new Error(`Complete failed: ${he}`)}const qt=await $n.json();_r(100),console.log("√¢≈ì‚Ä¶ [R2 Multipart] Upload complete!",qt),d.id===l.id&&(Ae(he=>{if(qt.temp_id){const He=he.findIndex(It=>It.temp_id===qt.temp_id);if(He!==-1){const It=[...he];return It[He]=qt,It}}return qt.id&&he.some(He=>He.id===qt.id)?he:[...he,qt]}),At("smooth"))}catch(P){console.error("√¢¬ù≈í [R2 Multipart] Error:",P),V.error(`Y√É¬ºkleme hatas√Ñ¬±: ${P.message}`)}kn(!1)},[l,I,k]),il=t=>{t.preventDefault(),t.stopPropagation(),vr(!1),t.dataTransfer.files&&t.dataTransfer.files.length>0&&Ar(t.dataTransfer.files[0])},ll=(t,s)=>{if(t.preventDefault(),t.stopPropagation(),dr(null),t.dataTransfer.files&&t.dataTransfer.files.length>0){const f=t.dataTransfer.files[0];if(s.type==="dm"){const S=ft.find(d=>d.id===s.id);if(S){const d=S.participants.find(_=>_.username!==I);d&&(Bo(d.username),setTimeout(()=>{Ar(f,!1,0,s)},300))}}else s.type==="room"&&roomsWithCategories.find(d=>d.room_slug===s.id)&&(handleRoomClick(s.id),setTimeout(()=>{Ar(f,!1,0,s)},300))}},cl=async t=>{if(t.preventDefault(),!l.id||!$t.trim()){$t.trim()||Fs(!0,0);return}yr(!0);try{let s=`${W}/messages/search/?q=${encodeURIComponent($t)}`;l.type==="room"?s+=`&room=${l.id}`:s+=`&dm=${l.id}`;const f=await k(s);if(f.ok){const S=await f.json();Ae(S.results||S)}}catch(s){console.error(s)}yr(!1)},Ws=async t=>{if(window.confirm("Bu mesaj√Ñ¬± silmek istedi√Ñ≈∏ine emin misin?"))try{(await k(`${W}/messages/${t}/delete/`,{method:"DELETE"})).ok&&Ae(f=>f.filter(S=>S.id!==t))}catch(s){console.error(s)}},dl=async t=>{if(window.confirm("Bu sohbeti listenizden gizlemek istiyor musunuz?"))try{(await k(`${W}/conversations/${t}/hide/`,{method:"POST"})).ok&&(we(f=>f.filter(S=>S.id!==t)),l.type==="dm"&&l.id===t&&de("welcome","welcome"))}catch(s){console.error(s)}},ul=async t=>{if(window.confirm(`√¢≈°¬†√Ø¬∏¬è ADM√Ñ¬∞N: Bu konu√Ö≈∏may√Ñ¬± HER √Ñ¬∞K√Ñ¬∞ TARAFTAN KALICI OLARAK silmek istedi√Ñ≈∏inize emin misiniz?

Bu i√Ö≈∏lem GER√Ñ¬∞ ALINAMAZ!`))try{const s=await k(`${W}/conversations/${t}/admin-delete/`,{method:"DELETE"});if(s.ok){const f=await s.json();V.success(`√¢≈ì‚Ä¶ ${f.deleted_messages} mesaj silindi. Kat√Ñ¬±l√Ñ¬±mc√Ñ¬±lar: ${f.participants.join(", ")}`),we(S=>S.filter(d=>d.id!==t)),l.type==="dm"&&l.id===t&&de("welcome","welcome")}else{const f=await s.json();V.error(`√¢¬ù≈í Hata: ${f.error||"Silme i√Ö≈∏lemi ba√Ö≈∏ar√Ñ¬±s√Ñ¬±z"}`)}}catch(s){console.error(s),V.error("√¢¬ù≈í Sunucuyla ba√Ñ≈∏lant√Ñ¬± hatas√Ñ¬±")}},fl=o.useCallback(()=>{de("welcome","welcome",null),Q&&_e(!1)},[Q]),pl=o.useCallback(async(t,s,f)=>{switch(t){case"profile":const S=re.find(d=>d.username===s.username);S&&st(S);break;case"message":Bo(s.username);break;case"volume":break;case"move":if(Te&&f&&E)try{(await k(`${W}/voice/move_user/`,{method:"POST",body:JSON.stringify({username:s.username,from_channel:E,to_channel:f})})).ok&&console.log(`√¢≈ì‚Ä¶ ${s.username} moved to ${f}`)}catch(d){console.error("Move user error:",d)}break;case"kick":if(Te&&window.confirm(`${s.username} kullan√Ñ¬±c√Ñ¬±s√Ñ¬±n√Ñ¬± kanaldan atmak istedi√Ñ≈∏ine emin misin?`))try{(await k(`${W}/voice/kick_user/`,{method:"POST",body:JSON.stringify({username:s.username,room:E})})).ok&&console.log(`√¢≈ì‚Ä¶ ${s.username} kicked from voice`)}catch(d){console.error("Kick user error:",d)}break;case"server_mute":if(Te)try{(await k(`${W}/voice/server_mute/`,{method:"POST",body:JSON.stringify({username:s.username,room:E})})).ok&&console.log(`√¢≈ì‚Ä¶ ${s.username} server muted`)}catch(d){console.error("Server mute error:",d)}break;case"add_friend":try{const d=await k(`${W}/friends/send/`,{method:"POST",body:JSON.stringify({username:s.username})});if(d.ok)me(`√¢≈ì‚Ä¶ ${s.username} kullan√Ñ¬±c√Ñ¬±s√Ñ¬±na arkada√Ö≈∏l√Ñ¬±k iste√Ñ≈∏i g√É¬∂nderildi!`),setTimeout(()=>me(""),3e3);else{const _=await d.json();me(`√¢¬ù≈í ${_.error||"√Ñ¬∞stek g√É¬∂nderilemedi"}`),setTimeout(()=>me(""),3e3)}}catch(d){console.error("Add friend error:",d),me("√¢¬ù≈í Arkada√Ö≈∏ ekleme hatas√Ñ¬±"),setTimeout(()=>me(""),3e3)}break;case"remove_friend":if(window.confirm(`${s.username} ile arkada√Ö≈∏l√Ñ¬±√Ñ≈∏√Ñ¬± sonland√Ñ¬±rmak istedi√Ñ≈∏inize emin misiniz?`))try{const d=Ht.find(_=>_.sender_username===s.username||_.receiver_username===s.username);if(d&&(await k(`${W}/friends/remove/${d.id}/`,{method:"DELETE"})).ok){me(`√¢≈ì‚Ä¶ ${s.username} ile arkada√Ö≈∏l√Ñ¬±k sonland√Ñ¬±r√Ñ¬±ld√Ñ¬±`),setTimeout(()=>me(""),3e3);const P=await k(`${W}/friends/list/`);if(P.ok){const te=await P.json();wn(te.friends||[])}}}catch(d){console.error("Remove friend error:",d),me("√¢¬ù≈í Arkada√Ö≈∏l√Ñ¬±k sonland√Ñ¬±rma hatas√Ñ¬±"),setTimeout(()=>me(""),3e3)}break;case"invite_to_server":jr({username:s.username});break;case"mute_user":try{const d=await k(`${W}/users/${s.username}/mute/`,{method:"POST"});if(d.ok)V.success(`√∞≈∏‚Äù‚Ä° ${s.username} sessize al√Ñ¬±nd√Ñ¬±`);else{const _=await d.json();V.error(`√¢¬ù≈í ${_.error||"Sessize alma ba√Ö≈∏ar√Ñ¬±s√Ñ¬±z"}`)}}catch(d){console.error("Mute user error:",d),V.error("√¢¬ù≈í Sessize alma hatas√Ñ¬±")}break;case"block_user":if(window.confirm(`${s.username} kullan√Ñ¬±c√Ñ¬±s√Ñ¬±n√Ñ¬± engellemek istedi√Ñ≈∏inize emin misiniz?`))try{const d=await k(`${W}/users/${s.username}/block/`,{method:"POST"});if(d.ok){V.success(`√∞≈∏≈°¬´ ${s.username} engellendi`);const _=await k(`${W}/friends/list/`);if(_.ok){const P=await _.json();wn(P.friends||[])}}else{const _=await d.json();V.error(`√¢¬ù≈í ${_.error||"Engelleme ba√Ö≈∏ar√Ñ¬±s√Ñ¬±z"}`)}}catch(d){console.error("Block user error:",d),V.error("√¢¬ù≈í Engelleme hatas√Ñ¬±")}break;default:console.log("Unknown action:",t)}},[re,Te,E,k,W,Bo,Ht,me]),ml=()=>{if(xo){Dt(!0),me("√Ñ¬∞ndiriliyor...");const{ipcRenderer:t}=window.require("electron"),s=`${A}/media/build/Pawscord-Setup.exe`;t.send("start-download",s)}else window.open(`${A}/media/build/Pawscord-Setup.exe`,"_blank")};o.useEffect(()=>{if(xo){const{ipcRenderer:t}=window.require("electron"),s=(d,_)=>or(Math.round(_*100)),f=()=>{me("Ba√Ö≈∏lat√Ñ¬±l√Ñ¬±yor..."),or(100),setTimeout(()=>me("Kapan√Ñ¬±yor..."),1500)},S=(d,_)=>{Dt(!1),V.error(`√Ñ¬∞ndirme hatas√Ñ¬±: ${_}`)};return t.on("download-progress",s),t.on("download-complete",f),t.on("download-error",S),()=>{t.removeAllListeners("download-progress"),t.removeAllListeners("download-complete"),t.removeAllListeners("download-error")}}},[]);const Gs=N!=="finished";if(!r)return e.jsxs(e.Fragment,{children:[Gs&&e.jsx(na,{animationState:N}),e.jsx(id,{onLogin:sl,onRegister:al,error:an,setAuthError:Je})]});const Pr=Q&&!Lt?"20px":Mt,Dn=l.type==="room"?`room-${l.id}`:`dm-${l.id}`,Ir=!!Zt[Dn];return Ls?e.jsx(o.Suspense,{fallback:e.jsx(et,{size:"large",text:"Davet y√É¬ºkleniyor..."}),children:e.jsx(wu,{vanityPath:Ls,fetchWithAuth:k,apiBaseUrl:A,onClose:()=>{Os(null),window.location.hash="#/"}})}):e.jsxs("div",{style:{...F.mainContainer},className:"dark-theme",children:[Gs&&e.jsx(na,{animationState:N}),wr&&e.jsx(Kc,{message:wr.message,endTime:wr.endTime,level:wr.level,onDismiss:()=>_n(null)}),e.jsxs(o.Suspense,{fallback:e.jsx(et,{size:"medium",text:"Modal y√É¬ºkleniyor..."}),children:[nn&&e.jsx(ku,{user:mt,onClose:()=>ir(!1),onProfileUpdate:t=>Sr(t),onLogout:c,fetchWithAuth:k,getDeterministicAvatar:Ge,updateProfileUrl:zu,changeUsernameUrl:Vu,soundSettings:$o,onUpdateSoundSettings:xs,onImageClick:_t,apiBaseUrl:A}),ro&&e.jsx(md,{onClose:()=>Ro(!1)}),un&&e.jsx(Td,{onClose:()=>Ao(!1),fetchWithAuth:k,apiBaseUrl:A}),Po&&e.jsx(Rd,{onClose:()=>ur(!1),onOpenAnalytics:()=>Ao(!0),onOpenWebhooks:()=>fr(!0),onOpenModTools:()=>pn(!0),onOpenAuditLogs:()=>a(!0),onOpenReports:()=>Ft(!0),onOpenVanityURL:()=>no(!0),onOpenAutoResponder:()=>C(!0),fetchWithAuth:k,apiBaseUrl:A}),Oi&&e.jsx(lu,{fetchWithAuth:k,apiBaseUrl:A,onClose:()=>Es(!1),username:I}),Di&&e.jsx(cu,{fetchWithAuth:k,apiBaseUrl:A,onClose:()=>Ts(!1),username:I}),$i&&e.jsx(du,{fetchWithAuth:k,apiBaseUrl:A,onClose:()=>Rs(!1),username:I}),Mi&&e.jsx(uu,{fetchWithAuth:k,apiBaseUrl:A,onClose:()=>As(!1),username:I}),zi&&e.jsx(fu,{fetchWithAuth:k,apiBaseUrl:A,onClose:()=>Ps(!1),username:I}),Ui&&e.jsx(pu,{fetchWithAuth:k,apiBaseUrl:A,onClose:()=>Is(!1),serverId:l?.type==="room"?l.server_id:null}),Vi&&e.jsx(Ru,{onClose:()=>Ds(!1)}),Bi&&e.jsx(Au,{onClose:()=>$s(!1),apiBaseUrl:A}),pr&&e.jsx(Id,{serverId:l?.type==="room"?l.server_id:null,fetchWithAuth:k,apiBaseUrl:A,onClose:()=>Io(!1)}),gn&&e.jsx(Od,{serverId:l?.type==="room"?l.server_id:null,fetchWithAuth:k,apiBaseUrl:A,onClose:()=>kt(!1)}),at&&e.jsx(Dd,{serverId:l?.type==="room"?l.server_id:null,fetchWithAuth:k,apiBaseUrl:A,onClose:()=>Ft(!1)}),so&&e.jsx($d,{serverId:l?.type==="room"?l.server_id:null,fetchWithAuth:k,apiBaseUrl:A,onClose:()=>a(!1)}),u&&e.jsx(Md,{serverId:l?.type==="room"?l.server_id:null,fetchWithAuth:k,apiBaseUrl:A,onClose:()=>p(!1)}),fn&&e.jsx(Ad,{serverId:l?.type==="room"?l.server_id:null,fetchWithAuth:k,apiBaseUrl:A,onClose:()=>fr(!1)}),mn&&e.jsx(Pd,{serverId:l?.type==="room"?l.server_id:null,fetchWithAuth:k,apiBaseUrl:A,onClose:()=>no(!1)}),v&&l?.type==="room"&&l.server_id&&e.jsx(o.Suspense,{fallback:e.jsx("div",{children:"Y√É¬ºkleniyor..."}),children:e.jsx(ia,{fetchWithAuth:k,apiBaseUrl:A,serverId:l.server_id,onClose:()=>C(!1)})}),w&&e.jsx(o.Suspense,{fallback:e.jsx("div",{children:"Y√É¬ºkleniyor..."}),children:e.jsx(zd,{fetchWithAuth:k,apiBaseUrl:A,onClose:()=>h(!1),onMessageClick:t=>{t.room?de({type:"room",slug:t.room}):t.conversation&&de({type:"dm",slug:t.conversation}),h(!1)}})}),g&&e.jsx(o.Suspense,{fallback:e.jsx("div",{children:"Y√É¬ºkleniyor..."}),children:e.jsx(Ud,{fetchWithAuth:k,apiBaseUrl:A,onClose:()=>T(!1),onMessageClick:t=>{t.room?de({type:"room",slug:t.room}):t.conversation&&de({type:"dm",slug:t.conversation}),T(!1)}})}),O&&l?.type==="room"&&e.jsx(o.Suspense,{fallback:e.jsx("div",{children:"Y√É¬ºkleniyor..."}),children:e.jsx(Vd,{fetchWithAuth:k,apiBaseUrl:A,channelSlug:l.slug,onClose:()=>K(!1)})}),pr&&e.jsx(o.Suspense,{fallback:e.jsx("div",{children:"Y√É¬ºkleniyor..."}),children:e.jsx(Ld,{fetchWithAuth:k,apiBaseUrl:A,serverId:l?.type==="room"?l.server_id:null,onClose:()=>Io(!1)})}),tr&&e.jsx(pd,{symbol:tr,onClose:()=>Ot(null)}),ln&&e.jsx(Sd,{onClose:()=>To(!1),ws:ke,username:I}),Qt&&e.jsx(fd,{onClose:()=>wo(!1),onSend:el}),ms&&e.jsx(jd,{onClose:()=>gs(null),server:ms,currentUsername:I,fetchWithAuth:k,apiBaseUrl:A,serverMembers:Kt}),Qr&&e.jsx(kd,{onClose:()=>er(!1),onSetKey:t=>Jr(Dn,t),existingKey:Zt[Dn]}),Ri&&e.jsx(Cd,{onClose:()=>ps(!1),apiBaseUrl:A}),hs&&e.jsx(aa,{isLoading:Ai,summaryText:Pi,onClose:()=>vn(!1)}),Zr&&e.jsx(Ed,{onClose:()=>Xo(!1),friendsList:Ht,fetchWithAuth:k,apiBaseUrl:A,onGroupCreated:t=>{we(s=>[t,...s]),de("dm",t.id,"Grup Sohbeti")}}),Xr&&(l.type==="room"||l.type==="dm")&&e.jsx(gd,{roomSlug:l.type==="room"?l.id:`dm_${l.id}`,onClose:()=>Xt(!1),wsProtocol:zr,apiHost:Ur}),Qo&&e.jsx(hd,{onClose:()=>bt(!1),fetchWithAuth:k,apiBaseUrl:A,sendSignal:ne,absoluteHostUrl:A}),Ii&&e.jsx(vd,{onClose:()=>Ss(!1),ws:ke,roomSlug:l.id}),sn&&e.jsx(wd,{onSelect:t=>{const s=t.startsWith("http")?t:A+t;Ln(s),cr(!1)},onClose:()=>cr(!1),localGifListUrl:Bu,absoluteHostUrl:A,fetchWithAuth:k}),Pe&&e.jsx(bd,{onClose:()=>Ut(!1),onSelect:t=>{Ln(t),Ut(!1)},fetchWithAuth:k,apiBaseUrl:A}),vo&&e.jsx(ud,{onClose:()=>rn(!1),fetchWithAuth:k,apiBaseUrl:A,activeRoomSlug:l.id})]}),hn&&l?.type==="room"&&e.jsx(o.Suspense,{fallback:e.jsx("div",{children:"Y√É¬ºkleniyor..."}),children:e.jsx(Bd,{fetchWithAuth:k,apiBaseUrl:A,roomSlug:l.slug,onClose:()=>ts(!1)})}),yn&&l?.type==="room"&&e.jsx(o.Suspense,{fallback:e.jsx("div",{children:"Y√É¬ºkleniyor..."}),children:e.jsx(Nd,{fetchWithAuth:k,apiBaseUrl:A,roomSlug:l.slug,onClose:()=>Oo(!1)})}),Gt&&l?.type==="room"&&l.server_id&&e.jsx(o.Suspense,{fallback:e.jsx("div",{children:"Y√É¬ºkleniyor..."}),children:e.jsx(Fd,{fetchWithAuth:k,apiBaseUrl:A,serverId:l.server_id,onClose:()=>it(!1)})}),Do&&e.jsx(o.Suspense,{fallback:e.jsx("div",{children:"Y√É¬ºkleniyor..."}),children:e.jsx(Wd,{fetchWithAuth:k,apiBaseUrl:A,username:I,onClose:()=>hr(!1)})}),xn&&e.jsx(o.Suspense,{fallback:e.jsx("div",{children:"Y√É¬ºkleniyor..."}),children:e.jsx(Gd,{fetchWithAuth:k,apiBaseUrl:A,username:I,onClose:()=>Sn(!1)})}),Ra&&e.jsx(o.Suspense,{fallback:e.jsx("div",{children:"Y√É¬ºkleniyor..."}),children:e.jsx(Hd,{fetchWithAuth:k,apiBaseUrl:A,onClose:()=>Aa(!1)})}),Pa&&l?.type==="room"&&l.server_id&&e.jsx(o.Suspense,{fallback:e.jsx("div",{children:"Y√É¬ºkleniyor..."}),children:e.jsx(Kd,{fetchWithAuth:k,apiBaseUrl:A,serverId:l.server_id,onClose:()=>Ia(!1)})}),La&&e.jsx(o.Suspense,{fallback:e.jsx("div",{children:"Y√É¬ºkleniyor..."}),children:e.jsx(qd,{fetchWithAuth:k,apiBaseUrl:A,onClose:()=>Oa(!1)})}),Da&&l?.type==="room"&&e.jsx(o.Suspense,{fallback:e.jsx("div",{children:"Y√É¬ºkleniyor..."}),children:e.jsx(Yd,{fetchWithAuth:k,apiBaseUrl:A,roomSlug:l.slug,onClose:()=>$a(!1)})}),Ma&&l?.type==="room"&&e.jsx(o.Suspense,{fallback:e.jsx("div",{children:"Y√É¬ºkleniyor..."}),children:e.jsx(Jd,{fetchWithAuth:k,apiBaseUrl:A,roomSlug:l.slug,onClose:()=>za(!1)})}),Ua&&e.jsx(o.Suspense,{fallback:e.jsx("div",{children:"Y√É¬ºkleniyor..."}),children:e.jsx(Zd,{fetchWithAuth:k,apiBaseUrl:A,onClose:()=>os(!1),onLoadDraft:t=>{t.room&&de({type:"room",slug:t.room}),os(!1)}})}),Va&&l?.type==="room"&&l.server_id&&e.jsx(o.Suspense,{fallback:e.jsx("div",{children:"Y√É¬ºkleniyor..."}),children:e.jsx(Xd,{fetchWithAuth:k,apiBaseUrl:A,serverId:l.server_id,onClose:()=>Ba(!1)})}),Na&&l?.type==="room"&&l.server_id&&e.jsx(o.Suspense,{fallback:e.jsx("div",{children:"Y√É¬ºkleniyor..."}),children:e.jsx(Qd,{fetchWithAuth:k,apiBaseUrl:A,serverId:l.server_id,currentUsername:I,onClose:()=>Fa(!1)})}),Wa&&l?.type==="room"&&e.jsx(o.Suspense,{fallback:e.jsx("div",{children:"Y√É¬ºkleniyor..."}),children:e.jsx(eu,{fetchWithAuth:k,apiBaseUrl:A,roomSlug:l.slug,onClose:()=>Ga(!1)})}),Ha&&e.jsx(o.Suspense,{fallback:e.jsx("div",{children:"Y√É¬ºkleniyor..."}),children:e.jsx(tu,{fetchWithAuth:k,apiBaseUrl:A,onClose:()=>Ka(!1)})}),qa&&l?.type==="room"&&l.server_id&&e.jsx(o.Suspense,{fallback:e.jsx("div",{children:"Y√É¬ºkleniyor..."}),children:e.jsx(ia,{fetchWithAuth:k,apiBaseUrl:A,serverId:l.server_id,onClose:()=>Ya(!1)})}),Ja&&e.jsx(o.Suspense,{fallback:e.jsx("div",{children:"Y√É¬ºkleniyor..."}),children:e.jsx(ou,{fetchWithAuth:k,apiBaseUrl:A,onClose:()=>Za(!1)})}),Xa&&e.jsx(o.Suspense,{fallback:e.jsx("div",{children:"Y√É¬ºkleniyor..."}),children:e.jsx(ru,{fetchWithAuth:k,apiBaseUrl:A,onClose:()=>Qa(!1)})}),ei&&l?.type==="room"&&l.server_id&&e.jsx(o.Suspense,{fallback:e.jsx("div",{children:"Y√É¬ºkleniyor..."}),children:e.jsx(nu,{fetchWithAuth:k,apiBaseUrl:A,serverId:l.server_id,onClose:()=>ti(!1)})}),oi&&e.jsx(o.Suspense,{fallback:e.jsx("div",{children:"Y√É¬ºkleniyor..."}),children:e.jsx(su,{fetchWithAuth:k,apiBaseUrl:A,onClose:()=>rs(!1),onSuccess:()=>{V.success("2FA ba√Ö≈∏ar√Ñ¬±yla etkinle√Ö≈∏tirildi!"),rs(!1)}})}),ri&&l?.type==="room"&&e.jsx(o.Suspense,{fallback:e.jsx("div",{children:"Y√É¬ºkleniyor..."}),children:e.jsx(au,{fetchWithAuth:k,apiBaseUrl:A,roomSlug:l.slug,onClose:()=>ni(!1)})}),si&&e.jsx(o.Suspense,{fallback:e.jsx("div",{children:"Y√É¬ºkleniyor..."}),children:e.jsx(iu,{fetchWithAuth:k,apiBaseUrl:A,onClose:()=>ai(!1)})}),ii&&l?.type==="room"&&l.server_id&&e.jsx(o.Suspense,{fallback:e.jsx("div",{children:"Y√É¬ºkleniyor..."}),children:e.jsx(mu,{fetchWithAuth:k,apiBaseUrl:A,serverId:l.server_id,onClose:()=>li(!1)})}),ci&&e.jsx(o.Suspense,{fallback:e.jsx("div",{children:"Y√É¬ºkleniyor..."}),children:e.jsx(gu,{fetchWithAuth:k,apiBaseUrl:A,onClose:()=>ns(!1),onMessageClick:t=>{t.room&&de({type:"room",slug:t.room}),ns(!1)}})}),di&&l?.type==="room"&&l.server_id&&e.jsx(o.Suspense,{fallback:e.jsx("div",{children:"Y√É¬ºkleniyor..."}),children:e.jsx(hu,{fetchWithAuth:k,apiBaseUrl:A,serverId:l.server_id,onClose:()=>ui(!1)})}),fi&&e.jsx(o.Suspense,{fallback:e.jsx("div",{children:"Y√É¬ºkleniyor..."}),children:e.jsx(yu,{fetchWithAuth:k,apiBaseUrl:A,url:null,onClose:()=>pi(!1)})}),mi&&e.jsx(o.Suspense,{fallback:e.jsx("div",{children:"Y√É¬ºkleniyor..."}),children:e.jsx(xu,{fetchWithAuth:k,apiBaseUrl:A,onClose:()=>gi(!1)})}),hi&&l?.type==="room"&&l.server_id&&e.jsx(o.Suspense,{fallback:e.jsx("div",{children:"Y√É¬ºkleniyor..."}),children:e.jsx(Su,{fetchWithAuth:k,apiBaseUrl:A,serverId:l.server_id,onClose:()=>yi(!1)})}),xi&&e.jsx(o.Suspense,{fallback:e.jsx("div",{children:"Y√É¬ºkleniyor..."}),children:e.jsx(bu,{fetchWithAuth:k,apiBaseUrl:A,onClose:()=>Si(!1)})}),bi&&e.jsx(o.Suspense,{fallback:e.jsx("div",{children:"√∞≈∏≈Ω¬Æ Oyunlar Y√É¬ºkleniyor..."}),children:e.jsx(MiniGamesPanel,{fetchWithAuth:k,apiBaseUrl:A,roomSlug:l?.id,currentUser:I,onClose:()=>ss(!1)})}),wi&&e.jsx(o.Suspense,{fallback:e.jsx("div",{children:"√∞≈∏‚Äú‚Äö Projeler Y√É¬ºkleniyor..."}),children:e.jsx(ProjectCollaborationPanel,{fetchWithAuth:k,apiBaseUrl:A,serverId:l?.server_id,currentUser:I,onClose:()=>as(!1)})}),vi&&e.jsx(o.Suspense,{fallback:e.jsx("div",{children:"√∞≈∏≈Ω¬® Avatar Studio Y√É¬ºkleniyor..."}),children:e.jsx(AvatarStudioPanel,{fetchWithAuth:k,apiBaseUrl:A,currentUser:I,onClose:()=>is(!1),onAvatarChange:t=>{mt&&Sr({...mt,avatar_url:t}),V.success("√∞≈∏≈Ω¬® Avatar g√É¬ºncellendi!")}})}),Bt&&e.jsx(cd,{imageUrl:Bt,onClose:()=>_t(null)}),oo&&e.jsx(o.Suspense,{fallback:e.jsx(et,{size:"small",text:"Sabitlenmi√Ö≈∏ mesajlar y√É¬ºkleniyor..."}),children:e.jsx(ju,{messages:ot,onClose:()=>lr(!1)})}),nt&&e.jsx(dd,{user:nt,onClose:()=>st(null),onStartDM:Bo,onImageClick:_t,getDeterministicAvatar:Ge,fetchWithAuth:k,apiBaseUrl:A,currentUser:I,friendsList:Ht}),Q&&jo&&e.jsx("div",{style:F.mobileOverlay,onClick:()=>_e(!1)}),Q&&Eo&&e.jsx("div",{style:F.mobileOverlay,onClick:()=>Ye(!1)}),e.jsxs("div",{style:F.chatLayout,children:[(!Q||jo)&&e.jsxs("div",{style:{...F.sidebarWrapper,...Q&&F.mobileSidebar,paddingTop:Pr,paddingBottom:sr,height:"100%",boxSizing:"border-box"},children:[Q&&e.jsxs("div",{style:F.mobileSidebarHeader,children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx("img",{src:"https://media.pawscord.com/assets/logo.png",alt:"",style:{width:"24px",height:"24px"},onError:t=>{t.target.style.display="none"}}),e.jsx("span",{style:{fontSize:"18px",fontWeight:"bold",color:"white"},children:"Pawscord"})]}),e.jsx("button",{onClick:()=>_e(!1),style:F.closeSidebarButton,children:e.jsx(Go,{})})]}),e.jsx(_u,{onFriendsClick:()=>de("friends","friends"),onRoomSelect:Ns,onDMSelect:(t,s)=>de("dm",t,s),onWelcomeClick:fl,setIsLeftSidebarVisible:_e,onProfileClick:()=>ir(!0),onViewUserProfile:t=>{const s=re.find(f=>f.username===t);s&&st(s)},onOpenStore:()=>Ro(!0),onOpenServerSettings:t=>gs(t),categories:Fi,onServerDragStart:qi,onServerDragOver:Yi,onServerDragEnd:Ji,onServerDrop:Zi,conversations:ft,allUsers:re,onlineUsers:Rn,serverMembers:Kt,isAdmin:Te,friendsList:Ht,pendingFriendRequests:ji,currentUsername:I,currentUserProfile:mt,getRealUserAvatar:Xe,getDeterministicAvatar:Ge,unreadCounts:Yo,joinVoiceChat:L,leaveVoiceChat:q,voiceUsers:Kr,isConnecting:R,currentVoiceRoom:E,currentRoom:E,currentConversationId:l.type==="dm"?l.id:null,remoteVolumes:G,setRemoteVolume:J,isPttActive:pe,apiBaseUrl:A,fetchWithAuth:k,onHideConversation:dl,handleDrop:ll,dropTarget:cn,setDropTarget:dr,isDragging:bs,onOpenCreateGroup:()=>Xo(!0),toggleMute:ee,toggleDeafened:H,isMuted:D,isDeafened:z,isInVoice:j,toggleVideo:B,toggleScreenShare:U,isVideoEnabled:Y,isScreenSharing:ue,updateAvailable:us,onUpdateClick:()=>ps(!0),onOpenAnalytics:()=>Ao(!0),onOpenAdminPanel:()=>ur(!0),onOpenPaymentPanel:()=>Es(!0),onOpenStoreModal:()=>Ts(!0),onOpenDailyRewards:()=>Rs(!0),onOpenAPIUsage:()=>As(!0),onOpenExportJobs:()=>Ps(!0),onOpenScheduledAnnouncements:()=>Is(!0),onOpenMiniGames:()=>ss(!0),onOpenProjectCollaboration:()=>as(!0),onOpenAvatarStudio:()=>is(!0),onServerSelect:tl})]}),e.jsxs("div",{style:F.mainContent,children:[e.jsx("div",{style:{position:"absolute",top:60,left:0,right:0,zIndex:90},children:e.jsx(ad,{message:cs?.message,type:cs?.type,onDismiss:()=>ao(null)})}),l.type==="friends"?e.jsx("div",{style:{width:"100%",height:"100%",paddingTop:Pr},children:e.jsx(vu,{fetchWithAuth:k,apiBaseUrl:A,onStartDM:Bo,getDeterministicAvatar:Ge,onClose:()=>de("welcome","welcome"),onPendingCountChange:Ei,onlineUsers:Rn})}):l.type==="welcome"?e.jsx("div",{style:{width:"100%",height:"100%"},children:e.jsx(ld,{isMobile:Q,onOpenMenu:()=>_e(!0),onOpenRightMenu:()=>Ye(!0),updateAvailable:us,isDownloading:en,downloadProgress:tn,updateStatusText:on,onStartUpdate:ml,onSwitchToFriends:()=>{de("friends","friends"),Q&&_e(!1)},onSwitchToAI:()=>{Ns("ai")},onSwitchToCinema:()=>{To(!0),Q&&_e(!1)}})}):Hi==="kanban"?e.jsxs("div",{style:{width:"100%",height:"100%",overflow:"hidden"},children:[e.jsx("div",{style:F.chatHeader,children:e.jsxs("h2",{children:["# ",Vo," (Pano)"]})}),e.jsx(o.Suspense,{fallback:e.jsx(et,{size:"medium",text:"Pano y√É¬ºkleniyor..."}),children:e.jsx(yd,{roomSlug:l.id,apiBaseUrl:A,fetchWithAuth:k})})]}):l.type==="voice"&&j?e.jsxs("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",backgroundColor:"#2f3136"},children:[e.jsxs("div",{style:{...F.chatHeader,justifyContent:"space-between"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[Q&&e.jsx("button",{onClick:()=>de("welcome","welcome"),style:{...F.mobileMenuButton},children:"√¢‚Ä†¬ê"}),e.jsxs("h2",{style:{margin:0,fontSize:"1.2em"},children:["√∞≈∏‚Äù≈† ",E]})]}),e.jsx("button",{onClick:()=>{q(),de("welcome","welcome")},style:{background:"#ed4245",color:"white",border:"none",borderRadius:"8px",padding:"8px 16px",cursor:"pointer",fontWeight:"bold"},children:"Ba√Ñ≈∏lant√Ñ¬±y√Ñ¬± Kes"})]}),e.jsx(la,{roomName:E,onClose:()=>{q(),de("welcome","welcome")},isMinimized:!1,onToggleMinimize:()=>{},getRealUserAvatar:Xe,allUsers:re,currentUserProfile:mt})]}):e.jsxs("div",{style:{...F.chatArea,position:"relative",paddingTop:Pr,boxSizing:"border-box"},onDrop:il,onDragOver:t=>{t.preventDefault(),vr(!0)},onDragEnter:t=>{t.preventDefault(),vr(!0)},onDragLeave:t=>{t.preventDefault(),t.target===t.currentTarget&&vr(!1)},children:[e.jsxs("div",{style:{...F.chatHeader,justifyContent:"space-between"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",overflow:"hidden",gap:"8px"},children:[Q&&!jo&&e.jsx("button",{onClick:()=>_e(!0),style:{...F.mobileMenuButton,fontSize:"1.3em"},"aria-label":"Men√É¬ºy√É¬º A√É¬ß",children:"√¢Àú¬∞"}),Q&&(l.type==="dm"||l.type==="room")&&e.jsx("button",{onClick:()=>{de("welcome","welcome"),_e(!1),Ye(!1)},style:{...F.mobileMenuButton,fontSize:"1.2em"},"aria-label":"Geri",children:"√¢‚Ä†¬ê"}),e.jsx("h2",{style:{display:"flex",alignItems:"center",gap:"10px",margin:0,fontSize:Q?"1em":"1.1em",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:l.type==="dm"?`@ ${String(l.targetUser||"DM")}`:`# ${String(Vo)}`}),e.jsx("div",{style:qe?F.connectionPillOnline:F.connectionPillOffline,children:qe?"Ba√Ñ≈∏l√Ñ¬±":"Kopuk"})]}),e.jsxs("div",{style:{display:"flex",gap:Q?"5px":"10px",alignItems:"center",flexWrap:Q?"nowrap":"wrap",position:"relative"},children:[e.jsxs("form",{onSubmit:cl,style:F.searchForm,children:[e.jsx("input",{type:"text",placeholder:"Ara...",value:rr,onChange:t=>nr(t.target.value),style:F.searchInput,ref:Us}),e.jsx(jl,{style:F.searchIcon})]}),!Q&&zs.length>0&&e.jsxs("span",{style:F.typingIndicator,children:[zs.join(", ")," yaz√Ñ¬±yor..."]}),e.jsx("button",{onClick:()=>Cs(!jn),style:{...F.iconButton,color:jn?"#5865f2":"#b9bbbe",position:"relative"},title:"Bildirimler",children:e.jsx(Ys,{})}),jn&&e.jsx("div",{style:{position:"absolute",top:"54px",right:"20px",zIndex:1e3},children:e.jsx(o.Suspense,{fallback:e.jsx(et,{size:"small",text:""}),children:e.jsx(Pu,{currentUser:I,onClose:()=>Cs(!1),fetchWithAuth:k,apiBaseUrl:A})})}),e.jsxs("div",{className:"toolbar-menu-container",style:{position:"relative"},children:[e.jsx("button",{onClick:()=>Fe(!Mo),style:{...F.iconButton,color:Mo?"#5865f2":"#b9bbbe",fontSize:"1.2em",fontWeight:"bold"},title:"Daha Fazla",children:"√¢‚Äπ¬Æ"}),Mo&&e.jsxs("div",{style:{position:"absolute",top:"50px",right:"0",backgroundColor:"#2f3136",borderRadius:"8px",boxShadow:"0 8px 16px rgba(0,0,0,0.4)",minWidth:"220px",zIndex:1e3,overflow:"hidden",border:"1px solid #202225"},children:[l.type==="dm"&&e.jsxs("button",{onClick:()=>{er(!0),Fe(!1)},style:{...F.menuItem,color:Ir?"#43b581":"#dcddde"},onMouseEnter:t=>{t.currentTarget.style.backgroundColor="#5865f2",t.currentTarget.style.color="#ffffff"},onMouseLeave:t=>{t.currentTarget.style.backgroundColor="transparent",t.currentTarget.style.color=Ir?"#43b581":"#dcddde"},children:[Ir?e.jsx(Js,{}):e.jsx(Js,{style:{opacity:.5}}),e.jsx("span",{children:Ir?"√Ö≈æifreli":"√Ö≈æifrele"})]}),e.jsxs("button",{onClick:()=>{lr(!oo),Fe(!1)},style:{...F.menuItem,color:oo?"#f5a524":"#dcddde"},onMouseEnter:t=>{t.currentTarget.style.backgroundColor="#5865f2",t.currentTarget.style.color="#ffffff"},onMouseLeave:t=>{t.currentTarget.style.backgroundColor="transparent",t.currentTarget.style.color=oo?"#f5a524":"#dcddde"},children:[e.jsx(El,{}),e.jsx("span",{children:"Sabitli Mesajlar"})]}),e.jsxs("button",{onClick:()=>{nl(),Fe(!1)},style:F.menuItem,onMouseEnter:t=>{t.currentTarget.style.backgroundColor="#5865f2",t.currentTarget.style.color="#ffffff"},onMouseLeave:t=>{t.currentTarget.style.backgroundColor="transparent",t.currentTarget.style.color="#dcddde"},children:[e.jsx(Tl,{}),e.jsx("span",{children:"Ba√Ñ≈∏lant√Ñ¬±y√Ñ¬± Kopyala"})]}),e.jsxs("button",{onClick:()=>{rl(),Fe(!1)},style:{...F.menuItem,color:$o.notifications?"#43b581":"#f04747"},onMouseEnter:t=>{t.currentTarget.style.backgroundColor="#5865f2",t.currentTarget.style.color="#ffffff"},onMouseLeave:t=>{t.currentTarget.style.backgroundColor="transparent",t.currentTarget.style.color=$o.notifications?"#43b581":"#f04747"},children:[$o.notifications?e.jsx(Ys,{}):e.jsx(Rl,{}),e.jsx("span",{children:$o.notifications?"Sessize Al":"Sesi A√É¬ß"})]}),e.jsx("div",{style:{height:"1px",backgroundColor:"#40444b",margin:"4px 0"}}),e.jsxs("button",{onClick:()=>{To(!0),Fe(!1)},style:F.menuItem,onMouseEnter:t=>{t.currentTarget.style.backgroundColor="#5865f2",t.currentTarget.style.color="#ffffff"},onMouseLeave:t=>{t.currentTarget.style.backgroundColor="transparent",t.currentTarget.style.color="#dcddde"},children:[e.jsx(Al,{}),e.jsx("span",{children:"Sinema Modu"})]}),e.jsxs("button",{onClick:()=>{Ss(!0),Fe(!1)},style:F.menuItem,onMouseEnter:t=>{t.currentTarget.style.backgroundColor="#5865f2",t.currentTarget.style.color="#ffffff"},onMouseLeave:t=>{t.currentTarget.style.backgroundColor="transparent",t.currentTarget.style.color="#dcddde"},children:[e.jsx(Pl,{}),e.jsx("span",{children:"DJ Modu"})]}),e.jsxs("button",{onClick:()=>{Xt(!0),Fe(!1)},style:F.menuItem,onMouseEnter:t=>{t.currentTarget.style.backgroundColor="#5865f2",t.currentTarget.style.color="#ffffff"},onMouseLeave:t=>{t.currentTarget.style.backgroundColor="transparent",t.currentTarget.style.color="#dcddde"},children:[e.jsx(Il,{}),e.jsx("span",{children:"Beyaz Tahta"})]}),j&&e.jsxs("button",{onClick:()=>{bt(!0),Fe(!1)},style:F.menuItem,onMouseEnter:t=>{t.currentTarget.style.backgroundColor="#5865f2",t.currentTarget.style.color="#ffffff"},onMouseLeave:t=>{t.currentTarget.style.backgroundColor="transparent",t.currentTarget.style.color="#dcddde"},children:[e.jsx(Zs,{}),e.jsx("span",{children:"Ses Efektleri"})]}),l.type==="room"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{height:"1px",backgroundColor:"#40444b",margin:"4px 0"}}),e.jsxs("button",{onClick:()=>{Qi(),Fe(!1)},style:F.menuItem,onMouseEnter:t=>{t.currentTarget.style.backgroundColor="#5865f2",t.currentTarget.style.color="#ffffff"},onMouseLeave:t=>{t.currentTarget.style.backgroundColor="transparent",t.currentTarget.style.color="#dcddde"},children:[e.jsx(Zs,{}),e.jsx("span",{children:"Sohbeti √É‚Äìzetle"})]}),e.jsxs("button",{onClick:()=>{Xi(),Fe(!1)},style:{...F.menuItem,color:"#f04747"},onMouseEnter:t=>{t.currentTarget.style.backgroundColor="#f04747",t.currentTarget.style.color="#ffffff"},onMouseLeave:t=>{t.currentTarget.style.backgroundColor="transparent",t.currentTarget.style.color="#f04747"},children:[e.jsx(Ll,{}),e.jsx("span",{children:"Sohbeti Temizle"})]}),I==="admin"&&l.type==="dm"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{height:"1px",backgroundColor:"#40444b",margin:"4px 0"}}),e.jsxs("button",{onClick:()=>{ul(l.id),Fe(!1)},style:{...F.menuItem,color:"#ed4245",fontWeight:"bold"},onMouseEnter:t=>{t.currentTarget.style.backgroundColor="#ed4245",t.currentTarget.style.color="#ffffff"},onMouseLeave:t=>{t.currentTarget.style.backgroundColor="transparent",t.currentTarget.style.color="#ed4245"},title:"Admin: Konu√Ö≈∏may√Ñ¬± kal√Ñ¬±c√Ñ¬± olarak sil (her iki taraftan)",children:[e.jsx(Ol,{}),e.jsx("span",{children:"√¢≈°¬†√Ø¬∏¬è KALICI S√Ñ¬∞L (ADM√Ñ¬∞N)"})]})]})]})]})]}),Q&&!Eo&&e.jsx("button",{onClick:()=>Ye(!0),style:{...F.mobileMenuButton,fontSize:"1.3em"},"aria-label":"Kullan√Ñ¬±c√Ñ¬±lar√Ñ¬± G√É¬∂ster",children:e.jsx(Bn,{})})]})]}),e.jsx("div",{style:F.messageBox,ref:Tn,onScroll:Ki,children:ki?e.jsx("p",{style:F.systemMessage,children:"Y√É¬ºkleniyor..."}):An.length>50?e.jsx(rd,{messages:An,scrollToBottom:!0,renderMessage:(t,s)=>e.jsx(sa,{msg:t,currentUser:I,absoluteHostUrl:A,isAdmin:Te,onImageClick:_t,fetchWithAuth:k,allUsers:re,getDeterministicAvatar:Ge,onShowChart:Ot,onDelete:Ws,onStartEdit:uo,onSetReply:vs,onToggleReaction:()=>{},onStartForward:_s,isSelectionMode:ks,isSelected:Vt.has(t.id),onToggleSelection:f=>{const S=new Set(Vt);S.has(f)?S.delete(f):S.add(f),Ie(S)},onScrollToMessage:Bs,onViewProfile:f=>st(re.find(S=>S.username===f)),onTogglePin:f=>{}},t.id||t.temp_id||s)}):e.jsxs(e.Fragment,{children:[An.map((t,s)=>{const f=t.id||t.temp_id||s;return e.jsx(sa,{msg:t,currentUser:I,absoluteHostUrl:A,isAdmin:Te,onImageClick:_t,fetchWithAuth:k,allUsers:re,getDeterministicAvatar:Ge,onShowChart:Ot,onDelete:Ws,onStartEdit:uo,onSetReply:vs,onToggleReaction:()=>{},onStartForward:_s,isSelectionMode:ks,isSelected:Vt.has(t.id),onToggleSelection:S=>{const d=new Set(Vt);d.has(S)?d.delete(S):d.add(S),Ie(d)},onScrollToMessage:Bs,onViewProfile:S=>st(re.find(d=>d.username===S)),onTogglePin:S=>{}},f)}),e.jsx("div",{ref:En,style:{float:"left",clear:"both",height:1}})]})}),Li&&e.jsx("button",{type:"button",style:F.scrollToBottomButton,onClick:()=>{At("smooth"),kr(!1)},"aria-label":"En alta in",children:"En alta in"}),e.jsxs("div",{style:{...F.inputContainer,paddingBottom:Lt?`calc(16px + ${sr})`:Q?"25px":"16px"},children:[bs&&e.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(88, 101, 242, 0.2)",border:"2px dashed #5865f2",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",zIndex:1e3},children:e.jsx("div",{style:{color:"#5865f2",fontSize:"1.2em",fontWeight:"bold"},children:"√∞≈∏‚Äú¬Å Dosyay√Ñ¬± buraya b√Ñ¬±rak√Ñ¬±n"})}),ws&&Cn>0&&e.jsx("div",{style:{position:"absolute",top:"-40px",left:"16px",right:"16px",backgroundColor:"#2b2d31",borderRadius:"8px",padding:"8px 12px",boxShadow:"0 2px 10px rgba(0,0,0,0.3)",zIndex:1001},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsxs("span",{style:{color:"#b9bbbe",fontSize:"12px",whiteSpace:"nowrap"},children:["√∞≈∏‚Äú¬§ Y√É¬ºkleniyor: ",Cn,"%"]}),e.jsx("div",{style:{flex:1,height:"6px",backgroundColor:"#40444b",borderRadius:"3px",overflow:"hidden"},children:e.jsx("div",{style:{width:`${Cn}%`,height:"100%",backgroundColor:"#5865f2",borderRadius:"3px",transition:"width 0.3s ease"}})})]})}),e.jsx(nd,{onSendMessage:Ln,onFileUpload:Ar,onShowCodeSnippet:()=>wo(!0),placeholder:Vo?`${l.type==="dm"?Vo:`# ${Vo}`} kanal√Ñ¬±na mesaj g√É¬∂nder`:"Mesaj yaz...",disabled:ws,fetchWithAuth:k,apiBaseUrl:A,activeChat:l})]})]}),(!Q||Eo)&&e.jsxs("div",{style:{...F.chatUserListPanel,...Q?F.mobileRightSidebar:{},paddingTop:Pr},children:[Q&&e.jsxs("div",{style:F.mobileSidebarHeader,children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(Bn,{size:18,color:"#b9bbbe"}),e.jsx("span",{style:{fontSize:"16px",fontWeight:"bold",color:"white"},children:l.type==="room"?"Sunucu √É≈ìyeleri":l.type==="friends"?"√É‚Ä°evrimi√É¬ßi":"Arkada√Ö≈∏lar"})]}),e.jsx("button",{onClick:()=>Ye(!1),style:F.closeSidebarButton,children:e.jsx(Go,{})})]}),e.jsx(o.Suspense,{fallback:e.jsx(et,{size:"small",text:"Kullan√Ñ¬±c√Ñ¬±lar y√É¬ºkleniyor..."}),children:e.jsx(Cu,{chatUsers:[],allUsers:re,onlineUsers:Rn,currentUser:I,getDeterministicAvatar:Ge,onUserClick:t=>{let s=re.find(f=>f.username===t);if(!s&&Kt.length>0){const f=Kt.find(S=>S.username===t);f&&(s={username:f.username,display_name:f.username,avatar:Ge(f.username),role:f.role||"member"})}s&&st(s)},onUserContextMenu:(t,s)=>{if(s===I)return;const f=re.find(S=>S.username===s);f&&js({x:t.clientX,y:t.clientY,user:f,permissions:Ni})},activeChat:l,serverMembers:Kt,friendsList:Ht,onNavigate:ol})})]})]}),j&&e.jsx(sd,{remoteStreams:ie,remoteVolumes:G,mutedUsers:ct}),j&&!ut&&l.type!=="voice"&&e.jsx("button",{onClick:()=>ko(!0),style:{position:"fixed",bottom:"20px",right:"20px",zIndex:9998,background:"#5865f2",color:"white",border:"none",borderRadius:"50%",width:"60px",height:"60px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",fontSize:"24px",boxShadow:"0 4px 12px rgba(0,0,0,0.3)",transition:"all 0.2s"},title:"Ses Panelini A√É¬ß",onMouseEnter:t=>t.currentTarget.style.transform="scale(1.1)",onMouseLeave:t=>t.currentTarget.style.transform="scale(1)",children:"√∞≈∏≈Ω¬§"}),j&&ut&&l.type!=="voice"&&e.jsx(e.Fragment,{children:wt?e.jsx(la,{roomName:E,onClose:()=>{ko(!1)},isMinimized:to,onToggleMinimize:()=>Co(!to),getRealUserAvatar:Xe,allUsers:re,currentUserProfile:mt}):e.jsx(o.Suspense,{fallback:e.jsx(et,{size:"small",text:"Sesli sohbet y√É¬ºkleniyor..."}),children:e.jsx(Eu,{islandState:Ve,onDrag:t=>ar(s=>({...s,x:t.x,y:t.y})),onResize:t=>ar(s=>({...s,width:t.width,height:t.height})),isMobile:Q,headerActions:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",flexWrap:"wrap"},children:[e.jsx("button",{onClick:t=>{t.preventDefault(),t.stopPropagation(),console.log("√∞≈∏≈Ω‚Ä∫√Ø¬∏¬è [VoiceIsland] Hiding panel"),ko(!1)},style:{background:"rgba(255,255,255,0.1)",color:"white",border:"none",borderRadius:"4px",padding:"8px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"16px",transition:"all 0.2s"},title:"Paneli Gizle",children:e.jsx(Go,{})}),e.jsx("div",{style:{width:"1px",height:"20px",background:"rgba(255,255,255,0.1)"}}),e.jsx("button",{onClick:t=>{t.preventDefault(),t.stopPropagation(),console.log("√∞≈∏≈Ω¬§ [VoiceIsland] Mute toggle clicked"),ee()},style:{background:D?"#ed4245":"#23a559",color:"white",border:"none",borderRadius:"4px",padding:"8px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"16px",transition:"all 0.2s"},title:D?"Mikrofonu A√É¬ß":"Mikrofonu Kapat",children:e.jsx(Gn,{style:{opacity:D?.5:1}})}),e.jsx("button",{onClick:t=>{t.preventDefault(),t.stopPropagation(),console.log("√∞≈∏≈Ω¬ß [VoiceIsland] Deafen toggle clicked"),H()},style:{background:z?"#ed4245":"#23a559",color:"white",border:"none",borderRadius:"4px",padding:"8px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"16px",transition:"all 0.2s"},title:z?"Sesi A√É¬ß":"Sesi Kapat",children:e.jsx(Dl,{style:{opacity:z?.5:1}})}),e.jsx("button",{onClick:t=>{t.preventDefault(),t.stopPropagation(),console.log("√∞≈∏‚Äú¬π [VoiceIsland] Video toggle clicked"),B()},style:{background:Y?"#5865f2":"rgba(255,255,255,0.1)",color:"white",border:"none",borderRadius:"4px",padding:"8px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"16px",transition:"all 0.2s"},title:Y?"Kameray√Ñ¬± Kapat":"Kameray√Ñ¬± A√É¬ß",children:e.jsx($l,{style:{opacity:Y?1:.5}})}),e.jsx("button",{onClick:t=>{t.preventDefault(),t.stopPropagation(),console.log("√∞≈∏‚Äì¬•√Ø¬∏¬è [VoiceIsland] Screen share toggle clicked"),U()},style:{background:ue?"#5865f2":"rgba(255,255,255,0.1)",color:"white",border:"none",borderRadius:"4px",padding:"8px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"16px",transition:"all 0.2s"},title:ue?"Ekran Payla√Ö≈∏√Ñ¬±m√Ñ¬±n√Ñ¬± Durdur":"Ekran√Ñ¬± Payla√Ö≈∏",children:e.jsx(Ml,{style:{opacity:ue?1:.5}})}),e.jsx("div",{style:{width:"1px",height:"20px",background:"rgba(255,255,255,0.1)"}}),e.jsx("button",{onClick:q,style:{background:"#ed4245",color:"white",border:"none",borderRadius:"4px",padding:"8px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"16px"},title:"Odadan Ayr√Ñ¬±l",children:e.jsx(zl,{})}),e.jsx("div",{style:{width:"1px",height:"20px",background:"rgba(255,255,255,0.1)"}}),e.jsx("button",{onClick:()=>St(t=>({...t,isActive:!t.isActive})),style:{background:De.isActive?"#5865f2":"rgba(255,255,255,0.1)",color:"white",border:"none",borderRadius:"4px",padding:"4px 8px",cursor:"pointer",fontSize:"12px",fontWeight:"bold"},children:De.isActive?"√∞≈∏≈Ω¬¨ Kapat":"√∞≈∏¬ç¬ø Sinema"}),e.jsx("div",{style:{width:"1px",height:"20px",background:"rgba(255,255,255,0.1)"}}),e.jsxs("select",{onChange:t=>ye(t.target.value),value:Ue,style:{background:"rgba(0,0,0,0.3)",color:"white",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"4px",padding:"2px 4px",fontSize:"12px",cursor:"pointer",outline:"none"},children:[e.jsx("option",{value:"none",children:"Normal"}),e.jsx("option",{value:"robot",children:"√∞≈∏¬§‚Äì Robot"}),e.jsx("option",{value:"child",children:"√∞≈∏‚Äò¬∂ Bebek"}),e.jsx("option",{value:"monster",children:"√∞≈∏‚Äò¬π Canavar"})]}),e.jsx("div",{style:{width:"1px",height:"20px",background:"rgba(255,255,255,0.1)"}}),e.jsxs("div",{style:{display:"flex",gap:"5px"},children:[e.jsx("button",{onClick:()=>Ee("reset"),title:"Reset Game",style:{background:"transparent",border:"none",cursor:"pointer",fontSize:"16px"},children:"√∞≈∏‚Äù‚Äû"}),["√∞≈∏¬™¬®","√∞≈∏‚Äú‚Äû","√¢≈ì‚Äö√Ø¬∏¬è"].map((t,s)=>{const f=s===0?"rock":s===1?"paper":"scissors";return e.jsx("button",{onClick:()=>Ee("move",f),style:{background:Ke?.moves?.[I]===f?"rgba(88, 101, 242, 0.5)":"transparent",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"50%",cursor:"pointer",fontSize:"16px",width:"28px",height:"28px",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.1s"},title:`Play ${f}`,children:t},t)})]}),e.jsx("div",{style:{width:"1px",height:"20px",background:"rgba(255,255,255,0.1)"}}),e.jsx("div",{style:{display:"flex",gap:"5px"},children:["√¢¬ù¬§√Ø¬∏¬è","√∞≈∏Àú‚Äö","√∞≈∏Àú¬Æ","√∞≈∏‚Äò¬ç","√∞≈∏≈Ω‚Ä∞"].map(t=>e.jsx("button",{onClick:()=>ze(t),style:{background:"transparent",border:"none",cursor:"pointer",fontSize:"16px",padding:"0 4px",transition:"transform 0.1s"},onMouseEnter:s=>s.target.style.transform="scale(1.2)",onMouseLeave:s=>s.target.style.transform="scale(1)",title:`Send ${t}`,children:t},t))})]}),children:De.isActive?e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[e.jsx("div",{style:{flex:1,minHeight:0,position:"relative"},children:e.jsx(o.Suspense,{fallback:e.jsx(et,{size:"large",text:"Cinema Player y√É¬ºkleniyor...",fullscreen:!0}),children:e.jsx(Tu,{})})}),e.jsx("div",{style:{height:"140px",display:"flex",gap:"8px",padding:"10px",overflowX:"auto",background:"rgba(0,0,0,0.5)",flexShrink:0,alignItems:"center"},children:(()=>{const t=[];return t.push({id:"local-cam",user:{username:I,is_talking:Z,is_mic_off:D,is_deafened:z},track:fe?.getVideoTracks()[0]||null,streamType:"camera",isLocal:!0,avatarUrl:Xe(I)}),be&&t.push({id:"local-screen",user:{username:I},track:be.getVideoTracks()[0],streamType:"screen",isLocal:!0,avatarUrl:Xe(I)}),Object.entries(ie||{}).forEach(([s,f])=>{const S=f.getVideoTracks(),d=f.getAudioTracks();S.length>0?S.forEach(_=>t.push({id:`${s}-${_.id}`,user:{username:s},track:_,streamType:"camera",isLocal:!1,avatarUrl:Xe(s)})):d.length>0&&t.push({id:`${s}-audio`,user:{username:s},track:d[0],streamType:"camera",isLocal:!1,avatarUrl:Xe(s)})}),t.map(s=>e.jsx(Mr,{...s,style:{height:"100%",aspectRatio:"16/9",minWidth:"160px"},lastReaction:X,gameMove:Ke?.moves?.[s.user.username]},s.id))})()})]}):e.jsx("div",{style:{...F.videoGrid,flexDirection:We?"column":"row",flexWrap:We?"nowrap":"wrap",overflowY:"auto",height:"100%"},children:(()=>{const t=[];if(t.push({id:"local-cam",user:{username:I,is_talking:Z,is_mic_off:D,is_deafened:z},track:fe?.getVideoTracks()[0]||null,streamType:"camera",isLocal:!0,avatarUrl:Xe(I)}),be?.getVideoTracks()[0]&&t.push({id:"local-screen",user:{username:I,is_talking:!1},track:be.getVideoTracks()[0],streamType:"screen",isLocal:!0,avatarUrl:Xe(I)}),Object.entries(ie||{}).forEach(([f,S])=>{if(f!==I){const d=S.getVideoTracks(),_=S.getAudioTracks();d.length>0?d.forEach(P=>{t.push({id:`${f}-${P.id}`,user:{username:f},track:P,streamType:P.label?.toLowerCase().includes("screen")?"screen":"camera",isLocal:!1,avatarUrl:Xe(f)})}):_.length>0&&t.push({id:`${f}-audio`,user:{username:f},track:_[0],streamType:"camera",isLocal:!1,avatarUrl:Xe(f)})}}),We){const f=t.find(d=>d.id===We);if(!f)return eo(null),s(t);const S=t.filter(d=>d.id!==We);return e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{flex:1,width:"100%",minHeight:"300px",padding:"0",overflow:"hidden",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#000"},children:e.jsx(Mr,{...f,style:{width:"100%",height:"100%",maxWidth:"100%",borderRadius:"0",maxHeight:"100%",margin:"0 auto",aspectRatio:"unset"},onClick:()=>eo(null),lastReaction:X,gameMove:Ke?.moves?.[f.user?.username]})}),e.jsx("div",{style:{height:"120px",display:"flex",gap:"8px",padding:"10px",overflowX:"auto",flexShrink:0,justifyContent:"center"},children:S.map(d=>e.jsx(Mr,{...d,style:{width:"180px",height:"100%",flexShrink:0,aspectRatio:"16/9"},onClick:()=>eo(d.id),lastReaction:X,gameMove:Ke?.moves?.[d.user.username]},d.id))})]})}else return s(t);function s(f){return f.map(S=>e.jsx(Mr,{...S,style:{width:"240px",maxWidth:"100%",flexGrow:1,height:"auto"},onClick:()=>eo(S.id),lastReaction:X,gameMove:Ke?.moves?.[S.user.username]},S.id))}})()})})})}),dn&&e.jsx(o.Suspense,{fallback:e.jsx(et,{size:"medium",text:"Temalar y√É¬ºkleniyor..."}),children:e.jsx(_d,{onClose:()=>Nt(!1),currentTheme:_i,onThemeChange:ls})}),hs&&e.jsx(o.Suspense,{fallback:e.jsx(et,{size:"medium",text:"√É‚Äìzet haz√Ñ¬±rlan√Ñ¬±yor..."}),children:e.jsx(aa,{roomSlug:l.id,onClose:()=>vn(!1),fetchWithAuth:k,apiBaseUrl:A})}),Xn&&e.jsx(o.Suspense,{fallback:e.jsx(et,{size:"small",text:"√Ö≈æablonlar y√É¬ºkleniyor..."}),children:e.jsx(xd,{onClose:()=>dt(!1),onSelect:t=>{Uo.current?.appendText?.(t),dt(!1)},fetchWithAuth:k,apiBaseUrl:A,isAdmin:Te})})]}),Cr&&e.jsx(Iu,{x:Cr.x,y:Cr.y,user:Cr.user,currentUser:I,onClose:()=>js(null),onAction:pl,voiceChannels:M.flatMap(t=>(t.categories||[]).flatMap(s=>(s.rooms||[]).filter(f=>f.is_voice))),isAdmin:Te,isInVoiceRoom:j,friendsList:Ht}),zo&&bl.createPortal(e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.85)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:999999},onClick:()=>jr(null),children:e.jsxs("div",{onClick:t=>t.stopPropagation(),style:{backgroundColor:"#2b2d31",borderRadius:"12px",width:"400px",maxHeight:"80vh",overflow:"hidden",boxShadow:"0 8px 32px rgba(0,0,0,0.5)"},children:[e.jsxs("div",{style:{padding:"20px",borderBottom:"1px solid #3f4147",textAlign:"center"},children:[e.jsx("h2",{style:{color:"#f2f3f5",margin:0,fontSize:"18px"},children:"√∞≈∏≈Ω¬´ Sunucuya Davet Et"}),e.jsxs("p",{style:{color:"#b9bbbe",margin:"8px 0 0",fontSize:"14px"},children:[e.jsx("strong",{children:zo.username})," kullan√Ñ¬±c√Ñ¬±s√Ñ¬±n√Ñ¬± hangi sunucuya davet etmek istiyorsunuz?"]})]}),e.jsx("div",{style:{maxHeight:"300px",overflowY:"auto",padding:"12px"},children:M.map(t=>e.jsxs("div",{onClick:async()=>{try{const s=await k(`${W}/servers/${t.id}/invite/`,{method:"POST",body:JSON.stringify({target_username:zo.username})});if(s.ok)V.success(`√∞≈∏≈Ω¬´ ${zo.username} kullan√Ñ¬±c√Ñ¬±s√Ñ¬±na davetiye g√É¬∂nderildi!`);else{const f=await s.json();f.error&&f.error.includes("zaten")?V.info(`√¢‚Äû¬π√Ø¬∏¬è ${zo.username} zaten bu sunucunun √É¬ºyesi!`):V.error(`√¢¬ù≈í ${f.error||"Davet g√É¬∂nderilemedi"}`)}}catch(s){console.error("√¢¬ù≈í Invite error:",s),V.error("√¢¬ù≈í Ba√Ñ≈∏lant√Ñ¬± hatas√Ñ¬±")}jr(null)},style:{display:"flex",alignItems:"center",gap:"12px",padding:"12px",borderRadius:"8px",cursor:"pointer",transition:"all 0.2s",backgroundColor:"rgba(255,255,255,0.02)",marginBottom:"8px"},onMouseEnter:s=>{s.currentTarget.style.backgroundColor="rgba(88, 101, 242, 0.2)"},onMouseLeave:s=>{s.currentTarget.style.backgroundColor="rgba(255,255,255,0.02)"},children:[t.icon?e.jsx("img",{src:t.icon,alt:t.name,style:{width:40,height:40,borderRadius:"50%",objectFit:"cover"}}):e.jsx("div",{style:{width:40,height:40,borderRadius:"50%",backgroundColor:"#5865f2",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",color:"white",fontSize:"16px"},children:t.name?.substring(0,2).toUpperCase()}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{color:"#f2f3f5",fontWeight:"600"},children:t.name}),e.jsxs("div",{style:{color:"#b9bbbe",fontSize:"12px"},children:[t.member_count||t.categories?.length||0," √É¬ºye"]})]}),e.jsx("div",{style:{color:"#5865f2",fontSize:"20px"},children:"√¢‚Ä†‚Äô"})]},t.id))}),e.jsx("div",{style:{padding:"16px 20px",borderTop:"1px solid #3f4147",textAlign:"center"},children:e.jsx("button",{onClick:()=>jr(null),style:{backgroundColor:"#4f545c",color:"#f2f3f5",border:"none",padding:"10px 24px",borderRadius:"4px",cursor:"pointer",fontWeight:"600"},children:"√Ñ¬∞ptal"})})]})}),document.body)]})},F={mainContainer:{display:"flex",width:"100%",height:"100dvh",backgroundColor:"#1E1F22",backgroundImage:"radial-gradient(circle at 50% 10%, rgba(88, 101, 242, 0.05) 0%, transparent 40%)",color:"white",overflow:"hidden",fontFamily:"'Inter', sans-serif"},chatLayout:{display:"flex",width:"100%",height:"100%",overflow:"hidden"},sidebarWrapper:{width:"312px",backgroundColor:"rgba(30, 31, 34, 0.6)",backdropFilter:"blur(10px)",display:"flex",flexDirection:"row",flexShrink:0,height:"100%",borderRight:"1px solid rgba(255,255,255,0.05)"},mainContent:{flex:1,display:"flex",minWidth:0,position:"relative",height:"100%",overflow:"hidden"},chatArea:{flex:1,display:"flex",flexDirection:"column",backgroundColor:"transparent",minWidth:0,height:"100%",overflow:"hidden",position:"relative"},chatHeader:{height:"54px",minHeight:"54px",borderBottom:"1px solid rgba(255,255,255,0.08)",display:"flex",alignItems:"center",padding:"0 20px",flexShrink:0,backgroundColor:"rgba(20, 21, 24, 0.7)",backdropFilter:"blur(15px)",boxShadow:"0 1px 3px rgba(0,0,0,0.2)",zIndex:10},messageBox:{flex:1,overflowY:"auto",padding:"20px 0",display:"flex",flexDirection:"column",gap:"4px",scrollBehavior:"smooth",minHeight:0},inputContainer:{padding:"0 20px 24px 20px",backgroundColor:"transparent",position:"relative",flexShrink:0,minHeight:"auto",zIndex:20},chatUserListPanel:{width:"240px",backgroundColor:"rgba(30, 31, 34, 0.6)",borderLeft:"1px solid rgba(255,255,255,0.08)",flexShrink:0,height:"100%",backdropFilter:"blur(10px)"},mobileSidebar:{position:"fixed",zIndex:100,top:0,bottom:0,left:0,width:"85vw",maxWidth:"350px",boxShadow:"5px 0 15px rgba(0,0,0,0.5)",display:"flex",flexDirection:"column"},mobileRightSidebar:{position:"fixed",zIndex:100,top:0,bottom:0,right:0,width:"85vw",maxWidth:"300px",boxShadow:"-5px 0 15px rgba(0,0,0,0.5)",display:"flex",flexDirection:"column"},mobileOverlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.6)",zIndex:99,backdropFilter:"blur(3px)"},mobileMenuButton:{background:"none",border:"none",color:"white",fontSize:"1.5em",marginRight:"10px",cursor:"pointer",padding:"6px",display:"flex",alignItems:"center",transition:"all 0.2s"},iconButton:{background:"none",border:"none",color:"#b9bbbe",fontSize:"1.3em",cursor:"pointer",padding:"6px",display:"flex",alignItems:"center",borderRadius:"50%",transition:"all 0.2s",":hover":{backgroundColor:"rgba(255,255,255,0.1)",color:"#fff"}},videoGrid:{display:"flex",flexWrap:"wrap",gap:"5px",padding:"5px",alignContent:"center",justifyContent:"center",alignItems:"center"},systemMessage:{color:"#949ba4",textAlign:"center",fontSize:"0.85em",margin:"10px 0",fontStyle:"italic"},searchForm:{position:"relative",display:"flex",alignItems:"center",backgroundColor:"rgba(0,0,0,0.2)",borderRadius:"4px",padding:"0 8px",height:"32px",marginRight:"8px",border:"1px solid rgba(255,255,255,0.05)"},searchInput:{backgroundColor:"transparent",border:"none",color:"#dcddde",fontSize:"0.9em",width:"140px",outline:"none"},searchIcon:{color:"#949ba4",fontSize:"0.8em",cursor:"pointer"},typingIndicator:{color:"#dbdee1",fontSize:"0.85em",maxWidth:"180px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",fontWeight:"bold"},connectionPillOnline:{marginLeft:"10px",padding:"4px 8px",borderRadius:"999px",backgroundColor:"rgba(59, 165, 93, 0.2)",border:"1px solid #3ba55d",color:"#3ba55d",fontSize:"0.75em",fontWeight:700},connectionPillOffline:{marginLeft:"10px",padding:"4px 8px",borderRadius:"999px",backgroundColor:"rgba(218, 55, 60, 0.2)",border:"1px solid #da373c",color:"#da373c",fontSize:"0.75em",fontWeight:700},scrollToBottomButton:{position:"absolute",right:"16px",bottom:"110px",backgroundColor:"#5865f2",color:"#fff",border:"none",borderRadius:"50%",width:"40px",height:"40px",display:"flex",justifyContent:"center",alignItems:"center",boxShadow:"0 4px 12px rgba(0,0,0,0.35)",cursor:"pointer",fontWeight:600},mobileSidebarHeader:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"10px 15px",backgroundColor:"#202225",borderBottom:"1px solid #111214",minHeight:"54px",flexShrink:0},closeSidebarButton:{background:"none",border:"none",color:"#b9bbbe",fontSize:"22px",cursor:"pointer",padding:"8px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",transition:"background 0.2s, color 0.2s"},menuItem:{width:"100%",padding:"10px 16px",background:"transparent",border:"none",color:"#dcddde",textAlign:"left",cursor:"pointer",display:"flex",alignItems:"center",gap:"12px",fontSize:"14px",fontWeight:"500",transition:"all 0.15s ease",borderRadius:"0"}};function Gu(){return e.jsx(sc,{fallbackMessage:"Pawscord encountered an error. Please try refreshing the page.",children:e.jsx(Wc,{children:e.jsx(Wu,{})})})}const Hu=`${Vc}/auth/verify-email/`,Ku=()=>{const{token:i}=ma(),r=Gr(),[n,m]=o.useState("loading"),[c,b]=o.useState("Hesabƒ±nƒ±z doƒürulanƒ±yor, l√ºtfen bekleyin...");return o.useEffect(()=>{if(!i){m("error"),b("Ge√ßersiz veya eksik doƒürulama kodu.");return}const j=async()=>{try{const R=await fetch(`${Hu}${i}/`),E=await R.json();R.ok?(m("success"),b("√úyeliƒüiniz ba≈üarƒ±yla aktif edildi!")):(m("error"),b(E.message||"Doƒürulama ba≈üarƒ±sƒ±z oldu."))}catch{m("error"),b("Sunucuya baƒülanƒ±lamadƒ±. L√ºtfen internet baƒülantƒ±nƒ±zƒ± kontrol edin.")}};setTimeout(()=>{j()},1e3)},[i]),e.jsx("div",{style:Me.container,children:e.jsxs("div",{style:Me.card,children:[n==="loading"&&e.jsxs("div",{style:Me.content,children:[e.jsx(ha,{className:"spin-animation",size:50,color:"#5865f2",style:{marginBottom:20}}),e.jsx("h2",{style:Me.title,children:"Doƒürulanƒ±yor..."}),e.jsx("p",{style:Me.text,children:c})]}),n==="success"&&e.jsxs("div",{style:Me.content,children:[e.jsx(Hn,{size:60,color:"#43b581",style:{marginBottom:20}}),e.jsx("h2",{style:{...Me.title,color:"#43b581"},children:"Tebrikler! üéâ"}),e.jsx("p",{style:Me.text,children:c}),e.jsx("p",{style:Me.subText,children:"Artƒ±k Pawscord'a tam eri≈üim saƒülayabilirsin."}),e.jsx("button",{onClick:()=>r("/"),style:Me.primaryButton,children:"Gƒ∞Rƒ∞≈û YAP"})]}),n==="error"&&e.jsxs("div",{style:Me.content,children:[e.jsx(Kn,{size:60,color:"#f04747",style:{marginBottom:20}}),e.jsx("h2",{style:{...Me.title,color:"#f04747"},children:"Hata Olu≈ütu"}),e.jsx("p",{style:Me.text,children:c}),e.jsx("button",{onClick:()=>r("/"),style:Me.secondaryButton,children:"Ana Sayfaya D√∂n"})]})]})})},Me={container:{display:"flex",justifyContent:"center",alignItems:"center",height:"100dvh",backgroundColor:"#1e1f22",fontFamily:"'Poppins', sans-serif",padding:"20px"},card:{backgroundColor:"#2b2d31",padding:"40px",borderRadius:"12px",boxShadow:"0 8px 24px rgba(0,0,0,0.5)",maxWidth:"400px",width:"100%",textAlign:"center",border:"1px solid #1f2023"},content:{display:"flex",flexDirection:"column",alignItems:"center"},title:{margin:"0 0 10px 0",color:"#fff",fontSize:"1.8em"},text:{color:"#dbdee1",fontSize:"1.1em",margin:"0 0 20px 0",lineHeight:"1.5"},subText:{color:"#949ba4",fontSize:"0.9em",marginBottom:"30px"},primaryButton:{backgroundColor:"#5865f2",color:"white",border:"none",padding:"12px 30px",borderRadius:"5px",fontSize:"1em",fontWeight:"bold",cursor:"pointer",transition:"background-color 0.2s",width:"100%"},secondaryButton:{backgroundColor:"#4f545c",color:"white",border:"none",padding:"12px 30px",borderRadius:"5px",fontSize:"1em",fontWeight:"bold",cursor:"pointer",width:"100%"}},Ca=document.createElement("style");Ca.innerText=`
  .spin-animation { animation: spin 1s linear infinite; }
  @keyframes spin { 100% { transform: rotate(360deg); } }
`;document.head.appendChild(Ca);const qu=y.memo(Ku),Yu=()=>{const{code:i}=ma(),r=Gr(),{isAuthenticated:n,token:m}=Ho(),[c,b]=o.useState(null),[j,R]=o.useState(!0),[E,L]=o.useState(""),[q,D]=o.useState(!1),[z,ee]=o.useState(!1),H="8888",B=window.Capacitor&&window.Capacitor.isNativePlatform(),U=typeof window<"u"&&typeof window.require=="function",J=`${(()=>{if(B)return"https://pawscord.com";if(U)return`http://127.0.0.1:${H}`;const Z=window.location.protocol,ne=window.location.hostname;return ne.includes("pawscord.com")?"https://pawscord.com":`${Z}//${ne}:${H}`})()}/api`;o.useEffect(()=>{console.log("üé´ [Invite Page] Loaded with code:",i),fe()},[i]);const fe=async()=>{console.log("üîç [Invite Page] Fetching invite info..."),R(!0),L("");try{const Z=await fetch(`${J}/invites/${i}/`),ne=await Z.json();console.log("üì¶ [Invite Page] Response:",{status:Z.status,data:ne}),Z.ok?(b(ne),console.log("‚úÖ [Invite Page] Invite info loaded")):(L(ne.error||"Davet bulunamadƒ±"),console.error("‚ùå [Invite Page] Error:",ne.error))}catch(Z){console.error("‚ùå [Invite Page] Network error:",Z),L("Baƒülantƒ± hatasƒ±. L√ºtfen tekrar deneyin.")}R(!1)},ie=async()=>{if(!n){console.log("‚ö†Ô∏è [Invite Page] User not authenticated, redirecting to login"),V.error("‚ùå L√ºtfen √∂nce giri≈ü yapƒ±n!"),sessionStorage.setItem("pending_invite",i),r("/");return}if(!m){console.error("‚ùå [Invite Page] No token found!"),V.error("‚ùå Giri≈ü token'ƒ± bulunamadƒ±. L√ºtfen tekrar giri≈ü yapƒ±n."),r("/");return}console.log("üé´ [Invite Page] Accepting invite...",{code:i,apiUrl:`${J}/invites/${i}/accept/`,hasToken:!!m}),D(!0),L("");try{const Z=`${J}/invites/${i}/accept/`;console.log("üì° [Invite Page] POST to:",Z);const ne=await fetch(Z,{method:"POST",headers:{Authorization:`Bearer ${m}`,"Content-Type":"application/json"}});console.log("üì¶ [Invite Page] Response status:",ne.status);const ue=await ne.json();if(console.log("üì¶ [Invite Page] Response data:",ue),ne.ok){console.log("‚úÖ [Invite Page] Successfully joined server!"),V.success(`‚úÖ Ba≈üarƒ±lƒ±! ${ue.server_name||"Sunucu"}ya katƒ±ldƒ±nƒ±z!`),ee(!0);const Y=ue.redirect||"/";console.log("üîó [Invite Page] Redirecting to:",Y),setTimeout(()=>{Y.startsWith("http")?window.location.href=Y:(r(Y),window.location.reload())},2e3)}else{const Y=ue.error||ue.message||"Sunucuya katƒ±lma hatasƒ±";console.error("‚ùå [Invite Page] Join failed:",Y,ue),L(Y),V.error(`‚ùå Hata: ${Y}`)}}catch(Z){console.error("‚ùå [Invite Page] Exception:",Z);const ne=Z.message||"Baƒülantƒ± hatasƒ±";L(ne),V.error(`‚ùå Hata: ${ne}`)}D(!1)};return j?e.jsxs("div",{style:oe.container,children:[e.jsx("div",{style:oe.backgroundGradient}),e.jsxs("div",{style:oe.card,children:[e.jsx("div",{style:oe.spinner}),e.jsx("p",{style:oe.loadingText,children:"Davet y√ºkleniyor..."})]})]}):E?e.jsxs("div",{style:oe.container,children:[e.jsx("div",{style:oe.backgroundGradient}),e.jsxs("div",{style:oe.card,children:[e.jsx(Kn,{size:64,color:"var(--error)"}),e.jsx("h2",{style:oe.errorTitle,children:"Hata"}),e.jsx("p",{style:oe.errorText,children:E}),e.jsx("button",{onClick:()=>r("/"),style:oe.homeButton,children:"Ana Sayfaya D√∂n"})]})]}):z?e.jsxs("div",{style:oe.container,children:[e.jsx("div",{style:oe.backgroundGradient}),e.jsxs("div",{style:oe.card,children:[e.jsx(Hn,{size:64,color:"var(--success)"}),e.jsx("h2",{style:oe.successTitle,children:"Ba≈üarƒ±lƒ±!"}),e.jsxs("p",{style:oe.successText,children:[e.jsx("strong",{children:c.server.name})," sunucusuna katƒ±ldƒ±nƒ±z!"]}),e.jsx("p",{style:oe.redirectText,children:"Ana sayfaya y√∂nlendiriliyorsunuz..."})]})]}):e.jsxs("div",{style:oe.container,children:[e.jsx("div",{style:oe.backgroundGradient}),e.jsxs("div",{style:oe.card,children:[c.server.icon&&e.jsx("img",{src:c.server.icon,alt:c.server.name,style:oe.serverIcon}),e.jsxs("h1",{style:oe.serverName,children:[e.jsx(Ul,{style:oe.icon}),c.server.name]}),e.jsxs("div",{style:oe.infoRow,children:[e.jsx(Bn,{style:oe.infoIcon}),e.jsxs("span",{children:[c.server.member_count," √úye"]})]}),c.expires_at&&e.jsxs("div",{style:oe.infoRow,children:[e.jsx(Vl,{style:oe.infoIcon}),e.jsxs("span",{children:["S√ºre: ",new Date(c.expires_at).toLocaleString("tr-TR")]})]}),c.max_uses>0&&e.jsx("div",{style:oe.infoRow,children:e.jsxs("span",{children:["Kullanƒ±m: ",c.uses," / ",c.max_uses]})}),e.jsxs("div",{style:oe.inviterInfo,children:["Davet Eden: ",e.jsx("strong",{children:c.inviter.username})]}),e.jsx("button",{onClick:ie,disabled:q,style:{...oe.joinButton,...q?oe.joinButtonDisabled:{}},children:q?"Katƒ±lƒ±nƒ±yor...":n?"Sunucuya Katƒ±l":"Giri≈ü Yap ve Katƒ±l"}),!n&&e.jsx("p",{style:oe.loginHint,children:"* Sunucuya katƒ±lmak i√ßin giri≈ü yapmanƒ±z gerekiyor"})]})]})},oe={container:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",background:"var(--bg-app)",padding:"20px",position:"relative",overflow:"hidden"},backgroundGradient:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"radial-gradient(ellipse at top, rgba(139, 92, 246, 0.15), transparent 50%), radial-gradient(ellipse at bottom, rgba(118, 75, 162, 0.15), transparent 50%)",pointerEvents:"none",zIndex:0},card:{background:"var(--glass-bg)",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)",padding:"48px",borderRadius:"var(--radius-2xl)",textAlign:"center",color:"var(--text-primary)",maxWidth:"560px",width:"100%",boxShadow:"var(--shadow-2xl)",border:"1px solid var(--glass-border)",position:"relative",zIndex:1,animation:"scaleIn 0.4s ease-out"},spinner:{width:"50px",height:"50px",border:"3px solid var(--glass-border)",borderTop:"3px solid var(--brand-primary)",borderRadius:"50%",animation:"spin 0.8s linear infinite",margin:"0 auto"},loadingText:{marginTop:"24px",color:"var(--text-tertiary)",fontSize:"15px",fontWeight:500},serverIcon:{width:"120px",height:"120px",borderRadius:"50%",marginBottom:"24px",objectFit:"cover",border:"4px solid var(--glass-border)",boxShadow:"0 8px 24px rgba(0, 0, 0, 0.2)",transition:"var(--transition-normal)"},serverName:{fontSize:"32px",fontWeight:800,marginBottom:"24px",display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",background:"var(--gradient-primary)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},icon:{fontSize:"28px",color:"var(--brand-primary)"},infoRow:{display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",margin:"16px 0",color:"var(--text-secondary)",fontSize:"16px",fontWeight:500,padding:"12px 20px",background:"var(--bg-elevated)",borderRadius:"var(--radius-md)",border:"1px solid var(--glass-border)"},infoIcon:{fontSize:"20px",color:"var(--brand-primary)"},inviterInfo:{marginTop:"24px",marginBottom:"32px",color:"var(--text-tertiary)",fontSize:"14px",padding:"16px",background:"var(--bg-elevated)",borderRadius:"var(--radius-md)",border:"1px solid var(--glass-border)"},joinButton:{background:"var(--gradient-primary)",color:"white",border:"none",padding:"16px 32px",borderRadius:"var(--radius-md)",cursor:"pointer",fontSize:"16px",fontWeight:700,marginTop:"16px",width:"100%",transition:"var(--transition-normal)",boxShadow:"0 4px 20px rgba(139, 92, 246, 0.4)",position:"relative",overflow:"hidden"},joinButtonDisabled:{background:"var(--bg-tertiary)",cursor:"not-allowed",opacity:.6,boxShadow:"none"},loginHint:{marginTop:"20px",fontSize:"13px",color:"var(--warning)",fontStyle:"italic",fontWeight:500},errorTitle:{color:"var(--error)",marginTop:"24px",fontSize:"28px",fontWeight:700},errorText:{color:"var(--text-tertiary)",margin:"24px 0",fontSize:"15px",lineHeight:1.6},successTitle:{color:"var(--success)",marginTop:"24px",fontSize:"28px",fontWeight:700},successText:{color:"var(--text-primary)",margin:"24px 0",fontSize:"18px",fontWeight:600},redirectText:{color:"var(--text-tertiary)",fontSize:"14px",marginTop:"12px",fontStyle:"italic"},homeButton:{background:"var(--bg-elevated)",color:"var(--text-primary)",border:"1px solid var(--glass-border)",padding:"14px 28px",borderRadius:"var(--radius-md)",cursor:"pointer",fontSize:"15px",fontWeight:600,marginTop:"24px",transition:"var(--transition-normal)"}},ja=document.createElement("style");ja.textContent=`
    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
`;document.head.appendChild(ja);const Ju=({apiBaseUrl:i})=>{const[r,n]=o.useState(!1),[m,c]=o.useState([]),[b,j]=o.useState(!1),R=o.useRef(null),E=o.useRef([]),L=o.useRef(null),{token:q}=Ho(),D=()=>{L.current?.scrollIntoView({behavior:"smooth"})};o.useEffect(()=>{D()},[m,b]);const z=async()=>{try{const B=await navigator.mediaDevices.getUserMedia({audio:!0});R.current=new MediaRecorder(B),E.current=[],R.current.ondataavailable=U=>{U.data.size>0&&E.current.push(U.data)},R.current.onstop=H,R.current.start(),n(!0)}catch{V.error("‚ùå Mikrofon izni gerekli!")}},ee=()=>{R.current&&r&&(R.current.stop(),n(!1))},H=async()=>{j(!0);const B=new Blob(E.current,{type:"audio/webm"}),U=new FormData;U.append("audio",B,"voice.webm");try{const G=await fetch(`${i}/eng-learn/voice-chat/`,{method:"POST",headers:{Authorization:`Bearer ${q}`},body:U});if(G.ok){const J=await G.json();c(ie=>[...ie,{sender:"user",text:J.user_text},{sender:"ai",text:J.ai_text}]),new Audio(`data:audio/mp3;base64,${J.audio_base64}`).play()}else console.error("Sunucu hatasƒ±:",G.status),V.error("‚ùå Anla≈üƒ±lamadƒ± veya hata olu≈ütu.")}catch(G){console.error(G),V.error("‚ùå Baƒülantƒ± hatasƒ±.")}finally{j(!1)}};return e.jsxs("div",{style:ht.container,children:[e.jsxs("div",{style:ht.header,children:[e.jsxs(ga,{to:"/eng-learn",style:ht.backBtn,children:[e.jsx(ya,{})," Geri"]}),e.jsx("h2",{children:"AI ile Konu≈ü (Speaking)"})]}),e.jsxs("div",{style:ht.chatArea,children:[m.length===0&&e.jsxs("div",{style:ht.emptyState,children:[e.jsx(Xs,{size:60,color:"#5865f2",style:{marginBottom:20}}),e.jsx("h3",{children:"ƒ∞ngilizce Pratik Yap"}),e.jsx("p",{children:"Mikrofona basƒ±lƒ± tut ve konu≈ümaya ba≈üla."}),e.jsx("small",{style:{color:"#72767d"},children:'"Hello, how are you?" diyebilirsin.'})]}),m.map((B,U)=>e.jsxs("div",{style:{...ht.messageBubble,alignSelf:B.sender==="user"?"flex-end":"flex-start",backgroundColor:B.sender==="user"?"#5865f2":"#2b2d31",color:"white",borderBottomRightRadius:B.sender==="user"?"0":"12px",borderBottomLeftRadius:B.sender==="ai"?"0":"12px"},children:[e.jsxs("div",{style:ht.msgHeader,children:[B.sender==="user"?e.jsx(Bl,{size:12}):e.jsx(Xs,{size:12}),e.jsx("span",{style:{marginLeft:5,fontSize:"0.8em",fontWeight:"bold"},children:B.sender==="user"?"Sen":"AI √ñƒüretmen"})]}),B.text]},U)),b&&e.jsx("div",{style:{alignSelf:"flex-start",color:"#949ba4",marginLeft:10,fontStyle:"italic"},children:"Yazƒ±yor ve seslendiriyor..."}),e.jsx("div",{ref:L})]}),e.jsxs("div",{style:ht.controls,children:[e.jsx("button",{onMouseDown:z,onMouseUp:ee,onTouchStart:z,onTouchEnd:ee,style:{...ht.micButton,backgroundColor:r?"#f04747":"#5865f2",transform:r?"scale(1.1)":"scale(1)"},children:r?e.jsx(Nl,{size:24}):e.jsx(Gn,{size:30})}),e.jsx("p",{style:{marginTop:15,color:"#949ba4",fontSize:"0.9em"},children:r?"Dinliyor... (Bƒ±rakƒ±nca G√∂nderir)":"Basƒ±lƒ± Tut ve Konu≈ü"})]})]})},ht={container:{display:"flex",flexDirection:"column",height:"100%",backgroundColor:"#313338",color:"white",padding:"20px",boxSizing:"border-box",fontFamily:"Poppins, sans-serif"},header:{display:"flex",alignItems:"center",gap:"15px",marginBottom:"20px",borderBottom:"1px solid #1f2023",paddingBottom:"15px"},backBtn:{color:"#b9bbbe",fontSize:"1em",textDecoration:"none",display:"flex",alignItems:"center",gap:"5px",fontWeight:"600"},chatArea:{flex:1,overflowY:"auto",display:"flex",flexDirection:"column",gap:"15px",paddingBottom:"20px",paddingRight:"5px"},emptyState:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",color:"#949ba4",opacity:.8,textAlign:"center"},messageBubble:{maxWidth:"85%",padding:"15px",borderRadius:"12px",fontSize:"1em",lineHeight:"1.5",boxShadow:"0 2px 5px rgba(0,0,0,0.1)",position:"relative"},msgHeader:{display:"flex",alignItems:"center",marginBottom:"5px",opacity:.8},controls:{display:"flex",flexDirection:"column",alignItems:"center",paddingTop:"20px",borderTop:"1px solid #1f2023"},micButton:{width:"80px",height:"80px",borderRadius:"50%",border:"none",color:"white",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.1s ease",boxShadow:"0 5px 20px rgba(0,0,0,0.4)"}},fa=[{text:"Hello",difficulty:"Kolay"},{text:"Water",difficulty:"Kolay"},{text:"Friend",difficulty:"Kolay"},{text:"Family",difficulty:"Kolay"},{text:"Music",difficulty:"Kolay"},{text:"School",difficulty:"Kolay"},{text:"Computer",difficulty:"Kolay"},{text:"Beautiful",difficulty:"Kolay"},{text:"Together",difficulty:"Kolay"},{text:"Morning",difficulty:"Kolay"},{text:"Happy",difficulty:"Kolay"},{text:"Garden",difficulty:"Kolay"},{text:"People",difficulty:"Kolay"},{text:"Coffee",difficulty:"Kolay"},{text:"Purple",difficulty:"Kolay"},{text:"Technology",difficulty:"Orta"},{text:"Development",difficulty:"Orta"},{text:"Environment",difficulty:"Orta"},{text:"Successfully",difficulty:"Orta"},{text:"Opportunity",difficulty:"Orta"},{text:"Government",difficulty:"Orta"},{text:"Communication",difficulty:"Orta"},{text:"Experience",difficulty:"Orta"},{text:"Available",difficulty:"Orta"},{text:"Management",difficulty:"Orta"},{text:"International",difficulty:"Orta"},{text:"Recommendation",difficulty:"Orta"},{text:"Responsibility",difficulty:"Orta"},{text:"Understand",difficulty:"Orta"},{text:"Literature",difficulty:"Orta"},{text:"Necessary",difficulty:"Orta"},{text:"Vocabulary",difficulty:"Orta"},{text:"Interesting",difficulty:"Orta"},{text:"Comfortable",difficulty:"Orta"},{text:"Vegetable",difficulty:"Orta"},{text:"Squirrel",difficulty:"Zor"},{text:"Schedule",difficulty:"Zor"},{text:"Queue",difficulty:"Zor"},{text:"Rural",difficulty:"Zor"},{text:"Brewery",difficulty:"Zor"},{text:"Phenomenon",difficulty:"Zor"},{text:"February",difficulty:"Zor"},{text:"Library",difficulty:"Zor"},{text:"Specific",difficulty:"Zor"},{text:"Regularly",difficulty:"Zor"},{text:"Probably",difficulty:"Zor"},{text:"Algorithm",difficulty:"Zor"},{text:"Hierarchical",difficulty:"Zor"},{text:"Maintenance",difficulty:"Zor"},{text:"Pronunciation",difficulty:"Zor"},{text:"Throughout",difficulty:"Zor"},{text:"Entrepreneur",difficulty:"Zor"},{text:"Simultaneously",difficulty:"Zor"},{text:"Mischievous",difficulty:"Zor"},{text:"Chaos",difficulty:"Zor"},{text:"Recipe",difficulty:"Zor"},{text:"Worcestershire",difficulty:"Efsane"},{text:"Colonel",difficulty:"Efsane"},{text:"Miscellaneous",difficulty:"Efsane"},{text:"Anesthetist",difficulty:"Efsane"},{text:"Otorhinolaryngologist",difficulty:"Efsane"},{text:"Isthmus",difficulty:"Efsane"},{text:"Anemone",difficulty:"Efsane"},{text:"Synecdoche",difficulty:"Efsane"},{text:"Onomatopoeia",difficulty:"Efsane"},{text:"Conscientious",difficulty:"Efsane"},{text:"Defibrillator",difficulty:"Efsane"},{text:"Antidisestablishmentarianism",difficulty:"Efsane"},{text:"How are you doing today?",difficulty:"C√ºmle"},{text:"I would like to order a coffee.",difficulty:"C√ºmle"},{text:"The quick brown fox jumps over the lazy dog.",difficulty:"C√ºmle"},{text:"Can you please repeat that?",difficulty:"C√ºmle"},{text:"I am learning to speak English fluently.",difficulty:"C√ºmle"},{text:"It is raining cats and dogs outside.",difficulty:"C√ºmle"},{text:"Actions speak louder than words.",difficulty:"C√ºmle"},{text:"I need to schedule a meeting for tomorrow.",difficulty:"C√ºmle"},{text:"What do you do for a living?",difficulty:"C√ºmle"},{text:"She sells seashells by the seashore.",difficulty:"Tekerleme"},{text:"Red lorry, yellow lorry.",difficulty:"Tekerleme"},{text:"Peter Piper picked a peck of pickled peppers.",difficulty:"Tekerleme"},{text:"How much wood would a woodchuck chuck?",difficulty:"Tekerleme"},{text:"Unique New York.",difficulty:"Tekerleme"},{text:"Fuzzy Wuzzy was a bear.",difficulty:"Tekerleme"},{text:"Which wristwatches are Swiss wristwatches?",difficulty:"Tekerleme"}],Zu=({apiBaseUrl:i})=>{const{token:r}=Ho(),[n,m]=o.useState(null),[c,b]=o.useState(!1),[j,R]=o.useState(!1),[E,L]=o.useState("idle"),[q,D]=o.useState(""),[z,ee]=o.useState(0),H=o.useRef(null),B=o.useRef([]);o.useEffect(()=>{U()},[]);const U=()=>{const Z=Math.floor(Math.random()*fa.length);m(fa[Z]),L("idle"),D("")},G=async()=>{if(n)try{const Z=await fetch(`${i}/eng-learn/speak-text/`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"},body:JSON.stringify({text:n.text})});if(Z.ok){const ne=await Z.json();new Audio(`data:audio/mp3;base64,${ne.audio_base64}`).play()}}catch(Z){console.error(Z)}},J=async()=>{D(""),L("recording");try{const Z=await navigator.mediaDevices.getUserMedia({audio:!0});H.current=new MediaRecorder(Z),B.current=[],H.current.ondataavailable=ne=>{ne.data.size>0&&B.current.push(ne.data)},H.current.onstop=ie,H.current.start(),b(!0)}catch{V.error("‚ùå Mikrofon izni gerekli!"),L("idle")}},fe=()=>{H.current&&c&&(H.current.stop(),b(!1))},ie=async()=>{R(!0);const Z=new Blob(B.current,{type:"audio/webm"}),ne=new FormData;ne.append("audio",Z,"voice.webm"),ne.append("target_text",n.text);try{const Y=await(await fetch(`${i}/eng-learn/check-pronunciation/`,{method:"POST",headers:{Authorization:`Bearer ${r}`},body:ne})).json();Y.is_correct?(L("success"),D(`Harika! üéâ (${Y.spoken_text})`),ee(pe=>pe+1)):(L("error"),D(`Algƒ±lanan: "${Y.spoken_text||"???"}" - Tekrar dene!`))}catch(ue){console.error(ue),D("Sunucu hatasƒ±."),L("error")}finally{R(!1)}};return n?e.jsxs("div",{style:Oe.container,children:[e.jsxs("div",{style:Oe.header,children:[e.jsxs(ga,{to:"/eng-learn",style:Oe.backBtn,children:[e.jsx(ya,{})," √áƒ±kƒ±≈ü"]}),e.jsxs("div",{style:Oe.scoreBadge,children:["Skor: ",z]})]}),e.jsxs("div",{style:Oe.mainContent,children:[e.jsxs("div",{style:{...Oe.card,borderColor:E==="success"?"#43b581":E==="error"?"#f04747":"transparent",boxShadow:E==="success"?"0 0 30px rgba(67, 181, 129, 0.3)":E==="error"?"0 0 30px rgba(240, 71, 71, 0.3)":"0 10px 30px rgba(0,0,0,0.3)"},children:[e.jsx("span",{style:{...Oe.difficulty,backgroundColor:n.difficulty==="Efsane"?"#eb459e":n.difficulty==="Zor"?"#f04747":"#202225",color:n.difficulty==="Efsane"||n.difficulty==="Zor"?"white":"#949ba4"},children:n.difficulty}),e.jsx("h1",{style:Oe.wordText,children:n.text}),e.jsx("div",{style:{height:"30px",marginTop:"10px",color:E==="success"?"#43b581":"#f04747",fontWeight:"bold"},children:j?"Analiz ediliyor...":q}),e.jsxs("div",{style:Oe.controls,children:[e.jsx("button",{onClick:G,style:Oe.iconButton,title:"Doƒürusunu Dinle",children:e.jsx(Fl,{size:24})}),e.jsx("button",{onMouseDown:J,onMouseUp:fe,onTouchStart:J,onTouchEnd:fe,style:{...Oe.micButton,backgroundColor:c?"#f04747":E==="success"?"#43b581":"#5865f2",transform:c?"scale(1.1)":"scale(1)"},children:e.jsx(Gn,{size:32})})]}),e.jsx("p",{style:Oe.hint,children:c?"Dinliyor...":"Mikrofona basƒ±lƒ± tut ve oku"})]}),e.jsx("div",{style:Oe.bottomNav,children:e.jsx("button",{onClick:U,style:Oe.skipButton,children:E==="success"?e.jsxs(e.Fragment,{children:["Sonraki Kelime ",e.jsx(Wl,{})]}):e.jsxs(e.Fragment,{children:["Bunu Ge√ß ",e.jsx(Gl,{})]})})})]})]}):e.jsx("div",{style:Oe.container,children:"Y√ºkleniyor..."})},Oe={container:{display:"flex",flexDirection:"column",height:"100%",backgroundColor:"#1e1f22",color:"white",padding:"20px",boxSizing:"border-box",fontFamily:"Poppins, sans-serif",alignItems:"center"},header:{width:"100%",maxWidth:"600px",display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"40px"},backBtn:{color:"#b9bbbe",textDecoration:"none",display:"flex",alignItems:"center",gap:"8px",fontWeight:"600"},scoreBadge:{backgroundColor:"#f0b232",color:"#000",padding:"5px 15px",borderRadius:"20px",fontWeight:"bold"},mainContent:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100%"},card:{backgroundColor:"#2b2d31",padding:"40px",borderRadius:"24px",width:"100%",maxWidth:"500px",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",border:"3px solid transparent",transition:"all 0.3s ease"},difficulty:{padding:"4px 12px",borderRadius:"12px",fontSize:"0.85em",marginBottom:"20px",fontWeight:"bold"},wordText:{fontSize:"2.2em",fontWeight:"800",margin:"0 0 10px 0",color:"#fff",letterSpacing:"1px",lineHeight:"1.3"},controls:{display:"flex",alignItems:"center",gap:"30px",marginTop:"30px"},iconButton:{width:"50px",height:"50px",borderRadius:"50%",border:"2px solid #40444b",backgroundColor:"transparent",color:"#b9bbbe",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},micButton:{width:"80px",height:"80px",borderRadius:"50%",border:"none",color:"white",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",boxShadow:"0 5px 20px rgba(0,0,0,0.4)",transition:"all 0.1s ease"},hint:{marginTop:"20px",color:"#72767d",fontSize:"0.9em"},bottomNav:{marginTop:"50px"},skipButton:{background:"transparent",border:"none",color:"#b9bbbe",fontSize:"1.1em",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",gap:"10px",padding:"10px 20px",borderRadius:"8px",transition:"background 0.2s",":hover":{backgroundColor:"rgba(255,255,255,0.05)"}}},Xu=y.memo(Zu),Qu=({apiBaseUrl:i})=>{const[r,n]=o.useState("loading"),m=Gr(),c=pa();return o.useEffect(()=>{const b=new URLSearchParams(c.search),j=b.get("code");if(b.get("error")){n("error");return}if(j){const E=localStorage.getItem("access_token");fetch(`${i}/spotify/callback/`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${E}`},body:JSON.stringify({code:j})}).then(L=>{L.ok?(n("success"),setTimeout(()=>{m("/",{replace:!0})},1500)):n("error")}).catch(L=>{console.error(L),n("error")})}},[c,i,m]),e.jsx("div",{style:Un.container,children:e.jsxs("div",{style:Un.card,children:[r==="loading"&&e.jsxs(e.Fragment,{children:[e.jsx(ha,{className:"spin",size:50,color:"#1db954",style:{marginBottom:20}}),e.jsx("h2",{children:"Spotify Baƒülanƒ±yor..."}),e.jsx("p",{children:"Token alƒ±nƒ±yor, l√ºtfen bekleyin."})]}),r==="success"&&e.jsxs(e.Fragment,{children:[e.jsx(Hn,{size:60,color:"#1db954",style:{marginBottom:20}}),e.jsx("h2",{style:{color:"#1db954"},children:"Ba≈üarƒ±lƒ±!"}),e.jsx("p",{children:"Hesabƒ±n baƒülandƒ±. Sohbet ekranƒ±na d√∂n√ºl√ºyor..."})]}),r==="error"&&e.jsxs(e.Fragment,{children:[e.jsx(Kn,{size:60,color:"#f04747",style:{marginBottom:20}}),e.jsx("h2",{style:{color:"#f04747"},children:"Hata Olu≈ütu"}),e.jsx("p",{children:"Baƒülantƒ± kurulamadƒ±."}),e.jsx("button",{onClick:()=>m("/"),style:Un.button,children:"Geri D√∂n"})]})]})})},Un={container:{display:"flex",justifyContent:"center",alignItems:"center",height:"100dvh",backgroundColor:"#191414",color:"white",fontFamily:"Poppins, sans-serif"},card:{backgroundColor:"#282828",padding:"40px",borderRadius:"16px",textAlign:"center",boxShadow:"0 10px 30px rgba(0,0,0,0.5)",maxWidth:"400px",width:"90%"},button:{marginTop:"20px",padding:"10px 20px",borderRadius:"20px",border:"none",backgroundColor:"#1db954",color:"white",fontWeight:"bold",cursor:"pointer"}},Ea=document.createElement("style");Ea.innerText=`
  .spin { animation: spin 1s linear infinite; }
  @keyframes spin { 100% { transform: rotate(360deg); } }
`;document.head.appendChild(Ea);const ef=y.memo(Qu),tf=()=>{const{globalData:i}=ka(),[r,n]=o.useState(null),[m,c]=o.useState(!1),b=Gr();if(o.useEffect(()=>{if(i&&i.type==="chat_message_handler"&&i.username==="‚ö° Signal Bot"){const R=i.content.split(`
`),E=R.find(z=>z.includes("ü™ô"))||"Bilinmiyor",L=R.find(z=>z.includes("üìà"))||"",q={title:"YENƒ∞ KRƒ∞PTO Sƒ∞NYALƒ∞! üö®",coin:E.replace("ü™ô","").replace(/\*/g,"").trim(),direction:L.includes("LONG")?"Y√úKSELƒ∞≈û (LONG)":"D√ú≈û√ú≈û (SHORT)",isLong:L.includes("LONG"),raw:i};n(q),c(!0);const D=setTimeout(()=>{c(!1)},8e3);return()=>clearTimeout(D)}},[i]),!m||!r)return null;const j=()=>{c(!1),b("/")};return e.jsxs("div",{style:yt.container,className:"slide-in-notification",children:[e.jsx("div",{style:yt.iconBox,children:e.jsx(Hl,{size:24,color:"#f0b232"})}),e.jsxs("div",{style:yt.content,onClick:j,children:[e.jsx("h4",{style:yt.title,children:r.title}),e.jsxs("div",{style:yt.details,children:[e.jsx("span",{style:yt.coinName,children:r.coin}),e.jsx("span",{style:{...yt.directionBadge,backgroundColor:r.isLong?"rgba(35, 165, 89, 0.2)":"rgba(240, 71, 71, 0.2)",color:r.isLong?"#23a559":"#da373c"},children:r.direction})]}),e.jsxs("span",{style:yt.hint,children:["Detaylar i√ßin tƒ±kla ",e.jsx(Kl,{size:10})]})]}),e.jsx("button",{onClick:R=>{R.stopPropagation(),c(!1)},style:yt.closeButton,children:e.jsx(Go,{})})]})},yt={container:{position:"fixed",top:"20px",right:"20px",width:"320px",backgroundColor:"#1e1f22",borderRadius:"8px",boxShadow:"0 8px 20px rgba(0,0,0,0.5)",borderLeft:"5px solid #f0b232",display:"flex",alignItems:"center",padding:"15px",zIndex:99999,cursor:"pointer",transition:"transform 0.3s ease-out"},iconBox:{marginRight:"15px",display:"flex",alignItems:"center"},content:{flex:1,display:"flex",flexDirection:"column"},title:{margin:0,color:"#fff",fontSize:"0.95em",fontWeight:"bold",marginBottom:"5px"},details:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"5px"},coinName:{color:"#dcddde",fontWeight:"bold",fontSize:"1.1em"},directionBadge:{fontSize:"0.75em",padding:"2px 6px",borderRadius:"4px",fontWeight:"bold"},hint:{fontSize:"0.7em",color:"#949ba4",display:"flex",alignItems:"center",gap:"5px"},closeButton:{background:"none",border:"none",color:"#949ba4",cursor:"pointer",padding:"5px",marginLeft:"10px",fontSize:"1em"}},Ta=document.createElement("style");Ta.innerText=`
  @keyframes slideInRight {
    from { transform: translateX(100%); opacity: 0; }
    to { transform: translateX(0); opacity: 1; }
  }
  .slide-in-notification {
    animation: slideInRight 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
  }
`;document.head.appendChild(Ta);function of(i={}){const{nonce:r,onScriptLoadSuccess:n,onScriptLoadError:m}=i,[c,b]=o.useState(!1),j=o.useRef(n);j.current=n;const R=o.useRef(m);return R.current=m,o.useEffect(()=>{const E=document.createElement("script");return E.src="https://accounts.google.com/gsi/client",E.async=!0,E.defer=!0,E.nonce=r,E.onload=()=>{var L;b(!0),(L=j.current)===null||L===void 0||L.call(j)},E.onerror=()=>{var L;b(!1),(L=R.current)===null||L===void 0||L.call(R)},document.body.appendChild(E),()=>{document.body.removeChild(E)}},[r]),c}const rf=o.createContext(null);function nf({clientId:i,nonce:r,onScriptLoadSuccess:n,onScriptLoadError:m,children:c}){const b=of({nonce:r,onScriptLoadSuccess:n,onScriptLoadError:m}),j=o.useMemo(()=>({clientId:i,scriptLoadedSuccessfully:b}),[i,b]);return y.createElement(rf.Provider,{value:j},c)}const je=({children:i})=>{const r=bo.isNativePlatform();return e.jsx("div",{style:{width:"100%",height:"100dvh",boxSizing:"border-box",paddingTop:r?"max(35px, env(safe-area-inset-top))":"0px",backgroundColor:"#1e1f22",overflowY:"auto",overflowX:"hidden",display:"flex",flexDirection:"column"},children:i})};class sf extends y.Component{constructor(n){super(n);Dr(this,"handleReset",()=>{this.setState({hasError:!1,error:null,errorInfo:null}),window.location.reload()});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(n){return{hasError:!0}}componentDidCatch(n,m){console.error("üî¥ App Crashed:",n),console.error("Error Info:",m),this.setState({error:n,errorInfo:m});try{fetch("/api/errors/report/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({error:n?.toString(),stack:n?.stack,componentStack:m?.componentStack,url:window.location.href,userAgent:navigator.userAgent,timestamp:new Date().toISOString()})}).catch(()=>{})}catch(c){console.warn("Could not report error:",c)}}render(){return this.state.hasError?e.jsx("div",{style:xt.container,children:e.jsxs("div",{style:xt.content,children:[e.jsx("div",{style:xt.icon,children:"üí•"}),e.jsx("h1",{style:xt.title,children:"Oops! Bir ≈üeyler ters gitti"}),e.jsx("p",{style:xt.message,children:"√úzg√ºn√ºz, uygulama beklenmedik bir hatayla kar≈üƒ±la≈ütƒ±."}),e.jsxs("div",{style:xt.actions,children:[e.jsx("button",{onClick:this.handleReset,style:xt.button,children:"üîÑ Yeniden Ba≈ülat"}),e.jsx("button",{onClick:()=>window.location.href="/",style:{...xt.button,...xt.buttonSecondary},children:"üè† Ana Sayfaya D√∂n"})]}),!1]})}):this.props.children}}const xt={container:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh",backgroundColor:"#1E1F22",color:"#FFFFFF",padding:"20px",fontFamily:"'Inter', sans-serif"},content:{textAlign:"center",maxWidth:"600px",padding:"40px",background:"linear-gradient(135deg, #2B2D31 0%, #1E1F22 100%)",borderRadius:"16px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)"},icon:{fontSize:"80px",marginBottom:"20px",animation:"shake 0.5s ease-in-out"},title:{fontSize:"32px",fontWeight:"bold",marginBottom:"16px",color:"#FFFFFF"},message:{fontSize:"16px",color:"#B9BBBE",marginBottom:"32px",lineHeight:"1.6"},actions:{display:"flex",gap:"12px",justifyContent:"center",flexWrap:"wrap"},button:{padding:"12px 24px",fontSize:"16px",fontWeight:"600",border:"none",borderRadius:"8px",cursor:"pointer",backgroundColor:"#5865F2",color:"#FFFFFF",transition:"all 0.2s",":hover":{backgroundColor:"#4752C4"}},buttonSecondary:{backgroundColor:"#4E5058",":hover":{backgroundColor:"#6A6F78"}}},af=y.lazy(()=>x(()=>import("./EnglishHub-B_CgDonV.js"),__vite__mapDeps([169,2,3,5]))),lf=y.lazy(()=>x(()=>import("./GrammarQuizPage-TGoWuvbp.js"),__vite__mapDeps([170,2,3,5,171,1,4,6]))),cf=y.lazy(()=>x(()=>import("./EnglishLearningPage-TPLz2hUV.js"),__vite__mapDeps([172,2,3,171,1,4,5,6]))),df=y.lazy(()=>x(()=>import("./CryptoDashboard-DTuFwFWd.js"),__vite__mapDeps([173,2,3,5,1,4,6]))),uf=y.lazy(()=>x(()=>import("./ForgotPasswordPage-ohAe50EJ.js"),__vite__mapDeps([121,2,5,39,3]))),ff=y.lazy(()=>x(()=>import("./ResetPasswordPage-BB5pWXbh.js"),__vite__mapDeps([122,2,5,3]))),pf=y.lazy(()=>x(()=>import("./TwoFactorLoginPage-BeasgjlK.js"),__vite__mapDeps([123,2,5,3]))),mf=y.lazy(()=>x(()=>import("./VerifyEmailPage-DysnN1lb.js"),__vite__mapDeps([120,2,5,3]))),gf=y.lazy(()=>x(()=>import("./LandingPage-CIFFO7cv.js"),__vite__mapDeps([174,2,141,1,3,4,5,6,175]))),hf=y.lazy(()=>x(()=>import("./ReferralProgram-Br_NowEc.js"),__vite__mapDeps([176,2,141,1,3,4,5,6,177]))),yf=y.lazy(()=>x(()=>import("./GrowthDashboard-CXRvTiSe.js"),__vite__mapDeps([178,2,141,9,179]))),xf=y.lazy(()=>x(()=>import("./ToastDemo-vagu7hek.js"),__vite__mapDeps([180,2,1,3,4,5,6,181]))),Sf=window.location.hostname==="pawscord.com"||window.location.hostname==="www.pawscord.com",bf="192.168.68.53",wf="8888",vf=Sf?"https://pawscord.com":`http://${bf}:${wf}`,lt=`${vf}/api`,_f="774757987258-poa0elqqapnab8eud3tol3h2pilcqe71.apps.googleusercontent.com",kf=()=>(o.useEffect(()=>{const i=setTimeout(()=>{try{Sa()}catch(r){console.warn("preloadCriticalChunks error",r)}},3e3);if("requestIdleCallback"in window)window.requestIdleCallback(()=>{try{Nn()}catch(r){console.warn("prefetchNextChunks error",r)}},{timeout:2e3});else{const r=setTimeout(()=>{try{Nn()}catch(n){console.warn("prefetchNextChunks error",n)}},4e3);return()=>clearTimeout(r)}return()=>clearTimeout(i)},[]),e.jsx(nf,{clientId:_f,children:e.jsx(Nc,{children:e.jsx(Hc,{children:e.jsx(sf,{children:e.jsxs(vl,{children:[e.jsx(tf,{}),e.jsxs(_l,{children:[e.jsx(Se,{path:"/verify/:token",element:e.jsx(je,{children:e.jsx(qu,{})})}),e.jsx(Se,{path:"/verify-email/:token",element:e.jsx(je,{children:e.jsx(y.Suspense,{fallback:e.jsx("div",{children:"Y√ºkleniyor..."}),children:e.jsx(mf,{apiBaseUrl:lt})})})}),e.jsx(Se,{path:"/forgot-password",element:e.jsx(je,{children:e.jsx(y.Suspense,{fallback:e.jsx("div",{children:"Y√ºkleniyor..."}),children:e.jsx(uf,{apiBaseUrl:lt})})})}),e.jsx(Se,{path:"/reset-password/:token",element:e.jsx(je,{children:e.jsx(y.Suspense,{fallback:e.jsx("div",{children:"Y√ºkleniyor..."}),children:e.jsx(ff,{apiBaseUrl:lt})})})}),e.jsx(Se,{path:"/2fa-login",element:e.jsx(je,{children:e.jsx(y.Suspense,{fallback:e.jsx("div",{children:"Y√ºkleniyor..."}),children:e.jsx(pf,{apiBaseUrl:lt})})})}),e.jsx(Se,{path:"/launch",element:e.jsx(je,{children:e.jsx(y.Suspense,{fallback:e.jsx("div",{children:"Y√ºkleniyor..."}),children:e.jsx(gf,{apiBaseUrl:lt})})})}),e.jsx(Se,{path:"/referral",element:e.jsx(je,{children:e.jsx(y.Suspense,{fallback:e.jsx("div",{children:"Y√ºkleniyor..."}),children:e.jsx(hf,{apiBaseUrl:lt})})})}),e.jsx(Se,{path:"/growth-dashboard",element:e.jsx(je,{children:e.jsx(y.Suspense,{fallback:e.jsx("div",{children:"Y√ºkleniyor..."}),children:e.jsx(yf,{apiBaseUrl:lt})})})}),e.jsx(Se,{path:"/toast-demo",element:e.jsx(je,{children:e.jsx(y.Suspense,{fallback:e.jsx("div",{children:"Y√ºkleniyor..."}),children:e.jsx(xf,{})})})}),e.jsx(Se,{path:"/invite/:code",element:e.jsx(je,{children:e.jsx(Yu,{})})}),e.jsx(Se,{path:"/spotify-callback",element:e.jsx(je,{children:e.jsx(ef,{apiBaseUrl:lt})})}),e.jsx(Se,{path:"/eng-learn",element:e.jsx(je,{children:e.jsx(y.Suspense,{fallback:e.jsx("div",{children:"Y√ºkleniyor..."}),children:e.jsx(af,{})})})}),e.jsx(Se,{path:"/eng-learn/vocab",element:e.jsx(je,{children:e.jsx(y.Suspense,{fallback:e.jsx("div",{children:"Y√ºkleniyor..."}),children:e.jsx(cf,{})})})}),e.jsx(Se,{path:"/eng-learn/grammar",element:e.jsx(je,{children:e.jsx(y.Suspense,{fallback:e.jsx("div",{children:"Y√ºkleniyor..."}),children:e.jsx(lf,{})})})}),e.jsx(Se,{path:"/eng-learn/voice",element:e.jsx(je,{children:e.jsx(Ju,{apiBaseUrl:lt})})}),e.jsx(Se,{path:"/eng-learn/pronunciation",element:e.jsx(je,{children:e.jsx(Xu,{apiBaseUrl:lt})})}),e.jsx(Se,{path:"/crypto-analysis",element:e.jsx(je,{children:e.jsx(y.Suspense,{fallback:e.jsx("div",{children:"Y√ºkleniyor..."}),children:e.jsx(df,{})})})}),e.jsx(Se,{path:"/*",element:e.jsx(Gu,{})})]})]})})})})})),Cf=wl.createRoot(document.getElementById("root"));Cf.render(e.jsx(kf,{}));export{Vc as A,bo as C,nc as G,Fn as T,xa as W,Ho as a,hp as b,gp as c,$c as d,Ce as e,mp as f,Yc as g,pp as h,Jn as i,Sc as j,Gc as k,Re as l,vc as m,qn as r,V as t,ka as u};
