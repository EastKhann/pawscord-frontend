var y=Object.defineProperty;var t=(o,n)=>y(o,"name",{value:n,configurable:!0});import{r,j as s}from"./react-core-Djgtqrmb.js";import{c as g,n as m,a as f,by as k,C as $,R as w,aE as C,P as x,z as F}from"./icons-vendor-BW7dxHkX.js";import{g as S}from"./index-BT6pEMKq.js";import"./media-vendor-CxFPycob.js";import"./router-vendor-ClgLnMjk.js";import"./state-vendor-BRqaXHJQ.js";import"./crypto-vendor-D1XRGppi.js";import"./ui-vendor-IhB9Znpc.js";const M=t(({serverId:o,onClose:n,fetchWithAuth:v})=>{const[e,j]=r.useState(null),[u,p]=r.useState(!0),[c,d]=r.useState("overview"),[h,b]=r.useState("week"),N=r.useCallback(async()=>{p(!0);try{const a=await v(`${S()}/servers/${o}/reaction-stats/?range=${h}`);if(a.ok){const i=await a.json();j(i)}else j({total_reactions:0,unique_emojis:0,top_emojis:[],top_reactors:[],hourly_distribution:Array(24).fill(0),daily_trend:[],most_reacted_messages:[]})}catch{j({total_reactions:0,unique_emojis:0,top_emojis:[],top_reactors:[],hourly_distribution:Array(24).fill(0),daily_trend:[],most_reacted_messages:[]})}p(!1)},[o,h,v]);r.useEffect(()=>{N()},[N]);const l=t(a=>a>=1e6?(a/1e6).toFixed(1)+"M":a>=1e3?(a/1e3).toFixed(1)+"K":a?.toString()||"0","formatNumber"),_=t(()=>e?.hourly_distribution?Math.max(...e.hourly_distribution,1):1,"getMaxHourlyValue");return u?s.jsx("div",{className:"reaction-stats-overlay",onClick:n,children:s.jsx("div",{className:"reaction-stats-panel",onClick:t(a=>a.stopPropagation(),"onClick"),children:s.jsxs("div",{className:"loading-spinner",children:[s.jsx(g,{className:"spin"}),s.jsx("span",{children:"Loading reaction statistics..."})]})})}):s.jsx("div",{className:"reaction-stats-overlay",onClick:n,children:s.jsxs("div",{className:"reaction-stats-panel",onClick:t(a=>a.stopPropagation(),"onClick"),children:[s.jsxs("div",{className:"panel-header",children:[s.jsxs("div",{className:"header-info",children:[s.jsxs("h2",{children:[s.jsx(m,{})," Reaction Statistics"]}),s.jsx("span",{className:"subtitle",children:"Discover emoji trends and patterns"})]}),s.jsxs("div",{className:"header-actions",children:[s.jsxs("select",{value:h,onChange:t(a=>b(a.target.value),"onChange"),className:"time-range-select",children:[s.jsx("option",{value:"day",children:"Last 24 Hours"}),s.jsx("option",{value:"week",children:"Last 7 Days"}),s.jsx("option",{value:"month",children:"Last 30 Days"}),s.jsx("option",{value:"all",children:"All Time"})]}),s.jsx("button",{className:"close-btn",onClick:n,children:s.jsx(f,{})})]})]}),s.jsxs("div",{className:"stats-overview",children:[s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-icon",children:s.jsx(k,{})}),s.jsxs("div",{className:"stat-info",children:[s.jsx("span",{className:"stat-value",children:l(e?.total_reactions)}),s.jsx("span",{className:"stat-label",children:"Total Reactions"})]})]}),s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-icon",children:s.jsx(m,{})}),s.jsxs("div",{className:"stat-info",children:[s.jsx("span",{className:"stat-value",children:l(e?.unique_emojis)}),s.jsx("span",{className:"stat-label",children:"Unique Emojis"})]})]}),s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-icon",children:s.jsx($,{})}),s.jsxs("div",{className:"stat-info",children:[s.jsx("span",{className:"stat-value",children:l(e?.top_reactors?.length)}),s.jsx("span",{className:"stat-label",children:"Active Reactors"})]})]}),s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-icon",children:s.jsx(w,{})}),s.jsxs("div",{className:"stat-info",children:[s.jsx("span",{className:"stat-value",children:e?.top_emojis?.[0]?.emoji||"ðŸ”¥"}),s.jsx("span",{className:"stat-label",children:"Top Emoji"})]})]})]}),s.jsxs("div",{className:"tabs",children:[s.jsxs("button",{className:`tab ${c==="overview"?"active":""}`,onClick:t(()=>d("overview"),"onClick"),children:[s.jsx(C,{})," Overview"]}),s.jsxs("button",{className:`tab ${c==="emojis"?"active":""}`,onClick:t(()=>d("emojis"),"onClick"),children:[s.jsx(m,{})," Top Emojis"]}),s.jsxs("button",{className:`tab ${c==="users"?"active":""}`,onClick:t(()=>d("users"),"onClick"),children:[s.jsx(x,{})," Top Reactors"]}),s.jsxs("button",{className:`tab ${c==="time"?"active":""}`,onClick:t(()=>d("time"),"onClick"),children:[s.jsx(F,{})," Activity Pattern"]})]}),s.jsxs("div",{className:"tab-content",children:[c==="overview"&&s.jsx("div",{className:"overview-tab",children:s.jsxs("div",{className:"section",children:[s.jsx("h3",{children:"ðŸ”¥ Trending Emojis"}),s.jsxs("div",{className:"emoji-grid",children:[(e?.top_emojis||[]).slice(0,10).map((a,i)=>s.jsxs("div",{className:"emoji-item",children:[s.jsx("span",{className:"emoji",children:a.emoji}),s.jsx("span",{className:"count",children:l(a.count)}),s.jsx("div",{className:"progress-bar",children:s.jsx("div",{className:"progress",style:{width:`${a.count/(e?.top_emojis?.[0]?.count||1)*100}%`}})})]},i)),(!e?.top_emojis||e.top_emojis.length===0)&&s.jsx("div",{className:"empty-state",children:"No reaction data yet"})]})]})}),c==="emojis"&&s.jsx("div",{className:"emojis-tab",children:s.jsxs("div",{className:"emoji-leaderboard",children:[(e?.top_emojis||[]).map((a,i)=>s.jsxs("div",{className:`leaderboard-item ${i<3?"top-three":""}`,children:[s.jsx("span",{className:"rank",children:i+1}),s.jsx("span",{className:"emoji-large",children:a.emoji}),s.jsxs("div",{className:"emoji-details",children:[s.jsx("span",{className:"emoji-name",children:a.name||"Custom Emoji"}),s.jsxs("span",{className:"emoji-usage",children:[l(a.count)," uses"]})]}),s.jsx("div",{className:"emoji-bar",children:s.jsx("div",{className:"bar-fill",style:{width:`${a.count/(e?.top_emojis?.[0]?.count||1)*100}%`}})})]},i)),(!e?.top_emojis||e.top_emojis.length===0)&&s.jsxs("div",{className:"empty-state",children:[s.jsx(m,{size:48}),s.jsx("p",{children:"No emoji data available"})]})]})}),c==="users"&&s.jsx("div",{className:"users-tab",children:s.jsxs("div",{className:"user-leaderboard",children:[(e?.top_reactors||[]).map((a,i)=>s.jsxs("div",{className:`user-item ${i<3?"top-three":""}`,children:[s.jsx("span",{className:`rank rank-${i+1}`,children:i<3?s.jsx(x,{}):`${i+1}`}),s.jsx("div",{className:"user-avatar",children:a.avatar?s.jsx("img",{src:a.avatar,alt:a.username}):a.username?.charAt(0).toUpperCase()||"?"}),s.jsxs("div",{className:"user-info",children:[s.jsx("span",{className:"username",children:a.username}),s.jsxs("span",{className:"reaction-count",children:[l(a.count)," reactions"]})]}),s.jsx("div",{className:"user-favorite",children:s.jsx("span",{className:"favorite-emoji",children:a.favorite_emoji||"â¤ï¸"})})]},i)),(!e?.top_reactors||e.top_reactors.length===0)&&s.jsxs("div",{className:"empty-state",children:[s.jsx(x,{size:48}),s.jsx("p",{children:"No reactor data available"})]})]})}),c==="time"&&s.jsx("div",{className:"time-tab",children:s.jsxs("div",{className:"section",children:[s.jsx("h3",{children:"â° Hourly Activity"}),s.jsx("div",{className:"hourly-chart",children:(e?.hourly_distribution||Array(24).fill(0)).map((a,i)=>s.jsxs("div",{className:"hour-bar",children:[s.jsx("div",{className:"bar",style:{height:`${Math.max(a/_()*100,5)}%`},title:`${i}:00 - ${a} reactions`}),s.jsx("span",{className:"hour-label",children:i})]},i))}),s.jsx("p",{className:"chart-note",children:"Hours shown in your local timezone"})]})})]})]})})},"ReactionStatsPanel");export{M as default};
