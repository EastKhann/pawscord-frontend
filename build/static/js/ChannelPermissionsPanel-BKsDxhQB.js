import{r,n as e}from"./react-core-Cj7FUMmY.js";import{j as R,a as _}from"./icons-vendor-TGltgKsJ.js";import{t as l}from"./index-DrIBbDZv.js";import"./editor-vendor-D9c4a6XZ.js";import"./media-vendor-BsD1gqUZ.js";import"./router-vendor-QeioVw-9.js";import"./state-vendor-MN-5i-Jz.js";import"./crypto-vendor-DK-7ILyQ.js";const $=({fetchWithAuth:d,apiBaseUrl:c,channelSlug:p,onClose:x})=>{const[I,f]=r.useState([]),[m,u]=r.useState([]),[h,y]=r.useState(!0),[w,P]=r.useState(null),[j,g]=r.useState({}),k=[{key:"view_channel",name:"Kanalƒ± G√∂r√ºnt√ºle",icon:"üëÅÔ∏è"},{key:"send_messages",name:"Mesaj G√∂nder",icon:"üí¨"},{key:"attach_files",name:"Dosya Ekle",icon:"üìé"},{key:"embed_links",name:"Link G√∂mme",icon:"üîó"},{key:"add_reactions",name:"Tepki Ekle",icon:"üòÄ"},{key:"use_voice",name:"Sesli Kullan",icon:"üé§"},{key:"speak",name:"Konu≈ü",icon:"üó£Ô∏è"},{key:"mute_members",name:"Susturma",icon:"üîá"},{key:"manage_messages",name:"Mesaj Y√∂netimi",icon:"‚öôÔ∏è"},{key:"manage_channel",name:"Kanal Y√∂netimi",icon:"üõ†Ô∏è"}];r.useEffect(()=>{b(),v()},[p]);const b=async()=>{try{y(!0);const n=await d(`${c}/channels/${p}/permissions/`);if(n.ok){const i=await n.json();f(i);const t={};i.forEach(o=>{t[o.role_id]||(t[o.role_id]={}),t[o.role_id][o.permission]=o.value}),g(t)}}catch{l.error("ƒ∞zinler y√ºklenemedi")}finally{y(!1)}},v=async()=>{try{const n=await d(`${c}/servers/roles/list/`);if(n.ok){const i=await n.json();u(i)}}catch{}},C=async(n,i,t)=>{try{(await d(`${c}/channels/permissions/add/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({channel_slug:p,role_id:n,permission:i,value:t})})).ok?(l.success("ƒ∞zin g√ºncellendi"),g(a=>({...a,[n]:{...a[n],[i]:t}}))):l.error("ƒ∞zin g√ºncellenemedi")}catch{l.error("Bir hata olu≈ütu")}},S=(n,i)=>j[n]?.[i],z=n=>n===!0?{icon:"‚úÖ",color:"#43b581",text:"ƒ∞zin Ver"}:n===!1?{icon:"‚ùå",color:"#ed4245",text:"Reddet"}:{icon:"‚ûñ",color:"#99aab5",text:"Varsayƒ±lan"};return e.jsx("div",{style:s.overlay,onClick:x,children:e.jsxs("div",{style:s.modal,onClick:n=>n.stopPropagation(),children:[e.jsxs("div",{style:s.header,children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(R,{style:{color:"#faa61a"}}),e.jsx("h2",{style:{margin:0},children:"Kanal ƒ∞zinleri"})]}),e.jsx(_,{onClick:x,style:s.closeBtn})]}),e.jsx("div",{style:s.content,children:h?e.jsx("div",{style:s.loading,children:"Y√ºkleniyor..."}):e.jsxs("div",{style:s.matrix,children:[e.jsxs("div",{style:s.matrixHeader,children:[e.jsx("div",{style:s.headerCell,children:"ƒ∞zin"}),m.map(n=>e.jsx("div",{style:s.headerCell,children:e.jsx("div",{style:{...s.roleTag,backgroundColor:n.color||"#5865f2"},children:n.name})},n.id))]}),k.map(n=>e.jsxs("div",{style:s.matrixRow,children:[e.jsxs("div",{style:s.permissionName,children:[e.jsx("span",{style:{fontSize:"18px",marginRight:"8px"},children:n.icon}),n.name]}),m.map(i=>{const t=S(i.id,n.key),o=z(t);return e.jsx("div",{style:s.permissionCell,children:e.jsx("button",{onClick:()=>{const a=t===null?!0:t===!0?!1:null;C(i.id,n.key,a)},style:{...s.permissionBtn,color:o.color},title:o.text,children:e.jsx("span",{style:{fontSize:"20px"},children:o.icon})})},i.id)})]},n.key))]})}),e.jsx("div",{style:s.footer,children:e.jsxs("div",{style:s.legend,children:[e.jsxs("div",{style:s.legendItem,children:[e.jsx("span",{style:{color:"#43b581",fontSize:"18px"},children:"‚úÖ"}),e.jsx("span",{children:"ƒ∞zin Ver"})]}),e.jsxs("div",{style:s.legendItem,children:[e.jsx("span",{style:{color:"#ed4245",fontSize:"18px"},children:"‚ùå"}),e.jsx("span",{children:"Reddet"})]}),e.jsxs("div",{style:s.legendItem,children:[e.jsx("span",{style:{color:"#99aab5",fontSize:"18px"},children:"‚ûñ"}),e.jsx("span",{children:"Varsayƒ±lan"})]})]})})]})})},s={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999},modal:{backgroundColor:"#1e1e1e",borderRadius:"8px",width:"95%",maxWidth:"1200px",maxHeight:"90vh",display:"flex",flexDirection:"column",color:"#fff"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #333"},closeBtn:{cursor:"pointer",fontSize:"24px",color:"#888"},content:{flex:1,overflowY:"auto",padding:"20px"},matrix:{display:"flex",flexDirection:"column",gap:"2px"},matrixHeader:{display:"grid",gridTemplateColumns:"200px repeat(auto-fit, minmax(100px, 1fr))",gap:"2px",marginBottom:"10px",position:"sticky",top:0,backgroundColor:"#1e1e1e",zIndex:10,paddingBottom:"10px"},headerCell:{padding:"12px",fontWeight:"600",textAlign:"center",backgroundColor:"#2c2f33",borderRadius:"4px"},roleTag:{padding:"6px 12px",borderRadius:"12px",fontSize:"13px",fontWeight:"600",color:"#fff"},matrixRow:{display:"grid",gridTemplateColumns:"200px repeat(auto-fit, minmax(100px, 1fr))",gap:"2px",marginBottom:"2px"},permissionName:{padding:"12px",backgroundColor:"#2c2f33",borderRadius:"4px",display:"flex",alignItems:"center",fontWeight:"500"},permissionCell:{padding:"12px",backgroundColor:"#2c2f33",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center"},permissionBtn:{backgroundColor:"transparent",border:"none",cursor:"pointer",padding:"8px",borderRadius:"4px",transition:"background-color 0.2s"},footer:{padding:"20px",borderTop:"1px solid #333"},legend:{display:"flex",gap:"30px",justifyContent:"center"},legendItem:{display:"flex",alignItems:"center",gap:"8px",fontSize:"14px"},loading:{textAlign:"center",padding:"40px",color:"#888"}};export{$ as default};
