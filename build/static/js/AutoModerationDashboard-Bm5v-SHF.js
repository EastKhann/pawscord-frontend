import{r,ay as S,l as x,o as L,b_ as I,Y as _,aX as z,bV as T,aI as B,aj as F}from"./react-core-B6hadH-M.js";import{h as A}from"./index-D_6pZib5.js";const K=({serverId:l,fetchWithAuth:s,apiBaseUrl:d,onClose:g})=>{const[c,u]=r.useState([]),[i,b]=r.useState([]),[f,R]=r.useState({total_violations:0,auto_deleted:0,warnings_issued:0,users_banned:0}),[E,m]=r.useState(!1),[o,p]=r.useState({rule_type:"toxic",action:"warn",threshold:.8,keywords:[]}),[h,y]=r.useState(!0);r.useEffect(()=>{v()},[l]);const v=async()=>{y(!0);try{const t=await s(`${d}/moderation/rules/${l}/`);if(t.ok){const n=await t.json();u(n.rules||[])}const a=await s(`${d}/moderation/logs/${l}/`);if(a.ok){const n=await a.json();b(n.logs||n)}i.length>0&&R({total_violations:i.length,auto_deleted:i.filter(n=>n.action==="delete").length,warnings_issued:i.filter(n=>n.action==="warn").length,users_banned:i.filter(n=>n.action==="ban").length})}catch(t){console.error("Failed to load moderation data:",t)}y(!1)},k=async()=>{try{const t=await s(`${d}/moderation/rules/${l}/create/`,{method:"POST",body:JSON.stringify(o)});if(t.ok){const a=await t.json();u([...c,a]),m(!1),p({rule_type:"toxic",action:"warn",threshold:.8,keywords:[]})}}catch(t){console.error("Failed to create rule:",t)}},w=async t=>{try{await s(`${d}/moderation/rules/${t}/toggle/`,{method:"POST"}),u(c.map(a=>a.id===t?{...a,is_enabled:!a.is_enabled}:a))}catch(a){console.error("Failed to toggle rule:",a)}},C=async t=>{if(await A("Bu kuralÄ± silmek istediÄŸine emin misin?"))try{await s(`${d}/moderation/rules/${t}/`,{method:"DELETE"}),u(c.filter(a=>a.id!==t))}catch(a){console.error("Failed to delete rule:",a)}};return React.createElement("div",{style:e.overlay,onClick:g},React.createElement("div",{style:e.panel,onClick:t=>t.stopPropagation()},React.createElement("div",{style:e.header},React.createElement("div",{style:e.headerLeft},React.createElement(S,{style:e.headerIcon}),React.createElement("h2",{style:e.title},"Auto-Moderation")),React.createElement("button",{onClick:g,style:e.closeButton},React.createElement(x,null))),React.createElement("div",{style:e.statsGrid},React.createElement("div",{style:e.statCard},React.createElement(L,{style:{...e.statIcon,color:"#f04747"}}),React.createElement("div",{style:e.statValue},f.total_violations),React.createElement("div",{style:e.statLabel},"Total Violations")),React.createElement("div",{style:e.statCard},React.createElement(I,{style:{...e.statIcon,color:"#ed4245"}}),React.createElement("div",{style:e.statValue},f.auto_deleted),React.createElement("div",{style:e.statLabel},"Auto-Deleted")),React.createElement("div",{style:e.statCard},React.createElement(_,{style:{...e.statIcon,color:"#f0b132"}}),React.createElement("div",{style:e.statValue},f.warnings_issued),React.createElement("div",{style:e.statLabel},"Warnings")),React.createElement("div",{style:e.statCard},React.createElement(z,{style:{...e.statIcon,color:"#43b581"}}),React.createElement("div",{style:e.statValue},c.filter(t=>t.is_enabled).length),React.createElement("div",{style:e.statLabel},"Active Rules"))),React.createElement("div",{style:e.section},React.createElement("div",{style:e.sectionHeader},React.createElement("h3",{style:e.sectionTitle},React.createElement(T,null)," Moderation Rules"),React.createElement("button",{onClick:()=>m(!0),style:e.addButton},React.createElement(B,null)," Add Rule")),h?React.createElement("div",{style:e.loading},"Loading..."):c.length===0?React.createElement("div",{style:e.empty},"No moderation rules yet. Create one to get started!"):React.createElement("div",{style:e.rulesList},c.map(t=>React.createElement("div",{key:t.id,style:e.ruleCard},React.createElement("div",{style:e.ruleHeader},React.createElement("div",{style:e.ruleType},D(t.rule_type),React.createElement("span",null,j(t.rule_type))),React.createElement("div",{style:e.ruleActions},React.createElement("label",{style:e.switch},React.createElement("input",{type:"checkbox",checked:t.is_enabled,onChange:()=>w(t.id)}),React.createElement("span",{style:e.slider})),React.createElement("button",{onClick:()=>C(t.id),style:e.deleteBtn},React.createElement(x,null)))),React.createElement("div",{style:e.ruleDetails},React.createElement("div",{style:e.ruleInfo},React.createElement("span",{style:e.ruleLabel},"Action:"),React.createElement("span",{style:e.ruleValue},V(t.action))),t.threshold&&React.createElement("div",{style:e.ruleInfo},React.createElement("span",{style:e.ruleLabel},"Threshold:"),React.createElement("span",{style:e.ruleValue},(t.threshold*100).toFixed(0),"%")),t.keywords&&t.keywords.length>0&&React.createElement("div",{style:e.ruleInfo},React.createElement("span",{style:e.ruleLabel},"Keywords:"),React.createElement("span",{style:e.ruleValue},t.keywords.join(", ")))))))),React.createElement("div",{style:e.section},React.createElement("h3",{style:e.sectionTitle},React.createElement(F,null)," Recent Activity"),React.createElement("div",{style:e.logsList},i.slice(0,10).map((t,a)=>React.createElement("div",{key:a,style:e.logItem},React.createElement("div",{style:e.logIcon},W(t.action)),React.createElement("div",{style:e.logContent},React.createElement("div",{style:e.logText},React.createElement("strong",null,t.user||"Unknown")," - ",t.violation_type),React.createElement("div",{style:e.logMeta},t.content?.substring(0,50),"... â€¢ ",new Date(t.created_at).toLocaleString())),React.createElement("div",{style:e.logAction},React.createElement("span",{style:$(t.action)},t.action)))))),E&&React.createElement("div",{style:e.modalOverlay,onClick:()=>m(!1)},React.createElement("div",{style:e.modal,onClick:t=>t.stopPropagation()},React.createElement("h3",{style:e.modalTitle},"Create Moderation Rule"),React.createElement("div",{style:e.formGroup},React.createElement("label",{style:e.label},"Rule Type"),React.createElement("select",{value:o.rule_type,onChange:t=>p({...o,rule_type:t.target.value}),style:e.select},React.createElement("option",{value:"toxic"},"Toxic Language"),React.createElement("option",{value:"spam"},"Spam Detection"),React.createElement("option",{value:"keyword"},"Keyword Filter"),React.createElement("option",{value:"link"},"Link Filter"),React.createElement("option",{value:"caps"},"Excessive Caps"))),React.createElement("div",{style:e.formGroup},React.createElement("label",{style:e.label},"Action"),React.createElement("select",{value:o.action,onChange:t=>p({...o,action:t.target.value}),style:e.select},React.createElement("option",{value:"warn"},"Warn User"),React.createElement("option",{value:"delete"},"Delete Message"),React.createElement("option",{value:"timeout"},"Timeout User (5min)"),React.createElement("option",{value:"kick"},"Kick User"),React.createElement("option",{value:"ban"},"Ban User"))),o.rule_type!=="keyword"&&React.createElement("div",{style:e.formGroup},React.createElement("label",{style:e.label},"AI Threshold (",(o.threshold*100).toFixed(0),"%)"),React.createElement("input",{type:"range",min:"0.5",max:"1",step:"0.05",value:o.threshold,onChange:t=>p({...o,threshold:parseFloat(t.target.value)}),style:e.slider})),o.rule_type==="keyword"&&React.createElement("div",{style:e.formGroup},React.createElement("label",{style:e.label},"Keywords (comma separated)"),React.createElement("input",{type:"text",placeholder:"word1, word2, word3",onChange:t=>p({...o,keywords:t.target.value.split(",").map(a=>a.trim())}),style:e.input})),React.createElement("div",{style:e.modalButtons},React.createElement("button",{onClick:()=>m(!1),style:e.cancelBtn},"Cancel"),React.createElement("button",{onClick:k,style:e.createBtn},"Create Rule"))))))},D=l=>{switch(l){case"toxic":return"â˜ ï¸";case"spam":return"ðŸš«";case"keyword":return"ðŸ”¤";case"link":return"ðŸ”—";case"caps":return"ðŸ“¢";default:return"âš™ï¸"}},j=l=>{switch(l){case"toxic":return"Toxic Language";case"spam":return"Spam Detection";case"keyword":return"Keyword Filter";case"link":return"Link Filter";case"caps":return"Excessive Caps";default:return l}},V=l=>{switch(l){case"warn":return"âš ï¸ Warn";case"delete":return"ðŸ—‘ï¸ Delete";case"timeout":return"â±ï¸ Timeout";case"kick":return"ðŸ‘¢ Kick";case"ban":return"ðŸ”¨ Ban";default:return l}},W=l=>{switch(l){case"warn":return"âš ï¸";case"delete":return"ðŸ—‘ï¸";case"timeout":return"â±ï¸";case"ban":return"ðŸ”¨";default:return"â“"}},$=l=>({padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"600",backgroundColor:l==="ban"?"#ed4245":l==="timeout"?"#f0b132":"#5865f2",color:"#fff"}),e={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,backdropFilter:"blur(5px)"},panel:{backgroundColor:"#2b2d31",borderRadius:"12px",width:"90%",maxWidth:"1000px",maxHeight:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.5)",overflow:"hidden"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #1e1f22"},headerLeft:{display:"flex",alignItems:"center",gap:"12px"},headerIcon:{fontSize:"24px",color:"#5865f2"},title:{margin:0,color:"#fff",fontSize:"24px",fontWeight:"600"},closeButton:{background:"none",border:"none",color:"#b9bbbe",cursor:"pointer",fontSize:"24px",padding:"8px",borderRadius:"4px"},statsGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px",padding:"20px",borderBottom:"1px solid #1e1f22"},statCard:{backgroundColor:"#1e1f22",borderRadius:"8px",padding:"16px",textAlign:"center"},statIcon:{fontSize:"32px",marginBottom:"8px"},statValue:{fontSize:"32px",fontWeight:"bold",color:"#fff",marginBottom:"4px"},statLabel:{fontSize:"14px",color:"#b9bbbe"},section:{padding:"20px",borderBottom:"1px solid #1e1f22",overflowY:"auto"},sectionHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},sectionTitle:{color:"#fff",fontSize:"18px",fontWeight:"600",margin:0,display:"flex",alignItems:"center",gap:"8px"},addButton:{backgroundColor:"#5865f2",color:"#fff",border:"none",borderRadius:"6px",padding:"8px 16px",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",fontSize:"14px",fontWeight:"600"},loading:{textAlign:"center",color:"#b9bbbe",padding:"40px"},empty:{textAlign:"center",color:"#b9bbbe",padding:"40px",fontSize:"14px"},rulesList:{display:"flex",flexDirection:"column",gap:"12px"},ruleCard:{backgroundColor:"#1e1f22",borderRadius:"8px",padding:"16px"},ruleHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},ruleType:{display:"flex",alignItems:"center",gap:"8px",fontSize:"16px",fontWeight:"600",color:"#fff"},ruleActions:{display:"flex",alignItems:"center",gap:"12px"},switch:{position:"relative",display:"inline-block",width:"44px",height:"24px"},slider:{position:"absolute",cursor:"pointer",top:0,left:0,right:0,bottom:0,backgroundColor:"#72767d",transition:"0.3s",borderRadius:"24px"},deleteBtn:{background:"none",border:"none",color:"#ed4245",cursor:"pointer",fontSize:"18px",padding:"4px"},ruleDetails:{display:"flex",flexDirection:"column",gap:"8px"},ruleInfo:{display:"flex",gap:"8px",fontSize:"14px"},ruleLabel:{color:"#b9bbbe",fontWeight:"500"},ruleValue:{color:"#fff"},logsList:{display:"flex",flexDirection:"column",gap:"8px"},logItem:{display:"flex",alignItems:"center",gap:"12px",backgroundColor:"#1e1f22",borderRadius:"6px",padding:"12px"},logIcon:{fontSize:"24px"},logContent:{flex:1},logText:{color:"#fff",fontSize:"14px",marginBottom:"4px"},logMeta:{color:"#72767d",fontSize:"12px"},logAction:{marginLeft:"auto"},modalOverlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10001},modal:{backgroundColor:"#2b2d31",borderRadius:"12px",padding:"24px",width:"90%",maxWidth:"500px"},modalTitle:{color:"#fff",fontSize:"20px",marginBottom:"20px"},formGroup:{marginBottom:"16px"},label:{display:"block",color:"#b9bbbe",fontSize:"14px",marginBottom:"8px",fontWeight:"500"},select:{width:"100%",backgroundColor:"#1e1f22",border:"1px solid #1e1f22",borderRadius:"6px",padding:"10px",color:"#fff",fontSize:"14px"},input:{width:"100%",backgroundColor:"#1e1f22",border:"1px solid #1e1f22",borderRadius:"6px",padding:"10px",color:"#fff",fontSize:"14px"},modalButtons:{display:"flex",gap:"12px",justifyContent:"flex-end",marginTop:"20px"},cancelBtn:{backgroundColor:"#4e5058",color:"#fff",border:"none",borderRadius:"6px",padding:"10px 20px",cursor:"pointer",fontSize:"14px"},createBtn:{backgroundColor:"#5865f2",color:"#fff",border:"none",borderRadius:"6px",padding:"10px 20px",cursor:"pointer",fontSize:"14px",fontWeight:"600"}};export{K as default};
