var C=Object.defineProperty;var a=(m,h)=>C(m,"name",{value:h,configurable:!0});import{r as c,j as s}from"./react-core-Djgtqrmb.js";import{t as o}from"./index-DjBRFZUD.js";import"./media-vendor-CxFPycob.js";import"./router-vendor-gmJ9Mn-1.js";import"./state-vendor-BRqaXHJQ.js";import"./crypto-vendor-D1XRGppi.js";import"./icons-vendor-BMXAt4pj.js";import"./ui-vendor-IhB9Znpc.js";const L=a(({apiBaseUrl:m,onClose:h})=>{const[n,v]=c.useState([]),[f,x]=c.useState(!0),[l,p]=c.useState("all"),[_,k]=c.useState(null);c.useEffect(()=>{S()},[]);const S=a(async()=>{try{x(!0);const e=localStorage.getItem("access_token"),t=await fetch(`${m}/reports/list/`,{headers:{Authorization:`Bearer ${e}`}});if(t.ok){const r=await t.json();v(r.reports||[])}else o.error("‚ùå ≈ûikayetler y√ºklenemedi")}catch{o.error("‚ùå Baƒülantƒ± hatasƒ±")}finally{x(!1)}},"fetchReports"),u=a(async(e,t,r="")=>{try{const d=localStorage.getItem("access_token"),j=await fetch(`${m}/reports/handle/${e}/`,{method:"POST",headers:{Authorization:`Bearer ${d}`,"Content-Type":"application/json"},body:JSON.stringify({action:t,reason:r})});if(j.ok){const y=await j.json();v(n.map(N=>N.id===e?{...N,status:t==="dismiss"?"dismissed":"resolved",resolution:t}:N)),k(null),o.success(`‚úÖ ${b(t)}`)}else{const y=await j.json();o.error(`‚ùå ${y.error||"ƒ∞≈ülem ba≈üarƒ±sƒ±z"}`)}}catch{o.error("‚ùå Baƒülantƒ± hatasƒ±")}},"handleReport"),b=a(e=>({ban:"Kullanƒ±cƒ± yasaklandƒ±",warn:"Kullanƒ±cƒ± uyarƒ±ldƒ±",delete_message:"Mesaj silindi",dismiss:"≈ûikayet reddedildi"})[e]||"ƒ∞≈ülem tamamlandƒ±","getActionLabel"),g=n.filter(e=>l==="all"?!0:l==="pending"?e.status==="pending":l==="resolved"?e.status==="resolved":l==="dismissed"?e.status==="dismissed":!0),w=a(e=>({pending:{label:"Bekliyor",className:"status-pending"},resolved:{label:"√á√∂z√ºld√º",className:"status-resolved"},dismissed:{label:"Reddedildi",className:"status-dismissed"}})[e]||{label:e,className:""},"getStatusBadge"),R=a(e=>({spam:{label:"Spam",className:"severity-low"},harassment:{label:"Taciz",className:"severity-high"},hate_speech:{label:"Nefret S√∂ylemi",className:"severity-critical"},inappropriate:{label:"Uygunsuz ƒ∞√ßerik",className:"severity-medium"},scam:{label:"Dolandƒ±rƒ±cƒ±lƒ±k",className:"severity-high"},other:{label:"Diƒüer",className:"severity-low"}})[e]||{label:e,className:""},"getSeverityBadge"),B=a(e=>new Date(e).toLocaleString("tr-TR",{day:"2-digit",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}),"formatDate"),i={total:n.length,pending:n.filter(e=>e.status==="pending").length,resolved:n.filter(e=>e.status==="resolved").length,dismissed:n.filter(e=>e.status==="dismissed").length};return s.jsx("div",{className:"reports-overlay",onClick:h,children:s.jsxs("div",{className:"reports-panel",onClick:a(e=>e.stopPropagation(),"onClick"),children:[s.jsxs("div",{className:"reports-header",children:[s.jsx("h2",{children:"üö® ≈ûikayet Y√∂netimi"}),s.jsx("button",{className:"close-btn",onClick:h,children:"‚úï"})]}),s.jsxs("div",{className:"reports-stats",children:[s.jsxs("div",{className:"stat-item",children:[s.jsx("span",{className:"stat-value",children:i.total}),s.jsx("span",{className:"stat-label",children:"Toplam"})]}),s.jsxs("div",{className:"stat-item pending",children:[s.jsx("span",{className:"stat-value",children:i.pending}),s.jsx("span",{className:"stat-label",children:"Bekliyor"})]}),s.jsxs("div",{className:"stat-item resolved",children:[s.jsx("span",{className:"stat-value",children:i.resolved}),s.jsx("span",{className:"stat-label",children:"√á√∂z√ºld√º"})]}),s.jsxs("div",{className:"stat-item dismissed",children:[s.jsx("span",{className:"stat-value",children:i.dismissed}),s.jsx("span",{className:"stat-label",children:"Reddedildi"})]})]}),s.jsxs("div",{className:"reports-filters",children:[s.jsxs("button",{className:l==="all"?"active":"",onClick:a(()=>p("all"),"onClick"),children:["T√ºm√º (",i.total,")"]}),s.jsxs("button",{className:l==="pending"?"active":"",onClick:a(()=>p("pending"),"onClick"),children:["Bekliyor (",i.pending,")"]}),s.jsxs("button",{className:l==="resolved"?"active":"",onClick:a(()=>p("resolved"),"onClick"),children:["√á√∂z√ºld√º (",i.resolved,")"]}),s.jsxs("button",{className:l==="dismissed"?"active":"",onClick:a(()=>p("dismissed"),"onClick"),children:["Reddedildi (",i.dismissed,")"]})]}),s.jsx("div",{className:"reports-content",children:f?s.jsxs("div",{className:"loading-state",children:[s.jsx("div",{className:"spinner"}),s.jsx("p",{children:"Y√ºkleniyor..."})]}):g.length===0?s.jsxs("div",{className:"empty-state",children:[s.jsx("div",{className:"empty-icon",children:"üéâ"}),s.jsx("h3",{children:"≈ûikayet yok"}),s.jsx("p",{children:"Bu filtre i√ßin ≈üikayet bulunamadƒ±"})]}):s.jsx("div",{className:"reports-list",children:g.map(e=>{const t=w(e.status),r=R(e.reason);return s.jsxs("div",{className:"report-card",children:[s.jsxs("div",{className:"report-header",children:[s.jsxs("div",{className:"report-meta",children:[s.jsx("span",{className:`status-badge ${t.className}`,children:t.label}),s.jsx("span",{className:`severity-badge ${r.className}`,children:r.label})]}),s.jsx("span",{className:"report-date",children:B(e.created_at)})]}),s.jsxs("div",{className:"report-body",children:[s.jsxs("div",{className:"report-info",children:[s.jsxs("div",{className:"info-row",children:[s.jsx("span",{className:"info-label",children:"Bildiren:"}),s.jsxs("span",{className:"info-value",children:["üë§ ",e.reporter_username]})]}),s.jsxs("div",{className:"info-row",children:[s.jsx("span",{className:"info-label",children:"Bildirilen:"}),s.jsxs("span",{className:"info-value",children:["‚ö†Ô∏è ",e.reported_user_username]})]}),e.message_content&&s.jsxs("div",{className:"info-row",children:[s.jsx("span",{className:"info-label",children:"Mesaj:"}),s.jsx("div",{className:"message-preview",children:e.message_content})]})]}),e.description&&s.jsxs("div",{className:"report-description",children:[s.jsx("strong",{children:"A√ßƒ±klama:"}),s.jsx("p",{children:e.description})]})]}),e.status==="pending"?s.jsxs("div",{className:"report-actions",children:[s.jsx("button",{className:"action-btn ban",onClick:a(()=>{const d=prompt("Yasaklama sebebi:");d&&u(e.id,"ban",d)},"onClick"),title:"Kullanƒ±cƒ±yƒ± Yasakla",children:"üö´ Yasakla"}),s.jsx("button",{className:"action-btn warn",onClick:a(()=>u(e.id,"warn","Uyarƒ± verildi"),"onClick"),title:"Kullanƒ±cƒ±yƒ± Uyar",children:"‚ö†Ô∏è Uyar"}),s.jsx("button",{className:"action-btn delete",onClick:a(()=>u(e.id,"delete_message","Mesaj silindi"),"onClick"),title:"Mesajƒ± Sil",children:"üóëÔ∏è Mesajƒ± Sil"}),s.jsx("button",{className:"action-btn dismiss",onClick:a(()=>u(e.id,"dismiss","Ge√ßersiz ≈üikayet"),"onClick"),title:"≈ûikayeti Reddet",children:"‚úï Reddet"})]}):s.jsxs("div",{className:"report-resolution",children:[s.jsx("span",{className:"resolution-label",children:"√á√∂z√ºm:"}),s.jsx("span",{className:"resolution-value",children:b(e.resolution)})]})]},e.id)})})})]})})},"ReportsPanel");export{L as default};
