import{r,n as e}from"./react-core-BMiyQWF6.js";import{y as n}from"./ui-vendor-6RMGJYFH.js";import{g as B}from"./index-5Qs4G3EW.js";import"./editor-vendor-D9c4a6XZ.js";import"./media-vendor-BuSyE8vR.js";import"./router-vendor-B86Z1mIL.js";import"./icons-vendor-GUGjkvMm.js";import"./state-vendor-CAyNnPM4.js";import"./crypto-vendor-1Q6e4ZD-.js";const Y=({serverId:c,onClose:x})=>{const o=B(),[j,v]=r.useState([]),[b,g]=r.useState([]),[N,k]=r.useState(!0),[d,p]=r.useState(!1),[a,i]=r.useState({title:"",description:"",color:"#5865f2",thumbnail:"",image:"",author_name:"",author_icon:"",footer_text:"",footer_icon:"",fields:[]}),[m,y]=r.useState("");r.useEffect(()=>{h(),_()},[c]);const h=async()=>{try{const s=await fetch(`${o}/custom-embeds/server/${c}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(s.ok){const t=await s.json();v(t)}}catch{}finally{k(!1)}},_=async()=>{try{const s=await fetch(`${o}/channels/server/${c}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(s.ok){const t=await s.json();g(t.filter(l=>l.type==="text"))}}catch{}},C=async()=>{if(!a.title&&!a.description){n.error("âŒ En az baÅŸlÄ±k veya aÃ§Ä±klama gerekli");return}try{(await fetch(`${o}/custom-embeds/save/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`,"Content-Type":"application/json"},body:JSON.stringify({server_id:c,...a})})).ok?(n.success("âœ… Embed kaydedildi"),p(!1),h(),$()):n.error("âŒ Kaydetme hatasÄ±")}catch{n.error("âŒ BaÄŸlantÄ± hatasÄ±")}},E=async s=>{if(!m){n.error("âŒ LÃ¼tfen bir kanal seÃ§in");return}try{(await fetch(`${o}/custom-embeds/${s}/send/`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`,"Content-Type":"application/json"},body:JSON.stringify({channel_id:m})})).ok?n.success("âœ… Embed gÃ¶nderildi"):n.error("âŒ GÃ¶nderim hatasÄ±")}catch{n.error("âŒ BaÄŸlantÄ± hatasÄ±")}},S=async s=>{if(window.confirm("Embed'i silmek istediÄŸinize emin misiniz?"))try{(await fetch(`${o}/custom-embeds/${s}/delete/`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}})).ok&&(n.success("âœ… Embed silindi"),h())}catch{n.error("âŒ Silme hatasÄ±")}},w=()=>{i({...a,fields:[...a.fields,{name:"",value:"",inline:!1}]})},u=(s,t,l)=>{const f=[...a.fields];f[s][t]=l,i({...a,fields:f})},z=s=>{i({...a,fields:a.fields.filter((t,l)=>l!==s)})},$=()=>{i({title:"",description:"",color:"#5865f2",thumbnail:"",image:"",author_name:"",author_icon:"",footer_text:"",footer_icon:"",fields:[]})};return e.jsx("div",{className:"custom-embed-overlay",onClick:x,children:e.jsxs("div",{className:"custom-embed-panel",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"custom-embed-header",children:[e.jsx("h2",{children:"ğŸ“ Ã–zel Embed OluÅŸturucu"}),e.jsx("button",{className:"close-btn",onClick:x,children:"Ã—"})]}),e.jsxs("div",{className:"custom-embed-content",children:[e.jsx("button",{className:"create-embed-btn",onClick:()=>p(!d),children:d?"âŒ DÃ¼zenleyiciyi Kapat":"+ Yeni Embed OluÅŸtur"}),d&&e.jsxs("div",{className:"embed-editor",children:[e.jsxs("div",{className:"editor-form",children:[e.jsxs("div",{className:"form-section",children:[e.jsx("h3",{children:"Yazar"}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Ä°sim"}),e.jsx("input",{value:a.author_name,onChange:s=>i({...a,author_name:s.target.value}),placeholder:"Yazar adÄ±"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Ä°kon URL"}),e.jsx("input",{value:a.author_icon,onChange:s=>i({...a,author_icon:s.target.value}),placeholder:"https://..."})]})]})]}),e.jsxs("div",{className:"form-section",children:[e.jsx("h3",{children:"Ä°Ã§erik"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"BaÅŸlÄ±k"}),e.jsx("input",{value:a.title,onChange:s=>i({...a,title:s.target.value}),placeholder:"Embed baÅŸlÄ±ÄŸÄ±"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"AÃ§Ä±klama"}),e.jsx("textarea",{value:a.description,onChange:s=>i({...a,description:s.target.value}),rows:"4",placeholder:"Embed aÃ§Ä±klamasÄ±"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Renk"}),e.jsx("input",{type:"color",value:a.color,onChange:s=>i({...a,color:s.target.value})})]})]}),e.jsxs("div",{className:"form-section",children:[e.jsx("h3",{children:"GÃ¶rseller"}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"KÃ¼Ã§Ã¼k Resim URL"}),e.jsx("input",{value:a.thumbnail,onChange:s=>i({...a,thumbnail:s.target.value}),placeholder:"https://..."})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"BÃ¼yÃ¼k Resim URL"}),e.jsx("input",{value:a.image,onChange:s=>i({...a,image:s.target.value}),placeholder:"https://..."})]})]})]}),e.jsxs("div",{className:"form-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h3",{children:"Alanlar"}),e.jsx("button",{className:"add-field-btn",onClick:w,children:"+ Alan Ekle"})]}),a.fields.map((s,t)=>e.jsx("div",{className:"field-item",children:e.jsxs("div",{className:"field-inputs",children:[e.jsx("input",{value:s.name,onChange:l=>u(t,"name",l.target.value),placeholder:"Alan adÄ±"}),e.jsx("input",{value:s.value,onChange:l=>u(t,"value",l.target.value),placeholder:"Alan deÄŸeri"}),e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:s.inline,onChange:l=>u(t,"inline",l.target.checked)}),e.jsx("span",{children:"Inline"})]}),e.jsx("button",{className:"remove-field-btn",onClick:()=>z(t),children:"ğŸ—‘ï¸"})]})},t))]}),e.jsxs("div",{className:"form-section",children:[e.jsx("h3",{children:"Footer"}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Metin"}),e.jsx("input",{value:a.footer_text,onChange:s=>i({...a,footer_text:s.target.value}),placeholder:"Footer metni"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Ä°kon URL"}),e.jsx("input",{value:a.footer_icon,onChange:s=>i({...a,footer_icon:s.target.value}),placeholder:"https://..."})]})]})]}),e.jsx("button",{className:"save-embed-btn",onClick:C,children:"ğŸ’¾ Kaydet"})]}),e.jsxs("div",{className:"embed-preview",children:[e.jsx("h3",{children:"Ã–nizleme"}),e.jsxs("div",{className:"discord-embed",style:{borderLeftColor:a.color},children:[a.author_name&&e.jsxs("div",{className:"embed-author",children:[a.author_icon&&e.jsx("img",{src:a.author_icon,alt:""}),e.jsx("span",{children:a.author_name})]}),a.title&&e.jsx("div",{className:"embed-title",children:a.title}),a.description&&e.jsx("div",{className:"embed-description",children:a.description}),a.fields.length>0&&e.jsx("div",{className:"embed-fields",children:a.fields.map((s,t)=>e.jsxs("div",{className:`embed-field ${s.inline?"inline":""}`,children:[e.jsx("div",{className:"field-name",children:s.name}),e.jsx("div",{className:"field-value",children:s.value})]},t))}),a.image&&e.jsx("img",{className:"embed-image",src:a.image,alt:""}),a.footer_text&&e.jsxs("div",{className:"embed-footer",children:[a.footer_icon&&e.jsx("img",{src:a.footer_icon,alt:""}),e.jsx("span",{children:a.footer_text})]})]})]})]}),N?e.jsxs("div",{className:"loading-state",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{children:"YÃ¼kleniyor..."})]}):j.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("span",{className:"empty-icon",children:"ğŸ“"}),e.jsx("p",{children:"HenÃ¼z kayÄ±tlÄ± embed yok"})]}):e.jsx("div",{className:"embeds-list",children:j.map(s=>e.jsxs("div",{className:"embed-card",children:[e.jsxs("div",{className:"embed-info",children:[e.jsx("h4",{children:s.title||"BaÅŸlÄ±ksÄ±z Embed"}),e.jsxs("p",{children:[s.description?.substring(0,100),s.description?.length>100?"...":""]})]}),e.jsxs("div",{className:"embed-actions",children:[e.jsxs("select",{value:m,onChange:t=>y(t.target.value),children:[e.jsx("option",{value:"",children:"Kanal seÃ§"}),b.map(t=>e.jsxs("option",{value:t.id,children:["# ",t.name]},t.id))]}),e.jsx("button",{onClick:()=>E(s.id),children:"ğŸ“¤ GÃ¶nder"}),e.jsx("button",{onClick:()=>S(s.id),children:"ğŸ—‘ï¸"})]})]},s.id))})]})]})})};export{Y as default};
