import{r as d,n as e}from"./react-core-BMiyQWF6.js";import{bB as x,a as h,bC as v,D as b,s as j,aJ as S,aI as k}from"./icons-vendor-GUGjkvMm.js";import{t as o}from"./index-Tex9oDNg.js";import"./editor-vendor-D9c4a6XZ.js";import"./media-vendor-BuSyE8vR.js";import"./router-vendor-B86Z1mIL.js";import"./state-vendor-CAyNnPM4.js";import"./crypto-vendor-1Q6e4ZD-.js";const A=({fetchWithAuth:r,apiBaseUrl:l,onClose:p})=>{const[n,f]=d.useState([]),[u,c]=d.useState(!1);d.useEffect(()=>{a()},[]);const a=async()=>{c(!0);try{const i=await(await r(`${l}/sessions/list/`)).json();f(i.sessions||[])}catch{o.error("Failed to load sessions")}finally{c(!1)}},y=async t=>{if(confirm("Are you sure you want to sign out this device?"))try{await r(`${l}/sessions/revoke/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_id:t})}),o.success("Session revoked successfully"),a()}catch{o.error("Failed to revoke session")}},g=async()=>{if(confirm("This will sign you out from ALL devices except this one. Continue?"))try{await r(`${l}/security/sessions/revoke-all/`,{method:"POST"}),o.success("All other sessions revoked"),a()}catch{o.error("Failed to revoke sessions")}},m=t=>{switch(t){case"mobile":return e.jsx(k,{style:{fontSize:"24px",color:"#5865f2"}});case"tablet":return e.jsx(S,{style:{fontSize:"24px",color:"#5865f2"}});default:return e.jsx(x,{style:{fontSize:"24px",color:"#5865f2"}})}};return e.jsx("div",{style:s.overlay,children:e.jsxs("div",{style:s.modal,children:[e.jsxs("div",{style:s.header,children:[e.jsxs("div",{style:s.headerLeft,children:[e.jsx(x,{style:{marginRight:"10px",color:"#5865f2"}}),e.jsx("h2",{style:s.title,children:"Active Sessions"})]}),e.jsx("button",{onClick:p,style:s.closeButton,children:e.jsx(h,{})})]}),e.jsxs("div",{style:s.toolbar,children:[e.jsxs("div",{style:s.sessionCount,children:[n.length," active ",n.length===1?"session":"sessions"]}),e.jsx("button",{onClick:g,style:s.revokeAllButton,children:"Sign Out All Other Devices"})]}),e.jsx("div",{style:s.content,children:u?e.jsx("div",{style:s.loading,children:"Loading sessions..."}):n.length===0?e.jsx("div",{style:s.empty,children:"No active sessions found"}):e.jsx("div",{style:s.sessionsList,children:n.map((t,i)=>e.jsxs("div",{style:{...s.sessionCard,...t.is_current&&s.currentSession},children:[e.jsx("div",{style:s.sessionIcon,children:m(t.device_type)}),e.jsxs("div",{style:s.sessionInfo,children:[e.jsxs("div",{style:s.sessionDevice,children:[t.device_name||"Unknown Device",t.is_current&&e.jsx("span",{style:s.currentBadge,children:"Current Session"})]}),e.jsxs("div",{style:s.sessionDetails,children:[e.jsxs("div",{style:s.detailItem,children:[e.jsx(v,{style:{marginRight:"5px",fontSize:"12px"}}),t.location||"Unknown Location"]}),e.jsxs("div",{style:s.detailItem,children:[e.jsx(b,{style:{marginRight:"5px",fontSize:"12px"}}),"Last active: ",new Date(t.last_activity).toLocaleString()]}),t.ip_address&&e.jsxs("div",{style:s.detailItem,children:["IP: ",t.ip_address]})]})]}),!t.is_current&&e.jsx("button",{onClick:()=>y(t.id),style:s.revokeButton,title:"Sign Out",children:e.jsx(j,{})})]},i))})})]})})},s={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999},modal:{backgroundColor:"#1e1e1e",borderRadius:"8px",width:"90%",maxWidth:"700px",maxHeight:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #2c2f33"},headerLeft:{display:"flex",alignItems:"center"},title:{margin:0,fontSize:"20px",color:"#ffffff"},closeButton:{background:"none",border:"none",color:"#99aab5",cursor:"pointer",fontSize:"20px",padding:"5px"},toolbar:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"15px 20px",borderBottom:"1px solid #2c2f33"},sessionCount:{fontSize:"14px",color:"#dcddde"},revokeAllButton:{padding:"8px 16px",backgroundColor:"#f04747",border:"none",borderRadius:"4px",color:"#ffffff",cursor:"pointer",fontSize:"13px",fontWeight:"500"},content:{padding:"20px",overflowY:"auto",flex:1},loading:{textAlign:"center",color:"#99aab5",padding:"40px"},empty:{textAlign:"center",color:"#99aab5",padding:"40px"},sessionsList:{display:"flex",flexDirection:"column",gap:"16px"},sessionCard:{backgroundColor:"#2c2f33",borderRadius:"8px",padding:"16px",display:"flex",gap:"16px",alignItems:"flex-start"},currentSession:{border:"2px solid #43b581"},sessionIcon:{minWidth:"40px",display:"flex",alignItems:"center",justifyContent:"center"},sessionInfo:{flex:1},sessionDevice:{fontSize:"16px",fontWeight:"600",color:"#ffffff",marginBottom:"8px",display:"flex",alignItems:"center",gap:"12px"},currentBadge:{fontSize:"11px",padding:"4px 8px",backgroundColor:"#43b581",borderRadius:"4px",fontWeight:"600"},sessionDetails:{display:"flex",flexDirection:"column",gap:"4px"},detailItem:{fontSize:"13px",color:"#99aab5",display:"flex",alignItems:"center"},revokeButton:{background:"none",border:"none",color:"#f04747",cursor:"pointer",fontSize:"18px",padding:"8px"}};export{A as default};
