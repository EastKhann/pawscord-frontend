import{b as I,r as n,j as t}from"./react-vendor-D8Fi5F9E.js";const S=({stream:i,isMirrored:o,objectFit:s="cover",muted:u=!1})=>{const a=n.useRef(null);return n.useEffect(()=>(a.current&&i&&(a.current.srcObject=i,console.log("üé• Video stream attached:",i.id),a.current.onloadedmetadata=()=>{console.log("‚úÖ Video metadata loaded"),a.current.play().catch(d=>{console.error("‚ùå Video play error:",d)})}),()=>{a.current&&(a.current.srcObject=null)}),[i]),t.jsx("video",{ref:a,style:{...r.videoElement,transform:o?"scaleX(-1)":"none",objectFit:s},autoPlay:!0,playsInline:!0,muted:!0})},z=({id:i,user:o,track:s,streamType:u,avatarUrl:a,isLocal:d,onClick:h,style:v,lastReaction:c,gameMove:x})=>{const m=n.useRef(null),[p,g]=n.useState(!1),b=n.useMemo(()=>s&&s.kind==="video"?new MediaStream([s]):null,[s]),y=e=>{e.stopPropagation(),m.current&&(document.fullscreenElement?document.exitFullscreen().then(()=>{g(!1)}):m.current.requestFullscreen().then(()=>{g(!0)}).catch(l=>{console.error("Tam ekran hatasƒ±:",l)}))};n.useEffect(()=>{const e=()=>{g(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",e),()=>document.removeEventListener("fullscreenchange",e)},[]);const[j,f]=n.useState([]);n.useEffect(()=>{if(c&&c.username===o.username){const e=Date.now()+Math.random();f(l=>[...l,{id:e,emoji:c.emoji}]),setTimeout(()=>{f(l=>l.filter(E=>E.id!==e))},2e3)}},[c,o.username]);const w=d&&u==="camera",k=d?`${o.username} (Siz)`:o.username,C=o.is_talking?"talking-border talking-pulse":"";return t.jsxs("div",{ref:m,className:C,style:{...r.containerOuter,cursor:"pointer",border:o.is_talking?"none":"1px solid rgba(0,0,0,0.2)",...p&&{width:"100vw",height:"100vh",maxWidth:"none",paddingBottom:0},...v},onClick:()=>h&&h(i),children:[t.jsx("style",{children:`
                @keyframes floatUp {
                    0% { transform: translateY(0) scale(0.5); opacity: 0; }
                    20% { opacity: 1; transform: translateY(-20px) scale(1.2); }
                    100% { transform: translateY(-100px) scale(1); opacity: 0; }
                }
            `}),t.jsxs("div",{style:{...r.aspectRatioWrapper,height:p?"100%":r.aspectRatioWrapper.height},children:[b?t.jsxs("div",{style:r.videoFull,children:[t.jsx(S,{stream:b,isMirrored:w,objectFit:"cover"}),t.jsx("button",{onClick:y,style:{position:"absolute",top:"8px",right:"8px",backgroundColor:"rgba(0,0,0,0.7)",border:"1px solid rgba(255,255,255,0.2)",color:"white",borderRadius:"6px",padding:"6px 10px",cursor:"pointer",fontSize:"14px",zIndex:15,backdropFilter:"blur(4px)",transition:"all 0.2s",display:"flex",alignItems:"center",gap:"4px"},onMouseEnter:e=>e.target.style.backgroundColor="rgba(88, 101, 242, 0.8)",onMouseLeave:e=>e.target.style.backgroundColor="rgba(0,0,0,0.7)",title:p?"Tam Ekrandan √áƒ±k (ESC)":"Tam Ekran",children:p?"üîô":"üî≥"}),t.jsx("div",{style:r.label,children:u==="screen"?"üñ•Ô∏è":"üì∑"})]}):t.jsxs("div",{style:r.avatarPlaceholder,children:[t.jsx("img",{src:a||"https://media.pawscord.com/assets/logo.png",style:{...r.avatarImage,border:o.is_talking?"3px solid #3ba55c":"2px solid #202225",transform:o.is_talking?"scale(1.1)":"scale(1)",transition:"all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275)"},alt:o.username,onError:e=>{e.target.onerror=null,e.target.src="https://media.pawscord.com/assets/logo.png"}}),t.jsx("div",{style:r.micStatus,children:o.is_deafened?"üîï":o.is_mic_off?"üîá":o.is_talking?"üîä":"üé§"})]}),t.jsx("div",{style:{position:"absolute",bottom:"10px",right:"10px",pointerEvents:"none",zIndex:20},children:j.map(e=>t.jsx("div",{style:{position:"absolute",bottom:0,right:0+Math.random()*20,fontSize:"32px",animation:"floatUp 2s ease-out forwards"},children:e.emoji},e.id))}),x&&t.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"64px",filter:"drop-shadow(0 0 10px rgba(0,0,0,0.8))",zIndex:30,animation:"popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)"},children:x==="rock"?"ü™®":x==="paper"?"üìÑ":"‚úÇÔ∏è"}),t.jsx("style",{children:`
                    @keyframes popIn {
                        from { transform: translate(-50%, -50%) scale(0); opacity: 0; }
                        to { transform: translate(-50%, -50%) scale(1); opacity: 1; }
                    }
                `}),t.jsx("div",{style:r.usernameOverlay,children:t.jsx("span",{children:k})})]})]})},r={containerOuter:{flexGrow:1,borderRadius:"12px",overflow:"hidden",backgroundColor:"#2b2d31",boxShadow:"0 4px 15px rgba(0,0,0,0.4)",transition:"all 0.2s ease-in-out",position:"relative",width:"100%",paddingBottom:"56.25%",minWidth:"200px"},aspectRatioWrapper:{position:"absolute",top:0,left:0,width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, rgba(255,255,255,0.05) 0%, rgba(255,255,255,0) 100%)",overflow:"hidden"},videoFull:{position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundColor:"#000",overflow:"hidden"},videoElement:{width:"100%",height:"100%",objectFit:"cover",position:"relative",zIndex:2,display:"block"},avatarPlaceholder:{position:"absolute",top:0,left:0,width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#1e1f22"},avatarImage:{width:"65px",height:"65px",objectFit:"cover",borderRadius:"50%",boxShadow:"0 5px 15px rgba(0,0,0,0.5)"},usernameOverlay:{position:"absolute",bottom:"8px",left:"8px",backgroundColor:"rgba(0,0,0,0.7)",backdropFilter:"blur(4px)",color:"white",padding:"4px 8px",borderRadius:"6px",fontSize:"0.75em",zIndex:10,fontWeight:"bold",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"85%",border:"1px solid rgba(255,255,255,0.1)"},label:{position:"absolute",top:"8px",right:"8px",backgroundColor:"rgba(0,0,0,0.6)",color:"white",padding:"4px",borderRadius:"4px",fontSize:"0.8em",zIndex:1},micStatus:{position:"absolute",bottom:"8px",right:"8px",fontSize:"1.1em",zIndex:10,backgroundColor:"rgba(0, 0, 0, 0.6)",padding:"4px",borderRadius:"50%",width:"24px",height:"24px",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(4px)",border:"1px solid rgba(255,255,255,0.1)"}},R=I.memo(z);export{R as default};
