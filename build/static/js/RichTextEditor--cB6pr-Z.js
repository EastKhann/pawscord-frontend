var I=Object.defineProperty;var i=(s,l)=>I(s,"name",{value:l,configurable:!0});import{r as o,j as t}from"./react-core-Djgtqrmb.js";import{u as M,i as F,a as W,E as v}from"./editor-vendor-HPqCJnoE.js";import{b6 as w,b7 as j,aD as A,b8 as k,b9 as E,q as L,s as T,aJ as K}from"./icons-vendor-BW7dxHkX.js";import"./chart-vendor-HLiKYU_V.js";import"./ui-vendor-IhB9Znpc.js";const D=[{name:"zar-at",description:"1-100 arası zar at",icon:t.jsx(j,{})},{name:"yazitura",description:"Yazı tura at",icon:t.jsx(A,{})},{name:"tkm",description:"Taş Kağıt Makas oyna (@kullanici)",icon:t.jsx(k,{})},{name:"xox",description:"XOX oyunu başlat",icon:t.jsx(j,{})},{name:"sec",description:"Seçeneklerden birini seç (/sec a b c)",icon:t.jsx(w,{})},{name:"cuzdan",description:"Coin bakiyeni gör",icon:t.jsx(E,{})},{name:"transfer",description:"Coin gönder (/transfer @kullanici miktar)",icon:t.jsx(E,{})},{name:"kanban",description:"Kanban panosunu aç",icon:t.jsx(j,{})},{name:"kod",description:"Python kodu çalıştır",icon:t.jsx(L,{})},{name:"resimgelismis",description:"AI ile resim çiz",icon:t.jsx(k,{})},{name:"temizle",description:"Mesajları sil (Admin)",icon:t.jsx(T,{}),adminOnly:!0},{name:"yardim",description:"Komut listesini gör",icon:t.jsx(w,{})},{name:"tema",description:"Tema Mağazasını Aç",icon:t.jsx(j,{})},{name:"duyuru",description:"Sabit Duyuru Yap (/duyuru mesaj)",icon:t.jsx(T,{}),adminOnly:!0},{name:"sablon",description:"Hazır Şablonlar",icon:t.jsx(K,{})},{name:"shrug",description:"¯\\_(ツ)_/¯ gönder",icon:t.jsx(k,{})}],O=i(({query:s,onSelect:l,activeIndex:b})=>{const[u,g]=o.useState([]);return o.useEffect(()=>{if(s==null)return;const c=s.toLowerCase().replace("/",""),a=D.filter(m=>m.name.toLowerCase().startsWith(c));g(a)},[s]),u.length===0?null:t.jsxs("div",{style:h.container,children:[t.jsxs("div",{style:h.header,children:[t.jsx(w,{style:{marginRight:6}}),"KOMUTLAR"]}),t.jsx("div",{style:h.list,children:u.map((c,a)=>t.jsxs("div",{onClick:i(()=>l(c),"onClick"),style:{...h.item,backgroundColor:a===b?"#5865f2":"transparent"},children:[t.jsx("div",{style:h.iconWrapper,children:c.icon}),t.jsxs("div",{style:h.textWrapper,children:[t.jsxs("span",{style:{fontWeight:"bold",color:"white"},children:["/",c.name]}),t.jsx("span",{style:{fontSize:"0.85em",color:a===b?"#eee":"#b9bbbe",marginLeft:8},children:c.description})]})]},c.name))})]})},"SlashCommandList"),h={container:{position:"absolute",bottom:"100%",left:0,width:"300px",maxHeight:"300px",backgroundColor:"#2f3136",borderRadius:"8px",boxShadow:"0 -4px 15px rgba(0,0,0,0.4)",display:"flex",flexDirection:"column",marginBottom:"10px",overflow:"hidden",zIndex:1e3,border:"1px solid rgba(255,255,255,0.05)"},header:{padding:"8px 12px",fontSize:"0.75em",fontWeight:"bold",color:"#b9bbbe",backgroundColor:"#202225",borderBottom:"1px solid rgba(255,255,255,0.05)",display:"flex",alignItems:"center",letterSpacing:"0.5px"},list:{overflowY:"auto",padding:"0"},item:{display:"flex",alignItems:"center",padding:"10px 12px",cursor:"pointer",transition:"background-color 0.1s"},iconWrapper:{display:"flex",alignItems:"center",justifyContent:"center",width:"24px",height:"24px",marginRight:"10px",color:"white",fontSize:"1.1em"},textWrapper:{display:"flex",alignItems:"center",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}},N=o.forwardRef(({onSend:s,onChange:l,placeholder:b,initialValue:u="",onFileUpload:g},c)=>{const a=o.useRef(!1),[m,x]=o.useState(null),[S,C]=o.useState(0),e=M({extensions:[F,W.configure({placeholder:b||"Bir mesaj yaz..."})],content:u,editorProps:{handlePaste:i((r,n,d)=>{const f=n.clipboardData?.items;if(f&&g)for(let p=0;p<f.length;p++){const y=f[p];if(y.kind==="file"){n.preventDefault();const z=y.getAsFile();return z&&g(z),!0}}return!1},"handlePaste"),handleKeyDown:i((r,n)=>{if(m!==null){if(n.key==="ArrowUp")return n.preventDefault(),C(d=>Math.max(0,d-1)),!0;if(n.key==="ArrowDown")return n.preventDefault(),C(d=>d+1),!0;if(n.key==="Enter"){n.preventDefault();const d=m.toLowerCase().replace("/",""),f=D.filter(p=>p.name.toLowerCase().startsWith(d));if(f.length>0){const p=Math.max(0,Math.min(S,f.length-1)),y=f[p];e.commands.setContent(`/${y.name} `),e.commands.focus("end"),x(null)}return!0}if(n.key==="Escape")return n.preventDefault(),x(null),!0}if(n.key==="Enter"&&!n.shiftKey){if(n.preventDefault(),m!==null)return!0;const d=r.state.doc.textContent;return d.trim().length>0&&(a.current=!0,s(d),e.commands.clearContent(),l?.(""),setTimeout(()=>{a.current=!1},100)),!0}return!1},"handleKeyDown")}});o.useEffect(()=>{if(!e)return;const r=i(()=>{if(a.current)return;const n=e.getText().trim();n.startsWith("/")?n.includes(" ")?x(null):(x(n),C(0)):m!==null&&x(null),l?.(n)},"handler");return e.on("update",r),()=>e.off("update",r)},[e,l]),o.useEffect(()=>{if(!e)return;const r=e.getText();u===""&&r!==""?e.commands.clearContent():u!==""&&r===""&&e.commands.setContent(u)},[e,u]);const R=o.useCallback(()=>{e&&e.chain().focus().run()},[e]);return o.useImperativeHandle(c,()=>({send:i(()=>{if(!e)return;const r=e.getText().trim();r&&(a.current=!0,s(r),e.commands.clearContent(),l?.(""),setTimeout(()=>{a.current=!1},100))},"send"),clear:i(()=>e?.commands.clearContent(),"clear"),hasContent:i(()=>!!e?.getText().trim(),"hasContent"),appendText:i(r=>{!e||!r||e.chain().focus().insertContent(r).run()},"appendText")}),[e,s,l]),e?t.jsxs("div",{className:"rich-editor-wrapper",onClick:R,role:"textbox","aria-label":"Mesaj editörü",children:[t.jsx(v,{editor:e,className:"tiptap-editor"}),m!==null&&t.jsx(O,{query:m,activeIndex:S,onSelect:i(r=>{e&&(e.commands.setContent(`/${r.name} `),e.commands.focus("end"),x(null))},"onSelect")})]}):null});N.displayName="RichTextEditor";export{N as default};
