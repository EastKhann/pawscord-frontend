import{r as l,b as e}from"./react-core-9vc7GIjk.js";import{R as b,bk as w,a as _,bs as i,bt as f,b7 as v,_ as C,O as F,p as A,z as $,aO as x,E as S,b1 as L,b2 as M,b$ as T}from"./icons-vendor-NoxEirJf.js";import{g as D}from"./index-DR3ngHaW.js";import"./editor-vendor-DiU449Dh.js";import"./media-vendor-B-uSUaIv.js";import"./router-vendor-u6fxj6P4.js";import"./crypto-vendor-C1qXRpJv.js";import"./state-vendor-0vlBuk0v.js";const z=({serverId:o,onClose:c,fetchWithAuth:d})=>{const[s,r]=l.useState(null),[h,u]=l.useState(!0),[n,N]=l.useState(null),[m,g]=l.useState("week"),E=l.useCallback(async()=>{u(!0);try{const a=await d(`${D()}/servers/${o}/channel-analytics/?range=${m}`);if(a.ok){const t=await a.json();r(t)}else r({summary:{total_channels:24,active_channels:18,total_messages:45823,average_response_time:2.4},channels:[{id:1,name:"general",type:"text",messages:12450,active_users:234,growth:15.2,peak_hour:20},{id:2,name:"announcements",type:"text",messages:856,active_users:512,growth:8.4,peak_hour:12},{id:3,name:"memes",type:"text",messages:8932,active_users:189,growth:22.1,peak_hour:22},{id:4,name:"gaming",type:"text",messages:6721,active_users:145,growth:-3.2,peak_hour:21},{id:5,name:"music",type:"voice",messages:0,active_users:67,growth:5.8,peak_hour:19},{id:6,name:"help",type:"text",messages:3421,active_users:98,growth:0,peak_hour:14}],peak_hours:[{hour:20,activity:100},{hour:21,activity:95},{hour:22,activity:88},{hour:19,activity:82},{hour:18,activity:75}],engagement_rate:76.4})}catch(a){console.error("Error loading analytics:",a),r({summary:{},channels:[],peak_hours:[]})}u(!1)},[o,m,d]);l.useEffect(()=>{E()},[E]);const p=a=>a>=1e6?(a/1e6).toFixed(1)+"M":a>=1e3?(a/1e3).toFixed(1)+"K":a?.toString()||"0",y=a=>a>0?e.createElement(L,{className:"growth-up"}):a<0?e.createElement(M,{className:"growth-down"}):e.createElement(T,{className:"growth-neutral"}),k=a=>a==="voice"?e.createElement(S,null):e.createElement(i,null);return h?e.createElement("div",{className:"channel-analytics-overlay",onClick:c},e.createElement("div",{className:"channel-analytics-panel",onClick:a=>a.stopPropagation()},e.createElement("div",{className:"loading-state"},e.createElement(b,{className:"spin"}),e.createElement("span",null,"Loading channel analytics...")))):e.createElement("div",{className:"channel-analytics-overlay",onClick:c},e.createElement("div",{className:"channel-analytics-panel",onClick:a=>a.stopPropagation()},e.createElement("div",{className:"panel-header"},e.createElement("div",{className:"header-info"},e.createElement("h2",null,e.createElement(w,null)," Channel Analytics"),e.createElement("span",{className:"subtitle"},"Track channel performance and engagement")),e.createElement("div",{className:"header-actions"},e.createElement("select",{value:m,onChange:a=>g(a.target.value),className:"time-select"},e.createElement("option",{value:"day"},"Last 24 Hours"),e.createElement("option",{value:"week"},"Last 7 Days"),e.createElement("option",{value:"month"},"Last 30 Days")),e.createElement("button",{className:"close-btn",onClick:c},e.createElement(_,null)))),e.createElement("div",{className:"summary-cards"},e.createElement("div",{className:"summary-card"},e.createElement("div",{className:"card-icon"},e.createElement(i,null)),e.createElement("div",{className:"card-content"},e.createElement("span",{className:"card-value"},s?.summary?.total_channels||0),e.createElement("span",{className:"card-label"},"Total Channels"))),e.createElement("div",{className:"summary-card"},e.createElement("div",{className:"card-icon active"},e.createElement(f,null)),e.createElement("div",{className:"card-content"},e.createElement("span",{className:"card-value"},s?.summary?.active_channels||0),e.createElement("span",{className:"card-label"},"Active Channels"))),e.createElement("div",{className:"summary-card"},e.createElement("div",{className:"card-icon"},e.createElement(v,null)),e.createElement("div",{className:"card-content"},e.createElement("span",{className:"card-value"},p(s?.summary?.total_messages)),e.createElement("span",{className:"card-label"},"Total Messages"))),e.createElement("div",{className:"summary-card"},e.createElement("div",{className:"card-icon"},e.createElement(C,null)),e.createElement("div",{className:"card-content"},e.createElement("span",{className:"card-value"},s?.engagement_rate||0,"%"),e.createElement("span",{className:"card-label"},"Engagement Rate")))),e.createElement("div",{className:"panel-body"},e.createElement("div",{className:"section"},e.createElement("h3",null,e.createElement(F,null)," Channel Leaderboard"),e.createElement("div",{className:"channel-list"},(s?.channels||[]).sort((a,t)=>t.messages-a.messages).map((a,t)=>e.createElement("div",{key:a.id,className:`channel-item ${n===a.id?"selected":""}`,onClick:()=>N(a.id===n?null:a.id)},e.createElement("span",{className:`rank ${t<3?"top":""}`},"#",t+1),e.createElement("span",{className:"channel-icon"},k(a.type)),e.createElement("div",{className:"channel-info"},e.createElement("span",{className:"channel-name"},a.name),e.createElement("div",{className:"channel-stats"},e.createElement("span",null,e.createElement(v,null)," ",p(a.messages)),e.createElement("span",null,e.createElement(A,null)," ",a.active_users))),e.createElement("div",{className:"channel-growth"},y(a.growth),e.createElement("span",{className:a.growth>0?"positive":a.growth<0?"negative":""},Math.abs(a.growth),"%")),e.createElement("div",{className:"channel-bar"},e.createElement("div",{className:"bar-fill",style:{width:`${a.messages/(s?.channels?.[0]?.messages||1)*100}%`}})))),(!s?.channels||s.channels.length===0)&&e.createElement("div",{className:"empty-state"},"No channel data available"))),e.createElement("div",{className:"section"},e.createElement("h3",null,e.createElement($,null)," Peak Activity Hours"),e.createElement("div",{className:"peak-hours"},(s?.peak_hours||[]).map((a,t)=>e.createElement("div",{key:t,className:"peak-item"},e.createElement("span",{className:"peak-rank"},"#",t+1),e.createElement("div",{className:"peak-time"},e.createElement(x,null),e.createElement("span",null,a.hour,":00 - ",a.hour+1,":00")),e.createElement("div",{className:"peak-bar"},e.createElement("div",{className:"bar-fill",style:{width:`${a.activity}%`}})),e.createElement("span",{className:"peak-value"},a.activity,"%"))))),n&&e.createElement("div",{className:"section channel-details"},e.createElement("h3",null,e.createElement(i,null)," Channel Details"),(()=>{const a=s?.channels?.find(t=>t.id===n);return a?e.createElement("div",{className:"details-grid"},e.createElement("div",{className:"detail-card"},e.createElement("span",{className:"detail-label"},"Peak Hour"),e.createElement("span",{className:"detail-value"},a.peak_hour,":00")),e.createElement("div",{className:"detail-card"},e.createElement("span",{className:"detail-label"},"Active Users"),e.createElement("span",{className:"detail-value"},a.active_users)),e.createElement("div",{className:"detail-card"},e.createElement("span",{className:"detail-label"},"Weekly Growth"),e.createElement("span",{className:`detail-value ${a.growth>0?"positive":a.growth<0?"negative":""}`},a.growth>0?"+":"",a.growth,"%")),e.createElement("div",{className:"detail-card"},e.createElement("span",{className:"detail-label"},"Messages/Day"),e.createElement("span",{className:"detail-value"},Math.round(a.messages/7)))):null})()))))};export{z as default};
