var nt=Object.defineProperty;var a=(t,r)=>nt(t,"name",{value:r,configurable:!0});import{r as c,j as e,a as Z}from"./react-core-Djgtqrmb.js";import{o as at,a as it,P as Ke,p as rt,t as Q}from"./index-DwVhiipM.js";import ot from"./UserContextMenu-DYhgW8ON.js";import st from"./VoiceSettingsPanel-DZKh7m3F.js";import{S as lt}from"./crypto-vendor-D1XRGppi.js";import{D as ct}from"./cjs-3Tj8aJ0i.js";import"./media-vendor-CxFPycob.js";import"./router-vendor-gmJ9Mn-1.js";import"./state-vendor-CbW2fAN9.js";import"./icons-vendor-BMXAt4pj.js";import"./ui-vendor-IhB9Znpc.js";const dt=a((t,r)=>{const s=c.useRef(null),l=c.useRef(null);return c.useEffect(()=>{s.current&&t&&(s.current.srcObject=t)},[t]),c.useEffect(()=>{if(l.current&&t&&!r.isLocal){const p=t.getAudioTracks();if(p.length>0){l.current.srcObject=new MediaStream(p);const g=r.volume||100;if(g<=100)l.current.volume=Math.max(0,g/100);else{l.current.volume=1;try{const i=l.current;i._audioContext||(i._audioContext=new(window.AudioContext||window.webkitAudioContext),i._sourceNode=i._audioContext.createMediaElementSource(i),i._gainNode=i._audioContext.createGain(),i._sourceNode.connect(i._gainNode),i._gainNode.connect(i._audioContext.destination)),i._gainNode.gain.value=g/100}catch{}}}}},[t,r.isLocal,r.username,r.volume]),{videoRef:s,audioRef:l}},"useVideoAudio"),xe=a((t,r=256)=>{if(!t)return`https://ui-avatars.com/api/?name=User&background=5865f2&color=fff&bold=true&size=${r}`;const s=lt.hash(t),l=parseInt(s.substring(0,8),16)%360;return`https://ui-avatars.com/api/?name=${encodeURIComponent(t)}&background=${l.toString(16).padStart(2,"0")}${((l+60)%360).toString(16).padStart(2,"0")}${((l+120)%360).toString(16).padStart(2,"0")}&color=fff&bold=true&size=${r}`},"getDeterministicAvatarFallback"),pt=a(({user:t,stream:r,videoRef:s,getUserAvatar:l,badge:p})=>{const g=r&&r.active&&r.getVideoTracks().length>0;return e.jsxs("div",{style:{width:"100%",height:"100%",background:"#1a1a1a",display:"flex",alignItems:"center",justifyContent:"center"},children:[p,g?e.jsx("video",{ref:s,autoPlay:!0,playsInline:!0,muted:t.isLocal===!0,style:{width:"100%",height:"100%",objectFit:t.streamType==="screen"?"contain":"cover",backgroundColor:t.streamType==="screen"?"#000":"#1a1a1a"}}):e.jsxs("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"16px",background:"linear-gradient(135deg, #36393f 0%, #2f3136 50%, #202225 100%)",position:"relative"},children:[e.jsx("div",{style:{position:"relative",padding:"8px",borderRadius:"50%",background:t.isTalking?"linear-gradient(135deg, #43b581, #3ca374)":"transparent",boxShadow:t.isTalking?"0 0 20px rgba(67, 181, 129, 0.6), 0 0 40px rgba(67, 181, 129, 0.3)":"none",transition:"all 0.3s ease",animation:t.isTalking?"talkingPulse 1s ease-in-out infinite":"none"},children:e.jsx("img",{src:l(t.username),alt:t.username,onError:a(i=>{i.target.onerror=null,i.target.src=xe(t.username,256)},"onError"),style:{width:"140px",height:"140px",borderRadius:"50%",objectFit:"cover",border:"5px solid #40444b",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.5)",display:"block"},loading:"lazy"})}),e.jsx("div",{style:{color:"#fff",fontSize:"18px",fontWeight:700,textShadow:"0 2px 8px rgba(0, 0, 0, 0.7)",letterSpacing:"0.5px"},children:t.username}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"6px 14px",background:t.isMuted?"rgba(240, 71, 71, 0.2)":"rgba(67, 181, 129, 0.2)",borderRadius:"16px",border:t.isMuted?"1px solid rgba(240, 71, 71, 0.4)":"1px solid rgba(67, 181, 129, 0.4)"},children:[e.jsx("span",{style:{fontSize:"16px"},children:t.isMuted?"ðŸ”‡":"ðŸŽ¤"}),e.jsx("span",{style:{color:t.isMuted?"#f04747":"#43b581",fontSize:"13px",fontWeight:600},children:t.isMuted?"Sessiz":t.isTalking?"KonuÅŸuyor...":"Dinliyor"})]})]})]})},"VideoDisplay"),xt=a(({user:t,isActive:r,connectionQuality:s})=>e.jsxs("div",{style:{position:"absolute",bottom:0,left:0,right:0,background:"linear-gradient(to top, rgba(0, 0, 0, 0.8), transparent)",padding:"12px 16px",display:"flex",alignItems:"center",gap:"8px",zIndex:10},children:[t.isTalking&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"3px"},children:[e.jsx("div",{style:{width:"3px",height:"12px",background:"#43b581",borderRadius:"2px",animation:"wave1 0.6s ease-in-out infinite"}}),e.jsx("div",{style:{width:"3px",height:"16px",background:"#43b581",borderRadius:"2px",animation:"wave2 0.6s ease-in-out infinite 0.1s"}}),e.jsx("div",{style:{width:"3px",height:"12px",background:"#43b581",borderRadius:"2px",animation:"wave3 0.6s ease-in-out infinite 0.2s"}})]}),!t.isLocal&&s&&e.jsx("div",{title:`RTT: ${s.rtt}ms, Packet Loss: ${s.packetLoss}%`,style:{fontSize:"16px",filter:s.quality==="excellent"?"none":s.quality==="good"?"hue-rotate(30deg)":"hue-rotate(90deg) saturate(2)",opacity:.9},children:s.quality==="excellent"||s.quality==="good"?"ðŸ“¶":"âš ï¸"}),e.jsxs("span",{onClick:a(l=>{l.stopPropagation(),t.isLocal||(window.openUserProfile?window.openUserProfile(t.username):window.location.hash=`#/profile/${t.username}`)},"onClick"),style:{color:"#fff",fontSize:"14px",fontWeight:600,flex:1,cursor:t.isLocal?"default":"pointer",textDecoration:t.isLocal?"none":"underline",textDecorationColor:"rgba(255, 255, 255, 0.3)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[t.username," ",t.streamType==="screen"&&"ðŸ–¥ï¸ Ekran"]}),e.jsxs("div",{style:{display:"flex",gap:"6px"},children:[t.isMuted&&e.jsx("span",{style:{fontSize:"16px"},children:"ðŸ”‡"}),t.streamType==="camera"&&t.isCameraOn&&e.jsx("span",{style:{fontSize:"16px"},children:"ðŸ“¹"}),r&&e.jsx("span",{style:{fontSize:"16px"},children:"ðŸ”Š"})]})]}),"UserOverlay"),ye=a(({icon:t,onClick:r,title:s,bgColor:l="rgba(0, 0, 0, 0.7)"})=>e.jsx("button",{onClick:r,title:s,style:{background:l,border:"1px solid rgba(255, 255, 255, 0.3)",borderRadius:"8px",width:"36px",height:"36px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",fontSize:"14px",color:"#fff",fontWeight:"bold",transition:"all 0.2s ease",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.3)"},onMouseEnter:a(p=>{p.currentTarget.style.transform="scale(1.1)",p.currentTarget.style.boxShadow="0 4px 16px rgba(255, 255, 255, 0.3)"},"onMouseEnter"),onMouseLeave:a(p=>{p.currentTarget.style.transform="scale(1)",p.currentTarget.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.3)"},"onMouseLeave"),children:t}),"ActionButton"),ut=a(({user:t,isPinned:r,onPin:s,onExpand:l,showFullControls:p,videoRef:g})=>e.jsxs("div",{style:{position:"absolute",top:"12px",right:"12px",display:"flex",gap:"6px",opacity:p?1:0,transition:"opacity 0.25s ease, transform 0.25s ease",transform:p?"translateY(0)":"translateY(-6px)",zIndex:20,pointerEvents:p?"auto":"none"},children:[e.jsx(ye,{icon:r?"ðŸ“Œ":"ðŸ“",onClick:a(i=>{i.stopPropagation(),s()},"onClick"),title:r?"Sabitlemeyi KaldÄ±r":"Sabitle",bgColor:"rgba(88, 101, 242, 0.9)"}),e.jsx(ye,{icon:"â›¶",onClick:a(i=>{i.stopPropagation(),l()},"onClick"),title:"Panelde GeniÅŸlet",bgColor:"rgba(67, 181, 129, 0.9)"}),e.jsx(ye,{icon:"ðŸ–¥ï¸",onClick:a(i=>{i.stopPropagation();const w=g.current;if(w){const y=w.parentElement?.parentElement||w;y.requestFullscreen?y.requestFullscreen():y.webkitRequestFullscreen?y.webkitRequestFullscreen():y.mozRequestFullScreen?y.mozRequestFullScreen():y.msRequestFullscreen&&y.msRequestFullscreen()}},"onClick"),title:"Tam Ekran Ä°zle",bgColor:"rgba(250, 166, 26, 0.9)"}),!t.isLocal&&p&&e.jsxs("div",{style:{background:"rgba(0, 0, 0, 0.9)",borderRadius:"10px",padding:"6px 10px",display:"flex",alignItems:"center",gap:"6px",minWidth:"100px",backdropFilter:"blur(8px)",border:"1px solid rgba(255, 255, 255, 0.1)",animation:"fadeIn 0.2s ease"},children:[e.jsx("span",{style:{fontSize:"12px"},children:(t.volume||100)===0?"ðŸ”‡":(t.volume||100)>100?"ðŸ”Š":"ðŸ”‰"}),e.jsx("input",{type:"range",min:"0",max:"200",value:t.volume||100,onChange:a(i=>{i.stopPropagation(),t.onVolumeChange&&t.onVolumeChange(parseInt(i.target.value))},"onChange"),style:{flex:1,cursor:"pointer",height:"4px"},onClick:a(i=>i.stopPropagation(),"onClick")}),e.jsxs("span",{style:{fontSize:"10px",color:"#fff",minWidth:"30px",fontWeight:600},children:[t.volume||100,"%"]})]})]}),"HoverControls"),ve=Z.memo(({user:t,stream:r,isActive:s,isPinned:l,onExpand:p,onPin:g,onContextMenu:i,compact:w=!1,badge:k,connectionQuality:y,getUserAvatar:I})=>{const{videoRef:j,audioRef:C}=dt(r,t),[K,$]=c.useState(!1),d=c.useCallback(A=>{A.preventDefault(),i&&t.username!==t.isLocal&&i({user:t,position:{x:A.clientX,y:A.clientY}})},[i,t]),v=c.useCallback(A=>{!t.isLocal&&i&&i({user:t,position:{x:A.clientX,y:A.clientY}})},[t,i]);return e.jsxs("div",{onContextMenu:d,onClick:v,onMouseEnter:a(()=>$(!0),"onMouseEnter"),onMouseLeave:a(()=>$(!1),"onMouseLeave"),style:{background:"linear-gradient(135deg, #2c2f33 0%, #23272a 100%)",borderRadius:"16px",overflow:"hidden",position:"relative",border:s?"3px solid #43b581":l?"3px solid #5865f2":"1px solid rgba(255, 255, 255, 0.1)",boxShadow:s?"0 0 20px rgba(67, 181, 129, 0.5)":"0 4px 16px rgba(0, 0, 0, 0.3)",transition:"all 0.3s ease",cursor:t.isLocal?"default":"pointer",width:"100%",height:"100%",display:"flex",flexDirection:"column"},children:[!t.isLocal&&r&&e.jsx("audio",{ref:C,autoPlay:!0,playsInline:!0,"data-username":t.username,style:{display:"none"}}),e.jsx(pt,{user:t,stream:r,videoRef:j,getUserAvatar:I,badge:k}),e.jsx(xt,{user:t,isActive:s,connectionQuality:y}),e.jsx(ut,{user:t,isPinned:l,onPin:g,onExpand:p,showFullControls:K,videoRef:j}),e.jsx("style",{children:`
                div:hover .hover-actions {
                    opacity: 1;
                }
            `})]})},(t,r)=>t.user.username===r.user.username&&t.stream===r.stream&&t.user.isCameraOn===r.user.isCameraOn&&t.user.isScreenSharing===r.user.isScreenSharing&&t.user.isMuted===r.user.isMuted&&t.isActive===r.isActive&&t.isPinned===r.isPinned&&t.compact===r.compact),V=a(({icon:t,active:r,danger:s,special:l,subtle:p,small:g,isLeave:i,onClick:w,title:k,label:y})=>{const I=a(()=>i?"linear-gradient(135deg, #ed4245 0%, #c03537 100%)":s&&r?"rgba(240, 71, 71, 0.4)":s?"rgba(240, 71, 71, 0.15)":l?"linear-gradient(135deg, #5865f2 0%, #4752c4 100%)":r?"rgba(67, 181, 129, 0.25)":p?"rgba(255, 255, 255, 0.05)":"rgba(255, 255, 255, 0.1)","getBackground"),j=a(()=>i?"none":s&&r?"2px solid rgba(240, 71, 71, 0.6)":r?"2px solid rgba(67, 181, 129, 0.5)":l?"2px solid rgba(88, 101, 242, 0.5)":"2px solid transparent","getBorder");return e.jsxs("button",{onClick:w,title:k,style:{background:I(),border:j(),borderRadius:i?"50%":"12px",width:i?"48px":g?"40px":"48px",height:i?"48px":g?"40px":"48px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",cursor:"pointer",fontSize:g?"16px":"20px",color:"#fff",transition:"all 0.2s ease",boxShadow:i?"0 4px 15px rgba(237, 66, 69, 0.4)":r?"0 2px 10px rgba(67, 181, 129, 0.3)":"none",transform:"scale(1)"},onMouseEnter:a(C=>{C.currentTarget.style.transform="scale(1.1)",C.currentTarget.style.boxShadow=i?"0 6px 20px rgba(237, 66, 69, 0.6)":"0 4px 15px rgba(255, 255, 255, 0.2)"},"onMouseEnter"),onMouseLeave:a(C=>{C.currentTarget.style.transform="scale(1)",C.currentTarget.style.boxShadow=i?"0 4px 15px rgba(237, 66, 69, 0.4)":r?"0 2px 10px rgba(67, 181, 129, 0.3)":"none"},"onMouseLeave"),children:[e.jsx("span",{children:t}),y&&e.jsx("span",{style:{fontSize:"9px",marginTop:"2px",fontWeight:600},children:y})]})},"VoiceControlBtn"),gt=a(({isMuted:t,isDeafened:r,isCameraOn:s,isScreenSharing:l,isSpatialAudio:p,isRecording:g,recordingDuration:i,onToggleMute:w,onToggleDeafened:k,onToggleCamera:y,onToggleScreenShare:I,onToggleSpatialAudio:j,onStartRecording:C,onStopRecording:K,onDownloadRecording:$,onLeave:d,onSettings:v})=>{const A=a(q=>{const O=Math.floor(q/60).toString().padStart(2,"0"),J=Math.floor(q%60).toString().padStart(2,"0");return`${O}:${J}`},"formatDuration");return e.jsxs("div",{style:{background:"linear-gradient(180deg, rgba(32, 34, 37, 0.98) 0%, rgba(24, 25, 28, 1) 100%)",padding:"12px 20px",display:"flex",justifyContent:"center",alignItems:"center",gap:"10px",borderTop:"1px solid rgba(255, 255, 255, 0.08)",boxShadow:"0 -4px 20px rgba(0, 0, 0, 0.4)",flexShrink:0,minHeight:"70px",position:"relative",zIndex:100},children:[e.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[e.jsx(V,{icon:t?"ðŸ”‡":"ðŸŽ¤",active:!t,danger:t,onClick:w,title:t?"Mikrofonu AÃ§":"Mikrofonu Kapat"}),e.jsx(V,{icon:r?"ðŸ”ˆ":"ðŸŽ§",active:!r,danger:r,onClick:k,title:r?"KulaklÄ±ÄŸÄ± AÃ§":"KulaklÄ±ÄŸÄ± Kapat"})]}),e.jsxs("div",{style:{display:"flex",gap:"8px",padding:"0 16px",borderLeft:"1px solid rgba(255, 255, 255, 0.1)",borderRight:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx(V,{icon:s?"ðŸ“¹":"ðŸ“·",active:s,onClick:y,title:s?"KamerayÄ± Kapat":"KamerayÄ± AÃ§"}),e.jsx(V,{icon:"ðŸ–¥ï¸",active:l,special:l,onClick:I,title:l?"PaylaÅŸÄ±mÄ± Durdur":"Ekran PaylaÅŸ"}),j&&e.jsx(V,{icon:"ðŸ”Š",active:p,onClick:j,title:p?"3D Ses (AÃ§Ä±k)":"3D Ses (KapalÄ±)",small:!0})]}),e.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[C&&K&&e.jsx(V,{icon:g?"â¹ï¸":"âºï¸",active:g,danger:g,onClick:g?K:C,title:g?`KaydÄ± Durdur (${A(i)})`:"KayÄ±t BaÅŸlat",label:g?A(i):null}),v&&e.jsx(V,{icon:"âš™ï¸",onClick:v,title:"Ayarlar",subtle:!0})]}),e.jsx(V,{icon:"ðŸ“ž",danger:!0,onClick:d,title:"AyrÄ±l",isLeave:!0})]})},"ControlBar"),ft=a(({stream:t,fullscreen:r})=>{const s=c.useRef(null);return c.useEffect(()=>{s.current&&t&&(s.current.srcObject=t)},[t]),e.jsx("video",{ref:s,autoPlay:!0,playsInline:!0,muted:!1,style:{width:"100%",height:"100%",objectFit:r?"contain":"cover",background:"#000"}})},"VideoFeed"),pe=a(({icon:t,active:r,danger:s,onClick:l,title:p})=>e.jsx("button",{onClick:l,title:p,style:{background:r?"rgba(88, 101, 242, 0.8)":s?"rgba(237, 66, 69, 0.8)":"rgba(255, 255, 255, 0.15)",border:"none",borderRadius:"8px",width:"36px",height:"36px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",fontSize:"16px",transition:"all 0.2s ease"},children:t}),"MiniButton"),Ne=Z.memo(({roomName:t,userCount:r,combinedUsers:s,currentUser:l,onToggleMinimize:p,onContextMenu:g,getUserAvatar:i,isMuted:w,isCameraOn:k,isScreenSharing:y,toggleMute:I,toggleCamera:j,toggleScreenShare:C,leaveVoice:K})=>{const $=c.useRef(null);return e.jsx(ct,{nodeRef:$,handle:".mini-drag-handle",defaultPosition:{x:20,y:window.innerHeight-180},bounds:"parent",children:e.jsxs("div",{ref:$,style:{position:"fixed",zIndex:9999,background:"linear-gradient(135deg, #1e2124 0%, #2c2f33 50%, #23272a 100%)",borderRadius:"16px",padding:"16px",boxShadow:"0 12px 48px rgba(0, 0, 0, 0.7), 0 0 0 1px rgba(88, 101, 242, 0.15)",border:"1px solid rgba(88, 101, 242, 0.1)",minWidth:"320px",maxWidth:"400px",backdropFilter:"blur(12px)",animation:"slideIn 0.3s ease"},children:[e.jsxs("div",{className:"mini-drag-handle",style:{display:"flex",alignItems:"center",gap:"12px",cursor:"move",marginBottom:"12px",paddingBottom:"12px",borderBottom:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx("div",{style:{width:"10px",height:"10px",borderRadius:"50%",background:"#43b581",boxShadow:"0 0 12px #43b581",animation:"pulse 2s infinite"}}),e.jsxs("span",{style:{color:"#fff",fontSize:"14px",fontWeight:600,flex:1},children:["ðŸŽ¤ ",t]}),e.jsxs("div",{style:{background:"rgba(67, 181, 129, 0.2)",borderRadius:"12px",padding:"4px 10px",fontSize:"11px",color:"#43b581",fontWeight:600},children:["ðŸ‘¥ ",r]}),e.jsx("button",{onClick:p,style:{background:"rgba(255, 255, 255, 0.1)",border:"none",borderRadius:"8px",padding:"6px 10px",color:"#fff",cursor:"pointer",fontSize:"12px",transition:"all 0.2s"},onMouseEnter:a(d=>d.target.style.background="rgba(255, 255, 255, 0.2)","onMouseEnter"),onMouseLeave:a(d=>d.target.style.background="rgba(255, 255, 255, 0.1)","onMouseLeave"),children:"â¬†ï¸ AÃ§"})]}),e.jsxs("div",{style:{marginBottom:"12px",maxHeight:"120px",overflowY:"auto",display:"flex",flexDirection:"column",gap:"6px"},children:[s.slice(0,3).map(d=>e.jsxs("div",{onContextMenu:a(v=>{v.preventDefault(),d.username!==l?.username&&g({user:d,position:{x:v.clientX,y:v.clientY}})},"onContextMenu"),onClick:a(v=>{d.username!==l?.username&&g({user:d,position:{x:v.clientX,y:v.clientY}})},"onClick"),style:{display:"flex",alignItems:"center",gap:"10px",padding:"8px",background:d.isTalking?"rgba(67, 181, 129, 0.15)":"rgba(255, 255, 255, 0.05)",borderRadius:"8px",border:d.isTalking?"1px solid rgba(67, 181, 129, 0.4)":"1px solid transparent",transition:"all 0.2s",cursor:d.username!==l?.username?"pointer":"default"},onMouseEnter:a(v=>{d.username!==l?.username&&(v.currentTarget.style.background="rgba(67, 181, 129, 0.2)")},"onMouseEnter"),onMouseLeave:a(v=>{v.currentTarget.style.background=d.isTalking?"rgba(67, 181, 129, 0.15)":"rgba(255, 255, 255, 0.05)"},"onMouseLeave"),children:[e.jsx("img",{src:i(d.username),alt:d.username,onError:a(v=>{v.target.onerror=null,v.target.src=xe(d.username,64)},"onError"),style:{width:"32px",height:"32px",borderRadius:"50%",objectFit:"cover",border:d.isTalking?"2px solid #43b581":"2px solid rgba(255, 255, 255, 0.15)",boxShadow:d.isTalking?"0 0 10px rgba(67, 181, 129, 0.5)":"none",transition:"all 0.3s ease"}}),e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{color:"#fff",fontSize:"13px",fontWeight:600},children:[d.username," ",d.isLocal&&"(Siz)"]}),e.jsx("div",{style:{color:"rgba(255, 255, 255, 0.5)",fontSize:"11px"},children:d.isMuted?"ðŸ”‡ Sessiz":d.isTalking?"ðŸ”Š KonuÅŸuyor":"ðŸŽ¤ Aktif"})]}),d.isCameraOn&&e.jsx("span",{style:{fontSize:"14px"},children:"ðŸ“¹"}),d.isScreenSharing&&e.jsx("span",{style:{fontSize:"14px"},children:"ðŸ–¥ï¸"})]},d.username)),r>3&&e.jsxs("div",{style:{textAlign:"center",color:"rgba(255, 255, 255, 0.5)",fontSize:"11px",padding:"6px"},children:["+",r-3," daha..."]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"8px"},children:[e.jsx(pe,{icon:w?"ðŸ”‡":"ðŸŽ¤",active:!w,onClick:I,title:w?"Mikrofonu AÃ§":"Mikrofonu Kapat"}),e.jsx(pe,{icon:k?"ðŸ“¹":"ðŸ“·",active:k,onClick:j,title:k?"KamerayÄ± Kapat":"KamerayÄ± AÃ§"}),e.jsx(pe,{icon:"ðŸ–¥ï¸",active:y,onClick:C,title:y?"PaylaÅŸÄ±mÄ± Durdur":"Ekran PaylaÅŸ"}),e.jsx(pe,{icon:"âŒ",danger:!0,onClick:K,title:"AyrÄ±l"})]})]})})});Ne.displayName="MinimizedView";function mt({isInVoice:t,localAudioStream:r,isMuted:s,startStatsMonitoring:l,stopStatsMonitoring:p,screenShareQuality:g,updateScreenQuality:i}){const[w,k]=c.useState({}),[y,I]=c.useState(!1),[j,C]=c.useState("good"),[K,$]=c.useState("unknown"),[d,v]=c.useState(!0),[A,q]=c.useState(!0),[O,J]=c.useState({}),[ee,re]=c.useState({}),[oe,se]=c.useState({}),[ke,te]=c.useState(null);return c.useEffect(()=>{if(!t)return;const T=a(async()=>{const R=window.__pawscord_peer_connections__||{};for(const[S,h]of Object.entries(R))if(h&&h.getStats)try{(await h.getStats()).forEach(f=>{f.type==="candidate-pair"&&f.state==="succeeded"&&k(P=>({...P,[S]:{rtt:Math.round((f.currentRoundTripTime||0)*1e3),packetLoss:f.packetsLost&&f.packetsSent?Math.round(f.packetsLost/f.packetsSent*100*10)/10:0,quality:(f.currentRoundTripTime||0)<.1?"excellent":(f.currentRoundTripTime||0)<.2?"good":"poor"}}))})}catch{}},"monitorConnections"),E=setInterval(T,3e3);return T(),()=>clearInterval(E)},[t]),c.useEffect(()=>(t&&l&&l(),()=>{p&&p()}),[t,l,p]),c.useEffect(()=>{if(!r||s||!t){I(!1);return}try{const T=window.AudioContext||window.webkitAudioContext,E=new T,R=E.createAnalyser();R.fftSize=2048,R.smoothingTimeConstant=.8;const S=E.createMediaStreamSource(r);S.connect(R);const h=new Uint8Array(R.frequencyBinCount);let z=0;const P=setInterval(a(()=>{R.getByteFrequencyData(h);const Y=h.slice(80,160),N=Math.max(...Y),G=Y.reduce((H,ne)=>H+ne,0)/Y.length,B=h.slice(10,40),le=B.reduce((H,ne)=>H+ne,0)/B.length;N>180&&G>100&&G>le*1.5?(z++,z>3&&I(!0)):(z=0,N<120&&I(!1))},"detectEcho"),1e3);return()=>{clearInterval(P),S.disconnect(),E.close()}}catch{}},[r,s,t]),c.useEffect(()=>{if(!t)return;const T=navigator.connection||navigator.mozConnection||navigator.webkitConnection,E=a(()=>{if(!T){C("good"),$("unknown");return}const S=T.effectiveType||"unknown";$(S);const h=T.downlink||10,z=T.rtt||50;let f="good";S==="4g"&&h>=5&&z<100?f="excellent":S==="slow-2g"||h<1||z>300?f="poor":S==="2g"||S==="3g"||h<3||z>150?f="good":f="excellent",C(f),d&&i&&(f==="poor"&&g!=="720p"?i("720p"):f==="excellent"&&g==="720p"&&i("1080p"))},"updateNetworkQuality");E(),T&&T.addEventListener("change",E);const R=setInterval(E,1e4);return()=>{clearInterval(R),T&&T.removeEventListener("change",E)}},[t,d,g,i]),c.useEffect(()=>{if(!A||!t)return;const E=setInterval(a(()=>{const R=document.querySelectorAll("audio[data-username]"),S={},h={...ee};R.forEach(z=>{const f=z.getAttribute("data-username");if(f)try{const P=new(window.AudioContext||window.webkitAudioContext),Y=P.createMediaElementSource(z),N=P.createAnalyser();N.fftSize=256,Y.connect(N),N.connect(P.destination);const G=new Uint8Array(N.frequencyBinCount);N.getByteFrequencyData(G);const B=G.reduce((le,H)=>le+H,0)/G.length;S[f]=B,B>0&&(B<50?h[f]=Math.min(1.5,(h[f]||1)*1.05):B>120&&(h[f]=Math.max(.7,(h[f]||1)*.95))),P.close()}catch{}}),J(S),re(h)},"monitorAudioLevels"),2e3);return()=>clearInterval(E)},[A,t,ee]),c.useEffect(()=>{if(!t)return;const E=setInterval(a(()=>{const R={};let S=null,h=0;Object.entries(O).forEach(([z,f])=>{f>30?(R[z]=!0,f>h&&(h=f,S=z)):R[z]=!1}),se(R),S&&h>50?te(S):h===0&&te(null)},"detectTalking"),100);return()=>clearInterval(E)},[t,O]),{connectionQuality:w,setConnectionQuality:k,hasEchoRisk:y,setHasEchoRisk:I,networkQuality:j,setNetworkQuality:C,networkType:K,setNetworkType:$,autoQualityEnabled:d,setAutoQualityEnabled:v,volumeNormalization:A,setVolumeNormalization:q,userAudioLevels:O,setUserAudioLevels:J,normalizedGains:ee,setNormalizedGains:re,talkingIndicators:oe,setTalkingIndicators:se,activeSpeaker:ke,setActiveSpeaker:te}}a(mt,"useVoiceMonitoring");function ht(){if(typeof document>"u"||document.head.querySelector("style#voice-fullscreen-styles"))return;const t=document.createElement("style");t.id="voice-fullscreen-styles",t.textContent=`
            /* Tam Ekran Video Stilleri */
            div:fullscreen video,
            div:-webkit-full-screen video,
            div:-moz-full-screen video,
            div:-ms-fullscreen video {
                width: 100% !important;
                height: 100% !important;
                object-fit: contain !important;
                background: #000 !important;
            }

            /* Tam Ekran Container */
            div:fullscreen,
            div:-webkit-full-screen,
            div:-moz-full-screen,
            div:-ms-fullscreen {
                background: #000 !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
            }

            /* Tam Ekran Kontrolleri */
            div:fullscreen .hover-actions,
            div:-webkit-full-screen .hover-actions,
            div:-moz-full-screen .hover-actions,
            div:-ms-fullscreen .hover-actions {
                opacity: 1 !important;
                z-index: 9999 !important;
            }

            /* ðŸ”¥ YENÄ°: Badge AnimasyonlarÄ± */
            @keyframes badgePulse {
                0%, 100% {
                    transform: scale(1);
                    box-shadow: 0 4px 16px rgba(88, 101, 242, 0.6), 0 0 0 2px rgba(255, 255, 255, 0.2);
                }
                50% {
                    transform: scale(1.05);
                    box-shadow: 0 6px 20px rgba(88, 101, 242, 0.9), 0 0 0 3px rgba(255, 255, 255, 0.4);
                }
            }

            @keyframes pulse {
                0%, 100% {
                    opacity: 1;
                    transform: scale(1);
                }
                50% {
                    opacity: 0.7;
                    transform: scale(1.2);
                }
            }

            /* ðŸ”¥ YENÄ°: Talking Indicator Wave Animations */
            @keyframes wave1 {
                0%, 100% { height: 12px; }
                50% { height: 20px; }
            }
            @keyframes wave2 {
                0%, 100% { height: 16px; }
                50% { height: 24px; }
            }
            @keyframes wave3 {
                0%, 100% { height: 12px; }
                50% { height: 20px; }
            }

            /* ðŸ”¥ YENÄ°: Avatar Talking Pulse Animation */
            @keyframes talkingPulse {
                0%, 100% {
                    box-shadow: 0 0 0 0 rgba(67, 181, 129, 0.7);
                    transform: scale(1);
                }
                50% {
                    box-shadow: 0 0 0 15px rgba(67, 181, 129, 0);
                    transform: scale(1.02);
                }
            }

            @keyframes slideIn {
                from { opacity: 0; transform: translateY(10px) scale(0.95); }
                to { opacity: 1; transform: translateY(0) scale(1); }
            }
            @keyframes fadeIn {
                from { opacity: 0; }
                to { opacity: 1; }
            }
            @keyframes connectionGlow {
                0%, 100% { box-shadow: 0 0 12px rgba(67, 181, 129, 0.3); }
                50% { box-shadow: 0 0 20px rgba(67, 181, 129, 0.6); }
            }
            @keyframes screenShareGlow {
                0%, 100% { border-color: rgba(88, 101, 242, 0.5); }
                50% { border-color: rgba(88, 101, 242, 0.9); }
            }

            /* Smooth grid transitions */
            .voice-grid-item {
                animation: slideIn 0.3s ease forwards;
            }
            /* Video card hover effects */
            .voice-video-card:hover {
                transform: scale(1.01);
                z-index: 10;
            }
            /* Active speaker highlight */
            .voice-active-speaker {
                animation: connectionGlow 2s ease-in-out infinite;
            }
            /* Screen share border animation */
            .voice-screen-share {
                animation: screenShareGlow 2s ease-in-out infinite;
            }
    `,document.head.appendChild(t)}a(ht,"injectVoicePanelStyles");ht();const bt=a(t=>t?t.replace(/_100x100\./gi,".").replace(/_150x150\./gi,".").replace(/_50x50\./gi,".").replace(/\?.*$/,""):null,"getFullResolutionAvatar"),yt=a(({roomName:t,onClose:r,isMinimized:s,onToggleMinimize:l,getRealUserAvatar:p,allUsers:g=[],currentUserProfile:i})=>{const{isInVoice:w,isMuted:k,isDeafened:y,isVideoEnabled:I,isScreenSharing:j,isSpatialAudioEnabled:C,vadSensitivity:K,isNoiseSuppressionEnabled:$,screenShareQuality:d,screenShareFPS:v,isRecording:A,recordingDuration:q,isPTTMode:O,isPTTActive:J,pttKey:ee,includeSystemAudio:re,connectedUsers:oe=[],isReconnecting:se=!1,connectionStats:ke={},startStatsMonitoring:te,stopStatsMonitoring:T,toggleMute:E,toggleDeafened:R,toggleCamera:S,toggleScreenShare:h,toggleSpatialAudio:z,updateVadSensitivity:f,toggleNoiseSuppression:P,updateScreenQuality:Y,updateScreenFPS:N,toggleSystemAudio:G,togglePTTMode:B,updatePTTKey:le,startRecording:H,stopRecording:ne,downloadRecording:vt,leaveVoiceRoom:Se,localAudioStream:Fe,remoteStreams:we={},remoteVolumes:je={},setRemoteVolume:Ce,localCameraStream:ue,localScreenStream:ge,isTalking:Te=!1}=at(),ae=I,{user:M}=it(),D=Z.useMemo(()=>{const n=[...oe];if(M&&!n.some(u=>u.username===M.username))n.push({username:M.username,isMuted:k,isCameraOn:ae,isScreenSharing:j,isTalking:Te,isLocal:!0});else if(M){const u=n.findIndex(b=>b.username===M.username);u>=0&&(n[u]={...n[u],isMuted:k,isCameraOn:ae,isScreenSharing:j,isTalking:Te,isLocal:!0})}return n},[oe,M,k,ae,j]),ie=c.useCallback(n=>{let u=null;if(i&&n===M?.username&&i.avatar&&typeof i.avatar=="string"&&(i.avatar.startsWith("http")||i.avatar.startsWith("blob:")?u=i.avatar:u=`${Ke}${i.avatar.startsWith("/")?"":"/"}${i.avatar}`),!u&&p&&(u=p(n)),!u){const b=g.find(o=>o.username===n);b?.avatar&&typeof b.avatar=="string"&&(b.avatar.startsWith("http")||b.avatar.startsWith("blob:")?u=b.avatar:u=`${Ke}${b.avatar.startsWith("/")?"":"/"}${b.avatar}`)}return u?bt(u):xe(n,256)},[i,M,p,g]),_=Z.useMemo(()=>{const n={...we};return M?.username&&(ue&&(n[`${M.username}_camera`]=ue),ge&&(n[`${M.username}_screen`]=ge)),n},[we,M,ue,ge]),[F,ce]=c.useState(null),[de,ze]=c.useState(null),[qe,Ee]=c.useState(!1),[fe,U]=c.useState(null),[Re,Ae]=c.useState(()=>{try{const n=localStorage.getItem("pawscord_voice_volumes");return n?JSON.parse(n):{}}catch{return{}}}),[Be,Ve]=c.useState(!0),{connectionQuality:me,hasEchoRisk:Oe,networkQuality:Ie,networkType:Me,talkingIndicators:Ye,activeSpeaker:L}=mt({isInVoice:w,localAudioStream:Fe,isMuted:k,startStatsMonitoring:te,stopStatsMonitoring:T,screenShareQuality:d,updateScreenQuality:Y});c.useEffect(()=>{const n=a(()=>{Ee(!0)},"handleOpenSettings");return window.addEventListener("openVoiceSettings",n),()=>window.removeEventListener("openVoiceSettings",n)},[]),c.useEffect(()=>{try{localStorage.setItem("pawscord_voice_volumes",JSON.stringify(Re))}catch{}},[Re]);const{isMobile:_e}=rt(),$e=F?"fullscreen":s?"minimized":_e?"mobile":"grid";c.useEffect(()=>{w||r()},[w,r]);const Ge=a(n=>_e?{cols:1,rows:n}:n<=1?{cols:1,rows:1}:n<=4?{cols:2,rows:2}:n<=6?{cols:3,rows:2}:n<=9?{cols:3,rows:3}:{cols:4,rows:Math.ceil(n/4)},"getGridLayout"),He=Z.useMemo(()=>{let n=D.length;return D.forEach(u=>{const b=u.username;_[`${b}_screen`]&&u.isScreenSharing&&n++}),n},[D,_]),Le=D.length,{cols:We,rows:Pe}=Ge(He),Ue=c.useCallback(async n=>{window.location.hash=`#/dm/${n.username}`},[]),Xe=c.useCallback(async n=>{try{(await fetch("/api/friends/send_request/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("access_token")}`},body:JSON.stringify({username:n.username})})).ok?Q.success(`Ã¢Å“â€¦ ${n.username} kullanÃ„Â±cÃ„Â±sÃ„Â±na arkadaÃ…Å¸lÃ„Â±k isteÃ„Å¸i gÃƒÂ¶nderildi!`):Q.error("Ã¢ÂÅ’ ArkadaÃ…Å¸lÃ„Â±k isteÃ„Å¸i gÃƒÂ¶nderilemedi")}catch{Q.error("Ã¢ÂÅ’ Bir hata oluÃ…Å¸tu")}},[]),Je=c.useCallback(async n=>{try{(await fetch("/api/users/block/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("access_token")}`},body:JSON.stringify({username:n.username})})).ok?Q.success(`Ã¢Å“â€¦ ${n.username} engellendi!`):Q.error("Ã¢ÂÅ’ Engelleme iÃ…Å¸lemi baÃ…Å¸arÃ„Â±sÃ„Â±z")}catch{Q.error("Ã¢ÂÅ’ Bir hata oluÃ…Å¸tu")}},[]),Qe=c.useCallback(n=>{U(null),window.openUserProfile?window.openUserProfile(n.username):window.location.hash=`#/profile/${n.username}`},[]),Ze=c.useCallback(n=>{Ae(u=>({...u,[n.username]:{...u[n.username],isMuted:!u[n.username]?.isMuted}}))},[]),et=c.useCallback((n,u)=>{const b=Math.max(0,Math.min(200,u));Ae(x=>({...x,[n.username]:{...x[n.username],volume:b}})),document.querySelectorAll(`audio[data-username="${n.username}"]`).forEach(x=>{if(b<=100){if(x.volume=b/100,x._gainNode)try{x._gainNode.gain.value=1}catch{}}else{x.volume=1;try{x._audioContext||(x._audioContext=new(window.AudioContext||window.webkitAudioContext),x._sourceNode=x._audioContext.createMediaElementSource(x),x._gainNode=x._audioContext.createGain(),x._sourceNode.connect(x._gainNode),x._gainNode.connect(x._audioContext.destination)),x._gainNode.gain.value=b/100}catch{}}})},[]),tt=a(()=>{const n=[];return A&&n.push(e.jsxs("span",{style:{background:"rgba(237,66,69,0.2)",color:"#ed4245",border:"1px solid rgba(237,66,69,0.4)",padding:"4px 8px",borderRadius:"10px",fontSize:"12px",display:"inline-flex",alignItems:"center",gap:"6px"},children:["Ã¢ÂÂºÃ¯Â¸Â KayÃ„Â±tta (",Math.floor(q/60).toString().padStart(2,"0"),":",Math.floor(q%60).toString().padStart(2,"0"),")"]},"rec")),j&&n.push(e.jsxs("span",{style:{background:"rgba(88,101,242,0.15)",color:"#8893ff",border:"1px solid rgba(88,101,242,0.35)",padding:"4px 8px",borderRadius:"10px",fontSize:"12px",display:"inline-flex",alignItems:"center",gap:"6px"},children:["Ã°Å¸â€“Â¥Ã¯Â¸Â PaylaÃ…Å¸Ã„Â±lÃ„Â±yor ",d," Ã¢â‚¬Â¢ ",v,"fps",re?" Ã¢â‚¬Â¢ Ã°Å¸â€Å  Sistem":""]},"ss")),O&&n.push(e.jsxs("span",{style:{background:"rgba(250,166,26,0.18)",color:"#faa61a",border:"1px solid rgba(250,166,26,0.35)",padding:"4px 8px",borderRadius:"10px",fontSize:"12px",display:"inline-flex",alignItems:"center",gap:"6px"},children:["Ã°Å¸Å½â„¢Ã¯Â¸Â PTT (",ee,") ",J?"Ã¢â‚¬Â¢ Aktif":""]},"ptt")),se&&n.push(e.jsx("span",{style:{background:"rgba(255,255,255,0.08)",color:"#fff",border:"1px solid rgba(255,255,255,0.2)",padding:"4px 8px",borderRadius:"10px",fontSize:"12px",display:"inline-flex",alignItems:"center",gap:"6px"},children:"Ã°Å¸â€â€ž Yeniden baÃ„Å¸lanÃ„Â±yor"},"reconnect")),n.length?e.jsx("div",{style:{display:"flex",gap:"8px",alignItems:"center",flexWrap:"wrap"},children:n}):null},"renderStatusBadges"),he=a(n=>n.streamType==="screen"?e.jsxs("div",{style:{position:"absolute",top:"12px",left:"12px",background:"linear-gradient(135deg, #5865f2 0%, #7289da 100%)",color:"#fff",padding:"8px 16px",borderRadius:"12px",fontSize:"13px",fontWeight:700,boxShadow:"0 4px 16px rgba(88, 101, 242, 0.6), 0 0 0 2px rgba(255, 255, 255, 0.2)",zIndex:100,display:"flex",alignItems:"center",gap:"8px",animation:"badgePulse 2s infinite"},children:["Ã°Å¸â€“Â¥Ã¯Â¸Â ",e.jsxs("span",{style:{textShadow:"0 2px 4px rgba(0, 0, 0, 0.5)"},children:[n.username," - Ekran PaylaÃ…Å¸Ã„Â±yor"]})]}):n.streamType==="camera"?e.jsx("div",{style:{position:"absolute",top:"12px",left:"12px",background:"rgba(67, 181, 129, 0.85)",color:"#fff",padding:"6px 12px",borderRadius:"8px",fontSize:"11px",fontWeight:600,boxShadow:"0 2px 8px rgba(0, 0, 0, 0.3)",zIndex:100,display:"flex",alignItems:"center",gap:"6px"},children:"Ã°Å¸â€œÂ¹ Kamera"}):null,"renderStreamBadge");if($e==="minimized")return e.jsx(Ne,{roomName:t,userCount:Le,combinedUsers:D,currentUser:M,onToggleMinimize:l,onContextMenu:a(n=>U(n),"onContextMenu"),getUserAvatar:ie,isMuted:k,isCameraOn:ae,isScreenSharing:j,toggleMute:E,toggleCamera:S,toggleScreenShare:h,leaveVoice:Se});if($e==="fullscreen"&&F){const n=F.streamType==="screen"?`${F.username}_screen`:`${F.username}_camera`,u=_[n]||_[F.username];return e.jsxs("div",{style:{width:"100%",height:"100%",background:"#000",display:"flex",flexDirection:"column",overflow:"hidden"},children:[e.jsxs("div",{style:{background:"rgba(0, 0, 0, 0.8)",padding:"16px 24px",display:"flex",alignItems:"center",gap:"16px"},children:[e.jsx("button",{onClick:a(()=>ce(null),"onClick"),style:{background:"rgba(255, 255, 255, 0.1)",border:"none",borderRadius:"8px",padding:"8px 16px",color:"#fff",cursor:"pointer",fontSize:"14px"},children:"Ã¢Â¬â€¦Ã¯Â¸Â Geri"}),e.jsxs("h3",{style:{color:"#fff",margin:0,flex:1},children:["Ã°Å¸â€˜Â¤ ",F.username," ",F.streamType==="screen"&&"Ã°Å¸â€“Â¥Ã¯Â¸Â Ekran PaylaÃ…Å¸Ã„Â±mÃ„Â±"]})]}),e.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",background:"#1a1a1a"},children:e.jsx(ft,{user:F,stream:u,fullscreen:!0})}),e.jsx(gt,{isMuted:k,isDeafened:y,isCameraOn:ae,isScreenSharing:j,isSpatialAudio:C,isRecording:A,recordingDuration:q,onToggleMute:E,onToggleDeafened:R,onToggleCamera:S,onToggleScreenShare:h,onToggleSpatialAudio:z,onStartRecording:H,onStopRecording:ne,onLeave:Se})]})}return e.jsxs("div",{style:{width:"100%",height:"100%",background:"linear-gradient(135deg, #1e1e1e 0%, #2c2c2c 100%)",display:"flex",flexDirection:"column",overflow:"hidden"},children:[e.jsxs("div",{style:{background:"rgba(0, 0, 0, 0.3)",padding:"16px 24px",display:"flex",alignItems:"center",gap:"16px",borderBottom:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx("div",{style:{width:"10px",height:"10px",borderRadius:"50%",background:"#43b581",boxShadow:"0 0 12px #43b581",animation:"pulse 2s infinite"}}),e.jsxs("h2",{style:{color:"#fff",margin:0,fontSize:"17px",fontWeight:700,flex:1,display:"flex",alignItems:"center",gap:"12px",letterSpacing:"0.3px"},children:["Ã°Å¸Å½â„¢Ã¯Â¸Â ",t,tt(),Ie==="poor"&&e.jsx("div",{style:{background:"rgba(240, 71, 71, 0.2)",border:"1px solid #f04747",borderRadius:"6px",padding:"4px 8px",fontSize:"12px",color:"#f04747",fontWeight:"600",display:"flex",alignItems:"center",gap:"4px"},children:"Ã¢Å¡Â Ã¯Â¸Â ZayÃ„Â±f BaÃ„Å¸lantÃ„Â±"}),Ie==="excellent"&&Me!=="unknown"&&e.jsxs("div",{style:{background:"rgba(67, 181, 129, 0.2)",border:"1px solid #43b581",borderRadius:"6px",padding:"4px 8px",fontSize:"12px",color:"#43b581",fontWeight:"600",display:"flex",alignItems:"center",gap:"4px"},children:["Ã°Å¸â€œÂ¶ ",Me.toUpperCase()]})]}),e.jsxs("div",{style:{color:"rgba(255, 255, 255, 0.7)",fontSize:"14px"},children:["Ã°Å¸â€˜Â¥ ",Le," kiÃ…Å¸i"]}),e.jsx("button",{onClick:l,style:{background:"rgba(255, 255, 255, 0.1)",border:"none",borderRadius:"8px",padding:"8px 16px",color:"#fff",cursor:"pointer",fontSize:"13px"},children:"Ã¢Â¬â€¡Ã¯Â¸Â KÃƒÂ¼ÃƒÂ§ÃƒÂ¼lt"})]}),e.jsx("div",{style:{flex:1,padding:"20px",display:"flex",flexDirection:"column",overflow:"auto",position:"relative",minHeight:0},children:(()=>{const n=D.filter(b=>b.isScreenSharing&&_[`${b.username}_screen`]);if(n.length>0){const b=[];n.forEach(m=>{const X=_[`${m.username}_screen`];X&&b.push({key:`${m.username}_screen`,username:m.username,type:"screen",component:e.jsx(ve,{user:{...m,streamType:"screen"},stream:X,isActive:!1,isPinned:!1,onExpand:a(()=>ce({...m,streamType:"screen"}),"onExpand"),onPin:a(()=>{},"onPin"),onContextMenu:a(De=>U(De),"onContextMenu"),badge:he({...m,streamType:"screen"}),connectionQuality:me[m.username],getUserAvatar:ie},`${m.username}_screen`)})}),D.forEach(m=>{const X=_[`${m.username}_camera`]||_[m.username];(X&&X.active||m.isLocal)&&b.push({key:`${m.username}_camera`,username:m.username,type:"camera",component:e.jsx(ve,{user:{...m,streamType:"camera",volume:je[m.username]||100,onVolumeChange:a(be=>Ce(m.username,be),"onVolumeChange"),isTalking:Ye[m.username]||!1},stream:X,isActive:L===m.username,isPinned:de===m.username,onExpand:a(()=>ce({...m,streamType:"camera"}),"onExpand"),onPin:a(()=>ze(de===m.username?null:m.username),"onPin"),onContextMenu:a(be=>U(be),"onContextMenu"),badge:he(m),connectionQuality:me[m.username],getUserAvatar:ie},`${m.username}_camera`)})});const o=b.length;let x,W;return o<=2?(x=o,W=1):o<=4?(x=2,W=2):o<=6?(x=3,W=2):(x=3,W=Math.ceil(o/3)),e.jsx("div",{style:{width:"100%",height:"100%",display:"grid",gridTemplateColumns:`repeat(${x}, 1fr)`,gridTemplateRows:`repeat(${W}, 1fr)`,gap:"16px",padding:"0",position:"relative"},children:b.map((m,X)=>e.jsx("div",{style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",zIndex:1,isolation:"isolate"},children:m.component},m.key))})}else return D.some(o=>{const x=_[`${o.username}_camera`]||_[o.username];return x&&x.active})?e.jsx("div",{style:{flex:1,display:"grid",gridTemplateColumns:`repeat(${We}, 1fr)`,gridTemplateRows:`repeat(${Pe}, 1fr)`,gap:"16px",minHeight:"400px",height:"100%"},children:D.map(o=>{const x=_[`${o.username}_camera`]||(o.isLocal?null:_[o.username]);return e.jsx(ve,{user:{...o,streamType:"camera",volume:je[o.username]||100,onVolumeChange:a(W=>Ce(o.username,W),"onVolumeChange")},stream:x,isActive:L===o.username,isPinned:de===o.username,onExpand:a(()=>ce({...o,streamType:"camera"}),"onExpand"),onPin:a(()=>ze(de===o.username?null:o.username),"onPin"),onContextMenu:a(W=>U(W),"onContextMenu"),badge:he({...o,streamType:"camera"}),connectionQuality:me[o.username],getUserAvatar:ie},`${o.username}_camera`)})}):e.jsx("div",{style:{flex:1,display:"grid",gridTemplateColumns:`repeat(${Math.min(We,3)}, 1fr)`,gridTemplateRows:`repeat(${Pe}, 1fr)`,gap:"24px",padding:"40px",alignItems:"center",justifyContent:"center"},children:D.map(o=>e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"12px",padding:"32px",borderRadius:"16px",background:L===o.username?"linear-gradient(135deg, rgba(88, 101, 242, 0.25) 0%, rgba(114, 137, 218, 0.15) 100%)":"rgba(47, 49, 54, 0.5)",border:L===o.username?"2px solid rgba(88, 101, 242, 0.9)":"2px solid rgba(79, 84, 92, 0.3)",boxShadow:L===o.username?"0 8px 32px rgba(88, 101, 242, 0.4), 0 0 20px rgba(88, 101, 242, 0.3)":"0 4px 12px rgba(0, 0, 0, 0.2)",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",cursor:"pointer",position:"relative",transform:L===o.username?"scale(1.05)":"scale(1)",animation:"slideIn 0.4s ease forwards"},onClick:a(()=>U({user:o,position:{x:window.innerWidth/2,y:window.innerHeight/2}}),"onClick"),children:[e.jsx("div",{style:{width:"140px",height:"140px",borderRadius:"50%",overflow:"hidden",border:`5px solid ${L===o.username?"#5865f2":"#40444b"}`,boxShadow:L===o.username?"0 8px 24px rgba(88, 101, 242, 0.6), inset 0 0 20px rgba(88, 101, 242, 0.2)":"0 4px 12px rgba(0, 0, 0, 0.4)",animation:L===o.username?"pulse 1.5s infinite":"none",position:"relative"},children:e.jsx("img",{src:ie(o.username),alt:o.username,onError:a(x=>{x.target.onerror=null,x.target.src=xe(o.username,256)},"onError"),style:{width:"100%",height:"100%",objectFit:"cover",filter:L===o.username?"brightness(1.1)":"brightness(0.95)"}})}),e.jsx("div",{style:{fontSize:"20px",fontWeight:"700",color:L===o.username?"#dee0fc":"#fff",textAlign:"center",textShadow:"0 2px 8px rgba(0, 0, 0, 0.7)",letterSpacing:"0.3px"},children:o.username}),e.jsxs("div",{style:{display:"flex",gap:"12px",fontSize:"22px",marginTop:"4px"},children:[o.isMuted&&e.jsx("span",{title:"Mikrofon KapalÃ„Â±",style:{filter:"drop-shadow(0 2px 4px rgba(0, 0, 0, 0.5))"},children:"Ã°Å¸â€â€¡"}),o.isDeafened&&e.jsx("span",{title:"KulaklÃ„Â±k KapalÃ„Â±",style:{filter:"drop-shadow(0 2px 4px rgba(0, 0, 0, 0.5))"},children:"Ã°Å¸â€Ë†"})]})]},o.username))})})()}),Oe&&Be&&e.jsxs("div",{style:{position:"absolute",bottom:"100px",left:"50%",transform:"translateX(-50%)",background:"linear-gradient(135deg, rgba(250, 166, 26, 0.95) 0%, rgba(237, 66, 69, 0.95) 100%)",color:"#fff",padding:"16px 24px",borderRadius:"12px",zIndex:1e3,display:"flex",alignItems:"center",gap:"12px",boxShadow:"0 8px 32px rgba(250, 166, 26, 0.6)",animation:"pulse 2s infinite",maxWidth:"90%"},children:[e.jsx("div",{style:{fontSize:"24px",animation:"pulse 1.5s infinite"},children:"Ã¢Å¡Â Ã¯Â¸Â"}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:"4px",fontSize:"15px"},children:"Echo Tespit Edildi!"}),e.jsx("div",{style:{fontSize:"13px",opacity:.9},children:"KulaklÃ„Â±k kullanmanÃ„Â±z ÃƒÂ¶nerilir. HoparlÃƒÂ¶r kullanÃ„Â±mÃ„Â± echo'ya neden olur."})]}),e.jsx("button",{onClick:a(()=>Ve(!1),"onClick"),style:{background:"rgba(255, 255, 255, 0.2)",border:"none",borderRadius:"6px",color:"#fff",padding:"6px 12px",cursor:"pointer",fontSize:"12px",fontWeight:"bold"},children:"Kapat"})]}),qe&&e.jsx(st,{onClose:a(()=>Ee(!1),"onClose"),channelId:t}),fe&&e.jsx(ot,{user:fe.user,position:fe.position,onClose:a(()=>U(null),"onClose"),onSendMessage:Ue,onAddFriend:Xe,onBlock:Je,onViewProfile:Qe,onMuteUser:Ze,onAdjustVolume:et,currentUser:M,isInVoiceChat:!0})]})},"VoiceChatPanel"),_t=Z.memo(yt);export{_t as default};
