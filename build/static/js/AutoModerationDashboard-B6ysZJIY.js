var L=Object.defineProperty;var l=(o,r)=>L(o,"name",{value:r,configurable:!0});import{r as p,j as e}from"./react-core-Djgtqrmb.js";import{a1 as I,a as R,d as z,ay as _,z as B,a9 as T,az as A,an as D,O as F}from"./icons-vendor-BMXAt4pj.js";import{d as W}from"./index-D0nbcjO7.js";import"./media-vendor-CxFPycob.js";import"./router-vendor-gmJ9Mn-1.js";import"./state-vendor-CbW2fAN9.js";import"./crypto-vendor-D1XRGppi.js";import"./ui-vendor-IhB9Znpc.js";const t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,backdropFilter:"blur(5px)"},panel:{backgroundColor:"#2b2d31",borderRadius:"12px",width:"90%",maxWidth:"1000px",maxHeight:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.5)",overflow:"hidden"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #1e1f22"},headerLeft:{display:"flex",alignItems:"center",gap:"12px"},headerIcon:{fontSize:"24px",color:"#5865f2"},title:{margin:0,color:"#fff",fontSize:"24px",fontWeight:"600"},closeButton:{background:"none",border:"none",color:"#b9bbbe",cursor:"pointer",fontSize:"24px",padding:"8px",borderRadius:"4px"},statsGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px",padding:"20px",borderBottom:"1px solid #1e1f22"},statCard:{backgroundColor:"#1e1f22",borderRadius:"8px",padding:"16px",textAlign:"center"},statIcon:{fontSize:"32px",marginBottom:"8px"},statValue:{fontSize:"32px",fontWeight:"bold",color:"#fff",marginBottom:"4px"},statLabel:{fontSize:"14px",color:"#b9bbbe"},section:{padding:"20px",borderBottom:"1px solid #1e1f22",overflowY:"auto"},sectionHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},sectionTitle:{color:"#fff",fontSize:"18px",fontWeight:"600",margin:0,display:"flex",alignItems:"center",gap:"8px"},addButton:{backgroundColor:"#5865f2",color:"#fff",border:"none",borderRadius:"6px",padding:"8px 16px",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",fontSize:"14px",fontWeight:"600"},loading:{textAlign:"center",color:"#b9bbbe",padding:"40px"},empty:{textAlign:"center",color:"#b9bbbe",padding:"40px",fontSize:"14px"},rulesList:{display:"flex",flexDirection:"column",gap:"12px"},ruleCard:{backgroundColor:"#1e1f22",borderRadius:"8px",padding:"16px"},ruleHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},ruleType:{display:"flex",alignItems:"center",gap:"8px",fontSize:"16px",fontWeight:"600",color:"#fff"},ruleActions:{display:"flex",alignItems:"center",gap:"12px"},switch:{position:"relative",display:"inline-block",width:"44px",height:"24px"},slider:{position:"absolute",cursor:"pointer",top:0,left:0,right:0,bottom:0,backgroundColor:"#72767d",transition:"0.3s",borderRadius:"24px"},deleteBtn:{background:"none",border:"none",color:"#ed4245",cursor:"pointer",fontSize:"18px",padding:"4px"},ruleDetails:{display:"flex",flexDirection:"column",gap:"8px"},ruleInfo:{display:"flex",gap:"8px",fontSize:"14px"},ruleLabel:{color:"#b9bbbe",fontWeight:"500"},ruleValue:{color:"#fff"},logsList:{display:"flex",flexDirection:"column",gap:"8px"},logItem:{display:"flex",alignItems:"center",gap:"12px",backgroundColor:"#1e1f22",borderRadius:"6px",padding:"12px"},logIcon:{fontSize:"24px"},logContent:{flex:1},logText:{color:"#fff",fontSize:"14px",marginBottom:"4px"},logMeta:{color:"#72767d",fontSize:"12px"},logAction:{marginLeft:"auto"},modalOverlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10001},modal:{backgroundColor:"#2b2d31",borderRadius:"12px",padding:"24px",width:"90%",maxWidth:"500px"},modalTitle:{color:"#fff",fontSize:"20px",marginBottom:"20px"},formGroup:{marginBottom:"16px"},label:{display:"block",color:"#b9bbbe",fontSize:"14px",marginBottom:"8px",fontWeight:"500"},select:{width:"100%",backgroundColor:"#1e1f22",border:"1px solid #1e1f22",borderRadius:"6px",padding:"10px",color:"#fff",fontSize:"14px"},input:{width:"100%",backgroundColor:"#1e1f22",border:"1px solid #1e1f22",borderRadius:"6px",padding:"10px",color:"#fff",fontSize:"14px"},modalButtons:{display:"flex",gap:"12px",justifyContent:"flex-end",marginTop:"20px"},cancelBtn:{backgroundColor:"#4e5058",color:"#fff",border:"none",borderRadius:"6px",padding:"10px 20px",cursor:"pointer",fontSize:"14px"},createBtn:{backgroundColor:"#5865f2",color:"#fff",border:"none",borderRadius:"6px",padding:"10px 20px",cursor:"pointer",fontSize:"14px",fontWeight:"600"}},V=l(({serverId:o,fetchWithAuth:r,apiBaseUrl:d})=>{const[c,n]=p.useState([]),[u,g]=p.useState([]),[k,f]=p.useState({total_violations:0,auto_deleted:0,warnings_issued:0,users_banned:0}),[C,y]=p.useState(!1),[b,m]=p.useState({rule_type:"toxic",action:"warn",threshold:.8,keywords:[]}),[w,j]=p.useState(!0);return{rules:c,logs:u,stats:k,loading:w,showCreateRule:C,setShowCreateRule:y,newRule:b,setNewRule:m,loadData:l(async()=>{j(!0);try{const i=await r(`${d}/moderation/rules/${o}/`);if(i.ok){const v=await i.json();n(v.rules||[])}const a=await r(`${d}/moderation/logs/${o}/`);if(a.ok){const v=await a.json(),x=v.logs||v;g(x),x.length>0&&f({total_violations:x.length,auto_deleted:x.filter(h=>h.action==="delete").length,warnings_issued:x.filter(h=>h.action==="warn").length,users_banned:x.filter(h=>h.action==="ban").length})}}catch{}j(!1)},"loadData"),createRule:l(async()=>{try{const i=await r(`${d}/moderation/rules/${o}/create/`,{method:"POST",body:JSON.stringify(b)});if(i.ok){const a=await i.json();n([...c,a]),y(!1),m({rule_type:"toxic",action:"warn",threshold:.8,keywords:[]})}}catch{}},"createRule"),toggleRule:l(async i=>{try{await r(`${d}/moderation/rules/${i}/toggle/`,{method:"POST"}),n(c.map(a=>a.id===i?{...a,is_enabled:!a.is_enabled}:a))}catch{}},"toggleRule"),deleteRule:l(async i=>{if(await W("Bu kuralÄ± silmek istediÄŸine emin misin?"))try{await r(`${d}/moderation/rules/${i}/`,{method:"DELETE"}),n(c.filter(a=>a.id!==i))}catch{}},"deleteRule")}},"useAutoModeration"),$=l(o=>{switch(o){case"toxic":return"â˜ ï¸";case"spam":return"ðŸš«";case"keyword":return"ðŸ”¤";case"link":return"ðŸ”—";case"caps":return"ðŸ“¢";default:return"âš™ï¸"}},"getRuleIcon"),M=l(o=>{switch(o){case"toxic":return"Toxic Language";case"spam":return"Spam Detection";case"keyword":return"Keyword Filter";case"link":return"Link Filter";case"caps":return"Excessive Caps";default:return o}},"getRuleLabel"),E=l(o=>{switch(o){case"warn":return"âš ï¸ Warn";case"delete":return"ðŸ—‘ï¸ Delete";case"timeout":return"â±ï¸ Timeout";case"kick":return"ðŸ‘¢ Kick";case"ban":return"ðŸ”¨ Ban";default:return o}},"getActionLabel"),G=l(o=>{switch(o){case"warn":return"âš ï¸";case"delete":return"ðŸ—‘ï¸";case"timeout":return"â±ï¸";case"ban":return"ðŸ”¨";default:return"â“"}},"getActionIcon"),K=l(o=>({padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"600",backgroundColor:o==="ban"?"#ed4245":o==="timeout"?"#f0b132":"#5865f2",color:"#fff"}),"getActionStyle"),O=l(({newRule:o,setNewRule:r,onClose:d,onCreateRule:c})=>e.jsx("div",{style:t.modalOverlay,onClick:d,children:e.jsxs("div",{style:t.modal,onClick:l(n=>n.stopPropagation(),"onClick"),children:[e.jsx("h3",{style:t.modalTitle,children:"Create Moderation Rule"}),e.jsxs("div",{style:t.formGroup,children:[e.jsx("label",{style:t.label,children:"Rule Type"}),e.jsxs("select",{value:o.rule_type,onChange:l(n=>r({...o,rule_type:n.target.value}),"onChange"),style:t.select,children:[e.jsx("option",{value:"toxic",children:"Toxic Language"}),e.jsx("option",{value:"spam",children:"Spam Detection"}),e.jsx("option",{value:"keyword",children:"Keyword Filter"}),e.jsx("option",{value:"link",children:"Link Filter"}),e.jsx("option",{value:"caps",children:"Excessive Caps"})]})]}),e.jsxs("div",{style:t.formGroup,children:[e.jsx("label",{style:t.label,children:"Action"}),e.jsxs("select",{value:o.action,onChange:l(n=>r({...o,action:n.target.value}),"onChange"),style:t.select,children:[e.jsx("option",{value:"warn",children:"Warn User"}),e.jsx("option",{value:"delete",children:"Delete Message"}),e.jsx("option",{value:"timeout",children:"Timeout User (5min)"}),e.jsx("option",{value:"kick",children:"Kick User"}),e.jsx("option",{value:"ban",children:"Ban User"})]})]}),o.rule_type!=="keyword"&&e.jsxs("div",{style:t.formGroup,children:[e.jsxs("label",{style:t.label,children:["AI Threshold (",(o.threshold*100).toFixed(0),"%)"]}),e.jsx("input",{type:"range",min:"0.5",max:"1",step:"0.05",value:o.threshold,onChange:l(n=>r({...o,threshold:parseFloat(n.target.value)}),"onChange"),style:t.slider})]}),o.rule_type==="keyword"&&e.jsxs("div",{style:t.formGroup,children:[e.jsx("label",{style:t.label,children:"Keywords (comma separated)"}),e.jsx("input",{type:"text",placeholder:"word1, word2, word3",onChange:l(n=>r({...o,keywords:n.target.value.split(",").map(u=>u.trim())}),"onChange"),style:t.input})]}),e.jsxs("div",{style:t.modalButtons,children:[e.jsx("button",{onClick:d,style:t.cancelBtn,children:"Cancel"}),e.jsx("button",{onClick:c,style:t.createBtn,children:"Create Rule"})]})]})}),"CreateRuleModal"),te=l(({serverId:o,fetchWithAuth:r,apiBaseUrl:d,onClose:c})=>{const{rules:n,logs:u,stats:g,showCreateRule:k,setShowCreateRule:f,newRule:C,setNewRule:y,loading:b,createRule:m,toggleRule:w,deleteRule:j}=V(o);return e.jsx("div",{style:t.overlay,onClick:c,children:e.jsxs("div",{style:t.panel,onClick:l(s=>s.stopPropagation(),"onClick"),children:[e.jsxs("div",{style:t.header,children:[e.jsxs("div",{style:t.headerLeft,children:[e.jsx(I,{style:t.headerIcon}),e.jsx("h2",{style:t.title,children:"Auto-Moderation"})]}),e.jsx("button",{onClick:c,style:t.closeButton,children:e.jsx(R,{})})]}),e.jsxs("div",{style:t.statsGrid,children:[e.jsxs("div",{style:t.statCard,children:[e.jsx(z,{style:{...t.statIcon,color:"#f04747"}}),e.jsx("div",{style:t.statValue,children:g.total_violations}),e.jsx("div",{style:t.statLabel,children:"Total Violations"})]}),e.jsxs("div",{style:t.statCard,children:[e.jsx(_,{style:{...t.statIcon,color:"#ed4245"}}),e.jsx("div",{style:t.statValue,children:g.auto_deleted}),e.jsx("div",{style:t.statLabel,children:"Auto-Deleted"})]}),e.jsxs("div",{style:t.statCard,children:[e.jsx(B,{style:{...t.statIcon,color:"#f0b132"}}),e.jsx("div",{style:t.statValue,children:g.warnings_issued}),e.jsx("div",{style:t.statLabel,children:"Warnings"})]}),e.jsxs("div",{style:t.statCard,children:[e.jsx(T,{style:{...t.statIcon,color:"#43b581"}}),e.jsx("div",{style:t.statValue,children:n.filter(s=>s.is_enabled).length}),e.jsx("div",{style:t.statLabel,children:"Active Rules"})]})]}),e.jsxs("div",{style:t.section,children:[e.jsxs("div",{style:t.sectionHeader,children:[e.jsxs("h3",{style:t.sectionTitle,children:[e.jsx(A,{})," Moderation Rules"]}),e.jsxs("button",{onClick:l(()=>f(!0),"onClick"),style:t.addButton,children:[e.jsx(D,{})," Add Rule"]})]}),b?e.jsx("div",{style:t.loading,children:"Loading..."}):n.length===0?e.jsx("div",{style:t.empty,children:"No moderation rules yet. Create one to get started!"}):e.jsx("div",{style:t.rulesList,children:n.map(s=>e.jsxs("div",{style:t.ruleCard,children:[e.jsxs("div",{style:t.ruleHeader,children:[e.jsxs("div",{style:t.ruleType,children:[$(s.rule_type),e.jsx("span",{children:M(s.rule_type)})]}),e.jsxs("div",{style:t.ruleActions,children:[e.jsxs("label",{style:t.switch,children:[e.jsx("input",{type:"checkbox",checked:s.is_enabled,onChange:l(()=>w(s.id),"onChange")}),e.jsx("span",{style:t.slider})]}),e.jsx("button",{onClick:l(()=>j(s.id),"onClick"),style:t.deleteBtn,children:e.jsx(R,{})})]})]}),e.jsxs("div",{style:t.ruleDetails,children:[e.jsxs("div",{style:t.ruleInfo,children:[e.jsx("span",{style:t.ruleLabel,children:"Action:"}),e.jsx("span",{style:t.ruleValue,children:E(s.action)})]}),s.threshold&&e.jsxs("div",{style:t.ruleInfo,children:[e.jsx("span",{style:t.ruleLabel,children:"Threshold:"}),e.jsxs("span",{style:t.ruleValue,children:[(s.threshold*100).toFixed(0),"%"]})]}),s.keywords&&s.keywords.length>0&&e.jsxs("div",{style:t.ruleInfo,children:[e.jsx("span",{style:t.ruleLabel,children:"Keywords:"}),e.jsx("span",{style:t.ruleValue,children:s.keywords.join(", ")})]})]})]},s.id))})]}),e.jsxs("div",{style:t.section,children:[e.jsxs("h3",{style:t.sectionTitle,children:[e.jsx(F,{})," Recent Activity"]}),e.jsx("div",{style:t.logsList,children:u.slice(0,10).map((s,S)=>e.jsxs("div",{style:t.logItem,children:[e.jsx("div",{style:t.logIcon,children:G(s.action)}),e.jsxs("div",{style:t.logContent,children:[e.jsxs("div",{style:t.logText,children:[e.jsx("strong",{children:s.user||"Unknown"})," - ",s.violation_type]}),e.jsxs("div",{style:t.logMeta,children:[s.content?.substring(0,50),"... ","â€¢"," ",new Date(s.created_at).toLocaleString()]})]}),e.jsx("div",{style:t.logAction,children:e.jsx("span",{style:K(s.action),children:s.action})})]},S))})]}),k&&e.jsx(O,{newRule:C,setNewRule:y,onClose:l(()=>f(!1),"onClose"),onCreateRule:m})]})})},"AutoModerationDashboard");export{te as default};
