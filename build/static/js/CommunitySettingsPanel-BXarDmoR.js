import{r as u,j as e}from"./react-core-D6cE4lil.js";import{b4 as b,aa as R,a9 as w,aC as K,cI as Q,a as p,f as A,a5 as k,d as $,u as z,bq as I,br as L,b3 as O,cC as q,aO as D}from"./icons-vendor-DT2gd7vx.js";import{t as g}from"./index-ClHcoIda.js";import"./media-vendor-Du00QUHb.js";import"./router-vendor-wrB4dqw3.js";import"./state-vendor-DnurjGY_.js";import"./crypto-vendor-BYnay7oC.js";import"./ui-vendor-CZOhtEfS.js";const G={is_community:!1,rules_channel_id:"",public_updates_channel_id:"",verification_level:"medium",explicit_content_filter:"medium",default_notifications:"mentions",description:"",preferred_locale:"tr",features:{welcome_screen:!0,member_screening:!1,discovery:!1}},Y=[{value:"none",label:"Yok",description:"Herkes mesaj gÃ¶nderebilir"},{value:"low",label:"DÃ¼ÅŸÃ¼k",description:"E-posta doÄŸrulamasÄ± gerekli"},{value:"medium",label:"Orta",description:"5 dakika kayÄ±tlÄ± olmalÄ±"},{value:"high",label:"YÃ¼ksek",description:"10 dakika sunucuda olmalÄ±"},{value:"highest",label:"En YÃ¼ksek",description:"Telefon doÄŸrulamasÄ± gerekli"}],H=[{value:"disabled",label:"KapalÄ±",description:"Ä°Ã§erik filtresi yok"},{value:"medium",label:"Orta",description:"RolsÃ¼z Ã¼yeler iÃ§in filtrele"},{value:"high",label:"YÃ¼ksek",description:"TÃ¼m mesajlarÄ± filtrele"}],P=(l,i)=>{const[t,s]=u.useState(G),[a,c]=u.useState([]),[r,h]=u.useState([]),[f,y]=u.useState([]),[N,_]=u.useState(!0),[S,j]=u.useState(!1),[C,T]=u.useState("general");u.useEffect(()=>{F(),E()},[]);const v=()=>({Authorization:`Bearer ${localStorage.getItem("access_token")}`}),F=async()=>{try{const n=await fetch(`${l}/servers/${i}/community/settings/`,{headers:v()});if(n.ok){const o=await n.json();s(d=>({...d,...o})),c(o.rules||[]),h(o.screening_questions||[])}}catch{}finally{_(!1)}},E=async()=>{try{const n=await fetch(`${l}/servers/${i}/channels/`,{headers:v()});if(n.ok){const o=await n.json();y((o.channels||o||[]).filter(d=>d.type!=="category"))}}catch{}};return{settings:t,setSettings:s,rules:a,screeningQuestions:r,channels:f,loading:N,saving:S,activeTab:C,setActiveTab:T,saveSettings:async()=>{j(!0);try{(await fetch(`${l}/servers/${i}/community/settings/`,{method:"PUT",headers:{...v(),"Content-Type":"application/json"},body:JSON.stringify({...t,rules:a,screening_questions:r})})).ok&&g.success("âœ… Topluluk ayarlarÄ± kaydedildi")}catch{g.error("Kaydetme baÅŸarÄ±sÄ±z")}finally{j(!1)}},addRule:()=>c(n=>[...n,{id:Date.now(),title:"",description:""}]),updateRule:(n,o,d)=>c(x=>x.map(m=>m.id===n?{...m,[o]:d}:m)),removeRule:n=>c(o=>o.filter(d=>d.id!==n)),addQuestion:()=>h(n=>[...n,{id:Date.now(),question:"",required:!1}]),updateQuestion:(n,o,d)=>h(x=>x.map(m=>m.id===n?{...m,[o]:d}:m)),removeQuestion:n=>h(o=>o.filter(d=>d.id!==n))}},V=({settings:l,setSettings:i,channels:t})=>e.jsxs("div",{className:"settings-tab",children:[e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["Sunucu A","Ã§Ä±","klamas","Ä±"]}),e.jsx("textarea",{value:l.description,onChange:s=>i(a=>({...a,description:s.target.value})),placeholder:"Sunucunuz hakk\\u0131nda k\\u0131sa bir a\\u00E7\\u0131klama...",rows:"3",maxLength:300}),e.jsxs("span",{className:"char-count",children:[l.description?.length||0,"/300"]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:[e.jsx(b,{})," Kurallar Kanal","Ä±"]}),e.jsxs("select",{value:l.rules_channel_id,onChange:s=>i(a=>({...a,rules_channel_id:s.target.value})),children:[e.jsxs("option",{value:"",children:["Se","Ã§","in..."]}),t.map(s=>e.jsxs("option",{value:s.id,children:["#",s.name]},s.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:[e.jsx(R,{})," G","Ã¼","ncellemeler Kanal","Ä±"]}),e.jsxs("select",{value:l.public_updates_channel_id,onChange:s=>i(a=>({...a,public_updates_channel_id:s.target.value})),children:[e.jsxs("option",{value:"",children:["Se","Ã§","in..."]}),t.map(s=>e.jsxs("option",{value:s.id,children:["#",s.name]},s.id))]})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:[e.jsx(w,{})," Tercih Edilen Dil"]}),e.jsxs("select",{value:l.preferred_locale,onChange:s=>i(a=>({...a,preferred_locale:s.target.value})),children:[e.jsxs("option",{value:"tr",children:["ðŸ‡¹ðŸ‡·"," T","Ã¼","rk","Ã§","e"]}),e.jsxs("option",{value:"en",children:["ðŸ‡¬ðŸ‡§"," English"]}),e.jsxs("option",{value:"de",children:["ðŸ‡©ðŸ‡ª"," Deutsch"]}),e.jsxs("option",{value:"fr",children:["ðŸ‡«ðŸ‡·"," Fran","Ã§","ais"]})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:[e.jsx(K,{})," Varsay","Ä±","lan Bildirimler"]}),e.jsxs("select",{value:l.default_notifications,onChange:s=>i(a=>({...a,default_notifications:s.target.value})),children:[e.jsxs("option",{value:"all",children:["T","Ã¼","m Mesajlar"]}),e.jsx("option",{value:"mentions",children:"Sadece Etiketler"})]})]})]}),e.jsxs("div",{className:"feature-toggles",children:[e.jsxs("h4",{children:["Ã–","zellikler"]}),[{key:"welcome_screen",label:"KarÅŸÄ±lama EkranÄ±"},{key:"member_screening",label:"Ãœye Tarama"},{key:"discovery",label:"Sunucu KeÅŸfet"}].map(s=>e.jsxs("label",{className:"feature-item",children:[e.jsx("span",{children:s.label}),e.jsx("input",{type:"checkbox",checked:l.features?.[s.key],onChange:a=>i(c=>({...c,features:{...c.features,[s.key]:a.target.checked}}))})]},s.key))]})]}),B=({rules:l,onAdd:i,onUpdate:t,onRemove:s})=>e.jsxs("div",{className:"settings-tab",children:[e.jsxs("div",{className:"tab-header",children:[e.jsxs("h4",{children:["Sunucu Kurallar","Ä±"]}),e.jsx("button",{className:"add-btn",onClick:i,children:"+ Kural Ekle"})]}),l.length===0?e.jsxs("div",{className:"empty-rules",children:[e.jsx(Q,{}),e.jsxs("p",{children:["Hen","Ã¼","z kural eklenmemi","ÅŸ"]})]}):e.jsx("div",{className:"rules-list",children:l.map((a,c)=>e.jsxs("div",{className:"rule-item",children:[e.jsx("span",{className:"rule-number",children:c+1}),e.jsxs("div",{className:"rule-content",children:[e.jsx("input",{type:"text",placeholder:"Kural ba\\u015Fl\\u0131\\u011F\\u0131...",value:a.title,onChange:r=>t(a.id,"title",r.target.value)}),e.jsx("textarea",{placeholder:"Kural a\\u00E7\\u0131klamas\\u0131...",value:a.description,onChange:r=>t(a.id,"description",r.target.value),rows:"2"})]}),e.jsx("button",{className:"remove-btn",onClick:()=>s(a.id),children:e.jsx(p,{})})]},a.id))})]}),U=({questions:l,onAdd:i,onUpdate:t,onRemove:s})=>e.jsxs("div",{className:"settings-tab",children:[e.jsxs("div",{className:"tab-header",children:[e.jsxs("h4",{children:["Ãœ","ye Tarama Sorular","Ä±"]}),e.jsx("button",{className:"add-btn",onClick:i,children:"+ Soru Ekle"})]}),e.jsxs("p",{className:"tab-description",children:["Yeni ","Ã¼","yeler sunucuya kat","Ä±","lmadan ","Ã¶","nce bu sorular","Ä±"," yan","Ä±","tlamal","Ä±","d","Ä±","r."]}),l.length===0?e.jsxs("div",{className:"empty-rules",children:[e.jsx(A,{}),e.jsxs("p",{children:["Hen","Ã¼","z soru eklenmemi","ÅŸ"]})]}):e.jsx("div",{className:"questions-list",children:l.map((a,c)=>e.jsxs("div",{className:"question-item",children:[e.jsx("span",{className:"question-number",children:c+1}),e.jsxs("div",{className:"question-content",children:[e.jsx("input",{type:"text",placeholder:"Soruyu yaz\\u0131n...",value:a.question,onChange:r=>t(a.id,"question",r.target.value)}),e.jsxs("label",{className:"required-toggle",children:[e.jsx("input",{type:"checkbox",checked:a.required,onChange:r=>t(a.id,"required",r.target.checked)}),e.jsx("span",{children:"Zorunlu"})]})]}),e.jsx("button",{className:"remove-btn",onClick:()=>s(a.id),children:e.jsx(p,{})})]},a.id))})]}),J=({settings:l,setSettings:i,verificationLevels:t,contentFilters:s})=>e.jsxs("div",{className:"settings-tab",children:[e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:[e.jsx(k,{})," Do","ÄŸ","rulama Seviyesi"]}),e.jsx("div",{className:"level-options",children:t.map(a=>e.jsxs("label",{className:`level-option ${l.verification_level===a.value?"selected":""}`,children:[e.jsx("input",{type:"radio",name:"verification",value:a.value,checked:l.verification_level===a.value,onChange:c=>i(r=>({...r,verification_level:c.target.value}))}),e.jsxs("div",{className:"level-info",children:[e.jsx("span",{className:"level-label",children:a.label}),e.jsx("span",{className:"level-desc",children:a.description})]})]},a.value))})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:[e.jsx($,{})," ","Ä°Ã§","erik Filtresi"]}),e.jsx("div",{className:"level-options",children:s.map(a=>e.jsxs("label",{className:`level-option ${l.explicit_content_filter===a.value?"selected":""}`,children:[e.jsx("input",{type:"radio",name:"content-filter",value:a.value,checked:l.explicit_content_filter===a.value,onChange:c=>i(r=>({...r,explicit_content_filter:c.target.value}))}),e.jsxs("div",{className:"level-info",children:[e.jsx("span",{className:"level-label",children:a.label}),e.jsx("span",{className:"level-desc",children:a.description})]})]},a.value))})]})]}),M=[{key:"general",label:"Genel",Icon:O},{key:"rules",label:"Kurallar",Icon:b},{key:"screening",label:"Ãœye Tarama",Icon:q},{key:"safety",label:"GÃ¼venlik",Icon:k}],me=({apiBaseUrl:l,serverId:i,onClose:t})=>{const s=P(l,i);return s.loading?e.jsx("div",{className:"community-settings-overlay",onClick:t,children:e.jsx("div",{className:"community-settings-panel",onClick:a=>a.stopPropagation(),children:e.jsxs("div",{className:"loading",children:["Y","Ã¼","kleniyor..."]})})}):e.jsx("div",{className:"community-settings-overlay",onClick:t,children:e.jsxs("div",{className:"community-settings-panel",onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{className:"panel-header",children:[e.jsxs("h2",{children:[e.jsx(z,{})," Topluluk Ayarlar","Ä±"]}),e.jsx("button",{className:"close-btn",onClick:t,children:e.jsx(p,{})})]}),e.jsxs("div",{className:"community-toggle",children:[e.jsxs("div",{className:"toggle-info",children:[e.jsx("span",{className:"toggle-label",children:"Topluluk Sunucusu"}),e.jsxs("span",{className:"toggle-description",children:["Topluluk ","Ã¶","zelliklerini aktifle","ÅŸ","tir (ke","ÅŸ","fet, kar","ÅŸÄ±","lama ekran","Ä±"," vb.)"]})]}),e.jsx("button",{className:`toggle-btn ${s.settings.is_community?"active":""}`,onClick:()=>s.setSettings(a=>({...a,is_community:!a.is_community})),children:s.settings.is_community?e.jsx(I,{}):e.jsx(L,{})})]}),e.jsx("div",{className:"tabs",children:M.map(({key:a,label:c,Icon:r})=>e.jsxs("button",{className:`tab ${s.activeTab===a?"active":""}`,onClick:()=>s.setActiveTab(a),children:[e.jsx(r,{})," ",c]},a))}),e.jsxs("div",{className:"panel-content",children:[s.activeTab==="general"&&e.jsx(V,{settings:s.settings,setSettings:s.setSettings,channels:s.channels}),s.activeTab==="rules"&&e.jsx(B,{rules:s.rules,onAdd:s.addRule,onUpdate:s.updateRule,onRemove:s.removeRule}),s.activeTab==="screening"&&e.jsx(U,{questions:s.screeningQuestions,onAdd:s.addQuestion,onUpdate:s.updateQuestion,onRemove:s.removeQuestion}),s.activeTab==="safety"&&e.jsx(J,{settings:s.settings,setSettings:s.setSettings,verificationLevels:Y,contentFilters:H})]}),e.jsxs("div",{className:"panel-footer",children:[e.jsxs("button",{className:"cancel-btn",onClick:t,children:["Ä°","ptal"]}),e.jsxs("button",{className:"save-btn",onClick:s.saveSettings,disabled:s.saving,children:[e.jsx(D,{})," ",s.saving?"Kaydediliyor...":"Kaydet"]})]})]})})};export{me as default};
