var E=Object.defineProperty;var o=(a,d)=>E(a,"name",{value:d,configurable:!0});import{r as s,j as e}from"./react-core-Djgtqrmb.js";import{c9 as O,a as J,an as z,bs as M,bc as I,u as q,z as G,aB as V}from"./icons-vendor-BMXAt4pj.js";import{t as c}from"./index-DwVhiipM.js";import"./media-vendor-CxFPycob.js";import"./router-vendor-gmJ9Mn-1.js";import"./state-vendor-CbW2fAN9.js";import"./crypto-vendor-D1XRGppi.js";import"./ui-vendor-IhB9Znpc.js";const re=o(({fetchWithAuth:a,apiBaseUrl:d,onClose:R,serverId:g})=>{const[h,N]=s.useState([]),[l,v]=s.useState(null),[C,H]=s.useState([]),[n,f]=s.useState(null),[x,i]=s.useState("projects"),[m,u]=s.useState(!1),[b,S]=s.useState(""),[D,k]=s.useState(""),[y,w]=s.useState(""),[T,P]=s.useState("");s.useEffect(()=>{B()},[]);const B=o(async()=>{try{const p=await(await a(`${d}/projects/?server_id=${g}`)).json();N(p.projects||[])}catch{}},"fetchProjects"),F=o(async r=>{try{const j=await(await a(`${d}/projects/${r}/`)).json();v(j.project),H(j.documents||[]),i("project-detail")}catch{c.error("Failed to load project")}},"fetchProject"),$=o(async()=>{if(!b.trim()){c.error("Project name required");return}u(!0);try{(await(await a(`${d}/projects/create/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:b,description:D,server_id:g})})).json()).project&&(c.success("Project created!"),S(""),k(""),i("projects"),B())}catch{c.error("Failed to create project")}finally{u(!1)}},"createProject"),L=o(async()=>{if(!y.trim()){c.error("Document title required");return}u(!0);try{(await(await a(`${d}/documents/create/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:y,content:T,project_id:l?.id})})).json()).document&&(c.success("Document created!"),w(""),P(""),F(l.id))}catch{c.error("Failed to create document")}finally{u(!1)}},"createDocument"),_=o(async r=>{try{const j=await(await a(`${d}/documents/${r}/`)).json();f(j.document),i("document")}catch{c.error("Failed to load document")}},"fetchDocument"),A=o(async()=>{if(n)try{await a(`${d}/documents/${n.id}/`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:n.content})}),c.success("Document saved!")}catch{c.error("Failed to save document")}},"saveDocument");return e.jsx("div",{style:t.overlay,children:e.jsxs("div",{style:t.modal,children:[e.jsxs("div",{style:t.header,children:[e.jsxs("div",{style:t.headerLeft,children:[e.jsx(O,{style:{marginRight:"10px",color:"#5865f2"}}),e.jsx("h2",{style:t.title,children:"Project Collaboration"})]}),e.jsx("button",{onClick:R,style:t.closeButton,children:e.jsx(J,{})})]}),e.jsxs("div",{style:t.breadcrumbs,children:[e.jsx("button",{onClick:o(()=>{i("projects"),v(null)},"onClick"),style:t.breadcrumb,children:"Projects"}),l&&e.jsxs(e.Fragment,{children:[e.jsx("span",{style:t.breadcrumbSep,children:"/"}),e.jsx("button",{onClick:o(()=>i("project-detail"),"onClick"),style:t.breadcrumb,children:l.name})]}),n&&e.jsxs(e.Fragment,{children:[e.jsx("span",{style:t.breadcrumbSep,children:"/"}),e.jsx("span",{style:t.breadcrumbActive,children:n.title})]})]}),e.jsxs("div",{style:t.content,children:[x==="projects"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:o(()=>i("create"),"onClick"),style:t.createProjectBtn,children:[e.jsx(z,{})," New Project"]}),e.jsxs("div",{style:t.projectsGrid,children:[h.map(r=>e.jsxs("div",{style:t.projectCard,onClick:o(()=>F(r.id),"onClick"),children:[e.jsx(M,{style:t.projectIcon}),e.jsx("h3",{style:t.projectName,children:r.name}),e.jsx("p",{style:t.projectDesc,children:r.description}),e.jsxs("div",{style:t.projectStats,children:[e.jsxs("span",{children:[e.jsx(I,{})," ",r.stats?.documents||0]}),e.jsxs("span",{children:[e.jsx(q,{})," ",r.member_count]})]})]},r.id)),h.length===0&&e.jsx("p",{style:t.emptyText,children:"No projects yet. Create one!"})]})]}),x==="create"&&e.jsxs("div",{style:t.createForm,children:[e.jsx("h3",{style:t.formTitle,children:"Create New Project"}),e.jsx("input",{type:"text",placeholder:"Project Name",value:b,onChange:o(r=>S(r.target.value),"onChange"),style:t.input}),e.jsx("textarea",{placeholder:"Description (optional)",value:D,onChange:o(r=>k(r.target.value),"onChange"),style:t.textarea}),e.jsxs("div",{style:t.formActions,children:[e.jsx("button",{onClick:o(()=>i("projects"),"onClick"),style:t.cancelBtn,children:"Cancel"}),e.jsx("button",{onClick:$,style:t.submitBtn,disabled:m,children:m?"Creating...":"Create Project"})]})]}),x==="project-detail"&&l&&e.jsxs("div",{style:t.projectDetail,children:[e.jsxs("div",{style:t.projectHeader,children:[e.jsxs("div",{children:[e.jsx("h3",{style:t.projectTitle,children:l.name}),e.jsx("p",{style:t.projectDescription,children:l.description})]}),e.jsxs("button",{onClick:o(()=>i("create-doc"),"onClick"),style:t.newDocBtn,children:[e.jsx(z,{})," New Document"]})]}),e.jsxs("div",{style:t.documentsSection,children:[e.jsx("h4",{style:t.sectionTitle,children:"Documents"}),e.jsxs("div",{style:t.documentsList,children:[C.map(r=>e.jsxs("div",{style:t.documentCard,onClick:o(()=>_(r.id),"onClick"),children:[e.jsx(I,{style:t.docIcon}),e.jsxs("div",{style:t.docInfo,children:[e.jsx("h4",{style:t.docTitle,children:r.title}),e.jsxs("span",{style:t.docMeta,children:[e.jsx(G,{})," ",new Date(r.updated_at).toLocaleDateString()," Â· ",r.last_edited_by]})]})]},r.id)),C.length===0&&e.jsx("p",{style:t.emptyText,children:"No documents yet"})]})]}),e.jsxs("div",{style:t.membersSection,children:[e.jsx("h4",{style:t.sectionTitle,children:"Team Members"}),e.jsx("div",{style:t.membersList,children:l.members?.map(r=>e.jsxs("div",{style:t.memberBadge,children:[e.jsx("span",{style:t.memberAvatar,children:r.username.charAt(0).toUpperCase()}),e.jsx("span",{children:r.username}),e.jsx("span",{style:t.memberRole,children:r.role})]},r.id))})]})]}),x==="create-doc"&&e.jsxs("div",{style:t.createForm,children:[e.jsx("h3",{style:t.formTitle,children:"Create New Document"}),e.jsx("input",{type:"text",placeholder:"Document Title",value:y,onChange:o(r=>w(r.target.value),"onChange"),style:t.input}),e.jsx("textarea",{placeholder:"Start writing...",value:T,onChange:o(r=>P(r.target.value),"onChange"),style:{...t.textarea,minHeight:"200px"}}),e.jsxs("div",{style:t.formActions,children:[e.jsx("button",{onClick:o(()=>i("project-detail"),"onClick"),style:t.cancelBtn,children:"Cancel"}),e.jsx("button",{onClick:L,style:t.submitBtn,disabled:m,children:m?"Creating...":"Create Document"})]})]}),x==="document"&&n&&e.jsxs("div",{style:t.documentEditor,children:[e.jsxs("div",{style:t.editorHeader,children:[e.jsx("input",{type:"text",value:n.title,onChange:o(r=>f({...n,title:r.target.value}),"onChange"),style:t.docTitleInput}),e.jsxs("div",{style:t.editorActions,children:[e.jsx("button",{onClick:A,style:t.saveBtn,children:"Save"}),e.jsxs("button",{style:t.historyBtn,children:[e.jsx(V,{})," History"]})]})]}),e.jsx("textarea",{value:n.content,onChange:o(r=>f({...n,content:r.target.value}),"onChange"),style:t.editor,placeholder:"Start writing your document..."}),e.jsxs("div",{style:t.editorFooter,children:[e.jsxs("span",{children:["Version ",n.version]}),e.jsxs("span",{children:["Last edited by ",n.last_edited_by]})]})]})]})]})})},"ProjectCollaborationPanel"),t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e4},modal:{backgroundColor:"#2f3136",borderRadius:"12px",width:"800px",maxHeight:"85vh",overflow:"hidden",display:"flex",flexDirection:"column"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #40444b"},headerLeft:{display:"flex",alignItems:"center"},title:{margin:0,color:"#fff",fontSize:"20px"},closeButton:{background:"none",border:"none",color:"#b9bbbe",cursor:"pointer",fontSize:"20px"},breadcrumbs:{display:"flex",alignItems:"center",padding:"10px 20px",gap:"8px",background:"#36393f"},breadcrumb:{background:"none",border:"none",color:"#5865f2",cursor:"pointer",fontSize:"14px"},breadcrumbSep:{color:"#72767d"},breadcrumbActive:{color:"#dcddde",fontSize:"14px"},content:{padding:"20px",overflowY:"auto",flex:1},createProjectBtn:{background:"#5865f2",border:"none",color:"#fff",padding:"10px 20px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",marginBottom:"20px"},projectsGrid:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"15px"},projectCard:{background:"#40444b",borderRadius:"10px",padding:"20px",cursor:"pointer",transition:"transform 0.2s",":hover":{transform:"translateY(-2px)"}},projectIcon:{color:"#faa61a",fontSize:"30px",marginBottom:"10px"},projectName:{color:"#fff",margin:"0 0 8px",fontSize:"16px"},projectDesc:{color:"#b9bbbe",fontSize:"13px",marginBottom:"15px"},projectStats:{display:"flex",gap:"15px",color:"#72767d",fontSize:"12px"},emptyText:{color:"#72767d",textAlign:"center",padding:"40px",gridColumn:"1 / -1"},createForm:{maxWidth:"500px",margin:"0 auto"},formTitle:{color:"#fff",marginBottom:"20px"},input:{width:"100%",background:"#40444b",border:"none",color:"#fff",padding:"12px",borderRadius:"6px",marginBottom:"15px"},textarea:{width:"100%",background:"#40444b",border:"none",color:"#fff",padding:"12px",borderRadius:"6px",marginBottom:"15px",minHeight:"100px",resize:"vertical"},formActions:{display:"flex",justifyContent:"flex-end",gap:"10px"},cancelBtn:{background:"#40444b",border:"none",color:"#fff",padding:"10px 20px",borderRadius:"6px",cursor:"pointer"},submitBtn:{background:"#5865f2",border:"none",color:"#fff",padding:"10px 20px",borderRadius:"6px",cursor:"pointer"},projectDetail:{display:"flex",flexDirection:"column",gap:"25px"},projectHeader:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},projectTitle:{color:"#fff",margin:"0 0 5px",fontSize:"24px"},projectDescription:{color:"#b9bbbe",margin:0},newDocBtn:{background:"#57f287",border:"none",color:"#000",padding:"10px 16px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},documentsSection:{},sectionTitle:{color:"#b9bbbe",fontSize:"12px",fontWeight:"600",textTransform:"uppercase",marginBottom:"10px"},documentsList:{display:"flex",flexDirection:"column",gap:"8px"},documentCard:{display:"flex",alignItems:"center",gap:"12px",background:"#40444b",padding:"12px 15px",borderRadius:"8px",cursor:"pointer"},docIcon:{color:"#5865f2",fontSize:"20px"},docInfo:{flex:1},docTitle:{color:"#fff",margin:0,fontSize:"14px"},docMeta:{color:"#72767d",fontSize:"12px",display:"flex",alignItems:"center",gap:"5px"},membersSection:{},membersList:{display:"flex",flexWrap:"wrap",gap:"10px"},memberBadge:{display:"flex",alignItems:"center",gap:"8px",background:"#40444b",padding:"8px 12px",borderRadius:"20px"},memberAvatar:{width:"24px",height:"24px",borderRadius:"50%",background:"#5865f2",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontSize:"12px"},memberRole:{color:"#72767d",fontSize:"11px",background:"#36393f",padding:"2px 6px",borderRadius:"4px"},documentEditor:{display:"flex",flexDirection:"column",height:"calc(85vh - 180px)"},editorHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},docTitleInput:{background:"transparent",border:"none",color:"#fff",fontSize:"24px",fontWeight:"bold",flex:1},editorActions:{display:"flex",gap:"10px"},saveBtn:{background:"#57f287",border:"none",color:"#000",padding:"8px 16px",borderRadius:"6px",cursor:"pointer"},historyBtn:{background:"#40444b",border:"none",color:"#fff",padding:"8px 16px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},editor:{flex:1,background:"#40444b",border:"none",color:"#dcddde",padding:"20px",borderRadius:"8px",fontSize:"14px",lineHeight:"1.6",resize:"none"},editorFooter:{display:"flex",justifyContent:"space-between",padding:"10px 0",color:"#72767d",fontSize:"12px"}};export{re as default};
