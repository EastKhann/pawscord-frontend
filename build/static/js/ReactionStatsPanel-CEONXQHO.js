import{r as c,j as s}from"./react-vendor-D8Fi5F9E.js";import{P as _,_ as n,a as y,bp as g,A as f,bo as k,be as $,M as j,x as w}from"./icons-vendor-BPCemF_6.js";import{g as C}from"./index-3z6rwLzK.js";import"./media-vendor-Dp18sh1g.js";import"./router-vendor-CTPwQFnc.js";import"./crypto-vendor-Cz32ecGD.js";import"./state-vendor-De5qIGw3.js";const L=({serverId:h,onClose:o,fetchWithAuth:x})=>{const[e,d]=c.useState(null),[N,v]=c.useState(!0),[t,r]=c.useState("overview"),[m,u]=c.useState("week"),p=c.useCallback(async()=>{v(!0);try{const a=await x(`${C()}/servers/${h}/reaction-stats/?range=${m}`);if(a.ok){const i=await a.json();d(i)}else d({total_reactions:0,unique_emojis:0,top_emojis:[],top_reactors:[],hourly_distribution:Array(24).fill(0),daily_trend:[],most_reacted_messages:[]})}catch(a){console.error("Error loading reaction stats:",a),d({total_reactions:0,unique_emojis:0,top_emojis:[],top_reactors:[],hourly_distribution:Array(24).fill(0),daily_trend:[],most_reacted_messages:[]})}v(!1)},[h,m,x]);c.useEffect(()=>{p()},[p]);const l=a=>a>=1e6?(a/1e6).toFixed(1)+"M":a>=1e3?(a/1e3).toFixed(1)+"K":a?.toString()||"0",b=()=>e?.hourly_distribution?Math.max(...e.hourly_distribution,1):1;return N?s.jsx("div",{className:"reaction-stats-overlay",onClick:o,children:s.jsx("div",{className:"reaction-stats-panel",onClick:a=>a.stopPropagation(),children:s.jsxs("div",{className:"loading-spinner",children:[s.jsx(_,{className:"spin"}),s.jsx("span",{children:"Loading reaction statistics..."})]})})}):s.jsx("div",{className:"reaction-stats-overlay",onClick:o,children:s.jsxs("div",{className:"reaction-stats-panel",onClick:a=>a.stopPropagation(),children:[s.jsxs("div",{className:"panel-header",children:[s.jsxs("div",{className:"header-info",children:[s.jsxs("h2",{children:[s.jsx(n,{})," Reaction Statistics"]}),s.jsx("span",{className:"subtitle",children:"Discover emoji trends and patterns"})]}),s.jsxs("div",{className:"header-actions",children:[s.jsxs("select",{value:m,onChange:a=>u(a.target.value),className:"time-range-select",children:[s.jsx("option",{value:"day",children:"Last 24 Hours"}),s.jsx("option",{value:"week",children:"Last 7 Days"}),s.jsx("option",{value:"month",children:"Last 30 Days"}),s.jsx("option",{value:"all",children:"All Time"})]}),s.jsx("button",{className:"close-btn",onClick:o,children:s.jsx(y,{})})]})]}),s.jsxs("div",{className:"stats-overview",children:[s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-icon",children:s.jsx(g,{})}),s.jsxs("div",{className:"stat-info",children:[s.jsx("span",{className:"stat-value",children:l(e?.total_reactions)}),s.jsx("span",{className:"stat-label",children:"Total Reactions"})]})]}),s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-icon",children:s.jsx(n,{})}),s.jsxs("div",{className:"stat-info",children:[s.jsx("span",{className:"stat-value",children:l(e?.unique_emojis)}),s.jsx("span",{className:"stat-label",children:"Unique Emojis"})]})]}),s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-icon",children:s.jsx(f,{})}),s.jsxs("div",{className:"stat-info",children:[s.jsx("span",{className:"stat-value",children:l(e?.top_reactors?.length)}),s.jsx("span",{className:"stat-label",children:"Active Reactors"})]})]}),s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-icon",children:s.jsx(k,{})}),s.jsxs("div",{className:"stat-info",children:[s.jsx("span",{className:"stat-value",children:e?.top_emojis?.[0]?.emoji||"ðŸ”¥"}),s.jsx("span",{className:"stat-label",children:"Top Emoji"})]})]})]}),s.jsxs("div",{className:"tabs",children:[s.jsxs("button",{className:`tab ${t==="overview"?"active":""}`,onClick:()=>r("overview"),children:[s.jsx($,{})," Overview"]}),s.jsxs("button",{className:`tab ${t==="emojis"?"active":""}`,onClick:()=>r("emojis"),children:[s.jsx(n,{})," Top Emojis"]}),s.jsxs("button",{className:`tab ${t==="users"?"active":""}`,onClick:()=>r("users"),children:[s.jsx(j,{})," Top Reactors"]}),s.jsxs("button",{className:`tab ${t==="time"?"active":""}`,onClick:()=>r("time"),children:[s.jsx(w,{})," Activity Pattern"]})]}),s.jsxs("div",{className:"tab-content",children:[t==="overview"&&s.jsx("div",{className:"overview-tab",children:s.jsxs("div",{className:"section",children:[s.jsx("h3",{children:"ðŸ”¥ Trending Emojis"}),s.jsxs("div",{className:"emoji-grid",children:[(e?.top_emojis||[]).slice(0,10).map((a,i)=>s.jsxs("div",{className:"emoji-item",children:[s.jsx("span",{className:"emoji",children:a.emoji}),s.jsx("span",{className:"count",children:l(a.count)}),s.jsx("div",{className:"progress-bar",children:s.jsx("div",{className:"progress",style:{width:`${a.count/(e?.top_emojis?.[0]?.count||1)*100}%`}})})]},i)),(!e?.top_emojis||e.top_emojis.length===0)&&s.jsx("div",{className:"empty-state",children:"No reaction data yet"})]})]})}),t==="emojis"&&s.jsx("div",{className:"emojis-tab",children:s.jsxs("div",{className:"emoji-leaderboard",children:[(e?.top_emojis||[]).map((a,i)=>s.jsxs("div",{className:`leaderboard-item ${i<3?"top-three":""}`,children:[s.jsxs("span",{className:"rank",children:["#",i+1]}),s.jsx("span",{className:"emoji-large",children:a.emoji}),s.jsxs("div",{className:"emoji-details",children:[s.jsx("span",{className:"emoji-name",children:a.name||"Custom Emoji"}),s.jsxs("span",{className:"emoji-usage",children:[l(a.count)," uses"]})]}),s.jsx("div",{className:"emoji-bar",children:s.jsx("div",{className:"bar-fill",style:{width:`${a.count/(e?.top_emojis?.[0]?.count||1)*100}%`}})})]},i)),(!e?.top_emojis||e.top_emojis.length===0)&&s.jsxs("div",{className:"empty-state",children:[s.jsx(n,{size:48}),s.jsx("p",{children:"No emoji data available"})]})]})}),t==="users"&&s.jsx("div",{className:"users-tab",children:s.jsxs("div",{className:"user-leaderboard",children:[(e?.top_reactors||[]).map((a,i)=>s.jsxs("div",{className:`user-item ${i<3?"top-three":""}`,children:[s.jsx("span",{className:`rank rank-${i+1}`,children:i<3?s.jsx(j,{}):`#${i+1}`}),s.jsx("div",{className:"user-avatar",children:a.avatar?s.jsx("img",{src:a.avatar,alt:a.username}):a.username?.charAt(0).toUpperCase()||"?"}),s.jsxs("div",{className:"user-info",children:[s.jsx("span",{className:"username",children:a.username}),s.jsxs("span",{className:"reaction-count",children:[l(a.count)," reactions"]})]}),s.jsx("div",{className:"user-favorite",children:s.jsx("span",{className:"favorite-emoji",children:a.favorite_emoji||"â¤ï¸"})})]},i)),(!e?.top_reactors||e.top_reactors.length===0)&&s.jsxs("div",{className:"empty-state",children:[s.jsx(j,{size:48}),s.jsx("p",{children:"No reactor data available"})]})]})}),t==="time"&&s.jsx("div",{className:"time-tab",children:s.jsxs("div",{className:"section",children:[s.jsx("h3",{children:"â° Hourly Activity"}),s.jsx("div",{className:"hourly-chart",children:(e?.hourly_distribution||Array(24).fill(0)).map((a,i)=>s.jsxs("div",{className:"hour-bar",children:[s.jsx("div",{className:"bar",style:{height:`${Math.max(a/b()*100,5)}%`},title:`${i}:00 - ${a} reactions`}),s.jsx("span",{className:"hour-label",children:i})]},i))}),s.jsx("p",{className:"chart-note",children:"Hours shown in your local timezone"})]})})]})]})})};export{L as default};
