import{r,d as e,X as g,cU as k,C as S,dD as z,aE as T,cd as F}from"./react-core-DrOm_csO.js";import{t as o}from"./index-DmEhdEtw.js";const P=({username:C,apiBaseUrl:d,fetchWithAuth:E,currentRoomSlug:w})=>{const[l,y]=r.useState("chat"),[b,p]=r.useState([]),[i,m]=r.useState(""),[u,c]=r.useState(!1),[v,A]=r.useState({used:0,limit:100}),[h,I]=r.useState([]),N=r.useRef(null);r.useEffect(()=>{f()},[]),r.useEffect(()=>{j()},[b]);const j=()=>{N.current?.scrollIntoView({behavior:"smooth"})},f=async()=>{try{const t=await(await E(`${d}/ai/quota/`)).json();A(t)}catch(a){console.error("Failed to fetch AI quota:",a)}},$=async a=>{if(a.preventDefault(),!i.trim()||u)return;const t=i.trim();m(""),p(s=>[...s,{role:"user",content:t,timestamp:new Date}]),c(!0);try{const n=await(await E(`${d}/ai/chat/`,{method:"POST",body:JSON.stringify({message:t,context:w||"general"})})).json();p(O=>[...O,{role:"assistant",content:n.response,timestamp:new Date}]),f(),o.success("ğŸ¤– AI yanÄ±tladÄ±!")}catch(s){console.error("AI chat error:",s),o.error("âŒ AI hatasÄ±!"),p(n=>[...n,{role:"assistant",content:"ÃœzgÃ¼nÃ¼m, bir hata oluÅŸtu.",timestamp:new Date,error:!0}])}finally{c(!1)}},R=async a=>{c(!0);try{const s=await(await E(`${d}/ai/smart-reply/`,{method:"POST",body:JSON.stringify({message_id:a,count:3})})).json();I(s.suggestions||[]),o.success("ğŸ’¡ AkÄ±llÄ± cevaplar hazÄ±r!")}catch(t){console.error("Smart reply error:",t),o.error("âŒ AkÄ±llÄ± cevap hatasÄ±!")}finally{c(!1)}},x=async a=>{c(!0);try{const s=await(await E(`${d}/ai/summarize/`,{method:"POST",body:JSON.stringify({message_ids:a,max_length:200})})).json();p(n=>[...n,{role:"assistant",content:`ğŸ“ **Ã–zet:**

${s.summary}`,timestamp:new Date,type:"summary"}]),o.success("ğŸ“ Mesajlar Ã¶zetlendi!")}catch(t){console.error("Summarize error:",t),o.error("âŒ Ã–zetleme hatasÄ±!")}finally{c(!1)}},D=async a=>{c(!0);try{const s=await(await E(`${d}/ai/code/`,{method:"POST",body:JSON.stringify({prompt:a,language:"javascript"})})).json();p(n=>[...n,{role:"assistant",content:`\`\`\`${s.language}
${s.code}
\`\`\`

${s.explanation||""}`,timestamp:new Date,type:"code"}]),o.success("ğŸ’» Kod oluÅŸturuldu!")}catch(t){console.error("Code generation error:",t),o.error("âŒ Kod Ã¼retme hatasÄ±!")}finally{c(!1)}},K=()=>{const a=v.used/v.limit*100,t=a>90?"#ed4245":a>70?"#faa61a":"#43b581";return e.createElement("div",{className:"ai-quota-container"},e.createElement("div",{className:"ai-quota-info"},e.createElement(F,null),e.createElement("span",null,"AI KullanÄ±m: ",v.used," / ",v.limit)),e.createElement("div",{className:"ai-quota-bar"},e.createElement("div",{className:"ai-quota-fill",style:{width:`${a}%`,backgroundColor:t}})))};return e.createElement("div",{className:"ai-chatbot-panel"},e.createElement("div",{className:"ai-header"},e.createElement("div",{className:"ai-header-left"},e.createElement(g,{size:28}),e.createElement("div",null,e.createElement("h3",{className:"ai-title"},"AI Assistant"),e.createElement("p",{className:"ai-subtitle"},"Discord'u geÃ§en AI Ã¶zellikleri"))),K()),e.createElement("div",{className:"ai-tabs"},e.createElement("button",{className:l==="chat"?"active":"",onClick:()=>y("chat")},e.createElement(g,null)," Chat"),e.createElement("button",{className:l==="smart-reply"?"active":"",onClick:()=>y("smart-reply")},e.createElement(k,null)," Smart Reply"),e.createElement("button",{className:l==="summarize"?"active":"",onClick:()=>y("summarize")},e.createElement(S,null)," Ã–zetle"),e.createElement("button",{className:l==="code"?"active":"",onClick:()=>y("code")},e.createElement(z,null)," Kod OluÅŸtur")),l==="chat"&&e.createElement("div",{className:"ai-chat-container"},e.createElement("div",{className:"ai-messages"},b.length===0?e.createElement("div",{className:"ai-empty-state"},e.createElement(g,{size:48}),e.createElement("h4",null,"AI Assistant'a HoÅŸ Geldin!"),e.createElement("p",null,"Soru sor, kod yazdÄ±r, mesajlarÄ± Ã¶zetle veya aÃ§Ä±klama iste."),e.createElement("div",{className:"ai-suggestions"},e.createElement("button",{onClick:()=>m("JavaScript ile bir todo list nasÄ±l yapÄ±lÄ±r?")},"ğŸ’» Kod Ã¶rneÄŸi iste"),e.createElement("button",{onClick:()=>m("React hooks nedir?")},"ğŸ“ Kavram aÃ§Ä±kla"),e.createElement("button",{onClick:()=>m("BugÃ¼n hava nasÄ±l?")},"ğŸ’¬ Sohbet et"))):b.map((a,t)=>e.createElement("div",{key:t,className:`ai-message ${a.role} ${a.error?"error":""}`},e.createElement("div",{className:"ai-message-avatar"},a.role==="user"?"ğŸ‘¤":"ğŸ¤–"),e.createElement("div",{className:"ai-message-content"},e.createElement("div",{className:"ai-message-header"},e.createElement("strong",null,a.role==="user"?C:"AI Assistant"),e.createElement("span",{className:"ai-message-time"},a.timestamp.toLocaleTimeString("tr-TR",{hour:"2-digit",minute:"2-digit"}))),e.createElement("div",{className:"ai-message-text"},a.content.split("```").map((s,n)=>n%2===0?e.createElement("span",{key:n},s):e.createElement("pre",{key:n,className:"ai-code-block"},e.createElement("code",null,s))))))),e.createElement("div",{ref:N})),e.createElement("form",{onSubmit:$,className:"ai-input-form"},e.createElement("input",{type:"text",value:i,onChange:a=>m(a.target.value),placeholder:"AI'ya bir ÅŸey sor...",disabled:u,className:"ai-input"}),e.createElement("button",{type:"submit",disabled:u||!i.trim(),className:"ai-send-btn"},u?"â³":e.createElement(T,null)))),l==="smart-reply"&&e.createElement("div",{className:"ai-feature-container"},e.createElement("div",{className:"ai-feature-header"},e.createElement(k,{size:32}),e.createElement("h4",null,"AkÄ±llÄ± Cevap Ã–nerileri"),e.createElement("p",null,"Mesajlara otomatik yanÄ±t Ã¶nerileri")),e.createElement("button",{onClick:()=>R("last-message-id"),disabled:u,className:"ai-action-btn"},"ğŸ’¡ Son Mesaja AkÄ±llÄ± Cevap Ã–ner"),h.length>0&&e.createElement("div",{className:"ai-smart-replies"},e.createElement("h5",null,"Ã–nerilen Cevaplar:"),h.map((a,t)=>e.createElement("div",{key:t,className:"ai-smart-reply-item"},e.createElement("span",null,a),e.createElement("button",{onClick:()=>m(a)},"Kullan"))))),l==="summarize"&&e.createElement("div",{className:"ai-feature-container"},e.createElement("div",{className:"ai-feature-header"},e.createElement(S,{size:32}),e.createElement("h4",null,"Mesaj Ã–zetleme"),e.createElement("p",null,"Uzun konuÅŸmalarÄ± tek paragrafta Ã¶zetle")),e.createElement("button",{onClick:()=>x(["msg1","msg2","msg3"]),disabled:u,className:"ai-action-btn"},"ğŸ“ Son 50 MesajÄ± Ã–zetle")),l==="code"&&e.createElement("div",{className:"ai-feature-container"},e.createElement("div",{className:"ai-feature-header"},e.createElement(z,{size:32}),e.createElement("h4",null,"Kod Ãœretimi"),e.createElement("p",null,"AI ile kod yaz, GitHub Copilot gibi")),e.createElement("form",{onSubmit:a=>{a.preventDefault(),D(i)},className:"ai-code-form"},e.createElement("textarea",{value:i,onChange:a=>m(a.target.value),placeholder:"Ne yapmak istiyorsun? Ã–rn: 'React'te bir sayaÃ§ komponenti yap'",rows:4,className:"ai-code-textarea"}),e.createElement("button",{type:"submit",disabled:u||!i.trim(),className:"ai-action-btn"},"ğŸ’» Kod Ãœret"))))};export{P as default};
