import{r as x,j as e}from"./react-core-D6cE4lil.js";import{a5 as R,a as S,d as L,b2 as I,E as _,as as z,b3 as B,ac as T,S as A}from"./icons-vendor-DT2gd7vx.js";import{h as D}from"./index-ClHcoIda.js";import"./media-vendor-Du00QUHb.js";import"./router-vendor-wrB4dqw3.js";import"./state-vendor-DnurjGY_.js";import"./crypto-vendor-BYnay7oC.js";import"./ui-vendor-CZOhtEfS.js";const t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,backdropFilter:"blur(5px)"},panel:{backgroundColor:"#2b2d31",borderRadius:"12px",width:"90%",maxWidth:"1000px",maxHeight:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.5)",overflow:"hidden"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:"1px solid #1e1f22"},headerLeft:{display:"flex",alignItems:"center",gap:"12px"},headerIcon:{fontSize:"24px",color:"#5865f2"},title:{margin:0,color:"#fff",fontSize:"24px",fontWeight:"600"},closeButton:{background:"none",border:"none",color:"#b9bbbe",cursor:"pointer",fontSize:"24px",padding:"8px",borderRadius:"4px"},statsGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px",padding:"20px",borderBottom:"1px solid #1e1f22"},statCard:{backgroundColor:"#1e1f22",borderRadius:"8px",padding:"16px",textAlign:"center"},statIcon:{fontSize:"32px",marginBottom:"8px"},statValue:{fontSize:"32px",fontWeight:"bold",color:"#fff",marginBottom:"4px"},statLabel:{fontSize:"14px",color:"#b9bbbe"},section:{padding:"20px",borderBottom:"1px solid #1e1f22",overflowY:"auto"},sectionHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},sectionTitle:{color:"#fff",fontSize:"18px",fontWeight:"600",margin:0,display:"flex",alignItems:"center",gap:"8px"},addButton:{backgroundColor:"#5865f2",color:"#fff",border:"none",borderRadius:"6px",padding:"8px 16px",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",fontSize:"14px",fontWeight:"600"},loading:{textAlign:"center",color:"#b9bbbe",padding:"40px"},empty:{textAlign:"center",color:"#b9bbbe",padding:"40px",fontSize:"14px"},rulesList:{display:"flex",flexDirection:"column",gap:"12px"},ruleCard:{backgroundColor:"#1e1f22",borderRadius:"8px",padding:"16px"},ruleHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},ruleType:{display:"flex",alignItems:"center",gap:"8px",fontSize:"16px",fontWeight:"600",color:"#fff"},ruleActions:{display:"flex",alignItems:"center",gap:"12px"},switch:{position:"relative",display:"inline-block",width:"44px",height:"24px"},slider:{position:"absolute",cursor:"pointer",top:0,left:0,right:0,bottom:0,backgroundColor:"#72767d",transition:"0.3s",borderRadius:"24px"},deleteBtn:{background:"none",border:"none",color:"#ed4245",cursor:"pointer",fontSize:"18px",padding:"4px"},ruleDetails:{display:"flex",flexDirection:"column",gap:"8px"},ruleInfo:{display:"flex",gap:"8px",fontSize:"14px"},ruleLabel:{color:"#b9bbbe",fontWeight:"500"},ruleValue:{color:"#fff"},logsList:{display:"flex",flexDirection:"column",gap:"8px"},logItem:{display:"flex",alignItems:"center",gap:"12px",backgroundColor:"#1e1f22",borderRadius:"6px",padding:"12px"},logIcon:{fontSize:"24px"},logContent:{flex:1},logText:{color:"#fff",fontSize:"14px",marginBottom:"4px"},logMeta:{color:"#72767d",fontSize:"12px"},logAction:{marginLeft:"auto"},modalOverlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10001},modal:{backgroundColor:"#2b2d31",borderRadius:"12px",padding:"24px",width:"90%",maxWidth:"500px"},modalTitle:{color:"#fff",fontSize:"20px",marginBottom:"20px"},formGroup:{marginBottom:"16px"},label:{display:"block",color:"#b9bbbe",fontSize:"14px",marginBottom:"8px",fontWeight:"500"},select:{width:"100%",backgroundColor:"#1e1f22",border:"1px solid #1e1f22",borderRadius:"6px",padding:"10px",color:"#fff",fontSize:"14px"},input:{width:"100%",backgroundColor:"#1e1f22",border:"1px solid #1e1f22",borderRadius:"6px",padding:"10px",color:"#fff",fontSize:"14px"},modalButtons:{display:"flex",gap:"12px",justifyContent:"flex-end",marginTop:"20px"},cancelBtn:{backgroundColor:"#4e5058",color:"#fff",border:"none",borderRadius:"6px",padding:"10px 20px",cursor:"pointer",fontSize:"14px"},createBtn:{backgroundColor:"#5865f2",color:"#fff",border:"none",borderRadius:"6px",padding:"10px 20px",cursor:"pointer",fontSize:"14px",fontWeight:"600"}},F=({serverId:o,fetchWithAuth:i,apiBaseUrl:a})=>{const[d,l]=x.useState([]),[p,u]=x.useState([]),[v,g]=x.useState({total_violations:0,auto_deleted:0,warnings_issued:0,users_banned:0}),[k,f]=x.useState(!1),[y,b]=x.useState({rule_type:"toxic",action:"warn",threshold:.8,keywords:[]}),[C,m]=x.useState(!0);return{rules:d,logs:p,stats:v,loading:C,showCreateRule:k,setShowCreateRule:f,newRule:y,setNewRule:b,loadData:async()=>{m(!0);try{const n=await i(`${a}/moderation/rules/${o}/`);if(n.ok){const j=await n.json();l(j.rules||[])}const r=await i(`${a}/moderation/logs/${o}/`);if(r.ok){const j=await r.json(),c=j.logs||j;u(c),c.length>0&&g({total_violations:c.length,auto_deleted:c.filter(h=>h.action==="delete").length,warnings_issued:c.filter(h=>h.action==="warn").length,users_banned:c.filter(h=>h.action==="ban").length})}}catch{}m(!1)},createRule:async()=>{try{const n=await i(`${a}/moderation/rules/${o}/create/`,{method:"POST",body:JSON.stringify(y)});if(n.ok){const r=await n.json();l([...d,r]),f(!1),b({rule_type:"toxic",action:"warn",threshold:.8,keywords:[]})}}catch{}},toggleRule:async n=>{try{await i(`${a}/moderation/rules/${n}/toggle/`,{method:"POST"}),l(d.map(r=>r.id===n?{...r,is_enabled:!r.is_enabled}:r))}catch{}},deleteRule:async n=>{if(await D("Bu kuralÄ± silmek istediÄŸine emin misin?"))try{await i(`${a}/moderation/rules/${n}/`,{method:"DELETE"}),l(d.filter(r=>r.id!==n))}catch{}}}},W=o=>{switch(o){case"toxic":return"â˜ ï¸";case"spam":return"ðŸš«";case"keyword":return"ðŸ”¤";case"link":return"ðŸ”—";case"caps":return"ðŸ“¢";default:return"âš™ï¸"}},V=o=>{switch(o){case"toxic":return"Toxic Language";case"spam":return"Spam Detection";case"keyword":return"Keyword Filter";case"link":return"Link Filter";case"caps":return"Excessive Caps";default:return o}},$=o=>{switch(o){case"warn":return"âš ï¸ Warn";case"delete":return"ðŸ—‘ï¸ Delete";case"timeout":return"â±ï¸ Timeout";case"kick":return"ðŸ‘¢ Kick";case"ban":return"ðŸ”¨ Ban";default:return o}},E=o=>{switch(o){case"warn":return"âš ï¸";case"delete":return"ðŸ—‘ï¸";case"timeout":return"â±ï¸";case"ban":return"ðŸ”¨";default:return"â“"}},M=o=>({padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"600",backgroundColor:o==="ban"?"#ed4245":o==="timeout"?"#f0b132":"#5865f2",color:"#fff"}),G=({newRule:o,setNewRule:i,onClose:a,onCreateRule:d})=>e.jsx("div",{style:t.modalOverlay,onClick:a,children:e.jsxs("div",{style:t.modal,onClick:l=>l.stopPropagation(),children:[e.jsx("h3",{style:t.modalTitle,children:"Create Moderation Rule"}),e.jsxs("div",{style:t.formGroup,children:[e.jsx("label",{style:t.label,children:"Rule Type"}),e.jsxs("select",{value:o.rule_type,onChange:l=>i({...o,rule_type:l.target.value}),style:t.select,children:[e.jsx("option",{value:"toxic",children:"Toxic Language"}),e.jsx("option",{value:"spam",children:"Spam Detection"}),e.jsx("option",{value:"keyword",children:"Keyword Filter"}),e.jsx("option",{value:"link",children:"Link Filter"}),e.jsx("option",{value:"caps",children:"Excessive Caps"})]})]}),e.jsxs("div",{style:t.formGroup,children:[e.jsx("label",{style:t.label,children:"Action"}),e.jsxs("select",{value:o.action,onChange:l=>i({...o,action:l.target.value}),style:t.select,children:[e.jsx("option",{value:"warn",children:"Warn User"}),e.jsx("option",{value:"delete",children:"Delete Message"}),e.jsx("option",{value:"timeout",children:"Timeout User (5min)"}),e.jsx("option",{value:"kick",children:"Kick User"}),e.jsx("option",{value:"ban",children:"Ban User"})]})]}),o.rule_type!=="keyword"&&e.jsxs("div",{style:t.formGroup,children:[e.jsxs("label",{style:t.label,children:["AI Threshold (",(o.threshold*100).toFixed(0),"%)"]}),e.jsx("input",{type:"range",min:"0.5",max:"1",step:"0.05",value:o.threshold,onChange:l=>i({...o,threshold:parseFloat(l.target.value)}),style:t.slider})]}),o.rule_type==="keyword"&&e.jsxs("div",{style:t.formGroup,children:[e.jsx("label",{style:t.label,children:"Keywords (comma separated)"}),e.jsx("input",{type:"text",placeholder:"word1, word2, word3",onChange:l=>i({...o,keywords:l.target.value.split(",").map(p=>p.trim())}),style:t.input})]}),e.jsxs("div",{style:t.modalButtons,children:[e.jsx("button",{onClick:a,style:t.cancelBtn,children:"Cancel"}),e.jsx("button",{onClick:d,style:t.createBtn,children:"Create Rule"})]})]})}),X=({serverId:o,fetchWithAuth:i,apiBaseUrl:a,onClose:d})=>{const{rules:l,logs:p,stats:u,showCreateRule:v,setShowCreateRule:g,newRule:k,setNewRule:f,loading:y,createRule:b,toggleRule:C,deleteRule:m}=F(o);return e.jsx("div",{style:t.overlay,onClick:d,children:e.jsxs("div",{style:t.panel,onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{style:t.header,children:[e.jsxs("div",{style:t.headerLeft,children:[e.jsx(R,{style:t.headerIcon}),e.jsx("h2",{style:t.title,children:"Auto-Moderation"})]}),e.jsx("button",{onClick:d,style:t.closeButton,children:e.jsx(S,{})})]}),e.jsxs("div",{style:t.statsGrid,children:[e.jsxs("div",{style:t.statCard,children:[e.jsx(L,{style:{...t.statIcon,color:"#f04747"}}),e.jsx("div",{style:t.statValue,children:u.total_violations}),e.jsx("div",{style:t.statLabel,children:"Total Violations"})]}),e.jsxs("div",{style:t.statCard,children:[e.jsx(I,{style:{...t.statIcon,color:"#ed4245"}}),e.jsx("div",{style:t.statValue,children:u.auto_deleted}),e.jsx("div",{style:t.statLabel,children:"Auto-Deleted"})]}),e.jsxs("div",{style:t.statCard,children:[e.jsx(_,{style:{...t.statIcon,color:"#f0b132"}}),e.jsx("div",{style:t.statValue,children:u.warnings_issued}),e.jsx("div",{style:t.statLabel,children:"Warnings"})]}),e.jsxs("div",{style:t.statCard,children:[e.jsx(z,{style:{...t.statIcon,color:"#43b581"}}),e.jsx("div",{style:t.statValue,children:l.filter(s=>s.is_enabled).length}),e.jsx("div",{style:t.statLabel,children:"Active Rules"})]})]}),e.jsxs("div",{style:t.section,children:[e.jsxs("div",{style:t.sectionHeader,children:[e.jsxs("h3",{style:t.sectionTitle,children:[e.jsx(B,{})," Moderation Rules"]}),e.jsxs("button",{onClick:()=>g(!0),style:t.addButton,children:[e.jsx(T,{})," Add Rule"]})]}),y?e.jsx("div",{style:t.loading,children:"Loading..."}):l.length===0?e.jsx("div",{style:t.empty,children:"No moderation rules yet. Create one to get started!"}):e.jsx("div",{style:t.rulesList,children:l.map(s=>e.jsxs("div",{style:t.ruleCard,children:[e.jsxs("div",{style:t.ruleHeader,children:[e.jsxs("div",{style:t.ruleType,children:[W(s.rule_type),e.jsx("span",{children:V(s.rule_type)})]}),e.jsxs("div",{style:t.ruleActions,children:[e.jsxs("label",{style:t.switch,children:[e.jsx("input",{type:"checkbox",checked:s.is_enabled,onChange:()=>C(s.id)}),e.jsx("span",{style:t.slider})]}),e.jsx("button",{onClick:()=>m(s.id),style:t.deleteBtn,children:e.jsx(S,{})})]})]}),e.jsxs("div",{style:t.ruleDetails,children:[e.jsxs("div",{style:t.ruleInfo,children:[e.jsx("span",{style:t.ruleLabel,children:"Action:"}),e.jsx("span",{style:t.ruleValue,children:$(s.action)})]}),s.threshold&&e.jsxs("div",{style:t.ruleInfo,children:[e.jsx("span",{style:t.ruleLabel,children:"Threshold:"}),e.jsxs("span",{style:t.ruleValue,children:[(s.threshold*100).toFixed(0),"%"]})]}),s.keywords&&s.keywords.length>0&&e.jsxs("div",{style:t.ruleInfo,children:[e.jsx("span",{style:t.ruleLabel,children:"Keywords:"}),e.jsx("span",{style:t.ruleValue,children:s.keywords.join(", ")})]})]})]},s.id))})]}),e.jsxs("div",{style:t.section,children:[e.jsxs("h3",{style:t.sectionTitle,children:[e.jsx(A,{})," Recent Activity"]}),e.jsx("div",{style:t.logsList,children:p.slice(0,10).map((s,w)=>e.jsxs("div",{style:t.logItem,children:[e.jsx("div",{style:t.logIcon,children:E(s.action)}),e.jsxs("div",{style:t.logContent,children:[e.jsxs("div",{style:t.logText,children:[e.jsx("strong",{children:s.user||"Unknown"})," - ",s.violation_type]}),e.jsxs("div",{style:t.logMeta,children:[s.content?.substring(0,50),"... ","â€¢"," ",new Date(s.created_at).toLocaleString()]})]}),e.jsx("div",{style:t.logAction,children:e.jsx("span",{style:M(s.action),children:s.action})})]},w))})]}),v&&e.jsx(G,{newRule:k,setNewRule:f,onClose:()=>g(!1),onCreateRule:b})]})})};export{X as default};
