import{r as t,n as e}from"./react-core-Cj7FUMmY.js";import{ae as p,cC as $,cD as G,h as L,by as P}from"./icons-vendor-Mc8int3h.js";import"./editor-vendor-D9c4a6XZ.js";function M({apiBaseUrl:i,fetchWithAuth:n,onSelectGIF:m}){const[f,y]=t.useState([]),[u,N]=t.useState([]),[c,v]=t.useState("all"),[o,w]=t.useState(""),[r,h]=t.useState("grid"),[l,j]=t.useState(new Set),[S,x]=t.useState(!1);t.useEffect(()=>{F(),b(),C()},[c,o]);const F=async()=>{x(!0);try{const s=new URLSearchParams;c!=="all"&&s.append("category",c),o&&s.append("search",o);const a=await n(`${i}/gifs/list_local/?${s}`);if(a.ok){const d=await a.json();y(d.gifs||[])}}catch{}finally{x(!1)}},b=async()=>{try{const s=await n(`${i}/gifs/categories/`);if(s.ok){const a=await s.json();N(a.categories||[])}}catch{}},C=async()=>{try{const s=await n(`${i}/gifs/favorites/`);if(s.ok){const a=await s.json();j(new Set(a.gif_ids||[]))}}catch{}},k=async s=>{try{const a=l.has(s),d=a?`${i}/gifs/favorites/remove/`:`${i}/gifs/favorites/add/`;if((await n(d,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({gif_id:s})})).ok){const g=new Set(l);a?g.delete(s):g.add(s),j(g)}}catch{}};return e.jsxs("div",{className:"gif-picker-panel",children:[e.jsxs("div",{className:"gif-header",children:[e.jsxs("h2",{children:[e.jsx(p,{})," GIF Library"]}),e.jsxs("div",{className:"view-controls",children:[e.jsx("button",{className:`view-btn ${r==="grid"?"active":""}`,onClick:()=>h("grid"),children:e.jsx($,{})}),e.jsx("button",{className:`view-btn ${r==="list"?"active":""}`,onClick:()=>h("list"),children:e.jsx(G,{})})]})]}),e.jsxs("div",{className:"gif-search",children:[e.jsx(L,{className:"search-icon"}),e.jsx("input",{type:"text",placeholder:"Search GIFs...",value:o,onChange:s=>w(s.target.value),className:"search-input"})]}),e.jsxs("div",{className:"gif-categories",children:[e.jsx("button",{className:`category-btn ${c==="all"?"active":""}`,onClick:()=>v("all"),children:"All"}),u.map(s=>e.jsx("button",{className:`category-btn ${c===s.id?"active":""}`,onClick:()=>v(s.id),children:s.name},s.id))]}),e.jsx("div",{className:`gif-grid ${r}`,children:S?e.jsx("div",{className:"gif-loading",children:"Loading GIFs..."}):f.length===0?e.jsxs("div",{className:"empty-gifs",children:[e.jsx(p,{className:"empty-icon"}),e.jsx("p",{children:"No GIFs found"})]}):f.map(s=>e.jsxs("div",{className:"gif-item",children:[e.jsx("img",{src:s.url,alt:s.name,onClick:()=>m&&m(s),className:"gif-image"}),e.jsx("div",{className:"gif-overlay",children:e.jsx("button",{className:`fav-btn ${l.has(s.id)?"favorited":""}`,onClick:a=>{a.stopPropagation(),k(s.id)},children:e.jsx(P,{})})})]},s.id))})]})}export{M as default};
