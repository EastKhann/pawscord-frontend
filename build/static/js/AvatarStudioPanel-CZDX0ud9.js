import{r as p,j as e}from"./react-core-D6cE4lil.js";import{C as T,aq as j,a as B,ap as E,br as w,ca as F,aY as O}from"./icons-vendor-fClA8qVL.js";import{t as c}from"./index-DHLSv4f5.js";import"./media-vendor-Du00QUHb.js";import"./router-vendor-wrB4dqw3.js";import"./state-vendor-DnurjGY_.js";import"./crypto-vendor-Drccqhv1.js";import"./ui-vendor-CZOhtEfS.js";const N=[{id:"face_shapes",name:"Face",icon:"ðŸ‘¤"},{id:"skin_tones",name:"Skin",icon:"ðŸŽ¨"},{id:"eyes",name:"Eyes",icon:"ðŸ‘ï¸"},{id:"eye_colors",name:"Eye Color",icon:"ðŸ”µ"},{id:"hairstyles",name:"Hair",icon:"ðŸ’‡"},{id:"hair_colors",name:"Hair Color",icon:"ðŸŒˆ"},{id:"mouths",name:"Mouth",icon:"ðŸ‘„"},{id:"accessories",name:"Accessories",icon:"ðŸ‘“"},{id:"backgrounds",name:"Background",icon:"ðŸ–¼ï¸"},{id:"expressions",name:"Expression",icon:"ðŸ˜Š"}],D={face_shapes:"face_shape",skin_tones:"skin_tone",hairstyles:"hairstyle",mouths:"mouth",accessories:"accessory",backgrounds:"background",expressions:"expression",eyes:"eyes",eye_colors:"eye_color",hair_colors:"hair_color"},t={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.85)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e4},modal:{backgroundColor:"#2f3136",borderRadius:"12px",width:"900px",maxHeight:"90vh",overflow:"hidden",display:"flex",flexDirection:"column"},header:{display:"flex",alignItems:"center",padding:"20px",borderBottom:"1px solid #40444b"},headerLeft:{display:"flex",alignItems:"center",flex:1},title:{margin:0,color:"#fff",fontSize:"20px"},coinsDisplay:{display:"flex",alignItems:"center",gap:"6px",color:"#fff",marginRight:"20px",background:"#40444b",padding:"6px 12px",borderRadius:"20px"},closeButton:{background:"none",border:"none",color:"#b9bbbe",cursor:"pointer",fontSize:"20px"},tabs:{display:"flex",padding:"10px 20px",gap:"10px",borderBottom:"1px solid #40444b"},tab:{background:"#40444b",border:"none",color:"#b9bbbe",padding:"8px 16px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},activeTab:{background:"#5865f2",border:"none",color:"#fff",padding:"8px 16px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},mainContent:{display:"flex",padding:"20px",gap:"20px",overflowY:"auto",flex:1},previewSection:{width:"250px",display:"flex",flexDirection:"column",alignItems:"center",gap:"20px"},previewActions:{display:"flex",flexDirection:"column",gap:"10px",width:"100%"},actionBtn:{background:"#40444b",border:"none",color:"#fff",padding:"10px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},saveBtn:{background:"#57f287",border:"none",color:"#000",padding:"12px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",fontWeight:"bold"},customizeSection:{flex:1},categoryTabs:{display:"flex",flexWrap:"wrap",gap:"8px",marginBottom:"15px"},catBtn:{background:"#40444b",border:"none",color:"#b9bbbe",padding:"8px 12px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",fontSize:"12px"},catActive:{background:"#5865f2",border:"none",color:"#fff",padding:"8px 12px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",fontSize:"12px"},catName:{display:"none"},itemsGrid:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"10px"},itemCard:{background:"#40444b",borderRadius:"8px",padding:"12px",display:"flex",flexDirection:"column",alignItems:"center",gap:"8px",cursor:"pointer",position:"relative"},itemSelected:{border:"2px solid #5865f2",background:"#36393f"},itemLocked:{opacity:.7,cursor:"default"},colorSwatch:{width:"40px",height:"40px",borderRadius:"50%",border:"2px solid #fff"},itemPreview:{width:"40px",height:"40px",borderRadius:"50%",background:"#5865f2",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontWeight:"bold"},itemName:{color:"#dcddde",fontSize:"11px",textAlign:"center"},buyBtn:{position:"absolute",bottom:"8px",right:"8px",background:"#faa61a",border:"none",color:"#000",padding:"4px 8px",borderRadius:"4px",cursor:"pointer",fontSize:"10px",display:"flex",alignItems:"center",gap:"4px"},presetsGrid:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"15px",width:"100%"},presetCard:{background:"#40444b",borderRadius:"10px",padding:"15px",display:"flex",flexDirection:"column",alignItems:"center",gap:"10px"},presetName:{color:"#fff",fontSize:"14px"},loadBtn:{background:"#5865f2",border:"none",color:"#fff",padding:"6px 16px",borderRadius:"4px",cursor:"pointer"},emptyText:{color:"#72767d",textAlign:"center",gridColumn:"1 / -1",padding:"40px"}},L={face_shape:"round",skin_tone:"medium",eyes:"normal",eye_color:"brown",hairstyle:"short",hair_color:"black",mouth:"smile",accessory:"none",background:"solid_gray",expression:"default"},$=(r,n)=>{const[f,s]=p.useState({}),[o,d]=p.useState({}),[y,x]=p.useState([]),[l,b]=p.useState(0),[k,S]=p.useState([]),[_,g]=p.useState(!1),[R,P]=p.useState("face_shapes"),[z,h]=p.useState("customize");p.useEffect(()=>{A(),I(),v()},[]);const A=async()=>{try{const i=await(await r(`${n}/avatar-studio/parts/`)).json();s(i.parts||{}),b(i.user_coins||0)}catch{}},I=async()=>{try{const i=await(await r(`${n}/avatar-studio/my-avatar/`)).json();d(i.avatar||L),x(i.owned_items||[])}catch{}},v=async()=>{try{const i=await(await r(`${n}/avatar-studio/presets/`)).json();S(i.presets||[])}catch{}};return{parts:f,avatar:o,ownedItems:y,userCoins:l,presets:k,loading:_,activeCategory:R,setActiveCategory:P,view:z,setView:h,selectPart:(a,i)=>{const m=D[a]||a;d(u=>({...u,[m]:i}))},purchaseItem:async(a,i)=>{g(!0);try{const u=await(await r(`${n}/avatar-studio/purchase/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({category:a,item_id:i})})).json();u.message?(c.success(u.message),b(u.new_balance),x(u.owned_items)):c.error(u.error||"Purchase failed")}catch{c.error("Purchase failed")}finally{g(!1)}},saveAvatar:async()=>{g(!0);try{const i=await(await r(`${n}/avatar-studio/save/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({config:o})})).json();i.message?c.success("Avatar saved!"):c.error(i.error||"Save failed")}catch{c.error("Save failed")}finally{g(!1)}},randomizeAvatar:async()=>{try{const i=await(await r(`${n}/avatar-studio/randomize/`,{method:"POST"})).json();i.avatar&&(d(i.avatar),c.success("Randomized!"))}catch{c.error("Failed to randomize")}},savePreset:async()=>{const a=prompt("Enter preset name:");if(a)try{(await(await r(`${n}/avatar-studio/presets/save/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:a,config:o})})).json()).preset_id&&(c.success("Preset saved!"),v())}catch{c.error("Failed to save preset")}},loadPreset:a=>{d(a.config),h("customize")}}},C=({avatar:r,parts:n,mini:f=!1})=>{const s=f?80:200,o=n.backgrounds?.find(l=>l.id===r.background)?.color||"#36393f",d=n.skin_tones?.find(l=>l.id===r.skin_tone)?.color||"#D2B48C",y=n.hair_colors?.find(l=>l.id===r.hair_color)?.color||"#1C1C1C",x=n.eye_colors?.find(l=>l.id===r.eye_color)?.color||"#8B4513";return e.jsxs("div",{style:{width:s,height:s,borderRadius:"50%",background:o,display:"flex",alignItems:"center",justifyContent:"center",position:"relative",overflow:"hidden",border:"4px solid #40444b"},children:[e.jsxs("div",{style:{width:s*.7,height:s*.8,borderRadius:r.face_shape==="round"?"50%":r.face_shape==="oval"?"50% 50% 45% 45%":r.face_shape==="square"?"10%":"50%",background:d,position:"relative"},children:[e.jsx("div",{style:{position:"absolute",top:-s*.1,left:"50%",transform:"translateX(-50%)",width:s*.7,height:s*.3,background:y,borderRadius:"50% 50% 0 0"}}),e.jsxs("div",{style:{position:"absolute",top:"35%",left:"50%",transform:"translateX(-50%)",display:"flex",gap:s*.15},children:[e.jsx("div",{style:{width:s*.1,height:s*.1,borderRadius:"50%",background:x}}),e.jsx("div",{style:{width:s*.1,height:s*.1,borderRadius:"50%",background:x}})]}),e.jsx("div",{style:{position:"absolute",bottom:"20%",left:"50%",transform:"translateX(-50%)",width:s*.2,height:s*.05,background:r.mouth==="smile"?"#e8a0a0":"#d4a0a0",borderRadius:r.mouth==="smile"?"0 0 50% 50%":"4px"}})]}),r.accessory==="glasses"&&e.jsx("div",{style:{position:"absolute",top:"32%",left:"50%",transform:"translateX(-50%)",width:s*.5,height:s*.12,border:"2px solid #333",borderRadius:"4px",background:"transparent"}}),r.accessory==="crown"&&e.jsx("div",{style:{position:"absolute",top:0,left:"50%",transform:"translateX(-50%)",fontSize:s*.2},children:"ðŸ‘‘"}),r.accessory==="cat_ears"&&e.jsx("div",{style:{position:"absolute",top:s*.05,left:"50%",transform:"translateX(-50%)",fontSize:s*.15},children:"ðŸ±"})]})},se=({fetchWithAuth:r,apiBaseUrl:n,onClose:f})=>{const s=$(r,n);return e.jsx("div",{style:t.overlay,children:e.jsxs("div",{style:t.modal,children:[e.jsxs("div",{style:t.header,children:[e.jsxs("div",{style:t.headerLeft,children:[e.jsx(T,{style:{marginRight:"10px",color:"#5865f2"}}),e.jsx("h2",{style:t.title,children:"Avatar Studio"})]}),e.jsxs("div",{style:t.coinsDisplay,children:[e.jsx(j,{style:{color:"#faa61a"}}),e.jsx("span",{children:s.userCoins})]}),e.jsx("button",{onClick:f,style:t.closeButton,children:e.jsx(B,{})})]}),e.jsxs("div",{style:t.tabs,children:[e.jsxs("button",{onClick:()=>s.setView("customize"),style:s.view==="customize"?t.activeTab:t.tab,children:[e.jsx(E,{})," Customize"]}),e.jsxs("button",{onClick:()=>s.setView("presets"),style:s.view==="presets"?t.activeTab:t.tab,children:[e.jsx(w,{})," Presets"]})]}),e.jsxs("div",{style:t.mainContent,children:[s.view==="customize"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:t.previewSection,children:[e.jsx(C,{avatar:s.avatar,parts:s.parts}),e.jsxs("div",{style:t.previewActions,children:[e.jsxs("button",{onClick:s.randomizeAvatar,style:t.actionBtn,children:[e.jsx(F,{})," Random"]}),e.jsxs("button",{onClick:s.savePreset,style:t.actionBtn,children:[e.jsx(w,{})," Save Preset"]}),e.jsxs("button",{onClick:s.saveAvatar,style:t.saveBtn,disabled:s.loading,children:[e.jsx(O,{})," ",s.loading?"Saving...":"Save Avatar"]})]})]}),e.jsxs("div",{style:t.customizeSection,children:[e.jsx("div",{style:t.categoryTabs,children:N.map(o=>e.jsxs("button",{onClick:()=>s.setActiveCategory(o.id),style:s.activeCategory===o.id?t.catActive:t.catBtn,children:[e.jsx("span",{children:o.icon}),e.jsx("span",{style:t.catName,children:o.name})]},o.id))}),e.jsx("div",{style:t.itemsGrid,children:(s.parts[s.activeCategory]||[]).map(o=>{const d=o.free||s.ownedItems.includes(o.id),y=Object.values(s.avatar).includes(o.id);return e.jsxs("div",{style:{...t.itemCard,...y?t.itemSelected:{},...d?{}:t.itemLocked},onClick:()=>d&&s.selectPart(s.activeCategory,o.id),children:[o.color&&!["gradient","galaxy","rainbow"].includes(o.color)?e.jsx("div",{style:{...t.colorSwatch,background:o.color}}):e.jsx("span",{style:t.itemPreview,children:(o.name||o.id).charAt(0).toUpperCase()}),e.jsx("span",{style:t.itemName,children:o.name||o.id}),!d&&e.jsxs("button",{onClick:x=>{x.stopPropagation(),s.purchaseItem(s.activeCategory,o.id)},style:t.buyBtn,disabled:s.loading||s.userCoins<(o.coins||0),children:[e.jsx(j,{})," ",o.coins]})]},o.id)})})]})]}),s.view==="presets"&&e.jsxs("div",{style:t.presetsGrid,children:[s.presets.map(o=>e.jsxs("div",{style:t.presetCard,children:[e.jsx(C,{avatar:o.config,parts:s.parts,mini:!0}),e.jsx("span",{style:t.presetName,children:o.name}),e.jsx("button",{onClick:()=>s.loadPreset(o),style:t.loadBtn,children:"Load"})]},o.id)),s.presets.length===0&&e.jsx("p",{style:t.emptyText,children:"No presets saved yet"})]})]})]})})};export{se as default};
