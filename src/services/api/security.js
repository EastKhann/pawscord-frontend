// Security API services
// Auto-generated by split_nice_to_have_api.py

import { API_BASE, getAuthHeaders } from './shared';

// ==========================================
// ðŸ•µï¸ #40 - Security Activity
// ==========================================
export const securityApi = {
    getActivityLog: async () => {
        const res = await fetch(`${API_BASE}/api/security/activity/`, { headers: getAuthHeaders() });
        return res.json();
    },
    getTrustedDevices: async () => {
        const res = await fetch(`${API_BASE}/api/security/devices/`, { headers: getAuthHeaders() });
        return res.json();
    },
    removeDevice: async (deviceId) => {
        const res = await fetch(`${API_BASE}/api/security/devices/${deviceId}/`, {
            method: 'DELETE',
            headers: getAuthHeaders()
        });
        return res.json();
    }
};

// ==========================================
// ðŸ“œ #42 - Audit Log Retention
// ==========================================
export const auditRetentionApi = {
    getPolicy: async (serverId) => {
        const res = await fetch(`${API_BASE}/api/servers/${serverId}/audit/policy/`, { headers: getAuthHeaders() });
        return res.json();
    },
    updatePolicy: async (serverId, data) => {
        const res = await fetch(`${API_BASE}/api/servers/${serverId}/audit/policy/`, {
            method: 'PUT',
            headers: getAuthHeaders(),
            body: JSON.stringify(data)
        });
        return res.json();
    },
    getArchives: async (serverId) => {
        const res = await fetch(`${API_BASE}/api/servers/${serverId}/audit/archives/`, { headers: getAuthHeaders() });
        return res.json();
    }
};

// ==========================================
// ðŸ” #44 - E2EE Keys
// ==========================================
export const e2eeKeysApi = {
    getMyKeys: async () => {
        const res = await fetch(`${API_BASE}/api/e2ee/keys/`, { headers: getAuthHeaders() });
        return res.json();
    },
    registerKeys: async (data) => {
        const res = await fetch(`${API_BASE}/api/e2ee/keys/`, {
            method: 'POST',
            headers: getAuthHeaders(),
            body: JSON.stringify(data)
        });
        return res.json();
    },
    getUserPublicKey: async (userId) => {
        const res = await fetch(`${API_BASE}/api/e2ee/keys/${userId}/`, { headers: getAuthHeaders() });
        return res.json();
    }
};

// ==========================================
// ðŸ”’ #37 - Two-Factor Hardware Key Support
// ==========================================
export const hardwareKeyApi = {
    getKeys: async () => {
        const res = await fetch(`${API_BASE}/api/auth/2fa/hardware-keys/`, { headers: getAuthHeaders() });
        return res.json();
    },
    registerKey: async (keyData) => {
        const res = await fetch(`${API_BASE}/api/auth/2fa/hardware-keys/`, {
            method: 'POST',
            headers: getAuthHeaders(),
            body: JSON.stringify(keyData)
        });
        return res.json();
    },
    deleteKey: async (keyId) => {
        const res = await fetch(`${API_BASE}/api/auth/2fa/hardware-keys/`, {
            method: 'DELETE',
            headers: getAuthHeaders(),
            body: JSON.stringify({ key_id: keyId })
        });
        return res.json();
    },
    generateBackupCodes: async () => {
        const res = await fetch(`${API_BASE}/api/auth/2fa/backup-codes/`, {
            method: 'POST',
            headers: getAuthHeaders()
        });
        return res.json();
    },
    useBackupCode: async (code) => {
        const res = await fetch(`${API_BASE}/api/auth/2fa/backup-codes/`, {
            method: 'PUT',
            headers: getAuthHeaders(),
            body: JSON.stringify({ code })
        });
        return res.json();
    },
    getSettings: async () => {
        const res = await fetch(`${API_BASE}/api/auth/2fa/settings/`, { headers: getAuthHeaders() });
        return res.json();
    },
    updateSettings: async (settings) => {
        const res = await fetch(`${API_BASE}/api/auth/2fa/settings/`, {
            method: 'PATCH',
            headers: getAuthHeaders(),
            body: JSON.stringify(settings)
        });
        return res.json();
    }
};

// ==========================================
// ðŸŽ­ #41 - Alt Account Detection
// ==========================================
export const altAccountApi = {
    recordFingerprint: async (fingerprintData) => {
        const res = await fetch(`${API_BASE}/api/fingerprint/`, {
            method: 'POST',
            headers: getAuthHeaders(),
            body: JSON.stringify(fingerprintData)
        });
        return res.json();
    },
    getSuspicions: async (serverId) => {
        const res = await fetch(`${API_BASE}/api/servers/${serverId}/alt-accounts/`, { headers: getAuthHeaders() });
        return res.json();
    },
    reviewSuspicion: async (suspicionId, result) => {
        const res = await fetch(`${API_BASE}/api/alt-accounts/${suspicionId}/review/`, {
            method: 'POST',
            headers: getAuthHeaders(),
            body: JSON.stringify({ result })
        });
        return res.json();
    }
};
