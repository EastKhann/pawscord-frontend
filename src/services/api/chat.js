// Chat API services
// Auto-generated by split_nice_to_have_api.py

import { API_BASE, apiFetch } from './shared';

// ==========================================
// ðŸ’Œ #16 - Anonymous Feedback
// ==========================================
export const feedbackApi = {
    sendFeedback: async (data) => {
        return await apiFetch(`${API_BASE}/api/feedback/send/`, {
            method: 'POST',
            body: JSON.stringify(data)
        });
    },
    getMyFeedbacks: async () => {
        return await apiFetch(`${API_BASE}/api/feedback/`);
    }
};

// ==========================================
// ðŸ”® #18 - Time Capsule
// ==========================================
export const timeCapsuleApi = {
    getCapsules: async () => {
        return await apiFetch(`${API_BASE}/api/time-capsule/`);
    },
    createCapsule: async (data) => {
        return await apiFetch(`${API_BASE}/api/time-capsule/`, {
            method: 'POST',
            body: JSON.stringify(data)
        });
    }
};

// ==========================================
// ðŸ“± #20 - QR Codes
// ==========================================
export const qrCodeApi = {
    generate: async (data) => {
        return await apiFetch(`${API_BASE}/api/qr/generate/`, {
            method: 'POST',
            body: JSON.stringify(data)
        });
    },
    scan: async (code) => {
        return await apiFetch(`${API_BASE}/api/qr/${code}/`);
    }
};

// ==========================================
// ðŸ§µ #21 - Advanced Threading
// ==========================================
export const threadingApi = {
    getSettings: async (threadId) => {
        return await apiFetch(`${API_BASE}/api/threads/${threadId}/settings/`);
    },
    updateSettings: async (threadId, data) => {
        return await apiFetch(`${API_BASE}/api/threads/${threadId}/settings/`, {
            method: 'PUT',
            body: JSON.stringify(data)
        });
    },
    subscribe: async (threadId, level = 'all') => {
        return await apiFetch(`${API_BASE}/api/threads/${threadId}/subscribe/`, {
            method: 'POST',
            body: JSON.stringify({ notification_level: level })
        });
    },
    unsubscribe: async (threadId) => {
        return await apiFetch(`${API_BASE}/api/threads/${threadId}/subscribe/`, {
            method: 'DELETE'
        });
    }
};

// ==========================================
// ðŸ“ #23 - Message Templates
// ==========================================
export const messageTemplatesApi = {
    getTemplates: async (serverId = null) => {
        const url = serverId
            ? `${API_BASE}/api/templates/?server_id=${serverId}`
            : `${API_BASE}/api/templates/`;
        return await apiFetch(url);
    },
    createTemplate: async (data) => {
        return await apiFetch(`${API_BASE}/api/templates/`, {
            method: 'POST',
            body: JSON.stringify(data)
        });
    }
};

// ==========================================
// ðŸ” #25 - Advanced Search
// ==========================================
export const advancedSearchApi = {
    search: async (query, filters = {}) => {
        return await apiFetch(`${API_BASE}/api/search/advanced/`, {
            method: 'POST',
            body: JSON.stringify({ query, filters })
        });
    }
};

// ==========================================
// ðŸ’¾ #27 - Message Auto-Delete
// ==========================================
export const autoDeleteApi = {
    getSettings: async () => {
        return await apiFetch(`${API_BASE}/api/settings/auto-delete/`);
    },
    updateSettings: async (data) => {
        return await apiFetch(`${API_BASE}/api/settings/auto-delete/`, {
            method: 'PUT',
            body: JSON.stringify(data)
        });
    }
};

// ==========================================
// ðŸ”— #29 - Link Preview
// ==========================================
export const linkPreviewApi = {
    fetchPreview: async (url) => {
        return await apiFetch(`${API_BASE}/api/link-preview/`, {
            method: 'POST',
            body: JSON.stringify({ url })
        });
    }
};

// ==========================================
// ðŸ—£ï¸ #31 - TTS Settings
// ==========================================
export const ttsApi = {
    getSettings: async () => {
        return await apiFetch(`${API_BASE}/api/tts/settings/`);
    },
    updateSettings: async (data) => {
        return await apiFetch(`${API_BASE}/api/tts/settings/`, {
            method: 'PUT',
            body: JSON.stringify(data)
        });
    }
};

// ==========================================
// ðŸ“¦ #32 - Message Bundles
// ==========================================
export const messageBundlesApi = {
    getBundles: async () => {
        return await apiFetch(`${API_BASE}/api/bundles/`);
    },
    createBundle: async (data) => {
        return await apiFetch(`${API_BASE}/api/bundles/`, {
            method: 'POST',
            body: JSON.stringify(data)
        });
    }
};

// ==========================================
// ðŸ” #34 - Ephemeral Messages
// ==========================================
export const ephemeralApi = {
    getSettings: async (conversationId = null, roomId = null) => {
        let url = `${API_BASE}/api/ephemeral/settings/`;
        if (conversationId) url += `?conversation_id=${conversationId}`;
        if (roomId) url += `?room_id=${roomId}`;
        return await apiFetch(url);
    },
    updateSettings: async (data) => {
        return await apiFetch(`${API_BASE}/api/ephemeral/settings/`, {
            method: 'PUT',
            body: JSON.stringify(data)
        });
    }
};

// ==========================================
// ðŸ’¬ #35 - Translation
// ==========================================
export const translationApi = {
    translate: async (text, targetLanguage = 'en') => {
        return await apiFetch(`${API_BASE}/api/translate/`, {
            method: 'POST',
            body: JSON.stringify({ text, target_language: targetLanguage })
        });
    },
    getPreference: async () => {
        return await apiFetch(`${API_BASE}/api/translation/preference/`);
    },
    updatePreference: async (data) => {
        return await apiFetch(`${API_BASE}/api/translation/preference/`, {
            method: 'PUT',
            body: JSON.stringify(data)
        });
    }
};

// ==========================================
// ðŸ“Œ #22 - Smart Pinned Messages
// ==========================================
export const smartPinApi = {
    getPins: async (roomId) => {
        return await apiFetch(`${API_BASE}/api/rooms/${roomId}/pins/`);
    },
    createPin: async (roomId, messageId, options = {}) => {
        return await apiFetch(`${API_BASE}/api/rooms/${roomId}/pins/`, {
            method: 'POST',
            body: JSON.stringify({ message_id: messageId, ...options })
        });
    },
    deletePin: async (pinId) => {
        return await apiFetch(`${API_BASE}/api/pins/${pinId}/`, {
            method: 'DELETE'
        });
    }
};

// ==========================================
// ðŸ“… #26 - Message Scheduling with Recurrence
// ==========================================
export const messageSchedulingApi = {
    getScheduled: async () => {
        return await apiFetch(`${API_BASE}/api/scheduled-messages/`);
    },
    scheduleMessage: async (roomId, content, scheduledAt, recurrence = {}) => {
        return await apiFetch(`${API_BASE}/api/scheduled-messages/`, {
            method: 'POST',
            body: JSON.stringify({ room_id: roomId, content, scheduled_at: scheduledAt, ...recurrence })
        });
    },
    cancelScheduled: async (messageId) => {
        return await apiFetch(`${API_BASE}/api/scheduled-messages/${messageId}/`, {
            method: 'DELETE'
        });
    }
};

// ==========================================
// ðŸŽ¯ #33 - Smart Mention Suggestions
// ==========================================
export const mentionSuggestionApi = {
    getSuggestions: async (roomId, query = '') => {
        return await apiFetch(`${API_BASE}/api/rooms/${roomId}/mention-suggestions/?q=${query}`);
    }
};
